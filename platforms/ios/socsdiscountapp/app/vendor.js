(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["vendor"],{

/***/ "../node_modules/css-loader/dist/cjs.js?!../node_modules/nativescript-theme-core/css/core.light.css":
/***/ (function(module, exports, __webpack_require__) {

exports = module.exports = __webpack_require__("../node_modules/css-loader/dist/runtime/api.js")(false);
// Module
exports.push([module.i, "/*!\r\n * NativeScript Theme v1.0.6 (https://nativescript.org)\r\n * Copyright 2016-2016 The Theme Authors\r\n * Copyright 2016-2016 Telerik\r\n * Licensed under MIT (https://github.com/NativeScript/theme/blob/master/LICENSE)\r\n */.c-white{color:#fff}.c-bg-white{background-color:#fff}.c-black{color:#000}.c-bg-black{background-color:#000}.c-aqua{color:#00caab}.c-bg-aqua{background-color:#00caab}.c-blue{color:#3d5afe}.c-bg-blue{background-color:#3d5afe}.c-charcoal{color:#303030}.c-bg-charcoal{background-color:#303030}.c-brown{color:#795548}.c-bg-brown{background-color:#795548}.c-forest{color:#006968}.c-bg-forest{background-color:#006968}.c-grey{color:#e0e0e0}.c-bg-grey{background-color:#e0e0e0}.c-grey-light{color:#bababa}.c-bg-grey-light{background-color:#bababa}.c-grey-dark{color:#5c687c}.c-bg-grey-dark{background-color:#5c687c}.c-purple{color:#8130ff}.c-bg-purple{background-color:#8130ff}.c-lemon{color:#ffea00}.c-bg-lemon{background-color:#ffea00}.c-lime{color:#aee406}.c-bg-lime{background-color:#aee406}.c-orange{color:#f57c00}.c-bg-orange{background-color:#f57c00}.c-ruby{color:#ff1744}.c-bg-ruby{background-color:#ff1744}.c-sky{color:#30bcff}.c-bg-sky{background-color:#30bcff}.w-full{width:100%}.w-100{width:100}.h-full{height:100%}.h-100{height:100}.m-0{margin:0}.m-t-0{margin-top:0}.m-r-0{margin-right:0}.m-b-0{margin-bottom:0}.m-l-0{margin-left:0}.m-x-0{margin-right:0;margin-left:0}.m-y-0{margin-top:0;margin-bottom:0}.m-2{margin:2}.m-t-2{margin-top:2}.m-r-2{margin-right:2}.m-b-2{margin-bottom:2}.m-l-2{margin-left:2}.m-x-2{margin-right:2;margin-left:2}.m-y-2{margin-top:2;margin-bottom:2}.m-4{margin:4}.m-t-4{margin-top:4}.m-r-4{margin-right:4}.m-b-4{margin-bottom:4}.m-l-4{margin-left:4}.m-x-4{margin-right:4;margin-left:4}.m-y-4{margin-top:4;margin-bottom:4}.m-5{margin:5}.m-t-5{margin-top:5}.m-r-5{margin-right:5}.m-b-5{margin-bottom:5}.m-l-5{margin-left:5}.m-x-5{margin-right:5;margin-left:5}.m-y-5{margin-top:5;margin-bottom:5}.m-8{margin:8}.m-t-8{margin-top:8}.m-r-8{margin-right:8}.m-b-8{margin-bottom:8}.m-l-8{margin-left:8}.m-x-8{margin-right:8;margin-left:8}.m-y-8{margin-top:8;margin-bottom:8}.m-10{margin:10}.m-t-10{margin-top:10}.m-r-10{margin-right:10}.m-b-10{margin-bottom:10}.m-l-10{margin-left:10}.m-x-10{margin-right:10;margin-left:10}.m-y-10{margin-top:10;margin-bottom:10}.m-12{margin:12}.m-t-12{margin-top:12}.m-r-12{margin-right:12}.m-b-12{margin-bottom:12}.m-l-12{margin-left:12}.m-x-12{margin-right:12;margin-left:12}.m-y-12{margin-top:12;margin-bottom:12}.m-15{margin:15}.m-t-15{margin-top:15}.m-r-15{margin-right:15}.m-b-15{margin-bottom:15}.m-l-15{margin-left:15}.m-x-15{margin-right:15;margin-left:15}.m-y-15{margin-top:15;margin-bottom:15}.m-16{margin:16}.m-t-16{margin-top:16}.m-r-16{margin-right:16}.m-b-16{margin-bottom:16}.m-l-16{margin-left:16}.m-x-16{margin-right:16;margin-left:16}.m-y-16{margin-top:16;margin-bottom:16}.m-20{margin:20}.m-t-20{margin-top:20}.m-r-20{margin-right:20}.m-b-20{margin-bottom:20}.m-l-20{margin-left:20}.m-x-20{margin-right:20;margin-left:20}.m-y-20{margin-top:20;margin-bottom:20}.m-24{margin:24}.m-t-24{margin-top:24}.m-r-24{margin-right:24}.m-b-24{margin-bottom:24}.m-l-24{margin-left:24}.m-x-24{margin-right:24;margin-left:24}.m-y-24{margin-top:24;margin-bottom:24}.m-25{margin:25}.m-t-25{margin-top:25}.m-r-25{margin-right:25}.m-b-25{margin-bottom:25}.m-l-25{margin-left:25}.m-x-25{margin-right:25;margin-left:25}.m-y-25{margin-top:25;margin-bottom:25}.m-28{margin:28}.m-t-28{margin-top:28}.m-r-28{margin-right:28}.m-b-28{margin-bottom:28}.m-l-28{margin-left:28}.m-x-28{margin-right:28;margin-left:28}.m-y-28{margin-top:28;margin-bottom:28}.m-30{margin:30}.m-t-30{margin-top:30}.m-r-30{margin-right:30}.m-b-30{margin-bottom:30}.m-l-30{margin-left:30}.m-x-30{margin-right:30;margin-left:30}.m-y-30{margin-top:30;margin-bottom:30}.p-0{padding:0}.p-t-0{padding-top:0}.p-r-0{padding-right:0}.p-b-0{padding-bottom:0}.p-l-0{padding-left:0}.p-x-0{padding-right:0;padding-left:0}.p-y-0{padding-top:0;padding-bottom:0}.p-2{padding:2}.p-t-2{padding-top:2}.p-r-2{padding-right:2}.p-b-2{padding-bottom:2}.p-l-2{padding-left:2}.p-x-2{padding-right:2;padding-left:2}.p-y-2{padding-top:2;padding-bottom:2}.p-4{padding:4}.p-t-4{padding-top:4}.p-r-4{padding-right:4}.p-b-4{padding-bottom:4}.p-l-4{padding-left:4}.p-x-4{padding-right:4;padding-left:4}.p-y-4{padding-top:4;padding-bottom:4}.p-5{padding:5}.p-t-5{padding-top:5}.p-r-5{padding-right:5}.p-b-5{padding-bottom:5}.p-l-5{padding-left:5}.p-x-5{padding-right:5;padding-left:5}.p-y-5{padding-top:5;padding-bottom:5}.p-8{padding:8}.p-t-8{padding-top:8}.p-r-8{padding-right:8}.p-b-8{padding-bottom:8}.p-l-8{padding-left:8}.p-x-8{padding-right:8;padding-left:8}.p-y-8{padding-top:8;padding-bottom:8}.p-10{padding:10}.p-t-10{padding-top:10}.p-r-10{padding-right:10}.p-b-10{padding-bottom:10}.p-l-10{padding-left:10}.p-x-10{padding-right:10;padding-left:10}.p-y-10{padding-top:10;padding-bottom:10}.p-12{padding:12}.p-t-12{padding-top:12}.p-r-12{padding-right:12}.p-b-12{padding-bottom:12}.p-l-12{padding-left:12}.p-x-12{padding-right:12;padding-left:12}.p-y-12{padding-top:12;padding-bottom:12}.p-15{padding:15}.p-t-15{padding-top:15}.p-r-15{padding-right:15}.p-b-15{padding-bottom:15}.p-l-15{padding-left:15}.p-x-15{padding-right:15;padding-left:15}.p-y-15{padding-top:15;padding-bottom:15}.p-16{padding:16}.p-t-16{padding-top:16}.p-r-16{padding-right:16}.p-b-16{padding-bottom:16}.p-l-16{padding-left:16}.p-x-16{padding-right:16;padding-left:16}.p-y-16{padding-top:16;padding-bottom:16}.p-20{padding:20}.p-t-20{padding-top:20}.p-r-20{padding-right:20}.p-b-20{padding-bottom:20}.p-l-20{padding-left:20}.p-x-20{padding-right:20;padding-left:20}.p-y-20{padding-top:20;padding-bottom:20}.p-24{padding:24}.p-t-24{padding-top:24}.p-r-24{padding-right:24}.p-b-24{padding-bottom:24}.p-l-24{padding-left:24}.p-x-24{padding-right:24;padding-left:24}.p-y-24{padding-top:24;padding-bottom:24}.p-25{padding:25}.p-t-25{padding-top:25}.p-r-25{padding-right:25}.p-b-25{padding-bottom:25}.p-l-25{padding-left:25}.p-x-25{padding-right:25;padding-left:25}.p-y-25{padding-top:25;padding-bottom:25}.p-28{padding:28}.p-t-28{padding-top:28}.p-r-28{padding-right:28}.p-b-28{padding-bottom:28}.p-l-28{padding-left:28}.p-x-28{padding-right:28;padding-left:28}.p-y-28{padding-top:28;padding-bottom:28}.p-30{padding:30}.p-t-30{padding-top:30}.p-r-30{padding-right:30}.p-b-30{padding-bottom:30}.p-l-30{padding-left:30}.p-x-30{padding-right:30;padding-left:30}.p-y-30{padding-top:30;padding-bottom:30}.hr-light{height:1;background-color:#e0e0e0;width:100%}.hr-dark{height:1;background-color:#303030;width:100%}.text-left{text-align:left}.text-right{text-align:right}.text-center{text-align:center}.text-lowercase{text-transform:lowercase}.text-uppercase{text-transform:uppercase}.text-capitalize{text-transform:capitalize}.font-weight-normal{font-weight:normal}.font-weight-bold{font-weight:bold}.font-italic{font-style:italic}.t-10{font-size:10}.t-12{font-size:12}.t-14{font-size:14}.t-15{font-size:15}.t-16{font-size:16}.t-17{font-size:17}.t-18{font-size:18}.t-19{font-size:19}.t-20{font-size:20}.t-25{font-size:25}.t-30{font-size:30}.img-rounded{border-radius:5}.img-circle{border-radius:20}.img-thumbnail{border-radius:0}.invisible{visibility:collapse}.pull-left{horizontal-align:left}.pull-right{horizontal-align:right}.m-x-auto{horizontal-align:center}.m-y-auto{vertical-align:center}.text-primary{color:#30bcff}.text-danger{color:#d50000}.text-muted{color:#9e9e9e}.bg-primary{background-color:#30bcff;color:#fff}.bg-danger{background-color:#d50000;color:#fff}.action-bar{background-color:#F8F8F8;color:#212121}.action-bar .action-bar-title{font-weight:bold;font-size:17;vertical-align:center}.action-bar .action-item{font-weight:normal}.activity-indicator{color:#30bcff;width:30;height:30}.btn{color:#30bcff;background-color:transparent;min-height:36;min-width:64;padding:10 10 10 10;font-size:18;margin:8 16 8 16}.btn.btn-active:highlighted{color:#fff;background-color:#c0ebff}.btn-primary{background-color:#30bcff;border-color:#30bcff;color:#fff}.btn-primary.btn-active:highlighted{background-color:#01a0ec;border-color:#01a0ec}.btn-primary.btn-aqua{background-color:#00caab}.btn-primary.btn-blue{background-color:#3d5afe}.btn-primary.btn-brown{background-color:#795548}.btn-primary.btn-forest{background-color:#006968}.btn-primary.btn-grey{background-color:#5c687c}.btn-primary.btn-lemon{background-color:#ffea00;color:#000}.btn-primary.btn-lime{background-color:#aee406;color:#000}.btn-primary.btn-orange{background-color:#f57c00}.btn-primary.btn-purple{background-color:#8130ff}.btn-primary.btn-ruby{background-color:#ff1744}.btn-primary.btn-sky{background-color:#30bcff}.btn-outline{background-color:transparent;border-color:#30bcff;color:#30bcff}.btn-outline.btn-active:highlighted{background-color:#c0ebff}.btn[isEnabled=false]{color:#a4a4a4;background-color:#e0e0e0;border-color:#e0e0e0}.fa{font-family:FontAwesome, fontawesome-webfont}.form .input{padding:16 8 16 8;background-color:transparent}.form .input.input-border{border-width:1;border-color:#e0e0e0;border-radius:2;padding:16}.form .input.input-rounded{border-width:1;border-color:#e0e0e0;border-radius:28;padding:16}.form .input[isEnabled='false']{background-color:#fafafa}.form .input-field{margin:8}.form .input-field .label{font-size:12;color:#bababa}.form .input-field .input{padding:0;margin:0 0 8 0}.form .input-field .hr-light.active,.form .input-field .hr-dark.active{background-color:#30bcff}.form .input-field.input-sides .label{font-size:18;margin:0 0 8 0}.h1,.h2,.h3,.h4,.h5,.h6{margin-bottom:4;font-weight:normal;color:#212121}.body,.body2,.footnote{font-weight:normal;color:#757575}.h1{font-size:32}.h2{font-size:22}.h3{font-size:15}.h4{font-size:12}.h5{font-size:11}.h6{font-size:10}.body{font-size:14}.body2{font-size:17}.footnote{font-size:13}.list-group .list-group-item{color:#212121;font-size:16;margin:0;padding:16}.list-group .list-group-item Label{vertical-align:center}.list-group .list-group-item .thumb{stretch:fill;width:40;height:40;margin-right:16}.list-group .list-group-item.active{background-color:#e0e0e0}.list-group .list-group-item .list-group-item-text{color:#757575;font-size:14}.page{background-color:#fff}.progress{color:#30bcff;background-color:#bababa}.segmented-bar{font-size:13;background-color:#fff;color:#212121;selected-background-color:#30bcff}.sidedrawer-left,.sidedrawer-center{background-color:#fafafa}.sidedrawer-header{background-color:#fafafa;height:148;width:100%}.sidedrawer-left .sidedrawer-header{padding:16 16 0 16}.sidedrawer-center .sidedrawer-header{padding:20 15 0 15}.sidedrawer-header-image{background-color:#e0e0e0}.sidedrawer-left .sidedrawer-header-image{height:64;width:64;border-radius:32;horizontal-align:left;margin-bottom:36}.sidedrawer-center .sidedrawer-header-image{height:74;width:74;border-radius:37;horizontal-align:center;margin-bottom:24}.sidedrawer-header-brand{color:#737373}.sidedrawer-left .sidedrawer-header-brand{horizontal-align:left;font-size:14}.sidedrawer-center .sidedrawer-header-brand{horizontal-align:center;font-size:15}.sidedrawer-list-item{height:48;horizontal-align:left;width:100%;orientation:horizontal}.sidedrawer-list-item .sidedrawer-list-item-icon{width:24;text-align:center;font-size:20;height:48;vertical-align:center}.sidedrawer-list-item.active{color:#fff;background-color:#30bcff}.sidedrawer-list-item.active .sidedrawer-list-item-icon{color:#fff}.sidedrawer-left .sidedrawer-list-item-icon{margin:0 16 0 16}.sidedrawer-center .sidedrawer-list-item-icon{margin:0 0 0 15}.sidedrawer-list-item-text{horizontal-align:left;text-align:left;font-size:15;background-color:transparent;border-width:0.1;width:80%;vertical-align:center}.sidedrawer-left .sidedrawer-list-item-text{padding-left:16}.sidedrawer-center .sidedrawer-list-item-text{padding-left:15}.slider{background-color:#30bcff}.slider[isEnabled=false]{background-color:#e0e0e0;color:#e0e0e0}.switch[checked=true]{background-color:#30bcff;color:#30bcff}.switch[checked=true][isEnabled=false]{background-color:#e0e0e0;color:#fff}.switch[isEnabled=false]{background-color:#e0e0e0;color:#e0e0e0}.tab-view{selected-color:#30bcff;tabs-background-color:#fff}.tab-view .tab-view-item{background-color:#fff;tabs-background-color:#fff}#login-background{margin-top:-20;background-size:cover;background-position:center}.login-wrap{padding:0 40}.logo-wrap{margin:60 0 10 0;padding:20 0}.logo-wrap .login-logo{text-align:center;font-size:30;font-weight:bold;margin-bottom:10;opacity:1;color:#212121;opacity:.9}.logo-wrap .login-logo-sub{color:#212121;opacity:.8;text-align:center}.login-wrapper{padding:20;background-color:#fff;border-radius:3}.login-wrapper TextField{padding:10 10;margin:10 0 0 0}.go-back{font-size:14;text-align:center;color:#212121;margin-top:10}.btn{border-width:0;font-family:'SF UI Text Medium';font-size:15}.btn-outline{border-width:1}.btn-rounded-sm{border-radius:4}.btn-rounded-lg{border-radius:19}.form{font-family:'SF UI Text Regular'}.form .input{font-size:15}.form .input.input-rounded{border-radius:27}.h1{font-size:32}.slider{margin:10 15}.sidedrawer-list-item-icon,.sidedrawer-list-item{color:#949494}.switch{margin:8 15}.list-group .list-group-item{padding:16 15 16 15}.list-group .list-group-item .thumb{margin-right:15}.list-group .list-group-item .list-group-item-heading{margin-bottom:5}.segmented-bar{margin:0 15;color:#30bcff}\n", ""]);



/***/ }),

/***/ "../node_modules/css-loader/dist/runtime/api.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return '@media ' + item[2] + '{' + content + '}';
      } else {
        return content;
      }
    }).join('');
  }; // import a list of modules into the list


  list.i = function (modules, mediaQuery) {
    if (typeof modules === 'string') {
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    for (var i = 0; i < this.length; i++) {
      var id = this[i][0];

      if (id != null) {
        alreadyImportedModules[id] = true;
      }
    }

    for (i = 0; i < modules.length; i++) {
      var item = modules[i]; // skip already imported module
      // this implementation is not 100% perfect for weird media query combinations
      // when a module is imported multiple times with different media queries.
      // I hope this will never occur (Hey this way we have smaller bundles)

      if (item[0] == null || !alreadyImportedModules[item[0]]) {
        if (mediaQuery && !item[2]) {
          item[2] = mediaQuery;
        } else if (mediaQuery) {
          item[2] = '(' + item[2] + ') and (' + mediaQuery + ')';
        }

        list.push(item);
      }
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || '';
  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */';
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;
  return '/*# ' + data + ' */';
}

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/hmr-update.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
const hot = __webpack_require__("../node_modules/nativescript-dev-webpack/hot.js");
const file_system_1 = __webpack_require__("tns-core-modules/file-system");
function hmrUpdate() {
    const applicationFiles = file_system_1.knownFolders.currentApp();
    const latestHash = __webpack_require__["h"]();
    return hot(latestHash, filename => applicationFiles.getFile(filename));
}
exports.hmrUpdate = hmrUpdate;
//# sourceMappingURL=hmr-update.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hmr/index.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var hmr_update_1 = __webpack_require__("../node_modules/nativescript-dev-webpack/hmr/hmr-update.js");
exports.hmrUpdate = hmr_update_1.hmrUpdate;
//# sourceMappingURL=index.js.map

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/hot.js":
/***/ (function(module, exports, __webpack_require__) {

const hmrPrefix = 'HMR:';
const log = {
    info: (message) => console.info(`${hmrPrefix} ${message}`),
    warn: (message) => console.warn(`${hmrPrefix} ${message}`),
    error: (message) => console.error(`${hmrPrefix} ${message}`),
};
const refresh = 'Application needs to be restarted in order to apply the changes.';
const hotOptions = {
    ignoreUnaccepted: false,
    ignoreDeclined: false,
    ignoreErrored: false,
    onUnaccepted(data) {
        const chain = [].concat(data.chain);
        const last = chain[chain.length - 1];

        if (last === 0) {
            chain.pop();
        }

        log.warn(`Ignored an update to unaccepted module: `);
        chain.forEach(mod => log.warn(`         ➭ ${mod}`));
    },
    onDeclined(data) {
        log.warn(`Ignored an update to declined module:`);
        data.chain.forEach(mod => log.warn(`         ➭ ${mod}`));
    },
    onErrored(data) {
        log.warn(
            `Ignored an error while updating module ${data.moduleId} <${data.type}>`
        );
        log.warn(data.error);
    },
};

let nextHash;
let currentHash;

function upToDate() {
    return nextHash.indexOf(__webpack_require__.h()) >= 0;
}

function result(modules, appliedModules) {
    const unaccepted = modules.filter(
        (moduleId) => appliedModules && appliedModules.indexOf(moduleId) < 0
    );

    if (unaccepted.length > 0) {
        log.warn('The following modules could not be updated:');

        for (const moduleId of unaccepted) {
            log.warn(`          ⦻ ${moduleId}`);
        }
    }

    if (!(appliedModules || []).length) {
        log.info('No Modules Updated.');
    } else {
        log.info('The following modules were updated:');

        for (const moduleId of appliedModules) {
            log.info(`         ↻ ${moduleId}`);
        }

        const numberIds = appliedModules.every(
            (moduleId) => typeof moduleId === 'number'
        );
        if (numberIds) {
            log.info(
                'Please consider using the NamedModulesPlugin for module names.'
            );
        }
    }
}

function check(options) {
    return module.hot
        .check()
        .then((modules) => {
            if (!modules) {
                log.warn(
                    `Cannot find update. ${refresh}`
                );
                return null;
            }

            return module.hot
                .apply(hotOptions)
                .then((appliedModules) => {
                    let nextCheck;
                    if (!upToDate()) {
                        nextCheck = check(options);
                    }

                    result(modules, appliedModules);

                    if (upToDate()) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.info(`Successfully applied update with hmr hash ${currentHash}. App is up to date.`);
                    }

                    return nextCheck || null;
                })
                .catch((err) => {
                    const status = module.hot.status();
                    if (['abort', 'fail'].indexOf(status) >= 0) {
                        // Do not modify message - CLI depends on this exact content to determine hmr operation status.
                        log.error(`Cannot apply update with hmr hash ${currentHash}.`);
                        log.error(err.message || err.stack);
                    } else {
                        log.error(`Update failed: ${err.message || err.stack}`);
                    }
                });
        })
        .catch((err) => {
            const status = module.hot.status();
            if (['abort', 'fail'].indexOf(status) >= 0) {
                log.error(`Cannot check for update. ${refresh}`);
                log.error(err.message || err.stack);
            } else {
                log.error(`Update check failed: ${err.message || err.stack}`);
            }
        });
}

if (true) {
    log.info('Hot Module Replacement Enabled. Waiting for signal.');
} else {}

function update(latestHash, options) {
    nextHash = latestHash;
    if (!upToDate()) {
        const status = module.hot.status();

        if (status === 'idle') {
            //Do not modify message - CLI depends on this exact content to determine hmr operation status.
            log.info(`Checking for updates to the bundle with hmr hash ${currentHash}.`);
            return check(options);
        } else if (['abort', 'fail'].indexOf(status) >= 0) {
            log.warn(
                `Cannot apply update. A previous update ${status}ed. ${refresh}`
            );
        }
    }
};

function getNextHash(hash, getFileContent) {
    const file = getFileContent(`${hash}.hot-update.json`);
    return file.readText().then(hotUpdateContent => {
        if (hotUpdateContent) {
            const manifest = JSON.parse(hotUpdateContent);
            const newHash = manifest.h;
            return getNextHash(newHash, getFileContent);
        } else {
            return Promise.resolve(hash);
        }
    }).catch(error => Promise.reject(error));
}

module.exports = function checkState(initialHash, getFileContent) {
    currentHash = initialHash;
    return getNextHash(initialHash, getFileContent).then(nextHash => {
        if (nextHash != initialHash) {
            return update(nextHash, {});
        }
    })
}


/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css-angular.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {const loadCss = __webpack_require__("../node_modules/nativescript-dev-webpack/load-application-css.js");

module.exports = function() {
    loadCss(function() {
        global.registerModule("./app.css", () => __webpack_require__("./app.css"));
    });
}

/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/nativescript-dev-webpack/load-application-css.js":
/***/ (function(module, exports, __webpack_require__) {

module.exports = function (loadModuleFn) {
    const application = __webpack_require__("tns-core-modules/application");
    __webpack_require__("tns-core-modules/ui/styling/style-scope");

    loadModuleFn();

    application.loadAppCss();
}


/***/ }),

/***/ "../node_modules/tns-core-modules/application/application-common.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/globals.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var events = new observable_1.Observable();
var launched = false;
function setLaunched() {
    launched = true;
    events.off("launch", setLaunched);
}
events.on("launch", setLaunched);
if (profiling_1.level() > 0) {
    events.on("displayed", function () {
        var duration = profiling_1.uptime();
        var end = profiling_1.time();
        var start = end - duration;
        profiling_1.trace("Displayed in " + duration.toFixed(2) + "ms", start, end);
    });
}
function hasLaunched() {
    return launched;
}
exports.hasLaunched = hasLaunched;
exports.launchEvent = "launch";
exports.suspendEvent = "suspend";
exports.displayedEvent = "displayed";
exports.resumeEvent = "resume";
exports.exitEvent = "exit";
exports.lowMemoryEvent = "lowMemory";
exports.uncaughtErrorEvent = "uncaughtError";
exports.discardedErrorEvent = "discardedError";
exports.orientationChangedEvent = "orientationChanged";
var cssFile = "./app.css";
var resources = {};
function getResources() {
    return resources;
}
exports.getResources = getResources;
function setResources(res) {
    resources = res;
}
exports.setResources = setResources;
exports.android = undefined;
exports.ios = undefined;
exports.on = events.on.bind(events);
exports.off = events.off.bind(events);
exports.notify = events.notify.bind(events);
exports.hasListeners = events.hasListeners.bind(events);
var app;
function setApplication(instance) {
    app = instance;
}
exports.setApplication = setApplication;
function livesync(rootView, context) {
    events.notify({ eventName: "livesync", object: app });
    var liveSyncCore = global.__onLiveSyncCore;
    var reapplyAppStyles = false;
    if (context && context.path) {
        var styleExtensions = ["css", "scss"];
        var appStylesFullFileName = getCssFileName();
        var appStylesFileName_1 = appStylesFullFileName.substring(0, appStylesFullFileName.lastIndexOf(".") + 1);
        reapplyAppStyles = styleExtensions.some(function (ext) { return context.path === appStylesFileName_1.concat(ext); });
    }
    if (reapplyAppStyles && rootView) {
        rootView._onCssStateChange();
    }
    else if (liveSyncCore) {
        liveSyncCore(context);
    }
}
exports.livesync = livesync;
function setCssFileName(cssFileName) {
    cssFile = cssFileName;
    events.notify({ eventName: "cssChanged", object: app, cssFile: cssFileName });
}
exports.setCssFileName = setCssFileName;
function getCssFileName() {
    return cssFile;
}
exports.getCssFileName = getCssFileName;
function loadAppCss() {
    try {
        events.notify({ eventName: "loadAppCss", object: app, cssFile: getCssFileName() });
    }
    catch (e) {
        throw new Error("The file " + getCssFileName() + " couldn't be loaded! " +
            "You may need to register it inside ./app/vendor.ts.");
    }
}
exports.loadAppCss = loadAppCss;
function addCss(cssText) {
    events.notify({ eventName: "cssChanged", object: app, cssText: cssText });
}
exports.addCss = addCss;
global.__onUncaughtError = function (error) {
    events.notify({ eventName: exports.uncaughtErrorEvent, object: app, android: error, ios: error, error: error });
};
global.__onDiscardedError = function (error) {
    events.notify({ eventName: exports.discardedErrorEvent, object: app, error: error });
};
//# sourceMappingURL=application-common.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/application/application.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var application_common_1 = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/application/application-common.js"));
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var frame_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var getVisibleViewController = utils_1.ios.getVisibleViewController;
var Responder = UIResponder.extend({
    get window() {
        return iosApp ? iosApp.window : undefined;
    },
    set window(setWindow) {
    }
}, {
    protocols: [UIApplicationDelegate]
});
var NotificationObserver = (function (_super) {
    __extends(NotificationObserver, _super);
    function NotificationObserver() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NotificationObserver.initWithCallback = function (onReceiveCallback) {
        var observer = _super.new.call(this);
        observer._onReceiveCallback = onReceiveCallback;
        return observer;
    };
    NotificationObserver.prototype.onReceive = function (notification) {
        this._onReceiveCallback(notification);
    };
    NotificationObserver.ObjCExposedMethods = {
        "onReceive": { returns: interop.types.void, params: [NSNotification] }
    };
    return NotificationObserver;
}(NSObject));
var displayedOnce = false;
var displayedLinkTarget;
var displayedLink;
var CADisplayLinkTarget = (function (_super) {
    __extends(CADisplayLinkTarget, _super);
    function CADisplayLinkTarget() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CADisplayLinkTarget.prototype.onDisplayed = function (link) {
        link.invalidate();
        var ios = UIApplication.sharedApplication;
        var object = iosApp;
        displayedOnce = true;
        application_common_1.notify({ eventName: application_common_1.displayedEvent, object: object, ios: ios });
        displayedLinkTarget = null;
        displayedLink = null;
    };
    CADisplayLinkTarget.ObjCExposedMethods = {
        "onDisplayed": { returns: interop.types.void, params: [CADisplayLink] }
    };
    return CADisplayLinkTarget;
}(NSObject));
var IOSApplication = (function () {
    function IOSApplication() {
        this._currentOrientation = UIDevice.currentDevice.orientation;
        this._observers = new Array();
        this.addNotificationObserver(UIApplicationDidFinishLaunchingNotification, this.didFinishLaunchingWithOptions.bind(this));
        this.addNotificationObserver(UIApplicationDidBecomeActiveNotification, this.didBecomeActive.bind(this));
        this.addNotificationObserver(UIApplicationDidEnterBackgroundNotification, this.didEnterBackground.bind(this));
        this.addNotificationObserver(UIApplicationWillTerminateNotification, this.willTerminate.bind(this));
        this.addNotificationObserver(UIApplicationDidReceiveMemoryWarningNotification, this.didReceiveMemoryWarning.bind(this));
        this.addNotificationObserver(UIDeviceOrientationDidChangeNotification, this.orientationDidChange.bind(this));
    }
    Object.defineProperty(IOSApplication.prototype, "rootController", {
        get: function () {
            return this._window.rootViewController;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "nativeApp", {
        get: function () {
            return UIApplication.sharedApplication;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "window", {
        get: function () {
            return this._window;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "delegate", {
        get: function () {
            return this._delegate;
        },
        set: function (value) {
            if (this._delegate !== value) {
                this._delegate = value;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(IOSApplication.prototype, "rootView", {
        get: function () {
            return this._rootView;
        },
        enumerable: true,
        configurable: true
    });
    IOSApplication.prototype.addNotificationObserver = function (notificationName, onReceiveCallback) {
        var observer = NotificationObserver.initWithCallback(onReceiveCallback);
        NSNotificationCenter.defaultCenter.addObserverSelectorNameObject(observer, "onReceive", notificationName, null);
        this._observers.push(observer);
        return observer;
    };
    IOSApplication.prototype.removeNotificationObserver = function (observer, notificationName) {
        var index = this._observers.indexOf(observer);
        if (index >= 0) {
            this._observers.splice(index, 1);
            NSNotificationCenter.defaultCenter.removeObserverNameObject(observer, notificationName, null);
        }
    };
    IOSApplication.prototype.didFinishLaunchingWithOptions = function (notification) {
        if (!displayedOnce) {
            displayedLinkTarget = CADisplayLinkTarget.new();
            displayedLink = CADisplayLink.displayLinkWithTargetSelector(displayedLinkTarget, "onDisplayed");
            displayedLink.addToRunLoopForMode(NSRunLoop.mainRunLoop, NSDefaultRunLoopMode);
            displayedLink.addToRunLoopForMode(NSRunLoop.mainRunLoop, UITrackingRunLoopMode);
        }
        this._window = UIWindow.alloc().initWithFrame(UIScreen.mainScreen.bounds);
        this._window.backgroundColor = UIColor.whiteColor;
        this.notifyAppStarted(notification);
    };
    IOSApplication.prototype.notifyAppStarted = function (notification) {
        var args = {
            eventName: application_common_1.launchEvent,
            object: this,
            ios: notification && notification.userInfo && notification.userInfo.objectForKey("UIApplicationLaunchOptionsLocalNotificationKey") || null
        };
        application_common_1.notify(args);
        application_common_1.notify({ eventName: "loadAppCss", object: this, cssFile: application_common_1.getCssFileName() });
        if (this._window) {
            this.setWindowContent(args.root);
        }
        else {
            this._window = UIApplication.sharedApplication.delegate.window;
        }
    };
    IOSApplication.prototype.didBecomeActive = function (notification) {
        var ios = UIApplication.sharedApplication;
        var object = this;
        application_common_1.notify({ eventName: application_common_1.resumeEvent, object: object, ios: ios });
        var rootView = this._rootView;
        if (rootView && !rootView.isLoaded) {
            rootView.callLoaded();
        }
    };
    IOSApplication.prototype.didEnterBackground = function (notification) {
        application_common_1.notify({ eventName: application_common_1.suspendEvent, object: this, ios: UIApplication.sharedApplication });
        var rootView = this._rootView;
        if (rootView && rootView.isLoaded) {
            rootView.callUnloaded();
        }
    };
    IOSApplication.prototype.willTerminate = function (notification) {
        application_common_1.notify({ eventName: application_common_1.exitEvent, object: this, ios: UIApplication.sharedApplication });
        var rootView = this._rootView;
        if (rootView && rootView.isLoaded) {
            rootView.callUnloaded();
        }
    };
    IOSApplication.prototype.didReceiveMemoryWarning = function (notification) {
        application_common_1.notify({ eventName: application_common_1.lowMemoryEvent, object: this, ios: UIApplication.sharedApplication });
    };
    IOSApplication.prototype.orientationDidChange = function (notification) {
        var orientation = UIDevice.currentDevice.orientation;
        if (this._currentOrientation !== orientation) {
            this._currentOrientation = orientation;
            var newValue = void 0;
            switch (orientation) {
                case 4:
                case 3:
                    newValue = "landscape";
                    break;
                case 1:
                case 2:
                    newValue = "portrait";
                    break;
                default:
                    newValue = "unknown";
                    break;
            }
            application_common_1.notify({
                eventName: application_common_1.orientationChangedEvent,
                ios: this,
                newValue: newValue,
                object: this
            });
        }
    };
    IOSApplication.prototype._onLivesync = function (context) {
        var isAppRootModuleChanged = context && context.path && context.path.includes(getMainEntry().moduleName) && context.type !== "style";
        if (isAppRootModuleChanged || (this._rootView && !this._rootView._onLivesync(context))) {
            this.setWindowContent();
        }
    };
    IOSApplication.prototype.setWindowContent = function (view) {
        if (this._rootView) {
            this._rootView._onRootViewReset();
        }
        var rootView = createRootView(view);
        var controller = getViewController(rootView);
        this._rootView = rootView;
        if (createRootFrame.value) {
            rootView._setupUI({});
        }
        else {
            rootView._setupAsRootView({});
        }
        setViewControllerView(rootView);
        var haveController = this._window.rootViewController !== null;
        this._window.rootViewController = controller;
        if (!haveController) {
            this._window.makeKeyAndVisible();
        }
    };
    __decorate([
        profiling_1.profile
    ], IOSApplication.prototype, "didFinishLaunchingWithOptions", null);
    __decorate([
        profiling_1.profile
    ], IOSApplication.prototype, "didBecomeActive", null);
    return IOSApplication;
}());
var iosApp = new IOSApplication();
exports.ios = iosApp;
application_common_1.setApplication(iosApp);
global.__onLiveSyncCore = function (context) {
    iosApp._onLivesync(context);
};
var mainEntry;
function createRootView(v) {
    var rootView = v;
    if (!rootView) {
        if (!mainEntry) {
            throw new Error("Main entry is missing. App cannot be started. Verify app bootstrap.");
        }
        else {
            if (createRootFrame.value) {
                var frame = rootView = new frame_1.Frame();
                frame.navigate(mainEntry);
            }
            else {
                rootView = builder_1.createViewFromEntry(mainEntry);
            }
        }
    }
    return rootView;
}
function getMainEntry() {
    return mainEntry;
}
exports.getMainEntry = getMainEntry;
function getRootView() {
    return iosApp.rootView;
}
exports.getRootView = getRootView;
var createRootFrame = { value: true };
var started = false;
function _start(entry) {
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    started = true;
    if (!iosApp.nativeApp) {
        UIApplicationMain(0, null, null, iosApp && iosApp.delegate ? NSStringFromClass(iosApp.delegate) : NSStringFromClass(Responder));
    }
    else {
        var rootView = createRootView();
        if (rootView) {
            var window_1 = iosApp.nativeApp.keyWindow || (iosApp.nativeApp.windows.count > 0 && iosApp.nativeApp.windows[0]);
            if (window_1) {
                var rootController = window_1.rootViewController;
                if (rootController) {
                    var controller = getViewController(rootView);
                    rootView._setupAsRootView({});
                    var embedderDelegate = NativeScriptEmbedder.sharedInstance().delegate;
                    if (embedderDelegate) {
                        embedderDelegate.presentNativeScriptApp(controller);
                    }
                    else {
                        var visibleVC = getVisibleViewController(rootController);
                        visibleVC.presentViewControllerAnimatedCompletion(controller, true, null);
                    }
                    iosApp.notifyAppStarted();
                }
            }
        }
    }
}
exports._start = _start;
function run(entry) {
    createRootFrame.value = false;
    _start(entry);
}
exports.run = run;
function _resetRootView(entry) {
    createRootFrame.value = false;
    mainEntry = typeof entry === "string" ? { moduleName: entry } : entry;
    iosApp.setWindowContent();
}
exports._resetRootView = _resetRootView;
function getNativeApplication() {
    return iosApp.nativeApp;
}
exports.getNativeApplication = getNativeApplication;
function getViewController(view) {
    var viewController = view.viewController || view.ios;
    if (viewController instanceof UIViewController) {
        return viewController;
    }
    else {
        viewController = view_1.ios.UILayoutViewController.initWithOwner(new WeakRef(view));
        view.viewController = viewController;
        return viewController;
    }
}
function setViewControllerView(view) {
    var viewController = view.viewController || view.ios;
    var nativeView = view.ios || view.nativeViewProtected;
    if (!nativeView || !viewController) {
        throw new Error("Root should be either UIViewController or UIView");
    }
    if (viewController instanceof view_1.ios.UILayoutViewController) {
        viewController.view.addSubview(nativeView);
    }
}
global.__onLiveSync = function __onLiveSync(context) {
    if (!started) {
        return;
    }
    var rootView = getRootView();
    application_common_1.livesync(rootView, context);
};
//# sourceMappingURL=application.ios.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var knownColors = __webpack_require__("../node_modules/tns-core-modules/color/known-colors.js");
var SHARP = "#";
var HEX_REGEX = /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i;
var Color = (function () {
    function Color() {
        if (arguments.length === 1) {
            var arg = arguments[0];
            if (types.isString(arg)) {
                if (isRgbOrRgba(arg)) {
                    this._argb = argbFromRgbOrRgba(arg);
                }
                else if (knownColors.isKnownName(arg)) {
                    var hex = knownColors.getKnownColor(arg);
                    this._name = arg;
                    this._argb = this._argbFromString(hex);
                }
                else if (HEX_REGEX.test(arg)) {
                    var hex = this._normalizeHex(arg);
                    this._argb = this._argbFromString(hex);
                }
                else {
                    throw new Error("Invalid color: " + arg);
                }
            }
            else if (types.isNumber(arg)) {
                this._argb = arg >>> 0;
            }
            else {
                throw new Error("Expected 1 or 4 constructor parameters.");
            }
        }
        else if (arguments.length === 4) {
            this._argb = (arguments[0] & 0xFF) * 0x01000000
                + (arguments[1] & 0xFF) * 0x00010000
                + (arguments[2] & 0xFF) * 0x00000100
                + (arguments[3] & 0xFF) * 0x00000001;
        }
        else {
            throw new Error("Expected 1 or 4 constructor parameters.");
        }
    }
    Object.defineProperty(Color.prototype, "a", {
        get: function () { return (this._argb / 0x01000000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "r", {
        get: function () { return (this._argb / 0x00010000) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "g", {
        get: function () { return (this._argb / 0x00000100) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "b", {
        get: function () { return (this._argb / 0x00000001) & 0xFF; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "argb", {
        get: function () {
            return this._argb;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "hex", {
        get: function () {
            if (this.a === 0xFF) {
                return ("#" + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
            else {
                return ("#" + this._componentToHex(this.a) + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b)).toUpperCase();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "ios", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Color.prototype, "android", {
        get: function () {
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    Color.prototype._argbFromString = function (hex) {
        if (hex.charAt(0) === "#") {
            hex = hex.substr(1);
        }
        if (hex.length === 3) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
        }
        else if (hex.length === 4) {
            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2] + hex[3] + hex[3];
        }
        var intVal = parseInt(hex, 16);
        if (hex.length === 6) {
            intVal = (intVal & 0x00FFFFFF) + 0xFF000000;
        }
        return intVal;
    };
    Color.prototype.equals = function (value) {
        return value && this.argb === value.argb;
    };
    Color.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.equals(value2);
    };
    Color.isValid = function (value) {
        if (types.isNullOrUndefined(value) || value instanceof Color) {
            return true;
        }
        if (!types.isString(value)) {
            return false;
        }
        if (knownColors.isKnownName(value)) {
            return true;
        }
        return HEX_REGEX.test(value) || isRgbOrRgba(value);
    };
    Color.prototype._componentToHex = function (component) {
        var hex = component.toString(16);
        if (hex.length === 1) {
            hex = "0" + hex;
        }
        return hex;
    };
    Color.prototype._normalizeHex = function (hexStr) {
        if (hexStr.charAt(0) === SHARP && hexStr.length === 4) {
            hexStr = hexStr.charAt(0)
                + hexStr.charAt(1) + hexStr.charAt(1)
                + hexStr.charAt(2) + hexStr.charAt(2)
                + hexStr.charAt(3) + hexStr.charAt(3);
        }
        return hexStr;
    };
    Color.prototype.toString = function () {
        return this.hex;
    };
    return Color;
}());
exports.Color = Color;
function isRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    return (toLower.indexOf("rgb(") === 0 || toLower.indexOf("rgba(") === 0) && toLower.indexOf(")") === (toLower.length - 1);
}
function argbFromRgbOrRgba(value) {
    var toLower = value.toLowerCase();
    var parts = toLower.replace("rgba(", "").replace("rgb(", "").replace(")", "").trim().split(",");
    var r = 255;
    var g = 255;
    var b = 255;
    var a = 255;
    if (parts[0]) {
        r = parseInt(parts[0].trim());
    }
    if (parts[1]) {
        g = parseInt(parts[1].trim());
    }
    if (parts[2]) {
        b = parseInt(parts[2].trim());
    }
    if (parts[3]) {
        a = Math.round(parseFloat(parts[3].trim()) * 255);
    }
    return (a & 0xFF) * 0x01000000
        + (r & 0xFF) * 0x00010000
        + (g & 0xFF) * 0x00000100
        + (b & 0xFF) * 0x00000001;
}
//# sourceMappingURL=color-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/color.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var common = __webpack_require__("../node_modules/tns-core-modules/color/color-common.js");
var Color = (function (_super) {
    __extends(Color, _super);
    function Color() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Color.prototype, "ios", {
        get: function () {
            if (!this._ios) {
                this._ios = UIColor.alloc().initWithRedGreenBlueAlpha(this.r / 255, this.g / 255, this.b / 255, this.a / 255);
            }
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    return Color;
}(common.Color));
exports.Color = Color;
//# sourceMappingURL=color.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/color/known-colors.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _allColors = {};
function registerColor(name, value) {
    _allColors[name.toLowerCase()] = value;
    return value;
}
function isKnownName(name) {
    if (!name) {
        return undefined;
    }
    return name.toLowerCase() in _allColors;
}
exports.isKnownName = isKnownName;
function getKnownColor(name) {
    if (!name) {
        return undefined;
    }
    return _allColors[name.toLowerCase()];
}
exports.getKnownColor = getKnownColor;
exports.Transparent = registerColor("Transparent", "#00000000");
exports.AliceBlue = registerColor("AliceBlue", "#F0F8FF");
exports.AntiqueWhite = registerColor("AntiqueWhite", "#FAEBD7");
exports.Aqua = registerColor("Aqua", "#00FFFF");
exports.Aquamarine = registerColor("Aquamarine", "#7FFFD4");
exports.Azure = registerColor("Azure", "#F0FFFF");
exports.Beige = registerColor("Beige", "#F5F5DC");
exports.Bisque = registerColor("Bisque", "#FFE4C4");
exports.Black = registerColor("Black", "#000000");
exports.BlanchedAlmond = registerColor("BlanchedAlmond", "#FFEBCD");
exports.Blue = registerColor("Blue", "#0000FF");
exports.BlueViolet = registerColor("BlueViolet", "#8A2BE2");
exports.Brown = registerColor("Brown", "#A52A2A");
exports.BurlyWood = registerColor("BurlyWood", "#DEB887");
exports.CadetBlue = registerColor("CadetBlue", "#5F9EA0");
exports.Chartreuse = registerColor("Chartreuse", "#7FFF00");
exports.Chocolate = registerColor("Chocolate", "#D2691E");
exports.Coral = registerColor("Coral", "#FF7F50");
exports.CornflowerBlue = registerColor("CornflowerBlue", "#6495ED");
exports.Cornsilk = registerColor("Cornsilk", "#FFF8DC");
exports.Crimson = registerColor("Crimson", "#DC143C");
exports.Cyan = registerColor("Cyan", "#00FFFF");
exports.DarkBlue = registerColor("DarkBlue", "#00008B");
exports.DarkCyan = registerColor("DarkCyan", "#008B8B");
exports.DarkGoldenRod = registerColor("DarkGoldenRod", "#B8860B");
exports.DarkGray = registerColor("DarkGray", "#A9A9A9");
exports.DarkGreen = registerColor("DarkGreen", "#006400");
exports.DarkKhaki = registerColor("DarkKhaki", "#BDB76B");
exports.DarkMagenta = registerColor("DarkMagenta", "#8B008B");
exports.DarkOliveGreen = registerColor("DarkOliveGreen", "#556B2F");
exports.DarkOrange = registerColor("DarkOrange", "#FF8C00");
exports.DarkOrchid = registerColor("DarkOrchid", "#9932CC");
exports.DarkRed = registerColor("DarkRed", "#8B0000");
exports.DarkSalmon = registerColor("DarkSalmon", "#E9967A");
exports.DarkSeaGreen = registerColor("DarkSeaGreen", "#8FBC8F");
exports.DarkSlateBlue = registerColor("DarkSlateBlue", "#483D8B");
exports.DarkSlateGray = registerColor("DarkSlateGray", "#2F4F4F");
exports.DarkTurquoise = registerColor("DarkTurquoise", "#00CED1");
exports.DarkViolet = registerColor("DarkViolet", "#9400D3");
exports.DeepPink = registerColor("DeepPink", "#FF1493");
exports.DeepSkyBlue = registerColor("DeepSkyBlue", "#00BFFF");
exports.DimGray = registerColor("DimGray", "#696969");
exports.DodgerBlue = registerColor("DodgerBlue", "#1E90FF");
exports.FireBrick = registerColor("FireBrick", "#B22222");
exports.FloralWhite = registerColor("FloralWhite", "#FFFAF0");
exports.ForestGreen = registerColor("ForestGreen", "#228B22");
exports.Fuchsia = registerColor("Fuchsia", "#FF00FF");
exports.Gainsboro = registerColor("Gainsboro", "#DCDCDC");
exports.GhostWhite = registerColor("GhostWhite", "#F8F8FF");
exports.Gold = registerColor("Gold", "#FFD700");
exports.GoldenRod = registerColor("GoldenRod", "#DAA520");
exports.Gray = registerColor("Gray", "#808080");
exports.Green = registerColor("Green", "#008000");
exports.GreenYellow = registerColor("GreenYellow", "#ADFF2F");
exports.HoneyDew = registerColor("HoneyDew", "#F0FFF0");
exports.HotPink = registerColor("HotPink", "#FF69B4");
exports.IndianRed = registerColor("IndianRed", "#CD5C5C");
exports.Indigo = registerColor("Indigo", "#4B0082");
exports.Ivory = registerColor("Ivory", "#FFFFF0");
exports.Khaki = registerColor("Khaki", "#F0E68C");
exports.Lavender = registerColor("Lavender", "#E6E6FA");
exports.LavenderBlush = registerColor("LavenderBlush", "#FFF0F5");
exports.LawnGreen = registerColor("LawnGreen", "#7CFC00");
exports.LemonChiffon = registerColor("LemonChiffon", "#FFFACD");
exports.LightBlue = registerColor("LightBlue", "#ADD8E6");
exports.LightCoral = registerColor("LightCoral", "#F08080");
exports.LightCyan = registerColor("LightCyan", "#E0FFFF");
exports.LightGoldenRodYellow = registerColor("LightGoldenRodYellow", "#FAFAD2");
exports.LightGray = registerColor("LightGray", "#D3D3D3");
exports.LightGreen = registerColor("LightGreen", "#90EE90");
exports.LightPink = registerColor("LightPink", "#FFB6C1");
exports.LightSalmon = registerColor("LightSalmon", "#FFA07A");
exports.LightSeaGreen = registerColor("LightSeaGreen", "#20B2AA");
exports.LightSkyBlue = registerColor("LightSkyBlue", "#87CEFA");
exports.LightSlateGray = registerColor("LightSlateGray", "#778899");
exports.LightSteelBlue = registerColor("LightSteelBlue", "#B0C4DE");
exports.LightYellow = registerColor("LightYellow", "#FFFFE0");
exports.Lime = registerColor("Lime", "#00FF00");
exports.LimeGreen = registerColor("LimeGreen", "#32CD32");
exports.Linen = registerColor("Linen", "#FAF0E6");
exports.Magenta = registerColor("Magenta", "#FF00FF");
exports.Maroon = registerColor("Maroon", "#800000");
exports.MediumAquaMarine = registerColor("MediumAquaMarine", "#66CDAA");
exports.MediumBlue = registerColor("MediumBlue", "#0000CD");
exports.MediumOrchid = registerColor("MediumOrchid", "#BA55D3");
exports.MediumPurple = registerColor("MediumPurple", "#9370DB");
exports.MediumSeaGreen = registerColor("MediumSeaGreen", "#3CB371");
exports.MediumSlateBlue = registerColor("MediumSlateBlue", "#7B68EE");
exports.MediumSpringGreen = registerColor("MediumSpringGreen", "#00FA9A");
exports.MediumTurquoise = registerColor("MediumTurquoise", "#48D1CC");
exports.MediumVioletRed = registerColor("MediumVioletRed", "#C71585");
exports.MidnightBlue = registerColor("MidnightBlue", "#191970");
exports.MintCream = registerColor("MintCream", "#F5FFFA");
exports.MistyRose = registerColor("MistyRose", "#FFE4E1");
exports.Moccasin = registerColor("Moccasin", "#FFE4B5");
exports.NavajoWhite = registerColor("NavajoWhite", "#FFDEAD");
exports.Navy = registerColor("Navy", "#000080");
exports.OldLace = registerColor("OldLace", "#FDF5E6");
exports.Olive = registerColor("Olive", "#808000");
exports.OliveDrab = registerColor("OliveDrab", "#6B8E23");
exports.Orange = registerColor("Orange", "#FFA500");
exports.OrangeRed = registerColor("OrangeRed", "#FF4500");
exports.Orchid = registerColor("Orchid", "#DA70D6");
exports.PaleGoldenRod = registerColor("PaleGoldenRod", "#EEE8AA");
exports.PaleGreen = registerColor("PaleGreen", "#98FB98");
exports.PaleTurquoise = registerColor("PaleTurquoise", "#AFEEEE");
exports.PaleVioletRed = registerColor("PaleVioletRed", "#DB7093");
exports.PapayaWhip = registerColor("PapayaWhip", "#FFEFD5");
exports.PeachPuff = registerColor("PeachPuff", "#FFDAB9");
exports.Peru = registerColor("Peru", "#CD853F");
exports.Pink = registerColor("Pink", "#FFC0CB");
exports.Plum = registerColor("Plum", "#DDA0DD");
exports.PowderBlue = registerColor("PowderBlue", "#B0E0E6");
exports.Purple = registerColor("Purple", "#800080");
exports.RebeccaPurple = registerColor("RebeccaPurple", "#663399");
exports.Red = registerColor("Red", "#FF0000");
exports.RosyBrown = registerColor("RosyBrown", "#BC8F8F");
exports.RoyalBlue = registerColor("RoyalBlue", "#4169E1");
exports.SaddleBrown = registerColor("SaddleBrown", "#8B4513");
exports.Salmon = registerColor("Salmon", "#FA8072");
exports.SandyBrown = registerColor("SandyBrown", "#F4A460");
exports.SeaGreen = registerColor("SeaGreen", "#2E8B57");
exports.SeaShell = registerColor("SeaShell", "#FFF5EE");
exports.Sienna = registerColor("Sienna", "#A0522D");
exports.Silver = registerColor("Silver", "#C0C0C0");
exports.SkyBlue = registerColor("SkyBlue", "#87CEEB");
exports.SlateBlue = registerColor("SlateBlue", "#6A5ACD");
exports.SlateGray = registerColor("SlateGray", "#708090");
exports.Snow = registerColor("Snow", "#FFFAFA");
exports.SpringGreen = registerColor("SpringGreen", "#00FF7F");
exports.SteelBlue = registerColor("SteelBlue", "#4682B4");
exports.Tan = registerColor("Tan", "#D2B48C");
exports.Teal = registerColor("Teal", "#008080");
exports.Thistle = registerColor("Thistle", "#D8BFD8");
exports.Tomato = registerColor("Tomato", "#FF6347");
exports.Turquoise = registerColor("Turquoise", "#40E0D0");
exports.Violet = registerColor("Violet", "#EE82EE");
exports.Wheat = registerColor("Wheat", "#F5DEB3");
exports.White = registerColor("White", "#FFFFFF");
exports.WhiteSmoke = registerColor("WhiteSmoke", "#F5F5F5");
exports.Yellow = registerColor("Yellow", "#FFFF00");
exports.YellowGreen = registerColor("YellowGreen", "#9ACD32");
//# sourceMappingURL=known-colors.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/console/console.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var Console = (function () {
    function Console() {
    }
    Console.prototype.time = function (reportName) {
    };
    Console.prototype.timeEnd = function (reportName) {
    };
    Console.prototype.assert = function (test, message) {
    };
    Console.prototype.info = function (message) {
    };
    Console.prototype.warn = function (message) {
    };
    Console.prototype.error = function (message) {
    };
    Console.prototype.log = function (message) {
    };
    Console.prototype.trace = function () {
    };
    Console.prototype.dir = function (obj) {
    };
    return Console;
}());
exports.Console = Console;
//# sourceMappingURL=console.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/css-value/index.js":
/***/ (function(module, exports) {


exports.parse = parse;

function parse(str) {
  return new Parser(str).parse();
}

function Parser(str) {
  this.str = str;
}

Parser.prototype.skip = function(m){
  this.str = this.str.slice(m[0].length);
};

Parser.prototype.comma = function(){
  var m = /^, */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return { type: 'comma', string: ',' };
};

Parser.prototype.ident = function(){
  var m = /^([\w-]+) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  return {
    type: 'ident',
    string: m[1]
  }
};

Parser.prototype.int = function(){
  var m = /^(([-\+]?\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = ~~m[2];
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.float = function(){
  var m = /^(((?:[-\+]?\d+)?\.\d+)(\S+)?) */.exec(this.str);
  if (!m) return;
  this.skip(m);
  var n = parseFloat(m[2]);
  var u = m[3];

  return {
    type: 'number',
    string: m[1],
    unit: u || '',
    value: n
  }
};

Parser.prototype.number = function(){
  return this.float() || this.int();
};

Parser.prototype.double = function(){
  var m = /^"([^"]*)" */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: '"',
    string: '"' + m[1] + '"',
    value: m[1]
  }
};

Parser.prototype.single = function(){
  var m = /^'([^']*)' */.exec(this.str);
  if (!m) return m;
  this.skip(m);
  return {
    type: 'string',
    quote: "'",
    string: "'" + m[1] + "'",
    value: m[1]
  }
};

Parser.prototype.string = function(){
  return this.single() || this.double();
};


Parser.prototype.value = function(){
  return this.number()
    || this.ident()
    || this.string()
    || this.comma();
};

Parser.prototype.parse = function(){
  var vals = [];

  while (this.str.length) {
    var obj = this.value();
    if (!obj) throw new Error('failed to parse near `' + this.str.slice(0, 10) + '...`');
    vals.push(obj);
  }

  return vals;
};


/***/ }),

/***/ "../node_modules/tns-core-modules/css/index.js":
/***/ (function(module, exports, __webpack_require__) {

exports.parse = __webpack_require__("../node_modules/tns-core-modules/css/lib/parse/index.js");


/***/ }),

/***/ "../node_modules/tns-core-modules/css/lib/parse/index.js":
/***/ (function(module, exports) {

// http://www.w3.org/TR/CSS21/grammar.html
// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027
var commentre = /\/\*[^*]*\*+([^/*][^*]*\*+)*\//g

module.exports = function(css, options){
  options = options || {};

  /**
   * Positional.
   */

  var lineno = 1;
  var column = 1;

  /**
   * Update lineno and column based on `str`.
   */

  function updatePosition(str) {
    var lines = str.match(/\n/g);
    if (lines) lineno += lines.length;
    var i = str.lastIndexOf('\n');
    column = ~i ? str.length - i : column + str.length;
  }

  /**
   * Mark position and patch `node.position`.
   */

  function position() {
    var start = { line: lineno, column: column };
    return function(node){
      node.position = new Position(start);
      whitespace();
      return node;
    };
  }

  /**
   * Store position information for a node
   */

  function Position(start) {
    this.start = start;
    this.end = { line: lineno, column: column };
    this.source = options.source;
  }

  /**
   * Non-enumerable source string
   */

  Position.prototype.content = css;

  /**
   * Error `msg`.
   */

  var errorsList = [];

  function error(msg) {
    var err = new Error(options.source + ':' + lineno + ':' + column + ': ' + msg);
    err.reason = msg;
    err.filename = options.source;
    err.line = lineno;
    err.column = column;
    err.source = css;

    if (options.silent) {
      errorsList.push(err);
    } else {
      throw err;
    }
  }

  /**
   * Parse stylesheet.
   */

  function stylesheet() {
    var rulesList = rules();

    return {
      type: 'stylesheet',
      stylesheet: {
        rules: rulesList,
        parsingErrors: errorsList
      }
    };
  }

  /**
   * Opening brace.
   */

  function open() {
    return match(/^{\s*/);
  }

  /**
   * Closing brace.
   */

  function close() {
    return match(/^}/);
  }

  /**
   * Parse ruleset.
   */

  function rules() {
    var node;
    var rules = [];
    whitespace();
    comments(rules);
    while (css.length && css.charAt(0) != '}' && (node = atrule() || rule())) {
      if (node !== false) {
        rules.push(node);
        comments(rules);
      }
    }
    return rules;
  }

  /**
   * Match `re` and return captures.
   */

  function match(re) {
    var m = re.exec(css);
    if (!m) return;
    var str = m[0];
    updatePosition(str);
    css = css.slice(str.length);
    return m;
  }

  /**
   * Parse whitespace.
   */

  function whitespace() {
    match(/^\s*/);
  }

  /**
   * Parse comments;
   */

  function comments(rules) {
    var c;
    rules = rules || [];
    while (c = comment()) {
      if (c !== false) {
        rules.push(c);
      }
    }
    return rules;
  }

  /**
   * Parse comment.
   */

  function comment() {
    var pos = position();
    if ('/' != css.charAt(0) || '*' != css.charAt(1)) return;

    var i = 2;
    while ("" != css.charAt(i) && ('*' != css.charAt(i) || '/' != css.charAt(i + 1))) ++i;
    i += 2;

    if ("" === css.charAt(i-1)) {
      return error('End of comment missing');
    }

    var str = css.slice(2, i - 2);
    column += 2;
    updatePosition(str);
    css = css.slice(i);
    column += 2;

    return pos({
      type: 'comment',
      comment: str
    });
  }

  /**
   * Parse selector.
   */

  function selector() {
    var m = match(/^([^{]+)/);
    if (!m) return;
    /* @fix Remove all comments from selectors
     * http://ostermiller.org/findcomment.html */
    return trim(m[0])
      .replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g, '')
      .replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g, function(m) {
        return m.replace(/,/g, '\u200C');
      })
      .split(/\s*(?![^(]*\)),\s*/)
      .map(function(s) {
        return s.replace(/\u200C/g, ',');
      });
  }

  /**
   * Parse declaration.
   */

  function declaration() {
    var pos = position();

    // prop
    var prop = match(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);
    if (!prop) return;
    prop = trim(prop[0]);

    // :
    if (!match(/^:\s*/)) return error("property missing ':'");

    // val
    var val = match(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/);

    var ret = pos({
      type: 'declaration',
      property: prop.replace(commentre, ''),
      value: val ? trim(val[0]).replace(commentre, '') : ''
    });

    // ;
    match(/^[;\s]*/);

    return ret;
  }

  /**
   * Parse declarations.
   */

  function declarations() {
    var decls = [];

    if (!open()) return error("missing '{'");
    comments(decls);

    // declarations
    var decl;
    while (decl = declaration()) {
      if (decl !== false) {
        decls.push(decl);
        comments(decls);
      }
    }

    if (!close()) return error("missing '}'");
    return decls;
  }

  /**
   * Parse keyframe.
   */

  function keyframe() {
    var m;
    var vals = [];
    var pos = position();

    while (m = match(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/)) {
      vals.push(m[1]);
      match(/^,\s*/);
    }

    if (!vals.length) return;

    return pos({
      type: 'keyframe',
      values: vals,
      declarations: declarations()
    });
  }

  /**
   * Parse keyframes.
   */

  function atkeyframes() {
    var pos = position();
    var m = match(/^@([-\w]+)?keyframes\s*/);

    if (!m) return;
    var vendor = m[1];

    // identifier
    var m = match(/^([-\w]+)\s*/);
    if (!m) return error("@keyframes missing name");
    var name = m[1];

    if (!open()) return error("@keyframes missing '{'");

    var frame;
    var frames = comments();
    while (frame = keyframe()) {
      frames.push(frame);
      frames = frames.concat(comments());
    }

    if (!close()) return error("@keyframes missing '}'");

    return pos({
      type: 'keyframes',
      name: name,
      vendor: vendor,
      keyframes: frames
    });
  }

  /**
   * Parse supports.
   */

  function atsupports() {
    var pos = position();
    var m = match(/^@supports *([^{]+)/);

    if (!m) return;
    var supports = trim(m[1]);

    if (!open()) return error("@supports missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@supports missing '}'");

    return pos({
      type: 'supports',
      supports: supports,
      rules: style
    });
  }

  /**
   * Parse host.
   */

  function athost() {
    var pos = position();
    var m = match(/^@host\s*/);

    if (!m) return;

    if (!open()) return error("@host missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@host missing '}'");

    return pos({
      type: 'host',
      rules: style
    });
  }

  /**
   * Parse media.
   */

  function atmedia() {
    var pos = position();
    var m = match(/^@media *([^{]+)/);

    if (!m) return;
    var media = trim(m[1]);

    if (!open()) return error("@media missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@media missing '}'");

    return pos({
      type: 'media',
      media: media,
      rules: style
    });
  }


  /**
   * Parse custom-media.
   */

  function atcustommedia() {
    var pos = position();
    var m = match(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);
    if (!m) return;

    return pos({
      type: 'custom-media',
      name: trim(m[1]),
      media: trim(m[2])
    });
  }

  /**
   * Parse paged media.
   */

  function atpage() {
    var pos = position();
    var m = match(/^@page */);
    if (!m) return;

    var sel = selector() || [];

    if (!open()) return error("@page missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@page missing '}'");

    return pos({
      type: 'page',
      selectors: sel,
      declarations: decls
    });
  }

  /**
   * Parse document.
   */

  function atdocument() {
    var pos = position();
    var m = match(/^@([-\w]+)?document *([^{]+)/);
    if (!m) return;

    var vendor = trim(m[1]);
    var doc = trim(m[2]);

    if (!open()) return error("@document missing '{'");

    var style = comments().concat(rules());

    if (!close()) return error("@document missing '}'");

    return pos({
      type: 'document',
      document: doc,
      vendor: vendor,
      rules: style
    });
  }

  /**
   * Parse font-face.
   */

  function atfontface() {
    var pos = position();
    var m = match(/^@font-face\s*/);
    if (!m) return;

    if (!open()) return error("@font-face missing '{'");
    var decls = comments();

    // declarations
    var decl;
    while (decl = declaration()) {
      decls.push(decl);
      decls = decls.concat(comments());
    }

    if (!close()) return error("@font-face missing '}'");

    return pos({
      type: 'font-face',
      declarations: decls
    });
  }

  /**
   * Parse import
   */

  var atimport = _compileAtrule('import');

  /**
   * Parse charset
   */

  var atcharset = _compileAtrule('charset');

  /**
   * Parse namespace
   */

  var atnamespace = _compileAtrule('namespace');

  /**
   * Parse non-block at-rules
   */


  function _compileAtrule(name) {
    var re = new RegExp('^@' + name + '\\s*([^;]+);');
    return function() {
      var pos = position();
      var m = match(re);
      if (!m) return;
      var ret = { type: name };
      ret[name] = m[1].trim();
      return pos(ret);
    }
  }

  /**
   * Parse at rule.
   */

  function atrule() {
    if (css[0] != '@') return;

    return atkeyframes()
      || atmedia()
      || atcustommedia()
      || atsupports()
      || atimport()
      || atcharset()
      || atnamespace()
      || atdocument()
      || atpage()
      || athost()
      || atfontface();
  }

  /**
   * Parse rule.
   */

  function rule() {
    var pos = position();
    var sel = selector();

    if (!sel) return error('selector missing');
    comments();

    return pos({
      type: 'rule',
      selectors: sel,
      declarations: declarations()
    });
  }

  return addParent(stylesheet());
};

/**
 * Trim `str`.
 */

function trim(str) {
  return str ? str.replace(/^\s+|\s+$/g, '') : '';
}

/**
 * Adds non-enumerable parent node reference to each node.
 */

function addParent(obj, parent) {
  var isNode = obj && typeof obj.type === 'string';
  var childParent = isNode ? obj : parent;

  for (var k in obj) {
    var value = obj[k];
    if (Array.isArray(value)) {
      value.forEach(function(v) { addParent(v, childParent); });
    } else if (value && typeof value === 'object') {
      addParent(value, childParent);
    }
  }

  if (isNode) {
    Object.defineProperty(obj, 'parent', {
      configurable: true,
      writable: true,
      enumerable: false,
      value: parent || null
    });
  }

  return obj;
}


/***/ }),

/***/ "../node_modules/tns-core-modules/css/parser.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var urlRegEx = /\s*url\((?:('|")([^\1]*)\1|([^\)]*))\)\s*/gy;
function parseURL(text, start) {
    if (start === void 0) { start = 0; }
    urlRegEx.lastIndex = start;
    var result = urlRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = urlRegEx.lastIndex;
    var value = result[2] || result[3];
    return { start: start, end: end, value: value };
}
exports.parseURL = parseURL;
var hexColorRegEx = /\s*#((?:[0-9A-F]{8})|(?:[0-9A-F]{6})|(?:[0-9A-F]{3}))\s*/giy;
function parseHexColor(text, start) {
    if (start === void 0) { start = 0; }
    hexColorRegEx.lastIndex = start;
    var result = hexColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = hexColorRegEx.lastIndex;
    var hex = result[1];
    var argb;
    if (hex.length === 8) {
        argb = parseInt("0x" + hex);
    }
    else if (hex.length === 6) {
        argb = parseInt("0xFF" + hex);
    }
    else if (hex.length === 3) {
        argb = parseInt("0xFF" + hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2]);
    }
    return { start: start, end: end, value: argb };
}
exports.parseHexColor = parseHexColor;
function rgbaToArgbNumber(r, g, b, a) {
    if (a === void 0) { a = 1; }
    if (r >= 0 && r <= 255 && g >= 0 && g <= 255 && b >= 0 && b <= 255 && a >= 0 && a <= 1) {
        return (Math.round(a * 0xFF) * 0x01000000) + (r * 0x010000) + (g * 0x000100) + (b * 0x000001);
    }
    else {
        return null;
    }
}
var rgbColorRegEx = /\s*(rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\))/gy;
function parseRGBColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbColorRegEx.lastIndex = start;
    var result = rgbColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbColorRegEx.lastIndex;
    var value = result[1] && rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]));
    return { start: start, end: end, value: value };
}
exports.parseRGBColor = parseRGBColor;
var rgbaColorRegEx = /\s*(rgba\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*,\s*([01]?\.?\d*)\s*\))/gy;
function parseRGBAColor(text, start) {
    if (start === void 0) { start = 0; }
    rgbaColorRegEx.lastIndex = start;
    var result = rgbaColorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = rgbaColorRegEx.lastIndex;
    var value = rgbaToArgbNumber(parseInt(result[2]), parseInt(result[3]), parseInt(result[4]), parseFloat(result[5]));
    return { start: start, end: end, value: value };
}
exports.parseRGBAColor = parseRGBAColor;
var colors;
(function (colors) {
    colors[colors["transparent"] = 0] = "transparent";
    colors[colors["aliceblue"] = 4293982463] = "aliceblue";
    colors[colors["antiquewhite"] = 4294634455] = "antiquewhite";
    colors[colors["aqua"] = 4278255615] = "aqua";
    colors[colors["aquamarine"] = 4286578644] = "aquamarine";
    colors[colors["azure"] = 4293984255] = "azure";
    colors[colors["beige"] = 4294309340] = "beige";
    colors[colors["bisque"] = 4294960324] = "bisque";
    colors[colors["black"] = 4278190080] = "black";
    colors[colors["blanchedalmond"] = 4294962125] = "blanchedalmond";
    colors[colors["blue"] = 4278190335] = "blue";
    colors[colors["blueviolet"] = 4287245282] = "blueviolet";
    colors[colors["brown"] = 4289014314] = "brown";
    colors[colors["burlywood"] = 4292786311] = "burlywood";
    colors[colors["cadetblue"] = 4284456608] = "cadetblue";
    colors[colors["chartreuse"] = 4286578432] = "chartreuse";
    colors[colors["chocolate"] = 4291979550] = "chocolate";
    colors[colors["coral"] = 4294934352] = "coral";
    colors[colors["cornflowerblue"] = 4284782061] = "cornflowerblue";
    colors[colors["cornsilk"] = 4294965468] = "cornsilk";
    colors[colors["crimson"] = 4292613180] = "crimson";
    colors[colors["cyan"] = 4278255615] = "cyan";
    colors[colors["darkblue"] = 4278190219] = "darkblue";
    colors[colors["darkcyan"] = 4278225803] = "darkcyan";
    colors[colors["darkgoldenrod"] = 4290283019] = "darkgoldenrod";
    colors[colors["darkgray"] = 4289309097] = "darkgray";
    colors[colors["darkgreen"] = 4278215680] = "darkgreen";
    colors[colors["darkgrey"] = 4289309097] = "darkgrey";
    colors[colors["darkkhaki"] = 4290623339] = "darkkhaki";
    colors[colors["darkmagenta"] = 4287299723] = "darkmagenta";
    colors[colors["darkolivegreen"] = 4283788079] = "darkolivegreen";
    colors[colors["darkorange"] = 4294937600] = "darkorange";
    colors[colors["darkorchid"] = 4288230092] = "darkorchid";
    colors[colors["darkred"] = 4287299584] = "darkred";
    colors[colors["darksalmon"] = 4293498490] = "darksalmon";
    colors[colors["darkseagreen"] = 4287609999] = "darkseagreen";
    colors[colors["darkslateblue"] = 4282924427] = "darkslateblue";
    colors[colors["darkslategray"] = 4281290575] = "darkslategray";
    colors[colors["darkslategrey"] = 4281290575] = "darkslategrey";
    colors[colors["darkturquoise"] = 4278243025] = "darkturquoise";
    colors[colors["darkviolet"] = 4287889619] = "darkviolet";
    colors[colors["deeppink"] = 4294907027] = "deeppink";
    colors[colors["deepskyblue"] = 4278239231] = "deepskyblue";
    colors[colors["dimgray"] = 4285098345] = "dimgray";
    colors[colors["dimgrey"] = 4285098345] = "dimgrey";
    colors[colors["dodgerblue"] = 4280193279] = "dodgerblue";
    colors[colors["firebrick"] = 4289864226] = "firebrick";
    colors[colors["floralwhite"] = 4294966000] = "floralwhite";
    colors[colors["forestgreen"] = 4280453922] = "forestgreen";
    colors[colors["fuchsia"] = 4294902015] = "fuchsia";
    colors[colors["gainsboro"] = 4292664540] = "gainsboro";
    colors[colors["ghostwhite"] = 4294506751] = "ghostwhite";
    colors[colors["gold"] = 4294956800] = "gold";
    colors[colors["goldenrod"] = 4292519200] = "goldenrod";
    colors[colors["gray"] = 4286611584] = "gray";
    colors[colors["green"] = 4278222848] = "green";
    colors[colors["greenyellow"] = 4289593135] = "greenyellow";
    colors[colors["grey"] = 4286611584] = "grey";
    colors[colors["honeydew"] = 4293984240] = "honeydew";
    colors[colors["hotpink"] = 4294928820] = "hotpink";
    colors[colors["indianred"] = 4291648604] = "indianred";
    colors[colors["indigo"] = 4283105410] = "indigo";
    colors[colors["ivory"] = 4294967280] = "ivory";
    colors[colors["khaki"] = 4293977740] = "khaki";
    colors[colors["lavender"] = 4293322490] = "lavender";
    colors[colors["lavenderblush"] = 4294963445] = "lavenderblush";
    colors[colors["lawngreen"] = 4286381056] = "lawngreen";
    colors[colors["lemonchiffon"] = 4294965965] = "lemonchiffon";
    colors[colors["lightblue"] = 4289583334] = "lightblue";
    colors[colors["lightcoral"] = 4293951616] = "lightcoral";
    colors[colors["lightcyan"] = 4292935679] = "lightcyan";
    colors[colors["lightgoldenrodyellow"] = 4294638290] = "lightgoldenrodyellow";
    colors[colors["lightgray"] = 4292072403] = "lightgray";
    colors[colors["lightgreen"] = 4287688336] = "lightgreen";
    colors[colors["lightgrey"] = 4292072403] = "lightgrey";
    colors[colors["lightpink"] = 4294948545] = "lightpink";
    colors[colors["lightsalmon"] = 4294942842] = "lightsalmon";
    colors[colors["lightseagreen"] = 4280332970] = "lightseagreen";
    colors[colors["lightskyblue"] = 4287090426] = "lightskyblue";
    colors[colors["lightslategray"] = 4286023833] = "lightslategray";
    colors[colors["lightslategrey"] = 4286023833] = "lightslategrey";
    colors[colors["lightsteelblue"] = 4289774814] = "lightsteelblue";
    colors[colors["lightyellow"] = 4294967264] = "lightyellow";
    colors[colors["lime"] = 4278255360] = "lime";
    colors[colors["limegreen"] = 4281519410] = "limegreen";
    colors[colors["linen"] = 4294635750] = "linen";
    colors[colors["magenta"] = 4294902015] = "magenta";
    colors[colors["maroon"] = 4286578688] = "maroon";
    colors[colors["mediumaquamarine"] = 4284927402] = "mediumaquamarine";
    colors[colors["mediumblue"] = 4278190285] = "mediumblue";
    colors[colors["mediumorchid"] = 4290401747] = "mediumorchid";
    colors[colors["mediumpurple"] = 4287852763] = "mediumpurple";
    colors[colors["mediumseagreen"] = 4282168177] = "mediumseagreen";
    colors[colors["mediumslateblue"] = 4286277870] = "mediumslateblue";
    colors[colors["mediumspringgreen"] = 4278254234] = "mediumspringgreen";
    colors[colors["mediumturquoise"] = 4282962380] = "mediumturquoise";
    colors[colors["mediumvioletred"] = 4291237253] = "mediumvioletred";
    colors[colors["midnightblue"] = 4279834992] = "midnightblue";
    colors[colors["mintcream"] = 4294311930] = "mintcream";
    colors[colors["mistyrose"] = 4294960353] = "mistyrose";
    colors[colors["moccasin"] = 4294960309] = "moccasin";
    colors[colors["navajowhite"] = 4294958765] = "navajowhite";
    colors[colors["navy"] = 4278190208] = "navy";
    colors[colors["oldlace"] = 4294833638] = "oldlace";
    colors[colors["olive"] = 4286611456] = "olive";
    colors[colors["olivedrab"] = 4285238819] = "olivedrab";
    colors[colors["orange"] = 4294944000] = "orange";
    colors[colors["orangered"] = 4294919424] = "orangered";
    colors[colors["orchid"] = 4292505814] = "orchid";
    colors[colors["palegoldenrod"] = 4293847210] = "palegoldenrod";
    colors[colors["palegreen"] = 4288215960] = "palegreen";
    colors[colors["paleturquoise"] = 4289720046] = "paleturquoise";
    colors[colors["palevioletred"] = 4292571283] = "palevioletred";
    colors[colors["papayawhip"] = 4294963157] = "papayawhip";
    colors[colors["peachpuff"] = 4294957753] = "peachpuff";
    colors[colors["peru"] = 4291659071] = "peru";
    colors[colors["pink"] = 4294951115] = "pink";
    colors[colors["plum"] = 4292714717] = "plum";
    colors[colors["powderblue"] = 4289781990] = "powderblue";
    colors[colors["purple"] = 4286578816] = "purple";
    colors[colors["rebeccapurple"] = 4284887961] = "rebeccapurple";
    colors[colors["red"] = 4294901760] = "red";
    colors[colors["rosybrown"] = 4290547599] = "rosybrown";
    colors[colors["royalblue"] = 4282477025] = "royalblue";
    colors[colors["saddlebrown"] = 4287317267] = "saddlebrown";
    colors[colors["salmon"] = 4294606962] = "salmon";
    colors[colors["sandybrown"] = 4294222944] = "sandybrown";
    colors[colors["seagreen"] = 4281240407] = "seagreen";
    colors[colors["seashell"] = 4294964718] = "seashell";
    colors[colors["sienna"] = 4288696877] = "sienna";
    colors[colors["silver"] = 4290822336] = "silver";
    colors[colors["skyblue"] = 4287090411] = "skyblue";
    colors[colors["slateblue"] = 4285160141] = "slateblue";
    colors[colors["slategray"] = 4285563024] = "slategray";
    colors[colors["slategrey"] = 4285563024] = "slategrey";
    colors[colors["snow"] = 4294966010] = "snow";
    colors[colors["springgreen"] = 4278255487] = "springgreen";
    colors[colors["steelblue"] = 4282811060] = "steelblue";
    colors[colors["tan"] = 4291998860] = "tan";
    colors[colors["teal"] = 4278222976] = "teal";
    colors[colors["thistle"] = 4292394968] = "thistle";
    colors[colors["tomato"] = 4294927175] = "tomato";
    colors[colors["turquoise"] = 4282441936] = "turquoise";
    colors[colors["violet"] = 4293821166] = "violet";
    colors[colors["wheat"] = 4294303411] = "wheat";
    colors[colors["white"] = 4294967295] = "white";
    colors[colors["whitesmoke"] = 4294309365] = "whitesmoke";
    colors[colors["yellow"] = 4294967040] = "yellow";
    colors[colors["yellowgreen"] = 4288335154] = "yellowgreen";
})(colors = exports.colors || (exports.colors = {}));
function parseColorKeyword(value, start, keyword) {
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && keyword.value in colors) {
        var end = keyword.end;
        var value_1 = colors[keyword.value];
        return { start: start, end: end, value: value_1 };
    }
    return null;
}
exports.parseColorKeyword = parseColorKeyword;
function parseColor(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    return parseHexColor(value, start) || parseColorKeyword(value, start, keyword) || parseRGBColor(value, start) || parseRGBAColor(value, start);
}
exports.parseColor = parseColor;
var keywordRegEx = /\s*([a-z][\w\-]*)\s*/giy;
function parseKeyword(text, start) {
    if (start === void 0) { start = 0; }
    keywordRegEx.lastIndex = start;
    var result = keywordRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = keywordRegEx.lastIndex;
    var value = result[1];
    return { start: start, end: end, value: value };
}
var backgroundRepeatKeywords = new Set(["repeat", "repeat-x", "repeat-y", "no-repeat"]);
function parseRepeat(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    if (keyword && backgroundRepeatKeywords.has(keyword.value)) {
        var end = keyword.end;
        var value_2 = keyword.value;
        return { start: start, end: end, value: value_2 };
    }
    return null;
}
exports.parseRepeat = parseRepeat;
var unitRegEx = /\s*([\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?)([a-zA-Z]+|%)?\s*/gy;
function parseUnit(text, start) {
    if (start === void 0) { start = 0; }
    unitRegEx.lastIndex = start;
    var result = unitRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = unitRegEx.lastIndex;
    var value = parseFloat(result[1]);
    var unit = result[2] || "dip";
    return { start: start, end: end, value: { value: value, unit: unit } };
}
exports.parseUnit = parseUnit;
function parsePercentageOrLength(text, start) {
    if (start === void 0) { start = 0; }
    var unitResult = parseUnit(text, start);
    if (unitResult) {
        var start_1 = unitResult.start, end = unitResult.end;
        var value = unitResult.value;
        if (value.unit === "%") {
            value.value /= 100;
        }
        else if (!value.unit) {
            value.unit = "dip";
        }
        else if (value.unit === "px" || value.unit === "dip") {
        }
        else {
            return null;
        }
        return { start: start_1, end: end, value: value };
    }
    return null;
}
exports.parsePercentageOrLength = parsePercentageOrLength;
var angleUnitsToRadMap = {
    "deg": function (start, end, deg) { return ({ start: start, end: end, value: deg / 180 * Math.PI }); },
    "rad": function (start, end, rad) { return ({ start: start, end: end, value: rad }); },
    "grad": function (start, end, grad) { return ({ start: start, end: end, value: grad / 200 * Math.PI }); },
    "turn": function (start, end, turn) { return ({ start: start, end: end, value: turn * Math.PI * 2 }); }
};
function parseAngle(value, start) {
    if (start === void 0) { start = 0; }
    var angleResult = parseUnit(value, start);
    if (angleResult) {
        var start_2 = angleResult.start, end = angleResult.end, value_3 = angleResult.value;
        return (angleUnitsToRadMap[value_3.unit] || (function (_, __, ___) { return null; }))(start_2, end, value_3.value);
    }
    return null;
}
exports.parseAngle = parseAngle;
var backgroundSizeKeywords = new Set(["auto", "contain", "cover"]);
function parseBackgroundSize(value, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(value, start); }
    var end = start;
    if (keyword && backgroundSizeKeywords.has(keyword.value)) {
        end = keyword.end;
        var value_4 = keyword.value;
        return { start: start, end: end, value: value_4 };
    }
    var firstLength = parsePercentageOrLength(value, end);
    if (firstLength) {
        end = firstLength.end;
        var secondLength = parsePercentageOrLength(value, firstLength.end);
        if (secondLength) {
            end = secondLength.end;
            return { start: start, end: end, value: { x: firstLength.value, y: secondLength.value } };
        }
        else {
            return { start: start, end: end, value: { x: firstLength.value, y: "auto" } };
        }
    }
    return null;
}
exports.parseBackgroundSize = parseBackgroundSize;
var backgroundPositionKeywords = Object.freeze(new Set(["left", "right", "top", "bottom", "center"]));
var backgroundPositionKeywordsDirection = {
    "left": "x",
    "right": "x",
    "center": "center",
    "top": "y",
    "bottom": "y"
};
function parseBackgroundPosition(text, start, keyword) {
    if (start === void 0) { start = 0; }
    if (keyword === void 0) { keyword = parseKeyword(text, start); }
    function formatH(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    function formatV(align, offset) {
        if (align.value === "center") {
            return "center";
        }
        if (offset && offset.value.value !== 0) {
            return { align: align.value, offset: offset.value };
        }
        return align.value;
    }
    var end = start;
    if (keyword && backgroundPositionKeywords.has(keyword.value)) {
        end = keyword.end;
        var firstDirection = backgroundPositionKeywordsDirection[keyword.value];
        var firstLength = firstDirection !== "center" && parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
        }
        var secondKeyword = parseKeyword(text, end);
        if (secondKeyword && backgroundPositionKeywords.has(secondKeyword.value)) {
            end = secondKeyword.end;
            var secondDirection = backgroundPositionKeywordsDirection[secondKeyword.end];
            if (firstDirection === secondDirection && firstDirection !== "center") {
                return null;
            }
            var secondLength = secondDirection !== "center" && parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
            }
            if ((firstDirection === secondDirection && secondDirection === "center") || (firstDirection === "x" || secondDirection === "y")) {
                return { start: start, end: end, value: {
                        x: formatH(keyword, firstLength),
                        y: formatV(secondKeyword, secondLength)
                    } };
            }
            else {
                return { start: start, end: end, value: {
                        x: formatH(secondKeyword, secondLength),
                        y: formatV(keyword, firstLength),
                    } };
            }
        }
        else {
            if (firstDirection === "center") {
                return { start: start, end: end, value: { x: "center", y: "center" } };
            }
            else if (firstDirection === "x") {
                return { start: start, end: end, value: { x: formatH(keyword, firstLength), y: "center" } };
            }
            else {
                return { start: start, end: end, value: { x: "center", y: formatV(keyword, firstLength) } };
            }
        }
    }
    else {
        var firstLength = parsePercentageOrLength(text, end);
        if (firstLength) {
            end = firstLength.end;
            var secondLength = parsePercentageOrLength(text, end);
            if (secondLength) {
                end = secondLength.end;
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: { align: "top", offset: secondLength.value } } };
            }
            else {
                return { start: start, end: end, value: { x: { align: "left", offset: firstLength.value }, y: "center" } };
            }
        }
        else {
            return null;
        }
    }
}
exports.parseBackgroundPosition = parseBackgroundPosition;
var directionRegEx = /\s*to\s*(left|right|top|bottom)\s*(left|right|top|bottom)?\s*/gy;
var sideDirections = {
    top: Math.PI * 0 / 2,
    right: Math.PI * 1 / 2,
    bottom: Math.PI * 2 / 2,
    left: Math.PI * 3 / 2
};
var cornerDirections = {
    top: {
        right: Math.PI * 1 / 4,
        left: Math.PI * 7 / 4
    },
    right: {
        top: Math.PI * 1 / 4,
        bottom: Math.PI * 3 / 4
    },
    bottom: {
        right: Math.PI * 3 / 4,
        left: Math.PI * 5 / 4
    },
    left: {
        top: Math.PI * 7 / 4,
        bottom: Math.PI * 5 / 4
    }
};
function parseDirection(text, start) {
    if (start === void 0) { start = 0; }
    directionRegEx.lastIndex = start;
    var result = directionRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = directionRegEx.lastIndex;
    var firstDirection = result[1];
    if (result[2]) {
        var secondDirection = result[2];
        var value = cornerDirections[firstDirection][secondDirection];
        return value === undefined ? null : { start: start, end: end, value: value };
    }
    else {
        return { start: start, end: end, value: sideDirections[firstDirection] };
    }
}
var openingBracketRegEx = /\s*\(\s*/gy;
var closingBracketRegEx = /\s*\)\s*/gy;
var closingBracketOrCommaRegEx = /\s*(\)|,)\s*/gy;
function parseArgumentsList(text, start, argument) {
    openingBracketRegEx.lastIndex = start;
    var openingBracket = openingBracketRegEx.exec(text);
    if (!openingBracket) {
        return null;
    }
    var end = openingBracketRegEx.lastIndex;
    var value = [];
    closingBracketRegEx.lastIndex = end;
    var closingBracket = closingBracketRegEx.exec(text);
    if (closingBracket) {
        return { start: start, end: end, value: value };
    }
    for (var index_1 = 0; true; index_1++) {
        var arg = argument(text, end, index_1);
        if (!arg) {
            return null;
        }
        end = arg.end;
        value.push(arg);
        closingBracketOrCommaRegEx.lastIndex = end;
        var closingBracketOrComma = closingBracketOrCommaRegEx.exec(text);
        if (closingBracketOrComma) {
            end = closingBracketOrCommaRegEx.lastIndex;
            if (closingBracketOrComma[1] === ",") {
                continue;
            }
            else if (closingBracketOrComma[1] === ")") {
                return { start: start, end: end, value: value };
            }
        }
        else {
            return null;
        }
    }
}
function parseColorStop(text, start) {
    if (start === void 0) { start = 0; }
    var color = parseColor(text, start);
    if (!color) {
        return null;
    }
    var end = color.end;
    var offset = parsePercentageOrLength(text, end);
    if (offset) {
        end = offset.end;
        return { start: start, end: end, value: { argb: color.value, offset: offset.value } };
    }
    return { start: start, end: end, value: { argb: color.value } };
}
exports.parseColorStop = parseColorStop;
var linearGradientStartRegEx = /\s*linear-gradient\s*/gy;
function parseLinearGradient(text, start) {
    if (start === void 0) { start = 0; }
    linearGradientStartRegEx.lastIndex = start;
    var lgs = linearGradientStartRegEx.exec(text);
    if (!lgs) {
        return null;
    }
    var end = linearGradientStartRegEx.lastIndex;
    var angle = Math.PI;
    var colors = [];
    var parsedArgs = parseArgumentsList(text, end, function (text, start, index) {
        if (index === 0) {
            var angleArg = parseAngle(text, start) || parseDirection(text, start);
            if (angleArg) {
                angle = angleArg.value;
                return angleArg;
            }
        }
        var colorStop = parseColorStop(text, start);
        if (colorStop) {
            colors.push(colorStop.value);
            return colorStop;
        }
        return null;
    });
    if (!parsedArgs) {
        return null;
    }
    end = parsedArgs.end;
    return { start: start, end: end, value: { angle: angle, colors: colors } };
}
exports.parseLinearGradient = parseLinearGradient;
var slashRegEx = /\s*(\/)\s*/gy;
function parseSlash(text, start) {
    slashRegEx.lastIndex = start;
    var slash = slashRegEx.exec(text);
    if (!slash) {
        return null;
    }
    var end = slashRegEx.lastIndex;
    return { start: start, end: end, value: "/" };
}
function parseBackground(text, start) {
    if (start === void 0) { start = 0; }
    var value = {};
    var end = start;
    while (end < text.length) {
        var keyword = parseKeyword(text, end);
        var color = parseColor(text, end, keyword);
        if (color) {
            value.color = color.value;
            end = color.end;
            continue;
        }
        var repeat = parseRepeat(text, end, keyword);
        if (repeat) {
            value.repeat = repeat.value;
            end = repeat.end;
            continue;
        }
        var position = parseBackgroundPosition(text, end, keyword);
        if (position) {
            position.value.text = text.substring(position.start, position.end);
            value.position = position.value;
            end = position.end;
            var slash = parseSlash(text, end);
            if (slash) {
                end = slash.end;
                var size = parseBackgroundSize(text, end);
                if (!size) {
                    return null;
                }
                value.size = size.value;
                end = size.end;
            }
            continue;
        }
        var url = parseURL(text, end);
        if (url) {
            value.image = url.value;
            end = url.end;
            continue;
        }
        var gradient = parseLinearGradient(text, end);
        if (gradient) {
            value.image = gradient.value;
            end = gradient.end;
            continue;
        }
        return null;
    }
    return { start: start, end: end, value: value };
}
exports.parseBackground = parseBackground;
var universalSelectorRegEx = /\*/gy;
function parseUniversalSelector(text, start) {
    if (start === void 0) { start = 0; }
    universalSelectorRegEx.lastIndex = start;
    var result = universalSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = universalSelectorRegEx.lastIndex;
    return { start: start, end: end, value: { type: "*" } };
}
exports.parseUniversalSelector = parseUniversalSelector;
var simpleIdentifierSelectorRegEx = /(#|\.|:|\b)([_-\w][_-\w\d]*)/gy;
function parseSimpleIdentifierSelector(text, start) {
    if (start === void 0) { start = 0; }
    simpleIdentifierSelectorRegEx.lastIndex = start;
    var result = simpleIdentifierSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = simpleIdentifierSelectorRegEx.lastIndex;
    var type = result[1];
    var identifier = result[2];
    var value = { type: type, identifier: identifier };
    return { start: start, end: end, value: value };
}
exports.parseSimpleIdentifierSelector = parseSimpleIdentifierSelector;
var attributeSelectorRegEx = /\[\s*([_-\w][_-\w\d]*)\s*(?:(=|\^=|\$=|\*=|\~=|\|=)\s*(?:([_-\w][_-\w\d]*)|"((?:[^\\"]|\\(?:"|n|r|f|\\|0-9a-f))*)"|'((?:[^\\']|\\(?:'|n|r|f|\\|0-9a-f))*)')\s*)?\]/gy;
function parseAttributeSelector(text, start) {
    attributeSelectorRegEx.lastIndex = start;
    var result = attributeSelectorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = attributeSelectorRegEx.lastIndex;
    var property = result[1];
    if (result[2]) {
        var test_1 = result[2];
        var value = result[3] || result[4] || result[5];
        return { start: start, end: end, value: { type: "[]", property: property, test: test_1, value: value } };
    }
    return { start: start, end: end, value: { type: "[]", property: property } };
}
exports.parseAttributeSelector = parseAttributeSelector;
function parseSimpleSelector(text, start) {
    if (start === void 0) { start = 0; }
    return parseUniversalSelector(text, start) ||
        parseSimpleIdentifierSelector(text, start) ||
        parseAttributeSelector(text, start);
}
exports.parseSimpleSelector = parseSimpleSelector;
function parseSimpleSelectorSequence(text, start) {
    var simpleSelector = parseSimpleSelector(text, start);
    if (!simpleSelector) {
        return null;
    }
    var end = simpleSelector.end;
    var value = [];
    while (simpleSelector) {
        value.push(simpleSelector.value);
        end = simpleSelector.end;
        simpleSelector = parseSimpleSelector(text, end);
    }
    return { start: start, end: end, value: value };
}
exports.parseSimpleSelectorSequence = parseSimpleSelectorSequence;
var combinatorRegEx = /\s*(\+|~|>)?\s*/gy;
function parseCombinator(text, start) {
    if (start === void 0) { start = 0; }
    combinatorRegEx.lastIndex = start;
    var result = combinatorRegEx.exec(text);
    if (!result) {
        return null;
    }
    var end = combinatorRegEx.lastIndex;
    var value = result[1] || " ";
    return { start: start, end: end, value: value };
}
exports.parseCombinator = parseCombinator;
var whiteSpaceRegEx = /\s*/gy;
function parseSelector(text, start) {
    if (start === void 0) { start = 0; }
    var end = start;
    whiteSpaceRegEx.lastIndex = end;
    var leadingWhiteSpace = whiteSpaceRegEx.exec(text);
    if (leadingWhiteSpace) {
        end = whiteSpaceRegEx.lastIndex;
    }
    var value = [];
    var combinator;
    var expectSimpleSelector = true;
    var pair;
    do {
        var simpleSelectorSequence = parseSimpleSelectorSequence(text, end);
        if (!simpleSelectorSequence) {
            if (expectSimpleSelector) {
                return null;
            }
            else {
                break;
            }
        }
        end = simpleSelectorSequence.end;
        if (combinator) {
            pair[1] = combinator.value;
        }
        pair = [simpleSelectorSequence.value, undefined];
        value.push(pair);
        combinator = parseCombinator(text, end);
        if (combinator) {
            end = combinator.end;
        }
        expectSimpleSelector = combinator && combinator.value !== " ";
    } while (combinator);
    return { start: start, end: end, value: value };
}
exports.parseSelector = parseSelector;
var whitespaceRegEx = /[\s\t\n\r\f]*/gym;
var singleQuoteStringRegEx = /'((?:[^\n\r\f\']|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?'|$)/gym;
var doubleQuoteStringRegEx = /"((?:[^\n\r\f\"]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)(:?"|$)/gym;
var commentRegEx = /(\/\*(?:[^\*]|\*[^\/])*\*\/)/gym;
var numberRegEx = /[\+\-]?(?:\d+\.\d+|\d+|\.\d+)(?:[eE][\+\-]?\d+)?/gym;
var nameRegEx = /-?(?:(?:[a-zA-Z_]|[^\x00-\x7F]|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))(?:[a-zA-Z_0-9\-]*|\\(?:\$|\n|[0-9a-fA-F]{1,6}\s?))*)/gym;
var CSS3Parser = (function () {
    function CSS3Parser(text) {
        this.text = text;
        this.nextInputCodePointIndex = 0;
    }
    CSS3Parser.prototype.tokenize = function () {
        var tokens = [];
        var inputToken;
        do {
            inputToken = this.consumeAToken();
            tokens.push(inputToken);
        } while (inputToken);
        return tokens;
    };
    CSS3Parser.prototype.consumeAToken = function () {
        if (this.reconsumedInputToken) {
            var result = this.reconsumedInputToken;
            this.reconsumedInputToken = null;
            return result;
        }
        var char = this.text[this.nextInputCodePointIndex];
        switch (char) {
            case "\"": return this.consumeAStringToken();
            case "'": return this.consumeAStringToken();
            case "(":
            case ")":
            case ",":
            case ":":
            case ";":
            case "[":
            case "]":
            case "{":
            case "}":
                this.nextInputCodePointIndex++;
                return char;
            case "#": return this.consumeAHashToken() || this.consumeADelimToken();
            case " ":
            case "\t":
            case "\n":
            case "\r":
            case "\f":
                return this.consumeAWhitespace();
            case "@": return this.consumeAtKeyword() || this.consumeADelimToken();
            case "\\": return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "0":
            case "1":
            case "2":
            case "3":
            case "4":
            case "5":
            case "6":
            case "7":
            case "8":
            case "9":
                return this.consumeANumericToken();
            case "u":
            case "U":
                if (this.text[this.nextInputCodePointIndex + 1] === "+") {
                    var thirdChar = this.text[this.nextInputCodePointIndex + 2];
                    if (thirdChar >= "0" && thirdChar <= "9" || thirdChar === "?") {
                        throw new Error("Unicode tokens not supported!");
                    }
                }
                return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
            case "$":
            case "*":
            case "^":
            case "|":
            case "~":
                return this.consumeAMatchToken() || this.consumeADelimToken();
            case "-": return this.consumeANumericToken() || this.consumeAnIdentLikeToken() || this.consumeCDC() || this.consumeADelimToken();
            case "+":
            case ".":
                return this.consumeANumericToken() || this.consumeADelimToken();
            case "/": return this.consumeAComment() || this.consumeADelimToken();
            case "<": return this.consumeCDO() || this.consumeADelimToken();
            case undefined: return undefined;
            default: return this.consumeAnIdentLikeToken() || this.consumeADelimToken();
        }
    };
    CSS3Parser.prototype.consumeADelimToken = function () {
        return { type: 2, text: this.text[this.nextInputCodePointIndex++] };
    };
    CSS3Parser.prototype.consumeAWhitespace = function () {
        whitespaceRegEx.lastIndex = this.nextInputCodePointIndex;
        whitespaceRegEx.exec(this.text);
        this.nextInputCodePointIndex = whitespaceRegEx.lastIndex;
        return " ";
    };
    CSS3Parser.prototype.consumeAHashToken = function () {
        this.nextInputCodePointIndex++;
        var hashName = this.consumeAName();
        if (hashName) {
            return { type: 12, text: "#" + hashName.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeCDO = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 4) === "<!--") {
            this.nextInputCodePointIndex += 4;
            return "<!--";
        }
        return null;
    };
    CSS3Parser.prototype.consumeCDC = function () {
        if (this.text.substr(this.nextInputCodePointIndex, 3) === "-->") {
            this.nextInputCodePointIndex += 3;
            return "-->";
        }
        return null;
    };
    CSS3Parser.prototype.consumeAMatchToken = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "=") {
            var token = this.text.substr(this.nextInputCodePointIndex, 2);
            this.nextInputCodePointIndex += 2;
            return token;
        }
        return null;
    };
    CSS3Parser.prototype.consumeANumericToken = function () {
        numberRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = numberRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = numberRegEx.lastIndex;
        if (this.text[this.nextInputCodePointIndex] === "%") {
            return { type: 4, text: result[0] };
        }
        var name = this.consumeAName();
        if (name) {
            return { type: 5, text: result[0] + name.text };
        }
        return { type: 3, text: result[0] };
    };
    CSS3Parser.prototype.consumeAnIdentLikeToken = function () {
        var name = this.consumeAName();
        if (!name) {
            return null;
        }
        if (this.text[this.nextInputCodePointIndex] === "(") {
            this.nextInputCodePointIndex++;
            if (name.text.toLowerCase() === "url") {
                return this.consumeAURLToken();
            }
            return { type: 8, name: name.text, text: name.text + "(" };
        }
        return name;
    };
    CSS3Parser.prototype.consumeAStringToken = function () {
        var char = this.text[this.nextInputCodePointIndex];
        var result;
        if (char === "'") {
            singleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = singleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = singleQuoteStringRegEx.lastIndex;
        }
        else if (char === "\"") {
            doubleQuoteStringRegEx.lastIndex = this.nextInputCodePointIndex;
            result = doubleQuoteStringRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = doubleQuoteStringRegEx.lastIndex;
        }
        return { type: 1, text: result[0] };
    };
    CSS3Parser.prototype.consumeAURLToken = function () {
        var start = this.nextInputCodePointIndex - 3 - 1;
        var urlToken = { type: 7, text: undefined };
        this.consumeAWhitespace();
        if (this.nextInputCodePointIndex >= this.text.length) {
            return urlToken;
        }
        var nextInputCodePoint = this.text[this.nextInputCodePointIndex];
        if (nextInputCodePoint === "\"" || nextInputCodePoint === "'") {
            var stringToken = this.consumeAStringToken();
            urlToken.text = stringToken.text;
            this.consumeAWhitespace();
            if (this.text[this.nextInputCodePointIndex] === ")" || this.nextInputCodePointIndex >= this.text.length) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                urlToken.text = this.text.substring(start, end);
                return urlToken;
            }
            else {
                return null;
            }
        }
        while (this.nextInputCodePointIndex < this.text.length) {
            var char = this.text[this.nextInputCodePointIndex++];
            switch (char) {
                case ")": return urlToken;
                case " ":
                case "\t":
                case "\n":
                case "\r":
                case "\f":
                    this.consumeAWhitespace();
                    if (this.text[this.nextInputCodePointIndex] === ")") {
                        this.nextInputCodePointIndex++;
                        return urlToken;
                    }
                    else {
                        return null;
                    }
                case "\"":
                case "\'":
                    return null;
                case "\\":
                    throw new Error("Escaping not yet supported!");
                default:
                    urlToken.text += char;
            }
        }
        return urlToken;
    };
    CSS3Parser.prototype.consumeAName = function () {
        nameRegEx.lastIndex = this.nextInputCodePointIndex;
        var result = nameRegEx.exec(this.text);
        if (!result) {
            return null;
        }
        this.nextInputCodePointIndex = nameRegEx.lastIndex;
        return { type: 6, text: result[0] };
    };
    CSS3Parser.prototype.consumeAtKeyword = function () {
        this.nextInputCodePointIndex++;
        var name = this.consumeAName();
        if (name) {
            return { type: 11, text: name.text };
        }
        this.nextInputCodePointIndex--;
        return null;
    };
    CSS3Parser.prototype.consumeAComment = function () {
        if (this.text[this.nextInputCodePointIndex + 1] === "*") {
            commentRegEx.lastIndex = this.nextInputCodePointIndex;
            var result = commentRegEx.exec(this.text);
            if (!result) {
                return null;
            }
            this.nextInputCodePointIndex = commentRegEx.lastIndex;
            return this.consumeAToken();
        }
        return null;
    };
    CSS3Parser.prototype.reconsumeTheCurrentInputToken = function (currentInputToken) {
        this.reconsumedInputToken = currentInputToken;
    };
    CSS3Parser.prototype.parseAStylesheet = function () {
        this.topLevelFlag = true;
        var stylesheet = {
            rules: this.consumeAListOfRules()
        };
        return stylesheet;
    };
    CSS3Parser.prototype.consumeAListOfRules = function () {
        var rules = [];
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            switch (inputToken) {
                case " ": continue;
                case "<!--":
                case "-->":
                    if (this.topLevelFlag) {
                        continue;
                    }
                    this.reconsumeTheCurrentInputToken(inputToken);
                    var atRule = this.consumeAnAtRule();
                    if (atRule) {
                        rules.push(atRule);
                    }
                    continue;
            }
            if (inputToken.type === 11) {
                this.reconsumeTheCurrentInputToken(inputToken);
                var atRule = this.consumeAnAtRule();
                if (atRule) {
                    rules.push(atRule);
                }
                continue;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var qualifiedRule = this.consumeAQualifiedRule();
            if (qualifiedRule) {
                rules.push(qualifiedRule);
            }
        }
        return rules;
    };
    CSS3Parser.prototype.consumeAnAtRule = function () {
        var inputToken = this.consumeAToken();
        var atRule = {
            type: "at-rule",
            name: inputToken.text,
            prelude: [],
            block: undefined
        };
        while (inputToken = this.consumeAToken()) {
            if (inputToken === ";") {
                return atRule;
            }
            else if (inputToken === "{") {
                atRule.block = this.consumeASimpleBlock(inputToken);
                return atRule;
            }
            else if (inputToken.type === 9 && inputToken.associatedToken === "{") {
                atRule.block = inputToken;
                return atRule;
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var component = this.consumeAComponentValue();
            if (component) {
                atRule.prelude.push(component);
            }
        }
        return atRule;
    };
    CSS3Parser.prototype.consumeAQualifiedRule = function () {
        var qualifiedRule = {
            type: "qualified-rule",
            prelude: [],
            block: undefined
        };
        var inputToken;
        while (inputToken = this.consumeAToken()) {
            if (inputToken === "{") {
                var block = this.consumeASimpleBlock(inputToken);
                qualifiedRule.block = block;
                return qualifiedRule;
            }
            else if (inputToken.type === 9) {
                var simpleBlock = inputToken;
                if (simpleBlock.associatedToken === "{") {
                    qualifiedRule.block = simpleBlock;
                    return qualifiedRule;
                }
            }
            this.reconsumeTheCurrentInputToken(inputToken);
            var componentValue = this.consumeAComponentValue();
            if (componentValue) {
                qualifiedRule.prelude.push(componentValue);
            }
        }
        return null;
    };
    CSS3Parser.prototype.consumeAComponentValue = function () {
        var inputToken = this.consumeAToken();
        switch (inputToken) {
            case "{":
            case "[":
            case "(":
                this.nextInputCodePointIndex++;
                return this.consumeASimpleBlock(inputToken);
        }
        if (typeof inputToken === "object" && inputToken.type === 8) {
            return this.consumeAFunction(inputToken.name);
        }
        return inputToken;
    };
    CSS3Parser.prototype.consumeASimpleBlock = function (associatedToken) {
        var endianToken = {
            "[": "]",
            "{": "}",
            "(": ")"
        }[associatedToken];
        var start = this.nextInputCodePointIndex - 1;
        var block = {
            type: 9,
            text: undefined,
            associatedToken: associatedToken,
            values: []
        };
        var nextInputToken;
        while (nextInputToken = this.text[this.nextInputCodePointIndex]) {
            if (nextInputToken === endianToken) {
                this.nextInputCodePointIndex++;
                var end = this.nextInputCodePointIndex;
                block.text = this.text.substring(start, end);
                return block;
            }
            var value = this.consumeAComponentValue();
            if (value) {
                block.values.push(value);
            }
        }
        block.text = this.text.substring(start);
        return block;
    };
    CSS3Parser.prototype.consumeAFunction = function (name) {
        var start = this.nextInputCodePointIndex;
        var funcToken = { type: 14, name: name, text: undefined, components: [] };
        do {
            if (this.nextInputCodePointIndex >= this.text.length) {
                funcToken.text = name + "(" + this.text.substring(start);
                return funcToken;
            }
            var nextInputToken = this.text[this.nextInputCodePointIndex];
            switch (nextInputToken) {
                case ")":
                    this.nextInputCodePointIndex++;
                    var end = this.nextInputCodePointIndex;
                    funcToken.text = name + "(" + this.text.substring(start, end);
                    return funcToken;
                default:
                    var component = this.consumeAComponentValue();
                    if (component) {
                        funcToken.components.push(component);
                    }
            }
        } while (true);
    };
    return CSS3Parser;
}());
exports.CSS3Parser = CSS3Parser;
var CSSNativeScript = (function () {
    function CSSNativeScript() {
    }
    CSSNativeScript.prototype.parseStylesheet = function (stylesheet) {
        return {
            type: "stylesheet",
            stylesheet: {
                rules: this.parseRules(stylesheet.rules)
            }
        };
    };
    CSSNativeScript.prototype.parseRules = function (rules) {
        var _this = this;
        return rules.map(function (rule) { return _this.parseRule(rule); });
    };
    CSSNativeScript.prototype.parseRule = function (rule) {
        if (rule.type === "at-rule") {
            return this.parseAtRule(rule);
        }
        else if (rule.type === "qualified-rule") {
            return this.parseQualifiedRule(rule);
        }
    };
    CSSNativeScript.prototype.parseAtRule = function (rule) {
        if (rule.name === "import") {
            return {
                import: rule.prelude.map(function (m) { return typeof m === "string" ? m : m.text; }).join("").trim(),
                type: "import"
            };
        }
        return;
    };
    CSSNativeScript.prototype.parseQualifiedRule = function (rule) {
        return {
            type: "rule",
            selectors: this.preludeToSelectorsStringArray(rule.prelude),
            declarations: this.ruleBlockToDeclarations(rule.block.values)
        };
    };
    CSSNativeScript.prototype.ruleBlockToDeclarations = function (declarationsInputTokens) {
        var declarations = [];
        var property = "";
        var value = "";
        var reading = "property";
        for (var i = 0; i < declarationsInputTokens.length; i++) {
            var inputToken = declarationsInputTokens[i];
            if (reading === "property") {
                if (inputToken === ":") {
                    reading = "value";
                }
                else if (typeof inputToken === "string") {
                    property += inputToken;
                }
                else {
                    property += inputToken.text;
                }
            }
            else {
                if (inputToken === ";") {
                    property = property.trim();
                    value = value.trim();
                    declarations.push({ type: "declaration", property: property, value: value });
                    property = "";
                    value = "";
                    reading = "property";
                }
                else if (typeof inputToken === "string") {
                    value += inputToken;
                }
                else {
                    value += inputToken.text;
                }
            }
        }
        property = property.trim();
        value = value.trim();
        if (property || value) {
            declarations.push({ type: "declaration", property: property, value: value });
        }
        return declarations;
    };
    CSSNativeScript.prototype.preludeToSelectorsStringArray = function (prelude) {
        var selectors = [];
        var selector = "";
        prelude.forEach(function (inputToken) {
            if (typeof inputToken === "string") {
                if (inputToken === ",") {
                    if (selector) {
                        selectors.push(selector.trim());
                    }
                    selector = "";
                }
                else {
                    selector += inputToken;
                }
            }
            else if (typeof inputToken === "object") {
                selector += inputToken.text;
            }
        });
        if (selector) {
            selectors.push(selector.trim());
        }
        return selectors;
    };
    return CSSNativeScript;
}());
exports.CSSNativeScript = CSSNativeScript;
//# sourceMappingURL=parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable-array/observable-array.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var ChangeType = (function () {
    function ChangeType() {
    }
    ChangeType.Add = "add";
    ChangeType.Delete = "delete";
    ChangeType.Update = "update";
    ChangeType.Splice = "splice";
    return ChangeType;
}());
exports.ChangeType = ChangeType;
var CHANGE = "change";
var ObservableArray = (function (_super) {
    __extends(ObservableArray, _super);
    function ObservableArray() {
        var _this = _super.call(this) || this;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            _this._array = arguments[0].slice();
        }
        else {
            _this._array = Array.apply(null, arguments);
        }
        _this._addArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Add,
            index: null,
            removed: new Array(),
            addedCount: 1
        };
        _this._deleteArgs = {
            eventName: CHANGE, object: _this,
            action: ChangeType.Delete,
            index: null,
            removed: null,
            addedCount: 0
        };
        return _this;
    }
    ObservableArray.prototype.getItem = function (index) {
        return this._array[index];
    };
    ObservableArray.prototype.setItem = function (index, value) {
        var oldValue = this._array[index];
        this._array[index] = value;
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Update,
            index: index,
            removed: [oldValue],
            addedCount: 1
        });
    };
    Object.defineProperty(ObservableArray.prototype, "length", {
        get: function () {
            return this._array.length;
        },
        set: function (value) {
            if (types.isNumber(value) && this._array && this._array.length !== value) {
                this.splice(value, this._array.length - value);
            }
        },
        enumerable: true,
        configurable: true
    });
    ObservableArray.prototype.toString = function () {
        return this._array.toString();
    };
    ObservableArray.prototype.toLocaleString = function () {
        return this._array.toLocaleString();
    };
    ObservableArray.prototype.concat = function () {
        this._addArgs.index = this._array.length;
        var result = this._array.concat.apply(this._array, arguments);
        return result;
    };
    ObservableArray.prototype.join = function (separator) {
        return this._array.join(separator);
    };
    ObservableArray.prototype.pop = function () {
        this._deleteArgs.index = this._array.length - 1;
        var result = this._array.pop();
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.push = function () {
        this._addArgs.index = this._array.length;
        if (arguments.length === 1 && Array.isArray(arguments[0])) {
            var source = arguments[0];
            for (var i = 0, l = source.length; i < l; i++) {
                this._array.push(source[i]);
            }
        }
        else {
            this._array.push.apply(this._array, arguments);
        }
        this._addArgs.addedCount = this._array.length - this._addArgs.index;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return this._array.length;
    };
    ObservableArray.prototype._notifyLengthChange = function () {
        var lengthChangedData = this._createPropertyChangeData("length", this._array.length);
        this.notify(lengthChangedData);
    };
    ObservableArray.prototype.reverse = function () {
        return this._array.reverse();
    };
    ObservableArray.prototype.shift = function () {
        var result = this._array.shift();
        this._deleteArgs.index = 0;
        this._deleteArgs.removed = [result];
        this.notify(this._deleteArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.slice = function (start, end) {
        return this._array.slice(start, end);
    };
    ObservableArray.prototype.sort = function (compareFn) {
        return this._array.sort(compareFn);
    };
    ObservableArray.prototype.splice = function (start, deleteCount) {
        var length = this._array.length;
        var result = this._array.splice.apply(this._array, arguments);
        this.notify({
            eventName: CHANGE, object: this,
            action: ChangeType.Splice,
            index: start,
            removed: result,
            addedCount: this._array.length + result.length - length
        });
        if (this._array.length !== length) {
            this._notifyLengthChange();
        }
        return result;
    };
    ObservableArray.prototype.unshift = function () {
        var length = this._array.length;
        var result = this._array.unshift.apply(this._array, arguments);
        this._addArgs.index = 0;
        this._addArgs.addedCount = result - length;
        this.notify(this._addArgs);
        this._notifyLengthChange();
        return result;
    };
    ObservableArray.prototype.indexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : 0;
        for (var i = index, l = this._array.length; i < l; i++) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.lastIndexOf = function (searchElement, fromIndex) {
        var index = fromIndex ? fromIndex : this._array.length - 1;
        for (var i = index; i >= 0; i--) {
            if (this._array[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
    ObservableArray.prototype.every = function (callbackfn, thisArg) {
        return this._array.every(callbackfn, thisArg);
    };
    ObservableArray.prototype.some = function (callbackfn, thisArg) {
        return this._array.some(callbackfn, thisArg);
    };
    ObservableArray.prototype.forEach = function (callbackfn, thisArg) {
        this._array.forEach(callbackfn, thisArg);
    };
    ObservableArray.prototype.map = function (callbackfn, thisArg) {
        return this._array.map(callbackfn, thisArg);
    };
    ObservableArray.prototype.filter = function (callbackfn, thisArg) {
        return this._array.filter(callbackfn, thisArg);
    };
    ObservableArray.prototype.reduce = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduce(callbackfn, initialValue) : this._array.reduce(callbackfn);
    };
    ObservableArray.prototype.reduceRight = function (callbackfn, initialValue) {
        return initialValue !== undefined ? this._array.reduceRight(callbackfn, initialValue) : this._array.reduceRight(callbackfn);
    };
    ObservableArray.changeEvent = CHANGE;
    return ObservableArray;
}(observable.Observable));
exports.ObservableArray = ObservableArray;
//# sourceMappingURL=observable-array.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/data/observable/observable.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var _wrappedIndex = 0;
var WrappedValue = (function () {
    function WrappedValue(wrapped) {
        this.wrapped = wrapped;
    }
    WrappedValue.unwrap = function (value) {
        return (value instanceof WrappedValue) ? value.wrapped : value;
    };
    WrappedValue.wrap = function (value) {
        var w = _wrappedValues[_wrappedIndex++ % 5];
        w.wrapped = value;
        return w;
    };
    return WrappedValue;
}());
exports.WrappedValue = WrappedValue;
var _wrappedValues = [
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null),
    new WrappedValue(null)
];
var Observable = (function () {
    function Observable() {
        this._observers = {};
    }
    Observable.prototype.get = function (name) {
        return this[name];
    };
    Observable.prototype.set = function (name, value) {
        var oldValue = this[name];
        if (this[name] === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this[name] = newValue;
        this.notifyPropertyChange(name, newValue, oldValue);
    };
    Observable.prototype.on = function (eventNames, callback, thisArg) {
        this.addEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.once = function (event, callback, thisArg) {
        var list = this._getEventList(event, true);
        list.push({ callback: callback, thisArg: thisArg, once: true });
    };
    Observable.prototype.off = function (eventNames, callback, thisArg) {
        this.removeEventListener(eventNames, callback, thisArg);
    };
    Observable.prototype.addEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_1 = events[i].trim();
            var list = this._getEventList(event_1, true);
            list.push({
                callback: callback,
                thisArg: thisArg
            });
        }
    };
    Observable.prototype.removeEventListener = function (eventNames, callback, thisArg) {
        if (typeof eventNames !== "string") {
            throw new TypeError("Events name(s) must be string.");
        }
        if (callback && typeof callback !== "function") {
            throw new TypeError("callback must be function.");
        }
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_2 = events[i].trim();
            if (callback) {
                var list = this._getEventList(event_2, false);
                if (list) {
                    var index_1 = this._indexOfListener(list, callback, thisArg);
                    if (index_1 >= 0) {
                        list.splice(index_1, 1);
                    }
                    if (list.length === 0) {
                        delete this._observers[event_2];
                    }
                }
            }
            else {
                this._observers[event_2] = undefined;
                delete this._observers[event_2];
            }
        }
    };
    Observable.prototype.notify = function (data) {
        var observers = this._observers[data.eventName];
        if (!observers) {
            return;
        }
        for (var i = observers.length - 1; i >= 0; i--) {
            var entry = observers[i];
            if (entry.once) {
                observers.splice(i, 1);
            }
            if (entry.thisArg) {
                entry.callback.apply(entry.thisArg, [data]);
            }
            else {
                entry.callback(data);
            }
        }
    };
    Observable.prototype.notifyPropertyChange = function (name, value, oldValue) {
        this.notify(this._createPropertyChangeData(name, value, oldValue));
    };
    Observable.prototype.hasListeners = function (eventName) {
        return eventName in this._observers;
    };
    Observable.prototype._createPropertyChangeData = function (propertyName, value, oldValue) {
        return { eventName: Observable.propertyChangeEvent, object: this, propertyName: propertyName, value: value, oldValue: oldValue };
    };
    Observable.prototype._emit = function (eventNames) {
        var events = eventNames.split(",");
        for (var i = 0, l = events.length; i < l; i++) {
            var event_3 = events[i].trim();
            this.notify({ eventName: event_3, object: this });
        }
    };
    Observable.prototype._getEventList = function (eventName, createIfNeeded) {
        if (!eventName) {
            throw new TypeError("EventName must be valid string.");
        }
        var list = this._observers[eventName];
        if (!list && createIfNeeded) {
            list = [];
            this._observers[eventName] = list;
        }
        return list;
    };
    Observable.prototype._indexOfListener = function (list, callback, thisArg) {
        for (var i = 0; i < list.length; i++) {
            var entry = list[i];
            if (thisArg) {
                if (entry.callback === callback && entry.thisArg === thisArg) {
                    return i;
                }
            }
            else {
                if (entry.callback === callback) {
                    return i;
                }
            }
        }
        return -1;
    };
    Observable.propertyChangeEvent = "propertyChange";
    return Observable;
}());
exports.Observable = Observable;
var ObservableFromObject = (function (_super) {
    __extends(ObservableFromObject, _super);
    function ObservableFromObject() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._map = {};
        return _this;
    }
    ObservableFromObject.prototype.get = function (name) {
        return this._map[name];
    };
    ObservableFromObject.prototype.set = function (name, value) {
        var currentValue = this._map[name];
        if (currentValue === value) {
            return;
        }
        var newValue = WrappedValue.unwrap(value);
        this._map[name] = newValue;
        this.notifyPropertyChange(name, newValue, currentValue);
    };
    return ObservableFromObject;
}(Observable));
function defineNewProperty(target, propertyName) {
    Object.defineProperty(target, propertyName, {
        get: function () {
            return target._map[propertyName];
        },
        set: function (value) {
            target.set(propertyName, value);
        },
        enumerable: true,
        configurable: true
    });
}
function addPropertiesFromObject(observable, source, recursive) {
    if (recursive === void 0) { recursive = false; }
    Object.keys(source).forEach(function (prop) {
        var value = source[prop];
        if (recursive
            && !Array.isArray(value)
            && value
            && typeof value === "object"
            && !(value instanceof Observable)) {
            value = fromObjectRecursive(value);
        }
        defineNewProperty(observable, prop);
        observable.set(prop, value);
    });
}
function fromObject(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, false);
    return observable;
}
exports.fromObject = fromObject;
function fromObjectRecursive(source) {
    var observable = new ObservableFromObject();
    addPropertiesFromObject(observable, source, true);
    return observable;
}
exports.fromObjectRecursive = fromObjectRecursive;
//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/debugger.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var network;
function getNetwork() {
    return network;
}
exports.getNetwork = getNetwork;
function setNetwork(newNetwork) {
    network = newNetwork;
}
exports.setNetwork = setNetwork;
var dom;
function getDOM() {
    return dom;
}
exports.getDOM = getDOM;
function setDOM(newDOM) {
    dom = newDOM;
}
exports.setDOM = setDOM;
var css;
function getCSS() {
    return css;
}
exports.getCSS = getCSS;
function setCSS(newCSS) {
    css = newCSS;
}
exports.setCSS = setCSS;
var NetworkAgent;
(function (NetworkAgent) {
    function responseReceived(requestId, result, headers) {
        var requestIdStr = requestId.toString();
        var mimeType = headers["Content-Type"] || headers["content-type"] || "application/octet-stream";
        var contentLengthHeader = headers["Content-Length"] || headers["content-length"];
        var contentLength = parseInt(contentLengthHeader, 10);
        if (isNaN(contentLength)) {
            contentLength = 0;
        }
        var response = {
            url: result.url || "",
            status: result.statusCode,
            statusText: result.statusText || "",
            headers: headers,
            mimeType: mimeType,
            fromDiskCache: false,
            connectionReused: true,
            connectionId: 0,
            encodedDataLength: contentLength,
            securityState: "info"
        };
        var responseData = {
            requestId: requestIdStr,
            type: mimeTypeToType(response.mimeType),
            response: response,
            timestamp: getTimeStamp()
        };
        global.__inspector.responseReceived(responseData);
        global.__inspector.loadingFinished({
            requestId: requestIdStr,
            timestamp: getTimeStamp(),
            encodedDataLength: contentLength
        });
        var hasTextContent = responseData.type === "Document" || responseData.type === "Script";
        var data;
        if (!hasTextContent) {
            if (responseData.type === "Image") {
                var bitmap = result.responseAsImage;
                if (bitmap) {
                    var outputStream = new java.io.ByteArrayOutputStream();
                    bitmap.compress(android.graphics.Bitmap.CompressFormat.PNG, 100, outputStream);
                    var base64Image = android.util.Base64.encodeToString(outputStream.toByteArray(), android.util.Base64.DEFAULT);
                    data = base64Image;
                }
            }
        }
        else {
            data = result.responseAsString;
        }
        var successfulRequestData = {
            requestId: requestIdStr,
            data: data,
            hasTextContent: hasTextContent
        };
        global.__inspector.dataForRequestId(successfulRequestData);
    }
    NetworkAgent.responseReceived = responseReceived;
    function requestWillBeSent(requestId, options) {
        var request = {
            url: options.url,
            method: options.method,
            headers: options.headers || {},
            postData: options.content ? options.content.toString() : "",
            initialPriority: "Medium",
            referrerPolicy: "no-referrer-when-downgrade"
        };
        var requestData = {
            requestId: requestId.toString(),
            url: request.url,
            request: request,
            timestamp: getTimeStamp(),
            type: "Document",
            wallTime: 0
        };
        global.__inspector.requestWillBeSent(requestData);
    }
    NetworkAgent.requestWillBeSent = requestWillBeSent;
    function getTimeStamp() {
        var d = new Date();
        return Math.round(d.getTime() / 1000);
    }
    function mimeTypeToType(mimeType) {
        var type = "Document";
        if (mimeType) {
            if (mimeType.indexOf("image") === 0) {
                type = "Image";
            }
            else if (mimeType.indexOf("javascript") !== -1 || mimeType.indexOf("json") !== -1) {
                type = "Script";
            }
        }
        return type;
    }
})(NetworkAgent = exports.NetworkAgent || (exports.NetworkAgent = {}));
//# sourceMappingURL=debugger.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/debugger/dom-node.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var registeredDomNodes = {};
var ELEMENT_NODE_TYPE = 1;
var ROOT_NODE_TYPE = 9;
var propertyBlacklist = [
    "effectivePaddingLeft",
    "effectivePaddingBottom",
    "effectivePaddingRight",
    "effectivePaddingTop",
    "effectiveBorderTopWidth",
    "effectiveBorderRightWidth",
    "effectiveBorderBottomWidth",
    "effectiveBorderLeftWidth",
    "effectiveMinWidth",
    "effectiveMinHeight",
    "effectiveWidth",
    "effectiveHeight",
    "effectiveMarginLeft",
    "effectiveMarginTop",
    "effectiveMarginRight",
    "effectiveMarginBottom",
    "nodeName",
    "nodeType",
    "decodeWidth",
    "decodeHeight",
    "ng-reflect-items",
    "domNode",
    "touchListenerIsSet",
    "bindingContext",
    "nativeView"
];
function lazy(action) {
    var _value;
    return function () { return _value || (_value = action()); };
}
var percentLengthToStringLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js").PercentLength.convertToString; });
var getSetPropertiesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getSetProperties; });
var getComputedCssValuesLazy = lazy(function () { return __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js").getComputedCssValues; });
function registerInspectorEvents(inspector) {
    inspectorFrontendInstance = inspector;
}
exports.registerInspectorEvents = registerInspectorEvents;
var inspectorFrontendInstance;
function notifyInspector(callback) {
    if (inspectorFrontendInstance) {
        callback(inspectorFrontendInstance);
    }
}
function valueToString(value) {
    if (typeof value === "undefined" || value === null) {
        return "";
    }
    else if (typeof value === "object" && value.unit) {
        return percentLengthToStringLazy()(value);
    }
    else {
        return value + "";
    }
}
function propertyFilter(_a) {
    var name = _a[0], value = _a[1];
    if (name[0] === "_") {
        return false;
    }
    if (value !== null && typeof value === "object") {
        return false;
    }
    if (propertyBlacklist.indexOf(name) >= 0) {
        return false;
    }
    return true;
}
function registerNode(domNode) {
    registeredDomNodes[domNode.nodeId] = domNode;
}
function unregisterNode(domNode) {
    delete registeredDomNodes[domNode.nodeId];
}
function getNodeById(id) {
    return registeredDomNodes[id];
}
exports.getNodeById = getNodeById;
var DOMNode = (function () {
    function DOMNode(view) {
        this.nodeValue = "";
        this.attributes = [];
        this.viewRef = new WeakRef(view);
        this.nodeType = view.typeName === "Frame" ? ROOT_NODE_TYPE : ELEMENT_NODE_TYPE;
        this.nodeId = view._domId;
        this.nodeName = view.typeName;
        this.localName = this.nodeName;
        this.loadAttributes();
        registerNode(this);
    }
    DOMNode.prototype.loadAttributes = function () {
        var _this = this;
        this.attributes = [];
        getSetPropertiesLazy()(this.viewRef.get())
            .filter(propertyFilter)
            .forEach(function (pair) { return _this.attributes.push(pair[0], pair[1] + ""); });
    };
    Object.defineProperty(DOMNode.prototype, "children", {
        get: function () {
            var view = this.viewRef.get();
            if (!view) {
                return [];
            }
            var res = [];
            view.eachChild(function (child) {
                child.ensureDomNode();
                res.push(child.domNode);
                return true;
            });
            return res;
        },
        enumerable: true,
        configurable: true
    });
    DOMNode.prototype.onChildAdded = function (childView) {
        var _this = this;
        notifyInspector(function (ins) {
            var view = _this.viewRef.get();
            var previousChild;
            view.eachChild(function (child) {
                if (child === childView) {
                    return false;
                }
                previousChild = child;
                return true;
            });
            var index = !!previousChild ? previousChild._domId : 0;
            childView.ensureDomNode();
            ins.childNodeInserted(_this.nodeId, index, childView.domNode);
        });
    };
    DOMNode.prototype.onChildRemoved = function (view) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.childNodeRemoved(_this.nodeId, view._domId);
        });
    };
    DOMNode.prototype.attributeModified = function (name, value) {
        var _this = this;
        notifyInspector(function (ins) {
            if (propertyBlacklist.indexOf(name) < 0) {
                ins.attributeModified(_this.nodeId, name, valueToString(value));
            }
        });
    };
    DOMNode.prototype.attributeRemoved = function (name) {
        var _this = this;
        notifyInspector(function (ins) {
            ins.attributeRemoved(_this.nodeId, name);
        });
    };
    DOMNode.prototype.getComputedProperties = function () {
        var view = this.viewRef.get();
        if (!view) {
            return [];
        }
        var result = getComputedCssValuesLazy()(view)
            .filter(function (pair) { return pair[0][0] !== "_"; })
            .map(function (pair) {
            return {
                name: pair[0],
                value: valueToString(pair[1])
            };
        });
        return result;
    };
    DOMNode.prototype.dispose = function () {
        unregisterNode(this);
        this.viewRef.clear();
    };
    DOMNode.prototype.toObject = function () {
        return {
            nodeId: this.nodeId,
            nodeType: this.nodeType,
            nodeName: this.nodeName,
            localName: this.localName,
            nodeValue: this.nodeValue,
            children: this.children.map(function (c) { return c.toObject(); }),
            attributes: this.attributes,
            backendNodeId: 0
        };
    };
    return DOMNode;
}());
exports.DOMNode = DOMNode;
//# sourceMappingURL=dom-node.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/fetch/fetch.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {﻿(function () {
    'use strict';

    exports.XMLHttpRequest = global.XMLHttpRequest;
    exports.FormData = global.FormData;

    if (!exports.XMLHttpRequest) {
        var xhr = __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js");
        exports.XMLHttpRequest = xhr.XMLHttpRequest;
        exports.FormData = xhr.FormData;
    }

    function normalizeName(name) {
        if (typeof name !== 'string') {
            name = name.toString();
        }
        if (/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)) {
            throw new TypeError('Invalid character in header field name')
        }
        return name.toLowerCase()
    }

    function normalizeValue(value) {
        if (typeof value !== 'string') {
            value = value.toString();
        }
        return value
    }

    function Headers(headers) {
        this.map = {}

        if (headers instanceof Headers) {
            headers.forEach(function (value, name) {
                this.append(name, value)
            }, this)

        } else if (headers) {
            Object.getOwnPropertyNames(headers).forEach(function (name) {
                this.append(name, headers[name])
            }, this)
        }
    }

    Headers.prototype.append = function (name, value) {
        name = normalizeName(name)
        value = normalizeValue(value)
        var list = this.map[name]
        if (!list) {
            list = []
            this.map[name] = list
        }
        list.push(value)
    }

    Headers.prototype['delete'] = function (name) {
        delete this.map[normalizeName(name)]
    }

    Headers.prototype.get = function (name) {
        var values = this.map[normalizeName(name)]
        return values ? values[0] : null
    }

    Headers.prototype.getAll = function (name) {
        return this.map[normalizeName(name)] || []
    }

    Headers.prototype.has = function (name) {
        return this.map.hasOwnProperty(normalizeName(name))
    }

    Headers.prototype.set = function (name, value) {
        this.map[normalizeName(name)] = [normalizeValue(value)]
    }

    Headers.prototype.forEach = function (callback, thisArg) {
        Object.getOwnPropertyNames(this.map).forEach(function (name) {
            this.map[name].forEach(function (value) {
                callback.call(thisArg, value, name, this)
            }, this)
        }, this)
    }

    function consumed(body) {
        if (body.bodyUsed) {
            return Promise.reject(new TypeError('Already read'))
        }
        body.bodyUsed = true
    }

    function fileReaderReady(reader) {
        return new Promise(function (resolve, reject) {
            reader.onload = function () {
                resolve(reader.result)
            }
            reader.onerror = function () {
                reject(reader.error)
            }
        })
    }

    function readBlobAsArrayBuffer(blob) {
        var reader = new FileReader()
        reader.readAsArrayBuffer(blob)
        return fileReaderReady(reader)
    }

    function readBlobAsText(blob) {
        var reader = new FileReader()
        reader.readAsText(blob)
        return fileReaderReady(reader)
    }

    var support = {
        blob: 'FileReader' in exports && 'Blob' in exports && (function () {
            try {
                new Blob();
                return true
            } catch (e) {
                return false
            }
        })(),
        formData: 'FormData' in exports
    }

    function Body() {
        this.bodyUsed = false


        this._initBody = function (body) {
            this._bodyInit = body
            if (typeof body === 'string') {
                this._bodyText = body
            } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
                this._bodyBlob = body
            } else if (support.formData && exports.FormData.prototype.isPrototypeOf(body)) {
                this._bodyFormData = body
            } else if (!body) {
                this._bodyText = ''
            } else {
                throw new Error('unsupported BodyInit type')
            }
        }

        if (support.blob) {
            this.blob = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return Promise.resolve(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as blob')
                } else {
                    return Promise.resolve(new Blob([this._bodyText]))
                }
            }

            this.arrayBuffer = function () {
                return this.blob().then(readBlobAsArrayBuffer)
            }

            this.text = function () {
                var rejected = consumed(this)
                if (rejected) {
                    return rejected
                }

                if (this._bodyBlob) {
                    return readBlobAsText(this._bodyBlob)
                } else if (this._bodyFormData) {
                    throw new Error('could not read FormData body as text')
                } else {
                    return Promise.resolve(this._bodyText)
                }
            }
        } else {
            this.text = function () {
                var rejected = consumed(this)
                return rejected ? rejected : Promise.resolve(this._bodyText)
            }
        }

        if (support.formData) {
            this.formData = function () {
                return this.text().then(decode)
            }
        }

        this.json = function () {
            return this.text().then(JSON.parse)
        }

        return this
    }

    // HTTP methods whose capitalization should be normalized
    var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']

    function normalizeMethod(method) {
        var upcased = method.toUpperCase()
        return (methods.indexOf(upcased) > -1) ? upcased : method
    }

    function Request(url, options) {
        options = options || {}
        this.url = url

        this.credentials = options.credentials || 'omit'
        this.headers = new Headers(options.headers)
        this.method = normalizeMethod(options.method || 'GET')
        this.mode = options.mode || null
        this.referrer = null

        if ((this.method === 'GET' || this.method === 'HEAD') && options.body) {
            throw new TypeError('Body not allowed for GET or HEAD requests')
        }
        this._initBody(options.body)
    }

    function decode(body) {
        var form = new exports.FormData()
        body.trim().split('&').forEach(function (bytes) {
            if (bytes) {
                var split = bytes.split('=')
                var name = split.shift().replace(/\+/g, ' ')
                var value = split.join('=').replace(/\+/g, ' ')
                form.append(decodeURIComponent(name), decodeURIComponent(value))
            }
        })
        return form
    }

    function headers(xhr) {
        var head = new Headers()
        var pairs = xhr.getAllResponseHeaders().trim().split('\n')
        pairs.forEach(function (header) {
            var split = header.trim().split(':')
            var key = split.shift().trim()
            var value = split.join(':').trim()
            head.append(key, value)
        })
        return head
    }

    Body.call(Request.prototype)

    function Response(bodyInit, options) {
        if (!options) {
            options = {}
        }

        this._initBody(bodyInit)
        this.type = 'default'
        this.url = null
        this.status = options.status
        this.ok = this.status >= 200 && this.status < 300
        this.statusText = options.statusText
        this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)
        this.url = options.url || ''
    }

    Body.call(Response.prototype)

    exports.Headers = Headers;
    exports.Request = Request;
    exports.Response = Response;

    exports.fetch = function (input, init) {
        // TODO: Request constructor should accept input, init
        var request
        if (Request.prototype.isPrototypeOf(input) && !init) {
            request = input
        } else {
            request = new Request(input, init)
        }

        return new Promise(function (resolve, reject) {
            var xhr = new exports.XMLHttpRequest()

            function responseURL() {
                if ('responseURL' in xhr) {
                    return xhr.responseURL
                }

                // Avoid security warnings on getResponseHeader when not allowed by CORS
                if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {
                    return xhr.getResponseHeader('X-Request-URL')
                }

                return;
            }

            xhr.onload = function () {
                var status = (xhr.status === 1223) ? 204 : xhr.status
                if (status < 100 || status > 599) {
                    reject(new TypeError('Network request failed'))
                    return
                }
                var options = {
                    status: status,
                    statusText: xhr.statusText,
                    headers: headers(xhr),
                    url: responseURL()
                }
                //var body = 'response' in xhr ? xhr.response : xhr.responseText;
                resolve(new Response(xhr.responseText, options))
            }

            xhr.onerror = function (error) {
                reject(new TypeError(['Network request failed:', error.message].join(' ')))
            }

            xhr.open(request.method, request.url, true)

            if (request.credentials === 'include') {
                xhr.withCredentials = true
            }

            if ('responseType' in xhr && support.blob) {
                xhr.responseType = 'blob'
            }

            request.headers.forEach(function (value, name) {
                xhr.setRequestHeader(name, value)
            })

            xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)
        })
    }
    exports.fetch.polyfill = true

})();
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system-access.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var text_1 = __webpack_require__("../node_modules/tns-core-modules/text/text.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var FileSystemAccess = (function () {
    function FileSystemAccess() {
    }
    FileSystemAccess.prototype.getLastModified = function (path) {
        var fileManager = NSFileManager.defaultManager;
        var attributes = fileManager.attributesOfItemAtPathError(path);
        if (attributes) {
            return attributes.objectForKey("NSFileModificationDate");
        }
        else {
            return new Date();
        }
    };
    FileSystemAccess.prototype.getFileSize = function (path) {
        var fileManager = NSFileManager.defaultManager;
        var attributes = fileManager.attributesOfItemAtPathError(path);
        if (attributes) {
            return attributes.objectForKey("NSFileSize");
        }
        else {
            return 0;
        }
    };
    FileSystemAccess.prototype.getParent = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var nsString = NSString.stringWithString(path);
            var parentPath = nsString.stringByDeletingLastPathComponent;
            var name_1 = fileManager.displayNameAtPath(parentPath);
            return {
                path: parentPath.toString(),
                name: name_1
            };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFile = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var exists = fileManager.fileExistsAtPath(path);
            if (!exists) {
                var parentPath = this.getParent(path, onError).path;
                if (!fileManager.createDirectoryAtPathWithIntermediateDirectoriesAttributesError(parentPath, true, null)
                    || !fileManager.createFileAtPathContentsAttributes(path, null, null)) {
                    if (onError) {
                        onError(new Error("Failed to create file at path '" + path + "'"));
                    }
                    return undefined;
                }
            }
            var fileName = fileManager.displayNameAtPath(path);
            return {
                path: path,
                name: fileName,
                extension: this.getFileExtension(path)
            };
        }
        catch (exception) {
            if (onError) {
                onError(exception);
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getFolder = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var exists = this.folderExists(path);
            if (!exists) {
                try {
                    fileManager.createDirectoryAtPathWithIntermediateDirectoriesAttributesError(path, true, null);
                }
                catch (ex) {
                    if (onError) {
                        onError(new Error("Failed to create folder at path '" + path + "': " + ex));
                    }
                    return undefined;
                }
            }
            var dirName = fileManager.displayNameAtPath(path);
            return {
                path: path,
                name: dirName
            };
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to create folder at path '" + path + "'"));
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.getExistingFolder = function (path, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var exists = this.folderExists(path);
            if (exists) {
                var dirName = fileManager.displayNameAtPath(path);
                return {
                    path: path,
                    name: dirName
                };
            }
            return undefined;
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to get folder at path '" + path + "'"));
            }
            return undefined;
        }
    };
    FileSystemAccess.prototype.eachEntity = function (path, onEntity, onError) {
        if (!onEntity) {
            return;
        }
        this.enumEntities(path, onEntity, onError);
    };
    FileSystemAccess.prototype.getEntities = function (path, onError) {
        var fileInfos = new Array();
        var onEntity = function (entity) {
            fileInfos.push(entity);
            return true;
        };
        var errorOccurred;
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            errorOccurred = true;
        };
        this.enumEntities(path, onEntity, localError);
        if (!errorOccurred) {
            return fileInfos;
        }
        return null;
    };
    FileSystemAccess.prototype.fileExists = function (path) {
        var result = this.exists(path);
        return result.exists;
    };
    FileSystemAccess.prototype.folderExists = function (path) {
        var result = this.exists(path);
        return result.exists && result.isDirectory;
    };
    FileSystemAccess.prototype.exists = function (path) {
        var fileManager = NSFileManager.defaultManager;
        var isDirectory = new interop.Reference(interop.types.bool, false);
        var exists = fileManager.fileExistsAtPathIsDirectory(path, isDirectory);
        return { exists: exists, isDirectory: isDirectory.value };
    };
    FileSystemAccess.prototype.concatPath = function (left, right) {
        return NSString.pathWithComponents([left, right]).toString();
    };
    FileSystemAccess.prototype.deleteFile = function (path, onError) {
        this.deleteEntity(path, onError);
    };
    FileSystemAccess.prototype.deleteFolder = function (path, onError) {
        this.deleteEntity(path, onError);
    };
    FileSystemAccess.prototype.emptyFolder = function (path, onError) {
        var fileManager = NSFileManager.defaultManager;
        var entities = this.getEntities(path, onError);
        if (!entities) {
            return;
        }
        for (var i = 0; i < entities.length; i++) {
            try {
                fileManager.removeItemAtPathError(entities[i].path);
            }
            catch (ex) {
                if (onError) {
                    onError(new Error("Failed to empty folder '" + path + "': " + ex));
                }
                return;
            }
        }
    };
    FileSystemAccess.prototype.rename = function (path, newPath, onError) {
        var fileManager = NSFileManager.defaultManager;
        try {
            fileManager.moveItemAtPathToPathError(path, newPath);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to rename '" + path + "' to '" + newPath + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.getLogicalRootPath = function () {
        var mainBundlePath = NSBundle.mainBundle.bundlePath;
        var resolvedPath = NSString.stringWithString(mainBundlePath).stringByResolvingSymlinksInPath;
        return resolvedPath;
    };
    FileSystemAccess.prototype.getDocumentsFolderPath = function () {
        return this.getKnownPath(9);
    };
    FileSystemAccess.prototype.getTempFolderPath = function () {
        return this.getKnownPath(13);
    };
    FileSystemAccess.prototype.getCurrentAppPath = function () {
        return utils_1.ios.getCurrentAppPath();
    };
    FileSystemAccess.prototype.readText = function (path, onError, encoding) {
        var actualEncoding = encoding || text_1.encoding.UTF_8;
        try {
            var nsString = NSString.stringWithContentsOfFileEncodingError(path, actualEncoding);
            return nsString.toString();
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to read file at path '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.read = function (path, onError) {
        try {
            return NSData.dataWithContentsOfFile(path);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to read file at path '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.writeText = function (path, content, onError, encoding) {
        var nsString = NSString.stringWithString(content);
        var actualEncoding = encoding || text_1.encoding.UTF_8;
        try {
            nsString.writeToFileAtomicallyEncodingError(path, false, actualEncoding);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to write to file '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.write = function (path, content, onError) {
        try {
            content.writeToFileAtomically(path, true);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to write to file '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.getKnownPath = function (folderType) {
        var fileManager = NSFileManager.defaultManager;
        var paths = fileManager.URLsForDirectoryInDomains(folderType, 1);
        var url = paths.objectAtIndex(0);
        return url.path;
    };
    FileSystemAccess.prototype.getFileExtension = function (path) {
        var dotIndex = path.lastIndexOf(".");
        if (dotIndex && dotIndex >= 0 && dotIndex < path.length) {
            return path.substring(dotIndex);
        }
        return "";
    };
    FileSystemAccess.prototype.deleteEntity = function (path, onError) {
        var fileManager = NSFileManager.defaultManager;
        try {
            fileManager.removeItemAtPathError(path);
        }
        catch (ex) {
            if (onError) {
                onError(new Error("Failed to delete file at path '" + path + "': " + ex));
            }
        }
    };
    FileSystemAccess.prototype.enumEntities = function (path, callback, onError) {
        try {
            var fileManager = NSFileManager.defaultManager;
            var files = void 0;
            try {
                files = fileManager.contentsOfDirectoryAtPathError(path);
            }
            catch (ex) {
                if (onError) {
                    onError(new Error("Failed to enum files for folder '" + path + "': " + ex));
                }
                return;
            }
            for (var i = 0; i < files.count; i++) {
                var file = files.objectAtIndex(i);
                var info = {
                    path: this.concatPath(path, file),
                    name: file,
                    extension: ""
                };
                if (!this.folderExists(this.joinPath(path, file))) {
                    info.extension = this.getFileExtension(info.path);
                }
                var retVal = callback(info);
                if (retVal === false) {
                    break;
                }
            }
        }
        catch (ex) {
            if (onError) {
                onError(ex);
            }
        }
    };
    FileSystemAccess.prototype.getPathSeparator = function () {
        return "/";
    };
    FileSystemAccess.prototype.normalizePath = function (path) {
        var nsString = NSString.stringWithString(path);
        var normalized = nsString.stringByStandardizingPath;
        return normalized;
    };
    FileSystemAccess.prototype.joinPath = function (left, right) {
        var nsString = NSString.stringWithString(left);
        return nsString.stringByAppendingPathComponent(right);
    };
    FileSystemAccess.prototype.joinPaths = function (paths) {
        return utils_1.ios.joinPaths.apply(utils_1.ios, paths);
    };
    return FileSystemAccess;
}());
exports.FileSystemAccess = FileSystemAccess;
//# sourceMappingURL=file-system-access.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/file-system/file-system.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_access_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system-access.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var fileAccess;
function getFileAccess() {
    if (!fileAccess) {
        fileAccess = new file_system_access_1.FileSystemAccess();
    }
    return fileAccess;
}
var platform;
function ensurePlatform() {
    if (!platform) {
        platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
    }
}
function createFile(info) {
    var file = new File();
    file._path = info.path;
    file._name = info.name;
    file._extension = info.extension;
    return file;
}
function createFolder(info) {
    var documents = knownFolders.documents();
    if (info.path === documents.path) {
        return documents;
    }
    var temp = knownFolders.temp();
    if (info.path === temp.path) {
        return temp;
    }
    var folder = new Folder();
    folder._path = info.path;
    folder._name = info.name;
    return folder;
}
var FileSystemEntity = (function () {
    function FileSystemEntity() {
    }
    Object.defineProperty(FileSystemEntity.prototype, "parent", {
        get: function () {
            var onError = function (error) {
                throw error;
            };
            var folderInfo = getFileAccess().getParent(this.path, onError);
            if (!folderInfo) {
                return undefined;
            }
            return createFolder(folderInfo);
        },
        enumerable: true,
        configurable: true
    });
    FileSystemEntity.prototype.remove = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.removeSync(localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.removeSync = function (onError) {
        if (this._isKnown) {
            if (onError) {
                onError({ message: "Cannot delete known folder." });
            }
            return;
        }
        var fileAccess = getFileAccess();
        if (this instanceof File) {
            fileAccess.deleteFile(this.path, onError);
        }
        else if (this instanceof Folder) {
            fileAccess.deleteFolder(this.path, onError);
        }
    };
    FileSystemEntity.prototype.rename = function (newName) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.renameSync(newName, localError);
            if (!hasError) {
                resolve();
            }
        });
    };
    FileSystemEntity.prototype.renameSync = function (newName, onError) {
        if (this._isKnown) {
            if (onError) {
                onError(new Error("Cannot rename known folder."));
            }
            return;
        }
        var parentFolder = this.parent;
        if (!parentFolder) {
            if (onError) {
                onError(new Error("No parent folder."));
            }
            return;
        }
        var fileAccess = getFileAccess();
        var path = parentFolder.path;
        var newPath = fileAccess.joinPath(path, newName);
        var localError = function (error) {
            if (onError) {
                onError(error);
            }
            return null;
        };
        fileAccess.rename(this.path, newPath, localError);
        this._path = newPath;
        this._name = newName;
        if (this instanceof File) {
            this._extension = fileAccess.getFileExtension(newPath);
        }
    };
    Object.defineProperty(FileSystemEntity.prototype, "name", {
        get: function () {
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "path", {
        get: function () {
            return this._path;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FileSystemEntity.prototype, "lastModified", {
        get: function () {
            var value = this._lastModified;
            if (!this._lastModified) {
                value = this._lastModified = getFileAccess().getLastModified(this.path);
            }
            return value;
        },
        enumerable: true,
        configurable: true
    });
    return FileSystemEntity;
}());
exports.FileSystemEntity = FileSystemEntity;
var File = (function (_super) {
    __extends(File, _super);
    function File() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    File.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var fileInfo = getFileAccess().getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    File.exists = function (path) {
        return getFileAccess().fileExists(path);
    };
    Object.defineProperty(File.prototype, "extension", {
        get: function () {
            return this._extension;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "isLocked", {
        get: function () {
            return !!this._locked;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(File.prototype, "size", {
        get: function () {
            return getFileAccess().getFileSize(this.path);
        },
        enumerable: true,
        configurable: true
    });
    File.prototype.readSync = function (onError) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().read(this.path, localError);
        this._locked = false;
        return content;
    };
    File.prototype.writeSync = function (content, onError) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_1 = this;
            var localError = function (error) {
                that_1._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().write(this.path, content, localError);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.readText = function (encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var content = _this.readTextSync(localError, encoding);
            if (!hasError) {
                resolve(content);
            }
        });
    };
    File.prototype.readTextSync = function (onError, encoding) {
        this.checkAccess();
        this._locked = true;
        var that = this;
        var localError = function (error) {
            that._locked = false;
            if (onError) {
                onError(error);
            }
        };
        var content = getFileAccess().readText(this.path, localError, encoding);
        this._locked = false;
        return content;
    };
    File.prototype.writeText = function (content, encoding) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.writeTextSync(content, localError, encoding);
            if (!hasError) {
                resolve();
            }
        });
    };
    File.prototype.writeTextSync = function (content, onError, encoding) {
        this.checkAccess();
        try {
            this._locked = true;
            var that_2 = this;
            var localError = function (error) {
                that_2._locked = false;
                if (onError) {
                    onError(error);
                }
            };
            getFileAccess().writeText(this.path, content, localError, encoding);
        }
        finally {
            this._locked = false;
        }
    };
    File.prototype.checkAccess = function () {
        if (this.isLocked) {
            throw new Error("Cannot access a locked file.");
        }
    };
    __decorate([
        profiling_1.profile
    ], File.prototype, "readTextSync", null);
    return File;
}(FileSystemEntity));
exports.File = File;
var Folder = (function (_super) {
    __extends(Folder, _super);
    function Folder() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Folder.fromPath = function (path) {
        var onError = function (error) {
            throw error;
        };
        var folderInfo = getFileAccess().getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.exists = function (path) {
        return getFileAccess().folderExists(path);
    };
    Folder.prototype.contains = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        if (fileAccess.fileExists(path)) {
            return true;
        }
        return fileAccess.folderExists(path);
    };
    Folder.prototype.clear = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var onError = function (error) {
                hasError = true;
                reject(error);
            };
            _this.clearSync(onError);
            if (!hasError) {
                resolve();
            }
        });
    };
    Folder.prototype.clearSync = function (onError) {
        getFileAccess().emptyFolder(this.path, onError);
    };
    Object.defineProperty(Folder.prototype, "isKnown", {
        get: function () {
            return this._isKnown;
        },
        enumerable: true,
        configurable: true
    });
    Folder.prototype.getFile = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var fileInfo = fileAccess.getFile(path, onError);
        if (!fileInfo) {
            return undefined;
        }
        return createFile(fileInfo);
    };
    Folder.prototype.getFolder = function (name) {
        var fileAccess = getFileAccess();
        var path = fileAccess.joinPath(this.path, name);
        var onError = function (error) {
            throw error;
        };
        var folderInfo = fileAccess.getFolder(path, onError);
        if (!folderInfo) {
            return undefined;
        }
        return createFolder(folderInfo);
    };
    Folder.prototype.getEntities = function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            var hasError = false;
            var localError = function (error) {
                hasError = true;
                reject(error);
            };
            var entities = _this.getEntitiesSync(localError);
            if (!hasError) {
                resolve(entities);
            }
        });
    };
    Folder.prototype.getEntitiesSync = function (onError) {
        var fileInfos = getFileAccess().getEntities(this.path, onError);
        if (!fileInfos) {
            return null;
        }
        var entities = new Array();
        for (var i = 0; i < fileInfos.length; i++) {
            if (fileInfos[i].extension) {
                entities.push(createFile(fileInfos[i]));
            }
            else {
                entities.push(createFolder(fileInfos[i]));
            }
        }
        return entities;
    };
    Folder.prototype.eachEntity = function (onEntity) {
        if (!onEntity) {
            return;
        }
        var onSuccess = function (fileInfo) {
            var entity;
            if (fileInfo.extension) {
                entity = createFile(fileInfo);
            }
            else {
                entity = createFolder(fileInfo);
            }
            return onEntity(entity);
        };
        var onError = function (error) {
            throw error;
        };
        getFileAccess().eachEntity(this.path, onSuccess, onError);
    };
    return Folder;
}(FileSystemEntity));
exports.Folder = Folder;
var knownFolders;
(function (knownFolders) {
    var _documents;
    var _temp;
    var _app;
    function documents() {
        if (!_documents) {
            var path_1 = getFileAccess().getDocumentsFolderPath();
            _documents = new Folder();
            _documents._path = path_1;
            _documents._isKnown = true;
        }
        return _documents;
    }
    knownFolders.documents = documents;
    function temp() {
        if (!_temp) {
            var path_2 = getFileAccess().getTempFolderPath();
            _temp = new Folder();
            _temp._path = path_2;
            _temp._isKnown = true;
        }
        return _temp;
    }
    knownFolders.temp = temp;
    function currentApp() {
        if (!_app) {
            var path_3 = getFileAccess().getCurrentAppPath();
            _app = new Folder();
            _app._path = path_3;
            _app._isKnown = true;
        }
        return _app;
    }
    knownFolders.currentApp = currentApp;
    var ios;
    (function (ios) {
        function _checkPlatform(knownFolderName) {
            ensurePlatform();
            if (!platform.isIOS) {
                throw new Error("The \"" + knownFolderName + "\" known folder is available on iOS only!");
            }
        }
        var _library;
        function library() {
            _checkPlatform("library");
            if (!_library) {
                var existingFolderInfo = getExistingFolderInfo(5);
                if (existingFolderInfo) {
                    _library = existingFolderInfo.folder;
                    _library._path = existingFolderInfo.path;
                    _library._isKnown = true;
                }
            }
            return _library;
        }
        ios.library = library;
        var _developer;
        function developer() {
            _checkPlatform("developer");
            if (!_developer) {
                var existingFolderInfo = getExistingFolderInfo(6);
                if (existingFolderInfo) {
                    _developer = existingFolderInfo.folder;
                    _developer._path = existingFolderInfo.path;
                    _developer._isKnown = true;
                }
            }
            return _developer;
        }
        ios.developer = developer;
        var _desktop;
        function desktop() {
            _checkPlatform("desktop");
            if (!_desktop) {
                var existingFolderInfo = getExistingFolderInfo(12);
                if (existingFolderInfo) {
                    _desktop = existingFolderInfo.folder;
                    _desktop._path = existingFolderInfo.path;
                    _desktop._isKnown = true;
                }
            }
            return _desktop;
        }
        ios.desktop = desktop;
        var _downloads;
        function downloads() {
            _checkPlatform("downloads");
            if (!_downloads) {
                var existingFolderInfo = getExistingFolderInfo(15);
                if (existingFolderInfo) {
                    _downloads = existingFolderInfo.folder;
                    _downloads._path = existingFolderInfo.path;
                    _downloads._isKnown = true;
                }
            }
            return _downloads;
        }
        ios.downloads = downloads;
        var _movies;
        function movies() {
            _checkPlatform("movies");
            if (!_movies) {
                var existingFolderInfo = getExistingFolderInfo(17);
                if (existingFolderInfo) {
                    _movies = existingFolderInfo.folder;
                    _movies._path = existingFolderInfo.path;
                    _movies._isKnown = true;
                }
            }
            return _movies;
        }
        ios.movies = movies;
        var _music;
        function music() {
            _checkPlatform("music");
            if (!_music) {
                var existingFolderInfo = getExistingFolderInfo(18);
                if (existingFolderInfo) {
                    _music = existingFolderInfo.folder;
                    _music._path = existingFolderInfo.path;
                    _music._isKnown = true;
                }
            }
            return _music;
        }
        ios.music = music;
        var _pictures;
        function pictures() {
            _checkPlatform("pictures");
            if (!_pictures) {
                var existingFolderInfo = getExistingFolderInfo(19);
                if (existingFolderInfo) {
                    _pictures = existingFolderInfo.folder;
                    _pictures._path = existingFolderInfo.path;
                    _pictures._isKnown = true;
                }
            }
            return _pictures;
        }
        ios.pictures = pictures;
        var _sharedPublic;
        function sharedPublic() {
            _checkPlatform("sharedPublic");
            if (!_sharedPublic) {
                var existingFolderInfo = getExistingFolderInfo(21);
                if (existingFolderInfo) {
                    _sharedPublic = existingFolderInfo.folder;
                    _sharedPublic._path = existingFolderInfo.path;
                    _sharedPublic._isKnown = true;
                }
            }
            return _sharedPublic;
        }
        ios.sharedPublic = sharedPublic;
        function getExistingFolderInfo(pathDirectory) {
            var fileAccess = getFileAccess();
            var folderPath = fileAccess.getKnownPath(pathDirectory);
            var folderInfo = fileAccess.getExistingFolder(folderPath);
            if (folderInfo) {
                return {
                    folder: createFolder(folderInfo),
                    path: folderPath
                };
            }
            return undefined;
        }
    })(ios = knownFolders.ios || (knownFolders.ios = {}));
})(knownFolders = exports.knownFolders || (exports.knownFolders = {}));
var path;
(function (path_4) {
    function normalize(path) {
        return getFileAccess().normalizePath(path);
    }
    path_4.normalize = normalize;
    function join() {
        var paths = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            paths[_i] = arguments[_i];
        }
        var fileAccess = getFileAccess();
        return fileAccess.joinPaths(paths);
    }
    path_4.join = join;
    path_4.separator = getFileAccess().getPathSeparator();
})(path = exports.path || (exports.path = {}));
//# sourceMappingURL=file-system.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/globals.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
__webpack_require__("../node_modules/tns-core-modules/globals/ts-helpers.js");
__webpack_require__("../node_modules/tns-core-modules/globals/register-module-helpers.js");
global.moduleMerge = function (sourceExports, destExports) {
    for (var key in sourceExports) {
        destExports[key] = sourceExports[key];
    }
};
global.zonedCallback = function (callback) {
    if (global.zone) {
        return global.zone.bind(callback);
    }
    if (global.Zone) {
        return global.Zone.current.wrap(callback);
    }
    else {
        return callback;
    }
};
global.registerModule("timer", function () { return __webpack_require__("../node_modules/tns-core-modules/timer/timer.js"); });
global.registerModule("ui/dialogs", function () { return __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs.js"); });
global.registerModule("xhr", function () { return __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js"); });
global.registerModule("fetch", function () { return __webpack_require__("../node_modules/tns-core-modules/fetch/fetch.js"); });
global.System = {
    import: function (path) {
        return new Promise(function (resolve, reject) {
            try {
                resolve(global.require(path));
            }
            catch (e) {
                reject(e);
            }
        });
    }
};
function registerOnGlobalContext(name, module) {
    Object.defineProperty(global, name, {
        get: function () {
            var m = global.loadModule(module);
            var resolvedValue = m[name];
            Object.defineProperty(global, name, { value: resolvedValue, configurable: true, writable: true });
            return resolvedValue;
        },
        configurable: true
    });
}
var snapshotGlobals;
function install() {
    if (global.__snapshot || global.__snapshotEnabled) {
        if (!snapshotGlobals) {
            var timer = __webpack_require__("../node_modules/tns-core-modules/timer/timer.js");
            var dialogs = __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs.js");
            var xhr = __webpack_require__("../node_modules/tns-core-modules/xhr/xhr.js");
            var fetch_1 = __webpack_require__("../node_modules/tns-core-modules/fetch/fetch.js");
            snapshotGlobals = snapshotGlobals || {
                setTimeout: timer.setTimeout,
                clearTimeout: timer.clearTimeout,
                setInterval: timer.setInterval,
                clearInterval: timer.clearInterval,
                alert: dialogs.alert,
                confirm: dialogs.confirm,
                prompt: dialogs.prompt,
                login: dialogs.login,
                action: dialogs.action,
                XMLHttpRequest: xhr.XMLHttpRequest,
                FormData: xhr.FormData,
                fetch: fetch_1.fetch,
                Headers: fetch_1.Headers,
                Request: fetch_1.Request,
                Response: fetch_1.Response,
            };
        }
        var consoleModule = __webpack_require__("../node_modules/tns-core-modules/console/console.js").Console;
        global.console = global.console || new consoleModule();
        Object.assign(global, snapshotGlobals);
    }
    else {
        registerOnGlobalContext("setTimeout", "timer");
        registerOnGlobalContext("clearTimeout", "timer");
        registerOnGlobalContext("setInterval", "timer");
        registerOnGlobalContext("clearInterval", "timer");
        registerOnGlobalContext("alert", "ui/dialogs");
        registerOnGlobalContext("confirm", "ui/dialogs");
        registerOnGlobalContext("prompt", "ui/dialogs");
        registerOnGlobalContext("login", "ui/dialogs");
        registerOnGlobalContext("action", "ui/dialogs");
        registerOnGlobalContext("XMLHttpRequest", "xhr");
        registerOnGlobalContext("FormData", "xhr");
        registerOnGlobalContext("fetch", "fetch");
        registerOnGlobalContext("Headers", "fetch");
        registerOnGlobalContext("Request", "fetch");
        registerOnGlobalContext("Response", "fetch");
    }
}
exports.install = install;
install();
function Deprecated(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_1 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is deprecated");
            return originalMethod_1.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is deprecated");
        return target;
    }
}
exports.Deprecated = Deprecated;
global.Deprecated = Deprecated;
function Experimental(target, key, descriptor) {
    if (descriptor) {
        var originalMethod_2 = descriptor.value;
        descriptor.value = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            console.log(key.toString() + " is experimental");
            return originalMethod_2.apply(this, args);
        };
        return descriptor;
    }
    else {
        console.log((target && target.name || target) + " is experimental");
        return target;
    }
}
exports.Experimental = Experimental;
global.Experimental = Experimental;
//# sourceMappingURL=globals.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/register-module-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {var modules = new Map();
var modulesLoadedForUI = new Set();
var defaultExtensionMap = {
    ".js": ".js",
    ".ts": ".js",
    ".css": ".css",
    ".scss": ".css",
    ".less": ".css",
    ".sass": ".css",
    ".xml": ".xml"
};
global.moduleResolvers = [global.require];
global.registerModule = function (name, loader) {
    modules.set(name, { loader: loader, moduleId: name });
};
global._unregisterModule = function _unregisterModule(name) {
    modules.delete(name);
};
global._isModuleLoadedForUI = function _isModuleLoadedForUI(moduleName) {
    return modulesLoadedForUI.has(moduleName);
};
global.registerWebpackModules = function registerWebpackModules(context, extensionMap) {
    if (extensionMap === void 0) { extensionMap = {}; }
    context.keys().forEach(function (moduleId) {
        var extDotIndex = moduleId.lastIndexOf(".");
        var base = moduleId.substr(0, extDotIndex);
        var originalExt = moduleId.substr(extDotIndex);
        var registerExt = extensionMap[originalExt] || defaultExtensionMap[originalExt] || originalExt;
        var isSourceFile = originalExt !== registerExt;
        var registerName = base + registerExt;
        var registerWithName = function (nickName) {
            modules.set(nickName, {
                moduleId: moduleId,
                loader: function () {
                    return context(moduleId);
                }
            });
        };
        if (registerName.startsWith("./") && registerName.endsWith(".js")) {
            var jsNickNames = [
                registerName.substr(2, registerName.length - 5),
                registerName.substr(0, registerName.length - 3),
                registerName.substr(2),
            ];
            jsNickNames.forEach(function (jsNickName) {
                if (isSourceFile || !global.moduleExists(jsNickName)) {
                    registerWithName(jsNickName);
                }
            });
        }
        else if (registerName.startsWith("./")) {
            var moduleNickNames = [
                registerName.substr(2),
            ];
            moduleNickNames.forEach(function (moduleNickName) {
                if (!global.moduleExists(moduleNickName)) {
                    registerWithName(moduleNickName);
                }
            });
        }
        if (isSourceFile || !global.moduleExists(registerName)) {
            registerWithName(registerName);
        }
    });
};
global.moduleExists = function moduleExists(name) {
    return modules.has(name);
};
global.loadModule = function loadModule(name, isUIModule) {
    if (isUIModule === void 0) { isUIModule = false; }
    var moduleInfo = modules.get(name);
    if (moduleInfo) {
        if (isUIModule) {
            modulesLoadedForUI.add(moduleInfo.moduleId);
        }
        var result = moduleInfo.loader(name);
        if (result.enableAutoAccept) {
            result.enableAutoAccept();
        }
        return result;
    }
    var _loop_1 = function (resolver) {
        var result = resolver(name);
        if (result) {
            modules.set(name, { moduleId: name, loader: function () { return result; } });
            return { value: result };
        }
    };
    for (var _i = 0, _a = global.moduleResolvers; _i < _a.length; _i++) {
        var resolver = _a[_i];
        var state_1 = _loop_1(resolver);
        if (typeof state_1 === "object")
            return state_1.value;
    }
};
global.getRegisteredModules = function getRegisteredModules() {
    return Array.from(modules.keys());
};
//# sourceMappingURL=register-module-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/globals/ts-helpers.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
if (!global.__extends) {
    global.__extends = function (d, b) {
        for (var p in b) {
            if (b.hasOwnProperty(p)) {
                d[p] = b[p];
            }
        }
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
}
var tslib = __webpack_require__("../node_modules/tslib/tslib.es6.js");
for (var _i = 0, _a = Object.keys(tslib); _i < _a.length; _i++) {
    var fnName = _a[_i];
    if (typeof tslib[fnName] !== "function") {
        continue;
    }
    if (fnName in global) {
        continue;
    }
    global[fnName] = tslib[fnName];
}
//# sourceMappingURL=ts-helpers.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
function getFilenameFromUrl(url) {
    var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    var slashPos = url.lastIndexOf("/") + 1;
    var questionMarkPos = url.lastIndexOf("?");
    var actualFileName;
    if (questionMarkPos !== -1) {
        actualFileName = url.substring(slashPos, questionMarkPos);
    }
    else {
        actualFileName = url.substring(slashPos);
    }
    var result = fs.path.join(fs.knownFolders.documents().path, actualFileName);
    return result;
}
exports.getFilenameFromUrl = getFilenameFromUrl;
//# sourceMappingURL=http-request-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http-request/http-request.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var domainDebugger = __webpack_require__("../node_modules/tns-core-modules/debugger/debugger.js");
var http_request_common_1 = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request-common.js");
var HttpResponseEncoding;
(function (HttpResponseEncoding) {
    HttpResponseEncoding[HttpResponseEncoding["UTF8"] = 0] = "UTF8";
    HttpResponseEncoding[HttpResponseEncoding["GBK"] = 1] = "GBK";
})(HttpResponseEncoding = exports.HttpResponseEncoding || (exports.HttpResponseEncoding = {}));
var currentDevice = UIDevice.currentDevice;
var device = currentDevice.userInterfaceIdiom === 0 ? "Phone" : "Pad";
var osVersion = currentDevice.systemVersion;
var GET = "GET";
var USER_AGENT_HEADER = "User-Agent";
var USER_AGENT = "Mozilla/5.0 (i" + device + "; CPU OS " + osVersion.replace(".", "_") + " like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/" + osVersion + " Mobile/10A5355d Safari/8536.25";
var sessionConfig = NSURLSessionConfiguration.defaultSessionConfiguration;
var queue = NSOperationQueue.mainQueue;
function parseJSON(source) {
    var src = source.trim();
    if (src.lastIndexOf(")") === src.length - 1) {
        return JSON.parse(src.substring(src.indexOf("(") + 1, src.lastIndexOf(")")));
    }
    return JSON.parse(src);
}
var NSURLSessionTaskDelegateImpl = (function (_super) {
    __extends(NSURLSessionTaskDelegateImpl, _super);
    function NSURLSessionTaskDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NSURLSessionTaskDelegateImpl.prototype.URLSessionTaskWillPerformHTTPRedirectionNewRequestCompletionHandler = function (session, task, response, request, completionHandler) {
        completionHandler(null);
    };
    NSURLSessionTaskDelegateImpl.ObjCProtocols = [NSURLSessionTaskDelegate];
    return NSURLSessionTaskDelegateImpl;
}(NSObject));
var sessionTaskDelegateInstance = NSURLSessionTaskDelegateImpl.new();
var defaultSession;
function ensureDefaultSession() {
    if (!defaultSession) {
        defaultSession = NSURLSession.sessionWithConfigurationDelegateDelegateQueue(sessionConfig, null, queue);
    }
}
var sessionNotFollowingRedirects;
function ensureSessionNotFollowingRedirects() {
    if (!sessionNotFollowingRedirects) {
        sessionNotFollowingRedirects = NSURLSession.sessionWithConfigurationDelegateDelegateQueue(sessionConfig, sessionTaskDelegateInstance, queue);
    }
}
var imageSource;
function ensureImageSource() {
    if (!imageSource) {
        imageSource = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
    }
}
var fs;
function ensureFileSystem() {
    if (!fs) {
        fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
    }
}
function request(options) {
    return new Promise(function (resolve, reject) {
        if (!options.url) {
            reject(new Error("Request url was empty."));
            return;
        }
        try {
            var network = domainDebugger.getNetwork();
            var debugRequest_1 = network && network.create();
            var urlRequest = NSMutableURLRequest.requestWithURL(NSURL.URLWithString(options.url));
            urlRequest.HTTPMethod = types.isDefined(options.method) ? options.method : GET;
            urlRequest.setValueForHTTPHeaderField(USER_AGENT, USER_AGENT_HEADER);
            if (options.headers) {
                for (var header in options.headers) {
                    urlRequest.setValueForHTTPHeaderField(options.headers[header] + "", header);
                }
            }
            if (types.isString(options.content) || options.content instanceof FormData) {
                urlRequest.HTTPBody = NSString.stringWithString(options.content.toString()).dataUsingEncoding(4);
            }
            if (types.isNumber(options.timeout)) {
                urlRequest.timeoutInterval = options.timeout / 1000;
            }
            var session = void 0;
            if (types.isBoolean(options.dontFollowRedirects) && options.dontFollowRedirects) {
                ensureSessionNotFollowingRedirects();
                session = sessionNotFollowingRedirects;
            }
            else {
                ensureDefaultSession();
                session = defaultSession;
            }
            var dataTask = session.dataTaskWithRequestCompletionHandler(urlRequest, function (data, response, error) {
                if (error) {
                    reject(new Error(error.localizedDescription));
                }
                else {
                    var headers_1 = {};
                    if (response && response.allHeaderFields) {
                        var headerFields = response.allHeaderFields;
                        headerFields.enumerateKeysAndObjectsUsingBlock(function (key, value, stop) {
                            addHeader(headers_1, key, value);
                        });
                    }
                    if (debugRequest_1) {
                        debugRequest_1.mimeType = response.MIMEType;
                        debugRequest_1.data = data;
                        var debugResponse = {
                            url: options.url,
                            status: response.statusCode,
                            statusText: NSHTTPURLResponse.localizedStringForStatusCode(response.statusCode),
                            headers: headers_1,
                            mimeType: response.MIMEType,
                            fromDiskCache: false
                        };
                        debugRequest_1.responseReceived(debugResponse);
                        debugRequest_1.loadingFinished();
                    }
                    resolve({
                        content: {
                            raw: data,
                            toString: function (encoding) { return NSDataToString(data, encoding); },
                            toJSON: function (encoding) { return parseJSON(NSDataToString(data, encoding)); },
                            toImage: function () {
                                ensureImageSource();
                                return new Promise(function (resolve, reject) {
                                    UIImage.tns_decodeImageWithDataCompletion(data, function (image) {
                                        if (image) {
                                            resolve(imageSource.fromNativeSource(image));
                                        }
                                        else {
                                            reject(new Error("Response content may not be converted to an Image"));
                                        }
                                    });
                                });
                            },
                            toFile: function (destinationFilePath) {
                                ensureFileSystem();
                                if (!destinationFilePath) {
                                    destinationFilePath = http_request_common_1.getFilenameFromUrl(options.url);
                                }
                                if (data instanceof NSData) {
                                    var file = fs.File.fromPath(destinationFilePath);
                                    data.writeToFileAtomically(destinationFilePath, true);
                                    return file;
                                }
                                else {
                                    reject(new Error("Cannot save file with path: " + destinationFilePath + "."));
                                }
                            }
                        },
                        statusCode: response.statusCode,
                        headers: headers_1
                    });
                }
            });
            if (options.url && debugRequest_1) {
                var request_1 = {
                    url: options.url,
                    method: "GET",
                    headers: options.headers
                };
                debugRequest_1.requestWillBeSent(request_1);
            }
            dataTask.resume();
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.request = request;
function NSDataToString(data, encoding) {
    var code = NSUTF8StringEncoding;
    if (encoding === HttpResponseEncoding.GBK) {
        code = 1586;
    }
    var encodedString = NSString.alloc().initWithDataEncoding(data, code);
    if (!encodedString) {
        code = NSISOLatin1StringEncoding;
        encodedString = NSString.alloc().initWithDataEncoding(data, code);
    }
    return encodedString.toString();
}
function addHeader(headers, key, value) {
    if (!headers[key]) {
        headers[key] = value;
    }
    else if (Array.isArray(headers[key])) {
        headers[key].push(value);
    }
    else {
        var values = [headers[key]];
        values.push(value);
        headers[key] = values;
    }
}
exports.addHeader = addHeader;
//# sourceMappingURL=http-request.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/http/http.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var httpRequest = __webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js");
__export(__webpack_require__("../node_modules/tns-core-modules/http/http-request/http-request.js"));
function getString(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var str = r.content.toString();
                resolve(str);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getString = getString;
function getJSON(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var json = r.content.toJSON();
                resolve(json);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getJSON = getJSON;
function getImage(arg) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                resolve(r.content.toImage());
            }
            catch (err) {
                reject(err);
            }
        }, function (err) {
            reject(err);
        });
    });
}
exports.getImage = getImage;
function getFile(arg, destinationFilePath) {
    return new Promise(function (resolve, reject) {
        httpRequest.request(typeof arg === "string" ? { url: arg, method: "GET" } : arg)
            .then(function (r) {
            try {
                var file = r.content.toFile(destinationFilePath);
                resolve(file);
            }
            catch (e) {
                reject(e);
            }
        }, function (e) { return reject(e); });
    });
}
exports.getFile = getFile;
//# sourceMappingURL=http.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/image-source/image-source.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.isFileOrResourcePath = utils_1.isFileOrResourcePath;
var http;
function ensureHttp() {
    if (!http) {
        http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
    }
}
var ImageSource = (function () {
    function ImageSource() {
    }
    ImageSource.prototype.fromAsset = function (asset) {
        return new Promise(function (resolve, reject) {
            asset.getImageAsync(function (image, err) {
                if (image) {
                    resolve(fromNativeSource(image));
                }
                else {
                    reject(err);
                }
            });
        });
    };
    ImageSource.prototype.loadFromResource = function (name) {
        this.ios = UIImage.tns_safeImageNamed(name) || UIImage.tns_safeImageNamed(name + ".jpg");
        return this.ios != null;
    };
    ImageSource.prototype.fromResource = function (name) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                UIImage.tns_safeDecodeImageNamedCompletion(name, function (image) {
                    if (image) {
                        _this.ios = image;
                        resolve(true);
                    }
                    else {
                        UIImage.tns_safeDecodeImageNamedCompletion(name + ".jpg", function (image) {
                            _this.ios = image;
                            resolve(true);
                        });
                    }
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromFile = function (path) {
        this.ios = UIImage.imageWithContentsOfFile(getFileName(path));
        return this.ios != null;
    };
    ImageSource.prototype.fromFile = function (path) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                UIImage.tns_decodeImageWidthContentsOfFileCompletion(getFileName(path), function (image) {
                    _this.ios = image;
                    resolve(true);
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromData = function (data) {
        this.ios = UIImage.imageWithData(data);
        return this.ios != null;
    };
    ImageSource.prototype.fromData = function (data) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                UIImage.tns_decodeImageWithDataCompletion(data, function (image) {
                    _this.ios = image;
                    resolve(true);
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromBase64 = function (source) {
        if (typeof source === "string") {
            var data = NSData.alloc().initWithBase64EncodedStringOptions(source, 1);
            this.ios = UIImage.imageWithData(data);
        }
        return this.ios != null;
    };
    ImageSource.prototype.fromBase64 = function (source) {
        var _this = this;
        return new Promise(function (resolve, reject) {
            try {
                var data = NSData.alloc().initWithBase64EncodedStringOptions(source, 1);
                UIImage.imageWithData["async"](UIImage, [data]).then(function (image) {
                    _this.ios = image;
                    resolve(true);
                });
            }
            catch (ex) {
                reject(ex);
            }
        });
    };
    ImageSource.prototype.loadFromFontIconCode = function (source, font, color) {
        var _a;
        var fontSize = utils_1.layout.toDevicePixels(font.fontSize);
        if (!fontSize) {
            fontSize = UIFont.labelFontSize;
        }
        var density = utils_1.layout.getDisplayDensity();
        var scaledFontSize = fontSize * density;
        var attributes = (_a = {},
            _a[NSFontAttributeName] = font.getUIFont(UIFont.systemFontOfSize(scaledFontSize)),
            _a);
        if (color) {
            attributes[NSForegroundColorAttributeName] = color.ios;
        }
        var attributedString = NSAttributedString.alloc().initWithStringAttributes(source, attributes);
        UIGraphicsBeginImageContextWithOptions(attributedString.size(), false, 0.0);
        attributedString.drawAtPoint(CGPointMake(0, 0));
        var iconImage = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
        this.ios = iconImage;
        return this.ios != null;
    };
    ImageSource.prototype.setNativeSource = function (source) {
        if (source && !(source instanceof UIImage)) {
            throw new Error("The method setNativeSource() expects UIImage instance.");
        }
        this.ios = source;
    };
    ImageSource.prototype.saveToFile = function (path, format, quality) {
        if (!this.ios) {
            return false;
        }
        if (quality) {
            quality = (quality - 0) / (100 - 0);
        }
        var data = getImageData(this.ios, format, quality);
        if (data) {
            return NSFileManager.defaultManager.createFileAtPathContentsAttributes(path, data, null);
        }
        return false;
    };
    ImageSource.prototype.toBase64String = function (format, quality) {
        var res = null;
        if (!this.ios) {
            return res;
        }
        if (quality) {
            quality = (quality - 0) / (100 - 0);
        }
        var data = getImageData(this.ios, format, quality);
        if (data) {
            res = data.base64Encoding();
        }
        return res;
    };
    Object.defineProperty(ImageSource.prototype, "height", {
        get: function () {
            if (this.ios) {
                return this.ios.size.height;
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "width", {
        get: function () {
            if (this.ios) {
                return this.ios.size.width;
            }
            return NaN;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ImageSource.prototype, "rotationAngle", {
        get: function () {
            return NaN;
        },
        set: function (_value) {
        },
        enumerable: true,
        configurable: true
    });
    return ImageSource;
}());
exports.ImageSource = ImageSource;
function getFileName(path) {
    var fileName = typeof path === "string" ? path.trim() : "";
    if (fileName.indexOf("~/") === 0) {
        fileName = file_system_1.path.join(file_system_1.knownFolders.currentApp().path, fileName.replace("~/", ""));
    }
    return fileName;
}
function getImageData(instance, format, quality) {
    if (quality === void 0) { quality = 0.9; }
    var data = null;
    switch (format) {
        case "png":
            data = UIImagePNGRepresentation(instance);
            break;
        case "jpeg":
        case "jpg":
            data = UIImageJPEGRepresentation(instance, quality);
            break;
    }
    return data;
}
function fromAsset(asset) {
    var image = new ImageSource();
    return image.fromAsset(asset);
}
exports.fromAsset = fromAsset;
function fromResource(name) {
    var image = new ImageSource();
    return image.loadFromResource(name) ? image : null;
}
exports.fromResource = fromResource;
function fromFile(path) {
    var image = new ImageSource();
    return image.loadFromFile(path) ? image : null;
}
exports.fromFile = fromFile;
function fromFontIconCode(source, font, color) {
    var image = new ImageSource();
    return image.loadFromFontIconCode(source, font, color) ? image : null;
}
exports.fromFontIconCode = fromFontIconCode;
function fromData(data) {
    var image = new ImageSource();
    return image.loadFromData(data) ? image : null;
}
exports.fromData = fromData;
function fromBase64(source) {
    var image = new ImageSource();
    return image.loadFromBase64(source) ? image : null;
}
exports.fromBase64 = fromBase64;
function fromNativeSource(source) {
    var imageSource = new ImageSource();
    imageSource.setNativeSource(source);
    return imageSource;
}
exports.fromNativeSource = fromNativeSource;
function fromUrl(url) {
    ensureHttp();
    return http.getImage(url);
}
exports.fromUrl = fromUrl;
function fromFileOrResource(path) {
    if (!utils_1.isFileOrResourcePath(path)) {
        throw new Error("Path \"" + "\" is not a valid file or resource.");
    }
    if (path.indexOf(utils_1.RESOURCE_PREFIX) === 0) {
        return fromResource(path.substr(utils_1.RESOURCE_PREFIX.length));
    }
    return fromFile(path);
}
exports.fromFileOrResource = fromFileOrResource;
//# sourceMappingURL=image-source.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/easysax/easysax.js":
/***/ (function(module, exports, __webpack_require__) {

﻿	/*
	new function() {
		var parser = new EasySAXParser();

		parser.ns('rss', { // or false
			rss: 'http://purl.org/rss/1.0/',
			atom: 'http://www.w3.org/2005/Atom',
			xhtml: 'http://www.w3.org/1999/xhtml',
			media: 'http://search.yahoo.com/mrss/'
		});


		parser.on('error', function(msg) {
			//console.log(msg)
		});

		parser.on('startNode', function(elem, attr, uq, tagend, getStrNode) {
			attr();
			return;
			if (tagend) {
				console.log('   '+str)
			} else {
				console.log('+  '+str)
			};
		});

		parser.on('endNode', function(elem, uq, tagstart, str) {
			return;
			if (!tagstart) console.log('-  ' + str)
		});

		parser.on('textNode', function(s, uq) {
			uq(s);
			return
			console.log('   '+s)
		});

		parser.on('cdata', function(data) {
		});


		parser.on('comment', function(text) {
			//console.log('--'+text+'--')
		});

		//parser.on('question', function() {}); // <? ... ?>
		//parser.on('attention', function() {}); // <!XXXXX zzzz="eeee">

		console.time('easysax');
		for(var z=1000;z--;) {
			parser.parse(xml)
		};
		console.timeEnd('easysax');
	};


	*/

// << ------------------------------------------------------------------------ >> //


if (true /*&& this == exports*/) {
	module.exports.EasySAXParser = EasySAXParser;
};

function EasySAXParser() {
	'use strict';

	if (!this) return null;

    this.angularSyntax = false;

	function nullFunc() {};

	this.onTextNode = nullFunc;
    this.onStartNode = nullFunc;
    this.onEndNode = nullFunc;
    this.onCDATA = nullFunc;
    this.onError = nullFunc;
    this.onComment = null;
    this.onQuestion = null;
    this.onAttention = null;
	this.is_onComment = this.is_onQuestion = this.is_onAttention = false;

	this.isNamespace = false;
    this.useNS = null;
    this.default_xmlns = null;
    this.xmlns = null;
	this.nsmatrix = {xmlns: this.xmlns};
	this.hasSurmiseNS = false;
	;


	this.attr_string = ''; // строка атрибутов
	this.attr_posstart = 0; //
	this.attr_res; // закешированный результат разбора атрибутов , null - разбор не проводился, object - хеш атрибутов, true - нет атрибутов, false - невалидный xml
}

EasySAXParser.prototype.on = function(name, cb) {
    if (typeof cb !== 'function') {
        if (cb !== null) return;
    };

    switch(name) {
        case 'error': this.onError = cb || nullFunc; break;
        case 'startNode': this.onStartNode = cb || nullFunc; break;
        case 'endNode': this.onEndNode = cb || nullFunc; break;
        case 'textNode': this.onTextNode = cb || nullFunc; break;
        case 'cdata': this.onCDATA = cb || nullFunc; break;

        case 'comment': this.onComment = cb; this.is_onComment = !!cb; break;
        case 'question': this.onQuestion = cb; this.is_onQuestion = !!cb; break; // <? ....  ?>
        case 'attention': this.onAttention = cb; this.is_onAttention = !!cb; break; // <!XXXXX zzzz="eeee">
    };
};

EasySAXParser.prototype.ns = function(root, ns) {
    if (!root || typeof root !== 'string' || !ns) {
        return;
    };

    var u, x = {}, ok, v, i;

    for(i in ns) {
        v = ns[i];
        if (typeof v === 'string') {
            if (root === v) ok = true;
            x[i] = v;
        };
    };

    if (ok) {
        this.isNamespace = true;
        this.default_xmlns = root;
        this.useNS = x;
    };
};


EasySAXParser.prototype.parse = function(xml) {
    if (typeof xml !== 'string') {
        return;
    };

    if (this.isNamespace) {
        this.nsmatrix = {xmlns: this.default_xmlns};

        parse(xml);

        this.nsmatrix = false;

    } else {
        parse(xml);
    };

    this.attr_res = true;
};

// -----------------------------------------------------

var xharsQuot={constructor: false, hasOwnProperty: false, isPrototypeOf: false, propertyIsEnumerable: false, toLocaleString: false, toString: false, valueOf: false
    , quot: '"'
    , QUOT: '"'
    , amp: '&'
    , AMP: '&'
    , nbsp: '\u00A0'
    , apos: '\''
    , lt: '<'
    , LT: '<'
    , gt: '>'
    , GT: '>'
    , copy: '\u00A9'
    , laquo: '\u00AB'
    , raquo: '\u00BB'
    , reg: '\u00AE'
    , deg: '\u00B0'
    , plusmn: '\u00B1'
    , sup2: '\u00B2'
    , sup3: '\u00B3'
    , micro: '\u00B5'
    , para: '\u00B6'
};


function rpEntities(s, d, x, z) {
    if (z) {
        return xharsQuot[z] || '\x01';
    };

    if (d) {
        return String.fromCharCode(d);
    };

    return String.fromCharCode(parseInt(x, 16));
};

function unEntities(s, i) {
    s = String(s);
    if (s.length > 3 && s.indexOf('&') !== -1) {
        if (s.indexOf('&gt;') !== -1) s = s.replace(/&gt;/g, '>');
        if (s.indexOf('&lt;') !== -1) s = s.replace(/&lt;/g, '<');
        if (s.indexOf('&quot;') !== -1) s = s.replace(/&quot;/g, '"');

        if (s.indexOf('&') !== -1) {
            s = s.replace(/&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig, rpEntities);
        };
    };

    return s;
};


EasySAXParser.prototype.allowedAngularAttributeChars = function(w) {
    if (!this.angularSyntax) {
        return false;
    } else {
        return (
            w === 40 || // (
            w === 41 || // )
            w === 91 || // [
            w === 93 || // ]
            w === 94 || // ^
            w === 35    // #
        );
    }
};

	/*
		парсит атрибуты по требованию. Важно! - функция не генерирует исключения.

		если была ошибка разбора возврашается false
		если атрибутов нет и разбор удачен то возврашается true
		если есть атрибуты то возврашается обьект(хеш)
	*/

EasySAXParser.prototype.getAttrs = function() {
    if (this.attr_res !== null) {
        return this.attr_res;
    };

    /*
    if (xxtest !== u && attr_string.indexOf(xxtest) === -1) {
        / *
            // для ускорения
            if (getAttrs('html').type == 'html') {
                ...
            };
        * /
        return true;
    };
    */

    var u
    , res = {}
    , s = this.attr_string
    , i = this.attr_posstart
    , l = s.length
    , attr_list = this.hasSurmiseNS ? [] : false
    , name, value = ''
    , ok = false
    , noValueAttribute = false
    , j, w, nn, n
    , hasNewMatrix
    , alias, newalias
    ;

    aa:
    for(; i < l; i++) {
        w = s.charCodeAt(i);

        if (w===32 || (w<14 && w > 8) ) { // \f\n\r\t\v
            continue
        };

        // Check for valid attribute start char
        if ((w < 65 && !this.allowedAngularAttributeChars(w)) ||
                w > 122 || (w > 90 && w < 97 && !this.allowedAngularAttributeChars(w)) ) { // ожидаем символ
            return this.attr_res = false; // error. invalid char
        };

        for(j = i + 1; j < l; j++) { // проверяем все символы имени атрибута
            w = s.charCodeAt(j);

            if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                if (noValueAttribute) {
                    j--; //Started next attribute. Get back and break out of the loop.
                    break;
                } else {
                    continue;
                }
            };

            if (this.allowedAngularAttributeChars(w)) {
                continue;
            }

            if (w === 32 || (w > 8 && w < 14) ) {  // \f\n\r\t\v пробел
                noValueAttribute = true;
                continue;
            } else if (w === 61) { // "=" == 61
                noValueAttribute = false;
                break;
            } else {
                //console.log('error 2');
                if (!noValueAttribute)
                    return this.attr_res = false; // error. invalid char
            };

            break;
        };

        name = s.substring(i, j).trim();
        ok = true;

        if (name === 'xmlns:xmlns') {
            //console.log('error 6')
            return this.attr_res = false; // error. invalid name
        };

        w = s.charCodeAt(j+1);

        while (w = s.charCodeAt(j+1)) {
            if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v пробел
                j++;
            } else {
                break;
            }
        }

        if (!noValueAttribute) {
            if (w === 34) {  // '"'
                j = s.indexOf('"', i = j+2 );

            } else {
                if (w === 39) {
                    j = s.indexOf('\'', i = j+2 );

                } else {  // "'"
                    return this.attr_res = false; // error. invalid char
                };
            };
        }

        if (j === -1) {
            //console.log('error 4')
            return this.attr_res = false; // error. invalid char
        };


        if (j+1 < l && !noValueAttribute) {
            w = s.charCodeAt(j+1);

            if (w > 32 || w < 9 || (w < 32 && w > 13)) {
                // error. invalid char
                //console.log('error 5')
                return this.attr_res = false;
            };
        };


        if (noValueAttribute) {
            value = '';
        } else {
            value = s.substring(i, j);
        }

        //i = j + 1; // след. семвол уже проверен потому проверять нужно следуюший
        i = j; // след. семвол уже проверен потому проверять нужно следуюший

        if (this.isNamespace) { //
            if (this.hasSurmiseNS) {
                // есть подозрение что в атрибутах присутствует xmlns

                if (newalias = name === 'xmlns' ? 'xmlns' : name.charCodeAt(0) === 120 && name.substr(0, 6) === 'xmlns:' && name.substr(6) ) {
                    alias = this.useNS[unEntities(value)];

                    if (alias) {
                        if (this.nsmatrix[newalias] !== alias) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = alias;
                        };
                    } else {
                        if (this.nsmatrix[newalias]) {
                            if (!hasNewMatrix) {
                                hasNewMatrix = true;
                                nn = {}; for (n in this.nsmatrix) nn[n] = this.nsmatrix[n];
                                this.nsmatrix = nn;
                            };

                            this.nsmatrix[newalias] = false;
                        };
                    };

                    res[name] = value;
                    continue;
                };

                attr_list.push(name, value);
                continue;
            };

            w = name.length;
            while(--w) {
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)] ) {
                        res[w + name.substr(w)] = value;
                    };
                    continue aa;

                    // 'xml:base' ???
                };
            };
        };

        res[name] = value;
        noValueAttribute = false;
    };


    if (!ok) {
        return this.attr_res = true;  // атрибутов нет, ошибок тоже нет
    };


    if (this.hasSurmiseNS)  {
        bb:

        for (i = 0, l = attr_list.length; i < l; i++) {
            name = attr_list[i++];

            w = name.length;
            while(--w) { // name.indexOf(':')
                if (name.charCodeAt(w) === 58) { // ':'
                    if (w = this.nsmatrix[name.substring(0, w)]) {
                        res[w + name.substr(w)] = attr_list[i];
                    };
                    continue bb;
                    break;
                };
            };

            res[name] = attr_list[i];
        };
    };

    return this.attr_res = res;
};


// xml - string
EasySAXParser.prototype.parse = function(xml) {
    var u
    , xml = String(xml)
    , nodestack = []
    , stacknsmatrix = []
    //, string_node
    , elem
    , tagend = false
    , tagstart = false
    , j = 0, i = 0, k = 0, len
    , x, y, q, w
    , xmlns
    , stopIndex = 0
    , stop // используется при разборе "namespace" . если встретился неизвестное пространство то события не генерируются
    , _nsmatrix
    , ok
    , pos = 0, ln = 0, lnStart = -2, lnEnd = -1
    ;

    len = xml.length;
    function getStringNode() {
        return xml.substring(i, j+1)
    };
    function findLineAndColumnFromPos() {
        while (lnStart < lnEnd && lnEnd < pos) {
            lnStart = lnEnd;
            lnEnd = xml.indexOf("\n", lnEnd + 1);
            ++ln;
        }
        return { line: ln, column: pos - lnStart };
    }
    function position(p) {
        pos = p;
        return findLineAndColumnFromPos;
    }

    while(j !== -1) {
        stop = stopIndex > 0;

        if (xml.charCodeAt(j) === 60) { // "<"
            i = j;
        } else {
            i = xml.indexOf('<', j);
        };

        if (i === -1) { // конец разбора

            if (nodestack.length) {
                this.onError('end file', position(j));
                return;
            };

            return;
        };

        if (j !== i && !stop) {
            ok = this.onTextNode(xml.substring(j, i), unEntities, position(j));
            if (ok === false) return;
        };

        w = xml.charCodeAt(i+1);

        if (w === 33) { // "!"
            w = xml.charCodeAt(i+2);
            if (w === 91 && xml.substr(i+3, 6) === 'CDATA[') { // 91 == "["
                j = xml.indexOf(']]>', i);
                if (j === -1) {
                    this.onError('cdata', position(i));
                    return;
                };

                //x = xml.substring(i+9, j);
                if (!stop) {
                    ok = this.onCDATA(xml.substring(i+9, j), false, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            if (w === 45 && xml.charCodeAt(i+3) === 45) { // 45 == "-"
                j = xml.indexOf('-->', i);
                if (j === -1) {
                    this.onError('expected -->', position(i));
                    return;
                };


                if (this.is_onComment && !stop) {
                    ok = this.onComment(xml.substring(i+4, j), unEntities, position(i));
                    if (ok === false) return;
                };

                j += 3;
                continue;
            };

            j = xml.indexOf('>', i+1);
            if (j === -1) {
                this.onError('expected ">"', position(i + 1));
                return;
            };

            if (this.is_onAttention && !stop) {
                ok = this.onAttention(xml.substring(i, j+1), unEntities, position(i));
                if (ok === false) return;
            };

            j += 1;
            continue;

        } else {
            if (w === 63) { // "?"
                j = xml.indexOf('?>', i);
                if (j === -1) { // error
                    this.onError('...?>', position(i));
                    return;
                };

                if (this.is_onQuestion) {
                    ok = this.onQuestion(xml.substring(i, j+2), position(i));
                    if (ok === false) return;
                };

                j += 2;
                continue;
            };
        };

        var inside=false;
        for (k=i,j=-1;k<len;k++) {
            var c = xml.charCodeAt(k);
            if (!inside) {

                if (c === 34) { // '"'
                    inside = c;
                }
                else if (c === 39) { // "'"
                    inside = c;
                }
                else if (c === 62) { // <
                    j = k; break;
                }
            } else {
                if (c === inside) { inside = false; }
            }
        }

        if (j == -1) { // error
            this.onError('...>', position(i + 1));
            return;
        };

        this.attr_res = true; // атрибутов нет

        //if (xml.charCodeAt(i+1) === 47) { // </...
        if (w === 47) { // </...
            tagstart = false;
            tagend = true;

            // проверяем что должен быть закрыт тотже тег что и открывался
            x = elem = nodestack.pop();
            q = i + 2 + x.length;

            //console.log()
            if (xml.substring(i+2, q) !== x) {
                this.onError('close tagname', position(i + 2));
                return;
            };

            // проверим что в закрываюшем теге нет лишнего
            for(; q < j; q++) {
                w = xml.charCodeAt(q);

                if (w===32 || (w > 8 && w<14) ) {  // \f\n\r\t\v пробел
                    continue;
                };

                this.onError('close tag', position(i + 2));
                return;
            };

        } else {
            if (xml.charCodeAt(j-1) ===  47) { // .../>
                x = elem = xml.substring(i+1, j-1);

                tagstart = true;
                tagend = true;
            } else {
                x = elem = xml.substring(i+1, j);

                tagstart = true;
                tagend = false;
            };

            if ( !(w > 96  && w < 123 || w > 64 && w <91) ) {
                this.onError('first char nodeName', position(i + 1));
                return;
            };

            for(q = 1, y = x.length; q < y; q++) {
                w = x.charCodeAt(q);

                if (w > 96 && w < 123 || w > 64 && w < 91 || w > 47 && w < 59 || w === 45 || w === 95 || w === 46 /* https://github.com/telerik/xPlatCore/issues/179 */) {
                    continue;
                };

                if (w===32 || (w<14 && w > 8)) { // \f\n\r\t\v пробел
                    elem = x.substring(0, q)
                    this.attr_res = null; // возможно есть атирибуты
                    break;
                };

                this.onError('invalid nodeName', position(i + 1));
                return;
            };

            if (!tagend) {
                nodestack.push(elem);
            };
        };


        if (this.isNamespace) {
            if (stop) {
                if (tagend) {
                    if (!tagstart) {
                        if (--stopIndex === 0) {
                            this.nsmatrix = stacknsmatrix.pop();
                        };
                    };

                } else {
                    stopIndex += 1;
                };


                j += 1;
                continue;
            };

            _nsmatrix = this.nsmatrix;

            if (!tagend) {
                stacknsmatrix.push(this.nsmatrix);

                if (this.attr_res !== true) {
                    if (this.hasSurmiseNS = x.indexOf('xmlns', q) !== -1) {
                        this.attr_string = x;
                        this.attr_posstart = q;

                        this.getAttrs();

                        this.hasSurmiseNS = false;
                    };
                };
            };


            w = elem.indexOf(':');
            if (w !== -1) {
                xmlns = this.nsmatrix[elem.substring(0, w)];
                elem = elem.substr(w+1);

            } else {
                xmlns = this.nsmatrix.xmlns;
            };

            if (!xmlns) {
                if (tagend) {
                    if (tagstart) {
                        this.nsmatrix = _nsmatrix;
                    } else {
                        this.nsmatrix = stacknsmatrix.pop();
                    };
                } else {
                    stopIndex = 1; // первый элемент для которого не определено пространство имен
                    this.attr_res = true;
                };

                j += 1;
                continue;
            };

            elem = xmlns + ':' + elem;
        };

        //string_node = xml.substring(i, j+1); // текст ноды как есть

        if (tagstart) { // is_onStartNode
            this.attr_string = x;
            this.attr_posstart = q;

            var that = this;
            ok = this.onStartNode(elem, function() { return that.getAttrs() }, unEntities, tagend
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            this.attr_res = true;
        };

        if (tagend) {
            ok = this.onEndNode(elem, unEntities, tagstart
                , getStringNode, position(i)
            );

            if (ok === false) {
                return;
            };

            if (this.isNamespace) {
                if (tagstart) {
                    this.nsmatrix = _nsmatrix;
                } else {
                    this.nsmatrix = stacknsmatrix.pop();
                };
            };
        };

        j += 1;
    };
};


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/esprima/esprima.js":
/***/ (function(module, exports) {

﻿/*
  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/

(function (global) {
    'use strict';

    var Token,
        TokenName,
        Syntax,
        Messages,
        source,
        index,
        length,
        delegate,
        lookahead,
        state;

    Token = {
        BooleanLiteral: 1,
        EOF: 2,
        Identifier: 3,
        Keyword: 4,
        NullLiteral: 5,
        NumericLiteral: 6,
        Punctuator: 7,
        StringLiteral: 8
    };

    TokenName = {};
    TokenName[Token.BooleanLiteral] = 'Boolean';
    TokenName[Token.EOF] = '<end>';
    TokenName[Token.Identifier] = 'Identifier';
    TokenName[Token.Keyword] = 'Keyword';
    TokenName[Token.NullLiteral] = 'Null';
    TokenName[Token.NumericLiteral] = 'Numeric';
    TokenName[Token.Punctuator] = 'Punctuator';
    TokenName[Token.StringLiteral] = 'String';

    Syntax = {
        ArrayExpression: 'ArrayExpression',
        BinaryExpression: 'BinaryExpression',
        CallExpression: 'CallExpression',
        ConditionalExpression: 'ConditionalExpression',
        EmptyStatement: 'EmptyStatement',
        ExpressionStatement: 'ExpressionStatement',
        Identifier: 'Identifier',
        Literal: 'Literal',
        LabeledStatement: 'LabeledStatement',
        LogicalExpression: 'LogicalExpression',
        MemberExpression: 'MemberExpression',
        ObjectExpression: 'ObjectExpression',
        Program: 'Program',
        Property: 'Property',
        ThisExpression: 'ThisExpression',
        UnaryExpression: 'UnaryExpression'
    };

    // Error messages should be identical to V8.
    Messages = {
        UnexpectedToken: 'Unexpected token %0',
        UnknownLabel: 'Undefined label \'%0\'',
        Redeclaration: '%0 \'%1\' has already been declared'
    };

    // Ensure the condition is true, otherwise throw an error.
    // This is only to have a better contract semantic, i.e. another safety net
    // to catch a logic error. The condition shall be fulfilled in normal case.
    // Do NOT use this to enforce a certain condition on any user input.

    function assert(condition, message) {
        if (!condition) {
            throw new Error('ASSERT: ' + message);
        }
    }

    function isDecimalDigit(ch) {
        return (ch >= 48 && ch <= 57);   // 0..9
    }


    // 7.2 White Space

    function isWhiteSpace(ch) {
        return (ch === 32) ||  // space
            (ch === 9) ||      // tab
            (ch === 0xB) ||
            (ch === 0xC) ||
            (ch === 0xA0) ||
            (ch >= 0x1680 && '\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\uFEFF'.indexOf(String.fromCharCode(ch)) > 0);
    }

    // 7.3 Line Terminators

    function isLineTerminator(ch) {
        return (ch === 10) || (ch === 13) || (ch === 0x2028) || (ch === 0x2029);
    }

    // 7.6 Identifier Names and Identifiers

    function isIdentifierStart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122);          // a..z
    }

    function isIdentifierPart(ch) {
        return (ch === 36) || (ch === 95) ||  // $ (dollar) and _ (underscore)
            (ch >= 65 && ch <= 90) ||         // A..Z
            (ch >= 97 && ch <= 122) ||        // a..z
            (ch >= 48 && ch <= 57);           // 0..9
    }

    // 7.6.1.1 Keywords

    function isKeyword(id) {
        return (id === 'this')
    }

    // 7.4 Comments

    function skipWhitespace() {
        while (index < length && isWhiteSpace(source.charCodeAt(index))) {
            ++index;
        }
    }

    function getIdentifier() {
        var start, ch;

        start = index++;
        while (index < length) {
            ch = source.charCodeAt(index);
            if (isIdentifierPart(ch)) {
                ++index;
            } else {
                break;
            }
        }

        return source.slice(start, index);
    }

    function scanIdentifier() {
        var start, id, type;

        start = index;

        id = getIdentifier();

        // There is no keyword or literal with only one character.
        // Thus, it must be an identifier.
        if (id.length === 1) {
            type = Token.Identifier;
        } else if (isKeyword(id)) {
            type = Token.Keyword;
        } else if (id === 'null') {
            type = Token.NullLiteral;
        } else if (id === 'true' || id === 'false') {
            type = Token.BooleanLiteral;
        } else {
            type = Token.Identifier;
        }

        return {
            type: type,
            value: id,
            range: [start, index]
        };
    }


    // 7.7 Punctuators

    function scanPunctuator() {
        var start = index,
            code = source.charCodeAt(index),
            code2,
            ch1 = source[index],
            ch2;

        switch (code) {

            // Check for most common single-character punctuators.
            case 46:   // . dot
            case 40:   // ( open bracket
            case 41:   // ) close bracket
            case 59:   // ; semicolon
            case 44:   // , comma
            case 123:  // { open curly brace
            case 125:  // } close curly brace
            case 91:   // [
            case 93:   // ]
            case 58:   // :
            case 63:   // ?
                ++index;
                return {
                    type: Token.Punctuator,
                    value: String.fromCharCode(code),
                    range: [start, index]
                };

            default:
                code2 = source.charCodeAt(index + 1);

                // '=' (char #61) marks an assignment or comparison operator.
                if (code2 === 61) {
                    switch (code) {
                        case 37:  // %
                        case 38:  // &
                        case 42:  // *:
                        case 43:  // +
                        case 45:  // -
                        case 47:  // /
                        case 60:  // <
                        case 62:  // >
                        case 124: // |
                            index += 2;
                            return {
                                type: Token.Punctuator,
                                value: String.fromCharCode(code) + String.fromCharCode(code2),
                                range: [start, index]
                            };

                        case 33: // !
                        case 61: // =
                            index += 2;

                            // !== and ===
                            if (source.charCodeAt(index) === 61) {
                                ++index;
                            }
                            return {
                                type: Token.Punctuator,
                                value: source.slice(start, index),
                                range: [start, index]
                            };
                        default:
                            break;
                    }
                }
                break;
        }

        // Peek more characters.

        ch2 = source[index + 1];

        // Other 2-character punctuators: && ||

        if (ch1 === ch2 && ('&|'.indexOf(ch1) >= 0)) {
            index += 2;
            return {
                type: Token.Punctuator,
                value: ch1 + ch2,
                range: [start, index]
            };
        }

        if ('<>=!+-*%&|^/'.indexOf(ch1) >= 0) {
            ++index;
            return {
                type: Token.Punctuator,
                value: ch1,
                range: [start, index]
            };
        }

        throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
    }

    // 7.8.3 Numeric Literals
    function scanNumericLiteral() {
        var number, start, ch;

        ch = source[index];
        assert(isDecimalDigit(ch.charCodeAt(0)) || (ch === '.'),
            'Numeric literal must start with a decimal digit or a decimal point');

        start = index;
        number = '';
        if (ch !== '.') {
            number = source[index++];
            ch = source[index];

            // Hex number starts with '0x'.
            // Octal number starts with '0'.
            if (number === '0') {
                // decimal number starts with '0' such as '09' is illegal.
                if (ch && isDecimalDigit(ch.charCodeAt(0))) {
                    throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
                }
            }

            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === '.') {
            number += source[index++];
            while (isDecimalDigit(source.charCodeAt(index))) {
                number += source[index++];
            }
            ch = source[index];
        }

        if (ch === 'e' || ch === 'E') {
            number += source[index++];

            ch = source[index];
            if (ch === '+' || ch === '-') {
                number += source[index++];
            }
            if (isDecimalDigit(source.charCodeAt(index))) {
                while (isDecimalDigit(source.charCodeAt(index))) {
                    number += source[index++];
                }
            } else {
                throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
            }
        }

        if (isIdentifierStart(source.charCodeAt(index))) {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.NumericLiteral,
            value: parseFloat(number),
            range: [start, index]
        };
    }

    // 7.8.4 String Literals

    function scanStringLiteral() {
        var str = '', quote, start, ch, octal = false;

        quote = source[index];
        assert((quote === '\'' || quote === '"'),
            'String literal must starts with a quote');

        start = index;
        ++index;

        while (index < length) {
            ch = source[index++];

            if (ch === quote) {
                quote = '';
                break;
            } else if (ch === '\\') {
                ch = source[index++];
                if (!ch || !isLineTerminator(ch.charCodeAt(0))) {
                    switch (ch) {
                        case 'n':
                            str += '\n';
                            break;
                        case 'r':
                            str += '\r';
                            break;
                        case 't':
                            str += '\t';
                            break;
                        case 'b':
                            str += '\b';
                            break;
                        case 'f':
                            str += '\f';
                            break;
                        case 'v':
                            str += '\x0B';
                            break;

                        default:
                            str += ch;
                            break;
                    }
                } else {
                    if (ch === '\r' && source[index] === '\n') {
                        ++index;
                    }
                }
            } else if (isLineTerminator(ch.charCodeAt(0))) {
                break;
            } else {
                str += ch;
            }
        }

        if (quote !== '') {
            throwError({}, Messages.UnexpectedToken, 'ILLEGAL');
        }

        return {
            type: Token.StringLiteral,
            value: str,
            octal: octal,
            range: [start, index]
        };
    }

    function isIdentifierName(token) {
        return token.type === Token.Identifier ||
            token.type === Token.Keyword ||
            token.type === Token.BooleanLiteral ||
            token.type === Token.NullLiteral;
    }

    function advance() {
        var ch;

        skipWhitespace();

        if (index >= length) {
            return {
                type: Token.EOF,
                range: [index, index]
            };
        }

        ch = source.charCodeAt(index);

        // Very common: ( and ) and ;
        if (ch === 40 || ch === 41 || ch === 58) {
            return scanPunctuator();
        }

        // String literal starts with single quote (#39) or double quote (#34).
        if (ch === 39 || ch === 34) {
            return scanStringLiteral();
        }

        if (isIdentifierStart(ch)) {
            return scanIdentifier();
        }

        // Dot (.) char #46 can also start a floating-point number, hence the need
        // to check the next character.
        if (ch === 46) {
            if (isDecimalDigit(source.charCodeAt(index + 1))) {
                return scanNumericLiteral();
            }
            return scanPunctuator();
        }

        if (isDecimalDigit(ch)) {
            return scanNumericLiteral();
        }

        return scanPunctuator();
    }

    function lex() {
        var token;

        token = lookahead;
        index = token.range[1];

        lookahead = advance();

        index = token.range[1];

        return token;
    }

    function peek() {
        var pos;

        pos = index;
        lookahead = advance();
        index = pos;
    }

    // Throw an exception

    function throwError(token, messageFormat) {
        var error,
            args = Array.prototype.slice.call(arguments, 2),
            msg = messageFormat.replace(
                /%(\d)/g,
                function (whole, index) {
                    assert(index < args.length, 'Message reference must be in range');
                    return args[index];
                }
            );

        error = new Error(msg);
        error.index = index;
        error.description = msg;
        throw error;
    }

    // Throw an exception because of the token.

    function throwUnexpected(token) {
        throwError(token, Messages.UnexpectedToken, token.value);
    }

    // Expect the next token to match the specified punctuator.
    // If not, an exception will be thrown.

    function expect(value) {
        var token = lex();
        if (token.type !== Token.Punctuator || token.value !== value) {
            throwUnexpected(token);
        }
    }

    // Return true if the next token matches the specified punctuator.

    function match(value) {
        return lookahead.type === Token.Punctuator && lookahead.value === value;
    }

    // Return true if the next token matches the specified keyword

    function matchKeyword(keyword) {
        return lookahead.type === Token.Keyword && lookahead.value === keyword;
    }

    function consumeSemicolon() {
        // Catch the very common case first: immediately a semicolon (char #59).
        if (source.charCodeAt(index) === 59) {
            lex();
            return;
        }

        skipWhitespace();

        if (match(';')) {
            lex();
            return;
        }

        if (lookahead.type !== Token.EOF && !match('}')) {
            throwUnexpected(lookahead);
        }
    }

    // 11.1.4 Array Initialiser

    function parseArrayInitialiser() {
        var elements = [];

        expect('[');

        while (!match(']')) {
            if (match(',')) {
                lex();
                elements.push(null);
            } else {
                elements.push(parseExpression());

                if (!match(']')) {
                    expect(',');
                }
            }
        }

        expect(']');

        return delegate.createArrayExpression(elements);
    }

    // 11.1.5 Object Initialiser

    function parseObjectPropertyKey() {
        var token;

        skipWhitespace();
        token = lex();

        // Note: This function is called only from parseObjectProperty(), where
        // EOF and Punctuator tokens are already filtered out.
        if (token.type === Token.StringLiteral || token.type === Token.NumericLiteral) {
            return delegate.createLiteral(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseObjectProperty() {
        var token, key;

        token = lookahead;
        skipWhitespace();

        if (token.type === Token.EOF || token.type === Token.Punctuator) {
            throwUnexpected(token);
        }

        key = parseObjectPropertyKey();
        expect(':');
        return delegate.createProperty('init', key, parseExpression());
    }

    function parseObjectInitialiser() {
        var properties = [];

        expect('{');

        while (!match('}')) {
            properties.push(parseObjectProperty());

            if (!match('}')) {
                expect(',');
            }
        }

        expect('}');

        return delegate.createObjectExpression(properties);
    }

    // 11.1.6 The Grouping Operator

    function parseGroupExpression() {
        var expr;

        expect('(');

        expr = parseExpression();

        expect(')');

        return expr;
    }


    // 11.1 Primary Expressions

    function parsePrimaryExpression() {
        var type, token, expr;

        if (match('(')) {
            return parseGroupExpression();
        }

        type = lookahead.type;

        if (type === Token.Identifier) {
            expr = delegate.createIdentifier(lex().value);
        } else if (type === Token.StringLiteral || type === Token.NumericLiteral) {
            expr = delegate.createLiteral(lex());
        } else if (type === Token.Keyword) {
            if (matchKeyword('this')) {
                lex();
                expr = delegate.createThisExpression();
            }
        } else if (type === Token.BooleanLiteral) {
            token = lex();
            token.value = (token.value === 'true');
            expr = delegate.createLiteral(token);
        } else if (type === Token.NullLiteral) {
            token = lex();
            token.value = null;
            expr = delegate.createLiteral(token);
        } else if (match('[')) {
            expr = parseArrayInitialiser();
        } else if (match('{')) {
            expr = parseObjectInitialiser();
        }

        if (expr) {
            return expr;
        }

        throwUnexpected(lex());
    }

    // 11.2 Left-Hand-Side Expressions

    function parseArguments() {
        var args = [];

        expect('(');

        if (!match(')')) {
            while (index < length) {
                args.push(parseExpression());
                if (match(')')) {
                    break;
                }
                expect(',');
            }
        }

        expect(')');

        return args;
    }

    function parseNonComputedProperty() {
        var token;

        token = lex();

        if (!isIdentifierName(token)) {
            throwUnexpected(token);
        }

        return delegate.createIdentifier(token.value);
    }

    function parseNonComputedMember() {
        expect('.');

        return parseNonComputedProperty();
    }

    function parseComputedMember() {
        var expr;

        expect('[');

        expr = parseExpression();

        expect(']');

        return expr;
    }

    function parseLeftHandSideExpression() {
        var expr, args, property;

        expr = parsePrimaryExpression();

        while (true) {
            if (match('[')) {
                property = parseComputedMember();
                expr = delegate.createMemberExpression('[', expr, property);
            } else if (match('.')) {
                property = parseNonComputedMember();
                expr = delegate.createMemberExpression('.', expr, property);
            } else if (match('(')) {
                args = parseArguments();
                expr = delegate.createCallExpression(expr, args);
            } else {
                break;
            }
        }

        return expr;
    }

    // 11.3 Postfix Expressions

    var parsePostfixExpression = parseLeftHandSideExpression;

    // 11.4 Unary Operators

    function parseUnaryExpression() {
        var token, expr;

        if (lookahead.type !== Token.Punctuator && lookahead.type !== Token.Keyword) {
            expr = parsePostfixExpression();
        } else if (match('+') || match('-') || match('!')) {
            token = lex();
            expr = parseUnaryExpression();
            expr = delegate.createUnaryExpression(token.value, expr);
        } else if (matchKeyword('delete') || matchKeyword('void') || matchKeyword('typeof')) {
            throwError({}, Messages.UnexpectedToken);
        } else {
            expr = parsePostfixExpression();
        }

        return expr;
    }

    function binaryPrecedence(token) {
        var prec = 0;

        if (token.type !== Token.Punctuator && token.type !== Token.Keyword) {
            return 0;
        }

        switch (token.value) {
            case '||':
                prec = 1;
                break;

            case '&&':
                prec = 2;
                break;

            case '==':
            case '!=':
            case '===':
            case '!==':
                prec = 6;
                break;

            case '<':
            case '>':
            case '<=':
            case '>=':
            case 'instanceof':
                prec = 7;
                break;

            case 'in':
                prec = 7;
                break;

            case '+':
            case '-':
                prec = 9;
                break;

            case '*':
            case '/':
            case '%':
                prec = 11;
                break;

            default:
                break;
        }

        return prec;
    }

    // 11.5 Multiplicative Operators
    // 11.6 Additive Operators
    // 11.7 Bitwise Shift Operators
    // 11.8 Relational Operators
    // 11.9 Equality Operators
    // 11.10 Binary Bitwise Operators
    // 11.11 Binary Logical Operators

    function parseBinaryExpression() {
        var expr, token, prec, stack, right, operator, left, i;

        left = parseUnaryExpression();

        token = lookahead;
        prec = binaryPrecedence(token);
        if (prec === 0) {
            return left;
        }
        token.prec = prec;
        lex();

        right = parseUnaryExpression();

        stack = [left, token, right];

        while ((prec = binaryPrecedence(lookahead)) > 0) {

            // Reduce: make a binary expression from the three topmost entries.
            while ((stack.length > 2) && (prec <= stack[stack.length - 2].prec)) {
                right = stack.pop();
                operator = stack.pop().value;
                left = stack.pop();
                expr = delegate.createBinaryExpression(operator, left, right);
                stack.push(expr);
            }

            // Shift.
            token = lex();
            token.prec = prec;
            stack.push(token);
            expr = parseUnaryExpression();
            stack.push(expr);
        }

        // Final reduce to clean-up the stack.
        i = stack.length - 1;
        expr = stack[i];
        while (i > 1) {
            expr = delegate.createBinaryExpression(stack[i - 1].value, stack[i - 2], expr);
            i -= 2;
        }

        return expr;
    }


    // 11.12 Conditional Operator

    function parseConditionalExpression() {
        var expr, consequent, alternate;

        expr = parseBinaryExpression();

        if (match('?')) {
            lex();
            consequent = parseConditionalExpression();
            expect(':');
            alternate = parseConditionalExpression();

            expr = delegate.createConditionalExpression(expr, consequent, alternate);
        }

        return expr;
    }

    // Simplification since we do not support AssignmentExpression.
    var parseExpression = parseConditionalExpression;

    // Polymer Syntax extensions

    // Filter ::
    //   Identifier
    //   Identifier "(" ")"
    //   Identifier "(" FilterArguments ")"

    function parseFilter() {
        var identifier, args;

        identifier = lex();

        if (identifier.type !== Token.Identifier) {
            throwUnexpected(identifier);
        }

        args = match('(') ? parseArguments() : [];

        return delegate.createFilter(identifier.value, args);
    }

    // Filters ::
    //   "|" Filter
    //   Filters "|" Filter

    function parseFilters() {
        while (match('|')) {
            lex();
            parseFilter();
        }
    }

    // TopLevel ::
    //   LabelledExpressions
    //   AsExpression
    //   InExpression
    //   FilterExpression

    // AsExpression ::
    //   FilterExpression as Identifier

    // InExpression ::
    //   Identifier, Identifier in FilterExpression
    //   Identifier in FilterExpression

    // FilterExpression ::
    //   Expression
    //   Expression Filters

    function parseTopLevel() {
        skipWhitespace();
        peek();

        var expr = parseExpression();
        if (expr) {
            if (lookahead.value === ',' || lookahead.value == 'in' &&
                       expr.type === Syntax.Identifier) {
                parseInExpression(expr);
            } else {
                parseFilters();
                if (lookahead.value === 'as') {
                    parseAsExpression(expr);
                } else {
                    delegate.createTopLevel(expr);
                }
            }
        }

        if (lookahead.type !== Token.EOF) {
            throwUnexpected(lookahead);
        }
    }

    function parseAsExpression(expr) {
        lex();  // as
        var identifier = lex().value;
        delegate.createAsExpression(expr, identifier);
    }

    function parseInExpression(identifier) {
        var indexName;
        if (lookahead.value === ',') {
            lex();
            if (lookahead.type !== Token.Identifier)
                throwUnexpected(lookahead);
            indexName = lex().value;
        }

        lex();  // in
        var expr = parseExpression();
        parseFilters();
        delegate.createInExpression(identifier.name, indexName, expr);
    }

    function parse(code, inDelegate) {
        delegate = inDelegate;
        source = code;
        index = 0;
        length = source.length;
        lookahead = null;
        state = {
            labelSet: {}
        };

        return parseTopLevel();
    }

    global.esprima = {
        parse: parse
    };
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
﻿/*
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */



function detectEval() {
    // Don't test for eval if we're running in a Chrome App environment.
    // We check for APIs set that only exist in a Chrome App context.
    if (typeof chrome !== 'undefined' && chrome.app && chrome.app.runtime) {
        return false;
    }

    // Firefox OS Apps do not allow eval. This feature detection is very hacky
    // but even if some other platform adds support for this function this code
    // will continue to work.
    if (typeof navigator != 'undefined' && navigator.getDeviceStorage) {
        return false;
    }

    try {
        var f = new Function('', 'return true;');
        return f();
    } catch (ex) {
        return false;
    }
}

var hasEval = detectEval();

function isIndex(s) {
    return +s === s >>> 0 && s !== '';
}

function toNumber(s) {
    return +s;
}

function isObject(obj) {
    return obj === Object(obj);
}

var numberIsNaN = Number.isNaN || function (value) {
    return typeof value === 'number' && isNaN(value);
}

function areSameValue(left, right) {
    if (left === right)
        return left !== 0 || 1 / left === 1 / right;
    if (numberIsNaN(left) && numberIsNaN(right))
        return true;

    return left !== left && right !== right;
}

var createObject = ('__proto__' in {}) ?
  function (obj) { return obj; } :
  function (obj) {
      var proto = obj.__proto__;
      if (!proto)
          return obj;
      var newObject = Object.create(proto);
      Object.getOwnPropertyNames(obj).forEach(function (name) {
          Object.defineProperty(newObject, name,
                               Object.getOwnPropertyDescriptor(obj, name));
      });
      return newObject;
  };

var identStart = '[\$_a-zA-Z]';
var identPart = '[\$_a-zA-Z0-9]';
var identRegExp = new RegExp('^' + identStart + '+' + identPart + '*' + '$');

function getPathCharType(char) {
    if (char === undefined)
        return 'eof';

    var code = char.charCodeAt(0);

    switch (code) {
        case 0x5B: // [
        case 0x5D: // ]
        case 0x2E: // .
        case 0x22: // "
        case 0x27: // '
        case 0x30: // 0
            return char;

        case 0x5F: // _
        case 0x24: // $
            return 'ident';

        case 0x20: // Space
        case 0x09: // Tab
        case 0x0A: // Newline
        case 0x0D: // Return
        case 0xA0:  // No-break space
        case 0xFEFF:  // Byte Order Mark
        case 0x2028:  // Line Separator
        case 0x2029:  // Paragraph Separator
            return 'ws';
    }

    // a-z, A-Z
    if ((0x61 <= code && code <= 0x7A) || (0x41 <= code && code <= 0x5A))
        return 'ident';

    // 1-9
    if (0x31 <= code && code <= 0x39)
        return 'number';

    return 'else';
}

var pathStateMachine = {
    'beforePath': {
        'ws': ['beforePath'],
        'ident': ['inIdent', 'append'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'inPath': {
        'ws': ['inPath'],
        '.': ['beforeIdent'],
        '[': ['beforeElement'],
        'eof': ['afterPath']
    },

    'beforeIdent': {
        'ws': ['beforeIdent'],
        'ident': ['inIdent', 'append']
    },

    'inIdent': {
        'ident': ['inIdent', 'append'],
        '0': ['inIdent', 'append'],
        'number': ['inIdent', 'append'],
        'ws': ['inPath', 'push'],
        '.': ['beforeIdent', 'push'],
        '[': ['beforeElement', 'push'],
        'eof': ['afterPath', 'push']
    },

    'beforeElement': {
        'ws': ['beforeElement'],
        '0': ['afterZero', 'append'],
        'number': ['inIndex', 'append'],
        "'": ['inSingleQuote', 'append', ''],
        '"': ['inDoubleQuote', 'append', '']
    },

    'afterZero': {
        'ws': ['afterElement', 'push'],
        ']': ['inPath', 'push']
    },

    'inIndex': {
        '0': ['inIndex', 'append'],
        'number': ['inIndex', 'append'],
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    },

    'inSingleQuote': {
        "'": ['afterElement'],
        'eof': ['error'],
        'else': ['inSingleQuote', 'append']
    },

    'inDoubleQuote': {
        '"': ['afterElement'],
        'eof': ['error'],
        'else': ['inDoubleQuote', 'append']
    },

    'afterElement': {
        'ws': ['afterElement'],
        ']': ['inPath', 'push']
    }
}

function noop() { }

function parsePath(path) {
    var keys = [];
    var index = -1;
    var c, newChar, key, type, transition, action, typeMap, mode = 'beforePath';

    var actions = {
        push: function () {
            if (key === undefined)
                return;

            keys.push(key);
            key = undefined;
        },

        append: function () {
            if (key === undefined)
                key = newChar
            else
                key += newChar;
        }
    };

    function maybeUnescapeQuote() {
        if (index >= path.length)
            return;

        var nextChar = path[index + 1];
        if ((mode == 'inSingleQuote' && nextChar == "'") ||
            (mode == 'inDoubleQuote' && nextChar == '"')) {
            index++;
            newChar = nextChar;
            actions.append();
            return true;
        }
    }

    while (mode) {
        index++;
        c = path[index];

        if (c == '\\' && maybeUnescapeQuote(mode))
            continue;

        type = getPathCharType(c);
        typeMap = pathStateMachine[mode];
        transition = typeMap[type] || typeMap['else'] || 'error';

        if (transition == 'error')
            return; // parse error;

        mode = transition[0];
        action = actions[transition[1]] || noop;
        newChar = transition[2] === undefined ? c : transition[2];
        action();

        if (mode === 'afterPath') {
            return keys;
        }
    }

    return; // parse error
}

function isIdent(s) {
    return identRegExp.test(s);
}

var constructorIsPrivate = {};

function Path(parts, privateToken) {
    if (privateToken !== constructorIsPrivate)
        throw Error('Use Path.get to retrieve path objects');

    for (var i = 0; i < parts.length; i++) {
        this.push(String(parts[i]));
    }

    if (hasEval && this.length) {
        this.getValueFrom = this.compiledGetValueFromFn();
    }
}

// TODO(rafaelw): Make simple LRU cache
var pathCache = {};

function getPath(pathString) {
    if (pathString instanceof Path)
        return pathString;

    if (pathString == null || pathString.length == 0)
        pathString = '';

    if (typeof pathString != 'string') {
        if (isIndex(pathString.length)) {
            // Constructed with array-like (pre-parsed) keys
            return new Path(pathString, constructorIsPrivate);
        }

        pathString = String(pathString);
    }

    var path = pathCache[pathString];
    if (path)
        return path;

    var parts = parsePath(pathString);
    if (!parts)
        return invalidPath;

    var path = new Path(parts, constructorIsPrivate);
    pathCache[pathString] = path;
    return path;
}

Path.get = getPath;

function formatAccessor(key) {
    if (isIndex(key)) {
        return '[' + key + ']';
    } else {
        return '["' + key.replace(/"/g, '\\"') + '"]';
    }
}

Path.prototype = createObject({
    __proto__: [],
    valid: true,

    toString: function () {
        var pathString = '';
        for (var i = 0; i < this.length; i++) {
            var key = this[i];
            if (isIdent(key)) {
                pathString += i ? '.' + key : key;
            } else {
                pathString += formatAccessor(key);
            }
        }

        return pathString;
    },

    getValueFrom: function (obj, directObserver) {
        for (var i = 0; i < this.length; i++) {
            if (obj == null)
                return;
            obj = obj[this[i]];
        }
        return obj;
    },

    iterateObjects: function (obj, observe) {
        for (var i = 0; i < this.length; i++) {
            if (i)
                obj = obj[this[i - 1]];
            if (!isObject(obj))
                return;
            observe(obj, this[i]);
        }
    },

    compiledGetValueFromFn: function () {
        var str = '';
        var pathString = 'obj';
        str += 'if (obj != null';
        var i = 0;
        var key;
        for (; i < (this.length - 1) ; i++) {
            key = this[i];
            pathString += isIdent(key) ? '.' + key : formatAccessor(key);
            str += ' &&\n     ' + pathString + ' != null';
        }
        str += ')\n';

        var key = this[i];
        pathString += isIdent(key) ? '.' + key : formatAccessor(key);

        str += '  return ' + pathString + ';\nelse\n  return undefined;';
        return new Function('obj', str);
    },

    setValueFrom: function (obj, value) {
        if (!this.length)
            return false;

        for (var i = 0; i < this.length - 1; i++) {
            if (!isObject(obj))
                return false;
            obj = obj[this[i]];
        }

        if (!isObject(obj))
            return false;

        obj[this[i]] = value;
        return true;
    }
});

var invalidPath = new Path('', constructorIsPrivate);
invalidPath.valid = false;
invalidPath.getValueFrom = invalidPath.setValueFrom = function () { };

exports.Path = Path;


/***/ }),

/***/ "../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js":
/***/ (function(module, exports, __webpack_require__) {

﻿// Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
// This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
// The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
// The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
// Code distributed by Google as part of the polymer project is also
// subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt

var esprima = __webpack_require__("../node_modules/tns-core-modules/js-libs/esprima/esprima.js").esprima;
var Path = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/path-parser.js").Path;

(function (global) {
    'use strict';

    // TODO(rafaelw): Implement simple LRU.
    var expressionParseCache = Object.create(null);

    function getExpression(expressionText) {
        var expression = expressionParseCache[expressionText];
        if (!expression) {
            var delegate = new ASTDelegate();
            esprima.parse(expressionText, delegate);
            expression = new Expression(delegate);
            expressionParseCache[expressionText] = expression;
        }
        return expression;
    }

    function Literal(value) {
        this.value = value;
        this.valueFn_ = undefined;
    }

    Literal.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var value = this.value;
                this.valueFn_ = function () {
                    return value;
                }
            }

            return this.valueFn_;
        }
    }

    function IdentPath(name) {
        this.name = name;
        this.path = Path.get(name);
    }

    IdentPath.prototype = {
        valueFn: function () {
            if (!this.valueFn_) {
                var name = this.name;
                var path = this.path;
                this.valueFn_ = function (model, observer, changedModel) {
                    if (observer)
                        observer.addPath(model, path);

                    if (changedModel) {
                        var result = path.getValueFrom(changedModel);
                        if (result !== undefined) {
                            return result;
                        }
                    }

                    return path.getValueFrom(model);
                }
            }

            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.path.length == 1) {
                model = findScope(model, this.path[0]);
            }

            return this.path.setValueFrom(model, newValue);
        }
    };

    function MemberExpression(object, property, accessor) {
        this.computed = accessor == '[';

        this.dynamicDeps = typeof object == 'function' ||
                           object.dynamicDeps ||
                           (this.computed && !(property instanceof Literal));

        this.simplePath =
            !this.dynamicDeps &&
            (property instanceof IdentPath || property instanceof Literal) &&
            (object instanceof MemberExpression || object instanceof IdentPath);

        this.object = this.simplePath ? object : getFn(object);
        this.property = !this.computed || this.simplePath ?
            property : getFn(property);
    }

    MemberExpression.prototype = {
        get fullPath() {
            if (!this.fullPath_) {

                var parts = this.object instanceof MemberExpression ?
                    this.object.fullPath.slice() : [this.object.name];
                parts.push(this.property instanceof IdentPath ?
                    this.property.name : this.property.value);
                this.fullPath_ = Path.get(parts);
            }

            return this.fullPath_;
        },

        valueFn: function () {
            if (!this.valueFn_) {
                var object = this.object;

                if (this.simplePath) {
                    var path = this.fullPath;

                    this.valueFn_ = function (model, observer) {
                        if (observer)
                            observer.addPath(model, path);

                        return path.getValueFrom(model);
                    };
                } else if (!this.computed) {
                    var path = Path.get(this.property.name);

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);

                        if (observer)
                            observer.addPath(context, path);

                        return path.getValueFrom(context);
                    }
                } else {
                    // Computed property.
                    var property = this.property;

                    this.valueFn_ = function (model, observer, filterRegistry) {
                        var context = object(model, observer, filterRegistry);
                        var propName = property(model, observer, filterRegistry);
                        if (observer)
                            observer.addPath(context, [propName]);

                        return context ? context[propName] : undefined;
                    };
                }
            }
            return this.valueFn_;
        },

        setValue: function (model, newValue) {
            if (this.simplePath) {
                this.fullPath.setValueFrom(model, newValue);
                return newValue;
            }

            var object = this.object(model);
            var propName = this.property instanceof IdentPath ? this.property.name :
                this.property(model);
            return object[propName] = newValue;
        }
    };

    function Filter(name, args) {
        this.name = name;
        this.args = [];
        for (var i = 0; i < args.length; i++) {
            this.args[i] = getFn(args[i]);
        }
    }

    Filter.prototype = {
        transform: function (model, observer, filterRegistry, toModelDirection,
                            initialArgs) {
            var fn = filterRegistry[this.name];
            var context = model;
            if (fn) {
                context = undefined;
            } else {
                fn = context[this.name];
                if (!fn) {
                    console.error('Cannot find function or filter: ' + this.name);
                    return;
                }
            }

            // If toModelDirection is falsey, then the "normal" (dom-bound) direction
            // is used. Otherwise, it looks for a 'toModel' property function on the
            // object.
            if (toModelDirection) {
                fn = fn.toModel;
            } else if (typeof fn.toView == 'function') {
                fn = fn.toView;
            }

            if (typeof fn != 'function') {
                console.error('Cannot find function or filter: ' + this.name);
                return;
            }

            var args = initialArgs || [];
            for (var i = 0; i < this.args.length; i++) {
                args.push(getFn(this.args[i])(model, observer, filterRegistry));
            }

            return fn.apply(context, args);
        }
    };

    function notImplemented() { throw Error('Not Implemented'); }

    var unaryOperators = {
        '+': function (v) { return +v; },
        '-': function (v) { return -v; },
        '!': function (v) { return !v; }
    };

    var binaryOperators = {
        '+': function (l, r) { return l + r; },
        '-': function (l, r) { return l - r; },
        '*': function (l, r) { return l * r; },
        '/': function (l, r) { return l / r; },
        '%': function (l, r) { return l % r; },
        '<': function (l, r) { return l < r; },
        '>': function (l, r) { return l > r; },
        '<=': function (l, r) { return l <= r; },
        '>=': function (l, r) { return l >= r; },
        '==': function (l, r) { return l == r; },
        '!=': function (l, r) { return l != r; },
        '===': function (l, r) { return l === r; },
        '!==': function (l, r) { return l !== r; },
        '&&': function (l, r) { return l && r; },
        '||': function (l, r) { return l || r; },
    };

    function getFn(arg) {
        return typeof arg == 'function' ? arg : arg.valueFn();
    }

    function ASTDelegate() {
        this.expression = null;
        this.filters = [];
        this.deps = {};
        this.currentPath = undefined;
        this.scopeIdent = undefined;
        this.indexIdent = undefined;
        this.dynamicDeps = false;
    }

    ASTDelegate.prototype = {
        createUnaryExpression: function (op, argument) {
            if (!unaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            argument = getFn(argument);

            return function (model, observer, filterRegistry) {
                return unaryOperators[op](argument(model, observer, filterRegistry));
            };
        },

        createBinaryExpression: function (op, left, right) {
            if (!binaryOperators[op])
                throw Error('Disallowed operator: ' + op);

            left = getFn(left);
            right = getFn(right);

            switch (op) {
                case '||':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) ||
                            right(model, observer, filterRegistry);
                    };
                case '&&':
                    this.dynamicDeps = true;
                    return function (model, observer, filterRegistry) {
                        return left(model, observer, filterRegistry) &&
                            right(model, observer, filterRegistry);
                    };
            }

            return function (model, observer, filterRegistry) {
                return binaryOperators[op](left(model, observer, filterRegistry),
                                           right(model, observer, filterRegistry));
            };
        },

        createConditionalExpression: function (test, consequent, alternate) {
            test = getFn(test);
            consequent = getFn(consequent);
            alternate = getFn(alternate);

            this.dynamicDeps = true;

            return function (model, observer, filterRegistry) {
                return test(model, observer, filterRegistry) ?
                    consequent(model, observer, filterRegistry) :
                    alternate(model, observer, filterRegistry);
            }
        },

        createIdentifier: function (name) {
            var ident = new IdentPath(name);
            ident.type = 'Identifier';
            return ident;
        },

        createMemberExpression: function (accessor, object, property) {
            var ex = new MemberExpression(object, property, accessor);
            if (ex.dynamicDeps)
                this.dynamicDeps = true;
            return ex;
        },

        createCallExpression: function (expression, args) {
            if (!(expression instanceof IdentPath))
                throw Error('Only identifier function invocations are allowed');

            var filter = new Filter(expression.name, args);

            return function (model, observer, filterRegistry) {
                return filter.transform(model, observer, filterRegistry, false);
            };
        },

        createLiteral: function (token) {
            return new Literal(token.value);
        },

        createArrayExpression: function (elements) {
            for (var i = 0; i < elements.length; i++)
                elements[i] = getFn(elements[i]);

            return function (model, observer, filterRegistry) {
                var arr = []
                for (var i = 0; i < elements.length; i++)
                    arr.push(elements[i](model, observer, filterRegistry));
                return arr;
            }
        },

        createProperty: function (kind, key, value) {
            return {
                key: key instanceof IdentPath ? key.name : key.value,
                value: value
            };
        },

        createObjectExpression: function (properties) {
            for (var i = 0; i < properties.length; i++)
                properties[i].value = getFn(properties[i].value);

            return function (model, observer, filterRegistry) {
                var obj = {};
                for (var i = 0; i < properties.length; i++)
                    obj[properties[i].key] =
                        properties[i].value(model, observer, filterRegistry);
                return obj;
            }
        },

        createFilter: function (name, args) {
            this.filters.push(new Filter(name, args));
        },

        createAsExpression: function (expression, scopeIdent) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
        },

        createInExpression: function (scopeIdent, indexIdent, expression) {
            this.expression = expression;
            this.scopeIdent = scopeIdent;
            this.indexIdent = indexIdent;
        },

        createTopLevel: function (expression) {
            this.expression = expression;
        },

        createThisExpression: notImplemented
    }

    function Expression(delegate) {
        this.scopeIdent = delegate.scopeIdent;
        this.indexIdent = delegate.indexIdent;

        if (!delegate.expression)
            throw Error('No expression found.');

        this.expression = delegate.expression;
        getFn(this.expression); // forces enumeration of path dependencies

        this.filters = delegate.filters;
        this.dynamicDeps = delegate.dynamicDeps;
    }

    Expression.prototype = {
        getValue: function (model, isBackConvert, changedModel, observer) {
            var value = getFn(this.expression)(model.context, observer, changedModel);
            for (var i = 0; i < this.filters.length; i++) {
                value = this.filters[i].transform(model.context, observer, model.context, isBackConvert, [value]);
            }

            return value;
        },

        setValue: function (model, newValue, filterRegistry) {
            var count = this.filters ? this.filters.length : 0;
            while (count-- > 0) {
                newValue = this.filters[count].transform(model, undefined,
                    filterRegistry, true, [newValue]);
            }

            if (this.expression.setValue)
                return this.expression.setValue(model, newValue);
        }
    }

    /**
     * Converts a style property name to a css property name. For example:
     * "WebkitUserSelect" to "-webkit-user-select"
     */
    function convertStylePropertyName(name) {
        return String(name).replace(/[A-Z]/g, function (c) {
            return '-' + c.toLowerCase();
        });
    }

    var parentScopeName = '@' + Math.random().toString(36).slice(2);

    // Single ident paths must bind directly to the appropriate scope object.
    // I.e. Pushed values in two-bindings need to be assigned to the actual model
    // object.
    function findScope(model, prop) {
        while (model[parentScopeName] &&
               !Object.prototype.hasOwnProperty.call(model, prop)) {
            model = model[parentScopeName];
        }

        return model;
    }

    function isLiteralExpression(pathString) {
        switch (pathString) {
            case '':
                return false;

            case 'false':
            case 'null':
            case 'true':
                return true;
        }

        if (!isNaN(Number(pathString)))
            return true;

        return false;
    };

    function PolymerExpressions() { }

    PolymerExpressions.prototype = {
        // "built-in" filters
        styleObject: function (value) {
            var parts = [];
            for (var key in value) {
                parts.push(convertStylePropertyName(key) + ': ' + value[key]);
            }
            return parts.join('; ');
        },

        tokenList: function (value) {
            var tokens = [];
            for (var key in value) {
                if (value[key])
                    tokens.push(key);
            }
            return tokens.join(' ');
        },

        // binding delegate API
        prepareInstancePositionChanged: function (template) {
            var indexIdent = template.polymerExpressionIndexIdent_;
            if (!indexIdent)
                return;

            return function (templateInstance, index) {
                templateInstance.model[indexIdent] = index;
            };
        },

        prepareInstanceModel: function (template) {
            var scopeName = template.polymerExpressionScopeIdent_;
            if (!scopeName)
                return;

            var parentScope = template.templateInstance ?
                template.templateInstance.model :
                template.model;

            var indexName = template.polymerExpressionIndexIdent_;

            return function (model) {
                return createScopeObject(parentScope, model, scopeName, indexName);
            };
        }
    };

    var createScopeObject = ('__proto__' in {}) ?
      function (parentScope, model, scopeName, indexName) {
          var scope = {};
          scope[scopeName] = model;
          scope[indexName] = undefined;
          scope[parentScopeName] = parentScope;
          scope.__proto__ = parentScope;
          return scope;
      } :
      function (parentScope, model, scopeName, indexName) {
          var scope = Object.create(parentScope);
          Object.defineProperty(scope, scopeName,
              { value: model, configurable: true, writable: true });
          Object.defineProperty(scope, indexName,
              { value: undefined, configurable: true, writable: true });
          Object.defineProperty(scope, parentScopeName,
              { value: parentScope, configurable: true, writable: true });
          return scope;
      };

    global.PolymerExpressions = PolymerExpressions;
    PolymerExpressions.getExpression = getExpression;
})(module.exports);

/***/ }),

/***/ "../node_modules/tns-core-modules/matrix/matrix.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
exports.getTransformMatrix = function (_a) {
    var property = _a.property, value = _a.value;
    return TRANSFORM_MATRIXES[property](value);
};
var TRANSFORM_MATRIXES = {
    "scale": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            x, 0, 0,
            0, y, 0,
            0, 0, 1,
        ];
    },
    "translate": function (_a) {
        var x = _a.x, y = _a.y;
        return [
            1, 0, x,
            0, 1, y,
            0, 0, 1,
        ];
    },
    "rotate": function (angleInDeg) {
        var angleInRad = number_utils_1.degreesToRadians(angleInDeg);
        return [
            Math.cos(angleInRad), -Math.sin(angleInRad), 0,
            Math.sin(angleInRad), Math.cos(angleInRad), 0,
            0, 0, 1,
        ];
    },
};
exports.matrixArrayToCssMatrix = function (m) { return [
    m[0], m[3], m[1],
    m[4], m[2], m[5],
]; };
function multiplyAffine2d(m1, m2) {
    return [
        m1[0] * m2[0] + m1[1] * m2[3],
        m1[0] * m2[1] + m1[1] * m2[4],
        m1[0] * m2[2] + m1[1] * m2[5] + m1[2],
        m1[3] * m2[0] + m1[4] * m2[3],
        m1[3] * m2[1] + m1[4] * m2[4],
        m1[3] * m2[2] + m1[4] * m2[5] + m1[5]
    ];
}
exports.multiplyAffine2d = multiplyAffine2d;
function decompose2DTransformMatrix(matrix) {
    verifyTransformMatrix(matrix);
    var _a = matrix.slice(), A = _a[0], B = _a[1], C = _a[2], D = _a[3], E = _a[4], F = _a[5];
    var determinant = A * D - B * C;
    var translate = { x: E || 0, y: F || 0 };
    var rotate = 0;
    var scale = { x: 1, y: 1 };
    if (A || B) {
        var R = Math.sqrt(A * A + B * B);
        rotate = B > 0 ? Math.acos(A / R) : -Math.acos(A / R);
        scale = { x: R, y: determinant / R };
    }
    else if (C || D) {
        var R = Math.sqrt(C * C + D * D);
        rotate = Math.PI / 2 - (D > 0 ? Math.acos(-C / R) : -Math.acos(C / R));
        scale = { x: determinant / R, y: R };
    }
    rotate = number_utils_1.radiansToDegrees(rotate);
    return { translate: translate, rotate: rotate, scale: scale };
}
exports.decompose2DTransformMatrix = decompose2DTransformMatrix;
function verifyTransformMatrix(matrix) {
    if (matrix.length < 6) {
        throw new Error("Transform matrix should be 2x3.");
    }
}
//# sourceMappingURL=matrix.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var qualifier_matcher_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js");
var non_bundle_workflow_compat_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js");
var ModuleNameResolver = (function () {
    function ModuleNameResolver(context, moduleListProvider) {
        if (moduleListProvider === void 0) { moduleListProvider = global.getRegisteredModules; }
        this.context = context;
        this.moduleListProvider = moduleListProvider;
        this._cache = {};
    }
    ModuleNameResolver.prototype.resolveModuleName = function (path, ext) {
        var key = path + ext;
        var result = this._cache[key];
        if (result === undefined) {
            result = this.resolveModuleNameImpl(path, ext);
            this._cache[key] = result;
        }
        return result;
    };
    ModuleNameResolver.prototype.clearCache = function () {
        this._cache = {};
    };
    ModuleNameResolver.prototype.resolveModuleNameImpl = function (path, ext) {
        var result = null;
        ext = ext ? "." + ext : "";
        if (false) {}
        var candidates = this.getCandidates(path, ext);
        result = qualifier_matcher_1.findMatch(path, ext, candidates, this.context);
        return result;
    };
    ModuleNameResolver.prototype.getCandidates = function (path, ext) {
        var candidates = this.moduleListProvider()
            .filter(function (moduleName) { return moduleName.startsWith(path) && (!ext || moduleName.endsWith(ext)); });
        return candidates;
    };
    return ModuleNameResolver;
}());
exports.ModuleNameResolver = ModuleNameResolver;
var resolverInstance;
function resolveModuleName(path, ext) {
    if (!resolverInstance) {
        resolverInstance = new ModuleNameResolver({
            width: platform_1.screen.mainScreen.widthDIPs,
            height: platform_1.screen.mainScreen.heightDIPs,
            os: platform_1.device.os,
            deviceType: platform_1.device.deviceType
        });
    }
    return resolverInstance.resolveModuleName(path, ext);
}
exports.resolveModuleName = resolveModuleName;
function clearCache() {
    if (resolverInstance) {
        resolverInstance.clearCache();
    }
}
exports.clearCache = clearCache;
function _setResolver(resolver) {
    resolverInstance = resolver;
}
exports._setResolver = _setResolver;
appCommonModule.on("livesync", function (args) { return clearCache(); });
appCommonModule.on("orientationChanged", function (args) {
    resolverInstance = undefined;
});
//# sourceMappingURL=module-name-resolver.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/non-bundle-workflow-compat.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var appCommonModule = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var cache = new Set();
var initialized = false;
function register(name, loader) {
    global.registerModule(name, loader);
}
function processFile(file) {
    var filePathRelativeToApp = file.path.substr(fs.knownFolders.currentApp().path.length + 1);
    var loadContent = function () { return file.readTextSync(); };
    switch (file.extension.toLocaleLowerCase()) {
        case ".js":
            var noExtPath = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - ".js".length);
            register(filePathRelativeToApp, function () { return global.require(file.path); });
            register(noExtPath, function () { return global.require(file.path); });
            break;
        case ".css":
            register(filePathRelativeToApp, loadContent);
            break;
        case ".xml":
            register(filePathRelativeToApp, loadContent);
            break;
    }
    if (file.name === "package.json") {
        var json = global.require(file.path);
        if (json.main) {
            var name_1 = filePathRelativeToApp.substr(0, filePathRelativeToApp.length - "package.json".length - 1);
            var requirePath_1 = fs.path.join(file.parent.path, json.main);
            if (name_1.startsWith("tns_modules")) {
                name_1 = name_1.substr("tns_modules".length + 1);
            }
            register(name_1, function () { return global.require(requirePath_1); });
        }
    }
}
function processFolder(path) {
    if (fs.Folder.exists(path)) {
        var folder = fs.Folder.fromPath(path);
        folder.eachEntity(function (file) {
            if (file instanceof fs.File) {
                processFile(file);
            }
            return true;
        });
    }
}
function registerModulesFromFileSystem(moduleName) {
    initialize();
    if (cache.has(moduleName)) {
        return;
    }
    cache.add(moduleName);
    var path = fs.path.join(fs.knownFolders.currentApp().path, moduleName);
    if (fs.Folder.exists(path)) {
        processFolder(path);
        return;
    }
    var parentName = moduleName.substr(0, moduleName.lastIndexOf(fs.path.separator));
    var parentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, parentName);
    if (fs.Folder.exists(parentFolderPath)) {
        processFolder(parentFolderPath);
        return;
    }
    var tnsModulesPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", moduleName);
    if (fs.Folder.exists(tnsModulesPath)) {
        processFolder(tnsModulesPath);
        return;
    }
    if (parentName) {
        var tnsParentFolderPath = fs.path.join(fs.knownFolders.currentApp().path, "tns_modules", parentName);
        if (fs.Folder.exists(tnsParentFolderPath)) {
            processFolder(tnsParentFolderPath);
            return;
        }
    }
}
exports.registerModulesFromFileSystem = registerModulesFromFileSystem;
function initialize() {
    if (!initialized) {
        appCommonModule.on("livesync", function (args) { return cache.clear(); });
        initialized = true;
    }
}
//# sourceMappingURL=non-bundle-workflow-compat.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/module-name-resolver/qualifier-matcher/qualifier-matcher.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var MIN_WH = "minWH";
var MIN_W = "minW";
var MIN_H = "minH";
var PRIORITY_STEP = 10000;
var minWidthHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_WH) === 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_WH.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualLength = Math.min(context.width, context.height);
        if (actualLength < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualLength - numVal);
    }
};
var minWidthQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_W) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_W.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualWidth = context.width;
        if (actualWidth < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualWidth - numVal);
    }
};
var minHeightQualifier = {
    isMatch: function (value) {
        return value.indexOf(MIN_H) === 0 && value.indexOf(MIN_WH) < 0;
    },
    getMatchValue: function (value, context) {
        var numVal = parseInt(value.substr(MIN_H.length));
        if (isNaN(numVal)) {
            return -1;
        }
        var actualHeight = context.height;
        if (actualHeight < numVal) {
            return -1;
        }
        return PRIORITY_STEP - (actualHeight - numVal);
    }
};
var platformQualifier = {
    isMatch: function (value) {
        return value === "android" ||
            value === "ios";
    },
    getMatchValue: function (value, context) {
        return value === context.os.toLowerCase() ? 1 : -1;
    }
};
var orientationQualifier = {
    isMatch: function (value) {
        return value === "land" ||
            value === "port";
    },
    getMatchValue: function (value, context) {
        var isLandscape = (context.width > context.height) ? 1 : -1;
        return (value === "land") ? isLandscape : -isLandscape;
    }
};
var supportedQualifiers = [
    minWidthHeightQualifier,
    minWidthQualifier,
    minHeightQualifier,
    orientationQualifier,
    platformQualifier
];
function checkQualifiers(qualifiers, context) {
    var result = 0;
    var value;
    for (var i = 0; i < qualifiers.length; i++) {
        if (qualifiers[i]) {
            value = checkQualifier(qualifiers[i], context);
            if (value < 0) {
                return -1;
            }
            result += value;
        }
    }
    return result;
}
function checkQualifier(value, context) {
    var result;
    for (var i = 0; i < supportedQualifiers.length; i++) {
        if (supportedQualifiers[i].isMatch(value)) {
            result = supportedQualifiers[i].getMatchValue(value, context);
            if (result > 0) {
                result += (supportedQualifiers.length - i) * PRIORITY_STEP;
            }
            return result;
        }
    }
    return -1;
}
function findMatch(path, ext, candidates, context) {
    var bestValue = -1;
    var result = null;
    for (var i = 0; i < candidates.length; i++) {
        var filePath = candidates[i];
        var qualifiersStr = filePath.substr(path.length, filePath.length - path.length - (ext ? ext.length : 0));
        var qualifiers = qualifiersStr.split(".");
        var value = checkQualifiers(qualifiers, context);
        if (value >= 0 && value > bestValue) {
            bestValue = value;
            result = candidates[i];
        }
    }
    return result;
}
exports.findMatch = findMatch;
//# sourceMappingURL=qualifier-matcher.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/platform/platform.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var platformNames;
(function (platformNames) {
    platformNames.android = "Android";
    platformNames.ios = "iOS";
})(platformNames = exports.platformNames || (exports.platformNames = {}));
var Device = (function () {
    function Device() {
    }
    Object.defineProperty(Device.prototype, "manufacturer", {
        get: function () {
            return "Apple";
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "os", {
        get: function () {
            return platformNames.ios;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "osVersion", {
        get: function () {
            if (!this._osVersion) {
                this._osVersion = UIDevice.currentDevice.systemVersion;
            }
            return this._osVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "model", {
        get: function () {
            if (!this._model) {
                this._model = UIDevice.currentDevice.model;
            }
            return this._model;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "sdkVersion", {
        get: function () {
            if (!this._sdkVersion) {
                this._sdkVersion = UIDevice.currentDevice.systemVersion;
            }
            return this._sdkVersion;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "deviceType", {
        get: function () {
            if (!this._deviceType) {
                if (UIDevice.currentDevice.userInterfaceIdiom === 0) {
                    this._deviceType = "Phone";
                }
                else {
                    this._deviceType = "Tablet";
                }
            }
            return this._deviceType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "uuid", {
        get: function () {
            var userDefaults = NSUserDefaults.standardUserDefaults;
            var uuid_key = "TNSUUID";
            var app_uuid = userDefaults.stringForKey(uuid_key);
            if (!app_uuid) {
                app_uuid = NSUUID.UUID().UUIDString;
                userDefaults.setObjectForKey(app_uuid, uuid_key);
                userDefaults.synchronize();
            }
            return app_uuid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "language", {
        get: function () {
            if (!this._language) {
                var languages = NSLocale.preferredLanguages;
                this._language = languages[0];
            }
            return this._language;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Device.prototype, "region", {
        get: function () {
            if (!this._region) {
                this._region = NSLocale.currentLocale.objectForKey(NSLocaleCountryCode);
            }
            return this._region;
        },
        enumerable: true,
        configurable: true
    });
    return Device;
}());
var MainScreen = (function () {
    function MainScreen() {
    }
    Object.defineProperty(MainScreen.prototype, "screen", {
        get: function () {
            if (!this._screen) {
                this._screen = UIScreen.mainScreen;
            }
            return this._screen;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthPixels", {
        get: function () {
            return this.widthDIPs * this.scale;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightPixels", {
        get: function () {
            return this.heightDIPs * this.scale;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "scale", {
        get: function () {
            return this.screen.scale;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "widthDIPs", {
        get: function () {
            return this.screen.bounds.size.width;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MainScreen.prototype, "heightDIPs", {
        get: function () {
            return this.screen.bounds.size.height;
        },
        enumerable: true,
        configurable: true
    });
    return MainScreen;
}());
exports.device = new Device();
var screen;
(function (screen) {
    screen.mainScreen = new MainScreen();
})(screen = exports.screen || (exports.screen = {}));
exports.isIOS = true;
exports.isAndroid = false;
//# sourceMappingURL=platform.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/profiling/profiling.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
function uptime() {
    return global.android ? org.nativescript.Process.getUpTime() : global.__tns_uptime();
}
exports.uptime = uptime;
function log(message) {
    if (global.__nslog) {
        global.__nslog("CONSOLE LOG: " + message);
    }
    console.log(message);
}
exports.log = log;
var timers = {};
var anyGlobal = global;
var profileNames = [];
exports.time = global.__time || Date.now;
function start(name) {
    var info = timers[name];
    if (info) {
        info.currentStart = exports.time();
        info.runCount++;
    }
    else {
        info = {
            totalTime: 0,
            count: 0,
            currentStart: exports.time(),
            runCount: 1
        };
        timers[name] = info;
        profileNames.push(name);
    }
}
exports.start = start;
function stop(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    if (info.runCount) {
        info.runCount--;
        if (info.runCount) {
            info.count++;
        }
        else {
            info.lastTime = exports.time() - info.currentStart;
            info.totalTime += info.lastTime;
            info.count++;
            info.currentStart = 0;
        }
    }
    else {
        throw new Error("Timer " + name + " paused more times than started.");
    }
    return info;
}
exports.stop = stop;
function timer(name) {
    return timers[name];
}
exports.timer = timer;
function print(name) {
    var info = timers[name];
    if (!info) {
        throw new Error("No timer started: " + name);
    }
    console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
    return info;
}
exports.print = print;
function isRunning(name) {
    var info = timers[name];
    return !!(info && info.runCount);
}
exports.isRunning = isRunning;
function countersProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    profileNames.push(name);
    return function () {
        start(name);
        try {
            return fn.apply(this, arguments);
        }
        finally {
            stop(name);
        }
    };
}
function timelineProfileFunctionFactory(fn, name, type) {
    if (type === void 0) { type = 1; }
    return type === 1 ? function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + " " + this + "  (" + start + "ms. - " + end + "ms.)");
        }
    } : function () {
        var start = exports.time();
        try {
            return fn.apply(this, arguments);
        }
        finally {
            var end = exports.time();
            console.log("Timeline: Modules: " + name + "  (" + start + "ms. - " + end + "ms.)");
        }
    };
}
var Level;
(function (Level) {
    Level[Level["none"] = 0] = "none";
    Level[Level["lifecycle"] = 1] = "lifecycle";
    Level[Level["timeline"] = 2] = "timeline";
})(Level = exports.Level || (exports.Level = {}));
var tracingLevel = Level.none;
var profileFunctionFactory;
function enable(mode) {
    if (mode === void 0) { mode = "counters"; }
    profileFunctionFactory = mode && {
        counters: countersProfileFunctionFactory,
        timeline: timelineProfileFunctionFactory
    }[mode];
    tracingLevel = {
        lifecycle: Level.lifecycle,
        timeline: Level.timeline,
    }[mode] || Level.none;
}
exports.enable = enable;
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.profiling) {
        enable(appConfig.profiling);
    }
}
catch (e1) {
    try {
        console.log("Profiling startup failed to figure out defaults from package.json, error: " + e1);
    }
    catch (e2) {
    }
}
function disable() {
    profileFunctionFactory = undefined;
}
exports.disable = disable;
function profileFunction(fn, customName) {
    return profileFunctionFactory(fn, customName || fn.name);
}
var profileMethodUnnamed = function (target, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(target, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (target && target.constructor && target.constructor.name) {
        className = target.constructor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 1);
    return descriptor;
};
var profileStaticMethodUnnamed = function (ctor, key, descriptor) {
    if (descriptor === undefined) {
        descriptor = Object.getOwnPropertyDescriptor(ctor, key);
    }
    var originalMethod = descriptor.value;
    var className = "";
    if (ctor && ctor.name) {
        className = ctor.name + ".";
    }
    var name = className + key;
    descriptor.value = profileFunctionFactory(originalMethod, name, 0);
    return descriptor;
};
function profileMethodNamed(name) {
    return function (target, key, descriptor) {
        if (descriptor === undefined) {
            descriptor = Object.getOwnPropertyDescriptor(target, key);
        }
        var originalMethod = descriptor.value;
        descriptor.value = profileFunctionFactory(originalMethod, name);
        return descriptor;
    };
}
var voidMethodDecorator = function () {
};
function profile(nameFnOrTarget, fnOrKey, descriptor) {
    if (typeof nameFnOrTarget === "object" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "function" && (typeof fnOrKey === "string" || typeof fnOrKey === "symbol")) {
        if (!profileFunctionFactory) {
            return;
        }
        return profileStaticMethodUnnamed(nameFnOrTarget, fnOrKey, descriptor);
    }
    else if (typeof nameFnOrTarget === "string" && typeof fnOrKey === "function") {
        if (!profileFunctionFactory) {
            return fnOrKey;
        }
        return profileFunction(fnOrKey, nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "function") {
        if (!profileFunctionFactory) {
            return nameFnOrTarget;
        }
        return profileFunction(nameFnOrTarget);
    }
    else if (typeof nameFnOrTarget === "string") {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodNamed(nameFnOrTarget);
    }
    else {
        if (!profileFunctionFactory) {
            return voidMethodDecorator;
        }
        return profileMethodUnnamed;
    }
}
exports.profile = profile;
function dumpProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            console.log("---- [" + name + "] STOP total: " + info.totalTime + " count:" + info.count);
        }
        else {
            console.log("---- [" + name + "] Never called");
        }
    });
}
exports.dumpProfiles = dumpProfiles;
function resetProfiles() {
    profileNames.forEach(function (name) {
        var info = timers[name];
        if (info) {
            if (info.runCount) {
                console.log("---- timer with name [" + name + "] is currently running and won't be reset");
            }
            else {
                timers[name] = undefined;
            }
        }
    });
}
exports.resetProfiles = resetProfiles;
function startCPUProfile(name) {
    if (anyGlobal.android) {
        __startCPUProfiler(name);
    }
}
exports.startCPUProfile = startCPUProfile;
function stopCPUProfile(name) {
    if (anyGlobal.android) {
        __stopCPUProfiler(name);
    }
}
exports.stopCPUProfile = stopCPUProfile;
function level() {
    return tracingLevel;
}
exports.level = level;
function trace(message, start, end) {
    log("Timeline: Modules: " + message + "  (" + start + "ms. - " + end + "ms.)");
}
exports.trace = trace;
//# sourceMappingURL=profiling.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/text/formatted-string.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var span_1 = __webpack_require__("../node_modules/tns-core-modules/text/span.js");
exports.Span = span_1.Span;
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var observable_array_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable-array/observable-array.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var knownCollections;
(function (knownCollections) {
    knownCollections.spans = "spans";
})(knownCollections = exports.knownCollections || (exports.knownCollections = {}));
var FormattedString = (function (_super) {
    __extends(FormattedString, _super);
    function FormattedString() {
        var _this = _super.call(this) || this;
        _this._spans = new observable_array_1.ObservableArray();
        _this._spans.addEventListener(observable_array_1.ObservableArray.changeEvent, _this.onSpansCollectionChanged, _this);
        return _this;
    }
    Object.defineProperty(FormattedString.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormattedString.prototype, "spans", {
        get: function () {
            if (!this._spans) {
                this._spans = new observable_array_1.ObservableArray();
            }
            return this._spans;
        },
        enumerable: true,
        configurable: true
    });
    FormattedString.prototype.toString = function () {
        var result = "";
        for (var i = 0, length_1 = this._spans.length; i < length_1; i++) {
            result += this._spans.getItem(i).text;
        }
        return result;
    };
    FormattedString.prototype._addArrayFromBuilder = function (name, value) {
        if (name === knownCollections.spans) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype._addChildFromBuilder = function (name, value) {
        if (value instanceof span_1.Span) {
            this.spans.push(value);
        }
    };
    FormattedString.prototype.onSpansCollectionChanged = function (eventData) {
        if (eventData.addedCount > 0) {
            for (var i = 0; i < eventData.addedCount; i++) {
                var span = eventData.object.getItem(eventData.index + i);
                this._addView(span);
                this.addPropertyChangeHandler(span);
            }
        }
        if (eventData.removed && eventData.removed.length > 0) {
            for (var p = 0; p < eventData.removed.length; p++) {
                var span = eventData.removed[p];
                this.removePropertyChangeHandler(span);
                this._removeView(span);
            }
        }
        this.notifyPropertyChange(".", this);
    };
    FormattedString.prototype.addPropertyChangeHandler = function (span) {
        var style = span.style;
        span.on(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.on("fontFamilyChange", this.onPropertyChange, this);
        style.on("fontSizeChange", this.onPropertyChange, this);
        style.on("fontStyleChange", this.onPropertyChange, this);
        style.on("fontWeightChange", this.onPropertyChange, this);
        style.on("textDecorationChange", this.onPropertyChange, this);
        style.on("colorChange", this.onPropertyChange, this);
        style.on("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.removePropertyChangeHandler = function (span) {
        var style = span.style;
        span.off(observable_1.Observable.propertyChangeEvent, this.onPropertyChange, this);
        style.off("fontFamilyChange", this.onPropertyChange, this);
        style.off("fontSizeChange", this.onPropertyChange, this);
        style.off("fontStyleChange", this.onPropertyChange, this);
        style.off("fontWeightChange", this.onPropertyChange, this);
        style.off("textDecorationChange", this.onPropertyChange, this);
        style.off("colorChange", this.onPropertyChange, this);
        style.off("backgroundColorChange", this.onPropertyChange, this);
    };
    FormattedString.prototype.onPropertyChange = function (data) {
        this.notifyPropertyChange(data.propertyName, this);
    };
    FormattedString.prototype.eachChild = function (callback) {
        this.spans.forEach(function (v, i, arr) { return callback(v); });
    };
    return FormattedString;
}(view_1.ViewBase));
exports.FormattedString = FormattedString;
//# sourceMappingURL=formatted-string.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/span.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var Span = (function (_super) {
    __extends(Span, _super);
    function Span() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(Span.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Span.prototype, "text", {
        get: function () {
            return this._text;
        },
        set: function (value) {
            if (this._text !== value) {
                this._text = value;
                this.notifyPropertyChange("text", value);
            }
        },
        enumerable: true,
        configurable: true
    });
    Span.prototype._setTextInternal = function (value) {
        this._text = value;
    };
    return Span;
}(view_1.ViewBase));
exports.Span = Span;
//# sourceMappingURL=span.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/text/text.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var encoding;
(function (encoding) {
    encoding.ISO_8859_1 = 5;
    encoding.US_ASCII = 1;
    encoding.UTF_16 = 10;
    encoding.UTF_16BE = 0x90000100;
    encoding.UTF_16LE = 0x94000100;
    encoding.UTF_8 = 4;
})(encoding = exports.encoding || (exports.encoding = {}));
//# sourceMappingURL=text.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/timer/timer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var timeoutCallbacks = new Map();
var timerId = 0;
var TimerTargetImpl = (function (_super) {
    __extends(TimerTargetImpl, _super);
    function TimerTargetImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TimerTargetImpl.initWithCallback = function (callback, id, shouldRepeat) {
        var handler = TimerTargetImpl.new();
        handler.callback = callback;
        handler.id = id;
        handler.shouldRepeat = shouldRepeat;
        return handler;
    };
    TimerTargetImpl.prototype.tick = function (timer) {
        if (!this.disposed) {
            this.callback();
        }
        if (!this.shouldRepeat) {
            this.unregister();
        }
    };
    TimerTargetImpl.prototype.unregister = function () {
        if (!this.disposed) {
            this.disposed = true;
            var timer = timeoutCallbacks.get(this.id).k;
            timer.invalidate();
            timeoutCallbacks.delete(this.id);
        }
    };
    TimerTargetImpl.ObjCExposedMethods = {
        "tick": { returns: interop.types.void, params: [NSTimer] }
    };
    return TimerTargetImpl;
}(NSObject));
function createTimerAndGetId(callback, milliseconds, shouldRepeat) {
    timerId++;
    var id = timerId;
    var timerTarget = TimerTargetImpl.initWithCallback(callback, id, shouldRepeat);
    var timer = NSTimer.scheduledTimerWithTimeIntervalTargetSelectorUserInfoRepeats(milliseconds / 1000, timerTarget, "tick", null, shouldRepeat);
    NSRunLoop.currentRunLoop.addTimerForMode(timer, NSRunLoopCommonModes);
    var pair = { k: timer, v: timerTarget };
    timeoutCallbacks.set(id, pair);
    return id;
}
function setTimeout(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var invoke = function () { return callback.apply(void 0, args); };
    return createTimerAndGetId(zonedCallback(invoke), milliseconds, false);
}
exports.setTimeout = setTimeout;
function clearTimeout(id) {
    var pair = timeoutCallbacks.get(id);
    if (pair) {
        pair.v.unregister();
    }
}
exports.clearTimeout = clearTimeout;
function setInterval(callback, milliseconds) {
    if (milliseconds === void 0) { milliseconds = 0; }
    var args = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        args[_i - 2] = arguments[_i];
    }
    var invoke = function () { return callback.apply(void 0, args); };
    return createTimerAndGetId(zonedCallback(invoke), milliseconds, true);
}
exports.setInterval = setInterval;
exports.clearInterval = clearTimeout;
//# sourceMappingURL=timer.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/trace/trace.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var enabled = false;
var _categories = {};
var _writers = [];
var _eventListeners = [];
var _errorHandler;
function enable() {
    enabled = true;
}
exports.enable = enable;
function disable() {
    enabled = false;
}
exports.disable = disable;
function isEnabled() {
    return enabled;
}
exports.isEnabled = isEnabled;
function isCategorySet(category) {
    return category in _categories;
}
exports.isCategorySet = isCategorySet;
function addWriter(writer) {
    _writers.push(writer);
}
exports.addWriter = addWriter;
function removeWriter(writer) {
    var index = _writers.indexOf(writer);
    if (index >= 0) {
        _writers.splice(index, 1);
    }
}
exports.removeWriter = removeWriter;
function clearWriters() {
    if (_writers.length > 0) {
        _writers.splice(0, _writers.length);
    }
}
exports.clearWriters = clearWriters;
function setCategories(categories) {
    _categories = {};
    addCategories(categories);
}
exports.setCategories = setCategories;
function addCategories(categories) {
    var split = categories.split(",");
    for (var i = 0; i < split.length; i++) {
        _categories[split[i].trim()] = true;
    }
}
exports.addCategories = addCategories;
function write(message, category, type) {
    var i;
    if (type === messageType.error) {
        for (i = 0; i < _writers.length; i++) {
            _writers[i].write(message, category, type);
        }
        return;
    }
    if (!enabled) {
        return;
    }
    if (!(category in _categories)) {
        return;
    }
    for (i = 0; i < _writers.length; i++) {
        _writers[i].write(message, category, type);
    }
}
exports.write = write;
function notifyEvent(object, name, data) {
    if (!enabled) {
        return;
    }
    var i, listener, filters;
    for (i = 0; i < _eventListeners.length; i++) {
        listener = _eventListeners[i];
        if (listener.filter) {
            filters = listener.filter.split(",");
            filters.forEach(function (value) {
                if (value.trim() === name) {
                    listener.on(object, name, data);
                }
            });
        }
        else {
            listener.on(object, name, data);
        }
    }
}
exports.notifyEvent = notifyEvent;
function addEventListener(listener) {
    _eventListeners.push(listener);
}
exports.addEventListener = addEventListener;
function removeEventListener(listener) {
    var index = _eventListeners.indexOf(listener);
    if (index >= 0) {
        _eventListeners.splice(index, 1);
    }
}
exports.removeEventListener = removeEventListener;
var messageType;
(function (messageType) {
    messageType.log = 0;
    messageType.info = 1;
    messageType.warn = 2;
    messageType.error = 3;
})(messageType = exports.messageType || (exports.messageType = {}));
var categories;
(function (categories) {
    categories.VisualTreeEvents = "VisualTreeEvents";
    categories.Layout = "Layout";
    categories.Style = "Style";
    categories.ViewHierarchy = "ViewHierarchy";
    categories.NativeLifecycle = "NativeLifecycle";
    categories.Debug = "Debug";
    categories.Navigation = "Navigation";
    categories.Test = "Test";
    categories.Binding = "Binding";
    categories.BindingError = "BindingError";
    categories.Error = "Error";
    categories.Animation = "Animation";
    categories.Transition = "Transition";
    categories.Livesync = "Livesync";
    categories.separator = ",";
    categories.All = categories.VisualTreeEvents + categories.separator
        + categories.Layout + categories.separator
        + categories.Style + categories.separator
        + categories.ViewHierarchy + categories.separator
        + categories.NativeLifecycle + categories.separator
        + categories.Debug + categories.separator
        + categories.Navigation + categories.separator
        + categories.Test + categories.separator
        + categories.Binding + categories.separator
        + categories.Error + categories.separator
        + categories.Animation + categories.separator
        + categories.Transition + categories.separator
        + categories.Livesync;
    function concat() {
        var result;
        for (var i = 0; i < arguments.length; i++) {
            if (!result) {
                result = arguments[i];
                continue;
            }
            result = result.concat(categories.separator, arguments[i]);
        }
        return result;
    }
    categories.concat = concat;
})(categories = exports.categories || (exports.categories = {}));
var ConsoleWriter = (function () {
    function ConsoleWriter() {
    }
    ConsoleWriter.prototype.write = function (message, category, type) {
        if (!console) {
            return;
        }
        var msgType;
        if (type === undefined) {
            msgType = messageType.log;
        }
        else {
            msgType = type;
        }
        switch (msgType) {
            case messageType.log:
                console.log(category + ": " + message);
                break;
            case messageType.info:
                console.info(category + ": " + message);
                break;
            case messageType.warn:
                console.warn(category + ": " + message);
                break;
            case messageType.error:
                console.error(category + ": " + message);
                break;
        }
    };
    return ConsoleWriter;
}());
addWriter(new ConsoleWriter());
var DefaultErrorHandler = (function () {
    function DefaultErrorHandler() {
    }
    DefaultErrorHandler.prototype.handlerError = function (error) {
        throw error;
    };
    return DefaultErrorHandler;
}());
exports.DefaultErrorHandler = DefaultErrorHandler;
setErrorHandler(new DefaultErrorHandler());
function getErrorHandler() {
    return _errorHandler;
}
exports.getErrorHandler = getErrorHandler;
function setErrorHandler(handler) {
    _errorHandler = handler;
}
exports.setErrorHandler = setErrorHandler;
function error(error) {
    if (!_errorHandler) {
        return;
    }
    if (typeof error === "string") {
        error = new Error(error);
    }
    _errorHandler.handlerError(error);
}
exports.error = error;
//# sourceMappingURL=trace.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceCategories = trace_1.categories;
exports.traceType = trace_1.messageType;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Properties;
(function (Properties) {
    Properties.opacity = "opacity";
    Properties.backgroundColor = "backgroundColor";
    Properties.translate = "translate";
    Properties.rotate = "rotate";
    Properties.scale = "scale";
    Properties.height = "height";
    Properties.width = "width";
})(Properties = exports.Properties || (exports.Properties = {}));
var CubicBezierAnimationCurve = (function () {
    function CubicBezierAnimationCurve(x1, y1, x2, y2) {
        this.x1 = x1;
        this.y1 = y1;
        this.x2 = x2;
        this.y2 = y2;
    }
    return CubicBezierAnimationCurve;
}());
exports.CubicBezierAnimationCurve = CubicBezierAnimationCurve;
var AnimationBase = (function () {
    function AnimationBase(animationDefinitions, playSequentially) {
        if (!animationDefinitions || animationDefinitions.length === 0) {
            throw new Error("No animation definitions specified");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Analyzing " + animationDefinitions.length + " animation definitions...", trace_1.categories.Animation);
        }
        this._propertyAnimations = new Array();
        for (var i = 0, length_1 = animationDefinitions.length; i < length_1; i++) {
            if (animationDefinitions[i].curve) {
                animationDefinitions[i].curve = this._resolveAnimationCurve(animationDefinitions[i].curve);
            }
            this._propertyAnimations = this._propertyAnimations.concat(AnimationBase._createPropertyAnimations(animationDefinitions[i]));
        }
        if (this._propertyAnimations.length === 0) {
            throw new Error("Nothing to animate.");
        }
        if (trace_1.isEnabled()) {
            trace_1.write("Created " + this._propertyAnimations.length + " individual property animations.", trace_1.categories.Animation);
        }
        this._playSequentially = playSequentially;
    }
    AnimationBase.prototype._rejectAlreadyPlaying = function () {
        var reason = "Animation is already playing.";
        trace_1.write(reason, trace_1.categories.Animation, trace_1.messageType.warn);
        return new Promise(function (resolve, reject) {
            reject(reason);
        });
    };
    AnimationBase.prototype.play = function () {
        var _this_1 = this;
        var animationFinishedPromise = new Promise(function (resolve, reject) {
            _this_1._resolve = resolve;
            _this_1._reject = reject;
        });
        this.fixupAnimationPromise(animationFinishedPromise);
        this._isPlaying = true;
        return animationFinishedPromise;
    };
    AnimationBase.prototype.fixupAnimationPromise = function (promise) {
        var _this = this;
        promise.cancel = function () {
            _this.cancel();
        };
        var _then = promise.then;
        promise.then = function () {
            var r = _then.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
        var _catch = promise.catch;
        promise.catch = function () {
            var r = _catch.apply(promise, arguments);
            _this.fixupAnimationPromise(r);
            return r;
        };
    };
    AnimationBase.prototype.cancel = function () {
    };
    Object.defineProperty(AnimationBase.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    AnimationBase.prototype._resolveAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._resolve();
    };
    AnimationBase.prototype._rejectAnimationFinishedPromise = function () {
        this._isPlaying = false;
        this._reject(new Error("Animation cancelled."));
    };
    AnimationBase._createPropertyAnimations = function (animationDefinition) {
        if (!animationDefinition.target) {
            throw new Error("No animation target specified.");
        }
        for (var item in animationDefinition) {
            if (animationDefinition[item] === undefined) {
                continue;
            }
            if ((item === Properties.opacity ||
                item === Properties.rotate ||
                item === "duration" ||
                item === "delay" ||
                item === "iterations") && typeof animationDefinition[item] !== "number") {
                throw new Error("Property " + item + " must be valid number. Value: " + animationDefinition[item]);
            }
            else if ((item === Properties.scale || item === Properties.translate) &&
                (typeof animationDefinition[item].x !== "number" || typeof animationDefinition[item].y !== "number")) {
                throw new Error("Property " + item + " must be valid Pair. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.backgroundColor && !color_1.Color.isValid(animationDefinition.backgroundColor)) {
                throw new Error("Property " + item + " must be valid color. Value: " + animationDefinition[item]);
            }
            else if (item === Properties.width || item === Properties.height) {
                animationDefinition[item] = style_properties_1.PercentLength.parse(animationDefinition[item]);
            }
        }
        var propertyAnimations = new Array();
        if (animationDefinition.opacity !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.opacity,
                value: animationDefinition.opacity,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.backgroundColor !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.backgroundColor,
                value: typeof animationDefinition.backgroundColor === "string" ?
                    new color_1.Color(animationDefinition.backgroundColor) : animationDefinition.backgroundColor,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.translate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.translate,
                value: animationDefinition.translate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.scale !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.scale,
                value: animationDefinition.scale,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.rotate !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.rotate,
                value: animationDefinition.rotate,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.height !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.height,
                value: animationDefinition.height,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (animationDefinition.width !== undefined) {
            propertyAnimations.push({
                target: animationDefinition.target,
                property: Properties.width,
                value: animationDefinition.width,
                duration: animationDefinition.duration,
                delay: animationDefinition.delay,
                iterations: animationDefinition.iterations,
                curve: animationDefinition.curve
            });
        }
        if (propertyAnimations.length === 0) {
            throw new Error("No known animation properties specified");
        }
        return propertyAnimations;
    };
    AnimationBase._getAnimationInfo = function (animation) {
        return JSON.stringify({
            target: animation.target.id,
            property: animation.property,
            value: animation.value,
            duration: animation.duration,
            delay: animation.delay,
            iterations: animation.iterations,
            curve: animation.curve
        });
    };
    return AnimationBase;
}());
exports.AnimationBase = AnimationBase;
//# sourceMappingURL=animation-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/animation.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var animation_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/animation/animation-common.js"));
var _transform = "_transform";
var _skip = "_skip";
var FLT_MAX = 340282346638528859811704183484516925440.000000;
var AnimationInfo = (function () {
    function AnimationInfo() {
    }
    return AnimationInfo;
}());
var AnimationDelegateImpl = (function (_super) {
    __extends(AnimationDelegateImpl, _super);
    function AnimationDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnimationDelegateImpl.initWithFinishedCallback = function (finishedCallback, propertyAnimation, valueSource) {
        var delegate = AnimationDelegateImpl.new();
        delegate._finishedCallback = finishedCallback;
        delegate._propertyAnimation = propertyAnimation;
        delegate._valueSource = valueSource;
        return delegate;
    };
    AnimationDelegateImpl.prototype.animationDidStart = function (anim) {
        var value = this._propertyAnimation.value;
        var setLocal = this._valueSource === "animation";
        var targetStyle = this._propertyAnimation.target.style;
        this._propertyAnimation.target._suspendPresentationLayerUpdates();
        switch (this._propertyAnimation.property) {
            case animation_common_1.Properties.backgroundColor:
                targetStyle[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.opacity:
                targetStyle[setLocal ? style_properties_1.opacityProperty.name : style_properties_1.opacityProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.rotate:
                targetStyle[setLocal ? style_properties_1.rotateProperty.name : style_properties_1.rotateProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.translate:
                targetStyle[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value.x;
                targetStyle[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value.y;
                break;
            case animation_common_1.Properties.height:
                targetStyle[setLocal ? style_properties_1.heightProperty.name : style_properties_1.heightProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.width:
                targetStyle[setLocal ? style_properties_1.widthProperty.name : style_properties_1.widthProperty.keyframe] = value;
                break;
            case animation_common_1.Properties.scale:
                targetStyle[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = value.x === 0 ? 0.001 : value.x;
                targetStyle[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = value.y === 0 ? 0.001 : value.y;
                break;
            case _transform:
                if (value[animation_common_1.Properties.translate] !== undefined) {
                    targetStyle[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value[animation_common_1.Properties.translate].x;
                    targetStyle[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value[animation_common_1.Properties.translate].y;
                }
                if (value[animation_common_1.Properties.scale] !== undefined) {
                    var x = value[animation_common_1.Properties.scale].x;
                    var y = value[animation_common_1.Properties.scale].y;
                    targetStyle[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = x === 0 ? 0.001 : x;
                    targetStyle[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = y === 0 ? 0.001 : y;
                }
                break;
        }
        this._propertyAnimation.target._resumePresentationLayerUpdates();
    };
    AnimationDelegateImpl.prototype.animationDidStopFinished = function (anim, finished) {
        if (this._finishedCallback) {
            this._finishedCallback(!finished);
        }
        if (finished && this.nextAnimation) {
            this.nextAnimation();
        }
    };
    AnimationDelegateImpl.ObjCProtocols = global.CAAnimationDelegate ? [global.CAAnimationDelegate] : [];
    return AnimationDelegateImpl;
}(NSObject));
function _resolveAnimationCurve(curve) {
    switch (curve) {
        case "easeIn":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionEaseIn);
        case "easeOut":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionEaseOut);
        case "easeInOut":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionEaseInEaseOut);
        case "linear":
            return CAMediaTimingFunction.functionWithName(kCAMediaTimingFunctionLinear);
        case "spring":
            return curve;
        case "ease":
            return CAMediaTimingFunction.functionWithControlPoints(0.25, 0.1, 0.25, 1.0);
        default:
            if (curve instanceof CAMediaTimingFunction) {
                return curve;
            }
            else if (curve instanceof animation_common_1.CubicBezierAnimationCurve) {
                var animationCurve = curve;
                return CAMediaTimingFunction.functionWithControlPoints(animationCurve.x1, animationCurve.y1, animationCurve.x2, animationCurve.y2);
            }
            else {
                throw new Error("Invalid animation curve: " + curve);
            }
    }
}
exports._resolveAnimationCurve = _resolveAnimationCurve;
var Animation = (function (_super) {
    __extends(Animation, _super);
    function Animation(animationDefinitions, playSequentially) {
        var _this = _super.call(this, animationDefinitions, playSequentially) || this;
        _this._valueSource = "animation";
        if (animationDefinitions.length > 0 && animationDefinitions[0].valueSource !== undefined) {
            _this._valueSource = animationDefinitions[0].valueSource;
        }
        if (!playSequentially) {
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Non-merged Property Animations: " + _this._propertyAnimations.length, animation_common_1.traceCategories.Animation);
            }
            _this._mergedPropertyAnimations = Animation._mergeAffineTransformAnimations(_this._propertyAnimations);
            if (animation_common_1.traceEnabled()) {
                animation_common_1.traceWrite("Merged Property Animations: " + _this._mergedPropertyAnimations.length, animation_common_1.traceCategories.Animation);
            }
        }
        else {
            _this._mergedPropertyAnimations = _this._propertyAnimations;
        }
        var that = _this;
        var animationFinishedCallback = function (cancelled) {
            if (that._playSequentially) {
                if (cancelled) {
                    that._rejectAnimationFinishedPromise();
                }
                else {
                    that._resolveAnimationFinishedPromise();
                }
            }
            else {
                if (cancelled) {
                    that._cancelledAnimations++;
                }
                else {
                    that._finishedAnimations++;
                }
                if (that._cancelledAnimations > 0 && (that._cancelledAnimations + that._finishedAnimations) === that._mergedPropertyAnimations.length) {
                    if (animation_common_1.traceEnabled()) {
                        animation_common_1.traceWrite(that._cancelledAnimations + " animations cancelled.", animation_common_1.traceCategories.Animation);
                    }
                    that._rejectAnimationFinishedPromise();
                }
                else if (that._finishedAnimations === that._mergedPropertyAnimations.length) {
                    if (animation_common_1.traceEnabled()) {
                        animation_common_1.traceWrite(that._finishedAnimations + " animations finished.", animation_common_1.traceCategories.Animation);
                    }
                    that._resolveAnimationFinishedPromise();
                }
            }
        };
        _this._iOSAnimationFunction = Animation._createiOSAnimationFunction(_this._mergedPropertyAnimations, 0, _this._playSequentially, _this._valueSource, animationFinishedCallback);
        return _this;
    }
    Animation.prototype.play = function () {
        if (this.isPlaying) {
            return this._rejectAlreadyPlaying();
        }
        var animationFinishedPromise = _super.prototype.play.call(this);
        this._finishedAnimations = 0;
        this._cancelledAnimations = 0;
        this._iOSAnimationFunction();
        return animationFinishedPromise;
    };
    Animation.prototype.cancel = function () {
        if (!this.isPlaying) {
            animation_common_1.traceWrite("Animation is not currently playing.", animation_common_1.traceCategories.Animation, animation_common_1.traceType.warn);
            return;
        }
        var i = 0;
        var length = this._mergedPropertyAnimations.length;
        for (; i < length; i++) {
            var propertyAnimation = this._mergedPropertyAnimations[i];
            propertyAnimation.target.nativeViewProtected.layer.removeAllAnimations();
            if (propertyAnimation._propertyResetCallback) {
                propertyAnimation._propertyResetCallback(propertyAnimation._originalValue, this._valueSource);
            }
        }
    };
    Animation.prototype._resolveAnimationCurve = function (curve) {
        return _resolveAnimationCurve(curve);
    };
    Animation._createiOSAnimationFunction = function (propertyAnimations, index, playSequentially, valueSource, finishedCallback) {
        return function (cancelled) {
            if (cancelled && finishedCallback) {
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("Animation " + (index - 1).toString() + " was cancelled. Will skip the rest of animations and call finishedCallback(true).", animation_common_1.traceCategories.Animation);
                }
                finishedCallback(cancelled);
                return;
            }
            var animation = propertyAnimations[index];
            var args = Animation._getNativeAnimationArguments(animation, valueSource);
            if (animation.curve === "spring") {
                Animation._createNativeSpringAnimation(propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback);
            }
            else {
                Animation._createNativeAnimation(propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback);
            }
        };
    };
    Animation._getNativeAnimationArguments = function (animation, valueSource) {
        var nativeView = animation.target.nativeViewProtected;
        var propertyNameToAnimate = animation.property;
        var toValue = animation.value;
        var fromValue;
        var parent = animation.target.parent;
        var screenScale = platform_1.screen.mainScreen.scale;
        var tempRotate = (animation.target.rotate || 0) * Math.PI / 180;
        var abs;
        var setLocal = valueSource === "animation";
        switch (animation.property) {
            case animation_common_1.Properties.backgroundColor:
                animation._originalValue = animation.target.backgroundColor;
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.backgroundColorProperty.name : style_properties_1.backgroundColorProperty.keyframe] = value;
                };
                fromValue = nativeView.layer.backgroundColor;
                if (nativeView instanceof UILabel) {
                    nativeView.setValueForKey(UIColor.clearColor, "backgroundColor");
                }
                toValue = toValue.CGColor;
                break;
            case animation_common_1.Properties.opacity:
                animation._originalValue = animation.target.opacity;
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.opacityProperty.name : style_properties_1.opacityProperty.keyframe] = value;
                };
                fromValue = nativeView.layer.opacity;
                break;
            case animation_common_1.Properties.rotate:
                animation._originalValue = animation.target.rotate !== undefined ? animation.target.rotate : 0;
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.rotateProperty.name : style_properties_1.rotateProperty.keyframe] = value;
                };
                propertyNameToAnimate = "transform.rotation";
                fromValue = nativeView.layer.valueForKeyPath("transform.rotation");
                if (animation.target.rotate !== undefined && animation.target.rotate !== 0 && Math.floor(toValue / 360) - toValue / 360 === 0) {
                    fromValue = animation.target.rotate * Math.PI / 180;
                }
                toValue = toValue * Math.PI / 180;
                abs = fabs(fromValue - toValue);
                if (abs < 0.001 && fromValue !== tempRotate) {
                    fromValue = tempRotate;
                }
                break;
            case animation_common_1.Properties.translate:
                animation._originalValue = { x: animation.target.translateX, y: animation.target.translateY };
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value.x;
                    animation.target.style[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value.y;
                };
                propertyNameToAnimate = "transform";
                fromValue = NSValue.valueWithCATransform3D(nativeView.layer.transform);
                toValue = NSValue.valueWithCATransform3D(CATransform3DTranslate(nativeView.layer.transform, toValue.x, toValue.y, 0));
                break;
            case animation_common_1.Properties.scale:
                if (toValue.x === 0) {
                    toValue.x = 0.001;
                }
                if (toValue.y === 0) {
                    toValue.y = 0.001;
                }
                animation._originalValue = { x: animation.target.scaleX, y: animation.target.scaleY };
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = value.x;
                    animation.target.style[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = value.y;
                };
                propertyNameToAnimate = "transform";
                fromValue = NSValue.valueWithCATransform3D(nativeView.layer.transform);
                toValue = NSValue.valueWithCATransform3D(CATransform3DScale(nativeView.layer.transform, toValue.x, toValue.y, 1));
                break;
            case _transform:
                fromValue = NSValue.valueWithCATransform3D(nativeView.layer.transform);
                animation._originalValue = {
                    xs: animation.target.scaleX, ys: animation.target.scaleY,
                    xt: animation.target.translateX, yt: animation.target.translateY
                };
                animation._propertyResetCallback = function (value, valueSource) {
                    animation.target.style[setLocal ? style_properties_1.translateXProperty.name : style_properties_1.translateXProperty.keyframe] = value.xt;
                    animation.target.style[setLocal ? style_properties_1.translateYProperty.name : style_properties_1.translateYProperty.keyframe] = value.yt;
                    animation.target.style[setLocal ? style_properties_1.scaleXProperty.name : style_properties_1.scaleXProperty.keyframe] = value.xs;
                    animation.target.style[setLocal ? style_properties_1.scaleYProperty.name : style_properties_1.scaleYProperty.keyframe] = value.ys;
                };
                propertyNameToAnimate = "transform";
                toValue = NSValue.valueWithCATransform3D(Animation._createNativeAffineTransform(animation));
                break;
            case animation_common_1.Properties.width:
            case animation_common_1.Properties.height:
                var direction = animation.property;
                var isHeight_1 = direction === "height";
                propertyNameToAnimate = "bounds";
                if (!parent) {
                    throw new Error("cannot animate " + direction + " on root view");
                }
                var parentExtent = isHeight_1 ? parent.getMeasuredHeight() : parent.getMeasuredWidth();
                var asNumber = style_properties_1.PercentLength.toDevicePixels(style_properties_1.PercentLength.parse(toValue), parentExtent, parentExtent) / screenScale;
                var currentBounds = nativeView.layer.bounds;
                var extentX = isHeight_1 ? currentBounds.size.width : asNumber;
                var extentY = isHeight_1 ? asNumber : currentBounds.size.height;
                fromValue = NSValue.valueWithCGRect(currentBounds);
                toValue = NSValue.valueWithCGRect(CGRectMake(currentBounds.origin.x, currentBounds.origin.y, extentX, extentY));
                animation._originalValue = animation.target.height;
                animation._propertyResetCallback = function (value, valueSource) {
                    var prop = isHeight_1 ? style_properties_1.heightProperty : style_properties_1.widthProperty;
                    animation.target.style[setLocal ? prop.name : prop.keyframe] = value;
                };
                break;
            default:
                throw new Error("Animating property '" + animation.property + "' is unsupported");
        }
        var duration = 0.3;
        if (animation.duration !== undefined) {
            duration = animation.duration / 1000.0;
        }
        var delay = undefined;
        if (animation.delay) {
            delay = animation.delay / 1000.0;
        }
        var repeatCount = undefined;
        if (animation.iterations !== undefined) {
            if (animation.iterations === Number.POSITIVE_INFINITY) {
                repeatCount = FLT_MAX;
            }
            else {
                repeatCount = animation.iterations;
            }
        }
        return {
            propertyNameToAnimate: propertyNameToAnimate,
            fromValue: fromValue,
            toValue: toValue,
            duration: duration,
            repeatCount: repeatCount,
            delay: delay
        };
    };
    Animation._createNativeAnimation = function (propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback) {
        var nativeView = animation.target.nativeViewProtected;
        var nativeAnimation = CABasicAnimation.animationWithKeyPath(args.propertyNameToAnimate);
        nativeAnimation.fromValue = args.fromValue;
        nativeAnimation.toValue = args.toValue;
        nativeAnimation.duration = args.duration;
        if (args.repeatCount !== undefined) {
            nativeAnimation.repeatCount = args.repeatCount;
        }
        if (args.delay !== undefined) {
            nativeAnimation.beginTime = CACurrentMediaTime() + args.delay;
        }
        if (animation.curve !== undefined) {
            nativeAnimation.timingFunction = animation.curve;
        }
        var animationDelegate = AnimationDelegateImpl.initWithFinishedCallback(finishedCallback, animation, valueSource);
        nativeAnimation.setValueForKey(animationDelegate, "delegate");
        nativeView.layer.addAnimationForKey(nativeAnimation, args.propertyNameToAnimate);
        var callback = undefined;
        if (index + 1 < propertyAnimations.length) {
            callback = Animation._createiOSAnimationFunction(propertyAnimations, index + 1, playSequentially, valueSource, finishedCallback);
            if (!playSequentially) {
                callback();
            }
            else {
                animationDelegate.nextAnimation = callback;
            }
        }
    };
    Animation._createNativeSpringAnimation = function (propertyAnimations, index, playSequentially, args, animation, valueSource, finishedCallback) {
        var nativeView = animation.target.nativeViewProtected;
        var callback = undefined;
        var nextAnimation;
        if (index + 1 < propertyAnimations.length) {
            callback = Animation._createiOSAnimationFunction(propertyAnimations, index + 1, playSequentially, valueSource, finishedCallback);
            if (!playSequentially) {
                callback();
            }
            else {
                nextAnimation = callback;
            }
        }
        var delay = 0;
        if (args.delay) {
            delay = args.delay;
        }
        UIView.animateWithDurationDelayUsingSpringWithDampingInitialSpringVelocityOptionsAnimationsCompletion(args.duration, delay, 0.2, 0, 196608, function () {
            if (args.repeatCount !== undefined) {
                UIView.setAnimationRepeatCount(args.repeatCount);
            }
            switch (animation.property) {
                case animation_common_1.Properties.backgroundColor:
                    animation.target.backgroundColor = args.toValue;
                    break;
                case animation_common_1.Properties.opacity:
                    animation.target.opacity = args.toValue;
                    break;
                case animation_common_1.Properties.height:
                case animation_common_1.Properties.width:
                    animation._originalValue = animation.target[animation.property];
                    nativeView.layer.setValueForKey(args.toValue, args.propertyNameToAnimate);
                    animation._propertyResetCallback = function (value) {
                        animation.target[animation.property] = value;
                    };
                    break;
                case animation_common_1.Properties.rotate:
                    nativeView.layer.setValueForKey(args.toValue, args.propertyNameToAnimate);
                    break;
                case _transform:
                    animation._originalValue = nativeView.layer.transform;
                    nativeView.layer.setValueForKey(args.toValue, args.propertyNameToAnimate);
                    animation._propertyResetCallback = function (value) {
                        nativeView.layer.transform = value;
                    };
                    break;
            }
        }, function (animationDidFinish) {
            if (animationDidFinish) {
                if (animation.property === _transform) {
                    if (animation.value[animation_common_1.Properties.translate] !== undefined) {
                        animation.target.translateX = animation.value[animation_common_1.Properties.translate].x;
                        animation.target.translateY = animation.value[animation_common_1.Properties.translate].y;
                    }
                    if (animation.value[animation_common_1.Properties.scale] !== undefined) {
                        animation.target.scaleX = animation.value[animation_common_1.Properties.scale].x;
                        animation.target.scaleY = animation.value[animation_common_1.Properties.scale].y;
                    }
                }
            }
            else {
                if (animation._propertyResetCallback) {
                    animation._propertyResetCallback(animation._originalValue);
                }
            }
            if (finishedCallback) {
                var cancelled = !animationDidFinish;
                finishedCallback(cancelled);
            }
            if (animationDidFinish && nextAnimation) {
                nextAnimation();
            }
        });
    };
    Animation._createNativeAffineTransform = function (animation) {
        var value = animation.value;
        var result = CATransform3DIdentity;
        if (value[animation_common_1.Properties.translate] !== undefined) {
            var x = value[animation_common_1.Properties.translate].x;
            var y = value[animation_common_1.Properties.translate].y;
            result = CATransform3DTranslate(result, x, y, 0);
        }
        if (value[animation_common_1.Properties.scale] !== undefined) {
            var x = value[animation_common_1.Properties.scale].x;
            var y = value[animation_common_1.Properties.scale].y;
            result = CATransform3DScale(result, x === 0 ? 0.001 : x, y === 0 ? 0.001 : y, 1);
        }
        return result;
    };
    Animation._isAffineTransform = function (property) {
        return property === _transform
            || property === animation_common_1.Properties.translate
            || property === animation_common_1.Properties.scale;
    };
    Animation._canBeMerged = function (animation1, animation2) {
        var result = Animation._isAffineTransform(animation1.property) &&
            Animation._isAffineTransform(animation2.property) &&
            animation1.target === animation2.target &&
            animation1.duration === animation2.duration &&
            animation1.delay === animation2.delay &&
            animation1.iterations === animation2.iterations &&
            animation1.curve === animation2.curve;
        return result;
    };
    Animation._mergeAffineTransformAnimations = function (propertyAnimations) {
        var result = new Array();
        var i = 0;
        var j;
        var length = propertyAnimations.length;
        for (; i < length; i++) {
            if (propertyAnimations[i][_skip]) {
                continue;
            }
            if (!Animation._isAffineTransform(propertyAnimations[i].property)) {
                result.push(propertyAnimations[i]);
            }
            else {
                var newTransformAnimation = {
                    target: propertyAnimations[i].target,
                    property: _transform,
                    value: {},
                    duration: propertyAnimations[i].duration,
                    delay: propertyAnimations[i].delay,
                    iterations: propertyAnimations[i].iterations,
                    curve: propertyAnimations[i].curve
                };
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("Curve: " + propertyAnimations[i].curve, animation_common_1.traceCategories.Animation);
                }
                newTransformAnimation.value[propertyAnimations[i].property] = propertyAnimations[i].value;
                if (animation_common_1.traceEnabled()) {
                    animation_common_1.traceWrite("Created new transform animation: " + Animation._getAnimationInfo(newTransformAnimation), animation_common_1.traceCategories.Animation);
                }
                j = i + 1;
                if (j < length) {
                    for (; j < length; j++) {
                        if (Animation._canBeMerged(propertyAnimations[i], propertyAnimations[j])) {
                            if (animation_common_1.traceEnabled()) {
                                animation_common_1.traceWrite("Merging animations: " + Animation._getAnimationInfo(newTransformAnimation) + " + " + Animation._getAnimationInfo(propertyAnimations[j]) + ";", animation_common_1.traceCategories.Animation);
                            }
                            newTransformAnimation.value[propertyAnimations[j].property] = propertyAnimations[j].value;
                            propertyAnimations[j][_skip] = true;
                        }
                    }
                }
                result.push(newTransformAnimation);
            }
        }
        return result;
    };
    return Animation;
}(animation_common_1.AnimationBase));
exports.Animation = Animation;
function _getTransformMismatchErrorMessage(view) {
    var result = CGAffineTransformIdentity;
    var tx = view.translateX;
    var ty = view.translateY;
    result = CGAffineTransformTranslate(result, tx, ty);
    result = CGAffineTransformRotate(result, (view.rotate || 0) * Math.PI / 180);
    result = CGAffineTransformScale(result, view.scaleX || 1, view.scaleY || 1);
    var viewTransform = NSStringFromCGAffineTransform(result);
    var nativeTransform = NSStringFromCGAffineTransform(view.nativeViewProtected.transform);
    if (viewTransform !== nativeTransform) {
        return "View and Native transforms do not match. View: " + viewTransform + "; Native: " + nativeTransform;
    }
    return undefined;
}
exports._getTransformMismatchErrorMessage = _getTransformMismatchErrorMessage;
//# sourceMappingURL=animation.ios.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/animation/keyframe-animation.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var Keyframes = (function () {
    function Keyframes() {
    }
    return Keyframes;
}());
exports.Keyframes = Keyframes;
var UnparsedKeyframe = (function () {
    function UnparsedKeyframe() {
    }
    return UnparsedKeyframe;
}());
exports.UnparsedKeyframe = UnparsedKeyframe;
var KeyframeDeclaration = (function () {
    function KeyframeDeclaration() {
    }
    return KeyframeDeclaration;
}());
exports.KeyframeDeclaration = KeyframeDeclaration;
var KeyframeInfo = (function () {
    function KeyframeInfo() {
        this.curve = enums_1.AnimationCurve.ease;
    }
    return KeyframeInfo;
}());
exports.KeyframeInfo = KeyframeInfo;
var KeyframeAnimationInfo = (function () {
    function KeyframeAnimationInfo() {
        this.name = "";
        this.duration = 0.3;
        this.delay = 0;
        this.iterations = 1;
        this.curve = "ease";
        this.isForwards = false;
        this.isReverse = false;
    }
    return KeyframeAnimationInfo;
}());
exports.KeyframeAnimationInfo = KeyframeAnimationInfo;
var KeyframeAnimation = (function () {
    function KeyframeAnimation() {
        this.delay = 0;
        this.iterations = 1;
    }
    KeyframeAnimation.keyframeAnimationFromInfo = function (info) {
        var length = info.keyframes.length;
        var animations = new Array();
        var startDuration = 0;
        if (info.isReverse) {
            for (var index_1 = length - 1; index_1 >= 0; index_1--) {
                var keyframe = info.keyframes[index_1];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
        }
        else {
            for (var index_2 = 0; index_2 < length; index_2++) {
                var keyframe = info.keyframes[index_2];
                startDuration = KeyframeAnimation.parseKeyframe(info, keyframe, animations, startDuration);
            }
            for (var index_3 = length - 1; index_3 > 0; index_3--) {
                var a1 = animations[index_3];
                var a2 = animations[index_3 - 1];
                if (a2["curve"] !== undefined) {
                    a1["curve"] = a2["curve"];
                    a2["curve"] = undefined;
                }
            }
        }
        animations.map(function (a) { return a["curve"] ? a : Object.assign(a, { curve: info.curve }); });
        var animation = new KeyframeAnimation();
        animation.delay = info.delay;
        animation.iterations = info.iterations;
        animation.animations = animations;
        animation._isForwards = info.isForwards;
        return animation;
    };
    KeyframeAnimation.parseKeyframe = function (info, keyframe, animations, startDuration) {
        var animation = {};
        for (var _i = 0, _a = keyframe.declarations; _i < _a.length; _i++) {
            var declaration = _a[_i];
            animation[declaration.property] = declaration.value;
        }
        var duration = keyframe.duration;
        if (duration === 0) {
            duration = 0.01;
        }
        else {
            duration = (info.duration * duration) - startDuration;
            startDuration += duration;
        }
        animation.duration = info.isReverse ? info.duration - duration : duration;
        animation.curve = keyframe.curve;
        animation.forceLayer = true;
        animation.valueSource = "keyframe";
        animations.push(animation);
        return startDuration;
    };
    Object.defineProperty(KeyframeAnimation.prototype, "isPlaying", {
        get: function () {
            return this._isPlaying;
        },
        enumerable: true,
        configurable: true
    });
    KeyframeAnimation.prototype.cancel = function () {
        if (!this.isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        this._isPlaying = false;
        for (var i = this._nativeAnimations.length - 1; i >= 0; i--) {
            var animation = this._nativeAnimations[i];
            if (animation.isPlaying) {
                animation.cancel();
            }
        }
        if (this._nativeAnimations.length > 0) {
            var animation = this._nativeAnimations[0];
            this._resetAnimationValues(this._target, animation);
        }
        this._resetAnimations();
    };
    KeyframeAnimation.prototype.play = function (view) {
        var _this = this;
        if (this._isPlaying) {
            trace_1.write("Keyframe animation is already playing.", trace_1.categories.Animation, trace_1.messageType.warn);
            return new Promise(function (resolve) {
                resolve();
            });
        }
        var animationFinishedPromise = new Promise(function (resolve) {
            _this._resolve = resolve;
        });
        this._isPlaying = true;
        this._nativeAnimations = new Array();
        this._target = view;
        if (this.delay !== 0) {
            setTimeout(function () { return _this.animate(view, 0, _this.iterations); }, this.delay);
        }
        else {
            this.animate(view, 0, this.iterations);
        }
        return animationFinishedPromise;
    };
    KeyframeAnimation.prototype.animate = function (view, index, iterations) {
        var _this = this;
        if (!this._isPlaying) {
            return;
        }
        if (index === 0) {
            var animation = this.animations[0];
            if ("backgroundColor" in animation) {
                view.style[style_properties_1.backgroundColorProperty.keyframe] = animation.backgroundColor;
            }
            if ("scale" in animation) {
                view.style[style_properties_1.scaleXProperty.keyframe] = animation.scale.x;
                view.style[style_properties_1.scaleYProperty.keyframe] = animation.scale.y;
            }
            if ("translate" in animation) {
                view.style[style_properties_1.translateXProperty.keyframe] = animation.translate.x;
                view.style[style_properties_1.translateYProperty.keyframe] = animation.translate.y;
            }
            if ("rotate" in animation) {
                view.style[style_properties_1.rotateProperty.keyframe] = animation.rotate;
            }
            if ("opacity" in animation) {
                view.style[style_properties_1.opacityProperty.keyframe] = animation.opacity;
            }
            if ("height" in animation) {
                view.style[style_properties_1.heightProperty.keyframe] = animation.height;
            }
            if ("width" in animation) {
                view.style[style_properties_1.widthProperty.keyframe] = animation.width;
            }
            setTimeout(function () { return _this.animate(view, 1, iterations); }, 1);
        }
        else if (index < 0 || index >= this.animations.length) {
            iterations -= 1;
            if (iterations > 0) {
                this.animate(view, 0, iterations);
            }
            else {
                if (this._isForwards === false) {
                    var animation = this.animations[this.animations.length - 1];
                    this._resetAnimationValues(view, animation);
                }
                this._resolveAnimationFinishedPromise();
            }
        }
        else {
            var animation = void 0;
            var cachedAnimation = this._nativeAnimations[index - 1];
            if (cachedAnimation) {
                animation = cachedAnimation;
            }
            else {
                var animationDef = this.animations[index];
                animationDef.target = view;
                animation = new animation_1.Animation([animationDef]);
                this._nativeAnimations.push(animation);
            }
            var isLastIteration = iterations - 1 <= 0;
            animation.play(isLastIteration).then(function () {
                _this.animate(view, index + 1, iterations);
            }, function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            }).catch(function (error) {
                trace_1.write(typeof error === "string" ? error : error.message, trace_1.categories.Animation, trace_1.messageType.warn);
            });
        }
    };
    KeyframeAnimation.prototype._resolveAnimationFinishedPromise = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
        this._resolve();
    };
    KeyframeAnimation.prototype._resetAnimations = function () {
        this._nativeAnimations = new Array();
        this._isPlaying = false;
        this._target = null;
    };
    KeyframeAnimation.prototype._resetAnimationValues = function (view, animation) {
        if ("backgroundColor" in animation) {
            view.style[style_properties_1.backgroundColorProperty.keyframe] = properties_1.unsetValue;
        }
        if ("scale" in animation) {
            view.style[style_properties_1.scaleXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.scaleYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("translate" in animation) {
            view.style[style_properties_1.translateXProperty.keyframe] = properties_1.unsetValue;
            view.style[style_properties_1.translateYProperty.keyframe] = properties_1.unsetValue;
        }
        if ("rotate" in animation) {
            view.style[style_properties_1.rotateProperty.keyframe] = properties_1.unsetValue;
        }
        if ("opacity" in animation) {
            view.style[style_properties_1.opacityProperty.keyframe] = properties_1.unsetValue;
        }
        if ("height" in animation) {
            view.style[style_properties_1.heightProperty.keyframe] = properties_1.unsetValue;
        }
        if ("width" in animation) {
            view.style[style_properties_1.widthProperty.keyframe] = properties_1.unsetValue;
        }
    };
    return KeyframeAnimation;
}());
exports.KeyframeAnimation = KeyframeAnimation;
//# sourceMappingURL=keyframe-animation.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/binding-builder.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var expressionSymbolsRegex = /[\+\-\*\/%\?:<>=!\|&\(\)^~]/;
var bindingConstants;
(function (bindingConstants) {
    bindingConstants.sourceProperty = "sourceProperty";
    bindingConstants.targetProperty = "targetProperty";
    bindingConstants.expression = "expression";
    bindingConstants.twoWay = "twoWay";
    bindingConstants.source = "source";
    bindingConstants.bindingValueKey = "$value";
    bindingConstants.parentValueKey = "$parent";
    bindingConstants.parentsValueKey = "$parents";
    bindingConstants.newPropertyValueKey = "$newPropertyValue";
})(bindingConstants = exports.bindingConstants || (exports.bindingConstants = {}));
var hasEqualSignRegex = /=+/;
var equalSignComparisionOperatorsRegex = /(==|===|>=|<=|!=|!==)/;
exports.parentsRegex = /\$parents\s*\[\s*(['"]*)\w*\1\s*\]/g;
function isNamedParam(value) {
    var equalSignIndex = value.search(hasEqualSignRegex);
    if (equalSignIndex > -1) {
        var equalSignSurround = value.substr(equalSignIndex > 0 ? equalSignIndex - 1 : 0, 3);
        if (equalSignSurround.search(equalSignComparisionOperatorsRegex) === -1) {
            return true;
        }
    }
    return false;
}
function areNamedParams(params) {
    for (var i = 0; i < params.length; i++) {
        if (isNamedParam(params[i])) {
            return true;
        }
    }
    return false;
}
var namedParamConstants = {
    propName: "propName",
    propValue: "propValue"
};
function getPropertyNameValuePair(param, knownOptions, callback) {
    var nameValuePair = {};
    var propertyName = param.substr(0, param.indexOf("=")).trim();
    var propertyValue = param.substr(param.indexOf("=") + 1).trim();
    if (knownOptions) {
        if (!propertyName) {
            propertyName = knownOptions.defaultProperty;
        }
        else {
            propertyName = propertyName in knownOptions ? propertyName : null;
        }
    }
    if (propertyName) {
        if (callback) {
            nameValuePair = callback(propertyName, propertyValue);
        }
        else {
            nameValuePair[namedParamConstants.propName] = propertyName;
            nameValuePair[namedParamConstants.propValue] = propertyValue;
        }
        return nameValuePair;
    }
    return null;
}
function parseNamedProperties(parameterList, knownOptions, callback) {
    var result = {};
    var nameValuePair;
    for (var i = 0; i < parameterList.length; i++) {
        nameValuePair = getPropertyNameValuePair(parameterList[i], knownOptions, callback);
        if (nameValuePair) {
            result[nameValuePair[namedParamConstants.propName]] = nameValuePair[namedParamConstants.propValue];
        }
    }
    return result;
}
function getParamsArray(value) {
    var result = [];
    var skipComma = 0;
    var indexReached = 0;
    var singleQuoteBlock = false;
    var doubleQuoteBlock = false;
    for (var i = 0; i < value.length; i++) {
        if (value[i] === "\"") {
            doubleQuoteBlock = !doubleQuoteBlock;
        }
        if (value[i] === "'") {
            singleQuoteBlock = !singleQuoteBlock;
        }
        if (value[i] === "(" || value[i] === "[") {
            skipComma++;
        }
        if (value[i] === ")" || value[i] === "]") {
            skipComma--;
        }
        if (value[i] === "," && skipComma === 0 && !(singleQuoteBlock || doubleQuoteBlock)) {
            result.push(value.substr(indexReached, i - indexReached));
            indexReached = i + 1;
        }
    }
    result.push(value.substr(indexReached));
    return result;
}
function isExpression(expression) {
    if (expression.search(expressionSymbolsRegex) > -1) {
        var parentsMatches = expression.match(exports.parentsRegex);
        if (parentsMatches) {
            var restOfExpression = expression.substr(expression.indexOf(parentsMatches[0]) + parentsMatches[0].length);
            if (!(restOfExpression.search(expressionSymbolsRegex) > -1)) {
                return false;
            }
        }
        return true;
    }
    return false;
}
function getBindingOptions(name, value) {
    var namedParams = [];
    var params = getParamsArray(value);
    if (!areNamedParams(params)) {
        if (params.length === 1) {
            var trimmedValue = params[0].trim();
            var sourceProp = void 0;
            if (isExpression(trimmedValue)) {
                sourceProp = bindingConstants.bindingValueKey;
                namedParams.push(bindingConstants.expression + " = " + trimmedValue);
            }
            else {
                sourceProp = trimmedValue;
            }
            namedParams.push(bindingConstants.sourceProperty + " = " + sourceProp);
            namedParams.push(bindingConstants.twoWay + " = true");
        }
        else {
            namedParams.push(bindingConstants.sourceProperty + " = " + params[0].trim());
            namedParams.push(bindingConstants.expression + " = " + params[1].trim());
            var twoWay = params[2] ? params[2].toLowerCase().trim() === "true" : true;
            namedParams.push(bindingConstants.twoWay + " = " + twoWay);
        }
    }
    else {
        namedParams = params;
    }
    var bindingPropertyHandler = function (prop, value) {
        var result = {};
        result[namedParamConstants.propName] = prop;
        if (prop === bindingConstants.twoWay) {
            if (value === "true") {
                result[namedParamConstants.propValue] = true;
            }
            else {
                result[namedParamConstants.propValue] = false;
            }
        }
        else {
            result[namedParamConstants.propValue] = value;
        }
        return result;
    };
    var bindingOptionsParameters = parseNamedProperties(namedParams, xmlBindingProperties, bindingPropertyHandler);
    var bindOptions = {
        targetProperty: name
    };
    for (var prop in bindingOptionsParameters) {
        if (bindingOptionsParameters.hasOwnProperty(prop)) {
            bindOptions[prop] = bindingOptionsParameters[prop];
        }
    }
    if (bindOptions[bindingConstants.twoWay] === undefined) {
        bindOptions[bindingConstants.twoWay] = true;
    }
    return bindOptions;
}
exports.getBindingOptions = getBindingOptions;
var xmlBindingProperties = {
    sourceProperty: true,
    expression: true,
    twoWay: true,
    source: true,
    defaultProperty: bindingConstants.sourceProperty
};
//# sourceMappingURL=binding-builder.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var xml = __webpack_require__("../node_modules/tns-core-modules/xml/xml.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var component_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var ios = platform_1.platformNames.ios.toLowerCase();
var android = platform_1.platformNames.android.toLowerCase();
var defaultNameSpaceMatcher = /tns\.xsd$/i;
function parse(value, context) {
    if (typeof value === "function") {
        return value();
    }
    else {
        var exports_1 = context ? getExports(context) : undefined;
        var componentModule = parseInternal(value, exports_1);
        return componentModule && componentModule.component;
    }
}
exports.parse = parse;
function parseMultipleTemplates(value, context) {
    var dummyComponent = "<ListView><ListView.itemTemplates>" + value + "</ListView.itemTemplates></ListView>";
    return parseInternal(dummyComponent, context).component["itemTemplates"];
}
exports.parseMultipleTemplates = parseMultipleTemplates;
function load(pathOrOptions, context) {
    var componentModule;
    if (typeof pathOrOptions === "string") {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(pathOrOptions);
        componentModule = loadInternal(moduleName, context);
    }
    else {
        componentModule = loadCustomComponent(pathOrOptions.path, pathOrOptions.name, pathOrOptions.attributes, pathOrOptions.exports, pathOrOptions.page, true);
    }
    return componentModule && componentModule.component;
}
exports.load = load;
exports.createViewFromEntry = profiling_1.profile("createViewFromEntry", function (entry) {
    if (entry.create) {
        var view = entry.create();
        if (!view) {
            throw new Error("Failed to create View with entry.create() function.");
        }
        return view;
    }
    else if (entry.moduleName) {
        var moduleName = module_name_sanitizer_1.sanitizeModuleName(entry.moduleName);
        var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
        var moduleExports = resolvedCodeModuleName ? global.loadModule(resolvedCodeModuleName, true) : null;
        if (moduleExports && moduleExports.createPage) {
            var view = moduleExports.createPage();
            var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
            if (resolvedCssModuleName) {
                view.addCssFile(resolvedCssModuleName);
            }
            return view;
        }
        else {
            var componentModule = loadInternal(moduleName, moduleExports);
            var componentView = componentModule && componentModule.component;
            return componentView;
        }
    }
    throw new Error("Failed to load page XML file for module: " + entry.moduleName);
});
function loadInternal(moduleName, moduleExports) {
    var componentModule;
    var resolvedXmlModule = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    if (resolvedXmlModule) {
        var text = global.loadModule(resolvedXmlModule, true);
        componentModule = parseInternal(text, moduleExports, resolvedXmlModule, moduleName);
    }
    var componentView = componentModule && componentModule.component;
    if (componentView) {
        componentView.exports = moduleExports;
        componentView._moduleName = moduleName;
    }
    if (!componentModule) {
        throw new Error("Failed to load component from module: " + moduleName);
    }
    return componentModule;
}
function loadCustomComponent(componentNamespace, componentName, attributes, context, parentPage, isRootComponent, moduleNamePath) {
    if (isRootComponent === void 0) { isRootComponent = true; }
    if (!parentPage && context) {
        parentPage = context["_parentPage"];
        delete context["_parentPage"];
    }
    var result;
    componentNamespace = module_name_sanitizer_1.sanitizeModuleName(componentNamespace);
    var moduleName = componentNamespace + "/" + componentName;
    var resolvedCodeModuleName = module_name_resolver_1.resolveModuleName(moduleName, "");
    var resolvedXmlModuleName = module_name_resolver_1.resolveModuleName(moduleName, "xml");
    var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
    if (resolvedXmlModuleName) {
        var subExports = context;
        if (resolvedCodeModuleName) {
            subExports = global.loadModule(resolvedCodeModuleName, true);
        }
        if (!subExports) {
            subExports = {};
        }
        subExports["_parentPage"] = parentPage;
        result = loadInternal(moduleName, subExports);
        if (types_1.isDefined(result) && types_1.isDefined(result.component) && types_1.isDefined(attributes)) {
            for (var attr in attributes) {
                component_builder_1.setPropertyValue(result.component, subExports, context, attr, attributes[attr]);
            }
        }
    }
    else {
        result = component_builder_1.getComponentModule(componentName, componentNamespace, attributes, context, moduleNamePath, isRootComponent);
        if (!resolvedCssModuleName) {
            resolvedCssModuleName = module_name_resolver_1.resolveModuleName(componentNamespace, "css");
        }
    }
    if (parentPage && resolvedCssModuleName) {
        parentPage.addCssFile(resolvedCssModuleName);
    }
    return result;
}
function getExports(instance) {
    var isView = !!instance._domId;
    if (!isView) {
        return instance.exports || instance;
    }
    var exportObject = instance.exports;
    var parent = instance.parent;
    while (exportObject === undefined && parent) {
        exportObject = parent.exports;
        parent = parent.parent;
    }
    return exportObject;
}
function parseInternal(value, context, xmlModule, moduleName) {
    var start;
    var ui;
    var errorFormat = (debug_1.debug && xmlModule) ? xml2ui.SourceErrorFormat(xmlModule) : xml2ui.PositionErrorFormat;
    var componentSourceTracker = (debug_1.debug && xmlModule) ? xml2ui.ComponentSourceTracker(xmlModule) : function () {
    };
    (start = new xml2ui.XmlStringParser(errorFormat))
        .pipe(new xml2ui.PlatformFilter())
        .pipe(new xml2ui.XmlStateParser(ui = new xml2ui.ComponentParser(context, errorFormat, componentSourceTracker, moduleName)));
    start.parse(value);
    return ui.rootComponentModule;
}
var xml2ui;
(function (xml2ui) {
    var XmlProducerBase = (function () {
        function XmlProducerBase() {
        }
        XmlProducerBase.prototype.pipe = function (next) {
            this._next = next;
            return next;
        };
        XmlProducerBase.prototype.next = function (args) {
            this._next.parse(args);
        };
        return XmlProducerBase;
    }());
    xml2ui.XmlProducerBase = XmlProducerBase;
    var XmlStringParser = (function (_super) {
        __extends(XmlStringParser, _super);
        function XmlStringParser(error) {
            var _this = _super.call(this) || this;
            _this.error = error || PositionErrorFormat;
            return _this;
        }
        XmlStringParser.prototype.parse = function (value) {
            var _this = this;
            var xmlParser = new xml.XmlParser(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            }, function (e, p) {
                throw _this.error(e, p);
            }, true);
            if (types_1.isString(value)) {
                xmlParser.parse(value);
            }
        };
        return XmlStringParser;
    }(XmlProducerBase));
    xml2ui.XmlStringParser = XmlStringParser;
    function PositionErrorFormat(e, p) {
        return new debug_1.ScopeError(e, "Parsing XML at " + p.line + ":" + p.column);
    }
    xml2ui.PositionErrorFormat = PositionErrorFormat;
    function SourceErrorFormat(uri) {
        return function (e, p) {
            var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
            e = new debug_1.SourceError(e, source, "Building UI from XML.");
            return e;
        };
    }
    xml2ui.SourceErrorFormat = SourceErrorFormat;
    function ComponentSourceTracker(uri) {
        return function (component, p) {
            if (!debug_1.Source.get(component)) {
                var source = p ? new debug_1.Source(uri, p.line, p.column) : new debug_1.Source(uri, -1, -1);
                debug_1.Source.set(component, source);
            }
        };
    }
    xml2ui.ComponentSourceTracker = ComponentSourceTracker;
    var PlatformFilter = (function (_super) {
        __extends(PlatformFilter, _super);
        function PlatformFilter() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        PlatformFilter.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    if (this.currentPlatformContext) {
                        throw new Error("Already in '" + this.currentPlatformContext + "' platform context and cannot switch to '" + args.elementName + "' platform! Platform tags cannot be nested.");
                    }
                    this.currentPlatformContext = args.elementName;
                    return;
                }
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                if (PlatformFilter.isPlatform(args.elementName)) {
                    this.currentPlatformContext = undefined;
                    return;
                }
            }
            if (this.currentPlatformContext && !PlatformFilter.isCurentPlatform(this.currentPlatformContext)) {
                return;
            }
            this.next(args);
        };
        PlatformFilter.isPlatform = function (value) {
            if (value) {
                var toLower = value.toLowerCase();
                return toLower === android || toLower === ios;
            }
            return false;
        };
        PlatformFilter.isCurentPlatform = function (value) {
            return value && value.toLowerCase() === platform_1.device.os.toLowerCase();
        };
        return PlatformFilter;
    }(XmlProducerBase));
    xml2ui.PlatformFilter = PlatformFilter;
    var XmlArgsReplay = (function (_super) {
        __extends(XmlArgsReplay, _super);
        function XmlArgsReplay(args, errorFormat) {
            var _this = _super.call(this) || this;
            _this.args = args;
            _this.error = errorFormat;
            return _this;
        }
        XmlArgsReplay.prototype.replay = function () {
            var _this = this;
            this.args.forEach(function (args) {
                try {
                    _this.next(args);
                }
                catch (e) {
                    throw _this.error(e, args.position);
                }
            });
        };
        return XmlArgsReplay;
    }(XmlProducerBase));
    xml2ui.XmlArgsReplay = XmlArgsReplay;
    var XmlStateParser = (function () {
        function XmlStateParser(state) {
            this.state = state;
        }
        XmlStateParser.prototype.parse = function (args) {
            this.state = this.state.parse(args);
        };
        return XmlStateParser;
    }());
    xml2ui.XmlStateParser = XmlStateParser;
    var TemplateParser = (function () {
        function TemplateParser(parent, templateProperty, setTemplateProperty) {
            if (setTemplateProperty === void 0) { setTemplateProperty = true; }
            this.parent = parent;
            this._context = templateProperty.context;
            this._recordedXmlStream = new Array();
            this._templateProperty = templateProperty;
            this._nestingLevel = 0;
            this._state = 0;
            this._setTemplateProperty = setTemplateProperty;
        }
        TemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement) {
                this.parseStartElement(args.prefix, args.namespace, args.elementName, args.attributes);
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                this.parseEndElement(args.prefix, args.elementName);
            }
            this._recordedXmlStream.push(args);
            return this._state === 2 ? this.parent : this;
        };
        Object.defineProperty(TemplateParser.prototype, "elementName", {
            get: function () {
                return this._templateProperty.elementName;
            },
            enumerable: true,
            configurable: true
        });
        TemplateParser.prototype.parseStartElement = function (prefix, namespace, elementName, attributes) {
            if (this._state === 0) {
                this._state = 1;
            }
            else if (this._state === 2) {
                throw new Error("Template must have exactly one root element but multiple elements were found.");
            }
            this._nestingLevel++;
        };
        TemplateParser.prototype.parseEndElement = function (prefix, elementName) {
            if (this._state === 0) {
                throw new Error("Template must have exactly one root element but none was found.");
            }
            else if (this._state === 2) {
                throw new Error("No more closing elements expected for this template.");
            }
            this._nestingLevel--;
            if (this._nestingLevel === 0) {
                this._state = 2;
                if (this._setTemplateProperty && this._templateProperty.name in this._templateProperty.parent.component) {
                    var template = this.buildTemplate();
                    this._templateProperty.parent.component[this._templateProperty.name] = template;
                }
            }
        };
        TemplateParser.prototype.buildTemplate = function () {
            var _this = this;
            var context = this._context;
            var errorFormat = this._templateProperty.errorFormat;
            var sourceTracker = this._templateProperty.sourceTracker;
            var template = profiling_1.profile("Template()", function () {
                var start;
                var ui;
                (start = new xml2ui.XmlArgsReplay(_this._recordedXmlStream, errorFormat))
                    .pipe(new XmlStateParser(ui = new ComponentParser(context, errorFormat, sourceTracker)));
                start.replay();
                return ui.rootComponentModule.component;
            });
            return template;
        };
        return TemplateParser;
    }());
    xml2ui.TemplateParser = TemplateParser;
    var MultiTemplateParser = (function () {
        function MultiTemplateParser(parent, templateProperty) {
            this.parent = parent;
            this.templateProperty = templateProperty;
            this._childParsers = new Array();
        }
        Object.defineProperty(MultiTemplateParser.prototype, "value", {
            get: function () { return this._value; },
            enumerable: true,
            configurable: true
        });
        MultiTemplateParser.prototype.parse = function (args) {
            if (args.eventType === xml.ParserEventType.StartElement && args.elementName === "template") {
                var childParser = new TemplateParser(this, this.templateProperty, false);
                childParser["key"] = args.attributes["key"];
                this._childParsers.push(childParser);
                return childParser;
            }
            if (args.eventType === xml.ParserEventType.EndElement) {
                var name_1 = ComponentParser.getComplexPropertyName(args.elementName);
                if (name_1 === this.templateProperty.name) {
                    var templates = new Array();
                    for (var i = 0; i < this._childParsers.length; i++) {
                        templates.push({
                            key: this._childParsers[i]["key"],
                            createView: this._childParsers[i].buildTemplate()
                        });
                    }
                    this._value = templates;
                    return this.parent.parse(args);
                }
            }
            return this;
        };
        return MultiTemplateParser;
    }());
    xml2ui.MultiTemplateParser = MultiTemplateParser;
    var ComponentParser = (function () {
        function ComponentParser(context, errorFormat, sourceTracker, moduleName) {
            this.moduleName = moduleName;
            this.parents = new Array();
            this.complexProperties = new Array();
            this.context = context;
            this.error = errorFormat;
            this.sourceTracker = sourceTracker;
        }
        ComponentParser.prototype.buildComponent = function (args) {
            if (args.prefix && args.namespace) {
                return loadCustomComponent(args.namespace, args.elementName, args.attributes, this.context, this.currentRootView, !this.currentRootView, this.moduleName);
            }
            else {
                var namespace = args.namespace;
                if (defaultNameSpaceMatcher.test(namespace || "")) {
                    namespace = undefined;
                }
                return component_builder_1.getComponentModule(args.elementName, namespace, args.attributes, this.context, this.moduleName, !this.currentRootView);
            }
        };
        ComponentParser.prototype.parse = function (args) {
            var parent = this.parents[this.parents.length - 1];
            var complexProperty = this.complexProperties[this.complexProperties.length - 1];
            if (args.eventType === xml.ParserEventType.StartElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    var name_2 = ComponentParser.getComplexPropertyName(args.elementName);
                    var complexProperty_1 = {
                        parent: parent,
                        name: name_2,
                        items: []
                    };
                    this.complexProperties.push(complexProperty_1);
                    if (ComponentParser.isKnownTemplate(name_2, parent.exports)) {
                        return new TemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                    }
                    if (ComponentParser.isKnownMultiTemplate(name_2, parent.exports)) {
                        var parser = new MultiTemplateParser(this, {
                            context: (parent ? getExports(parent.component) : null) || this.context,
                            parent: parent,
                            name: name_2,
                            elementName: args.elementName,
                            templateItems: [],
                            errorFormat: this.error,
                            sourceTracker: this.sourceTracker
                        });
                        complexProperty_1.parser = parser;
                        return parser;
                    }
                }
                else {
                    var componentModule = this.buildComponent(args);
                    if (componentModule) {
                        this.sourceTracker(componentModule.component, args.position);
                        if (parent) {
                            if (complexProperty) {
                                ComponentParser.addToComplexProperty(parent, complexProperty, componentModule);
                            }
                            else if (parent.component._addChildFromBuilder) {
                                parent.component._addChildFromBuilder(args.elementName, componentModule.component);
                            }
                        }
                        else if (this.parents.length === 0) {
                            this.rootComponentModule = componentModule;
                            if (this.rootComponentModule) {
                                this.currentRootView = this.rootComponentModule.component;
                                if (this.currentRootView.exports) {
                                    this.context = this.currentRootView.exports;
                                }
                            }
                        }
                        this.parents.push(componentModule);
                    }
                }
            }
            else if (args.eventType === xml.ParserEventType.EndElement) {
                if (ComponentParser.isComplexProperty(args.elementName)) {
                    if (complexProperty) {
                        if (complexProperty.parser) {
                            parent.component[complexProperty.name] = complexProperty.parser.value;
                        }
                        else if (parent && parent.component._addArrayFromBuilder) {
                            parent.component._addArrayFromBuilder(complexProperty.name, complexProperty.items);
                            complexProperty.items = [];
                        }
                    }
                    this.complexProperties.pop();
                }
                else {
                    this.parents.pop();
                }
            }
            return this;
        };
        ComponentParser.isComplexProperty = function (name) {
            return types_1.isString(name) && name.indexOf(".") !== -1;
        };
        ComponentParser.getComplexPropertyName = function (fullName) {
            var name;
            if (types_1.isString(fullName)) {
                var names = fullName.split(".");
                name = names[names.length - 1];
            }
            return name;
        };
        ComponentParser.isKnownTemplate = function (name, exports) {
            return ComponentParser.KNOWNTEMPLATES in exports && exports[ComponentParser.KNOWNTEMPLATES] && name in exports[ComponentParser.KNOWNTEMPLATES];
        };
        ComponentParser.isKnownMultiTemplate = function (name, exports) {
            return ComponentParser.KNOWNMULTITEMPLATES in exports && exports[ComponentParser.KNOWNMULTITEMPLATES] && name in exports[ComponentParser.KNOWNMULTITEMPLATES];
        };
        ComponentParser.addToComplexProperty = function (parent, complexProperty, elementModule) {
            var parentComponent = parent.component;
            if (ComponentParser.isKnownCollection(complexProperty.name, parent.exports)) {
                complexProperty.items.push(elementModule.component);
            }
            else if (parentComponent._addChildFromBuilder) {
                parentComponent._addChildFromBuilder(complexProperty.name, elementModule.component);
            }
            else {
                parentComponent[complexProperty.name] = elementModule.component;
            }
        };
        ComponentParser.isKnownCollection = function (name, context) {
            return ComponentParser.KNOWNCOLLECTIONS in context && context[ComponentParser.KNOWNCOLLECTIONS] && name in context[ComponentParser.KNOWNCOLLECTIONS];
        };
        ComponentParser.KNOWNCOLLECTIONS = "knownCollections";
        ComponentParser.KNOWNTEMPLATES = "knownTemplates";
        ComponentParser.KNOWNMULTITEMPLATES = "knownMultiTemplates";
        __decorate([
            profiling_1.profile
        ], ComponentParser.prototype, "buildComponent", null);
        return ComponentParser;
    }());
    xml2ui.ComponentParser = ComponentParser;
})(xml2ui || (xml2ui = {}));
//# sourceMappingURL=builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/component-builder/component-builder.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var platform = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var module_name_resolver_1 = __webpack_require__("../node_modules/tns-core-modules/module-name-resolver/module-name-resolver.js");
var UI_PATH = "ui/";
var MODULES = {
    "TabViewItem": "ui/tab-view",
    "TabStrip": "ui/tab-navigation-base/tab-strip",
    "TabStripItem": "ui/tab-navigation-base/tab-strip-item",
    "TabContentItem": "ui/tab-navigation-base/tab-content-item",
    "FormattedString": "text/formatted-string",
    "Span": "text/span",
    "ActionItem": "ui/action-bar",
    "NavigationButton": "ui/action-bar",
    "SegmentedBarItem": "ui/segmented-bar",
};
var CODE_FILE = "codeFile";
var CSS_FILE = "cssFile";
var IMPORT = "import";
var createComponentInstance = profiling_1.profile("createComponentInstance", function (elementName, namespace) {
    var instance;
    var instanceModule;
    var resolvedModuleName;
    try {
        if (typeof namespace === "string") {
            resolvedModuleName = module_name_resolver_1.resolveModuleName(namespace, "");
            instanceModule = global.loadModule(resolvedModuleName, true);
        }
        else {
            resolvedModuleName = MODULES[elementName] || UI_PATH +
                (elementName.toLowerCase().indexOf("layout") !== -1 ? "layouts/" : "") +
                elementName.split(/(?=[A-Z])/).join("-").toLowerCase();
            instanceModule = global.loadModule(resolvedModuleName, false);
        }
        var instanceType = instanceModule[elementName] || Object;
        instance = new instanceType();
    }
    catch (ex) {
        var debug = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
        throw new debug.ScopeError(ex, "Module '" + resolvedModuleName + "' not found for element '" + (namespace ? namespace + ":" : "") + elementName + "'.");
    }
    return { instance: instance, instanceModule: instanceModule };
});
var getComponentModuleExports = profiling_1.profile("getComponentModuleExports", function (instance, moduleExports, attributes) {
    if (attributes) {
        var codeFileAttribute = attributes[CODE_FILE] || attributes[IMPORT];
        if (codeFileAttribute) {
            var resolvedCodeFileModule = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(codeFileAttribute), "");
            if (resolvedCodeFileModule) {
                moduleExports = global.loadModule(resolvedCodeFileModule, true);
                instance.exports = moduleExports;
            }
            else {
                throw new Error("Code file with path \"" + codeFileAttribute + "\" cannot be found! Looking for webpack module with name \"" + resolvedCodeFileModule + "\"");
            }
        }
    }
    return moduleExports;
});
var applyComponentCss = profiling_1.profile("applyComponentCss", function (instance, moduleName, attributes) {
    var cssApplied = false;
    if (attributes && attributes[CSS_FILE]) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(module_name_sanitizer_1.sanitizeModuleName(attributes[CSS_FILE]), "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
            cssApplied = true;
        }
        else {
            throw new Error("Css file with path \"" + attributes[CSS_FILE] + "\" cannot be found! Looking for webpack module with name \"" + resolvedCssModuleName + "\"");
        }
    }
    if (moduleName && !cssApplied) {
        var resolvedCssModuleName = module_name_resolver_1.resolveModuleName(moduleName, "css");
        if (resolvedCssModuleName) {
            instance.addCssFile(resolvedCssModuleName);
        }
    }
});
var applyComponentAttributes = profiling_1.profile("applyComponentAttributes", function (instance, instanceModule, moduleExports, attributes) {
    if (instance && instanceModule) {
        for (var attr in attributes) {
            var attrValue = attributes[attr];
            if (attr.indexOf(":") !== -1) {
                var platformName = attr.split(":")[0].trim();
                if (platformName.toLowerCase() === platform.device.os.toLowerCase()) {
                    attr = attr.split(":")[1].trim();
                }
                else {
                    continue;
                }
            }
            if (attr.indexOf(".") !== -1) {
                var subObj = instance;
                var properties = attr.split(".");
                var subPropName = properties[properties.length - 1];
                for (var i = 0; i < properties.length - 1; i++) {
                    if (subObj !== undefined && subObj !== null) {
                        subObj = subObj[properties[i]];
                    }
                }
                if (subObj !== undefined && subObj !== null) {
                    setPropertyValue(subObj, instanceModule, moduleExports, subPropName, attrValue);
                }
            }
            else {
                setPropertyValue(instance, instanceModule, moduleExports, attr, attrValue);
            }
        }
    }
});
function getComponentModule(elementName, namespace, attributes, moduleExports, moduleNamePath, isRootComponent) {
    elementName = elementName.split("-").map(function (s) { return s[0].toUpperCase() + s.substring(1); }).join("");
    var _a = createComponentInstance(elementName, namespace), instance = _a.instance, instanceModule = _a.instanceModule;
    moduleExports = getComponentModuleExports(instance, moduleExports, attributes);
    if (isRootComponent) {
        applyComponentCss(instance, moduleNamePath, attributes);
    }
    applyComponentAttributes(instance, instanceModule, moduleExports, attributes);
    var componentModule;
    if (instance && instanceModule) {
        componentModule = { component: instance, exports: instanceModule };
    }
    return componentModule;
}
exports.getComponentModule = getComponentModule;
function setPropertyValue(instance, instanceModule, exports, propertyName, propertyValue) {
    if (isBinding(propertyValue) && instance.bind) {
        var bindOptions = binding_builder_1.getBindingOptions(propertyName, getBindingExpressionFromAttribute(propertyValue));
        instance.bind({
            sourceProperty: bindOptions[binding_builder_1.bindingConstants.sourceProperty],
            targetProperty: bindOptions[binding_builder_1.bindingConstants.targetProperty],
            expression: bindOptions[binding_builder_1.bindingConstants.expression],
            twoWay: bindOptions[binding_builder_1.bindingConstants.twoWay]
        }, bindOptions[binding_builder_1.bindingConstants.source]);
    }
    else if (bindable_1.isEventOrGesture(propertyName, instance)) {
        var handler = exports && exports[propertyValue];
        if (typeof handler === "function") {
            instance.on(propertyName, handler);
        }
    }
    else if (isKnownFunction(propertyName, instance) && exports && typeof exports[propertyValue] === "function") {
        instance[propertyName] = exports[propertyValue];
    }
    else {
        instance[propertyName] = propertyValue;
    }
}
exports.setPropertyValue = setPropertyValue;
function getBindingExpressionFromAttribute(value) {
    return value.replace("{{", "").replace("}}", "").trim();
}
function isBinding(value) {
    var isBinding;
    if (typeof value === "string") {
        var str = value.trim();
        isBinding = str.indexOf("{{") === 0 && str.lastIndexOf("}}") === str.length - 2;
    }
    return isBinding;
}
var KNOWN_FUNCTIONS = "knownFunctions";
function isKnownFunction(name, instance) {
    return instance.constructor
        && KNOWN_FUNCTIONS in instance.constructor
        && instance.constructor[KNOWN_FUNCTIONS].indexOf(name) !== -1;
}
//# sourceMappingURL=component-builder.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function sanitizeModuleName(moduleName, removeExtension) {
    if (removeExtension === void 0) { removeExtension = true; }
    moduleName = moduleName.trim();
    if (moduleName.startsWith("~/")) {
        moduleName = moduleName.substring(2);
    }
    else if (moduleName.startsWith("/")) {
        moduleName = moduleName.substring(1);
    }
    if (removeExtension) {
        var lastDot = moduleName.lastIndexOf(".");
        if (lastDot > 0) {
            moduleName = moduleName.substr(0, lastDot);
        }
    }
    return moduleName;
}
exports.sanitizeModuleName = sanitizeModuleName;
//# sourceMappingURL=module-name-sanitizer.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var ButtonBase = (function (_super) {
    __extends(ButtonBase, _super);
    function ButtonBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(ButtonBase.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    ButtonBase.tapEvent = "tap";
    ButtonBase = __decorate([
        text_base_1.CSSType("Button")
    ], ButtonBase);
    return ButtonBase;
}(text_base_1.TextBase));
exports.ButtonBase = ButtonBase;
ButtonBase.prototype.recycleNativeView = "auto";
//# sourceMappingURL=button-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/button/button.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var control_state_change_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/control-state-change/control-state-change.js");
var button_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/button/button-common.js"));
var Button = (function (_super) {
    __extends(Button, _super);
    function Button() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Button.prototype.createNativeView = function () {
        return UIButton.buttonWithType(1);
    };
    Button.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        var nativeView = this.nativeViewProtected;
        this._tapHandler = TapHandlerImpl.initWithOwner(new WeakRef(this));
        nativeView.addTargetActionForControlEvents(this._tapHandler, "tap", 64);
    };
    Button.prototype.disposeNativeView = function () {
        this._tapHandler = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(Button.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Button.prototype.onUnloaded = function () {
        _super.prototype.onUnloaded.call(this);
        if (this._stateChangedHandler) {
            this._stateChangedHandler.stop();
        }
    };
    Button.prototype._updateButtonStateChangeHandler = function (subscribe) {
        var _this = this;
        if (subscribe) {
            if (!this._stateChangedHandler) {
                this._stateChangedHandler = new control_state_change_1.ControlStateChangeListener(this.nativeViewProtected, function (s) {
                    _this._goToVisualState(s);
                });
            }
            this._stateChangedHandler.start();
        }
        else {
            this._stateChangedHandler.stop();
        }
    };
    Button.prototype[button_common_1.borderTopWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.top,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderTopWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var top = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop + this.effectiveBorderTopWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: top, left: inset.left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.borderRightWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.right,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderRightWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var right = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight + this.effectiveBorderRightWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: inset.bottom, right: right };
    };
    Button.prototype[button_common_1.borderBottomWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.bottom,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderBottomWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var bottom = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom + this.effectiveBorderBottomWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: bottom, right: inset.right };
    };
    Button.prototype[button_common_1.borderLeftWidthProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.left,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.borderLeftWidthProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var left = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft + this.effectiveBorderLeftWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.paddingTopProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.top,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingTopProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var top = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop + this.effectiveBorderTopWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: top, left: inset.left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.paddingRightProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.right,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingRightProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var right = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight + this.effectiveBorderRightWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: inset.bottom, right: right };
    };
    Button.prototype[button_common_1.paddingBottomProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.bottom,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingBottomProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var bottom = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom + this.effectiveBorderBottomWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: inset.left, bottom: bottom, right: inset.right };
    };
    Button.prototype[button_common_1.paddingLeftProperty.getDefault] = function () {
        return {
            value: this.nativeViewProtected.contentEdgeInsets.left,
            unit: "px"
        };
    };
    Button.prototype[button_common_1.paddingLeftProperty.setNative] = function (value) {
        var inset = this.nativeViewProtected.contentEdgeInsets;
        var left = button_common_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft + this.effectiveBorderLeftWidth);
        this.nativeViewProtected.contentEdgeInsets = { top: inset.top, left: left, bottom: inset.bottom, right: inset.right };
    };
    Button.prototype[button_common_1.textAlignmentProperty.setNative] = function (value) {
        switch (value) {
            case "left":
                this.nativeViewProtected.titleLabel.textAlignment = 0;
                this.nativeViewProtected.contentHorizontalAlignment = 1;
                break;
            case "initial":
            case "center":
                this.nativeViewProtected.titleLabel.textAlignment = 1;
                this.nativeViewProtected.contentHorizontalAlignment = 0;
                break;
            case "right":
                this.nativeViewProtected.titleLabel.textAlignment = 2;
                this.nativeViewProtected.contentHorizontalAlignment = 2;
                break;
        }
    };
    Button.prototype[button_common_1.whiteSpaceProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected.titleLabel;
        switch (value) {
            case "normal":
                nativeView.lineBreakMode = 0;
                nativeView.numberOfLines = 0;
                break;
            case "nowrap":
            case "initial":
                nativeView.lineBreakMode = 5;
                nativeView.numberOfLines = 1;
                break;
        }
    };
    Button.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        if (!this.textWrap) {
            return _super.prototype.onMeasure.call(this, widthMeasureSpec, heightMeasureSpec);
        }
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            var width = button_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
            var widthMode = button_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
            var height = button_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
            var heightMode = button_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
            var horizontalPadding = this.effectivePaddingLeft + this.effectiveBorderLeftWidth + this.effectivePaddingRight + this.effectiveBorderRightWidth;
            var verticalPadding = this.effectivePaddingTop + this.effectiveBorderTopWidth + this.effectivePaddingBottom + this.effectiveBorderBottomWidth;
            if (verticalPadding === 0) {
                verticalPadding = button_common_1.layout.toDevicePixels(12);
            }
            var desiredSize = button_common_1.layout.measureNativeView(nativeView.titleLabel, width - horizontalPadding, widthMode, height - verticalPadding, heightMode);
            desiredSize.width = desiredSize.width + horizontalPadding;
            desiredSize.height = desiredSize.height + verticalPadding;
            var measureWidth = Math.max(desiredSize.width, this.effectiveMinWidth);
            var measureHeight = Math.max(desiredSize.height, this.effectiveMinHeight);
            var widthAndState = button_common_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
            var heightAndState = button_common_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
            this.setMeasuredDimension(widthAndState, heightAndState);
        }
    };
    __decorate([
        button_common_1.PseudoClassHandler("normal", "highlighted", "pressed", "active")
    ], Button.prototype, "_updateButtonStateChangeHandler", null);
    return Button;
}(button_common_1.ButtonBase));
exports.Button = Button;
var TapHandlerImpl = (function (_super) {
    __extends(TapHandlerImpl, _super);
    function TapHandlerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TapHandlerImpl.initWithOwner = function (owner) {
        var handler = TapHandlerImpl.new();
        handler._owner = owner;
        return handler;
    };
    TapHandlerImpl.prototype.tap = function (args) {
        var owner = this._owner.get();
        if (owner) {
            owner._emit(button_common_1.ButtonBase.tapEvent);
        }
    };
    TapHandlerImpl.ObjCExposedMethods = {
        "tap": { returns: interop.types.void, params: [interop.types.id] }
    };
    return TapHandlerImpl;
}(NSObject));
//# sourceMappingURL=button.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/bindable/bindable.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
exports.Observable = observable_1.Observable;
exports.WrappedValue = observable_1.WrappedValue;
var weak_event_listener_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js");
var binding_builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/binding-builder.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
exports.traceEnabled = trace_1.isEnabled;
exports.traceWrite = trace_1.write;
exports.traceError = trace_1.error;
exports.traceCategories = trace_1.categories;
exports.traceNotifyEvent = trace_1.notifyEvent;
exports.isCategorySet = trace_1.isCategorySet;
exports.traceMessageType = trace_1.messageType;
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var polymerExpressions = __webpack_require__("../node_modules/tns-core-modules/js-libs/polymer-expressions/polymer-expressions.js");
var contextKey = "context";
var paramsRegex = /\[\s*(['"])*(\w*)\1\s*\]/;
var bc = binding_builder_1.bindingConstants;
var emptyArray = [];
var propertiesCache = {};
function getProperties(property) {
    if (!property) {
        return emptyArray;
    }
    var result = propertiesCache[property];
    if (result) {
        return result;
    }
    var parentsMatches = property.match(binding_builder_1.parentsRegex);
    result = property.replace(binding_builder_1.parentsRegex, "parentsMatch")
        .replace(/\]/g, "")
        .split(/\.|\[/);
    var parentsMatchesCounter = 0;
    for (var i = 0, resultLength = result.length; i < resultLength; i++) {
        if (result[i] === "parentsMatch") {
            result[i] = parentsMatches[parentsMatchesCounter++];
        }
    }
    propertiesCache[property] = result;
    return result;
}
function getEventOrGestureName(name) {
    return name.indexOf("on") === 0 ? name.substr(2, name.length - 2) : name;
}
exports.getEventOrGestureName = getEventOrGestureName;
function isGesture(eventOrGestureName) {
    var t = eventOrGestureName.trim().toLowerCase();
    return t === "tap"
        || t === "doubletap"
        || t === "pinch"
        || t === "pan"
        || t === "swipe"
        || t === "rotation"
        || t === "longpress"
        || t === "touch";
}
exports.isGesture = isGesture;
function isEventOrGesture(name, view) {
    if (typeof name === "string") {
        var eventOrGestureName = getEventOrGestureName(name);
        var evt = eventOrGestureName + "Event";
        return view.constructor && evt in view.constructor || isGesture(eventOrGestureName.toLowerCase());
    }
    return false;
}
exports.isEventOrGesture = isEventOrGesture;
var Binding = (function () {
    function Binding(target, options) {
        this.propertyChangeListeners = new Map();
        this.target = new WeakRef(target);
        this.options = options;
        this.sourceProperties = getProperties(options.sourceProperty);
        this.targetOptions = this.resolveOptions(target, getProperties(options.targetProperty));
        if (!this.targetOptions) {
            throw new Error("Invalid property: " + options.targetProperty + " for target: " + target);
        }
        if (options.twoWay) {
            var target_1 = this.targetOptions.instance.get();
            if (target_1 instanceof observable_1.Observable) {
                target_1.on(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
        }
    }
    Binding.prototype.onTargetPropertyChanged = function (data) {
        this.updateTwoWay(data.value);
    };
    Binding.prototype.loadedHandlerVisualTreeBinding = function (args) {
        var target = args.object;
        target.off("loaded", this.loadedHandlerVisualTreeBinding, this);
        var context = target.bindingContext;
        if (context !== undefined && context !== null) {
            this.update(context);
        }
    };
    Binding.prototype.clearSource = function () {
        var _this = this;
        this.propertyChangeListeners.forEach(function (observable, index, map) {
            weak_event_listener_1.removeWeakEventListener(observable, observable_1.Observable.propertyChangeEvent, _this.onSourcePropertyChanged, _this);
        });
        this.propertyChangeListeners.clear();
        if (this.source) {
            this.source.clear();
        }
        if (this.sourceOptions) {
            this.sourceOptions.instance.clear();
            this.sourceOptions = undefined;
        }
    };
    Binding.prototype.sourceAsObject = function (source) {
        var objectType = typeof source;
        if (objectType === "number") {
            source = new Number(source);
        }
        else if (objectType === "boolean") {
            source = new Boolean(source);
        }
        else if (objectType === "string") {
            source = new String(source);
        }
        return source;
    };
    Binding.prototype.bindingContextChanged = function (data) {
        var target = this.targetOptions.instance.get();
        if (!target) {
            this.unbind();
            return;
        }
        var value = data.value;
        if (value !== null && value !== undefined) {
            this.update(value);
        }
        else {
            this.clearBinding();
        }
    };
    Binding.prototype.bind = function (source) {
        var target = this.targetOptions.instance.get();
        if (this.sourceIsBindingContext && target instanceof observable_1.Observable && this.targetOptions.property !== "bindingContext") {
            target.on("bindingContextChange", this.bindingContextChanged, this);
        }
        this.update(source);
    };
    Binding.prototype.update = function (source) {
        this.clearSource();
        source = this.sourceAsObject(source);
        if (!types.isNullOrUndefined(source)) {
            this.source = new WeakRef(source);
            this.sourceOptions = this.resolveOptions(source, this.sourceProperties);
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue);
            this.addPropertyChangeListeners(this.source, this.sourceProperties);
        }
        else if (!this.sourceIsBindingContext) {
            var sourceValue = this.getSourcePropertyValue();
            this.updateTarget(sourceValue ? sourceValue : source);
        }
    };
    Binding.prototype.unbind = function () {
        var target = this.targetOptions.instance.get();
        if (target instanceof observable_1.Observable) {
            if (this.options.twoWay) {
                target.off(this.targetOptions.property + "Change", this.onTargetPropertyChanged, this);
            }
            if (this.sourceIsBindingContext && this.targetOptions.property !== "bindingContext") {
                target.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        if (this.targetOptions) {
            this.targetOptions = undefined;
        }
        this.sourceProperties = undefined;
        if (!this.source) {
            return;
        }
        this.clearSource();
    };
    Binding.prototype.resolveObjectsAndProperties = function (source, properties) {
        var result = [];
        var currentObject = source;
        var currentObjectChanged = false;
        for (var i = 0, propsArrayLength = properties.length; i < propsArrayLength; i++) {
            var property = properties[i];
            if (property === bc.bindingValueKey) {
                currentObjectChanged = true;
            }
            if (property === bc.parentValueKey || property.indexOf(bc.parentsValueKey) === 0) {
                var parentView = this.getParentView(this.target.get(), property).view;
                if (parentView) {
                    currentObject = parentView.bindingContext;
                }
                else {
                    var targetInstance = this.target.get();
                    targetInstance.off("loaded", this.loadedHandlerVisualTreeBinding, this);
                    targetInstance.on("loaded", this.loadedHandlerVisualTreeBinding, this);
                }
                currentObjectChanged = true;
            }
            if (currentObject) {
                result.push({ instance: currentObject, property: property });
            }
            else {
                break;
            }
            if (!currentObjectChanged && (i < propsArrayLength - 1)) {
                currentObject = currentObject ? currentObject[properties[i]] : null;
            }
            currentObjectChanged = false;
        }
        return result;
    };
    Binding.prototype.addPropertyChangeListeners = function (source, sourceProperty, parentProperies) {
        var objectsAndProperties = this.resolveObjectsAndProperties(source.get(), sourceProperty);
        var prop = parentProperies || "";
        for (var i = 0, length_1 = objectsAndProperties.length; i < length_1; i++) {
            var propName = objectsAndProperties[i].property;
            prop += "$" + propName;
            var currentObject = objectsAndProperties[i].instance;
            if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable && currentObject._isViewBase) {
                weak_event_listener_1.addWeakEventListener(currentObject, propName + "Change", this.onSourcePropertyChanged, this);
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
            else if (!this.propertyChangeListeners.has(prop) && currentObject instanceof observable_1.Observable) {
                weak_event_listener_1.addWeakEventListener(currentObject, observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                this.propertyChangeListeners.set(prop, currentObject);
            }
        }
    };
    Binding.prototype.prepareExpressionForUpdate = function () {
        var escapedSourceProperty = utils_1.escapeRegexSymbols(this.options.sourceProperty);
        var expRegex = new RegExp(escapedSourceProperty, "g");
        var resultExp = this.options.expression.replace(expRegex, bc.newPropertyValueKey);
        return resultExp;
    };
    Binding.prototype.updateTwoWay = function (value) {
        if (this.updating || !this.options.twoWay) {
            return;
        }
        var newValue = value;
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = value;
            changedModel[bc.newPropertyValueKey] = value;
            var sourcePropertyName = "";
            if (this.sourceOptions) {
                sourcePropertyName = this.sourceOptions.property;
            }
            else if (typeof this.options.sourceProperty === "string" && this.options.sourceProperty.indexOf(".") === -1) {
                sourcePropertyName = this.options.sourceProperty;
            }
            if (sourcePropertyName !== "") {
                changedModel[sourcePropertyName] = value;
            }
            var updateExpression = this.prepareExpressionForUpdate();
            this.prepareContextForExpression(changedModel, updateExpression, undefined);
            var expressionValue = this._getExpressionValue(updateExpression, true, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            newValue = expressionValue;
        }
        this.updateSource(newValue);
    };
    Binding.prototype._getExpressionValue = function (expression, isBackConvert, changedModel) {
        try {
            var exp_1 = polymerExpressions.PolymerExpressions.getExpression(expression);
            if (exp_1) {
                var context_1 = this.source && this.source.get && this.source.get() || global;
                var model = {};
                var addedProps = [];
                var resources = applicationCommon.getResources();
                for (var prop in resources) {
                    if (resources.hasOwnProperty(prop) && !context_1.hasOwnProperty(prop)) {
                        context_1[prop] = resources[prop];
                        addedProps.push(prop);
                    }
                }
                this.prepareContextForExpression(context_1, expression, addedProps);
                model[contextKey] = context_1;
                var result = exp_1.getValue(model, isBackConvert, changedModel ? changedModel : model);
                var addedPropsLength = addedProps.length;
                for (var i = 0; i < addedPropsLength; i++) {
                    delete context_1[addedProps[i]];
                }
                addedProps.length = 0;
                return result;
            }
            return new Error(expression + " is not a valid expression.");
        }
        catch (e) {
            var errorMessage = "Run-time error occured in file: " + e.sourceURL + " at line: " + e.line + " and column: " + e.column;
            return new Error(errorMessage);
        }
    };
    Binding.prototype.onSourcePropertyChanged = function (data) {
        var sourceProps = this.sourceProperties;
        var sourcePropsLength = sourceProps.length;
        var changedPropertyIndex = sourceProps.indexOf(data.propertyName);
        var parentProps = "";
        if (changedPropertyIndex > -1) {
            parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            while (this.propertyChangeListeners.get(parentProps) !== data.object) {
                changedPropertyIndex += sourceProps.slice(changedPropertyIndex + 1).indexOf(data.propertyName) + 1;
                parentProps = "$" + sourceProps.slice(0, changedPropertyIndex + 1).join("$");
            }
        }
        if (this.options.expression) {
            var expressionValue = this._getExpressionValue(this.options.expression, false, undefined);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                this.updateTarget(expressionValue);
            }
        }
        else {
            if (changedPropertyIndex > -1) {
                var props = sourceProps.slice(changedPropertyIndex + 1);
                var propsLength = props.length;
                if (propsLength > 0) {
                    var value = data.value;
                    for (var i = 0; i < propsLength; i++) {
                        value = value[props[i]];
                    }
                    this.updateTarget(value);
                }
                else if (data.propertyName === this.sourceOptions.property) {
                    this.updateTarget(data.value);
                }
            }
        }
        if (changedPropertyIndex > -1 && changedPropertyIndex < sourcePropsLength - 1) {
            var probablyChangedObject = this.propertyChangeListeners.get(parentProps);
            if (probablyChangedObject &&
                probablyChangedObject !== data.object[sourceProps[changedPropertyIndex]]) {
                for (var i = sourcePropsLength - 1; i > changedPropertyIndex; i--) {
                    var prop = "$" + sourceProps.slice(0, i + 1).join("$");
                    if (this.propertyChangeListeners.has(prop)) {
                        weak_event_listener_1.removeWeakEventListener(this.propertyChangeListeners.get(prop), observable_1.Observable.propertyChangeEvent, this.onSourcePropertyChanged, this);
                        this.propertyChangeListeners.delete(prop);
                    }
                }
                var newProps = sourceProps.slice(changedPropertyIndex + 1);
                var newObject = data.object[sourceProps[changedPropertyIndex]];
                if (!types.isNullOrUndefined(newObject) && typeof newObject === "object") {
                    this.addPropertyChangeListeners(new WeakRef(newObject), newProps, parentProps);
                }
            }
        }
    };
    Binding.prototype.prepareContextForExpression = function (model, expression, newProps) {
        var parentViewAndIndex;
        var parentView;
        var addedProps = newProps || [];
        if (expression.indexOf(bc.bindingValueKey) > -1) {
            model[bc.bindingValueKey] = model;
            addedProps.push(bc.bindingValueKey);
        }
        if (expression.indexOf(bc.parentValueKey) > -1) {
            parentView = this.getParentView(this.target.get(), bc.parentValueKey).view;
            if (parentView) {
                model[bc.parentValueKey] = parentView.bindingContext;
                addedProps.push(bc.parentValueKey);
            }
        }
        var parentsArray = expression.match(binding_builder_1.parentsRegex);
        if (parentsArray) {
            for (var i = 0; i < parentsArray.length; i++) {
                parentViewAndIndex = this.getParentView(this.target.get(), parentsArray[i]);
                if (parentViewAndIndex.view) {
                    model[bc.parentsValueKey] = model[bc.parentsValueKey] || {};
                    model[bc.parentsValueKey][parentViewAndIndex.index] = parentViewAndIndex.view.bindingContext;
                    addedProps.push(bc.parentsValueKey);
                }
            }
        }
    };
    Binding.prototype.getSourcePropertyValue = function () {
        if (this.options.expression) {
            var changedModel = {};
            changedModel[bc.bindingValueKey] = this.source ? this.source.get() : undefined;
            var expressionValue = this._getExpressionValue(this.options.expression, false, changedModel);
            if (expressionValue instanceof Error) {
                trace_1.write(expressionValue.message, trace_1.categories.Binding, trace_1.messageType.error);
            }
            else {
                return expressionValue;
            }
        }
        if (this.sourceOptions) {
            var sourceOptionsInstance = this.sourceOptions.instance.get();
            if (this.sourceOptions.property === bc.bindingValueKey) {
                return sourceOptionsInstance;
            }
            else if ((sourceOptionsInstance instanceof observable_1.Observable) && (this.sourceOptions.property && this.sourceOptions.property !== "")) {
                return sourceOptionsInstance.get(this.sourceOptions.property);
            }
            else if (sourceOptionsInstance && this.sourceOptions.property && this.sourceOptions.property !== "" &&
                this.sourceOptions.property in sourceOptionsInstance) {
                return sourceOptionsInstance[this.sourceOptions.property];
            }
            else {
                trace_1.write("Property: '" + this.sourceOptions.property + "' is invalid or does not exist. SourceProperty: '" + this.options.sourceProperty + "'", trace_1.categories.Binding, trace_1.messageType.error);
            }
        }
        return null;
    };
    Binding.prototype.clearBinding = function () {
        this.clearSource();
        this.updateTarget(properties_1.unsetValue);
    };
    Binding.prototype.updateTarget = function (value) {
        if (this.updating) {
            return;
        }
        this.updateOptions(this.targetOptions, types.isNullOrUndefined(value) ? properties_1.unsetValue : value);
    };
    Binding.prototype.updateSource = function (value) {
        if (this.updating || !this.source || !this.source.get()) {
            return;
        }
        this.updateOptions(this.sourceOptions, value);
    };
    Binding.prototype.getParentView = function (target, property) {
        if (!target) {
            return { view: null, index: null };
        }
        var result;
        if (property === bc.parentValueKey) {
            result = target.parent;
        }
        var index = null;
        if (property.indexOf(bc.parentsValueKey) === 0) {
            result = target.parent;
            var indexParams = paramsRegex.exec(property);
            if (indexParams && indexParams.length > 1) {
                index = indexParams[2];
            }
            if (!isNaN(index)) {
                var indexAsInt = parseInt(index);
                while (indexAsInt > 0) {
                    result = result.parent;
                    indexAsInt--;
                }
            }
            else if (types.isString(index)) {
                while (result && result.typeName !== index) {
                    result = result.parent;
                }
            }
        }
        return { view: result, index: index };
    };
    Binding.prototype.resolveOptions = function (obj, properties) {
        var objectsAndProperties = this.resolveObjectsAndProperties(obj, properties);
        if (objectsAndProperties.length > 0) {
            var resolvedObj = objectsAndProperties[objectsAndProperties.length - 1].instance;
            var prop = objectsAndProperties[objectsAndProperties.length - 1].property;
            return {
                instance: new WeakRef(this.sourceAsObject(resolvedObj)),
                property: prop
            };
        }
        return null;
    };
    Binding.prototype.updateOptions = function (options, value) {
        var optionsInstance;
        if (options && options.instance) {
            optionsInstance = options.instance.get();
        }
        if (!optionsInstance) {
            return;
        }
        this.updating = true;
        try {
            if (isEventOrGesture(options.property, optionsInstance) &&
                types.isFunction(value)) {
                optionsInstance.off(options.property, null, optionsInstance.bindingContext);
                optionsInstance.on(options.property, value, optionsInstance.bindingContext);
            }
            else if (optionsInstance instanceof observable_1.Observable) {
                optionsInstance.set(options.property, value);
            }
            else {
                optionsInstance[options.property] = value;
            }
        }
        catch (ex) {
            trace_1.write("Binding error while setting property " + options.property + " of " + optionsInstance + ": " + ex, trace_1.categories.Binding, trace_1.messageType.error);
        }
        this.updating = false;
    };
    return Binding;
}());
exports.Binding = Binding;
//# sourceMappingURL=bindable.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/control-state-change/control-state-change.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var ObserverClass = (function (_super) {
    __extends(ObserverClass, _super);
    function ObserverClass() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ObserverClass.prototype.observeValueForKeyPathOfObjectChangeContext = function (path) {
        if (path === "selected") {
            this["_owner"]._onSelectedChanged();
        }
        else if (path === "enabled") {
            this["_owner"]._onEnabledChanged();
        }
        else if (path === "highlighted") {
            this["_owner"]._onHighlightedChanged();
        }
    };
    return ObserverClass;
}(NSObject));
var ControlStateChangeListener = (function () {
    function ControlStateChangeListener(control, callback) {
        this._observing = false;
        this._observer = ObserverClass.alloc();
        this._observer["_owner"] = this;
        this._control = control;
        this._callback = callback;
    }
    ControlStateChangeListener.prototype.start = function () {
        if (!this._observing) {
            this._control.addObserverForKeyPathOptionsContext(this._observer, "highlighted", 1, null);
            this._observing = true;
            this._updateState();
        }
    };
    ControlStateChangeListener.prototype.stop = function () {
        if (this._observing) {
            this._observing = false;
            this._control.removeObserverForKeyPath(this._observer, "highlighted");
        }
    };
    ControlStateChangeListener.prototype._onEnabledChanged = function () {
        this._updateState();
    };
    ControlStateChangeListener.prototype._onSelectedChanged = function () {
        this._updateState();
    };
    ControlStateChangeListener.prototype._onHighlightedChanged = function () {
        this._updateState();
    };
    ControlStateChangeListener.prototype._updateState = function () {
        var state = "normal";
        if (this._control.highlighted) {
            state = "highlighted";
        }
        this._callback(state);
    };
    return ControlStateChangeListener;
}());
exports.ControlStateChangeListener = ControlStateChangeListener;
//# sourceMappingURL=control-state-change.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/properties/properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var style_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style/style.js");
exports.Style = style_1.Style;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
exports.unsetValue = new Object();
var cssPropertyNames = [];
var symbolPropertyMap = {};
var cssSymbolPropertyMap = {};
var inheritableProperties = new Array();
var inheritableCssProperties = new Array();
function print(map) {
    var symbols = Object.getOwnPropertySymbols(map);
    for (var _i = 0, symbols_1 = symbols; _i < symbols_1.length; _i++) {
        var symbol = symbols_1[_i];
        var prop = map[symbol];
        if (!prop.registered) {
            console.log("Property " + prop.name + " not Registered!!!!!");
        }
    }
}
function _printUnregisteredProperties() {
    print(symbolPropertyMap);
    print(cssSymbolPropertyMap);
}
exports._printUnregisteredProperties = _printUnregisteredProperties;
function _getProperties() {
    return getPropertiesFromMap(symbolPropertyMap);
}
exports._getProperties = _getProperties;
function _getStyleProperties() {
    return getPropertiesFromMap(cssSymbolPropertyMap);
}
exports._getStyleProperties = _getStyleProperties;
function getPropertiesFromMap(map) {
    var props = [];
    Object.getOwnPropertySymbols(map).forEach(function (symbol) { return props.push(map[symbol]); });
    return props;
}
var Property = (function () {
    function Property(options) {
        this.enumerable = true;
        this.configurable = true;
        var propertyName = options.name;
        this.name = propertyName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var equalityComparer = options.equalityComparer;
        var affectsLayout = options.affectsLayout;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        this.get = function () {
            return key in this ? this[key] : defaultValue;
        };
        this.nativeValueChange = function (owner, value) {
            var oldValue = key in owner ? owner[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                owner[key] = value;
                if (valueChanged) {
                    valueChanged(owner, oldValue, value);
                }
                if (owner.nativeViewProtected && !(defaultValueKey in owner)) {
                    owner[defaultValueKey] = owner[getDefault] ? owner[getDefault]() : defaultValue;
                }
                if (owner.hasListeners(eventName)) {
                    owner.notify({ object: owner, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    owner.requestLayout();
                }
                if (owner.domNode) {
                    owner.domNode.attributeModified(propertyName, value);
                }
            }
        };
        symbolPropertyMap[key] = this;
    }
    Property.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this);
    };
    Property.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return Property;
}());
exports.Property = Property;
Property.prototype.isStyleProperty = false;
var CoercibleProperty = (function (_super) {
    __extends(CoercibleProperty, _super);
    function CoercibleProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var defaultValue = _this.defaultValue;
        var coerceKey = Symbol(propertyName + ":coerceKey");
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var coerceCallback = options.coerceValue;
        var property = _this;
        _this.coerce = function (target) {
            var originalValue = coerceKey in target ? target[coerceKey] : defaultValue;
            target[propertyName] = originalValue;
        };
        _this.set = function (boxedValue) {
            var reset = boxedValue === exports.unsetValue;
            var value;
            var wrapped;
            if (reset) {
                value = defaultValue;
                delete this[coerceKey];
            }
            else {
                wrapped = boxedValue && boxedValue.wrapped;
                value = wrapped ? observable_1.WrappedValue.unwrap(boxedValue) : boxedValue;
                if (valueConverter && typeof value === "string") {
                    value = valueConverter(value);
                }
                this[coerceKey] = value;
                value = coerceCallback(this, value);
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (wrapped || changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                this[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                this[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (this[setNative]) {
                        if (this._suspendNativeUpdatesCount) {
                            if (this._suspendedUpdates) {
                                this._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = this[getDefault] ? this[getDefault]() : defaultValue;
                            }
                            this[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    this.requestLayout();
                }
                if (this.domNode) {
                    if (reset) {
                        this.domNode.attributeRemoved(propertyName);
                    }
                    else {
                        this.domNode.attributeModified(propertyName, value);
                    }
                }
            }
        };
        return _this;
    }
    return CoercibleProperty;
}(Property));
exports.CoercibleProperty = CoercibleProperty;
var InheritedProperty = (function (_super) {
    __extends(InheritedProperty, _super);
    function InheritedProperty(options) {
        var _this = _super.call(this, options) || this;
        var name = options.name;
        var key = _this.key;
        var defaultValue = options.defaultValue;
        var sourceKey = Symbol(name + ":valueSourceKey");
        _this.sourceKey = sourceKey;
        var setBase = _this.set;
        var setFunc = function (valueSource) { return function (value) {
            var that = this;
            var unboxedValue;
            var newValueSource;
            if (value === exports.unsetValue) {
                var parent_1 = that.parent;
                if (parent_1 && parent_1[sourceKey] !== 0) {
                    unboxedValue = parent_1[name];
                    newValueSource = 1;
                }
                else {
                    unboxedValue = defaultValue;
                    newValueSource = 0;
                }
            }
            else {
                unboxedValue = value;
                newValueSource = valueSource;
            }
            var currentValue = that[key];
            setBase.call(that, unboxedValue);
            var newValue = that[key];
            that[sourceKey] = newValueSource;
            if (currentValue !== newValue) {
                var reset_1 = newValueSource === 0;
                that.eachChild(function (child) {
                    var childValueSource = child[sourceKey] || 0;
                    if (reset_1) {
                        if (childValueSource === 1) {
                            setFunc.call(child, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedValue.call(child, newValue);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setInheritedValue = setFunc(1);
        _this.setInheritedValue = setInheritedValue;
        _this.set = setFunc(3);
        inheritableProperties.push(_this);
        return _this;
    }
    return InheritedProperty;
}(Property));
exports.InheritedProperty = InheritedProperty;
var CssProperty = (function () {
    function CssProperty(options) {
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = options.cssName;
        var key = Symbol(propertyName + ":propertyKey");
        this.key = key;
        var sourceKey = Symbol(propertyName + ":valueSourceKey");
        this.sourceKey = sourceKey;
        var getDefault = Symbol(propertyName + ":getDefault");
        this.getDefault = getDefault;
        var setNative = Symbol(propertyName + ":setNative");
        this.setNative = setNative;
        var defaultValueKey = Symbol(propertyName + ":nativeDefaultValue");
        this.defaultValueKey = defaultValueKey;
        var defaultValue = options.defaultValue;
        this.defaultValue = defaultValue;
        var eventName = propertyName + "Change";
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = this;
        function setLocalValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                this[sourceKey] = 3;
                value = (valueConverter && typeof newValue === "string") ?
                    valueConverter(newValue) :
                    newValue;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function setCssValue(newValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(newValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var currentValueSource = this[sourceKey] || 0;
            if (currentValueSource === 3) {
                return;
            }
            var reset = newValue === exports.unsetValue || newValue === "";
            var value;
            if (reset) {
                value = defaultValue;
                delete this[sourceKey];
            }
            else {
                value = valueConverter && typeof newValue === "string" ?
                    valueConverter(newValue) :
                    newValue;
                this[sourceKey] = 2;
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (reset) {
                    delete this[key];
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                    }
                }
                else {
                    this[key] = value;
                    if (valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative]) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
            }
        }
        function get() {
            return key in this ? this[key] : defaultValue;
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: get,
            set: setLocalValue
        };
        cssSymbolPropertyMap[key] = this;
    }
    CssProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
    };
    CssProperty.prototype.isSet = function (instance) {
        return this.key in instance;
    };
    return CssProperty;
}());
exports.CssProperty = CssProperty;
CssProperty.prototype.isStyleProperty = true;
var CssAnimationProperty = (function () {
    function CssAnimationProperty(options) {
        var valueConverter = options.valueConverter, equalityComparer = options.equalityComparer, valueChanged = options.valueChanged, defaultValue = options.defaultValue;
        var propertyName = options.name;
        this.name = propertyName;
        cssPropertyNames.push(options.cssName);
        CssAnimationProperty.properties[propertyName] = this;
        if (options.cssName && options.cssName !== propertyName) {
            CssAnimationProperty.properties[options.cssName] = this;
        }
        this._valueConverter = options.valueConverter;
        var cssLocalName = (options.cssName || propertyName);
        this.cssLocalName = cssLocalName;
        var cssName = "css:" + cssLocalName;
        this.cssName = cssName;
        var keyframeName = "keyframe:" + propertyName;
        this.keyframe = keyframeName;
        var defaultName = "default:" + propertyName;
        var defaultValueKey = Symbol(defaultName);
        this.defaultValueKey = defaultValueKey;
        this.defaultValue = defaultValue;
        var cssValue = Symbol(cssName);
        var styleValue = Symbol("local:" + propertyName);
        var keyframeValue = Symbol(keyframeName);
        var computedValue = Symbol("computed-value:" + propertyName);
        this.key = computedValue;
        var computedSource = Symbol("computed-source:" + propertyName);
        this.source = computedSource;
        this.getDefault = Symbol(propertyName + ":getDefault");
        var getDefault = this.getDefault;
        var setNative = this.setNative = Symbol(propertyName + ":setNative");
        var eventName = propertyName + "Change";
        var property = this;
        function descriptor(symbol, propertySource, enumerable, configurable, getsComputed) {
            return {
                enumerable: enumerable, configurable: configurable,
                get: getsComputed ? function () { return this[computedValue]; } : function () { return this[symbol]; },
                set: function (boxedValue) {
                    var view = this.viewRef.get();
                    if (!view) {
                        trace_1.write(boxedValue + " not set to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                        return;
                    }
                    var oldValue = this[computedValue];
                    var oldSource = this[computedSource];
                    var wasSet = oldSource !== 0;
                    var reset = boxedValue === exports.unsetValue || boxedValue === "";
                    if (reset) {
                        this[symbol] = exports.unsetValue;
                        if (this[computedSource] === propertySource) {
                            if (this[styleValue] !== exports.unsetValue) {
                                this[computedSource] = 3;
                                this[computedValue] = this[styleValue];
                            }
                            else if (this[cssValue] !== exports.unsetValue) {
                                this[computedSource] = 2;
                                this[computedValue] = this[cssValue];
                            }
                            else {
                                delete this[computedSource];
                                delete this[computedValue];
                            }
                        }
                    }
                    else {
                        if (valueConverter && typeof boxedValue === "string") {
                            boxedValue = valueConverter(boxedValue);
                        }
                        this[symbol] = boxedValue;
                        if (this[computedSource] <= propertySource) {
                            this[computedSource] = propertySource;
                            this[computedValue] = boxedValue;
                        }
                    }
                    var value = this[computedValue];
                    var source = this[computedSource];
                    var isSet = source !== 0;
                    var computedValueChanged = oldValue !== value && (!equalityComparer || !equalityComparer(oldValue, value));
                    if (computedValueChanged && valueChanged) {
                        valueChanged(this, oldValue, value);
                    }
                    if (view[setNative] && (computedValueChanged || isSet !== wasSet)) {
                        if (view._suspendNativeUpdatesCount) {
                            if (view._suspendedUpdates) {
                                view._suspendedUpdates[propertyName] = property;
                            }
                        }
                        else {
                            if (isSet) {
                                if (!wasSet && !(defaultValueKey in this)) {
                                    this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                                }
                                view[setNative](value);
                            }
                            else if (wasSet) {
                                if (defaultValueKey in this) {
                                    view[setNative](this[defaultValueKey]);
                                }
                                else {
                                    view[setNative](defaultValue);
                                }
                            }
                        }
                    }
                    if (computedValueChanged && this.hasListeners(eventName)) {
                        this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                    }
                }
            };
        }
        var defaultPropertyDescriptor = descriptor(defaultValueKey, 0, false, false, false);
        var cssPropertyDescriptor = descriptor(cssValue, 2, false, false, false);
        var stylePropertyDescriptor = descriptor(styleValue, 3, true, true, true);
        var keyframePropertyDescriptor = descriptor(keyframeValue, 4, false, false, false);
        symbolPropertyMap[computedValue] = this;
        cssSymbolPropertyMap[computedValue] = this;
        this.register = function (cls) {
            cls.prototype[computedValue] = options.defaultValue;
            cls.prototype[computedSource] = 0;
            cls.prototype[cssValue] = exports.unsetValue;
            cls.prototype[styleValue] = exports.unsetValue;
            cls.prototype[keyframeValue] = exports.unsetValue;
            Object.defineProperty(cls.prototype, defaultName, defaultPropertyDescriptor);
            Object.defineProperty(cls.prototype, cssName, cssPropertyDescriptor);
            Object.defineProperty(cls.prototype, propertyName, stylePropertyDescriptor);
            if (options.cssName && options.cssName !== options.name) {
                Object.defineProperty(cls.prototype, options.cssName, stylePropertyDescriptor);
            }
            Object.defineProperty(cls.prototype, keyframeName, keyframePropertyDescriptor);
        };
    }
    CssAnimationProperty.prototype._initDefaultNativeValue = function (target) {
        var view = target.viewRef.get();
        if (!view) {
            trace_1.write("_initDefaultNativeValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return;
        }
        var defaultValueKey = this.defaultValueKey;
        if (!(defaultValueKey in target)) {
            var getDefault = this.getDefault;
            target[defaultValueKey] = view[getDefault] ? view[getDefault]() : this.defaultValue;
        }
    };
    CssAnimationProperty._getByCssName = function (name) {
        return this.properties[name];
    };
    CssAnimationProperty._getPropertyNames = function () {
        return Object.keys(CssAnimationProperty.properties);
    };
    CssAnimationProperty.prototype.isSet = function (instance) {
        return instance[this.source] !== 0;
    };
    CssAnimationProperty.properties = {};
    return CssAnimationProperty;
}());
exports.CssAnimationProperty = CssAnimationProperty;
CssAnimationProperty.prototype.isStyleProperty = true;
var InheritedCssProperty = (function (_super) {
    __extends(InheritedCssProperty, _super);
    function InheritedCssProperty(options) {
        var _this = _super.call(this, options) || this;
        var propertyName = options.name;
        var key = _this.key;
        var sourceKey = _this.sourceKey;
        var getDefault = _this.getDefault;
        var setNative = _this.setNative;
        var defaultValueKey = _this.defaultValueKey;
        var eventName = propertyName + "Change";
        var defaultValue = options.defaultValue;
        var affectsLayout = options.affectsLayout;
        var equalityComparer = options.equalityComparer;
        var valueChanged = options.valueChanged;
        var valueConverter = options.valueConverter;
        var property = _this;
        var setFunc = function (valueSource) { return function (boxedValue) {
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write(boxedValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
                return;
            }
            var reset = boxedValue === exports.unsetValue || boxedValue === "";
            var currentValueSource = this[sourceKey] || 0;
            if (reset) {
                if (valueSource === 2 && currentValueSource === 3) {
                    return;
                }
            }
            else {
                if (currentValueSource > valueSource) {
                    return;
                }
            }
            var oldValue = key in this ? this[key] : defaultValue;
            var value;
            var unsetNativeValue = false;
            if (reset) {
                var parent_2 = view.parent;
                var style = parent_2 ? parent_2.style : null;
                if (style && style[sourceKey] > 0) {
                    value = style[propertyName];
                    this[sourceKey] = 1;
                    this[key] = value;
                }
                else {
                    value = defaultValue;
                    delete this[sourceKey];
                    delete this[key];
                    unsetNativeValue = true;
                }
            }
            else {
                this[sourceKey] = valueSource;
                if (valueConverter && typeof boxedValue === "string") {
                    value = valueConverter(boxedValue);
                }
                else {
                    value = boxedValue;
                }
                this[key] = value;
            }
            var changed = equalityComparer ? !equalityComparer(oldValue, value) : oldValue !== value;
            if (changed) {
                if (valueChanged) {
                    valueChanged(this, oldValue, value);
                }
                if (view[setNative]) {
                    if (view._suspendNativeUpdatesCount) {
                        if (view._suspendedUpdates) {
                            view._suspendedUpdates[propertyName] = property;
                        }
                    }
                    else {
                        if (unsetNativeValue) {
                            if (defaultValueKey in this) {
                                view[setNative](this[defaultValueKey]);
                                delete this[defaultValueKey];
                            }
                            else {
                                view[setNative](defaultValue);
                            }
                        }
                        else {
                            if (!(defaultValueKey in this)) {
                                this[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                            }
                            view[setNative](value);
                        }
                    }
                }
                if (this.hasListeners(eventName)) {
                    this.notify({ object: this, eventName: eventName, propertyName: propertyName, value: value, oldValue: oldValue });
                }
                if (affectsLayout) {
                    view.requestLayout();
                }
                view.eachChild(function (child) {
                    var childStyle = child.style;
                    var childValueSource = childStyle[sourceKey] || 0;
                    if (reset) {
                        if (childValueSource === 1) {
                            setDefaultFunc.call(childStyle, exports.unsetValue);
                        }
                    }
                    else {
                        if (childValueSource <= 1) {
                            setInheritedFunc.call(childStyle, value);
                        }
                    }
                    return true;
                });
            }
        }; };
        var setDefaultFunc = setFunc(0);
        var setInheritedFunc = setFunc(1);
        _this.setInheritedValue = setInheritedFunc;
        _this.cssValueDescriptor.set = setFunc(2);
        _this.localValueDescriptor.set = setFunc(3);
        inheritableCssProperties.push(_this);
        return _this;
    }
    return InheritedCssProperty;
}(CssProperty));
exports.InheritedCssProperty = InheritedCssProperty;
var ShorthandProperty = (function () {
    function ShorthandProperty(options) {
        this.name = options.name;
        var key = Symbol(this.name + ":propertyKey");
        this.key = key;
        this.cssName = "css:" + options.cssName;
        this.cssLocalName = "" + options.cssName;
        var converter = options.converter;
        function setLocalValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setLocalValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.name] = v;
                }
            });
        }
        function setCssValue(value) {
            var _this = this;
            var view = this.viewRef.get();
            if (!view) {
                trace_1.write("setCssValue not executed to view because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            view._batchUpdate(function () {
                for (var _i = 0, _a = converter(value); _i < _a.length; _i++) {
                    var _b = _a[_i], p = _b[0], v = _b[1];
                    _this[p.cssName] = v;
                }
            });
        }
        this.cssValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setCssValue
        };
        this.localValueDescriptor = {
            enumerable: true,
            configurable: true,
            get: options.getter,
            set: setLocalValue
        };
        this.propertyBagDescriptor = {
            enumerable: false,
            configurable: true,
            set: function (value) {
                var _this = this;
                converter(value).forEach(function (_a) {
                    var property = _a[0], value = _a[1];
                    _this[property.cssLocalName] = value;
                });
            }
        };
        cssSymbolPropertyMap[key] = this;
    }
    ShorthandProperty.prototype.register = function (cls) {
        if (this.registered) {
            throw new Error("Property " + this.name + " already registered.");
        }
        this.registered = true;
        Object.defineProperty(cls.prototype, this.name, this.localValueDescriptor);
        Object.defineProperty(cls.prototype, this.cssName, this.cssValueDescriptor);
        if (this.cssLocalName !== this.cssName) {
            Object.defineProperty(cls.prototype, this.cssLocalName, this.localValueDescriptor);
        }
        Object.defineProperty(cls.prototype.PropertyBag, this.cssLocalName, this.propertyBagDescriptor);
    };
    return ShorthandProperty;
}());
exports.ShorthandProperty = ShorthandProperty;
function inheritablePropertyValuesOn(view) {
    var array = new Array();
    for (var _i = 0, inheritableProperties_1 = inheritableProperties; _i < inheritableProperties_1.length; _i++) {
        var prop = inheritableProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = view[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: view[prop.name] });
        }
    }
    return array;
}
function inheritableCssPropertyValuesOn(style) {
    var array = new Array();
    for (var _i = 0, inheritableCssProperties_1 = inheritableCssProperties; _i < inheritableCssProperties_1.length; _i++) {
        var prop = inheritableCssProperties_1[_i];
        var sourceKey = prop.sourceKey;
        var valueSource = style[sourceKey] || 0;
        if (valueSource !== 0) {
            array.push({ property: prop, value: style[prop.name] });
        }
    }
    return array;
}
exports.initNativeView = profiling_1.profile("\"properties\".initNativeView", function initNativeView(view) {
    if (view._suspendedUpdates) {
        applyPendingNativeSetters(view);
    }
    else {
        applyAllNativeSetters(view);
    }
    view._suspendedUpdates = {};
});
function applyPendingNativeSetters(view) {
    var suspendedUpdates = view._suspendedUpdates;
    for (var propertyName in suspendedUpdates) {
        var property = suspendedUpdates[propertyName];
        var setNative = property.setNative;
        if (view[setNative]) {
            var getDefault = property.getDefault, isStyleProperty = property.isStyleProperty, defaultValueKey = property.defaultValueKey, defaultValue = property.defaultValue;
            var value = void 0;
            if (isStyleProperty) {
                var style = view.style;
                if (property.isSet(view.style)) {
                    if (!(defaultValueKey in style)) {
                        style[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view.style[propertyName];
                }
                else {
                    value = style[defaultValueKey];
                }
            }
            else {
                if (property.isSet(view)) {
                    if (!(defaultValueKey in view)) {
                        view[defaultValueKey] = view[getDefault] ? view[getDefault]() : defaultValue;
                    }
                    value = view[propertyName];
                }
                else {
                    value = view[defaultValueKey];
                }
            }
            view[setNative](value);
        }
    }
}
exports.applyPendingNativeSetters = applyPendingNativeSetters;
function applyAllNativeSetters(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_2 = symbols; _i < symbols_2.length; _i++) {
        var symbol = symbols_2[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var setNative = property.setNative;
        var getDefault = property.getDefault;
        if (setNative in view) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in view)) {
                view[defaultValueKey] = view[getDefault] ? view[getDefault]() : property.defaultValue;
            }
            var value = view[symbol];
            view[setNative](value);
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_3 = symbols; _a < symbols_3.length; _a++) {
        var symbol = symbols_3[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            var defaultValueKey = property.defaultValueKey;
            if (!(defaultValueKey in style)) {
                style[defaultValueKey] = view[property.getDefault] ? view[property.getDefault]() : property.defaultValue;
            }
            var value = style[symbol];
            view[property.setNative](value);
        }
    }
}
exports.applyAllNativeSetters = applyAllNativeSetters;
function resetNativeView(view) {
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_4 = symbols; _i < symbols_4.length; _i++) {
        var symbol = symbols_4[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in view) {
                view[property.setNative](view[property.defaultValueKey]);
                delete view[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
    var style = view.style;
    symbols = Object.getOwnPropertySymbols(style);
    for (var _a = 0, symbols_5 = symbols; _a < symbols_5.length; _a++) {
        var symbol = symbols_5[_a];
        var property = cssSymbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        if (view[property.setNative]) {
            if (property.defaultValueKey in style) {
                view[property.setNative](style[property.defaultValueKey]);
                delete style[property.defaultValueKey];
            }
            else {
                view[property.setNative](property.defaultValue);
            }
        }
    }
}
exports.resetNativeView = resetNativeView;
function clearInheritedProperties(view) {
    for (var _i = 0, inheritableProperties_2 = inheritableProperties; _i < inheritableProperties_2.length; _i++) {
        var prop = inheritableProperties_2[_i];
        var sourceKey = prop.sourceKey;
        if (view[sourceKey] === 1) {
            prop.set.call(view, exports.unsetValue);
        }
    }
    var style = view.style;
    for (var _a = 0, inheritableCssProperties_2 = inheritableCssProperties; _a < inheritableCssProperties_2.length; _a++) {
        var prop = inheritableCssProperties_2[_a];
        var sourceKey = prop.sourceKey;
        if (style[sourceKey] === 1) {
            prop.setInheritedValue.call(style, exports.unsetValue);
        }
    }
}
exports.clearInheritedProperties = clearInheritedProperties;
function resetCSSProperties(style) {
    var symbols = Object.getOwnPropertySymbols(style);
    for (var _i = 0, symbols_6 = symbols; _i < symbols_6.length; _i++) {
        var symbol = symbols_6[_i];
        var cssProperty = void 0;
        if (cssProperty = cssSymbolPropertyMap[symbol]) {
            style[cssProperty.cssName] = exports.unsetValue;
            if (cssProperty instanceof CssAnimationProperty) {
                style[cssProperty.keyframe] = exports.unsetValue;
            }
        }
    }
}
exports.resetCSSProperties = resetCSSProperties;
function propagateInheritableProperties(view, child) {
    var inheritablePropertyValues = inheritablePropertyValuesOn(view);
    for (var _i = 0, inheritablePropertyValues_1 = inheritablePropertyValues; _i < inheritablePropertyValues_1.length; _i++) {
        var pair = inheritablePropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = child[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(child, pair.value);
        }
    }
}
exports.propagateInheritableProperties = propagateInheritableProperties;
function propagateInheritableCssProperties(parentStyle, childStyle) {
    var inheritableCssPropertyValues = inheritableCssPropertyValuesOn(parentStyle);
    for (var _i = 0, inheritableCssPropertyValues_1 = inheritableCssPropertyValues; _i < inheritableCssPropertyValues_1.length; _i++) {
        var pair = inheritableCssPropertyValues_1[_i];
        var prop = pair.property;
        var sourceKey = prop.sourceKey;
        var currentValueSource = childStyle[sourceKey] || 0;
        if (currentValueSource <= 1) {
            prop.setInheritedValue.call(childStyle, pair.value, 1);
        }
    }
}
exports.propagateInheritableCssProperties = propagateInheritableCssProperties;
function makeValidator() {
    var values = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        values[_i] = arguments[_i];
    }
    var set = new Set(values);
    return function (value) { return set.has(value); };
}
exports.makeValidator = makeValidator;
function makeParser(isValid) {
    return function (value) {
        var lower = value && value.toLowerCase();
        if (isValid(lower)) {
            return lower;
        }
        else {
            throw new Error("Invalid value: " + value);
        }
    };
}
exports.makeParser = makeParser;
function getSetProperties(view) {
    var result = [];
    Object.getOwnPropertyNames(view).forEach(function (prop) {
        result.push([prop, view[prop]]);
    });
    var symbols = Object.getOwnPropertySymbols(view);
    for (var _i = 0, symbols_7 = symbols; _i < symbols_7.length; _i++) {
        var symbol = symbols_7[_i];
        var property = symbolPropertyMap[symbol];
        if (!property) {
            continue;
        }
        var value = view[property.key];
        result.push([property.name, value]);
    }
    return result;
}
exports.getSetProperties = getSetProperties;
function getComputedCssValues(view) {
    var result = [];
    var style = view.style;
    for (var _i = 0, cssPropertyNames_1 = cssPropertyNames; _i < cssPropertyNames_1.length; _i++) {
        var prop = cssPropertyNames_1[_i];
        result.push([prop, style[prop]]);
    }
    result.push(["top", "auto"]);
    result.push(["left", "auto"]);
    result.push(["bottom", "auto"]);
    result.push(["right", "auto"]);
    return result;
}
exports.getComputedCssValues = getComputedCssValues;
//# sourceMappingURL=properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view-base/view-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var debug_1 = __webpack_require__("../node_modules/tns-core-modules/utils/debug.js");
var bindable_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.isIOS = platform_1.isIOS;
exports.isAndroid = platform_1.isAndroid;
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
exports.layout = utils_1.layout;
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
exports.Color = color_1.Color;
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/bindable/bindable.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js"));
var ssm = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var domNodeModule;
function ensuredomNodeModule() {
    if (!domNodeModule) {
        domNodeModule = __webpack_require__("../node_modules/tns-core-modules/debugger/dom-node.js");
    }
}
var styleScopeModule;
function ensureStyleScopeModule() {
    if (!styleScopeModule) {
        styleScopeModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
    }
}
var defaultBindingSource = {};
function getAncestor(view, criterion) {
    var matcher = null;
    if (typeof criterion === "string") {
        matcher = function (view) { return view.typeName === criterion; };
    }
    else {
        matcher = function (view) { return view instanceof criterion; };
    }
    for (var parent_1 = view.parent; parent_1 != null; parent_1 = parent_1.parent) {
        if (matcher(parent_1)) {
            return parent_1;
        }
    }
    return null;
}
exports.getAncestor = getAncestor;
function getViewById(view, id) {
    if (!view) {
        return undefined;
    }
    if (view.id === id) {
        return view;
    }
    var retVal;
    var descendantsCallback = function (child) {
        if (child.id === id) {
            retVal = child;
            return false;
        }
        return true;
    };
    eachDescendant(view, descendantsCallback);
    return retVal;
}
exports.getViewById = getViewById;
function eachDescendant(view, callback) {
    if (!callback || !view) {
        return;
    }
    var continueIteration;
    var localCallback = function (child) {
        continueIteration = callback(child);
        if (continueIteration) {
            child.eachChild(localCallback);
        }
        return continueIteration;
    };
    view.eachChild(localCallback);
}
exports.eachDescendant = eachDescendant;
var viewIdCounter = 1;
var Flags;
(function (Flags) {
    Flags["superOnLoadedCalled"] = "Loaded";
    Flags["superOnUnloadedCalled"] = "Unloaded";
})(Flags || (Flags = {}));
var SuspendType;
(function (SuspendType) {
    SuspendType[SuspendType["Incremental"] = 0] = "Incremental";
    SuspendType[SuspendType["Loaded"] = 1048576] = "Loaded";
    SuspendType[SuspendType["NativeView"] = 2097152] = "NativeView";
    SuspendType[SuspendType["UISetup"] = 4194304] = "UISetup";
    SuspendType[SuspendType["IncrementalCountMask"] = -7340033] = "IncrementalCountMask";
})(SuspendType || (SuspendType = {}));
(function (SuspendType) {
    function toString(type) {
        return (type ? "suspended" : "resumed") + "(" +
            "Incremental: " + (type & SuspendType.IncrementalCountMask) + ", " +
            "Loaded: " + !(type & SuspendType.Loaded) + ", " +
            "NativeView: " + !(type & SuspendType.NativeView) + ", " +
            "UISetup: " + !(type & SuspendType.UISetup) +
            ")";
    }
    SuspendType.toString = toString;
})(SuspendType || (SuspendType = {}));
var ViewBase = (function (_super) {
    __extends(ViewBase, _super);
    function ViewBase() {
        var _this = _super.call(this) || this;
        _this._onLoadedCalled = false;
        _this._onUnloadedCalled = false;
        _this._cssState = new ssm.CssState(new WeakRef(_this));
        _this.pseudoClassAliases = {
            "highlighted": [
                "active",
                "pressed"
            ]
        };
        _this.cssClasses = new Set();
        _this.cssPseudoClasses = new Set();
        _this._domId = viewIdCounter++;
        _this._style = new properties_1.Style(new WeakRef(_this));
        return _this;
    }
    Object.defineProperty(ViewBase.prototype, "parentNode", {
        get: function () {
            return this._templateParent || this.parent;
        },
        set: function (node) {
            this._templateParent = node;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "nativeView", {
        get: function () {
            return this.nativeViewProtected;
        },
        set: function (value) {
            this.setNativeView(value);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "typeName", {
        get: function () {
            return types.getClass(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "style", {
        get: function () {
            return this._style;
        },
        set: function (inlineStyle) {
            if (typeof inlineStyle === "string") {
                this.setInlineStyle(inlineStyle);
            }
            else {
                throw new Error("View.style property is read-only.");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "android", {
        get: function () {
            return this._androidView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "ios", {
        get: function () {
            return this._iosView;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "isLoaded", {
        get: function () {
            return this._isLoaded;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewBase.prototype, "class", {
        get: function () {
            return this.className;
        },
        set: function (v) {
            this.className = v;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.getViewById = function (id) {
        return getViewById(this, id);
    };
    Object.defineProperty(ViewBase.prototype, "page", {
        get: function () {
            if (this.parent) {
                return this.parent.page;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    ViewBase.prototype.ensureDomNode = function () {
        if (!this.domNode) {
            ensuredomNodeModule();
            this.domNode = new domNodeModule.DOMNode(this);
        }
    };
    ViewBase.prototype.set = function (name, value) {
        this[name] = bindable_1.WrappedValue.unwrap(value);
    };
    ViewBase.prototype.onLoaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnLoadedCalled, true);
        if (this._isLoaded) {
            return;
        }
        this._isLoaded = true;
        this._cssState.onLoaded();
        this._resumeNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.loadView(child);
            return true;
        });
        this._emit("loaded");
    };
    ViewBase.prototype.onUnloaded = function () {
        var _this = this;
        this.setFlag(Flags.superOnUnloadedCalled, true);
        if (!this._isLoaded) {
            return;
        }
        this._suspendNativeUpdates(SuspendType.Loaded);
        this.eachChild(function (child) {
            _this.unloadView(child);
            return true;
        });
        this._isLoaded = false;
        this._cssState.onUnloaded();
        this._emit("unloaded");
    };
    ViewBase.prototype._suspendNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount | type;
        }
        else {
            this._suspendNativeUpdatesCount++;
        }
    };
    ViewBase.prototype._resumeNativeUpdates = function (type) {
        if (type) {
            this._suspendNativeUpdatesCount = this._suspendNativeUpdatesCount & ~type;
        }
        else {
            if ((this._suspendNativeUpdatesCount & SuspendType.IncrementalCountMask) === 0) {
                throw new Error("Invalid call to " + this + "._resumeNativeUpdates");
            }
            this._suspendNativeUpdatesCount--;
        }
        if (!this._suspendNativeUpdatesCount) {
            this.onResumeNativeUpdates();
        }
    };
    ViewBase.prototype._batchUpdate = function (callback) {
        try {
            this._suspendNativeUpdates(SuspendType.Incremental);
            return callback();
        }
        finally {
            this._resumeNativeUpdates(SuspendType.Incremental);
        }
    };
    ViewBase.prototype.setFlag = function (flag, value) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                this._onLoadedCalled = value;
                break;
            case Flags.superOnUnloadedCalled:
                this._onUnloadedCalled = value;
                break;
        }
    };
    ViewBase.prototype.isFlagSet = function (flag) {
        switch (flag) {
            case Flags.superOnLoadedCalled:
                return this._onLoadedCalled;
            case Flags.superOnUnloadedCalled:
                return this._onUnloadedCalled;
        }
    };
    ViewBase.prototype.callFunctionWithSuper = function (flag, func) {
        this.setFlag(flag, false);
        func();
        if (!this.isFlagSet(flag)) {
            throw new Error("super." + flag + " not called in " + this);
        }
    };
    ViewBase.prototype.callLoaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnLoadedCalled, function () { return _this.onLoaded(); });
    };
    ViewBase.prototype.callUnloaded = function () {
        var _this = this;
        this.callFunctionWithSuper(Flags.superOnUnloadedCalled, function () { return _this.onUnloaded(); });
    };
    ViewBase.prototype.notifyPseudoClassChanged = function (pseudoClass) {
        this.notify({ eventName: ":" + pseudoClass, object: this });
    };
    ViewBase.prototype.getAllAliasedStates = function (name) {
        var allStates = [];
        allStates.push(name);
        if (name in this.pseudoClassAliases) {
            for (var i = 0; i < this.pseudoClassAliases[name].length; i++) {
                allStates.push(this.pseudoClassAliases[name][i]);
            }
        }
        return allStates;
    };
    ViewBase.prototype.addPseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (!this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.add(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.deletePseudoClass = function (name) {
        var allStates = this.getAllAliasedStates(name);
        for (var i = 0; i < allStates.length; i++) {
            if (this.cssPseudoClasses.has(allStates[i])) {
                this.cssPseudoClasses.delete(allStates[i]);
                this.notifyPseudoClassChanged(allStates[i]);
            }
        }
    };
    ViewBase.prototype.bindingContextChanged = function (data) {
        this.bindings.get("bindingContext").bind(data.value);
    };
    ViewBase.prototype.bind = function (options, source) {
        if (source === void 0) { source = defaultBindingSource; }
        var targetProperty = options.targetProperty;
        this.unbind(targetProperty);
        if (!this.bindings) {
            this.bindings = new Map();
        }
        var binding = new bindable_1.Binding(this, options);
        this.bindings.set(targetProperty, binding);
        var bindingSource = source;
        if (bindingSource === defaultBindingSource) {
            bindingSource = this.bindingContext;
            binding.sourceIsBindingContext = true;
            if (targetProperty === "bindingContext") {
                this.bindingContextBoundToParentBindingContextChanged = true;
                var parent_2 = this.parent;
                if (parent_2) {
                    parent_2.on("bindingContextChange", this.bindingContextChanged, this);
                }
                else {
                    this.shouldAddHandlerToParentBindingContextChanged = true;
                }
            }
        }
        binding.bind(bindingSource);
    };
    ViewBase.prototype.unbind = function (property) {
        var bindings = this.bindings;
        if (!bindings) {
            return;
        }
        var binding = bindings.get(property);
        if (binding) {
            binding.unbind();
            bindings.delete(property);
            if (binding.sourceIsBindingContext) {
                if (property === "bindingContext") {
                    this.shouldAddHandlerToParentBindingContextChanged = false;
                    this.bindingContextBoundToParentBindingContextChanged = false;
                    var parent_3 = this.parent;
                    if (parent_3) {
                        parent_3.off("bindingContextChange", this.bindingContextChanged, this);
                    }
                }
            }
        }
    };
    ViewBase.prototype.requestLayout = function () {
        var parent = this.parent;
        if (parent) {
            parent.requestLayout();
        }
    };
    ViewBase.prototype.eachChild = function (callback) {
    };
    ViewBase.prototype._addView = function (view, atIndex) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._addView(" + view + ", " + atIndex + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (!view) {
            throw new Error("Expecting a valid View instance.");
        }
        if (!(view instanceof ViewBase)) {
            throw new Error(view + " is not a valid View instance.");
        }
        if (view.parent) {
            throw new Error("View already has a parent. View: " + view + " Parent: " + view.parent);
        }
        view.parent = this;
        this._addViewCore(view, atIndex);
        view._parentChanged(null);
        if (this.domNode) {
            this.domNode.onChildAdded(view);
        }
    };
    ViewBase.prototype._addViewCore = function (view, atIndex) {
        properties_1.propagateInheritableProperties(this, view);
        view._inheritStyleScope(this._styleScope);
        properties_1.propagateInheritableCssProperties(this.style, view.style);
        if (this._context) {
            view._setupUI(this._context, atIndex);
        }
        if (this._isLoaded) {
            this.loadView(view);
        }
    };
    ViewBase.prototype.loadView = function (view) {
        if (view && !view.isLoaded) {
            view.callLoaded();
        }
    };
    ViewBase.prototype.unloadView = function (view) {
        if (view && view.isLoaded) {
            view.callUnloaded();
        }
    };
    ViewBase.prototype._removeView = function (view) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + "._removeView(" + view + ")", bindable_1.traceCategories.ViewHierarchy);
        }
        if (view.parent !== this) {
            throw new Error("View not added to this instance. View: " + view + " CurrentParent: " + view.parent + " ExpectedParent: " + this);
        }
        if (this.domNode) {
            this.domNode.onChildRemoved(view);
        }
        this._removeViewCore(view);
        view.parent = undefined;
        view._parentChanged(this);
    };
    ViewBase.prototype._removeViewCore = function (view) {
        this.unloadView(view);
        if (view._context) {
            view._tearDownUI();
        }
    };
    ViewBase.prototype.createNativeView = function () {
        return undefined;
    };
    ViewBase.prototype.disposeNativeView = function () {
    };
    ViewBase.prototype.initNativeView = function () {
    };
    ViewBase.prototype.resetNativeView = function () {
    };
    ViewBase.prototype.resetNativeViewInternal = function () {
    };
    ViewBase.prototype._setupAsRootView = function (context) {
        this._setupUI(context);
    };
    ViewBase.prototype._setupUI = function (context, atIndex, parentIsLoaded) {
        if (this._context === context) {
            return;
        }
        else if (this._context) {
            this._tearDownUI(true);
        }
        this._context = context;
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            nativeView = this.createNativeView();
        }
        if (platform_1.isAndroid) {
            this._androidView = nativeView;
            if (nativeView) {
                if (this._isPaddingRelative === undefined) {
                    this._isPaddingRelative = nativeView.isPaddingRelative();
                }
                var result = nativeView.defaultPaddings;
                if (result === undefined) {
                    result = org.nativescript.widgets.ViewHelper.getPadding(nativeView);
                    nativeView.defaultPaddings = result;
                }
                this._defaultPaddingTop = result.top;
                this._defaultPaddingRight = result.right;
                this._defaultPaddingBottom = result.bottom;
                this._defaultPaddingLeft = result.left;
                var style = this.style;
                if (!style_properties_1.paddingTopProperty.isSet(style)) {
                    this.effectivePaddingTop = this._defaultPaddingTop;
                }
                if (!style_properties_1.paddingRightProperty.isSet(style)) {
                    this.effectivePaddingRight = this._defaultPaddingRight;
                }
                if (!style_properties_1.paddingBottomProperty.isSet(style)) {
                    this.effectivePaddingBottom = this._defaultPaddingBottom;
                }
                if (!style_properties_1.paddingLeftProperty.isSet(style)) {
                    this.effectivePaddingLeft = this._defaultPaddingLeft;
                }
            }
        }
        else {
            this._iosView = nativeView;
        }
        this.setNativeView(nativeView);
        if (this.parent) {
            var nativeIndex = this.parent._childIndexToNativeChildIndex(atIndex);
            this._isAddedToNativeVisualTree = this.parent._addViewToNativeVisualTree(this, nativeIndex);
        }
        this._resumeNativeUpdates(SuspendType.UISetup);
        this.eachChild(function (child) {
            child._setupUI(context);
            return true;
        });
    };
    ViewBase.prototype.setNativeView = function (value) {
        if (this.__nativeView === value) {
            return;
        }
        if (this.__nativeView) {
            this._suspendNativeUpdates(SuspendType.NativeView);
        }
        this.__nativeView = this.nativeViewProtected = value;
        if (this.__nativeView) {
            this._suspendedUpdates = undefined;
            this.initNativeView();
            this._resumeNativeUpdates(SuspendType.NativeView);
        }
    };
    ViewBase.prototype._tearDownUI = function (force) {
        if (!this._context) {
            return;
        }
        this.resetNativeViewInternal();
        this.eachChild(function (child) {
            child._tearDownUI(force);
            return true;
        });
        if (this.parent) {
            this.parent._removeViewFromNativeVisualTree(this);
        }
        this.disposeNativeView();
        this._suspendNativeUpdates(SuspendType.UISetup);
        if (platform_1.isAndroid) {
            this.setNativeView(null);
            this._androidView = null;
        }
        this._context = null;
        if (this.domNode) {
            this.domNode.dispose();
            this.domNode = undefined;
        }
    };
    ViewBase.prototype._childIndexToNativeChildIndex = function (index) {
        return index;
    };
    ViewBase.prototype._addViewToNativeVisualTree = function (view, atIndex) {
        if (view._isAddedToNativeVisualTree) {
            throw new Error("Child already added to the native visual tree.");
        }
        return true;
    };
    ViewBase.prototype._removeViewFromNativeVisualTree = function (view) {
        view._isAddedToNativeVisualTree = false;
    };
    ViewBase.prototype._goToVisualState = function (state) {
        if (bindable_1.traceEnabled()) {
            bindable_1.traceWrite(this + " going to state: " + state, bindable_1.traceCategories.Style);
        }
        if (state === this._visualState) {
            return;
        }
        this.deletePseudoClass(this._visualState);
        this._visualState = state;
        this.addPseudoClass(state);
    };
    ViewBase.prototype._applyXmlAttribute = function (attribute, value) {
        console.log("ViewBase._applyXmlAttribute(...) is deprecated; set attributes as plain properties instead");
        if (attribute === "style" || attribute === "rows" || attribute === "columns" || attribute === "fontAttributes") {
            this[attribute] = value;
            return true;
        }
        return false;
    };
    ViewBase.prototype.setInlineStyle = function (style) {
        if (typeof style !== "string") {
            throw new Error("Parameter should be valid CSS string!");
        }
        ensureStyleScopeModule();
        styleScopeModule.applyInlineStyle(this, style);
    };
    ViewBase.prototype._parentChanged = function (oldParent) {
        var newParent = this.parent;
        if (oldParent) {
            properties_1.clearInheritedProperties(this);
            if (this.bindingContextBoundToParentBindingContextChanged) {
                oldParent.off("bindingContextChange", this.bindingContextChanged, this);
            }
        }
        else if (this.shouldAddHandlerToParentBindingContextChanged) {
            newParent.on("bindingContextChange", this.bindingContextChanged, this);
            this.bindings.get("bindingContext").bind(newParent.bindingContext);
        }
    };
    ViewBase.prototype.onResumeNativeUpdates = function () {
        properties_1.initNativeView(this);
    };
    ViewBase.prototype.toString = function () {
        var str = this.typeName;
        if (this.id) {
            str += "<" + this.id + ">";
        }
        else {
            str += "(" + this._domId + ")";
        }
        var source = debug_1.Source.get(this);
        if (source) {
            str += "@" + source + ";";
        }
        return str;
    };
    ViewBase.prototype._onCssStateChange = function () {
        this._cssState.onChange();
        eachDescendant(this, function (child) {
            child._cssState.onChange();
            return true;
        });
    };
    ViewBase.prototype._inheritStyleScope = function (styleScope) {
        if (this._isStyleScopeHost) {
            return;
        }
        if (this._styleScope !== styleScope) {
            this._styleScope = styleScope;
            this._onCssStateChange();
            this.eachChild(function (child) {
                child._inheritStyleScope(styleScope);
                return true;
            });
        }
    };
    ViewBase.prototype.showModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        return parent && parent.showModal.apply(parent, args);
    };
    ViewBase.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var parent = this.parent;
        if (parent) {
            parent.closeModal.apply(parent, args);
        }
    };
    ViewBase.prototype._dialogClosed = function () {
        eachDescendant(this, function (child) {
            child._dialogClosed();
            return true;
        });
    };
    ViewBase.prototype._onRootViewReset = function () {
        eachDescendant(this, function (child) {
            child._onRootViewReset();
            return true;
        });
    };
    ViewBase.loadedEvent = "loaded";
    ViewBase.unloadedEvent = "unloaded";
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "onUnloaded", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "addPseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "deletePseudoClass", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "requestLayout", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_addView", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_setupUI", null);
    __decorate([
        profiling_1.profile
    ], ViewBase.prototype, "_tearDownUI", null);
    return ViewBase;
}(bindable_1.Observable));
exports.ViewBase = ViewBase;
ViewBase.prototype.isCollapsed = false;
ViewBase.prototype._oldLeft = 0;
ViewBase.prototype._oldTop = 0;
ViewBase.prototype._oldRight = 0;
ViewBase.prototype._oldBottom = 0;
ViewBase.prototype.effectiveMinWidth = 0;
ViewBase.prototype.effectiveMinHeight = 0;
ViewBase.prototype.effectiveWidth = 0;
ViewBase.prototype.effectiveHeight = 0;
ViewBase.prototype.effectiveMarginTop = 0;
ViewBase.prototype.effectiveMarginRight = 0;
ViewBase.prototype.effectiveMarginBottom = 0;
ViewBase.prototype.effectiveMarginLeft = 0;
ViewBase.prototype.effectivePaddingTop = 0;
ViewBase.prototype.effectivePaddingRight = 0;
ViewBase.prototype.effectivePaddingBottom = 0;
ViewBase.prototype.effectivePaddingLeft = 0;
ViewBase.prototype.effectiveBorderTopWidth = 0;
ViewBase.prototype.effectiveBorderRightWidth = 0;
ViewBase.prototype.effectiveBorderBottomWidth = 0;
ViewBase.prototype.effectiveBorderLeftWidth = 0;
ViewBase.prototype._defaultPaddingTop = 0;
ViewBase.prototype._defaultPaddingRight = 0;
ViewBase.prototype._defaultPaddingBottom = 0;
ViewBase.prototype._defaultPaddingLeft = 0;
ViewBase.prototype._isViewBase = true;
ViewBase.prototype.recycleNativeView = "never";
ViewBase.prototype._suspendNativeUpdatesCount =
    SuspendType.Loaded |
        SuspendType.NativeView |
        SuspendType.UISetup;
exports.bindingContextProperty = new properties_1.InheritedProperty({ name: "bindingContext" });
exports.bindingContextProperty.register(ViewBase);
exports.classNameProperty = new properties_1.Property({
    name: "className",
    valueChanged: function (view, oldValue, newValue) {
        var classes = view.cssClasses;
        classes.clear();
        if (typeof newValue === "string" && newValue !== "") {
            newValue.split(" ").forEach(function (c) { return classes.add(c); });
        }
        view._onCssStateChange();
    }
});
exports.classNameProperty.register(ViewBase);
exports.idProperty = new properties_1.Property({ name: "id", valueChanged: function (view, oldValue, newValue) { return view._onCssStateChange(); } });
exports.idProperty.register(ViewBase);
function booleanConverter(v) {
    var lowercase = (v + "").toLowerCase();
    if (lowercase === "true") {
        return true;
    }
    else if (lowercase === "false") {
        return false;
    }
    throw new Error("Invalid boolean: " + v);
}
exports.booleanConverter = booleanConverter;
//# sourceMappingURL=view-base.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var gestures_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
var style_scope_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-scope.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
exports.LinearGradient = linear_gradient_1.LinearGradient;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js"));
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view-base/view-base.js"));
var animationModule;
function ensureAnimationModule() {
    if (!animationModule) {
        animationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
    }
}
function CSSType(type) {
    return function (cls) {
        cls.prototype.cssType = type;
    };
}
exports.CSSType = CSSType;
function viewMatchesModuleContext(view, context, types) {
    return context &&
        view._moduleName &&
        context.type &&
        types.some(function (type) { return type === context.type; }) &&
        context.path &&
        context.path.includes(view._moduleName);
}
exports.viewMatchesModuleContext = viewMatchesModuleContext;
function PseudoClassHandler() {
    var pseudoClasses = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        pseudoClasses[_i] = arguments[_i];
    }
    var stateEventNames = pseudoClasses.map(function (s) { return ":" + s; });
    var listeners = Symbol("listeners");
    return function (target, propertyKey, descriptor) {
        function update(change) {
            var prev = this[listeners] || 0;
            var next = prev + change;
            if (prev <= 0 && next > 0) {
                this[propertyKey](true);
            }
            else if (prev > 0 && next <= 0) {
                this[propertyKey](false);
            }
        }
        stateEventNames.forEach(function (s) { return target[s] = update; });
    };
}
exports.PseudoClassHandler = PseudoClassHandler;
exports._rootModalViews = new Array();
var ViewCommon = (function (_super) {
    __extends(ViewCommon, _super);
    function ViewCommon() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._gestureObservers = {};
        return _this;
    }
    Object.defineProperty(ViewCommon.prototype, "css", {
        get: function () {
            var scope = this._styleScope;
            return scope && scope.css;
        },
        set: function (value) {
            this._updateStyleScope(undefined, undefined, value);
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.addCss = function (cssString) {
        this._updateStyleScope(undefined, cssString);
    };
    ViewCommon.prototype.addCssFile = function (cssFileName) {
        this._updateStyleScope(cssFileName);
    };
    ViewCommon.prototype.changeCssFile = function (cssFileName) {
        var scope = this._styleScope;
        if (scope && cssFileName) {
            scope.changeCssFile(cssFileName);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype._updateStyleScope = function (cssFileName, cssString, css) {
        var scope = this._styleScope;
        if (!scope) {
            scope = new style_scope_1.StyleScope();
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._inheritStyleScope(scope);
            this._isStyleScopeHost = true;
        }
        else {
            this.setScopeProperty(scope, cssFileName, cssString, css);
            this._onCssStateChange();
        }
    };
    ViewCommon.prototype.setScopeProperty = function (scope, cssFileName, cssString, css) {
        if (cssFileName !== undefined) {
            scope.addCssFile(cssFileName);
        }
        else if (cssString !== undefined) {
            scope.addCss(cssString);
        }
        else if (css !== undefined) {
            scope.css = css;
        }
    };
    ViewCommon.prototype._onLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._onLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (this._handleLivesync(context)) {
            return true;
        }
        var handled = false;
        this.eachChildView(function (child) {
            if (child._onLivesync(context)) {
                handled = true;
                return false;
            }
        });
        return handled;
    };
    ViewCommon.prototype._handleLivesync = function (context) {
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + "._handleLivesync(" + JSON.stringify(context) + ")", view_base_1.traceCategories.Livesync);
        }
        if (viewMatchesModuleContext(this, context, ["style"])) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing CSS for " + this, view_base_1.traceCategories.Livesync);
            }
            var cssModuleName = module_name_sanitizer_1.sanitizeModuleName(context.path) + ".css";
            this.changeCssFile(cssModuleName);
            return true;
        }
        if (viewMatchesModuleContext(this, context, ["markup", "script"]) &&
            this.page &&
            this.page.frame) {
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite("Change Handled: Changing " + context.type + " for " + this + " inside " + this.page, view_base_1.traceCategories.Livesync);
            }
            return this.page.frame._handleLivesync({ type: context.type, path: this.page._moduleName });
        }
        return false;
    };
    ViewCommon.prototype._setupAsRootView = function (context) {
        _super.prototype._setupAsRootView.call(this, context);
        if (!this._styleScope) {
            this._updateStyleScope();
        }
    };
    ViewCommon.prototype._observe = function (type, callback, thisArg) {
        if (!this._gestureObservers[type]) {
            this._gestureObservers[type] = [];
        }
        this._gestureObservers[type].push(gestures_1.observe(this, type, callback, thisArg));
    };
    ViewCommon.prototype.getGestureObservers = function (type) {
        return this._gestureObservers[type];
    };
    ViewCommon.prototype.addEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            arg = view_base_1.getEventOrGestureName(arg);
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._observe(gesture, callback, thisArg);
            }
            else {
                var events = (arg).split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._observe(gst, callback, thisArg);
                        }
                        else {
                            _super.prototype.addEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.addEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._observe(arg, callback, thisArg);
        }
    };
    ViewCommon.prototype.removeEventListener = function (arg, callback, thisArg) {
        if (typeof arg === "string") {
            var gesture = gestures_1.fromString(arg);
            if (gesture && !this._isEvent(arg)) {
                this._disconnectGestureObservers(gesture);
            }
            else {
                var events = arg.split(",");
                if (events.length > 0) {
                    for (var i = 0; i < events.length; i++) {
                        var evt = events[i].trim();
                        var gst = gestures_1.fromString(evt);
                        if (gst && !this._isEvent(arg)) {
                            this._disconnectGestureObservers(gst);
                        }
                        else {
                            _super.prototype.removeEventListener.call(this, evt, callback, thisArg);
                        }
                    }
                }
                else {
                    _super.prototype.removeEventListener.call(this, arg, callback, thisArg);
                }
            }
        }
        else if (typeof arg === "number") {
            this._disconnectGestureObservers(arg);
        }
    };
    ViewCommon.prototype.onBackPressed = function () {
        return false;
    };
    ViewCommon.prototype._getFragmentManager = function () {
        return undefined;
    };
    ViewCommon.prototype.getModalOptions = function (args) {
        if (args.length === 0) {
            throw new Error("showModal without parameters is deprecated. Please call showModal on a view instance instead.");
        }
        else {
            var options = null;
            if (args.length === 2) {
                options = args[1];
            }
            else {
                if (args[0] instanceof ViewCommon) {
                    console.log("showModal(view: ViewBase, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(view: ViewBase, modalOptions: ShowModalOptions) instead.");
                }
                else {
                    console.log("showModal(moduleName: string, context: any, closeCallback: Function, fullscreen?: boolean, animated?: boolean, stretched?: boolean) " +
                        "is deprecated. Use showModal(moduleName: string, modalOptions: ShowModalOptions) instead.");
                }
                options = {
                    context: args[1],
                    closeCallback: args[2],
                    fullscreen: args[3],
                    animated: args[4],
                    stretched: args[5]
                };
            }
            var firstArgument = args[0];
            var view = firstArgument instanceof ViewCommon
                ? firstArgument : builder_1.createViewFromEntry({ moduleName: firstArgument });
            return { view: view, options: options };
        }
    };
    ViewCommon.prototype.showModal = function () {
        var _a = this.getModalOptions(arguments), view = _a.view, options = _a.options;
        view._showNativeModalView(this, options);
        return view;
    };
    ViewCommon.prototype.closeModal = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var closeCallback = this._closeModalCallback;
        if (closeCallback) {
            closeCallback.apply(undefined, arguments);
        }
        else {
            var parent_1 = this.parent;
            if (parent_1) {
                parent_1.closeModal.apply(parent_1, args);
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "modal", {
        get: function () {
            return this._modal;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype._showNativeModalView = function (parent, options) {
        exports._rootModalViews.push(this);
        parent._modal = this;
        this._modalParent = parent;
        this._modalContext = options.context;
        var that = this;
        this._closeModalCallback = function () {
            var originalArgs = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                originalArgs[_i] = arguments[_i];
            }
            if (that._closeModalCallback) {
                var modalIndex = exports._rootModalViews.indexOf(that);
                exports._rootModalViews.splice(modalIndex);
                that._modalParent = null;
                that._modalContext = null;
                that._closeModalCallback = null;
                that._dialogClosed();
                parent._modal = null;
                var whenClosedCallback = function () {
                    if (typeof options.closeCallback === "function") {
                        options.closeCallback.apply(undefined, originalArgs);
                    }
                };
                that._hideNativeModalView(parent, whenClosedCallback);
            }
        };
    };
    ViewCommon.prototype._raiseLayoutChangedEvent = function () {
        var args = {
            eventName: ViewCommon.layoutChangedEvent,
            object: this
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShownModallyEvent = function () {
        var args = {
            eventName: ViewCommon.shownModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._raiseShowingModallyEvent = function () {
        var args = {
            eventName: ViewCommon.showingModallyEvent,
            object: this,
            context: this._modalContext,
            closeCallback: this._closeModalCallback
        };
        this.notify(args);
    };
    ViewCommon.prototype._isEvent = function (name) {
        return this.constructor && name + "Event" in this.constructor;
    };
    ViewCommon.prototype._disconnectGestureObservers = function (type) {
        var observers = this.getGestureObservers(type);
        if (observers) {
            for (var i = 0; i < observers.length; i++) {
                observers[i].disconnect();
            }
        }
    };
    Object.defineProperty(ViewCommon.prototype, "borderColor", {
        get: function () {
            return this.style.borderColor;
        },
        set: function (value) {
            this.style.borderColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopColor", {
        get: function () {
            return this.style.borderTopColor;
        },
        set: function (value) {
            this.style.borderTopColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightColor", {
        get: function () {
            return this.style.borderRightColor;
        },
        set: function (value) {
            this.style.borderRightColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomColor", {
        get: function () {
            return this.style.borderBottomColor;
        },
        set: function (value) {
            this.style.borderBottomColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftColor", {
        get: function () {
            return this.style.borderLeftColor;
        },
        set: function (value) {
            this.style.borderLeftColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderWidth", {
        get: function () {
            return this.style.borderWidth;
        },
        set: function (value) {
            this.style.borderWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopWidth", {
        get: function () {
            return this.style.borderTopWidth;
        },
        set: function (value) {
            this.style.borderTopWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRightWidth", {
        get: function () {
            return this.style.borderRightWidth;
        },
        set: function (value) {
            this.style.borderRightWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomWidth", {
        get: function () {
            return this.style.borderBottomWidth;
        },
        set: function (value) {
            this.style.borderBottomWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderLeftWidth", {
        get: function () {
            return this.style.borderLeftWidth;
        },
        set: function (value) {
            this.style.borderLeftWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderRadius", {
        get: function () {
            return this.style.borderRadius;
        },
        set: function (value) {
            this.style.borderRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopLeftRadius", {
        get: function () {
            return this.style.borderTopLeftRadius;
        },
        set: function (value) {
            this.style.borderTopLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderTopRightRadius", {
        get: function () {
            return this.style.borderTopRightRadius;
        },
        set: function (value) {
            this.style.borderTopRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomRightRadius", {
        get: function () {
            return this.style.borderBottomRightRadius;
        },
        set: function (value) {
            this.style.borderBottomRightRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "borderBottomLeftRadius", {
        get: function () {
            return this.style.borderBottomLeftRadius;
        },
        set: function (value) {
            this.style.borderBottomLeftRadius = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "color", {
        get: function () {
            return this.style.color;
        },
        set: function (value) {
            this.style.color = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "background", {
        get: function () {
            return this.style.background;
        },
        set: function (value) {
            this.style.background = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundColor", {
        get: function () {
            return this.style.backgroundColor;
        },
        set: function (value) {
            this.style.backgroundColor = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundImage", {
        get: function () {
            return this.style.backgroundImage;
        },
        set: function (value) {
            this.style.backgroundImage = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundSize", {
        get: function () {
            return this.style.backgroundSize;
        },
        set: function (value) {
            this.style.backgroundSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundPosition", {
        get: function () {
            return this.style.backgroundPosition;
        },
        set: function (value) {
            this.style.backgroundPosition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "backgroundRepeat", {
        get: function () {
            return this.style.backgroundRepeat;
        },
        set: function (value) {
            this.style.backgroundRepeat = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minWidth", {
        get: function () {
            return this.style.minWidth;
        },
        set: function (value) {
            this.style.minWidth = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "minHeight", {
        get: function () {
            return this.style.minHeight;
        },
        set: function (value) {
            this.style.minHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "width", {
        get: function () {
            return this.style.width;
        },
        set: function (value) {
            this.style.width = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "height", {
        get: function () {
            return this.style.height;
        },
        set: function (value) {
            this.style.height = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "margin", {
        get: function () {
            return this.style.margin;
        },
        set: function (value) {
            this.style.margin = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginLeft", {
        get: function () {
            return this.style.marginLeft;
        },
        set: function (value) {
            this.style.marginLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginTop", {
        get: function () {
            return this.style.marginTop;
        },
        set: function (value) {
            this.style.marginTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginRight", {
        get: function () {
            return this.style.marginRight;
        },
        set: function (value) {
            this.style.marginRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "marginBottom", {
        get: function () {
            return this.style.marginBottom;
        },
        set: function (value) {
            this.style.marginBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "horizontalAlignment", {
        get: function () {
            return this.style.horizontalAlignment;
        },
        set: function (value) {
            this.style.horizontalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "verticalAlignment", {
        get: function () {
            return this.style.verticalAlignment;
        },
        set: function (value) {
            this.style.verticalAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "visibility", {
        get: function () {
            return this.style.visibility;
        },
        set: function (value) {
            this.style.visibility = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "opacity", {
        get: function () {
            return this.style.opacity;
        },
        set: function (value) {
            this.style.opacity = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "rotate", {
        get: function () {
            return this.style.rotate;
        },
        set: function (value) {
            this.style.rotate = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateX", {
        get: function () {
            return this.style.translateX;
        },
        set: function (value) {
            this.style.translateX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "translateY", {
        get: function () {
            return this.style.translateY;
        },
        set: function (value) {
            this.style.translateY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleX", {
        get: function () {
            return this.style.scaleX;
        },
        set: function (value) {
            this.style.scaleX = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "scaleY", {
        get: function () {
            return this.style.scaleY;
        },
        set: function (value) {
            this.style.scaleY = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidElevation", {
        get: function () {
            return this.style.androidElevation;
        },
        set: function (value) {
            this.style.androidElevation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "androidDynamicElevationOffset", {
        get: function () {
            return this.style.androidDynamicElevationOffset;
        },
        set: function (value) {
            this.style.androidDynamicElevationOffset = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutValid", {
        get: function () {
            return this._isLayoutValid;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "cssType", {
        get: function () {
            if (!this._cssType) {
                this._cssType = this.typeName.toLowerCase();
            }
            return this._cssType;
        },
        set: function (type) {
            this._cssType = type.toLowerCase();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ViewCommon.prototype, "isLayoutRequired", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    ViewCommon.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
    };
    ViewCommon.prototype.layout = function (left, top, right, bottom) {
        this._setCurrentLayoutBounds(left, top, right, bottom);
    };
    ViewCommon.prototype.getMeasuredWidth = function () {
        return this._measuredWidth & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredHeight = function () {
        return this._measuredHeight & view_base_1.layout.MEASURED_SIZE_MASK || 0;
    };
    ViewCommon.prototype.getMeasuredState = function () {
        return (this._measuredWidth & view_base_1.layout.MEASURED_STATE_MASK)
            | ((this._measuredHeight >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT)
                & (view_base_1.layout.MEASURED_STATE_MASK >> view_base_1.layout.MEASURED_HEIGHT_STATE_SHIFT));
    };
    ViewCommon.prototype.setMeasuredDimension = function (measuredWidth, measuredHeight) {
        this._measuredWidth = measuredWidth;
        this._measuredHeight = measuredHeight;
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(this + " :setMeasuredDimension: " + measuredWidth + ", " + measuredHeight, view_base_1.traceCategories.Layout);
        }
    };
    ViewCommon.prototype.requestLayout = function () {
        this._isLayoutValid = false;
        _super.prototype.requestLayout.call(this);
    };
    ViewCommon.resolveSizeAndState = function (size, specSize, specMode, childMeasuredState) {
        var result = size;
        switch (specMode) {
            case view_base_1.layout.UNSPECIFIED:
                result = Math.ceil(size);
                break;
            case view_base_1.layout.AT_MOST:
                if (specSize < size) {
                    result = Math.ceil(specSize) | view_base_1.layout.MEASURED_STATE_TOO_SMALL;
                }
                break;
            case view_base_1.layout.EXACTLY:
                result = Math.ceil(specSize);
                break;
        }
        return result | (childMeasuredState & view_base_1.layout.MEASURED_STATE_MASK);
    };
    ViewCommon.combineMeasuredStates = function (curState, newState) {
        return curState | newState;
    };
    ViewCommon.layoutChild = function (parent, child, left, top, right, bottom, setFrame) {
        if (setFrame === void 0) { setFrame = true; }
        if (!child || child.isCollapsed) {
            return;
        }
        var childStyle = child.style;
        var childTop;
        var childLeft;
        var childWidth = child.getMeasuredWidth();
        var childHeight = child.getMeasuredHeight();
        var effectiveMarginTop = child.effectiveMarginTop;
        var effectiveMarginBottom = child.effectiveMarginBottom;
        var vAlignment;
        if (child.effectiveHeight >= 0 && childStyle.verticalAlignment === "stretch") {
            vAlignment = "middle";
        }
        else {
            vAlignment = childStyle.verticalAlignment;
        }
        switch (vAlignment) {
            case "top":
                childTop = top + effectiveMarginTop;
                break;
            case "middle":
                childTop = top + (bottom - top - childHeight + (effectiveMarginTop - effectiveMarginBottom)) / 2;
                break;
            case "bottom":
                childTop = bottom - childHeight - effectiveMarginBottom;
                break;
            case "stretch":
            default:
                childTop = top + effectiveMarginTop;
                childHeight = bottom - top - (effectiveMarginTop + effectiveMarginBottom);
                break;
        }
        var effectiveMarginLeft = child.effectiveMarginLeft;
        var effectiveMarginRight = child.effectiveMarginRight;
        var hAlignment;
        if (child.effectiveWidth >= 0 && childStyle.horizontalAlignment === "stretch") {
            hAlignment = "center";
        }
        else {
            hAlignment = childStyle.horizontalAlignment;
        }
        switch (hAlignment) {
            case "left":
                childLeft = left + effectiveMarginLeft;
                break;
            case "center":
                childLeft = left + (right - left - childWidth + (effectiveMarginLeft - effectiveMarginRight)) / 2;
                break;
            case "right":
                childLeft = right - childWidth - effectiveMarginRight;
                break;
            case "stretch":
            default:
                childLeft = left + effectiveMarginLeft;
                childWidth = right - left - (effectiveMarginLeft + effectiveMarginRight);
                break;
        }
        var childRight = Math.round(childLeft + childWidth);
        var childBottom = Math.round(childTop + childHeight);
        childLeft = Math.round(childLeft);
        childTop = Math.round(childTop);
        if (view_base_1.traceEnabled()) {
            view_base_1.traceWrite(child.parent + " :layoutChild: " + child + " " + childLeft + ", " + childTop + ", " + childRight + ", " + childBottom, view_base_1.traceCategories.Layout);
        }
        child.layout(childLeft, childTop, childRight, childBottom, setFrame);
    };
    ViewCommon.measureChild = function (parent, child, widthMeasureSpec, heightMeasureSpec) {
        var measureWidth = 0;
        var measureHeight = 0;
        if (child && !child.isCollapsed) {
            var widthSpec = parent ? parent._currentWidthMeasureSpec : widthMeasureSpec;
            var heightSpec = parent ? parent._currentHeightMeasureSpec : heightMeasureSpec;
            var width = view_base_1.layout.getMeasureSpecSize(widthSpec);
            var widthMode = view_base_1.layout.getMeasureSpecMode(widthSpec);
            var height = view_base_1.layout.getMeasureSpecSize(heightSpec);
            var heightMode = view_base_1.layout.getMeasureSpecMode(heightSpec);
            child._updateEffectiveLayoutValues(width, widthMode, height, heightMode);
            var style = child.style;
            var horizontalMargins = child.effectiveMarginLeft + child.effectiveMarginRight;
            var verticalMargins = child.effectiveMarginTop + child.effectiveMarginBottom;
            var childWidthMeasureSpec = ViewCommon.getMeasureSpec(widthMeasureSpec, horizontalMargins, child.effectiveWidth, style.horizontalAlignment === "stretch");
            var childHeightMeasureSpec = ViewCommon.getMeasureSpec(heightMeasureSpec, verticalMargins, child.effectiveHeight, style.verticalAlignment === "stretch");
            if (view_base_1.traceEnabled()) {
                view_base_1.traceWrite(child.parent + " :measureChild: " + child + " " + view_base_1.layout.measureSpecToString(childWidthMeasureSpec) + ", " + view_base_1.layout.measureSpecToString(childHeightMeasureSpec) + "}", view_base_1.traceCategories.Layout);
            }
            child.measure(childWidthMeasureSpec, childHeightMeasureSpec);
            measureWidth = Math.round(child.getMeasuredWidth() + horizontalMargins);
            measureHeight = Math.round(child.getMeasuredHeight() + verticalMargins);
        }
        return { measuredWidth: measureWidth, measuredHeight: measureHeight };
    };
    ViewCommon.getMeasureSpec = function (parentSpec, margins, childLength, stretched) {
        var parentLength = view_base_1.layout.getMeasureSpecSize(parentSpec);
        var parentSpecMode = view_base_1.layout.getMeasureSpecMode(parentSpec);
        var resultSize;
        var resultMode;
        if (childLength >= 0) {
            resultSize = parentSpecMode === view_base_1.layout.UNSPECIFIED ? childLength : Math.min(parentLength, childLength);
            resultMode = view_base_1.layout.EXACTLY;
        }
        else {
            switch (parentSpecMode) {
                case view_base_1.layout.EXACTLY:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = stretched ? view_base_1.layout.EXACTLY : view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.AT_MOST:
                    resultSize = Math.max(0, parentLength - margins);
                    resultMode = view_base_1.layout.AT_MOST;
                    break;
                case view_base_1.layout.UNSPECIFIED:
                    resultSize = 0;
                    resultMode = view_base_1.layout.UNSPECIFIED;
                    break;
            }
        }
        return view_base_1.layout.makeMeasureSpec(resultSize, resultMode);
    };
    ViewCommon.prototype._setCurrentMeasureSpecs = function (widthMeasureSpec, heightMeasureSpec) {
        var changed = this._currentWidthMeasureSpec !== widthMeasureSpec || this._currentHeightMeasureSpec !== heightMeasureSpec;
        this._currentWidthMeasureSpec = widthMeasureSpec;
        this._currentHeightMeasureSpec = heightMeasureSpec;
        return changed;
    };
    ViewCommon.prototype._getCurrentLayoutBounds = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype._setCurrentLayoutBounds = function (left, top, right, bottom) {
        this._isLayoutValid = true;
        var boundsChanged = this._oldLeft !== left || this._oldTop !== top || this._oldRight !== right || this._oldBottom !== bottom;
        var sizeChanged = (this._oldRight - this._oldLeft !== right - left) || (this._oldBottom - this._oldTop !== bottom - top);
        this._oldLeft = left;
        this._oldTop = top;
        this._oldRight = right;
        this._oldBottom = bottom;
        return { boundsChanged: boundsChanged, sizeChanged: sizeChanged };
    };
    ViewCommon.prototype.eachChild = function (callback) {
        this.eachChildView(callback);
    };
    ViewCommon.prototype.eachChildView = function (callback) {
    };
    ViewCommon.prototype._getNativeViewsCount = function () {
        return this._isAddedToNativeVisualTree ? 1 : 0;
    };
    ViewCommon.prototype._eachLayoutView = function (callback) {
        return callback(this);
    };
    ViewCommon.prototype.focus = function () {
        return undefined;
    };
    ViewCommon.prototype.getSafeAreaInsets = function () {
        return { left: 0, top: 0, right: 0, bottom: 0 };
    };
    ViewCommon.prototype.getLocationInWindow = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationOnScreen = function () {
        return undefined;
    };
    ViewCommon.prototype.getLocationRelativeTo = function (otherView) {
        return undefined;
    };
    ViewCommon.prototype.getActualSize = function () {
        var currentBounds = this._getCurrentLayoutBounds();
        if (!currentBounds) {
            return undefined;
        }
        return {
            width: view_base_1.layout.toDeviceIndependentPixels(currentBounds.right - currentBounds.left),
            height: view_base_1.layout.toDeviceIndependentPixels(currentBounds.bottom - currentBounds.top),
        };
    };
    ViewCommon.prototype.animate = function (animation) {
        return this.createAnimation(animation).play();
    };
    ViewCommon.prototype.createAnimation = function (animation) {
        ensureAnimationModule();
        if (!this._localAnimations) {
            this._localAnimations = new Set();
        }
        animation.target = this;
        var anim = new animationModule.Animation([animation]);
        this._localAnimations.add(anim);
        return anim;
    };
    ViewCommon.prototype._removeAnimation = function (animation) {
        var localAnimations = this._localAnimations;
        if (localAnimations && localAnimations.has(animation)) {
            localAnimations.delete(animation);
            if (animation.isPlaying) {
                animation.cancel();
            }
            return true;
        }
        return false;
    };
    ViewCommon.prototype.resetNativeView = function () {
        var _this = this;
        if (this._localAnimations) {
            this._localAnimations.forEach(function (a) { return _this._removeAnimation(a); });
        }
        _super.prototype.resetNativeView.call(this);
    };
    ViewCommon.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    ViewCommon.prototype._getValue = function () {
        throw new Error("The View._getValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._setValue = function () {
        throw new Error("The View._setValue is obsolete. There is a new property system.");
    };
    ViewCommon.prototype._updateEffectiveLayoutValues = function (parentWidthMeasureSize, parentWidthMeasureMode, parentHeightMeasureSize, parentHeightMeasureMode) {
        var style = this.style;
        var availableWidth = parentWidthMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentWidthMeasureSize;
        this.effectiveWidth = style_properties_1.PercentLength.toDevicePixels(style.width, -2, availableWidth);
        this.effectiveMarginLeft = style_properties_1.PercentLength.toDevicePixels(style.marginLeft, 0, availableWidth);
        this.effectiveMarginRight = style_properties_1.PercentLength.toDevicePixels(style.marginRight, 0, availableWidth);
        var availableHeight = parentHeightMeasureMode === view_base_1.layout.UNSPECIFIED ? -1 : parentHeightMeasureSize;
        this.effectiveHeight = style_properties_1.PercentLength.toDevicePixels(style.height, -2, availableHeight);
        this.effectiveMarginTop = style_properties_1.PercentLength.toDevicePixels(style.marginTop, 0, availableHeight);
        this.effectiveMarginBottom = style_properties_1.PercentLength.toDevicePixels(style.marginBottom, 0, availableHeight);
    };
    ViewCommon.prototype._setNativeClipToBounds = function () {
    };
    ViewCommon.prototype._redrawNativeBackground = function (value) {
    };
    ViewCommon.prototype._onAttachedToWindow = function () {
    };
    ViewCommon.prototype._onDetachedFromWindow = function () {
    };
    ViewCommon.prototype._hasAncestorView = function (ancestorView) {
        var matcher = function (view) { return view === ancestorView; };
        for (var parent_2 = this.parent; parent_2 != null; parent_2 = parent_2.parent) {
            if (matcher(parent_2)) {
                return true;
            }
        }
        return false;
    };
    ViewCommon.layoutChangedEvent = "layoutChanged";
    ViewCommon.shownModallyEvent = "shownModally";
    ViewCommon.showingModallyEvent = "showingModally";
    return ViewCommon;
}(view_base_1.ViewBase));
exports.ViewCommon = ViewCommon;
exports.automationTextProperty = new view_base_1.Property({ name: "automationText" });
exports.automationTextProperty.register(ViewCommon);
exports.originXProperty = new view_base_1.Property({ name: "originX", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originXProperty.register(ViewCommon);
exports.originYProperty = new view_base_1.Property({ name: "originY", defaultValue: 0.5, valueConverter: function (v) { return parseFloat(v); } });
exports.originYProperty.register(ViewCommon);
exports.isEnabledProperty = new view_base_1.Property({
    name: "isEnabled",
    defaultValue: true,
    valueConverter: view_base_1.booleanConverter,
    valueChanged: function (target, oldValue, newValue) {
        target._goToVisualState(newValue ? "normal" : "disabled");
    }
});
exports.isEnabledProperty.register(ViewCommon);
exports.isUserInteractionEnabledProperty = new view_base_1.Property({ name: "isUserInteractionEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.isUserInteractionEnabledProperty.register(ViewCommon);
exports.iosOverflowSafeAreaProperty = new view_base_1.Property({ name: "iosOverflowSafeArea", defaultValue: false, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaProperty.register(ViewCommon);
exports.iosOverflowSafeAreaEnabledProperty = new view_base_1.InheritedProperty({ name: "iosOverflowSafeAreaEnabled", defaultValue: true, valueConverter: view_base_1.booleanConverter });
exports.iosOverflowSafeAreaEnabledProperty.register(ViewCommon);
//# sourceMappingURL=view-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/view/view.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js"));
var PFLAG_FORCE_LAYOUT = 1;
var PFLAG_MEASURED_DIMENSION_SET = 1 << 1;
var PFLAG_LAYOUT_REQUIRED = 1 << 2;
var majorVersion = utils_1.ios.MajorVersion;
var View = (function (_super) {
    __extends(View, _super);
    function View() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._isLaidOut = false;
        _this._hasTransfrom = false;
        _this._privateFlags = PFLAG_LAYOUT_REQUIRED | PFLAG_FORCE_LAYOUT;
        _this._suspendCATransaction = false;
        return _this;
    }
    Object.defineProperty(View.prototype, "isLayoutRequired", {
        get: function () {
            return (this._privateFlags & PFLAG_LAYOUT_REQUIRED) === PFLAG_LAYOUT_REQUIRED;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(View.prototype, "isLayoutRequested", {
        get: function () {
            return (this._privateFlags & PFLAG_FORCE_LAYOUT) === PFLAG_FORCE_LAYOUT;
        },
        enumerable: true,
        configurable: true
    });
    View.prototype.requestLayout = function () {
        _super.prototype.requestLayout.call(this);
        this._privateFlags |= PFLAG_FORCE_LAYOUT;
        var nativeView = this.nativeViewProtected;
        if (nativeView) {
            nativeView.setNeedsLayout();
        }
        if (this.viewController && this.viewController.view !== nativeView) {
            this.viewController.view.setNeedsLayout();
        }
    };
    View.prototype.measure = function (widthMeasureSpec, heightMeasureSpec) {
        var measureSpecsChanged = this._setCurrentMeasureSpecs(widthMeasureSpec, heightMeasureSpec);
        var forceLayout = (this._privateFlags & PFLAG_FORCE_LAYOUT) === PFLAG_FORCE_LAYOUT;
        if (forceLayout || measureSpecsChanged) {
            this._privateFlags &= ~PFLAG_MEASURED_DIMENSION_SET;
            this.onMeasure(widthMeasureSpec, heightMeasureSpec);
            this._privateFlags |= PFLAG_LAYOUT_REQUIRED;
            if ((this._privateFlags & PFLAG_MEASURED_DIMENSION_SET) !== PFLAG_MEASURED_DIMENSION_SET) {
                throw new Error("onMeasure() did not set the measured dimension by calling setMeasuredDimension() " + this);
            }
        }
    };
    View.prototype.layout = function (left, top, right, bottom, setFrame) {
        if (setFrame === void 0) { setFrame = true; }
        var _a = this._setCurrentLayoutBounds(left, top, right, bottom), boundsChanged = _a.boundsChanged, sizeChanged = _a.sizeChanged;
        if (setFrame) {
            this.layoutNativeView(left, top, right, bottom);
        }
        if (boundsChanged || (this._privateFlags & PFLAG_LAYOUT_REQUIRED) === PFLAG_LAYOUT_REQUIRED) {
            var position = { left: left, top: top, right: right, bottom: bottom };
            if (this.nativeViewProtected && majorVersion > 10) {
                var frame = this.nativeViewProtected.frame;
                position = ios.getPositionFromFrame(frame);
            }
            this.onLayout(position.left, position.top, position.right, position.bottom);
            this._privateFlags &= ~PFLAG_LAYOUT_REQUIRED;
        }
        this.updateBackground(sizeChanged);
        this._privateFlags &= ~PFLAG_FORCE_LAYOUT;
    };
    View.prototype.updateBackground = function (sizeChanged) {
        if (sizeChanged) {
            this._onSizeChanged();
        }
        else if (this._nativeBackgroundState === "invalid") {
            var background = this.style.backgroundInternal;
            this._redrawNativeBackground(background);
        }
    };
    View.prototype.setMeasuredDimension = function (measuredWidth, measuredHeight) {
        _super.prototype.setMeasuredDimension.call(this, measuredWidth, measuredHeight);
        this._privateFlags |= PFLAG_MEASURED_DIMENSION_SET;
    };
    View.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var view = this.nativeViewProtected;
        var width = view_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = view_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = view_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = view_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var nativeWidth = 0;
        var nativeHeight = 0;
        if (view) {
            var nativeSize = view_common_1.layout.measureNativeView(view, width, widthMode, height, heightMode);
            nativeWidth = nativeSize.width;
            nativeHeight = nativeSize.height;
        }
        var measureWidth = Math.max(nativeWidth, this.effectiveMinWidth);
        var measureHeight = Math.max(nativeHeight, this.effectiveMinHeight);
        var widthAndState = View.resolveSizeAndState(measureWidth, width, widthMode, 0);
        var heightAndState = View.resolveSizeAndState(measureHeight, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    View.prototype.onLayout = function (left, top, right, bottom) {
    };
    View.prototype._setNativeViewFrame = function (nativeView, frame) {
        var oldFrame = this._cachedFrame || nativeView.frame;
        if (!CGRectEqualToRect(oldFrame, frame)) {
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(this + " :_setNativeViewFrame: " + JSON.stringify(ios.getPositionFromFrame(frame)), view_common_1.traceCategories.Layout);
            }
            this._cachedFrame = frame;
            var adjustedFrame = null;
            var transform = null;
            if (this._hasTransfrom) {
                transform = nativeView.transform;
                nativeView.transform = CGAffineTransformIdentity;
                nativeView.frame = frame;
            }
            else {
                nativeView.frame = frame;
            }
            adjustedFrame = this.applySafeAreaInsets(frame);
            if (adjustedFrame) {
                nativeView.frame = adjustedFrame;
            }
            if (this._hasTransfrom) {
                nativeView.transform = transform;
            }
            var boundsOrigin = nativeView.bounds.origin;
            var boundsFrame = adjustedFrame || frame;
            nativeView.bounds = CGRectMake(boundsOrigin.x, boundsOrigin.y, boundsFrame.size.width, boundsFrame.size.height);
            this._raiseLayoutChangedEvent();
            this._isLaidOut = true;
        }
        else if (!this._isLaidOut) {
            this._raiseLayoutChangedEvent();
            this._isLaidOut = true;
        }
    };
    Object.defineProperty(View.prototype, "isLayoutValid", {
        get: function () {
            if (this.nativeViewProtected) {
                return this._isLayoutValid;
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    View.prototype.layoutNativeView = function (left, top, right, bottom) {
        if (!this.nativeViewProtected) {
            return;
        }
        var nativeView = this.nativeViewProtected;
        var frame = ios.getFrameFromPosition({ left: left, top: top, right: right, bottom: bottom });
        this._setNativeViewFrame(nativeView, frame);
    };
    View.prototype._setLayoutFlags = function (left, top, right, bottom) {
        var width = right - left;
        var height = bottom - top;
        var widthSpec = view_common_1.layout.makeMeasureSpec(width, view_common_1.layout.EXACTLY);
        var heightSpec = view_common_1.layout.makeMeasureSpec(height, view_common_1.layout.EXACTLY);
        this._setCurrentMeasureSpecs(widthSpec, heightSpec);
        this._privateFlags &= ~PFLAG_FORCE_LAYOUT;
        this.setMeasuredDimension(width, height);
        var sizeChanged = this._setCurrentLayoutBounds(left, top, right, bottom).sizeChanged;
        this.updateBackground(sizeChanged);
        this._privateFlags &= ~PFLAG_LAYOUT_REQUIRED;
    };
    View.prototype.focus = function () {
        if (this.ios) {
            return this.ios.becomeFirstResponder();
        }
        return false;
    };
    View.prototype.applySafeAreaInsets = function (frame) {
        if (majorVersion <= 10) {
            return null;
        }
        if (!this.iosOverflowSafeArea || !this.iosOverflowSafeAreaEnabled) {
            return ios.shrinkToSafeArea(this, frame);
        }
        else if (this.nativeViewProtected && this.nativeViewProtected.window) {
            return ios.expandBeyondSafeArea(this, frame);
        }
        return null;
    };
    View.prototype.getSafeAreaInsets = function () {
        var safeAreaInsets = this.nativeViewProtected && this.nativeViewProtected.safeAreaInsets;
        var insets = { left: 0, top: 0, right: 0, bottom: 0 };
        if (safeAreaInsets) {
            insets.left = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.left));
            insets.top = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.top));
            insets.right = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.right));
            insets.bottom = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaInsets.bottom));
        }
        return insets;
    };
    View.prototype.getLocationInWindow = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.window) {
            return undefined;
        }
        var pointInWindow = this.nativeViewProtected.convertPointToView(this.nativeViewProtected.bounds.origin, null);
        return {
            x: pointInWindow.x,
            y: pointInWindow.y
        };
    };
    View.prototype.getLocationOnScreen = function () {
        if (!this.nativeViewProtected || !this.nativeViewProtected.window) {
            return undefined;
        }
        var pointInWindow = this.nativeViewProtected.convertPointToView(this.nativeViewProtected.bounds.origin, null);
        var pointOnScreen = this.nativeViewProtected.window.convertPointToWindow(pointInWindow, null);
        return {
            x: pointOnScreen.x,
            y: pointOnScreen.y
        };
    };
    View.prototype.getLocationRelativeTo = function (otherView) {
        if (!this.nativeViewProtected || !this.nativeViewProtected.window ||
            !otherView.nativeViewProtected || !otherView.nativeViewProtected.window ||
            this.nativeViewProtected.window !== otherView.nativeViewProtected.window) {
            return undefined;
        }
        var myPointInWindow = this.nativeViewProtected.convertPointToView(this.nativeViewProtected.bounds.origin, null);
        var otherPointInWindow = otherView.nativeViewProtected.convertPointToView(otherView.nativeViewProtected.bounds.origin, null);
        return {
            x: myPointInWindow.x - otherPointInWindow.x,
            y: myPointInWindow.y - otherPointInWindow.y
        };
    };
    View.prototype._onSizeChanged = function () {
        var nativeView = this.nativeViewProtected;
        if (!nativeView) {
            return;
        }
        var background = this.style.backgroundInternal;
        var backgroundDependsOnSize = background.image
            || !background.hasUniformBorder()
            || background.hasBorderRadius();
        if (this._nativeBackgroundState === "invalid" || (this._nativeBackgroundState === "drawn" && backgroundDependsOnSize)) {
            this._redrawNativeBackground(background);
        }
        var clipPath = this.style.clipPath;
        if (clipPath !== "" && this[style_properties_1.clipPathProperty.setNative]) {
            this[style_properties_1.clipPathProperty.setNative](clipPath);
        }
    };
    View.prototype.updateNativeTransform = function () {
        var scaleX = this.scaleX || 1e-6;
        var scaleY = this.scaleY || 1e-6;
        var rotate = this.rotate || 0;
        var newTransform = CGAffineTransformIdentity;
        newTransform = CGAffineTransformTranslate(newTransform, this.translateX, this.translateY);
        newTransform = CGAffineTransformRotate(newTransform, rotate * Math.PI / 180);
        newTransform = CGAffineTransformScale(newTransform, scaleX, scaleY);
        if (!CGAffineTransformEqualToTransform(this.nativeViewProtected.transform, newTransform)) {
            var updateSuspended = this._isPresentationLayerUpdateSuspeneded();
            if (!updateSuspended) {
                CATransaction.begin();
            }
            this.nativeViewProtected.transform = newTransform;
            this._hasTransfrom = this.nativeViewProtected && !CGAffineTransformEqualToTransform(this.nativeViewProtected.transform, CGAffineTransformIdentity);
            if (!updateSuspended) {
                CATransaction.commit();
            }
        }
    };
    View.prototype.updateOriginPoint = function (originX, originY) {
        var newPoint = CGPointMake(originX, originY);
        this.nativeViewProtected.layer.anchorPoint = newPoint;
        if (this._cachedFrame) {
            this._setNativeViewFrame(this.nativeViewProtected, this._cachedFrame);
        }
    };
    View.prototype._suspendPresentationLayerUpdates = function () {
        this._suspendCATransaction = true;
    };
    View.prototype._resumePresentationLayerUpdates = function () {
        this._suspendCATransaction = false;
    };
    View.prototype._isPresentationLayerUpdateSuspeneded = function () {
        return this._suspendCATransaction || this._suspendNativeUpdatesCount;
    };
    View.prototype._showNativeModalView = function (parent, options) {
        var _this = this;
        var parentWithController = ios.getParentWithViewController(parent);
        if (!parentWithController) {
            view_common_1.traceWrite("Could not find parent with viewController for " + parent + " while showing modal view.", view_common_1.traceCategories.ViewHierarchy, view_common_1.traceMessageType.error);
            return;
        }
        var parentController = parentWithController.viewController;
        if (parentController.presentedViewController) {
            view_common_1.traceWrite("Parent is already presenting view controller. Close the current modal page before showing another one!", view_common_1.traceCategories.ViewHierarchy, view_common_1.traceMessageType.error);
            return;
        }
        if (!parentController.view || !parentController.view.window) {
            view_common_1.traceWrite("Parent page is not part of the window hierarchy.", view_common_1.traceCategories.ViewHierarchy, view_common_1.traceMessageType.error);
            return;
        }
        this._setupAsRootView({});
        _super.prototype._showNativeModalView.call(this, parentWithController, options);
        var controller = this.viewController;
        if (!controller) {
            var nativeView = this.ios || this.nativeViewProtected;
            controller = ios.UILayoutViewController.initWithOwner(new WeakRef(this));
            if (nativeView instanceof UIView) {
                controller.view.addSubview(nativeView);
            }
            this.viewController = controller;
        }
        if (options.fullscreen) {
            controller.modalPresentationStyle = 0;
        }
        else {
            controller.modalPresentationStyle = 2;
        }
        if (options.ios && options.ios.presentationStyle) {
            var presentationStyle = options.ios.presentationStyle;
            controller.modalPresentationStyle = presentationStyle;
            if (presentationStyle === 7) {
                var popoverPresentationController = controller.popoverPresentationController;
                this._popoverPresentationDelegate = ios.UIPopoverPresentationControllerDelegateImp.initWithOwnerAndCallback(new WeakRef(this), this._closeModalCallback);
                popoverPresentationController.delegate = this._popoverPresentationDelegate;
                var view = parent.nativeViewProtected;
                popoverPresentationController.sourceView = view;
                popoverPresentationController.sourceRect = CGRectMake(0, 0, view.frame.size.width, view.frame.size.height);
            }
        }
        this.horizontalAlignment = "stretch";
        this.verticalAlignment = "stretch";
        this._raiseShowingModallyEvent();
        var animated = options.animated === undefined ? true : !!options.animated;
        controller.animated = animated;
        parentController.presentViewControllerAnimatedCompletion(controller, animated, null);
        var transitionCoordinator = parentController.transitionCoordinator;
        if (transitionCoordinator) {
            UIViewControllerTransitionCoordinator.prototype.animateAlongsideTransitionCompletion
                .call(transitionCoordinator, null, function () { return _this._raiseShownModallyEvent(); });
        }
        else {
            this._raiseShownModallyEvent();
        }
    };
    View.prototype._hideNativeModalView = function (parent, whenClosedCallback) {
        if (!parent || !parent.viewController) {
            view_common_1.traceError("Trying to hide modal view but no parent with viewController specified.");
            return;
        }
        if (!parent.viewController.presentedViewController) {
            whenClosedCallback();
            return;
        }
        var parentController = parent.viewController;
        var animated = this.viewController.animated;
        parentController.dismissViewControllerAnimatedCompletion(animated, whenClosedCallback);
    };
    View.prototype[view_common_1.isEnabledProperty.getDefault] = function () {
        var nativeView = this.nativeViewProtected;
        return nativeView instanceof UIControl ? nativeView.enabled : true;
    };
    View.prototype[view_common_1.isEnabledProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        if (nativeView instanceof UIControl) {
            nativeView.enabled = value;
        }
    };
    View.prototype[view_common_1.originXProperty.getDefault] = function () {
        return this.nativeViewProtected.layer.anchorPoint.x;
    };
    View.prototype[view_common_1.originXProperty.setNative] = function (value) {
        this.updateOriginPoint(value, this.originY);
    };
    View.prototype[view_common_1.originYProperty.getDefault] = function () {
        return this.nativeViewProtected.layer.anchorPoint.y;
    };
    View.prototype[view_common_1.originYProperty.setNative] = function (value) {
        this.updateOriginPoint(this.originX, value);
    };
    View.prototype[view_common_1.automationTextProperty.getDefault] = function () {
        return this.nativeViewProtected.accessibilityLabel;
    };
    View.prototype[view_common_1.automationTextProperty.setNative] = function (value) {
        this.nativeViewProtected.accessibilityIdentifier = value;
        this.nativeViewProtected.accessibilityLabel = value;
    };
    View.prototype[view_common_1.isUserInteractionEnabledProperty.getDefault] = function () {
        return this.nativeViewProtected.userInteractionEnabled;
    };
    View.prototype[view_common_1.isUserInteractionEnabledProperty.setNative] = function (value) {
        this.nativeViewProtected.userInteractionEnabled = value;
    };
    View.prototype[style_properties_1.visibilityProperty.getDefault] = function () {
        return this.nativeViewProtected.hidden ? style_properties_1.Visibility.COLLAPSE : style_properties_1.Visibility.VISIBLE;
    };
    View.prototype[style_properties_1.visibilityProperty.setNative] = function (value) {
        switch (value) {
            case style_properties_1.Visibility.VISIBLE:
                this.nativeViewProtected.hidden = false;
                break;
            case style_properties_1.Visibility.HIDDEN:
            case style_properties_1.Visibility.COLLAPSE:
                this.nativeViewProtected.hidden = true;
                break;
            default:
                throw new Error("Invalid visibility value: " + value + ". Valid values are: \"" + style_properties_1.Visibility.VISIBLE + "\", \"" + style_properties_1.Visibility.HIDDEN + "\", \"" + style_properties_1.Visibility.COLLAPSE + "\".");
        }
    };
    View.prototype[style_properties_1.opacityProperty.getDefault] = function () {
        return this.nativeViewProtected.alpha;
    };
    View.prototype[style_properties_1.opacityProperty.setNative] = function (value) {
        var nativeView = this.nativeViewProtected;
        var updateSuspended = this._isPresentationLayerUpdateSuspeneded();
        if (!updateSuspended) {
            CATransaction.begin();
        }
        nativeView.alpha = value;
        if (!updateSuspended) {
            CATransaction.commit();
        }
    };
    View.prototype[style_properties_1.rotateProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.rotateProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.scaleXProperty.getDefault] = function () {
        return 1;
    };
    View.prototype[style_properties_1.scaleXProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.scaleYProperty.getDefault] = function () {
        return 1;
    };
    View.prototype[style_properties_1.scaleYProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.translateXProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.translateXProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.translateYProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.translateYProperty.setNative] = function (value) {
        this.updateNativeTransform();
    };
    View.prototype[style_properties_1.zIndexProperty.getDefault] = function () {
        return 0;
    };
    View.prototype[style_properties_1.zIndexProperty.setNative] = function (value) {
        this.nativeViewProtected.layer.zPosition = value;
    };
    View.prototype[style_properties_1.backgroundInternalProperty.getDefault] = function () {
        return this.nativeViewProtected.backgroundColor;
    };
    View.prototype[style_properties_1.backgroundInternalProperty.setNative] = function (value) {
        this._nativeBackgroundState = "invalid";
        if (this.isLayoutValid) {
            this._redrawNativeBackground(value);
        }
    };
    View.prototype._getCurrentLayoutBounds = function () {
        var nativeView = this.nativeViewProtected;
        if (nativeView && !this.isCollapsed) {
            var frame = nativeView.frame;
            var origin_1 = frame.origin;
            var size = frame.size;
            return {
                left: Math.round(view_common_1.layout.toDevicePixels(origin_1.x)),
                top: Math.round(view_common_1.layout.toDevicePixels(origin_1.y)),
                right: Math.round(view_common_1.layout.toDevicePixels(origin_1.x + size.width)),
                bottom: Math.round(view_common_1.layout.toDevicePixels(origin_1.y + size.height))
            };
        }
        else {
            return { left: 0, top: 0, right: 0, bottom: 0 };
        }
    };
    View.prototype._redrawNativeBackground = function (value) {
        var _this = this;
        var updateSuspended = this._isPresentationLayerUpdateSuspeneded();
        if (!updateSuspended) {
            CATransaction.begin();
        }
        if (value instanceof UIColor) {
            this.nativeViewProtected.backgroundColor = value;
        }
        else {
            background_1.ios.createBackgroundUIColor(this, function (color) {
                _this.nativeViewProtected.backgroundColor = color;
            });
            this._setNativeClipToBounds();
        }
        if (!updateSuspended) {
            CATransaction.commit();
        }
        this._nativeBackgroundState = "drawn";
    };
    View.prototype._setNativeClipToBounds = function () {
        var backgroundInternal = this.style.backgroundInternal;
        this.nativeViewProtected.clipsToBounds =
            this.nativeViewProtected instanceof UIScrollView ||
                backgroundInternal.hasBorderWidth() ||
                backgroundInternal.hasBorderRadius();
    };
    __decorate([
        profiling_1.profile
    ], View.prototype, "layout", null);
    __decorate([
        profiling_1.profile
    ], View.prototype, "onMeasure", null);
    return View;
}(view_common_1.ViewCommon));
exports.View = View;
View.prototype._nativeBackgroundState = "unset";
var ContainerView = (function (_super) {
    __extends(ContainerView, _super);
    function ContainerView() {
        var _this = _super.call(this) || this;
        _this.iosOverflowSafeArea = true;
        return _this;
    }
    return ContainerView;
}(View));
exports.ContainerView = ContainerView;
var CustomLayoutView = (function (_super) {
    __extends(CustomLayoutView, _super);
    function CustomLayoutView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    CustomLayoutView.prototype.createNativeView = function () {
        return UIView.alloc().initWithFrame(UIScreen.mainScreen.bounds);
    };
    Object.defineProperty(CustomLayoutView.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    CustomLayoutView.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
    };
    CustomLayoutView.prototype._addViewToNativeVisualTree = function (child, atIndex) {
        _super.prototype._addViewToNativeVisualTree.call(this, child, atIndex);
        var parentNativeView = this.nativeViewProtected;
        var childNativeView = child.nativeViewProtected;
        if (parentNativeView && childNativeView) {
            if (typeof atIndex !== "number" || atIndex >= parentNativeView.subviews.count) {
                parentNativeView.addSubview(childNativeView);
            }
            else {
                parentNativeView.insertSubviewAtIndex(childNativeView, atIndex);
            }
            return true;
        }
        return false;
    };
    CustomLayoutView.prototype._removeViewFromNativeVisualTree = function (child) {
        _super.prototype._removeViewFromNativeVisualTree.call(this, child);
        if (child.nativeViewProtected) {
            child.nativeViewProtected.removeFromSuperview();
        }
    };
    return CustomLayoutView;
}(ContainerView));
exports.CustomLayoutView = CustomLayoutView;
var ios;
(function (ios) {
    function getParentWithViewController(view) {
        while (view && !view.viewController) {
            view = view.parent;
        }
        return view;
    }
    ios.getParentWithViewController = getParentWithViewController;
    function updateAutoAdjustScrollInsets(controller, owner) {
        if (majorVersion <= 10) {
            owner._automaticallyAdjustsScrollViewInsets = false;
            controller.automaticallyAdjustsScrollViewInsets = false;
        }
    }
    ios.updateAutoAdjustScrollInsets = updateAutoAdjustScrollInsets;
    function updateConstraints(controller, owner) {
        if (majorVersion <= 10) {
            var layoutGuide = initLayoutGuide(controller);
            controller.view.safeAreaLayoutGuide = layoutGuide;
        }
    }
    ios.updateConstraints = updateConstraints;
    function initLayoutGuide(controller) {
        var rootView = controller.view;
        var layoutGuide = UILayoutGuide.alloc().init();
        rootView.addLayoutGuide(layoutGuide);
        NSLayoutConstraint.activateConstraints([
            layoutGuide.topAnchor.constraintEqualToAnchor(controller.topLayoutGuide.bottomAnchor),
            layoutGuide.bottomAnchor.constraintEqualToAnchor(controller.bottomLayoutGuide.topAnchor),
            layoutGuide.leadingAnchor.constraintEqualToAnchor(rootView.leadingAnchor),
            layoutGuide.trailingAnchor.constraintEqualToAnchor(rootView.trailingAnchor)
        ]);
        return layoutGuide;
    }
    function layoutView(controller, owner) {
        var layoutGuide = controller.view.safeAreaLayoutGuide;
        if (!layoutGuide) {
            view_common_1.traceWrite("safeAreaLayoutGuide during layout of " + owner + ". Creating fallback constraints, but layout might be wrong.", view_common_1.traceCategories.Layout, view_common_1.traceMessageType.error);
            layoutGuide = initLayoutGuide(controller);
        }
        var safeArea = layoutGuide.layoutFrame;
        var position = ios.getPositionFromFrame(safeArea);
        var safeAreaSize = safeArea.size;
        var hasChildViewControllers = controller.childViewControllers.count > 0;
        if (hasChildViewControllers) {
            var fullscreen = controller.view.frame;
            position = ios.getPositionFromFrame(fullscreen);
        }
        var safeAreaWidth = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaSize.width));
        var safeAreaHeight = view_common_1.layout.round(view_common_1.layout.toDevicePixels(safeAreaSize.height));
        var widthSpec = view_common_1.layout.makeMeasureSpec(safeAreaWidth, view_common_1.layout.EXACTLY);
        var heightSpec = view_common_1.layout.makeMeasureSpec(safeAreaHeight, view_common_1.layout.EXACTLY);
        View.measureChild(null, owner, widthSpec, heightSpec);
        View.layoutChild(null, owner, position.left, position.top, position.right, position.bottom);
        layoutParent(owner.parent);
    }
    ios.layoutView = layoutView;
    function getPositionFromFrame(frame) {
        var left = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.x));
        var top = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.y));
        var right = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.x + frame.size.width));
        var bottom = view_common_1.layout.round(view_common_1.layout.toDevicePixels(frame.origin.y + frame.size.height));
        return { left: left, right: right, top: top, bottom: bottom };
    }
    ios.getPositionFromFrame = getPositionFromFrame;
    function getFrameFromPosition(position, insets) {
        insets = insets || { left: 0, top: 0, right: 0, bottom: 0 };
        var left = view_common_1.layout.toDeviceIndependentPixels(position.left + insets.left);
        var top = view_common_1.layout.toDeviceIndependentPixels(position.top + insets.top);
        var width = view_common_1.layout.toDeviceIndependentPixels(position.right - position.left - insets.left - insets.right);
        var height = view_common_1.layout.toDeviceIndependentPixels(position.bottom - position.top - insets.top - insets.bottom);
        return CGRectMake(left, top, width, height);
    }
    ios.getFrameFromPosition = getFrameFromPosition;
    function shrinkToSafeArea(view, frame) {
        var insets = view.getSafeAreaInsets();
        if (insets.left || insets.top) {
            var position = ios.getPositionFromFrame(frame);
            var adjustedFrame = ios.getFrameFromPosition(position, insets);
            if (view_common_1.traceEnabled()) {
                view_common_1.traceWrite(this + " :shrinkToSafeArea: " + JSON.stringify(ios.getPositionFromFrame(adjustedFrame)), view_common_1.traceCategories.Layout);
            }
            return adjustedFrame;
        }
        return null;
    }
    ios.shrinkToSafeArea = shrinkToSafeArea;
    function expandBeyondSafeArea(view, frame) {
        var availableSpace = getAvailableSpaceFromParent(view, frame);
        var safeArea = availableSpace.safeArea;
        var fullscreen = availableSpace.fullscreen;
        var inWindow = availableSpace.inWindow;
        var position = ios.getPositionFromFrame(frame);
        var safeAreaPosition = ios.getPositionFromFrame(safeArea);
        var fullscreenPosition = ios.getPositionFromFrame(fullscreen);
        var inWindowPosition = ios.getPositionFromFrame(inWindow);
        var adjustedPosition = position;
        if (position.left && inWindowPosition.left <= safeAreaPosition.left) {
            adjustedPosition.left = fullscreenPosition.left;
        }
        if (position.top && inWindowPosition.top <= safeAreaPosition.top) {
            adjustedPosition.top = fullscreenPosition.top;
        }
        if (inWindowPosition.right < fullscreenPosition.right && inWindowPosition.right >= safeAreaPosition.right + fullscreenPosition.left) {
            adjustedPosition.right += fullscreenPosition.right - inWindowPosition.right;
        }
        if (inWindowPosition.bottom < fullscreenPosition.bottom && inWindowPosition.bottom >= safeAreaPosition.bottom + fullscreenPosition.top) {
            adjustedPosition.bottom += fullscreenPosition.bottom - inWindowPosition.bottom;
        }
        var adjustedFrame = CGRectMake(view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.left), view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.top), view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.right - adjustedPosition.left), view_common_1.layout.toDeviceIndependentPixels(adjustedPosition.bottom - adjustedPosition.top));
        if (view_common_1.traceEnabled()) {
            view_common_1.traceWrite(view + " :expandBeyondSafeArea: " + JSON.stringify(ios.getPositionFromFrame(adjustedFrame)), view_common_1.traceCategories.Layout);
        }
        return adjustedFrame;
    }
    ios.expandBeyondSafeArea = expandBeyondSafeArea;
    function layoutParent(view) {
        if (!view) {
            return;
        }
        if (view instanceof View && view.nativeViewProtected) {
            var frame = view.nativeViewProtected.frame;
            var origin_2 = frame.origin;
            var size = frame.size;
            var left = view_common_1.layout.toDevicePixels(origin_2.x);
            var top_1 = view_common_1.layout.toDevicePixels(origin_2.y);
            var width = view_common_1.layout.toDevicePixels(size.width);
            var height = view_common_1.layout.toDevicePixels(size.height);
            view._setLayoutFlags(left, top_1, width + left, height + top_1);
        }
        layoutParent(view.parent);
    }
    function getAvailableSpaceFromParent(view, frame) {
        if (!view) {
            return;
        }
        var scrollView = null;
        var viewControllerView = null;
        if (view.viewController) {
            viewControllerView = view.viewController.view;
        }
        else {
            var parent_1 = view.parent;
            while (parent_1 && !parent_1.viewController && !(parent_1.nativeViewProtected instanceof UIScrollView)) {
                parent_1 = parent_1.parent;
            }
            if (parent_1.nativeViewProtected instanceof UIScrollView) {
                scrollView = parent_1.nativeViewProtected;
            }
            else if (parent_1.viewController) {
                viewControllerView = parent_1.viewController.view;
            }
        }
        var fullscreen = null;
        var safeArea = null;
        if (viewControllerView) {
            safeArea = viewControllerView.safeAreaLayoutGuide.layoutFrame;
            fullscreen = viewControllerView.frame;
        }
        else if (scrollView) {
            var insets = scrollView.safeAreaInsets;
            safeArea = CGRectMake(insets.left, insets.top, scrollView.contentSize.width - insets.left - insets.right, scrollView.contentSize.height - insets.top - insets.bottom);
            fullscreen = CGRectMake(0, 0, scrollView.contentSize.width, scrollView.contentSize.height);
        }
        var locationInWindow = view.getLocationInWindow();
        var inWindowLeft = locationInWindow.x;
        var inWindowTop = locationInWindow.y;
        if (scrollView) {
            inWindowLeft += scrollView.contentOffset.x;
            inWindowTop += scrollView.contentOffset.y;
        }
        var inWindow = CGRectMake(inWindowLeft, inWindowTop, frame.size.width, frame.size.height);
        return { safeArea: safeArea, fullscreen: fullscreen, inWindow: inWindow };
    }
    var UILayoutViewController = (function (_super) {
        __extends(UILayoutViewController, _super);
        function UILayoutViewController() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        UILayoutViewController.initWithOwner = function (owner) {
            var controller = UILayoutViewController.new();
            controller.owner = owner;
            return controller;
        };
        UILayoutViewController.prototype.viewDidLoad = function () {
            _super.prototype.viewDidLoad.call(this);
            this.extendedLayoutIncludesOpaqueBars = true;
        };
        UILayoutViewController.prototype.viewWillLayoutSubviews = function () {
            _super.prototype.viewWillLayoutSubviews.call(this);
            var owner = this.owner.get();
            if (owner) {
                updateConstraints(this, owner);
            }
        };
        UILayoutViewController.prototype.viewDidLayoutSubviews = function () {
            _super.prototype.viewDidLayoutSubviews.call(this);
            var owner = this.owner.get();
            if (owner) {
                if (majorVersion >= 11) {
                    var tabViewItem = owner.parent;
                    var tabView = tabViewItem && tabViewItem.parent;
                    var parent_2 = tabView && tabView.parent;
                    while (parent_2 && !parent_2.nativeViewProtected) {
                        parent_2 = parent_2.parent;
                    }
                    if (parent_2) {
                        var parentPageInsetsTop = parent_2.nativeViewProtected.safeAreaInsets.top;
                        var currentInsetsTop = this.view.safeAreaInsets.top;
                        var additionalInsetsTop = Math.max(parentPageInsetsTop - currentInsetsTop, 0);
                        var parentPageInsetsBottom = parent_2.nativeViewProtected.safeAreaInsets.bottom;
                        var currentInsetsBottom = this.view.safeAreaInsets.bottom;
                        var additionalInsetsBottom = Math.max(parentPageInsetsBottom - currentInsetsBottom, 0);
                        if (additionalInsetsTop > 0 || additionalInsetsBottom > 0) {
                            var additionalInsets = new UIEdgeInsets({ top: additionalInsetsTop, left: 0, bottom: additionalInsetsBottom, right: 0 });
                            this.additionalSafeAreaInsets = additionalInsets;
                        }
                    }
                }
                layoutView(this, owner);
            }
        };
        UILayoutViewController.prototype.viewWillAppear = function (animated) {
            _super.prototype.viewWillAppear.call(this, animated);
            var owner = this.owner.get();
            if (!owner) {
                return;
            }
            updateAutoAdjustScrollInsets(this, owner);
            if (!owner.parent) {
                owner.callLoaded();
            }
        };
        UILayoutViewController.prototype.viewDidDisappear = function (animated) {
            _super.prototype.viewDidDisappear.call(this, animated);
            var owner = this.owner.get();
            if (owner && !owner.parent) {
                owner.callUnloaded();
            }
        };
        return UILayoutViewController;
    }(UIViewController));
    ios.UILayoutViewController = UILayoutViewController;
    var UIPopoverPresentationControllerDelegateImp = (function (_super) {
        __extends(UIPopoverPresentationControllerDelegateImp, _super);
        function UIPopoverPresentationControllerDelegateImp() {
            return _super !== null && _super.apply(this, arguments) || this;
        }
        UIPopoverPresentationControllerDelegateImp.initWithOwnerAndCallback = function (owner, whenClosedCallback) {
            var instance = _super.new.call(this);
            instance.owner = owner;
            instance.closedCallback = whenClosedCallback;
            return instance;
        };
        UIPopoverPresentationControllerDelegateImp.prototype.popoverPresentationControllerDidDismissPopover = function (popoverPresentationController) {
            var owner = this.owner.get();
            if (owner && typeof this.closedCallback === "function") {
                this.closedCallback();
            }
        };
        UIPopoverPresentationControllerDelegateImp.ObjCProtocols = [UIPopoverPresentationControllerDelegate];
        return UIPopoverPresentationControllerDelegateImp;
    }(NSObject));
    ios.UIPopoverPresentationControllerDelegateImp = UIPopoverPresentationControllerDelegateImp;
})(ios = exports.ios || (exports.ios = {}));
//# sourceMappingURL=view.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/core/weak-event-listener/weak-event-listener.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var handlersForEventName = new Map();
var sourcesMap = new WeakMap();
var TargetHandlerPair = (function () {
    function TargetHandlerPair(target, handler) {
        this.tagetRef = new WeakRef(target);
        this.handler = handler;
    }
    return TargetHandlerPair;
}());
function getHandlerForEventName(eventName) {
    var handler = handlersForEventName.get(eventName);
    if (!handler) {
        handler = function (eventData) {
            var source = eventData.object;
            var sourceEventMap = sourcesMap.get(source);
            if (!sourceEventMap) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                return;
            }
            var targetHandlerPairList = sourceEventMap.get(eventName);
            if (!targetHandlerPairList) {
                return;
            }
            var deadPairsIndexes = [];
            var pair;
            var target;
            for (var i = 0; i < targetHandlerPairList.length; i++) {
                pair = targetHandlerPairList[i];
                target = pair.tagetRef.get();
                if (target) {
                    pair.handler.call(target, eventData);
                }
                else {
                    deadPairsIndexes.push(i);
                }
            }
            if (deadPairsIndexes.length === targetHandlerPairList.length) {
                source.removeEventListener(eventName, handlersForEventName.get(eventName));
                sourceEventMap.delete(eventName);
            }
            else {
                for (var j = deadPairsIndexes.length - 1; j >= 0; j--) {
                    targetHandlerPairList.splice(deadPairsIndexes[j], 1);
                }
            }
        };
        handlersForEventName.set(eventName, handler);
    }
    return handler;
}
function validateArgs(source, eventName, handler, target) {
    if (!source) {
        throw new Error("source is null or undefined");
    }
    if (!target) {
        throw new Error("target is null or undefined");
    }
    if (typeof eventName !== "string") {
        throw new Error("eventName is not a string");
    }
    if (typeof handler !== "function") {
        throw new Error("handler is not a function");
    }
}
function addWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var shouldAttach = false;
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        sourceEventMap = new Map();
        sourcesMap.set(source, sourceEventMap);
        shouldAttach = true;
    }
    var pairList = sourceEventMap.get(eventName);
    if (!pairList) {
        pairList = new Array();
        sourceEventMap.set(eventName, pairList);
        shouldAttach = true;
    }
    pairList.push(new TargetHandlerPair(target, handler));
    if (shouldAttach) {
        source.addEventListener(eventName, getHandlerForEventName(eventName));
    }
}
exports.addWeakEventListener = addWeakEventListener;
function removeWeakEventListener(source, eventName, handler, target) {
    validateArgs(source, eventName, handler, target);
    var handlerForEventWithName = handlersForEventName.get(eventName);
    if (!handlerForEventWithName) {
        return;
    }
    var sourceEventMap = sourcesMap.get(source);
    if (!sourceEventMap) {
        return;
    }
    var targetHandlerPairList = sourceEventMap.get(eventName);
    if (!targetHandlerPairList) {
        return;
    }
    var targetHandlerPairsToRemove = [];
    var pair;
    var registeredTarget;
    for (var i = 0; i < targetHandlerPairList.length; i++) {
        pair = targetHandlerPairList[i];
        registeredTarget = pair.tagetRef.get();
        if (!registeredTarget || (registeredTarget === target && handler === pair.handler)) {
            targetHandlerPairsToRemove.push(i);
        }
    }
    if (targetHandlerPairsToRemove.length === targetHandlerPairList.length) {
        source.removeEventListener(eventName, handlerForEventWithName);
        sourceEventMap.delete(eventName);
    }
    else {
        for (var j = targetHandlerPairsToRemove.length - 1; j >= 0; j--) {
            targetHandlerPairList.splice(targetHandlerPairsToRemove[j], 1);
        }
    }
}
exports.removeWeakEventListener = removeWeakEventListener;
//# sourceMappingURL=weak-event-listener.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
exports.STRING = "string";
exports.PROMPT = "Prompt";
exports.CONFIRM = "Confirm";
exports.ALERT = "Alert";
exports.LOGIN = "Login";
exports.OK = "OK";
exports.CANCEL = "Cancel";
var inputType;
(function (inputType) {
    inputType.text = "text";
    inputType.password = "password";
    inputType.email = "email";
    inputType.number = "number";
    inputType.decimal = "decimal";
    inputType.phone = "phone";
})(inputType = exports.inputType || (exports.inputType = {}));
var capitalizationType;
(function (capitalizationType) {
    capitalizationType.none = "none";
    capitalizationType.all = "all";
    capitalizationType.sentences = "sentences";
    capitalizationType.words = "words";
})(capitalizationType = exports.capitalizationType || (exports.capitalizationType = {}));
var frame;
function getCurrentPage() {
    if (!frame) {
        frame = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame.js");
    }
    var topmostFrame = frame.topmost();
    if (topmostFrame) {
        return topmostFrame.currentPage;
    }
    return undefined;
}
exports.getCurrentPage = getCurrentPage;
function applySelectors(view, callback) {
    var currentPage = getCurrentPage();
    if (currentPage) {
        var styleScope = currentPage._styleScope;
        if (styleScope) {
            view._inheritStyleScope(styleScope);
            view.onLoaded();
            callback(view);
            view.onUnloaded();
        }
    }
}
var button;
var label;
var textField;
function getButtonColors() {
    if (!button) {
        var Button = __webpack_require__("../node_modules/tns-core-modules/ui/button/button.js").Button;
        button = new Button;
        if (platform_1.isIOS) {
            button._setupUI({});
        }
    }
    var buttonColor;
    var buttonBackgroundColor;
    applySelectors(button, function (btn) {
        buttonColor = btn.color;
        buttonBackgroundColor = btn.backgroundColor;
    });
    return { color: buttonColor, backgroundColor: buttonBackgroundColor };
}
exports.getButtonColors = getButtonColors;
function getLabelColor() {
    if (!label) {
        var Label = __webpack_require__("../node_modules/tns-core-modules/ui/label/label.js").Label;
        label = new Label;
        if (platform_1.isIOS) {
            label._setupUI({});
        }
    }
    var labelColor;
    applySelectors(label, function (lbl) {
        labelColor = lbl.color;
    });
    return labelColor;
}
exports.getLabelColor = getLabelColor;
function getTextFieldColor() {
    if (!textField) {
        var TextField = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field.js").TextField;
        textField = new TextField();
        if (platform_1.isIOS) {
            textField._setupUI({});
        }
    }
    var textFieldColor;
    applySelectors(textField, function (tf) {
        textFieldColor = tf.color;
    });
    return textFieldColor;
}
exports.getTextFieldColor = getTextFieldColor;
function isDialogOptions(arg) {
    return arg && (arg.message || arg.title);
}
exports.isDialogOptions = isDialogOptions;
function parseLoginOptions(args) {
    if (args.length === 1 && types_1.isObject(args[0])) {
        return args[0];
    }
    var options = { title: exports.LOGIN, okButtonText: exports.OK, cancelButtonText: exports.CANCEL };
    if (types_1.isString(args[0])) {
        options.message = args[0];
    }
    if (types_1.isString(args[1])) {
        options.userNameHint = args[1];
    }
    if (types_1.isString(args[2])) {
        options.passwordHint = args[2];
    }
    if (types_1.isString(args[3])) {
        options.userName = args[3];
    }
    if (types_1.isString(args[4])) {
        options.password = args[4];
    }
    return options;
}
exports.parseLoginOptions = parseLoginOptions;
//# sourceMappingURL=dialogs-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/dialogs/dialogs.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var dialogs_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var application_1 = __webpack_require__("../node_modules/tns-core-modules/application/application.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/dialogs/dialogs-common.js"));
function addButtonsToAlertController(alertController, options, callback) {
    if (!options) {
        return;
    }
    if (types_1.isString(options.cancelButtonText)) {
        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.cancelButtonText, 0, function () {
            raiseCallback(callback, false);
        }));
    }
    if (types_1.isString(options.neutralButtonText)) {
        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.neutralButtonText, 0, function () {
            raiseCallback(callback, undefined);
        }));
    }
    if (types_1.isString(options.okButtonText)) {
        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.okButtonText, 0, function () {
            raiseCallback(callback, true);
        }));
    }
}
function raiseCallback(callback, result) {
    if (types_1.isFunction(callback)) {
        callback(result);
    }
}
function alert(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.ALERT, okButtonText: dialogs_common_1.OK, message: arg + "" } : arg;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            addButtonsToAlertController(alertController, options, function () { resolve(); });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.alert = alert;
function confirm(arg) {
    return new Promise(function (resolve, reject) {
        try {
            var options = !dialogs_common_1.isDialogOptions(arg) ? { title: dialogs_common_1.CONFIRM, okButtonText: dialogs_common_1.OK, cancelButtonText: dialogs_common_1.CANCEL, message: arg + "" } : arg;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            addButtonsToAlertController(alertController, options, function (r) { resolve(r); });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.confirm = confirm;
function prompt(arg) {
    var options;
    var defaultOptions = {
        title: dialogs_common_1.PROMPT,
        okButtonText: dialogs_common_1.OK,
        cancelButtonText: dialogs_common_1.CANCEL,
        inputType: dialogs_common_1.inputType.text,
    };
    if (arguments.length === 1) {
        if (types_1.isString(arg)) {
            options = defaultOptions;
            options.message = arg;
        }
        else {
            options = arg;
        }
    }
    else if (arguments.length === 2) {
        if (types_1.isString(arguments[0]) && types_1.isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.defaultText = arguments[1];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var textField_1;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            alertController.addTextFieldWithConfigurationHandler(function (arg) {
                arg.text = types_1.isString(options.defaultText) ? options.defaultText : "";
                arg.secureTextEntry = options && options.inputType === dialogs_common_1.inputType.password;
                if (options && options.inputType === dialogs_common_1.inputType.email) {
                    arg.keyboardType = 7;
                }
                else if (options && options.inputType === dialogs_common_1.inputType.number) {
                    arg.keyboardType = 4;
                }
                else if (options && options.inputType === dialogs_common_1.inputType.decimal) {
                    arg.keyboardType = 8;
                }
                else if (options && options.inputType === dialogs_common_1.inputType.phone) {
                    arg.keyboardType = 5;
                }
                var color = dialogs_common_1.getTextFieldColor();
                if (color) {
                    arg.textColor = arg.tintColor = color.ios;
                }
            });
            textField_1 = alertController.textFields.firstObject;
            if (options) {
                switch (options.capitalizationType) {
                    case dialogs_common_1.capitalizationType.all: {
                        textField_1.autocapitalizationType = 3;
                        break;
                    }
                    case dialogs_common_1.capitalizationType.sentences: {
                        textField_1.autocapitalizationType = 2;
                        break;
                    }
                    case dialogs_common_1.capitalizationType.words: {
                        textField_1.autocapitalizationType = 1;
                        break;
                    }
                    default: {
                        textField_1.autocapitalizationType = 0;
                    }
                }
            }
            addButtonsToAlertController(alertController, options, function (r) { resolve({ result: r, text: textField_1.text }); });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.prompt = prompt;
function login() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    var options = dialogs_common_1.parseLoginOptions(args);
    return new Promise(function (resolve, reject) {
        try {
            var userNameTextField_1;
            var passwordTextField_1;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 1);
            var textFieldColor_1 = dialogs_common_1.getTextFieldColor();
            alertController.addTextFieldWithConfigurationHandler(function (arg) {
                arg.placeholder = "Login";
                arg.placeholder = options.userNameHint ? options.userNameHint : "";
                arg.text = types_1.isString(options.userName) ? options.userName : "";
                if (textFieldColor_1) {
                    arg.textColor = arg.tintColor = textFieldColor_1.ios;
                }
            });
            alertController.addTextFieldWithConfigurationHandler(function (arg) {
                arg.placeholder = "Password";
                arg.secureTextEntry = true;
                arg.placeholder = options.passwordHint ? options.passwordHint : "";
                arg.text = types_1.isString(options.password) ? options.password : "";
                if (textFieldColor_1) {
                    arg.textColor = arg.tintColor = textFieldColor_1.ios;
                }
            });
            userNameTextField_1 = alertController.textFields.firstObject;
            passwordTextField_1 = alertController.textFields.lastObject;
            addButtonsToAlertController(alertController, options, function (r) {
                resolve({
                    result: r,
                    userName: userNameTextField_1.text,
                    password: passwordTextField_1.text
                });
            });
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.login = login;
function showUIAlertController(alertController) {
    var _a, _b;
    var currentView = dialogs_common_1.getCurrentPage() || application_1.getRootView();
    if (currentView) {
        currentView = currentView.modal || currentView;
        var viewController = currentView.ios;
        if (!(currentView.ios instanceof UIViewController)) {
            var parentWithController = view_1.ios.getParentWithViewController(currentView);
            viewController = parentWithController ? parentWithController.viewController : undefined;
        }
        if (viewController) {
            if (alertController.popoverPresentationController) {
                alertController.popoverPresentationController.sourceView = viewController.view;
                alertController.popoverPresentationController.sourceRect = CGRectMake(viewController.view.bounds.size.width / 2.0, viewController.view.bounds.size.height / 2.0, 1.0, 1.0);
                alertController.popoverPresentationController.permittedArrowDirections = 0;
            }
            var color = dialogs_common_1.getButtonColors().color;
            if (color) {
                alertController.view.tintColor = color.ios;
            }
            var lblColor = dialogs_common_1.getLabelColor();
            if (lblColor) {
                if (alertController.title) {
                    var title = NSAttributedString.alloc().initWithStringAttributes(alertController.title, (_a = {}, _a[NSForegroundColorAttributeName] = lblColor.ios, _a));
                    alertController.setValueForKey(title, "attributedTitle");
                }
                if (alertController.message) {
                    var message = NSAttributedString.alloc().initWithStringAttributes(alertController.message, (_b = {}, _b[NSForegroundColorAttributeName] = lblColor.ios, _b));
                    alertController.setValueForKey(message, "attributedMessage");
                }
            }
            viewController.presentModalViewControllerAnimated(alertController, true);
        }
    }
}
function action() {
    var options;
    var defaultOptions = { title: null, cancelButtonText: dialogs_common_1.CANCEL };
    if (arguments.length === 1) {
        if (types_1.isString(arguments[0])) {
            options = defaultOptions;
            options.message = arguments[0];
        }
        else {
            options = arguments[0];
        }
    }
    else if (arguments.length === 2) {
        if (types_1.isString(arguments[0]) && types_1.isString(arguments[1])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
        }
    }
    else if (arguments.length === 3) {
        if (types_1.isString(arguments[0]) && types_1.isString(arguments[1]) && types_1.isDefined(arguments[2])) {
            options = defaultOptions;
            options.message = arguments[0];
            options.cancelButtonText = arguments[1];
            options.actions = arguments[2];
        }
    }
    return new Promise(function (resolve, reject) {
        try {
            var i = void 0;
            var action_1;
            var alertController = UIAlertController.alertControllerWithTitleMessagePreferredStyle(options.title, options.message, 0);
            if (options.actions) {
                for (i = 0; i < options.actions.length; i++) {
                    action_1 = options.actions[i];
                    if (types_1.isString(action_1)) {
                        alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(action_1, 0, function (arg) {
                            resolve(arg.title);
                        }));
                    }
                }
            }
            if (types_1.isString(options.cancelButtonText)) {
                alertController.addAction(UIAlertAction.actionWithTitleStyleHandler(options.cancelButtonText, 1, function (arg) {
                    resolve(arg.title);
                }));
            }
            showUIAlertController(alertController);
        }
        catch (ex) {
            reject(ex);
        }
    });
}
exports.action = action;
//# sourceMappingURL=dialogs.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._focusHandler = function () { return _this._goToVisualState("focus"); };
        _this._blurHandler = function () { return _this._goToVisualState("blur"); };
        return _this;
    }
    EditableTextBase.prototype._updateTextBaseFocusStateHandler = function (subscribe) {
        var method = subscribe ? "on" : "off";
        this[method]("focus", this._focusHandler);
        this[method]("blur", this._blurHandler);
    };
    EditableTextBase.blurEvent = "blur";
    EditableTextBase.focusEvent = "focus";
    EditableTextBase.textChangeEvent = "textChange";
    __decorate([
        text_base_1.PseudoClassHandler("focus", "blur")
    ], EditableTextBase.prototype, "_updateTextBaseFocusStateHandler", null);
    return EditableTextBase;
}(text_base_1.TextBase));
exports.EditableTextBase = EditableTextBase;
exports.placeholderColorProperty = new text_base_1.CssProperty({ name: "placeholderColor", cssName: "placeholder-color", equalityComparer: text_base_1.Color.equals, valueConverter: function (v) { return new text_base_1.Color(v); } });
exports.placeholderColorProperty.register(text_base_1.Style);
var keyboardTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("datetime", "phone", "number", "url", "email"));
exports.keyboardTypeProperty = new text_base_1.Property({ name: "keyboardType", valueConverter: keyboardTypeConverter });
exports.keyboardTypeProperty.register(EditableTextBase);
var returnKeyTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("done", "next", "go", "search", "send"));
exports.returnKeyTypeProperty = new text_base_1.Property({ name: "returnKeyType", valueConverter: returnKeyTypeConverter });
exports.returnKeyTypeProperty.register(EditableTextBase);
exports.editableProperty = new text_base_1.Property({ name: "editable", defaultValue: true, valueConverter: text_base_1.booleanConverter });
exports.editableProperty.register(EditableTextBase);
exports.updateTextTriggerProperty = new text_base_1.Property({ name: "updateTextTrigger", defaultValue: "textChanged" });
exports.updateTextTriggerProperty.register(EditableTextBase);
var autocapitalizationTypeConverter = text_base_1.makeParser(text_base_1.makeValidator("none", "words", "sentences", "allcharacters"));
exports.autocapitalizationTypeProperty = new text_base_1.Property({ name: "autocapitalizationType", defaultValue: "sentences", valueConverter: autocapitalizationTypeConverter });
exports.autocapitalizationTypeProperty.register(EditableTextBase);
exports.autocorrectProperty = new text_base_1.Property({ name: "autocorrect", valueConverter: text_base_1.booleanConverter });
exports.autocorrectProperty.register(EditableTextBase);
exports.hintProperty = new text_base_1.Property({ name: "hint", defaultValue: "" });
exports.hintProperty.register(EditableTextBase);
exports.maxLengthProperty = new text_base_1.Property({ name: "maxLength", defaultValue: Number.POSITIVE_INFINITY, valueConverter: parseInt });
exports.maxLengthProperty.register(EditableTextBase);
//# sourceMappingURL=editable-text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base-common.js"));
var EditableTextBase = (function (_super) {
    __extends(EditableTextBase, _super);
    function EditableTextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EditableTextBase.prototype.dismissSoftInput = function () {
        this.nativeTextViewProtected.resignFirstResponder();
        this.notify({ eventName: EditableTextBase.blurEvent, object: this });
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.getDefault] = function () {
        var keyboardType = this.nativeTextViewProtected.keyboardType;
        switch (keyboardType) {
            case 2:
                return "number";
            case 5:
                return "phone";
            case 3:
                return "url";
            case 7:
                return "email";
            default:
                return keyboardType.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.keyboardTypeProperty.setNative] = function (value) {
        var newKeyboardType;
        switch (value) {
            case "datetime":
                newKeyboardType = 2;
                break;
            case "phone":
                newKeyboardType = 5;
                break;
            case "number":
                newKeyboardType = 2;
                break;
            case "url":
                newKeyboardType = 3;
                break;
            case "email":
                newKeyboardType = 7;
                break;
            default:
                var kt = +value;
                if (!isNaN(kt)) {
                    newKeyboardType = kt;
                }
                else {
                    newKeyboardType = 0;
                }
                break;
        }
        this.nativeTextViewProtected.keyboardType = newKeyboardType;
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.getDefault] = function () {
        var returnKeyType = this.nativeTextViewProtected.returnKeyType;
        switch (returnKeyType) {
            case 9:
                return "done";
            case 1:
                return "go";
            case 4:
                return "next";
            case 6:
                return "search";
            case 7:
                return "send";
            default:
                return returnKeyType.toString();
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.returnKeyTypeProperty.setNative] = function (value) {
        var newValue;
        switch (value) {
            case "done":
                newValue = 9;
                break;
            case "go":
                newValue = 1;
                break;
            case "next":
                newValue = 4;
                break;
            case "search":
                newValue = 6;
                break;
            case "send":
                newValue = 7;
                break;
            default:
                var rkt = +value;
                if (!isNaN(rkt)) {
                    newValue = rkt;
                }
                else {
                    newValue = 0;
                }
                break;
        }
        this.nativeTextViewProtected.returnKeyType = newValue;
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.getDefault] = function () {
        var autocapitalizationType = this.nativeTextViewProtected.autocapitalizationType;
        switch (autocapitalizationType) {
            case 0:
                return "none";
            case 1:
                return "words";
            case 2:
                return "sentences";
            case 3:
                return "allcharacters";
            default:
                throw new Error("Invalid autocapitalizationType value:" + autocapitalizationType);
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocapitalizationTypeProperty.setNative] = function (value) {
        var newValue;
        switch (value) {
            case "none":
                newValue = 0;
                break;
            case "words":
                newValue = 1;
                break;
            case "sentences":
                newValue = 2;
                break;
            case "allcharacters":
                newValue = 3;
                break;
            default:
                newValue = 2;
                break;
        }
        this.nativeTextViewProtected.autocapitalizationType = newValue;
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.getDefault] = function () {
        var autocorrectionType = this.nativeTextViewProtected.autocorrectionType;
        switch (autocorrectionType) {
            case 2:
                return true;
            case 1:
                return false;
            case 0:
                return autocorrectionType;
        }
    };
    EditableTextBase.prototype[editable_text_base_common_1.autocorrectProperty.setNative] = function (value) {
        var newValue;
        if (typeof value === "number") {
            newValue = 0;
        }
        else if (value) {
            newValue = 2;
        }
        else {
            newValue = 1;
        }
        this.nativeTextViewProtected.autocorrectionType = newValue;
    };
    return EditableTextBase;
}(editable_text_base_common_1.EditableTextBase));
exports.EditableTextBase = EditableTextBase;
function _updateCharactersInRangeReplacementString(formattedText, rangeLocation, rangeLength, replacementString) {
    var deletingText = !replacementString;
    var currentLocation = 0;
    for (var i = 0, length_1 = formattedText.spans.length; i < length_1; i++) {
        var span = formattedText.spans.getItem(i);
        if (currentLocation <= rangeLocation && rangeLocation < (currentLocation + span.text.length)) {
            var newText = splice(span.text, rangeLocation - currentLocation, deletingText ? rangeLength : 0, replacementString);
            span._setTextInternal(newText);
            return;
        }
        currentLocation += span.text.length;
    }
}
exports._updateCharactersInRangeReplacementString = _updateCharactersInRangeReplacementString;
function splice(value, start, delCount, newSubStr) {
    return value.slice(0, start) + newSubStr + value.slice(start + Math.abs(delCount));
}
//# sourceMappingURL=editable-text-base.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/enums/enums.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var KeyboardType;
(function (KeyboardType) {
    KeyboardType.datetime = "datetime";
    KeyboardType.phone = "phone";
    KeyboardType.number = "number";
    KeyboardType.url = "url";
    KeyboardType.email = "email";
})(KeyboardType = exports.KeyboardType || (exports.KeyboardType = {}));
var ReturnKeyType;
(function (ReturnKeyType) {
    ReturnKeyType.done = "done";
    ReturnKeyType.next = "next";
    ReturnKeyType.go = "go";
    ReturnKeyType.search = "search";
    ReturnKeyType.send = "send";
})(ReturnKeyType = exports.ReturnKeyType || (exports.ReturnKeyType = {}));
var TextAlignment;
(function (TextAlignment) {
    TextAlignment.left = "left";
    TextAlignment.center = "center";
    TextAlignment.right = "right";
})(TextAlignment = exports.TextAlignment || (exports.TextAlignment = {}));
var TextDecoration;
(function (TextDecoration) {
    TextDecoration.none = "none";
    TextDecoration.underline = "underline";
    TextDecoration.lineThrough = "line-through";
})(TextDecoration = exports.TextDecoration || (exports.TextDecoration = {}));
var TextTransform;
(function (TextTransform) {
    TextTransform.none = "none";
    TextTransform.capitalize = "capitalize";
    TextTransform.uppercase = "uppercase";
    TextTransform.lowercase = "lowercase";
})(TextTransform = exports.TextTransform || (exports.TextTransform = {}));
var WhiteSpace;
(function (WhiteSpace) {
    WhiteSpace.normal = "normal";
    WhiteSpace.nowrap = "nowrap";
})(WhiteSpace = exports.WhiteSpace || (exports.WhiteSpace = {}));
var Orientation;
(function (Orientation) {
    Orientation.horizontal = "horizontal";
    Orientation.vertical = "vertical";
})(Orientation = exports.Orientation || (exports.Orientation = {}));
var DeviceOrientation;
(function (DeviceOrientation) {
    DeviceOrientation.portrait = "portrait";
    DeviceOrientation.landscape = "landscape";
    DeviceOrientation.unknown = "unknown";
})(DeviceOrientation = exports.DeviceOrientation || (exports.DeviceOrientation = {}));
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.left = "left";
    HorizontalAlignment.center = "center";
    HorizontalAlignment.right = "right";
    HorizontalAlignment.stretch = "stretch";
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.top = "top";
    VerticalAlignment.middle = "middle";
    VerticalAlignment.bottom = "bottom";
    VerticalAlignment.stretch = "stretch";
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
var Stretch;
(function (Stretch) {
    Stretch.none = "none";
    Stretch.aspectFill = "aspectFill";
    Stretch.aspectFit = "aspectFit";
    Stretch.fill = "fill";
})(Stretch = exports.Stretch || (exports.Stretch = {}));
var Visibility;
(function (Visibility) {
    Visibility.visible = "visible";
    Visibility.collapse = "collapse";
    Visibility.collapsed = "collapsed";
})(Visibility = exports.Visibility || (exports.Visibility = {}));
var FontAttributes;
(function (FontAttributes) {
    FontAttributes.Normal = 0;
    FontAttributes.Bold = 1;
    FontAttributes.Italic = 1 << 1;
})(FontAttributes = exports.FontAttributes || (exports.FontAttributes = {}));
var DeviceType;
(function (DeviceType) {
    DeviceType.Phone = "Phone";
    DeviceType.Tablet = "Tablet";
})(DeviceType = exports.DeviceType || (exports.DeviceType = {}));
var UpdateTextTrigger;
(function (UpdateTextTrigger) {
    UpdateTextTrigger.focusLost = "focusLost";
    UpdateTextTrigger.textChanged = "textChanged";
})(UpdateTextTrigger = exports.UpdateTextTrigger || (exports.UpdateTextTrigger = {}));
var Accuracy;
(function (Accuracy) {
    Accuracy.any = 300;
    Accuracy.high = 3;
})(Accuracy = exports.Accuracy || (exports.Accuracy = {}));
var Dock;
(function (Dock) {
    Dock.left = "left";
    Dock.top = "top";
    Dock.right = "right";
    Dock.bottom = "bottom";
})(Dock = exports.Dock || (exports.Dock = {}));
var AutocapitalizationType;
(function (AutocapitalizationType) {
    AutocapitalizationType.none = "none";
    AutocapitalizationType.words = "words";
    AutocapitalizationType.sentences = "sentences";
    AutocapitalizationType.allCharacters = "allcharacters";
})(AutocapitalizationType = exports.AutocapitalizationType || (exports.AutocapitalizationType = {}));
var NavigationBarVisibility;
(function (NavigationBarVisibility) {
    NavigationBarVisibility.auto = "auto";
    NavigationBarVisibility.never = "never";
    NavigationBarVisibility.always = "always";
})(NavigationBarVisibility = exports.NavigationBarVisibility || (exports.NavigationBarVisibility = {}));
var AndroidActionBarIconVisibility;
(function (AndroidActionBarIconVisibility) {
    AndroidActionBarIconVisibility.auto = "auto";
    AndroidActionBarIconVisibility.never = "never";
    AndroidActionBarIconVisibility.always = "always";
})(AndroidActionBarIconVisibility = exports.AndroidActionBarIconVisibility || (exports.AndroidActionBarIconVisibility = {}));
var AndroidActionItemPosition;
(function (AndroidActionItemPosition) {
    AndroidActionItemPosition.actionBar = "actionBar";
    AndroidActionItemPosition.actionBarIfRoom = "actionBarIfRoom";
    AndroidActionItemPosition.popup = "popup";
})(AndroidActionItemPosition = exports.AndroidActionItemPosition || (exports.AndroidActionItemPosition = {}));
var IOSActionItemPosition;
(function (IOSActionItemPosition) {
    IOSActionItemPosition.left = "left";
    IOSActionItemPosition.right = "right";
})(IOSActionItemPosition = exports.IOSActionItemPosition || (exports.IOSActionItemPosition = {}));
var ImageFormat;
(function (ImageFormat) {
    ImageFormat.png = "png";
    ImageFormat.jpeg = "jpeg";
    ImageFormat.jpg = "jpg";
})(ImageFormat = exports.ImageFormat || (exports.ImageFormat = {}));
var FontStyle;
(function (FontStyle) {
    FontStyle.normal = "normal";
    FontStyle.italic = "italic";
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.thin = "100";
    FontWeight.extraLight = "200";
    FontWeight.light = "300";
    FontWeight.normal = "normal";
    FontWeight.medium = "500";
    FontWeight.semiBold = "600";
    FontWeight.bold = "bold";
    FontWeight.extraBold = "800";
    FontWeight.black = "900";
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.repeat = "repeat";
    BackgroundRepeat.repeatX = "repeat-x";
    BackgroundRepeat.repeatY = "repeat-y";
    BackgroundRepeat.noRepeat = "no-repeat";
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
var animation;
var AnimationCurve;
(function (AnimationCurve) {
    AnimationCurve.ease = "ease";
    AnimationCurve.easeIn = "easeIn";
    AnimationCurve.easeOut = "easeOut";
    AnimationCurve.easeInOut = "easeInOut";
    AnimationCurve.linear = "linear";
    AnimationCurve.spring = "spring";
    function cubicBezier(x1, y1, x2, y2) {
        animation = animation || __webpack_require__("../node_modules/tns-core-modules/ui/animation/animation.js");
        return new animation.CubicBezierAnimationCurve(x1, y1, x2, y2);
    }
    AnimationCurve.cubicBezier = cubicBezier;
})(AnimationCurve = exports.AnimationCurve || (exports.AnimationCurve = {}));
var StatusBarStyle;
(function (StatusBarStyle) {
    StatusBarStyle.light = "light";
    StatusBarStyle.dark = "dark";
})(StatusBarStyle = exports.StatusBarStyle || (exports.StatusBarStyle = {}));
//# sourceMappingURL=enums.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/fragment.transitions.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var slide_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/slide-transition.js");
var fade_transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/fade-transition.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var UIViewControllerAnimatedTransitioningMethods;
(function (UIViewControllerAnimatedTransitioningMethods) {
    var methodSignature = NSMethodSignature.signatureWithObjCTypes("v@:c");
    var invocation = NSInvocation.invocationWithMethodSignature(methodSignature);
    invocation.selector = "completeTransition:";
    function completeTransition(didComplete) {
        var didCompleteReference = new interop.Reference(interop.types.bool, didComplete);
        invocation.setArgumentAtIndex(didCompleteReference, 2);
        invocation.invokeWithTarget(this);
    }
    UIViewControllerAnimatedTransitioningMethods.completeTransition = completeTransition;
})(UIViewControllerAnimatedTransitioningMethods || (UIViewControllerAnimatedTransitioningMethods = {}));
var AnimatedTransitioning = (function (_super) {
    __extends(AnimatedTransitioning, _super);
    function AnimatedTransitioning() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    AnimatedTransitioning.init = function (transition, operation, fromVC, toVC) {
        var impl = AnimatedTransitioning.new();
        impl._transition = transition;
        impl._operation = operation;
        impl._fromVC = fromVC;
        impl._toVC = toVC;
        return impl;
    };
    AnimatedTransitioning.prototype.animateTransition = function (transitionContext) {
        var containerView = transitionContext.valueForKey("containerView");
        var completion = UIViewControllerAnimatedTransitioningMethods.completeTransition.bind(transitionContext);
        switch (this._operation) {
            case 1:
                this._transitionType = "push";
                break;
            case 2:
                this._transitionType = "pop";
                break;
            case 0:
                this._transitionType = "none";
                break;
        }
        if (trace_1.isEnabled()) {
            trace_1.write("START " + this._transition + " " + this._transitionType, trace_1.categories.Transition);
        }
        this._transition.animateIOSTransition(containerView, this._fromVC.view, this._toVC.view, this._operation, completion);
    };
    AnimatedTransitioning.prototype.transitionDuration = function (transitionContext) {
        return this._transition.getDuration();
    };
    AnimatedTransitioning.prototype.animationEnded = function (transitionCompleted) {
        if (transitionCompleted) {
            if (trace_1.isEnabled()) {
                trace_1.write("END " + this._transition + " " + this._transitionType, trace_1.categories.Transition);
            }
        }
        else {
            if (trace_1.isEnabled()) {
                trace_1.write("CANCEL " + this._transition + " " + this._transitionType, trace_1.categories.Transition);
            }
        }
    };
    AnimatedTransitioning.ObjCProtocols = [UIViewControllerAnimatedTransitioning];
    return AnimatedTransitioning;
}(NSObject));
function _createIOSAnimatedTransitioning(navigationTransition, nativeCurve, operation, fromVC, toVC) {
    var instance = navigationTransition.instance;
    var transition;
    if (instance) {
        transition = instance;
    }
    else if (navigationTransition.name) {
        var name_1 = navigationTransition.name.toLowerCase();
        if (name_1.indexOf("slide") === 0) {
            var direction = name_1.substr("slide".length) || "left";
            transition = new slide_transition_1.SlideTransition(direction, navigationTransition.duration, nativeCurve);
        }
        else if (name_1 === "fade") {
            transition = new fade_transition_1.FadeTransition(navigationTransition.duration, nativeCurve);
        }
    }
    return transition ? AnimatedTransitioning.init(transition, operation, fromVC, toVC) : undefined;
}
exports._createIOSAnimatedTransitioning = _createIOSAnimatedTransitioning;
//# sourceMappingURL=fragment.transitions.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view-common.js");
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var builder_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/builder.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_stack_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-stack.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var NavigationType;
(function (NavigationType) {
    NavigationType[NavigationType["back"] = 0] = "back";
    NavigationType[NavigationType["forward"] = 1] = "forward";
    NavigationType[NavigationType["replace"] = 2] = "replace";
})(NavigationType = exports.NavigationType || (exports.NavigationType = {}));
function buildEntryFromArgs(arg) {
    var entry;
    if (typeof arg === "string") {
        entry = {
            moduleName: arg
        };
    }
    else if (typeof arg === "function") {
        entry = {
            create: arg
        };
    }
    else {
        entry = arg;
    }
    return entry;
}
var FrameBase = (function (_super) {
    __extends(FrameBase, _super);
    function FrameBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._backStack = new Array();
        _this._navigationQueue = new Array();
        _this._isInFrameStack = false;
        return _this;
    }
    FrameBase_1 = FrameBase;
    FrameBase.prototype._addChildFromBuilder = function (name, value) {
        throw new Error("Frame should not have a view. Use 'defaultPage' property instead.");
    };
    FrameBase.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.canGoBack = function () {
        var _this = this;
        var backstack = this._backStack.length;
        var previousForwardNotInBackstack = false;
        this._navigationQueue.forEach(function (item) {
            var entry = item.entry;
            var isBackNavigation = item.navigationType === NavigationType.back;
            if (isBackNavigation) {
                previousForwardNotInBackstack = false;
                if (!entry) {
                    backstack--;
                }
                else {
                    var backstackIndex = _this._backStack.indexOf(entry);
                    if (backstackIndex !== -1) {
                        backstack = backstackIndex;
                    }
                    else {
                        backstack--;
                    }
                }
            }
            else if (entry.entry.clearHistory) {
                previousForwardNotInBackstack = false;
                backstack = 0;
            }
            else {
                backstack++;
                if (previousForwardNotInBackstack) {
                    backstack--;
                }
                previousForwardNotInBackstack = entry.entry.backstackVisible === false;
            }
        });
        if (this._navigationQueue.length > 0 && !this._currentEntry) {
            backstack--;
        }
        return backstack > 0;
    };
    FrameBase.prototype.goBack = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK", view_1.traceCategories.Navigation);
        }
        if (!this.canGoBack()) {
            return;
        }
        if (backstackEntry) {
            var index_1 = this._backStack.indexOf(backstackEntry);
            if (index_1 < 0) {
                return;
            }
        }
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: true,
            navigationType: NavigationType.back
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype._removeEntry = function (removed) {
        var page = removed.resolvedPage;
        var frame = page.frame;
        page._frame = null;
        if (frame) {
            frame._removeView(page);
        }
        else {
            page._tearDownUI(true);
        }
        removed.resolvedPage = null;
    };
    FrameBase.prototype.navigate = function (param) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE", view_1.traceCategories.Navigation);
        }
        var entry = buildEntryFromArgs(param);
        var page = builder_1.createViewFromEntry(entry);
        this._pushInFrameStack();
        var backstackEntry = {
            entry: entry,
            resolvedPage: page,
            navDepth: undefined,
            fragmentTag: undefined
        };
        var navigationContext = {
            entry: backstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.forward
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    FrameBase.prototype.isCurrent = function (entry) {
        return this._currentEntry === entry;
    };
    FrameBase.prototype.setCurrent = function (entry, navigationType) {
        var newPage = entry.resolvedPage;
        if (!newPage.frame) {
            this._addView(newPage);
            newPage._frame = this;
        }
        this._currentEntry = entry;
        var isBack = navigationType === NavigationType.back;
        if (isBack) {
            this._pushInFrameStack();
        }
        newPage.onNavigatedTo(isBack);
        this._executingContext = null;
    };
    FrameBase.prototype._updateBackstack = function (entry, navigationType) {
        var _this = this;
        var isBack = navigationType === NavigationType.back;
        var isReplace = navigationType === NavigationType.replace;
        this.raiseCurrentPageNavigatedEvents(isBack);
        var current = this._currentEntry;
        if (isBack) {
            var index_2 = this._backStack.indexOf(entry);
            this._backStack.splice(index_2 + 1).forEach(function (e) { return _this._removeEntry(e); });
            this._backStack.pop();
        }
        else if (!isReplace) {
            if (entry.entry.clearHistory) {
                this._backStack.forEach(function (e) { return _this._removeEntry(e); });
                this._backStack.length = 0;
            }
            else if (FrameBase_1._isEntryBackstackVisible(current)) {
                this._backStack.push(current);
            }
        }
        if (current && this._backStack.indexOf(current) < 0) {
            this._removeEntry(current);
        }
    };
    FrameBase.prototype.isNestedWithin = function (parentFrameCandidate) {
        var frameAncestor = this;
        while (frameAncestor) {
            frameAncestor = view_common_1.getAncestor(frameAncestor, FrameBase_1);
            if (frameAncestor === parentFrameCandidate) {
                return true;
            }
        }
        return false;
    };
    FrameBase.prototype.raiseCurrentPageNavigatedEvents = function (isBack) {
        var page = this.currentPage;
        if (page) {
            if (page.isLoaded) {
                page.callUnloaded();
            }
            page.onNavigatedFrom(isBack);
        }
    };
    FrameBase.prototype._processNavigationQueue = function (page) {
        if (this._navigationQueue.length === 0) {
            return;
        }
        var entry = this._navigationQueue[0].entry;
        var currentNavigationPage = entry.resolvedPage;
        if (page !== currentNavigationPage) {
            return;
        }
        this._navigationQueue.shift();
        this._processNextNavigationEntry();
        this._updateActionBar();
    };
    FrameBase.prototype._findEntryForTag = function (fragmentTag) {
        var entry;
        if (this._currentEntry && this._currentEntry.fragmentTag === fragmentTag) {
            entry = this._currentEntry;
        }
        else {
            entry = this._backStack.find(function (value) { return value.fragmentTag === fragmentTag; });
            if (!entry) {
                var navigationItem = this._navigationQueue.find(function (value) { return value.entry.fragmentTag === fragmentTag; });
                entry = navigationItem ? navigationItem.entry : undefined;
            }
        }
        return entry;
    };
    FrameBase.prototype.navigationQueueIsEmpty = function () {
        return this._navigationQueue.length === 0;
    };
    FrameBase._isEntryBackstackVisible = function (entry) {
        if (!entry) {
            return false;
        }
        var backstackVisibleValue = entry.entry.backstackVisible;
        var backstackHidden = backstackVisibleValue !== undefined && !backstackVisibleValue;
        return !backstackHidden;
    };
    FrameBase.prototype._updateActionBar = function (page, disableNavBarAnimation) {
    };
    FrameBase.prototype._processNextNavigationEntry = function () {
        if (!this.isLoaded || this._executingContext) {
            return;
        }
        if (this._navigationQueue.length > 0) {
            var navigationContext = this._navigationQueue[0];
            var isBackNavigation = navigationContext.navigationType === NavigationType.back;
            if (isBackNavigation) {
                this.performGoBack(navigationContext);
            }
            else {
                this.performNavigation(navigationContext);
            }
        }
    };
    FrameBase.prototype.performNavigation = function (navigationContext) {
        this._executingContext = navigationContext;
        var backstackEntry = navigationContext.entry;
        var isBackNavigation = navigationContext.navigationType === NavigationType.back;
        this._onNavigatingTo(backstackEntry, isBackNavigation);
        this._navigateCore(backstackEntry);
    };
    FrameBase.prototype.performGoBack = function (navigationContext) {
        var backstackEntry = navigationContext.entry;
        var backstack = this._backStack;
        if (!backstackEntry) {
            backstackEntry = backstack[backstack.length - 1];
            navigationContext.entry = backstackEntry;
        }
        this._executingContext = navigationContext;
        this._onNavigatingTo(backstackEntry, true);
        this._goBackCore(backstackEntry);
    };
    FrameBase.prototype._goBackCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("GO BACK CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._navigateCore = function (backstackEntry) {
        if (view_1.traceEnabled()) {
            view_1.traceWrite("NAVIGATE CORE(" + this._backstackEntryTrace(backstackEntry) + "); currentPage: " + this.currentPage, view_1.traceCategories.Navigation);
        }
    };
    FrameBase.prototype._onNavigatingTo = function (backstackEntry, isBack) {
        if (this.currentPage) {
            this.currentPage.onNavigatingFrom(isBack);
        }
        backstackEntry.resolvedPage.onNavigatingTo(backstackEntry.entry.context, isBack, backstackEntry.entry.bindingContext);
    };
    Object.defineProperty(FrameBase.prototype, "animated", {
        get: function () {
            return this._animated;
        },
        set: function (value) {
            this._animated = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "transition", {
        get: function () {
            return this._transition;
        },
        set: function (value) {
            this._transition = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "backStack", {
        get: function () {
            return this._backStack.slice();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentPage", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.resolvedPage;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FrameBase.prototype, "currentEntry", {
        get: function () {
            if (this._currentEntry) {
                return this._currentEntry.entry;
            }
            return null;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._pushInFrameStackRecursive = function () {
        this._pushInFrameStack();
        var framesToPush = [];
        for (var _i = 0, frameStack_1 = frame_stack_1.frameStack; _i < frameStack_1.length; _i++) {
            var frame = frameStack_1[_i];
            if (frame.isNestedWithin(this)) {
                framesToPush.push(frame);
            }
        }
        for (var _a = 0, framesToPush_1 = framesToPush; _a < framesToPush_1.length; _a++) {
            var frame = framesToPush_1[_a];
            frame._pushInFrameStack();
        }
    };
    FrameBase.prototype._pushInFrameStack = function () {
        frame_stack_1._pushInFrameStack(this);
    };
    FrameBase.prototype._popFromFrameStack = function () {
        frame_stack_1._popFromFrameStack(this);
    };
    FrameBase.prototype._removeFromFrameStack = function () {
        frame_stack_1._removeFromFrameStack(this);
    };
    FrameBase.prototype._dialogClosed = function () {
        this._removeFromFrameStack();
    };
    FrameBase.prototype._onRootViewReset = function () {
        _super.prototype._onRootViewReset.call(this);
        this._removeFromFrameStack();
    };
    Object.defineProperty(FrameBase.prototype, "_childrenCount", {
        get: function () {
            if (this.currentPage) {
                return 1;
            }
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype.eachChildView = function (callback) {
        var page = this.currentPage;
        if (page) {
            callback(page);
        }
    };
    FrameBase.prototype._getIsAnimatedNavigation = function (entry) {
        if (entry && entry.animated !== undefined) {
            return entry.animated;
        }
        if (this.animated !== undefined) {
            return this.animated;
        }
        return FrameBase_1.defaultAnimatedNavigation;
    };
    FrameBase.prototype._getNavigationTransition = function (entry) {
        if (entry) {
            if (view_1.isIOS && entry.transitioniOS !== undefined) {
                return entry.transitioniOS;
            }
            if (view_1.isAndroid && entry.transitionAndroid !== undefined) {
                return entry.transitionAndroid;
            }
            if (entry.transition !== undefined) {
                return entry.transition;
            }
        }
        if (this.transition !== undefined) {
            return this.transition;
        }
        return FrameBase_1.defaultTransition;
    };
    Object.defineProperty(FrameBase.prototype, "navigationBarHeight", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    FrameBase.prototype._getNavBarVisible = function (page) {
        throw new Error();
    };
    FrameBase.prototype._addViewToNativeVisualTree = function (child) {
        return true;
    };
    FrameBase.prototype._removeViewFromNativeVisualTree = function (child) {
        child._isAddedToNativeVisualTree = false;
    };
    FrameBase.prototype._printFrameBackStack = function () {
        var length = this.backStack.length;
        var i = length - 1;
        console.log("Frame Back Stack: ");
        while (i >= 0) {
            var backstackEntry = this.backStack[i--];
            console.log("\t" + backstackEntry.resolvedPage);
        }
    };
    FrameBase.prototype._backstackEntryTrace = function (b) {
        var result = "" + b.resolvedPage;
        var backstackVisible = FrameBase_1._isEntryBackstackVisible(b);
        if (!backstackVisible) {
            result += " | INVISIBLE";
        }
        if (b.entry.clearHistory) {
            result += " | CLEAR HISTORY";
        }
        var animated = this._getIsAnimatedNavigation(b.entry);
        if (!animated) {
            result += " | NOT ANIMATED";
        }
        var t = this._getNavigationTransition(b.entry);
        if (t) {
            result += " | Transition[" + JSON.stringify(t) + "]";
        }
        return result;
    };
    FrameBase.prototype._onLivesync = function (context) {
        if (_super.prototype._onLivesync.call(this, context)) {
            return true;
        }
        if (!context) {
            return this.legacyLivesync();
        }
        return false;
    };
    FrameBase.prototype._handleLivesync = function (context) {
        if (_super.prototype._handleLivesync.call(this, context)) {
            return true;
        }
        if (this.currentPage &&
            view_common_1.viewMatchesModuleContext(this.currentPage, context, ["markup", "script"])) {
            view_1.traceWrite("Change Handled: Replacing page " + context.path, view_1.traceCategories.Livesync);
            this.replacePage(context.path);
            return true;
        }
        return false;
    };
    FrameBase.prototype.legacyLivesync = function () {
        if (view_1.traceEnabled()) {
            view_1.traceWrite(this + "._onLivesync()", view_1.traceCategories.Livesync);
        }
        if (!this._currentEntry || !this._currentEntry.entry) {
            return false;
        }
        var currentEntry = this._currentEntry.entry;
        var newEntry = {
            animated: false,
            clearHistory: true,
            context: currentEntry.context,
            create: currentEntry.create,
            moduleName: currentEntry.moduleName,
            backstackVisible: currentEntry.backstackVisible
        };
        if (newEntry.create) {
            var page = newEntry.create();
            if (page === this.currentPage) {
                return false;
            }
        }
        this.navigate(newEntry);
        return true;
    };
    FrameBase.prototype.replacePage = function (pagePath) {
        var currentBackstackEntry = this._currentEntry;
        var contextModuleName = module_name_sanitizer_1.sanitizeModuleName(pagePath);
        var newPage = builder_1.createViewFromEntry({ moduleName: contextModuleName });
        var newBackstackEntry = {
            entry: currentBackstackEntry.entry,
            resolvedPage: newPage,
            navDepth: currentBackstackEntry.navDepth,
            fragmentTag: currentBackstackEntry.fragmentTag,
            frameId: currentBackstackEntry.frameId
        };
        var navigationContext = {
            entry: newBackstackEntry,
            isBackNavigation: false,
            navigationType: NavigationType.replace
        };
        this._navigationQueue.push(navigationContext);
        this._processNextNavigationEntry();
    };
    var FrameBase_1;
    FrameBase.androidOptionSelectedEvent = "optionSelected";
    FrameBase.defaultAnimatedNavigation = true;
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "onLoaded", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performNavigation", null);
    __decorate([
        profiling_1.profile
    ], FrameBase.prototype, "performGoBack", null);
    FrameBase = FrameBase_1 = __decorate([
        view_1.CSSType("Frame")
    ], FrameBase);
    return FrameBase;
}(view_1.CustomLayoutView));
exports.FrameBase = FrameBase;
function getFrameById(id) {
    return frame_stack_1.frameStack.find(function (frame) { return frame.id && frame.id === id; });
}
exports.getFrameById = getFrameById;
function topmost() {
    return frame_stack_1.topmost();
}
exports.topmost = topmost;
function goBack() {
    var top = topmost();
    if (top && top.canGoBack()) {
        top.goBack();
        return true;
    }
    else if (top) {
        var parentFrameCanGoBack = false;
        var parentFrame = view_common_1.getAncestor(top, "Frame");
        while (parentFrame && !parentFrameCanGoBack) {
            if (parentFrame && parentFrame.canGoBack()) {
                parentFrameCanGoBack = true;
            }
            else {
                parentFrame = view_common_1.getAncestor(parentFrame, "Frame");
            }
        }
        if (parentFrame && parentFrameCanGoBack) {
            parentFrame.goBack();
            return true;
        }
    }
    if (frame_stack_1.frameStack.length > 1) {
        top._popFromFrameStack();
    }
    return false;
}
exports.goBack = goBack;
function _stack() {
    return frame_stack_1.frameStack;
}
exports._stack = _stack;
exports.defaultPage = new view_1.Property({
    name: "defaultPage", valueChanged: function (frame, oldValue, newValue) {
        frame.navigate({ moduleName: newValue });
    }
});
exports.defaultPage.register(FrameBase);
exports.actionBarVisibilityProperty = new view_1.Property({ name: "actionBarVisibility", defaultValue: "auto", affectsLayout: view_1.isIOS });
exports.actionBarVisibilityProperty.register(FrameBase);
//# sourceMappingURL=frame-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame-stack.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
exports.frameStack = [];
function topmost() {
    if (exports.frameStack.length > 0) {
        return exports.frameStack[exports.frameStack.length - 1];
    }
    return undefined;
}
exports.topmost = topmost;
function _pushInFrameStack(frame) {
    if (frame._isInFrameStack && exports.frameStack[exports.frameStack.length - 1] === frame) {
        return;
    }
    if (frame._isInFrameStack) {
        var indexOfFrame = exports.frameStack.indexOf(frame);
        exports.frameStack.splice(indexOfFrame, 1);
    }
    exports.frameStack.push(frame);
    frame._isInFrameStack = true;
}
exports._pushInFrameStack = _pushInFrameStack;
function _popFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var top = topmost();
    if (top !== frame) {
        throw new Error("Cannot pop a Frame which is not at the top of the navigation stack.");
    }
    exports.frameStack.pop();
    frame._isInFrameStack = false;
}
exports._popFromFrameStack = _popFromFrameStack;
function _removeFromFrameStack(frame) {
    if (!frame._isInFrameStack) {
        return;
    }
    var index = exports.frameStack.indexOf(frame);
    exports.frameStack.splice(index, 1);
    frame._isInFrameStack = false;
}
exports._removeFromFrameStack = _removeFromFrameStack;
//# sourceMappingURL=frame-stack.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/frame/frame.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var frame_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js");
var fragment_transitions_1 = __webpack_require__("../node_modules/tns-core-modules/ui/frame/fragment.transitions.js");
var utils = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/frame/frame-common.js"));
var majorVersion = utils.ios.MajorVersion;
var ENTRY = "_entry";
var DELEGATE = "_delegate";
var NAV_DEPTH = "_navDepth";
var TRANSITION = "_transition";
var NON_ANIMATED_TRANSITION = "non-animated";
var HMR_REPLACE_TRANSITION = "fade";
var navDepth = -1;
var Frame = (function (_super) {
    __extends(Frame, _super);
    function Frame() {
        var _this = _super.call(this) || this;
        _this._animatedDelegate = UINavigationControllerAnimatedDelegate.new();
        _this._ios = new iOSFrame(_this);
        _this.viewController = _this._ios.controller;
        return _this;
    }
    Frame.prototype.createNativeView = function () {
        return this.viewController.view;
    };
    Frame.prototype.disposeNativeView = function () {
        this._removeFromFrameStack();
        this.viewController = null;
        this._ios.controller = null;
        _super.prototype.disposeNativeView.call(this);
    };
    Object.defineProperty(Frame.prototype, "ios", {
        get: function () {
            return this._ios;
        },
        enumerable: true,
        configurable: true
    });
    Frame.prototype.setCurrent = function (entry, navigationType) {
        var current = this._currentEntry;
        var currentEntryChanged = current !== entry;
        if (currentEntryChanged) {
            this._updateBackstack(entry, navigationType);
            _super.prototype.setCurrent.call(this, entry, navigationType);
        }
    };
    Frame.prototype._navigateCore = function (backstackEntry) {
        _super.prototype._navigateCore.call(this, backstackEntry);
        var viewController = backstackEntry.resolvedPage.ios;
        if (!viewController) {
            throw new Error("Required page does not have a viewController created.");
        }
        var clearHistory = backstackEntry.entry.clearHistory;
        if (clearHistory) {
            navDepth = -1;
        }
        var isReplace = this._executingContext && this._executingContext.navigationType === frame_common_1.NavigationType.replace;
        if (!isReplace) {
            navDepth++;
        }
        var navigationTransition;
        var animated = this.currentPage ? this._getIsAnimatedNavigation(backstackEntry.entry) : false;
        if (isReplace) {
            animated = true;
            navigationTransition = { name: HMR_REPLACE_TRANSITION, duration: 100 };
            viewController[TRANSITION] = navigationTransition;
        }
        else if (animated) {
            navigationTransition = this._getNavigationTransition(backstackEntry.entry);
            if (navigationTransition) {
                viewController[TRANSITION] = navigationTransition;
            }
        }
        else {
            viewController[TRANSITION] = { name: NON_ANIMATED_TRANSITION };
        }
        var nativeTransition = _getNativeTransition(navigationTransition, true);
        if (!nativeTransition && navigationTransition) {
            this._ios.controller.delegate = this._animatedDelegate;
            viewController[DELEGATE] = this._animatedDelegate;
        }
        else {
            viewController[DELEGATE] = null;
            this._ios.controller.delegate = null;
        }
        backstackEntry[NAV_DEPTH] = navDepth;
        viewController[ENTRY] = backstackEntry;
        if (!animated && majorVersion > 10) {
            var barButtonItem = UIBarButtonItem.alloc().initWithTitleStyleTargetAction("", 0, null, null);
            viewController.navigationItem.backBarButtonItem = barButtonItem;
        }
        if (!this._currentEntry) {
            this._updateActionBar(backstackEntry.resolvedPage, true);
            this._ios.controller.pushViewControllerAnimated(viewController, animated);
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite(this + ".pushViewControllerAnimated(" + viewController + ", " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
            }
            return;
        }
        if (clearHistory) {
            viewController.navigationItem.hidesBackButton = true;
            var newControllers = NSMutableArray.alloc().initWithCapacity(1);
            newControllers.addObject(viewController);
            var oldControllers = this._ios.controller.viewControllers;
            for (var i = 0; i < oldControllers.count; i++) {
                oldControllers.objectAtIndex(i).isBackstackCleared = true;
            }
            this._ios.controller.setViewControllersAnimated(newControllers, animated);
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite(this + ".setViewControllersAnimated([" + viewController + "], " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
            }
            return;
        }
        if (!Frame._isEntryBackstackVisible(this._currentEntry) || isReplace) {
            var newControllers = NSMutableArray.alloc().initWithArray(this._ios.controller.viewControllers);
            if (newControllers.count === 0) {
                throw new Error("Wrong controllers count.");
            }
            viewController.navigationItem.hidesBackButton = this.backStack.length === 0;
            var skippedNavController = newControllers.lastObject;
            skippedNavController.isBackstackSkipped = true;
            newControllers.removeLastObject();
            newControllers.addObject(viewController);
            this._ios.controller.setViewControllersAnimated(newControllers, animated);
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite(this + ".setViewControllersAnimated([originalControllers - lastController + " + viewController + "], " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
            }
            return;
        }
        this._ios.controller.pushViewControllerAnimated(viewController, animated);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(this + ".pushViewControllerAnimated(" + viewController + ", " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
        }
    };
    Frame.prototype._goBackCore = function (backstackEntry) {
        _super.prototype._goBackCore.call(this, backstackEntry);
        navDepth = backstackEntry[NAV_DEPTH];
        var controller = backstackEntry.resolvedPage.ios;
        var animated = this._currentEntry ? this._getIsAnimatedNavigation(this._currentEntry.entry) : false;
        this._updateActionBar(backstackEntry.resolvedPage);
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite(this + ".popToViewControllerAnimated(" + controller + ", " + animated + "); depth = " + navDepth, frame_common_1.traceCategories.Navigation);
        }
        this._ios.controller.popToViewControllerAnimated(controller, animated);
    };
    Frame.prototype._updateActionBar = function (page, disableNavBarAnimation) {
        if (disableNavBarAnimation === void 0) { disableNavBarAnimation = false; }
        _super.prototype._updateActionBar.call(this, page);
        if (page && this.currentPage && this.currentPage.modal === page) {
            return;
        }
        page = page || this.currentPage;
        var newValue = this._getNavBarVisible(page);
        var disableNavBarAnimationCache = this._ios._disableNavBarAnimation;
        if (disableNavBarAnimation) {
            this._ios._disableNavBarAnimation = true;
        }
        this._ios.showNavigationBar = newValue;
        if (disableNavBarAnimation) {
            this._ios._disableNavBarAnimation = disableNavBarAnimationCache;
        }
        if (this._ios.controller.navigationBar) {
            this._ios.controller.navigationBar.userInteractionEnabled = this.navigationQueueIsEmpty();
        }
    };
    Frame.prototype._getNavBarVisible = function (page) {
        switch (this.actionBarVisibility) {
            case "always":
                return true;
            case "never":
                return false;
            case "auto":
                switch (this._ios.navBarVisibility) {
                    case "always":
                        return true;
                    case "never":
                        return false;
                    case "auto":
                        var newValue = void 0;
                        if (page && page.actionBarHidden !== undefined) {
                            newValue = !page.actionBarHidden;
                        }
                        else {
                            newValue = this.ios.controller.viewControllers.count > 1 || (page && page.actionBar && !page.actionBar._isEmpty());
                        }
                        newValue = !!newValue;
                        return newValue;
                }
        }
    };
    Object.defineProperty(Frame, "defaultAnimatedNavigation", {
        get: function () {
            return frame_common_1.FrameBase.defaultAnimatedNavigation;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultAnimatedNavigation = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Frame, "defaultTransition", {
        get: function () {
            return frame_common_1.FrameBase.defaultTransition;
        },
        set: function (value) {
            frame_common_1.FrameBase.defaultTransition = value;
        },
        enumerable: true,
        configurable: true
    });
    Frame.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var width = frame_common_1.layout.getMeasureSpecSize(widthMeasureSpec);
        var widthMode = frame_common_1.layout.getMeasureSpecMode(widthMeasureSpec);
        var height = frame_common_1.layout.getMeasureSpecSize(heightMeasureSpec);
        var heightMode = frame_common_1.layout.getMeasureSpecMode(heightMeasureSpec);
        var widthAndState = frame_common_1.View.resolveSizeAndState(width, width, widthMode, 0);
        var heightAndState = frame_common_1.View.resolveSizeAndState(height, height, heightMode, 0);
        this.setMeasuredDimension(widthAndState, heightAndState);
    };
    Frame.prototype.layoutNativeView = function (left, top, right, bottom) {
    };
    Frame.prototype._setNativeViewFrame = function (nativeView, frame) {
    };
    Frame.prototype._onNavigatingTo = function (backstackEntry, isBack) {
    };
    __decorate([
        profiling_1.profile
    ], Frame.prototype, "_navigateCore", null);
    return Frame;
}(frame_common_1.FrameBase));
exports.Frame = Frame;
var transitionDelegates = new Array();
var TransitionDelegate = (function (_super) {
    __extends(TransitionDelegate, _super);
    function TransitionDelegate() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TransitionDelegate.initWithOwnerId = function (id) {
        var delegate = TransitionDelegate.new();
        delegate._id = id;
        transitionDelegates.push(delegate);
        return delegate;
    };
    TransitionDelegate.prototype.animationWillStart = function (animationID, context) {
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("START " + this._id, frame_common_1.traceCategories.Transition);
        }
    };
    TransitionDelegate.prototype.animationDidStop = function (animationID, finished, context) {
        if (finished) {
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite("END " + this._id, frame_common_1.traceCategories.Transition);
            }
        }
        else {
            if (frame_common_1.traceEnabled()) {
                frame_common_1.traceWrite("CANCEL " + this._id, frame_common_1.traceCategories.Transition);
            }
        }
        var index = transitionDelegates.indexOf(this);
        if (index > -1) {
            transitionDelegates.splice(index, 1);
        }
    };
    TransitionDelegate.ObjCExposedMethods = {
        "animationWillStart": { returns: interop.types.void, params: [NSString, NSObject] },
        "animationDidStop": { returns: interop.types.void, params: [NSString, NSNumber, NSObject] }
    };
    return TransitionDelegate;
}(NSObject));
var _defaultTransitionDuration = 0.35;
var UINavigationControllerAnimatedDelegate = (function (_super) {
    __extends(UINavigationControllerAnimatedDelegate, _super);
    function UINavigationControllerAnimatedDelegate() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UINavigationControllerAnimatedDelegate.prototype.navigationControllerAnimationControllerForOperationFromViewControllerToViewController = function (navigationController, operation, fromVC, toVC) {
        var viewController;
        switch (operation) {
            case 1:
                viewController = toVC;
                break;
            case 2:
                viewController = fromVC;
                break;
        }
        if (!viewController) {
            return null;
        }
        var navigationTransition = viewController[TRANSITION];
        if (!navigationTransition) {
            return null;
        }
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.navigationControllerAnimationControllerForOperationFromViewControllerToViewController(" + operation + ", " + fromVC + ", " + toVC + "), transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        var curve = _getNativeCurve(navigationTransition);
        var animationController = fragment_transitions_1._createIOSAnimatedTransitioning(navigationTransition, curve, operation, fromVC, toVC);
        return animationController;
    };
    UINavigationControllerAnimatedDelegate.ObjCProtocols = [UINavigationControllerDelegate];
    return UINavigationControllerAnimatedDelegate;
}(NSObject));
var UINavigationControllerImpl = (function (_super) {
    __extends(UINavigationControllerImpl, _super);
    function UINavigationControllerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UINavigationControllerImpl.initWithOwner = function (owner) {
        var controller = UINavigationControllerImpl.new();
        controller._owner = owner;
        return controller;
    };
    Object.defineProperty(UINavigationControllerImpl.prototype, "owner", {
        get: function () {
            return this._owner.get();
        },
        enumerable: true,
        configurable: true
    });
    UINavigationControllerImpl.prototype.viewWillAppear = function (animated) {
        _super.prototype.viewWillAppear.call(this, animated);
        var owner = this._owner.get();
        if (owner && !owner.isLoaded && !owner.parent) {
            owner.callLoaded();
        }
    };
    UINavigationControllerImpl.prototype.viewDidDisappear = function (animated) {
        _super.prototype.viewDidDisappear.call(this, animated);
        var owner = this._owner.get();
        if (owner && owner.isLoaded && !owner.parent && !this.presentedViewController) {
            owner.callUnloaded();
            owner._tearDownUI(true);
        }
    };
    UINavigationControllerImpl.prototype.animateWithDuration = function (navigationTransition, nativeTransition, transitionType, baseCallback) {
        var _this = this;
        var duration = navigationTransition.duration ? navigationTransition.duration / 1000 : _defaultTransitionDuration;
        var curve = _getNativeCurve(navigationTransition);
        var transitionTraced = frame_common_1.isCategorySet(frame_common_1.traceCategories.Transition);
        var transitionDelegate;
        if (transitionTraced) {
            var id = _getTransitionId(nativeTransition, transitionType);
            transitionDelegate = TransitionDelegate.initWithOwnerId(id);
        }
        UIView.animateWithDurationAnimations(duration, function () {
            if (transitionTraced) {
                UIView.setAnimationDelegate(transitionDelegate);
            }
            UIView.setAnimationWillStartSelector("animationWillStart");
            UIView.setAnimationDidStopSelector("animationDidStop");
            UIView.setAnimationCurve(curve);
            baseCallback();
            UIView.setAnimationTransitionForViewCache(nativeTransition, _this.view, true);
        });
    };
    UINavigationControllerImpl.prototype.pushViewControllerAnimated = function (viewController, animated) {
        var _this = this;
        var navigationTransition = viewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.pushViewControllerAnimated(" + viewController + ", " + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, true);
        if (!animated || !navigationTransition || !nativeTransition) {
            _super.prototype.pushViewControllerAnimated.call(this, viewController, animated);
            return;
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "push", function () {
            _super.prototype.pushViewControllerAnimated.call(_this, viewController, false);
        });
    };
    UINavigationControllerImpl.prototype.setViewControllersAnimated = function (viewControllers, animated) {
        var _this = this;
        var viewController = viewControllers.lastObject;
        var navigationTransition = viewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.setViewControllersAnimated(" + viewControllers + ", " + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, true);
        if (!animated || !navigationTransition || !nativeTransition) {
            _super.prototype.setViewControllersAnimated.call(this, viewControllers, animated);
            return;
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "set", function () {
            _super.prototype.setViewControllersAnimated.call(_this, viewControllers, false);
        });
    };
    UINavigationControllerImpl.prototype.popViewControllerAnimated = function (animated) {
        var _this = this;
        var lastViewController = this.viewControllers.lastObject;
        var navigationTransition = lastViewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.popViewControllerAnimated(" + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        if (navigationTransition && navigationTransition.name === NON_ANIMATED_TRANSITION) {
            return _super.prototype.popViewControllerAnimated.call(this, false);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, false);
        if (!animated || !navigationTransition || !nativeTransition) {
            return _super.prototype.popViewControllerAnimated.call(this, animated);
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "pop", function () {
            _super.prototype.popViewControllerAnimated.call(_this, false);
        });
        return null;
    };
    UINavigationControllerImpl.prototype.popToViewControllerAnimated = function (viewController, animated) {
        var _this = this;
        var lastViewController = this.viewControllers.lastObject;
        var navigationTransition = lastViewController[TRANSITION];
        if (frame_common_1.traceEnabled()) {
            frame_common_1.traceWrite("UINavigationControllerImpl.popToViewControllerAnimated(" + viewController + ", " + animated + "); transition: " + JSON.stringify(navigationTransition), frame_common_1.traceCategories.NativeLifecycle);
        }
        if (navigationTransition && navigationTransition.name === NON_ANIMATED_TRANSITION) {
            return _super.prototype.popToViewControllerAnimated.call(this, viewController, false);
        }
        var nativeTransition = _getNativeTransition(navigationTransition, false);
        if (!animated || !navigationTransition || !nativeTransition) {
            return _super.prototype.popToViewControllerAnimated.call(this, viewController, animated);
        }
        this.animateWithDuration(navigationTransition, nativeTransition, "popTo", function () {
            _super.prototype.popToViewControllerAnimated.call(_this, viewController, false);
        });
        return null;
    };
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "viewWillAppear", null);
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "viewDidDisappear", null);
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "pushViewControllerAnimated", null);
    __decorate([
        profiling_1.profile
    ], UINavigationControllerImpl.prototype, "setViewControllersAnimated", null);
    return UINavigationControllerImpl;
}(UINavigationController));
function _getTransitionId(nativeTransition, transitionType) {
    var name;
    switch (nativeTransition) {
        case 4:
            name = "CurlDown";
            break;
        case 3:
            name = "CurlUp";
            break;
        case 1:
            name = "FlipFromLeft";
            break;
        case 2:
            name = "FlipFromRight";
            break;
        case 0:
            name = "None";
            break;
    }
    return name + " " + transitionType;
}
function _getNativeTransition(navigationTransition, push) {
    if (navigationTransition && navigationTransition.name) {
        switch (navigationTransition.name.toLowerCase()) {
            case "flip":
            case "flipright":
                return push ? 2 : 1;
            case "flipleft":
                return push ? 1 : 2;
            case "curl":
            case "curlup":
                return push ? 3 : 4;
            case "curldown":
                return push ? 4 : 3;
        }
    }
    return null;
}
function _getNativeCurve(transition) {
    if (transition.curve) {
        switch (transition.curve) {
            case "easeIn":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.EaseIn.", frame_common_1.traceCategories.Transition);
                }
                return 1;
            case "easeOut":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.EaseOut.", frame_common_1.traceCategories.Transition);
                }
                return 2;
            case "easeInOut":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.EaseInOut.", frame_common_1.traceCategories.Transition);
                }
                return 0;
            case "linear":
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to UIViewAnimationCurve.Linear.", frame_common_1.traceCategories.Transition);
                }
                return 3;
            default:
                if (frame_common_1.traceEnabled()) {
                    frame_common_1.traceWrite("Transition curve resolved to original: " + transition.curve, frame_common_1.traceCategories.Transition);
                }
                return transition.curve;
        }
    }
    return 0;
}
exports._getNativeCurve = _getNativeCurve;
var iOSFrame = (function () {
    function iOSFrame(frame) {
        this._navBarVisibility = "auto";
        this._controller = UINavigationControllerImpl.initWithOwner(new WeakRef(frame));
    }
    Object.defineProperty(iOSFrame.prototype, "controller", {
        get: function () {
            return this._controller;
        },
        set: function (value) {
            this._controller = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(iOSFrame.prototype, "showNavigationBar", {
        get: function () {
            return this._showNavigationBar;
        },
        set: function (value) {
            this._showNavigationBar = value;
            this._controller.setNavigationBarHiddenAnimated(!value, !this._disableNavBarAnimation);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(iOSFrame.prototype, "navBarVisibility", {
        get: function () {
            return this._navBarVisibility;
        },
        set: function (value) {
            this._navBarVisibility = value;
        },
        enumerable: true,
        configurable: true
    });
    return iOSFrame;
}());
//# sourceMappingURL=frame.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures-common.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var GestureTypes;
(function (GestureTypes) {
    GestureTypes[GestureTypes["tap"] = 1] = "tap";
    GestureTypes[GestureTypes["doubleTap"] = 2] = "doubleTap";
    GestureTypes[GestureTypes["pinch"] = 4] = "pinch";
    GestureTypes[GestureTypes["pan"] = 8] = "pan";
    GestureTypes[GestureTypes["swipe"] = 16] = "swipe";
    GestureTypes[GestureTypes["rotation"] = 32] = "rotation";
    GestureTypes[GestureTypes["longPress"] = 64] = "longPress";
    GestureTypes[GestureTypes["touch"] = 128] = "touch";
})(GestureTypes = exports.GestureTypes || (exports.GestureTypes = {}));
var GestureStateTypes;
(function (GestureStateTypes) {
    GestureStateTypes[GestureStateTypes["cancelled"] = 0] = "cancelled";
    GestureStateTypes[GestureStateTypes["began"] = 1] = "began";
    GestureStateTypes[GestureStateTypes["changed"] = 2] = "changed";
    GestureStateTypes[GestureStateTypes["ended"] = 3] = "ended";
})(GestureStateTypes = exports.GestureStateTypes || (exports.GestureStateTypes = {}));
var SwipeDirection;
(function (SwipeDirection) {
    SwipeDirection[SwipeDirection["right"] = 1] = "right";
    SwipeDirection[SwipeDirection["left"] = 2] = "left";
    SwipeDirection[SwipeDirection["up"] = 4] = "up";
    SwipeDirection[SwipeDirection["down"] = 8] = "down";
})(SwipeDirection = exports.SwipeDirection || (exports.SwipeDirection = {}));
var TouchAction;
(function (TouchAction) {
    TouchAction.down = "down";
    TouchAction.up = "up";
    TouchAction.move = "move";
    TouchAction.cancel = "cancel";
})(TouchAction = exports.TouchAction || (exports.TouchAction = {}));
function toString(type, separator) {
    var types = new Array();
    if (type & GestureTypes.tap) {
        types.push("tap");
    }
    if (type & GestureTypes.doubleTap) {
        types.push("doubleTap");
    }
    if (type & GestureTypes.pinch) {
        types.push("pinch");
    }
    if (type & GestureTypes.pan) {
        types.push("pan");
    }
    if (type & GestureTypes.swipe) {
        types.push("swipe");
    }
    if (type & GestureTypes.rotation) {
        types.push("rotation");
    }
    if (type & GestureTypes.longPress) {
        types.push("longPress");
    }
    if (type & GestureTypes.touch) {
        types.push("touch");
    }
    return types.join(separator);
}
exports.toString = toString;
function fromString(type) {
    var t = type.trim().toLowerCase();
    if (t === "tap") {
        return GestureTypes.tap;
    }
    else if (t === "doubletap") {
        return GestureTypes.doubleTap;
    }
    else if (t === "pinch") {
        return GestureTypes.pinch;
    }
    else if (t === "pan") {
        return GestureTypes.pan;
    }
    else if (t === "swipe") {
        return GestureTypes.swipe;
    }
    else if (t === "rotation") {
        return GestureTypes.rotation;
    }
    else if (t === "longpress") {
        return GestureTypes.longPress;
    }
    else if (t === "touch") {
        return GestureTypes.touch;
    }
    return undefined;
}
exports.fromString = fromString;
var GesturesObserverBase = (function () {
    function GesturesObserverBase(target, callback, context) {
        this._target = target;
        this._callback = callback;
        this._context = context;
    }
    Object.defineProperty(GesturesObserverBase.prototype, "callback", {
        get: function () {
            return this._callback;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "target", {
        get: function () {
            return this._target;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GesturesObserverBase.prototype, "context", {
        get: function () {
            return this._context;
        },
        enumerable: true,
        configurable: true
    });
    GesturesObserverBase.prototype.disconnect = function () {
        if (this.target) {
            var list = this.target.getGestureObservers(this.type);
            if (list && list.length > 0) {
                for (var i = 0; i < list.length; i++) {
                    if (list[i].callback === this.callback) {
                        break;
                    }
                }
                list.length = 0;
                this.target._gestureObservers[this.type] = undefined;
                delete this.target._gestureObservers[this.type];
            }
        }
        this._target = null;
        this._callback = null;
        this._context = null;
    };
    return GesturesObserverBase;
}());
exports.GesturesObserverBase = GesturesObserverBase;
//# sourceMappingURL=gestures-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/gestures/gestures.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var gestures_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/gestures/gestures-common.js"));
function observe(target, type, callback, context) {
    var observer = new GesturesObserver(target, callback, context);
    observer.observe(type);
    return observer;
}
exports.observe = observe;
var UIGestureRecognizerDelegateImpl = (function (_super) {
    __extends(UIGestureRecognizerDelegateImpl, _super);
    function UIGestureRecognizerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIGestureRecognizerDelegateImpl.prototype.gestureRecognizerShouldRecognizeSimultaneouslyWithGestureRecognizer = function (gestureRecognizer, otherGestureRecognizer) {
        return true;
    };
    UIGestureRecognizerDelegateImpl.prototype.gestureRecognizerShouldRequireFailureOfGestureRecognizer = function (gestureRecognizer, otherGestureRecognizer) {
        if (gestureRecognizer instanceof UITapGestureRecognizer
            && otherGestureRecognizer instanceof UITapGestureRecognizer
            && otherGestureRecognizer.numberOfTapsRequired === 2) {
            return true;
        }
        return false;
    };
    UIGestureRecognizerDelegateImpl.ObjCProtocols = [UIGestureRecognizerDelegate];
    return UIGestureRecognizerDelegateImpl;
}(NSObject));
var recognizerDelegateInstance = UIGestureRecognizerDelegateImpl.new();
var UIGestureRecognizerImpl = (function (_super) {
    __extends(UIGestureRecognizerImpl, _super);
    function UIGestureRecognizerImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIGestureRecognizerImpl.initWithOwnerTypeCallback = function (owner, type, callback, thisArg) {
        var handler = UIGestureRecognizerImpl.new();
        handler._owner = owner;
        handler._type = type;
        if (callback) {
            handler._callback = callback;
        }
        if (thisArg) {
            handler._context = thisArg;
        }
        return handler;
    };
    UIGestureRecognizerImpl.prototype.recognize = function (recognizer) {
        var owner = this._owner.get();
        var callback = this._callback ? this._callback : (owner ? owner.callback : null);
        var typeParam = this._type;
        var target = owner ? owner.target : undefined;
        var args = {
            type: typeParam,
            view: target,
            ios: recognizer,
            android: undefined,
            object: target,
            eventName: gestures_common_1.toString(typeParam),
        };
        if (callback) {
            callback.call(this._context, args);
        }
    };
    UIGestureRecognizerImpl.ObjCExposedMethods = {
        "recognize": { returns: interop.types.void, params: [UIGestureRecognizer] }
    };
    return UIGestureRecognizerImpl;
}(NSObject));
var GesturesObserver = (function (_super) {
    __extends(GesturesObserver, _super);
    function GesturesObserver(target, callback, context) {
        var _this = _super.call(this, target, callback, context) || this;
        _this._recognizers = {};
        return _this;
    }
    GesturesObserver.prototype.androidOnTouchEvent = function (motionEvent) {
    };
    GesturesObserver.prototype.observe = function (type) {
        var _this = this;
        if (this.target) {
            this.type = type;
            this._onTargetLoaded = function (args) {
                _this._attach(_this.target, type);
            };
            this._onTargetUnloaded = function (args) {
                _this._detach();
            };
            this.target.on("loaded", this._onTargetLoaded);
            this.target.on("unloaded", this._onTargetUnloaded);
            if (this.target.isLoaded) {
                this._attach(this.target, type);
            }
        }
    };
    GesturesObserver.prototype._attach = function (target, type) {
        var _this = this;
        this._detach();
        if (target && target.nativeViewProtected && target.nativeViewProtected.addGestureRecognizer) {
            var nativeView = target.nativeViewProtected;
            if (type & gestures_common_1.GestureTypes.tap) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.tap));
            }
            if (type & gestures_common_1.GestureTypes.doubleTap) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.doubleTap));
            }
            if (type & gestures_common_1.GestureTypes.pinch) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.pinch, function (args) {
                    _this._executeCallback(_getPinchData(args));
                }));
            }
            if (type & gestures_common_1.GestureTypes.pan) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.pan, function (args) {
                    _this._executeCallback(_getPanData(args, target.nativeViewProtected));
                }));
            }
            if (type & gestures_common_1.GestureTypes.swipe) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 8));
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 2));
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 1));
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.swipe, function (args) {
                    _this._executeCallback(_getSwipeData(args));
                }, 4));
            }
            if (type & gestures_common_1.GestureTypes.rotation) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.rotation, function (args) {
                    _this._executeCallback(_getRotationData(args));
                }));
            }
            if (type & gestures_common_1.GestureTypes.longPress) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.longPress));
            }
            if (type & gestures_common_1.GestureTypes.touch) {
                nativeView.addGestureRecognizer(this._createRecognizer(gestures_common_1.GestureTypes.touch));
            }
        }
    };
    GesturesObserver.prototype._detach = function () {
        if (this.target && this.target.nativeViewProtected) {
            for (var name_1 in this._recognizers) {
                if (this._recognizers.hasOwnProperty(name_1)) {
                    var item = this._recognizers[name_1];
                    this.target.nativeViewProtected.removeGestureRecognizer(item.recognizer);
                    item.recognizer = null;
                    item.target = null;
                }
            }
            this._recognizers = {};
        }
    };
    GesturesObserver.prototype.disconnect = function () {
        this._detach();
        if (this.target) {
            this.target.off("loaded", this._onTargetLoaded);
            this.target.off("unloaded", this._onTargetUnloaded);
            this._onTargetLoaded = null;
            this._onTargetUnloaded = null;
        }
        _super.prototype.disconnect.call(this);
    };
    GesturesObserver.prototype._executeCallback = function (args) {
        if (this.callback) {
            this.callback.call(this.context, args);
        }
    };
    GesturesObserver.prototype._createRecognizer = function (type, callback, swipeDirection) {
        var recognizer;
        var name = gestures_common_1.toString(type);
        var target = _createUIGestureRecognizerTarget(this, type, callback, this.context);
        var recognizerType = _getUIGestureRecognizerType(type);
        if (recognizerType) {
            recognizer = recognizerType.alloc().initWithTargetAction(target, "recognize");
            if (type === gestures_common_1.GestureTypes.swipe && swipeDirection) {
                name = name + swipeDirection.toString();
                recognizer.direction = swipeDirection;
            }
            else if (type === gestures_common_1.GestureTypes.touch) {
                recognizer.observer = this;
            }
            else if (type === gestures_common_1.GestureTypes.doubleTap) {
                recognizer.numberOfTapsRequired = 2;
            }
            if (recognizer) {
                recognizer.delegate = recognizerDelegateInstance;
                this._recognizers[name] = { recognizer: recognizer, target: target };
            }
        }
        return recognizer;
    };
    return GesturesObserver;
}(gestures_common_1.GesturesObserverBase));
exports.GesturesObserver = GesturesObserver;
function _createUIGestureRecognizerTarget(owner, type, callback, context) {
    return UIGestureRecognizerImpl.initWithOwnerTypeCallback(new WeakRef(owner), type, callback, context);
}
function _getUIGestureRecognizerType(type) {
    var nativeType = null;
    if (type === gestures_common_1.GestureTypes.tap) {
        nativeType = UITapGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.doubleTap) {
        nativeType = UITapGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.pinch) {
        nativeType = UIPinchGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.pan) {
        nativeType = UIPanGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.swipe) {
        nativeType = UISwipeGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.rotation) {
        nativeType = UIRotationGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.longPress) {
        nativeType = UILongPressGestureRecognizer;
    }
    else if (type === gestures_common_1.GestureTypes.touch) {
        nativeType = TouchGestureRecognizer;
    }
    return nativeType;
}
function getState(recognizer) {
    if (recognizer.state === 1) {
        return gestures_common_1.GestureStateTypes.began;
    }
    else if (recognizer.state === 4) {
        return gestures_common_1.GestureStateTypes.cancelled;
    }
    else if (recognizer.state === 2) {
        return gestures_common_1.GestureStateTypes.changed;
    }
    else if (recognizer.state === 3) {
        return gestures_common_1.GestureStateTypes.ended;
    }
}
function _getSwipeDirection(direction) {
    if (direction === 8) {
        return gestures_common_1.SwipeDirection.down;
    }
    else if (direction === 2) {
        return gestures_common_1.SwipeDirection.left;
    }
    else if (direction === 1) {
        return gestures_common_1.SwipeDirection.right;
    }
    else if (direction === 4) {
        return gestures_common_1.SwipeDirection.up;
    }
}
function _getPinchData(args) {
    var recognizer = args.ios;
    var center = recognizer.locationInView(args.view.nativeViewProtected);
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        scale: recognizer.scale,
        getFocusX: function () { return center.x; },
        getFocusY: function () { return center.y; },
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
        state: getState(recognizer)
    };
}
function _getSwipeData(args) {
    var recognizer = args.ios;
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        direction: _getSwipeDirection(recognizer.direction),
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
    };
}
function _getPanData(args, view) {
    var recognizer = args.ios;
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        deltaX: recognizer.translationInView(view).x,
        deltaY: recognizer.translationInView(view).y,
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
        state: getState(recognizer)
    };
}
function _getRotationData(args) {
    var recognizer = args.ios;
    return {
        type: args.type,
        view: args.view,
        ios: args.ios,
        android: undefined,
        rotation: recognizer.rotation * (180.0 / Math.PI),
        object: args.view,
        eventName: gestures_common_1.toString(args.type),
        state: getState(recognizer)
    };
}
var TouchGestureRecognizer = (function (_super) {
    __extends(TouchGestureRecognizer, _super);
    function TouchGestureRecognizer() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TouchGestureRecognizer.prototype.touchesBeganWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.down, touches, event);
        if (this.view) {
            this.view.touchesBeganWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.touchesMovedWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.move, touches, event);
        if (this.view) {
            this.view.touchesMovedWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.touchesEndedWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.up, touches, event);
        if (this.view) {
            this.view.touchesEndedWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.touchesCancelledWithEvent = function (touches, event) {
        this.executeCallback(gestures_common_1.TouchAction.cancel, touches, event);
        if (this.view) {
            this.view.touchesCancelledWithEvent(touches, event);
        }
    };
    TouchGestureRecognizer.prototype.executeCallback = function (action, touches, event) {
        if (!this._eventData) {
            this._eventData = new TouchGestureEventData();
        }
        this._eventData.prepare(this.observer.target, action, touches, event);
        this.observer._executeCallback(this._eventData);
    };
    return TouchGestureRecognizer;
}(UIGestureRecognizer));
var Pointer = (function () {
    function Pointer(touch, targetView) {
        this.android = undefined;
        this.ios = undefined;
        this.ios = touch;
        this._view = targetView;
    }
    Object.defineProperty(Pointer.prototype, "location", {
        get: function () {
            if (!this._location) {
                this._location = this.ios.locationInView(this._view.nativeViewProtected);
            }
            return this._location;
        },
        enumerable: true,
        configurable: true
    });
    Pointer.prototype.getX = function () {
        return this.location.x;
    };
    Pointer.prototype.getY = function () {
        return this.location.y;
    };
    return Pointer;
}());
var TouchGestureEventData = (function () {
    function TouchGestureEventData() {
        this.eventName = gestures_common_1.toString(gestures_common_1.GestureTypes.touch);
        this.type = gestures_common_1.GestureTypes.touch;
        this.android = undefined;
    }
    TouchGestureEventData.prototype.prepare = function (view, action, touches, event) {
        this.action = action;
        this.view = view;
        this.object = view;
        this.ios = {
            touches: touches,
            event: event
        };
        this._mainPointer = undefined;
        this._activePointers = undefined;
        this._allPointers = undefined;
    };
    TouchGestureEventData.prototype.getPointerCount = function () {
        return this.ios.event.allTouches.count;
    };
    TouchGestureEventData.prototype.getMainPointer = function () {
        if (this._mainPointer === undefined) {
            this._mainPointer = this.ios.touches.anyObject();
        }
        return this._mainPointer;
    };
    TouchGestureEventData.prototype.getActivePointers = function () {
        if (!this._activePointers) {
            this._activePointers = [];
            for (var i = 0, nsArr = this.ios.touches.allObjects; i < nsArr.count; i++) {
                this._activePointers.push(new Pointer(nsArr.objectAtIndex(i), this.view));
            }
        }
        return this._activePointers;
    };
    TouchGestureEventData.prototype.getAllPointers = function () {
        if (!this._allPointers) {
            this._allPointers = [];
            var nsArr = this.ios.event.allTouches.allObjects;
            for (var i = 0; i < nsArr.count; i++) {
                this._allPointers.push(new Pointer(nsArr.objectAtIndex(i), this.view));
            }
        }
        return this._allPointers;
    };
    TouchGestureEventData.prototype.getX = function () {
        return this.getMainPointer().locationInView(this.view.nativeViewProtected).x;
    };
    TouchGestureEventData.prototype.getY = function () {
        return this.getMainPointer().locationInView(this.view.nativeViewProtected).y;
    };
    return TouchGestureEventData;
}());
//# sourceMappingURL=gestures.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/label/label.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js");
var background_2 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base.js"));
var FixedSize;
(function (FixedSize) {
    FixedSize[FixedSize["NONE"] = 0] = "NONE";
    FixedSize[FixedSize["WIDTH"] = 1] = "WIDTH";
    FixedSize[FixedSize["HEIGHT"] = 2] = "HEIGHT";
    FixedSize[FixedSize["BOTH"] = 3] = "BOTH";
})(FixedSize || (FixedSize = {}));
var Label = (function (_super) {
    __extends(Label, _super);
    function Label() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Label.prototype.createNativeView = function () {
        var view = TNSLabel.new();
        view.userInteractionEnabled = true;
        return view;
    };
    Object.defineProperty(Label.prototype, "ios", {
        get: function () {
            return this.nativeTextViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Label.prototype, "textWrap", {
        get: function () {
            return this.style.whiteSpace === "normal";
        },
        set: function (value) {
            if (typeof value === "string") {
                value = text_base_1.booleanConverter(value);
            }
            this.style.whiteSpace = value ? "normal" : "nowrap";
        },
        enumerable: true,
        configurable: true
    });
    Label.prototype._requestLayoutOnTextChanged = function () {
        if (this._fixedSize === FixedSize.BOTH) {
            return;
        }
        if (this._fixedSize === FixedSize.WIDTH && !this.textWrap && this.getMeasuredHeight() > 0) {
            return;
        }
        _super.prototype._requestLayoutOnTextChanged.call(this);
    };
    Label.prototype.onMeasure = function (widthMeasureSpec, heightMeasureSpec) {
        var nativeView = this.nativeTextViewProtected;
        if (nativeView) {
            var width = text_base_1.layout.getMeasureSpecSize(widthMeasureSpec);
            var widthMode = text_base_1.layout.getMeasureSpecMode(widthMeasureSpec);
            var height = text_base_1.layout.getMeasureSpecSize(heightMeasureSpec);
            var heightMode = text_base_1.layout.getMeasureSpecMode(heightMeasureSpec);
            this._fixedSize = (widthMode === text_base_1.layout.EXACTLY ? FixedSize.WIDTH : FixedSize.NONE)
                | (heightMode === text_base_1.layout.EXACTLY ? FixedSize.HEIGHT : FixedSize.NONE);
            var nativeSize = void 0;
            if (this.textWrap) {
                nativeSize = this._measureNativeView(width, widthMode, height, heightMode);
            }
            else {
                nativeSize = text_base_1.layout.measureNativeView(nativeView, width, widthMode, height, heightMode);
            }
            var labelWidth = nativeSize.width;
            if (this.textWrap && widthMode === text_base_1.layout.AT_MOST) {
                labelWidth = Math.min(labelWidth, width);
            }
            var measureWidth = Math.max(labelWidth, this.effectiveMinWidth);
            var measureHeight = Math.max(nativeSize.height, this.effectiveMinHeight);
            var widthAndState = text_base_1.View.resolveSizeAndState(measureWidth, width, widthMode, 0);
            var heightAndState = text_base_1.View.resolveSizeAndState(measureHeight, height, heightMode, 0);
            this.setMeasuredDimension(widthAndState, heightAndState);
        }
    };
    Label.prototype._measureNativeView = function (width, widthMode, height, heightMode) {
        var view = this.nativeTextViewProtected;
        var nativeSize = view.textRectForBoundsLimitedToNumberOfLines(CGRectMake(0, 0, widthMode === 0 ? Number.POSITIVE_INFINITY : text_base_1.layout.toDeviceIndependentPixels(width), heightMode === 0 ? Number.POSITIVE_INFINITY : text_base_1.layout.toDeviceIndependentPixels(height)), 0).size;
        nativeSize.width = text_base_1.layout.round(text_base_1.layout.toDevicePixels(nativeSize.width));
        nativeSize.height = text_base_1.layout.round(text_base_1.layout.toDevicePixels(nativeSize.height));
        return nativeSize;
    };
    Label.prototype[text_base_1.whiteSpaceProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        switch (value) {
            case "normal":
                nativeView.lineBreakMode = 0;
                nativeView.numberOfLines = 0;
                break;
            case "nowrap":
            case "initial":
                nativeView.lineBreakMode = 4;
                nativeView.numberOfLines = 1;
                break;
        }
    };
    Label.prototype._redrawNativeBackground = function (value) {
        var _this = this;
        if (value instanceof background_1.Background) {
            background_2.ios.createBackgroundUIColor(this, function (color) {
                var cgColor = color ? color.CGColor : null;
                _this.nativeTextViewProtected.layer.backgroundColor = cgColor;
            }, true);
        }
        this._setNativeClipToBounds();
    };
    Label.prototype[text_base_1.borderTopWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderTopWidth),
            right: border.right,
            bottom: border.bottom,
            left: border.left
        };
    };
    Label.prototype[text_base_1.borderRightWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: border.top,
            right: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderRightWidth),
            bottom: border.bottom,
            left: border.left
        };
    };
    Label.prototype[text_base_1.borderBottomWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: border.top,
            right: border.right,
            bottom: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderBottomWidth),
            left: border.left
        };
    };
    Label.prototype[text_base_1.borderLeftWidthProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var border = nativeView.borderThickness;
        nativeView.borderThickness = {
            top: border.top,
            right: border.right,
            bottom: border.bottom,
            left: text_base_1.layout.toDeviceIndependentPixels(this.effectiveBorderLeftWidth)
        };
    };
    Label.prototype[text_base_1.paddingTopProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingTop),
            right: padding.right,
            bottom: padding.bottom,
            left: padding.left
        };
    };
    Label.prototype[text_base_1.paddingRightProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: padding.top,
            right: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingRight),
            bottom: padding.bottom,
            left: padding.left
        };
    };
    Label.prototype[text_base_1.paddingBottomProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: padding.top,
            right: padding.right,
            bottom: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingBottom),
            left: padding.left
        };
    };
    Label.prototype[text_base_1.paddingLeftProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        var padding = nativeView.padding;
        nativeView.padding = {
            top: padding.top,
            right: padding.right,
            bottom: padding.bottom,
            left: text_base_1.layout.toDeviceIndependentPixels(this.effectivePaddingLeft)
        };
    };
    Label = __decorate([
        text_base_1.CSSType("Label")
    ], Label);
    return Label;
}(text_base_1.TextBase));
exports.Label = Label;
Label.prototype.recycleNativeView = "auto";
//# sourceMappingURL=label.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var Background = (function () {
    function Background() {
        this.borderTopWidth = 0;
        this.borderRightWidth = 0;
        this.borderBottomWidth = 0;
        this.borderLeftWidth = 0;
        this.borderTopLeftRadius = 0;
        this.borderTopRightRadius = 0;
        this.borderBottomLeftRadius = 0;
        this.borderBottomRightRadius = 0;
    }
    Background.prototype.clone = function () {
        var clone = new Background();
        clone.color = this.color;
        clone.image = this.image;
        clone.repeat = this.repeat;
        clone.position = this.position;
        clone.size = this.size;
        clone.borderTopColor = this.borderTopColor;
        clone.borderRightColor = this.borderRightColor;
        clone.borderBottomColor = this.borderBottomColor;
        clone.borderLeftColor = this.borderLeftColor;
        clone.borderTopWidth = this.borderTopWidth;
        clone.borderRightWidth = this.borderRightWidth;
        clone.borderBottomWidth = this.borderBottomWidth;
        clone.borderLeftWidth = this.borderLeftWidth;
        clone.borderTopLeftRadius = this.borderTopLeftRadius;
        clone.borderTopRightRadius = this.borderTopRightRadius;
        clone.borderBottomRightRadius = this.borderBottomRightRadius;
        clone.borderBottomLeftRadius = this.borderBottomLeftRadius;
        clone.clipPath = this.clipPath;
        return clone;
    };
    Background.prototype.withColor = function (value) {
        var clone = this.clone();
        clone.color = value;
        return clone;
    };
    Background.prototype.withImage = function (value) {
        var clone = this.clone();
        clone.image = value;
        return clone;
    };
    Background.prototype.withRepeat = function (value) {
        var clone = this.clone();
        clone.repeat = value;
        return clone;
    };
    Background.prototype.withPosition = function (value) {
        var clone = this.clone();
        clone.position = value;
        return clone;
    };
    Background.prototype.withSize = function (value) {
        var clone = this.clone();
        clone.size = value;
        return clone;
    };
    Background.prototype.withBorderTopColor = function (value) {
        var clone = this.clone();
        clone.borderTopColor = value;
        return clone;
    };
    Background.prototype.withBorderRightColor = function (value) {
        var clone = this.clone();
        clone.borderRightColor = value;
        return clone;
    };
    Background.prototype.withBorderBottomColor = function (value) {
        var clone = this.clone();
        clone.borderBottomColor = value;
        return clone;
    };
    Background.prototype.withBorderLeftColor = function (value) {
        var clone = this.clone();
        clone.borderLeftColor = value;
        return clone;
    };
    Background.prototype.withBorderTopWidth = function (value) {
        var clone = this.clone();
        clone.borderTopWidth = value;
        return clone;
    };
    Background.prototype.withBorderRightWidth = function (value) {
        var clone = this.clone();
        clone.borderRightWidth = value;
        return clone;
    };
    Background.prototype.withBorderBottomWidth = function (value) {
        var clone = this.clone();
        clone.borderBottomWidth = value;
        return clone;
    };
    Background.prototype.withBorderLeftWidth = function (value) {
        var clone = this.clone();
        clone.borderLeftWidth = value;
        return clone;
    };
    Background.prototype.withBorderTopLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderTopLeftRadius = value;
        return clone;
    };
    Background.prototype.withBorderTopRightRadius = function (value) {
        var clone = this.clone();
        clone.borderTopRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomRightRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomRightRadius = value;
        return clone;
    };
    Background.prototype.withBorderBottomLeftRadius = function (value) {
        var clone = this.clone();
        clone.borderBottomLeftRadius = value;
        return clone;
    };
    Background.prototype.withClipPath = function (value) {
        var clone = this.clone();
        clone.clipPath = value;
        return clone;
    };
    Background.prototype.isEmpty = function () {
        return !this.color
            && !this.image
            && !this.hasBorderWidth()
            && !this.hasBorderRadius()
            && !this.clipPath;
    };
    Background.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        var imagesEqual = false;
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            imagesEqual = linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            imagesEqual = value1.image === value2.image;
        }
        return color_1.Color.equals(value1.color, value2.color)
            && imagesEqual
            && value1.position === value2.position
            && value1.repeat === value2.repeat
            && value1.size === value2.size
            && color_1.Color.equals(value1.borderTopColor, value2.borderTopColor)
            && color_1.Color.equals(value1.borderRightColor, value2.borderRightColor)
            && color_1.Color.equals(value1.borderBottomColor, value2.borderBottomColor)
            && color_1.Color.equals(value1.borderLeftColor, value2.borderLeftColor)
            && value1.borderTopWidth === value2.borderTopWidth
            && value1.borderRightWidth === value2.borderRightWidth
            && value1.borderBottomWidth === value2.borderBottomWidth
            && value1.borderLeftWidth === value2.borderLeftWidth
            && value1.borderTopLeftRadius === value2.borderTopLeftRadius
            && value1.borderTopRightRadius === value2.borderTopRightRadius
            && value1.borderBottomRightRadius === value2.borderBottomRightRadius
            && value1.borderBottomLeftRadius === value2.borderBottomLeftRadius
            && value1.clipPath === value2.clipPath;
    };
    Background.prototype.hasBorderColor = function () {
        return !!this.borderTopColor || !!this.borderRightColor || !!this.borderBottomColor || !!this.borderLeftColor;
    };
    Background.prototype.hasBorderWidth = function () {
        return this.borderTopWidth > 0
            || this.borderRightWidth > 0
            || this.borderBottomWidth > 0
            || this.borderLeftWidth > 0;
    };
    Background.prototype.hasBorderRadius = function () {
        return this.borderTopLeftRadius > 0
            || this.borderTopRightRadius > 0
            || this.borderBottomRightRadius > 0
            || this.borderBottomLeftRadius > 0;
    };
    Background.prototype.hasUniformBorderColor = function () {
        return color_1.Color.equals(this.borderTopColor, this.borderRightColor)
            && color_1.Color.equals(this.borderTopColor, this.borderBottomColor)
            && color_1.Color.equals(this.borderTopColor, this.borderLeftColor);
    };
    Background.prototype.hasUniformBorderWidth = function () {
        return this.borderTopWidth === this.borderRightWidth
            && this.borderTopWidth === this.borderBottomWidth
            && this.borderTopWidth === this.borderLeftWidth;
    };
    Background.prototype.hasUniformBorderRadius = function () {
        return this.borderTopLeftRadius === this.borderTopRightRadius
            && this.borderTopLeftRadius === this.borderBottomRightRadius
            && this.borderTopLeftRadius === this.borderBottomLeftRadius;
    };
    Background.prototype.hasUniformBorder = function () {
        return this.hasUniformBorderColor()
            && this.hasUniformBorderWidth()
            && this.hasUniformBorderRadius();
    };
    Background.prototype.getUniformBorderColor = function () {
        if (this.hasUniformBorderColor()) {
            return this.borderTopColor;
        }
        return undefined;
    };
    Background.prototype.getUniformBorderWidth = function () {
        if (this.hasUniformBorderWidth()) {
            return this.borderTopWidth;
        }
        return 0;
    };
    Background.prototype.getUniformBorderRadius = function () {
        if (this.hasUniformBorderRadius()) {
            return this.borderTopLeftRadius;
        }
        return 0;
    };
    Background.prototype.toString = function () {
        return "isEmpty: " + this.isEmpty() + "; color: " + this.color + "; image: " + this.image + "; repeat: " + this.repeat + "; position: " + this.position + "; size: " + this.size + "; borderTopColor: " + this.borderTopColor + "; borderRightColor: " + this.borderRightColor + "; borderBottomColor: " + this.borderBottomColor + "; borderLeftColor: " + this.borderLeftColor + "; borderTopWidth: " + this.borderTopWidth + "; borderRightWidth: " + this.borderRightWidth + "; borderBottomWidth: " + this.borderBottomWidth + "; borderLeftWidth: " + this.borderLeftWidth + "; borderTopLeftRadius: " + this.borderTopLeftRadius + "; borderTopRightRadius: " + this.borderTopRightRadius + "; borderBottomRightRadius: " + this.borderBottomRightRadius + "; borderBottomLeftRadius: " + this.borderBottomLeftRadius + "; clipPath: " + this.clipPath + ";";
    };
    Background.default = new Background();
    return Background;
}());
exports.Background = Background;
//# sourceMappingURL=background-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/background.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var image_source_1 = __webpack_require__("../node_modules/tns-core-modules/image-source/image-source.js");
var css_value_1 = __webpack_require__("../node_modules/tns-core-modules/css-value/index.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/background-common.js"));
var clearCGColor = UIColor.clearColor.CGColor;
var symbolUrl = Symbol("backgroundImageUrl");
var ios;
(function (ios) {
    function createBackgroundUIColor(view, callback, flip) {
        var background = view.style.backgroundInternal;
        var nativeView = view.nativeViewProtected;
        if (nativeView.hasNonUniformBorder) {
            unsubscribeFromScrollNotifications(view);
            clearNonUniformBorders(nativeView);
        }
        clearGradient(nativeView);
        if (background.image instanceof linear_gradient_1.LinearGradient) {
            drawGradient(nativeView, background.image);
        }
        var hasNonUniformBorderWidths = background.hasBorderWidth() && !background.hasUniformBorder();
        var hasNonUniformBorderRadiuses = background.hasBorderRadius() && !background.hasUniformBorderRadius();
        if (background.hasUniformBorderColor() && (hasNonUniformBorderWidths || hasNonUniformBorderRadiuses)) {
            drawUniformColorNonUniformBorders(nativeView, background);
            subscribeForScrollNotifications(view);
        }
        else if (background.hasUniformBorder()) {
            var layer = nativeView.layer;
            var borderColor = background.getUniformBorderColor();
            layer.borderColor = !borderColor ? undefined : borderColor.ios.CGColor;
            layer.borderWidth = utils_1.layout.toDeviceIndependentPixels(background.getUniformBorderWidth());
            var renderSize = view.getActualSize() || { width: 0, height: 0 };
            var cornerRadius = utils_1.layout.toDeviceIndependentPixels(background.getUniformBorderRadius());
            layer.cornerRadius = Math.min(Math.min(renderSize.width / 2, renderSize.height / 2), cornerRadius);
        }
        else {
            drawNoRadiusNonUniformBorders(nativeView, background);
            subscribeForScrollNotifications(view);
        }
        if (background.clipPath) {
            drawClipPath(nativeView, background);
        }
        if (!background.image || background.image instanceof linear_gradient_1.LinearGradient) {
            var uiColor = background.color ? background.color.ios : undefined;
            callback(uiColor);
        }
        else {
            setUIColorFromImage(view, nativeView, callback, flip);
        }
    }
    ios.createBackgroundUIColor = createBackgroundUIColor;
})(ios = exports.ios || (exports.ios = {}));
function onScroll(args) {
    var view = args.object;
    var nativeView = view.nativeViewProtected;
    if (nativeView instanceof UIScrollView) {
        adjustLayersForScrollView(nativeView);
    }
}
function adjustLayersForScrollView(nativeView) {
    var layer = nativeView.borderLayer;
    if (layer instanceof CALayer) {
        CATransaction.begin();
        CATransaction.setValueForKey(kCFBooleanTrue, kCATransactionDisableActions);
        var offset = nativeView.contentOffset;
        var transform = { a: 1, b: 0, c: 0, d: 1, tx: offset.x, ty: offset.y };
        layer.setAffineTransform(transform);
        if (nativeView.layer.mask) {
            nativeView.layer.mask.setAffineTransform(transform);
        }
        CATransaction.commit();
    }
}
function unsubscribeFromScrollNotifications(view) {
    if (view.nativeViewProtected instanceof UIScrollView) {
        view.off("scroll", onScroll);
    }
}
function subscribeForScrollNotifications(view) {
    if (view.nativeViewProtected instanceof UIScrollView) {
        view.on("scroll", onScroll);
        adjustLayersForScrollView(view.nativeViewProtected);
    }
}
function clearNonUniformBorders(nativeView) {
    if (nativeView.borderLayer) {
        nativeView.borderLayer.removeFromSuperlayer();
    }
    if (nativeView.hasBorderMask) {
        nativeView.layer.mask = nativeView.borderOriginalMask;
        nativeView.hasBorderMask = false;
        nativeView.borderOriginalMask = null;
    }
    if (nativeView.topBorderLayer) {
        nativeView.topBorderLayer.removeFromSuperlayer();
    }
    if (nativeView.rightBorderLayer) {
        nativeView.rightBorderLayer.removeFromSuperlayer();
    }
    if (nativeView.bottomBorderLayer) {
        nativeView.bottomBorderLayer.removeFromSuperlayer();
    }
    if (nativeView.leftBorderLayer) {
        nativeView.leftBorderLayer.removeFromSuperlayer();
    }
}
var pattern = /url\(('|")(.*?)\1\)/;
function setUIColorFromImage(view, nativeView, callback, flip) {
    var frame = nativeView.frame;
    var boundsWidth = view.scaleX ? frame.size.width / view.scaleX : frame.size.width;
    var boundsHeight = view.scaleY ? frame.size.height / view.scaleY : frame.size.height;
    if (!boundsWidth || !boundsHeight) {
        return undefined;
    }
    var style = view.style;
    var background = style.backgroundInternal;
    var imageUri = background.image;
    if (imageUri) {
        var match = imageUri.match(pattern);
        if (match && match[2]) {
            imageUri = match[2];
        }
    }
    var bitmap;
    if (utils_1.isDataURI(imageUri)) {
        var base64Data = imageUri.split(",")[1];
        if (base64Data !== undefined) {
            var imageSource = image_source_1.fromBase64(base64Data);
            bitmap = imageSource && imageSource.ios;
        }
    }
    else if (utils_1.isFileOrResourcePath(imageUri)) {
        var imageSource = image_source_1.fromFileOrResource(imageUri);
        bitmap = imageSource && imageSource.ios;
    }
    else if (imageUri.indexOf("http") !== -1) {
        style[symbolUrl] = imageUri;
        image_source_1.fromUrl(imageUri).then(function (r) {
            if (style && style[symbolUrl] === imageUri) {
                uiColorFromImage(r.ios, view, callback, flip);
            }
        });
    }
    uiColorFromImage(bitmap, view, callback, flip);
}
function parsePosition(pos) {
    var values = css_value_1.parse(pos);
    if (values.length === 2) {
        return { x: values[0], y: values[1] };
    }
    if (values.length === 1 && values[0].type === "ident") {
        var val = values[0].string.toLocaleLowerCase();
        var center = { type: "ident", string: "center" };
        if (val === "left" || val === "right") {
            return { x: values[0], y: center };
        }
        else if (val === "top" || val === "bottom") {
            return { x: center, y: values[0] };
        }
        else if (val === "center") {
            return { x: center, y: center };
        }
    }
    return null;
}
function getDrawParams(image, background, width, height) {
    if (!image) {
        return null;
    }
    var res = {
        repeatX: true,
        repeatY: true,
        posX: 0,
        posY: 0,
    };
    if (background.repeat) {
        switch (background.repeat.toLowerCase()) {
            case "no-repeat":
                res.repeatX = false;
                res.repeatY = false;
                break;
            case "repeat-x":
                res.repeatY = false;
                break;
            case "repeat-y":
                res.repeatX = false;
                break;
        }
    }
    var imageSize = image.size;
    var imageWidth = imageSize.width;
    var imageHeight = imageSize.height;
    var size = background.size;
    if (size) {
        var values = css_value_1.parse(size);
        if (values.length === 2) {
            var vx = values[0];
            var vy = values[1];
            if (vx.unit === "%" && vy.unit === "%") {
                imageWidth = width * vx.value / 100;
                imageHeight = height * vy.value / 100;
                res.sizeX = imageWidth;
                res.sizeY = imageHeight;
            }
            else if (vx.type === "number" && vy.type === "number" &&
                ((vx.unit === "px" && vy.unit === "px") || (vx.unit === "" && vy.unit === ""))) {
                imageWidth = vx.value;
                imageHeight = vy.value;
                res.sizeX = imageWidth;
                res.sizeY = imageHeight;
            }
        }
        else if (values.length === 1 && values[0].type === "ident") {
            var scale = 0;
            if (values[0].string === "cover") {
                scale = Math.max(width / imageWidth, height / imageHeight);
            }
            else if (values[0].string === "contain") {
                scale = Math.min(width / imageWidth, height / imageHeight);
            }
            if (scale > 0) {
                imageWidth *= scale;
                imageHeight *= scale;
                res.sizeX = imageWidth;
                res.sizeY = imageHeight;
            }
        }
    }
    var position = background.position;
    if (position) {
        var v = parsePosition(position);
        if (v) {
            var spaceX = width - imageWidth;
            var spaceY = height - imageHeight;
            if (v.x.unit === "%" && v.y.unit === "%") {
                res.posX = spaceX * v.x.value / 100;
                res.posY = spaceY * v.y.value / 100;
            }
            else if (v.x.type === "number" && v.y.type === "number" &&
                ((v.x.unit === "px" && v.y.unit === "px") || (v.x.unit === "" && v.y.unit === ""))) {
                res.posX = v.x.value;
                res.posY = v.y.value;
            }
            else if (v.x.type === "ident" && v.y.type === "ident") {
                if (v.x.string.toLowerCase() === "center") {
                    res.posX = spaceX / 2;
                }
                else if (v.x.string.toLowerCase() === "right") {
                    res.posX = spaceX;
                }
                if (v.y.string.toLowerCase() === "center") {
                    res.posY = spaceY / 2;
                }
                else if (v.y.string.toLowerCase() === "bottom") {
                    res.posY = spaceY;
                }
            }
        }
    }
    return res;
}
function uiColorFromImage(img, view, callback, flip) {
    var background = view.style.backgroundInternal;
    if (!img) {
        callback(background.color && background.color.ios);
        return;
    }
    var nativeView = view.nativeViewProtected;
    var frame = nativeView.frame;
    var boundsWidth = view.scaleX ? frame.size.width / view.scaleX : frame.size.width;
    var boundsHeight = view.scaleY ? frame.size.height / view.scaleY : frame.size.height;
    var params = getDrawParams(img, background, boundsWidth, boundsHeight);
    if (params.sizeX > 0 && params.sizeY > 0) {
        var resizeRect = CGRectMake(0, 0, params.sizeX, params.sizeY);
        UIGraphicsBeginImageContextWithOptions(resizeRect.size, false, 0.0);
        img.drawInRect(resizeRect);
        img = UIGraphicsGetImageFromCurrentImageContext();
        UIGraphicsEndImageContext();
    }
    UIGraphicsBeginImageContextWithOptions(CGSizeFromString("{" + boundsWidth + "," + boundsHeight + "}"), false, 0.0);
    var context = UIGraphicsGetCurrentContext();
    if (background.color && background.color.ios) {
        CGContextSetFillColorWithColor(context, background.color.ios.CGColor);
        CGContextFillRect(context, CGRectMake(0, 0, boundsWidth, boundsHeight));
    }
    if (!params.repeatX && !params.repeatY) {
        img.drawAtPoint(CGPointMake(params.posX, params.posY));
    }
    else {
        var w = params.repeatX ? boundsWidth : img.size.width;
        var h = params.repeatY ? boundsHeight : img.size.height;
        CGContextSetPatternPhase(context, CGSizeMake(params.posX, params.posY));
        params.posX = params.repeatX ? 0 : params.posX;
        params.posY = params.repeatY ? 0 : params.posY;
        var patternRect = CGRectMake(params.posX, params.posY, w, h);
        img.drawAsPatternInRect(patternRect);
    }
    var bkgImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    if (flip) {
        var flippedImage = _flipImage(bkgImage);
        callback(UIColor.alloc().initWithPatternImage(flippedImage));
    }
    else {
        callback(UIColor.alloc().initWithPatternImage(bkgImage));
    }
}
function _flipImage(originalImage) {
    UIGraphicsBeginImageContextWithOptions(originalImage.size, false, 0.0);
    var context = UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);
    CGContextTranslateCTM(context, 0.0, originalImage.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);
    originalImage.drawInRect(CGRectMake(0, 0, originalImage.size.width, originalImage.size.height));
    CGContextRestoreGState(context);
    var flippedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return flippedImage;
}
function cssValueToDeviceIndependentPixels(source, total) {
    source = source.trim();
    if (source.indexOf("px") !== -1) {
        return utils_1.layout.toDeviceIndependentPixels(parseFloat(source.replace("px", "")));
    }
    else if (source.indexOf("%") !== -1 && total > 0) {
        return (parseFloat(source.replace("%", "")) / 100) * total;
    }
    else {
        return parseFloat(source);
    }
}
function drawUniformColorNonUniformBorders(nativeView, background) {
    var layer = nativeView.layer;
    layer.backgroundColor = undefined;
    layer.borderColor = undefined;
    layer.borderWidth = 0;
    layer.cornerRadius = 0;
    var _a = layer.bounds.size, width = _a.width, height = _a.height;
    var _b = layer.bounds.origin, x = _b.x, y = _b.y;
    var left = x;
    var top = y;
    var right = x + width;
    var bottom = y + height;
    var min = Math.min, max = Math.max;
    var borderTopWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderTopWidth));
    var borderRightWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderRightWidth));
    var borderBottomWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderBottomWidth));
    var borderLeftWidth = max(0, utils_1.layout.toDeviceIndependentPixels(background.borderLeftWidth));
    var borderVWidth = borderTopWidth + borderBottomWidth;
    var borderHWidth = borderLeftWidth + borderRightWidth;
    var cappedBorderTopWidth = borderTopWidth && borderTopWidth * min(1, height / borderVWidth);
    var cappedBorderRightWidth = borderRightWidth && borderRightWidth * min(1, width / borderHWidth);
    var cappedBorderBottomWidth = borderBottomWidth && borderBottomWidth * min(1, height / borderVWidth);
    var cappedBorderLeftWidth = borderLeftWidth && borderLeftWidth * min(1, width / borderHWidth);
    var outerTopLeftRadius = utils_1.layout.toDeviceIndependentPixels(background.borderTopLeftRadius);
    var outerTopRightRadius = utils_1.layout.toDeviceIndependentPixels(background.borderTopRightRadius);
    var outerBottomRightRadius = utils_1.layout.toDeviceIndependentPixels(background.borderBottomRightRadius);
    var outerBottomLeftRadius = utils_1.layout.toDeviceIndependentPixels(background.borderBottomLeftRadius);
    var topRadii = outerTopLeftRadius + outerTopRightRadius;
    var rightRadii = outerTopRightRadius + outerBottomRightRadius;
    var bottomRadii = outerBottomRightRadius + outerBottomLeftRadius;
    var leftRadii = outerBottomLeftRadius + outerTopLeftRadius;
    function capRadius(a, b, c) {
        return a && Math.min(a, Math.min(b, c));
    }
    var cappedOuterTopLeftRadius = capRadius(outerTopLeftRadius, outerTopLeftRadius / topRadii * width, outerTopLeftRadius / leftRadii * height);
    var cappedOuterTopRightRadius = capRadius(outerTopRightRadius, outerTopRightRadius / topRadii * width, outerTopRightRadius / rightRadii * height);
    var cappedOuterBottomRightRadius = capRadius(outerBottomRightRadius, outerBottomRightRadius / bottomRadii * width, outerBottomRightRadius / rightRadii * height);
    var cappedOuterBottomLeftRadius = capRadius(outerBottomLeftRadius, outerBottomLeftRadius / bottomRadii * width, outerBottomLeftRadius / leftRadii * height);
    var clipPath = CGPathCreateMutable();
    CGPathMoveToPoint(clipPath, null, left + cappedOuterTopLeftRadius, top);
    CGPathAddArcToPoint(clipPath, null, right, top, right, top + cappedOuterTopRightRadius, cappedOuterTopRightRadius);
    CGPathAddArcToPoint(clipPath, null, right, bottom, right - cappedOuterBottomRightRadius, bottom, cappedOuterBottomRightRadius);
    CGPathAddArcToPoint(clipPath, null, left, bottom, left, bottom - cappedOuterBottomLeftRadius, cappedOuterBottomLeftRadius);
    CGPathAddArcToPoint(clipPath, null, left, top, left + cappedOuterTopLeftRadius, top, cappedOuterTopLeftRadius);
    CGPathCloseSubpath(clipPath);
    nativeView.borderOriginalMask = layer.mask;
    var clipShapeLayer = CAShapeLayer.layer();
    clipShapeLayer.path = clipPath;
    layer.mask = clipShapeLayer;
    nativeView.hasBorderMask = true;
    if (cappedBorderLeftWidth > 0 || cappedBorderTopWidth > 0 || cappedBorderRightWidth > 0 || cappedBorderBottomWidth > 0) {
        var borderPath = CGPathCreateMutable();
        CGPathAddRect(borderPath, null, CGRectMake(left, top, width, height));
        if (cappedBorderTopWidth > 0 || cappedBorderLeftWidth > 0) {
            CGPathMoveToPoint(borderPath, null, left + cappedOuterTopLeftRadius, top + cappedBorderTopWidth);
        }
        else {
            CGPathMoveToPoint(borderPath, null, left, top);
        }
        if (cappedBorderTopWidth > 0 || cappedBorderRightWidth > 0) {
            var innerTopRightWRadius = max(0, cappedOuterTopRightRadius - cappedBorderRightWidth);
            var innerTopRightHRadius = max(0, cappedOuterTopRightRadius - cappedBorderTopWidth);
            var innerTopRightMaxRadius = max(innerTopRightWRadius, innerTopRightHRadius);
            var innerTopRightTransform = CGAffineTransformMake(innerTopRightMaxRadius && innerTopRightWRadius / innerTopRightMaxRadius, 0, 0, innerTopRightMaxRadius && innerTopRightHRadius / innerTopRightMaxRadius, right - cappedBorderRightWidth - innerTopRightWRadius, top + cappedBorderTopWidth + innerTopRightHRadius);
            CGPathAddArc(borderPath, innerTopRightTransform, 0, 0, innerTopRightMaxRadius, Math.PI * 3 / 2, 0, false);
        }
        else {
            CGPathMoveToPoint(borderPath, null, right, top);
        }
        if (cappedBorderBottomWidth > 0 || cappedBorderRightWidth > 0) {
            var innerBottomRightWRadius = max(0, cappedOuterBottomRightRadius - cappedBorderRightWidth);
            var innerBottomRightHRadius = max(0, cappedOuterBottomRightRadius - cappedBorderBottomWidth);
            var innerBottomRightMaxRadius = max(innerBottomRightWRadius, innerBottomRightHRadius);
            var innerBottomRightTransform = CGAffineTransformMake(innerBottomRightMaxRadius && innerBottomRightWRadius / innerBottomRightMaxRadius, 0, 0, innerBottomRightMaxRadius && innerBottomRightHRadius / innerBottomRightMaxRadius, right - cappedBorderRightWidth - innerBottomRightWRadius, bottom - cappedBorderBottomWidth - innerBottomRightHRadius);
            CGPathAddArc(borderPath, innerBottomRightTransform, 0, 0, innerBottomRightMaxRadius, 0, Math.PI / 2, false);
        }
        else {
            CGPathAddLineToPoint(borderPath, null, right, bottom);
        }
        if (cappedBorderBottomWidth > 0 || cappedBorderLeftWidth > 0) {
            var innerBottomLeftWRadius = max(0, cappedOuterBottomLeftRadius - cappedBorderLeftWidth);
            var innerBottomLeftHRadius = max(0, cappedOuterBottomLeftRadius - cappedBorderBottomWidth);
            var innerBottomLeftMaxRadius = max(innerBottomLeftWRadius, innerBottomLeftHRadius);
            var innerBottomLeftTransform = CGAffineTransformMake(innerBottomLeftMaxRadius && innerBottomLeftWRadius / innerBottomLeftMaxRadius, 0, 0, innerBottomLeftMaxRadius && innerBottomLeftHRadius / innerBottomLeftMaxRadius, left + cappedBorderLeftWidth + innerBottomLeftWRadius, bottom - cappedBorderBottomWidth - innerBottomLeftHRadius);
            CGPathAddArc(borderPath, innerBottomLeftTransform, 0, 0, innerBottomLeftMaxRadius, Math.PI / 2, Math.PI, false);
        }
        else {
            CGPathAddLineToPoint(borderPath, null, left, bottom);
        }
        if (cappedBorderTopWidth > 0 || cappedBorderLeftWidth > 0) {
            var innerTopLeftWRadius = max(0, cappedOuterTopLeftRadius - cappedBorderLeftWidth);
            var innerTopLeftHRadius = max(0, cappedOuterTopLeftRadius - cappedBorderTopWidth);
            var innerTopLeftMaxRadius = max(innerTopLeftWRadius, innerTopLeftHRadius);
            var innerTopLeftTransform = CGAffineTransformMake(innerTopLeftMaxRadius && innerTopLeftWRadius / innerTopLeftMaxRadius, 0, 0, innerTopLeftMaxRadius && innerTopLeftHRadius / innerTopLeftMaxRadius, left + cappedBorderLeftWidth + innerTopLeftWRadius, top + cappedBorderTopWidth + innerTopLeftHRadius);
            CGPathAddArc(borderPath, innerTopLeftTransform, 0, 0, innerTopLeftMaxRadius, Math.PI, Math.PI * 3 / 2, false);
        }
        else {
            CGPathAddLineToPoint(borderPath, null, left, top);
        }
        CGPathCloseSubpath(borderPath);
        var borderLayer = CAShapeLayer.layer();
        borderLayer.fillColor = background.borderTopColor && background.borderTopColor.ios.CGColor || UIColor.blackColor.CGColor;
        borderLayer.fillRule = kCAFillRuleEvenOdd;
        borderLayer.path = borderPath;
        layer.addSublayer(borderLayer);
        nativeView.borderLayer = borderLayer;
    }
    nativeView.hasNonUniformBorder = true;
}
function drawNoRadiusNonUniformBorders(nativeView, background) {
    var borderLayer = CALayer.layer();
    nativeView.layer.addSublayer(borderLayer);
    nativeView.borderLayer = borderLayer;
    borderLayer.borderColor = undefined;
    borderLayer.borderWidth = 0;
    borderLayer.cornerRadius = 0;
    var layerBounds = nativeView.layer.bounds;
    var layerOrigin = layerBounds.origin;
    var layerSize = layerBounds.size;
    var nativeViewLayerBounds = {
        left: layerOrigin.x,
        top: layerOrigin.y,
        bottom: layerSize.height,
        right: layerSize.width
    };
    var top = utils_1.layout.toDeviceIndependentPixels(background.borderTopWidth);
    var right = utils_1.layout.toDeviceIndependentPixels(background.borderRightWidth);
    var bottom = utils_1.layout.toDeviceIndependentPixels(background.borderBottomWidth);
    var left = utils_1.layout.toDeviceIndependentPixels(background.borderLeftWidth);
    var lto = { x: nativeViewLayerBounds.left, y: nativeViewLayerBounds.top };
    var lti = { x: nativeViewLayerBounds.left + left, y: nativeViewLayerBounds.top + top };
    var rto = { x: nativeViewLayerBounds.right, y: nativeViewLayerBounds.top };
    var rti = { x: nativeViewLayerBounds.right - right, y: nativeViewLayerBounds.top + top };
    var rbo = { x: nativeViewLayerBounds.right, y: nativeViewLayerBounds.bottom };
    var rbi = { x: nativeViewLayerBounds.right - right, y: nativeViewLayerBounds.bottom - bottom };
    var lbo = { x: nativeViewLayerBounds.left, y: nativeViewLayerBounds.bottom };
    var lbi = { x: nativeViewLayerBounds.left + left, y: nativeViewLayerBounds.bottom - bottom };
    var hasNonUniformBorder;
    var borderTopColor = background.borderTopColor;
    if (top > 0 && borderTopColor && borderTopColor.ios) {
        var topBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(topBorderPath, null, lto.x, lto.y);
        CGPathAddLineToPoint(topBorderPath, null, rto.x, rto.y);
        CGPathAddLineToPoint(topBorderPath, null, rti.x, rti.y);
        CGPathAddLineToPoint(topBorderPath, null, lti.x, lti.y);
        CGPathAddLineToPoint(topBorderPath, null, lto.x, lto.y);
        var topBorderLayer = CAShapeLayer.layer();
        topBorderLayer.fillColor = background.borderTopColor.ios.CGColor;
        topBorderLayer.path = topBorderPath;
        borderLayer.addSublayer(topBorderLayer);
        nativeView.topBorderLayer = topBorderLayer;
        hasNonUniformBorder = true;
    }
    var borderRightColor = background.borderRightColor;
    if (right > 0 && borderRightColor && borderRightColor.ios) {
        var rightBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(rightBorderPath, null, rto.x, rto.y);
        CGPathAddLineToPoint(rightBorderPath, null, rbo.x, rbo.y);
        CGPathAddLineToPoint(rightBorderPath, null, rbi.x, rbi.y);
        CGPathAddLineToPoint(rightBorderPath, null, rti.x, rti.y);
        CGPathAddLineToPoint(rightBorderPath, null, rto.x, rto.y);
        var rightBorderLayer = CAShapeLayer.layer();
        rightBorderLayer.fillColor = background.borderRightColor.ios.CGColor;
        rightBorderLayer.path = rightBorderPath;
        borderLayer.addSublayer(rightBorderLayer);
        nativeView.rightBorderLayer = rightBorderLayer;
        hasNonUniformBorder = true;
    }
    var borderBottomColor = background.borderBottomColor;
    if (bottom > 0 && borderBottomColor && borderBottomColor.ios) {
        var bottomBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(bottomBorderPath, null, rbo.x, rbo.y);
        CGPathAddLineToPoint(bottomBorderPath, null, lbo.x, lbo.y);
        CGPathAddLineToPoint(bottomBorderPath, null, lbi.x, lbi.y);
        CGPathAddLineToPoint(bottomBorderPath, null, rbi.x, rbi.y);
        CGPathAddLineToPoint(bottomBorderPath, null, rbo.x, rbo.y);
        var bottomBorderLayer = CAShapeLayer.layer();
        bottomBorderLayer.fillColor = background.borderBottomColor.ios.CGColor;
        bottomBorderLayer.path = bottomBorderPath;
        borderLayer.addSublayer(bottomBorderLayer);
        nativeView.bottomBorderLayer = bottomBorderLayer;
        hasNonUniformBorder = true;
    }
    var borderLeftColor = background.borderLeftColor;
    if (left > 0 && borderLeftColor && borderLeftColor.ios) {
        var leftBorderPath = CGPathCreateMutable();
        CGPathMoveToPoint(leftBorderPath, null, lbo.x, lbo.y);
        CGPathAddLineToPoint(leftBorderPath, null, lto.x, lto.y);
        CGPathAddLineToPoint(leftBorderPath, null, lti.x, lti.y);
        CGPathAddLineToPoint(leftBorderPath, null, lbi.x, lbi.y);
        CGPathAddLineToPoint(leftBorderPath, null, lbo.x, lbo.y);
        var leftBorderLayer = CAShapeLayer.layer();
        leftBorderLayer.fillColor = background.borderLeftColor.ios.CGColor;
        leftBorderLayer.path = leftBorderPath;
        borderLayer.addSublayer(leftBorderLayer);
        nativeView.leftBorderLayer = leftBorderLayer;
        hasNonUniformBorder = true;
    }
    nativeView.hasNonUniformBorder = hasNonUniformBorder;
}
function drawGradient(nativeView, gradient) {
    var gradientLayer = CAGradientLayer.layer();
    gradientLayer.frame = nativeView.bounds;
    nativeView.gradientLayer = gradientLayer;
    var iosColors = NSMutableArray.alloc().initWithCapacity(gradient.colorStops.length);
    var iosStops = NSMutableArray.alloc().initWithCapacity(gradient.colorStops.length);
    var hasStops = false;
    gradient.colorStops.forEach(function (stop) {
        iosColors.addObject(stop.color.ios.CGColor);
        if (stop.offset) {
            iosStops.addObject(stop.offset.value);
            hasStops = true;
        }
    });
    gradientLayer.colors = iosColors;
    if (hasStops) {
        gradientLayer.locations = iosStops;
    }
    var alpha = gradient.angle / (Math.PI * 2);
    var startX = Math.pow(Math.sin(Math.PI * (alpha + 0.75)), 2);
    var startY = Math.pow(Math.sin(Math.PI * (alpha + 0.5)), 2);
    var endX = Math.pow(Math.sin(Math.PI * (alpha + 0.25)), 2);
    var endY = Math.pow(Math.sin(Math.PI * alpha), 2);
    gradientLayer.startPoint = { x: startX, y: startY };
    gradientLayer.endPoint = { x: endX, y: endY };
    nativeView.layer.insertSublayerAtIndex(gradientLayer, 0);
}
function clearGradient(nativeView) {
    if (nativeView.gradientLayer) {
        nativeView.gradientLayer.removeFromSuperlayer();
    }
}
function drawClipPath(nativeView, background) {
    var layer = nativeView.layer;
    var layerBounds = layer.bounds;
    var layerOrigin = layerBounds.origin;
    var layerSize = layerBounds.size;
    var bounds = {
        left: layerOrigin.x,
        top: layerOrigin.y,
        bottom: layerSize.height,
        right: layerSize.width
    };
    if (bounds.right === 0 || bounds.bottom === 0) {
        return;
    }
    var path;
    var clipPath = background.clipPath;
    var functionName = clipPath.substring(0, clipPath.indexOf("("));
    var value = clipPath.replace(functionName + "(", "").replace(")", "");
    switch (functionName) {
        case "rect":
            path = rectPath(value, bounds);
            break;
        case "inset":
            path = insetPath(value, bounds);
            break;
        case "circle":
            path = circlePath(value, bounds);
            break;
        case "ellipse":
            path = ellipsePath(value, bounds);
            break;
        case "polygon":
            path = polygonPath(value, bounds);
            break;
    }
    if (path) {
        var shape = CAShapeLayer.layer();
        shape.path = path;
        layer.mask = shape;
        nativeView.clipsToBounds = true;
        var borderWidth = background.getUniformBorderWidth();
        var borderColor = background.getUniformBorderColor();
        if (borderWidth > 0 && borderColor instanceof color_1.Color) {
            var borderLayer = CAShapeLayer.layer();
            borderLayer.path = path;
            borderLayer.lineWidth = borderWidth * 2;
            borderLayer.strokeColor = borderColor.ios.CGColor;
            borderLayer.fillColor = clearCGColor;
            borderLayer.frame = nativeView.bounds;
            layer.borderColor = undefined;
            layer.borderWidth = 0;
            layer.addSublayer(borderLayer);
        }
    }
}
function rectPath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var top = cssValueToDeviceIndependentPixels(arr[0], bounds.top);
    var right = cssValueToDeviceIndependentPixels(arr[1], bounds.right);
    var bottom = cssValueToDeviceIndependentPixels(arr[2], bounds.bottom);
    var left = cssValueToDeviceIndependentPixels(arr[3], bounds.left);
    return UIBezierPath.bezierPathWithRect(CGRectMake(left, top, right - left, bottom - top)).CGPath;
}
function insetPath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var topString;
    var rightString;
    var bottomString;
    var leftString;
    if (arr.length === 1) {
        topString = rightString = bottomString = leftString = arr[0];
    }
    else if (arr.length === 2) {
        topString = bottomString = arr[0];
        rightString = leftString = arr[1];
    }
    else if (arr.length === 3) {
        topString = arr[0];
        rightString = leftString = arr[1];
        bottomString = arr[2];
    }
    else if (arr.length === 4) {
        topString = arr[0];
        rightString = arr[1];
        bottomString = arr[2];
        leftString = arr[3];
    }
    var top = cssValueToDeviceIndependentPixels(topString, bounds.bottom);
    var right = cssValueToDeviceIndependentPixels("100%", bounds.right) - cssValueToDeviceIndependentPixels(rightString, bounds.right);
    var bottom = cssValueToDeviceIndependentPixels("100%", bounds.bottom) - cssValueToDeviceIndependentPixels(bottomString, bounds.bottom);
    var left = cssValueToDeviceIndependentPixels(leftString, bounds.right);
    return UIBezierPath.bezierPathWithRect(CGRectMake(left, top, right - left, bottom - top)).CGPath;
}
function circlePath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var radius = cssValueToDeviceIndependentPixels(arr[0], (bounds.right > bounds.bottom ? bounds.bottom : bounds.right) / 2);
    var y = cssValueToDeviceIndependentPixels(arr[2], bounds.bottom);
    var x = cssValueToDeviceIndependentPixels(arr[3], bounds.right);
    return UIBezierPath.bezierPathWithArcCenterRadiusStartAngleEndAngleClockwise(CGPointMake(x, y), radius, 0, 360, true).CGPath;
}
function ellipsePath(value, bounds) {
    var arr = value.split(/[\s]+/);
    var rX = cssValueToDeviceIndependentPixels(arr[0], bounds.right);
    var rY = cssValueToDeviceIndependentPixels(arr[1], bounds.bottom);
    var cX = cssValueToDeviceIndependentPixels(arr[3], bounds.right);
    var cY = cssValueToDeviceIndependentPixels(arr[4], bounds.bottom);
    var left = cX - rX;
    var top = cY - rY;
    var width = rX * 2;
    var height = rY * 2;
    return UIBezierPath.bezierPathWithOvalInRect(CGRectMake(left, top, width, height)).CGPath;
}
function polygonPath(value, bounds) {
    var path = CGPathCreateMutable();
    var firstPoint;
    var arr = value.split(/[,]+/);
    for (var i = 0; i < arr.length; i++) {
        var xy = arr[i].trim().split(/[\s]+/);
        var point = {
            x: cssValueToDeviceIndependentPixels(xy[0], bounds.right),
            y: cssValueToDeviceIndependentPixels(xy[1], bounds.bottom)
        };
        if (!firstPoint) {
            firstPoint = point;
            CGPathMoveToPoint(path, null, point.x, point.y);
        }
        CGPathAddLineToPoint(path, null, point.x, point.y);
    }
    CGPathAddLineToPoint(path, null, firstPoint.x, firstPoint.y);
    return path;
}
//# sourceMappingURL=background.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/converters.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var enums_1 = __webpack_require__("../node_modules/tns-core-modules/ui/enums/enums.js");
var STYLE_CURVE_MAP = Object.freeze({
    "ease": enums_1.AnimationCurve.ease,
    "linear": enums_1.AnimationCurve.linear,
    "ease-in": enums_1.AnimationCurve.easeIn,
    "ease-out": enums_1.AnimationCurve.easeOut,
    "ease-in-out": enums_1.AnimationCurve.easeInOut,
    "spring": enums_1.AnimationCurve.spring,
});
function timeConverter(value) {
    var result = parseFloat(value);
    if (value.indexOf("ms") === -1) {
        result = result * 1000;
    }
    return Math.max(0.0, result);
}
exports.timeConverter = timeConverter;
function animationTimingFunctionConverter(value) {
    return value ?
        STYLE_CURVE_MAP[value] || parseCubicBezierCurve(value) :
        enums_1.AnimationCurve.ease;
}
exports.animationTimingFunctionConverter = animationTimingFunctionConverter;
function parseCubicBezierCurve(value) {
    var coordsString = /\((.*?)\)/.exec(value);
    var coords = coordsString && coordsString[1]
        .split(",")
        .map(stringToBezieCoords);
    if (value.startsWith("cubic-bezier") &&
        coordsString &&
        coords.length === 4) {
        var _a = coords.slice(), x1 = _a[0], x2 = _a[1], y1_1 = _a[2], y2 = _a[3];
        return enums_1.AnimationCurve.cubicBezier(x1, x2, y1_1, y2);
    }
    else {
        throw new Error("Invalid value for animation: " + value);
    }
}
function stringToBezieCoords(value) {
    var result = parseFloat(value);
    if (result < 0) {
        return 0;
    }
    else if (result > 1) {
        return 1;
    }
    return result;
}
//# sourceMappingURL=converters.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-animation-parser.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var keyframe_animation_1 = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
var converters_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/converters.js");
var style_properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/style-properties.js");
var ANIMATION_PROPERTY_HANDLERS = Object.freeze({
    "animation-name": function (info, value) { return info.name = value; },
    "animation-duration": function (info, value) { return info.duration = converters_1.timeConverter(value); },
    "animation-delay": function (info, value) { return info.delay = converters_1.timeConverter(value); },
    "animation-timing-function": function (info, value) { return info.curve = converters_1.animationTimingFunctionConverter(value); },
    "animation-iteration-count": function (info, value) { return info.iterations = value === "infinite" ? Number.MAX_VALUE : parseFloat(value); },
    "animation-direction": function (info, value) { return info.isReverse = value === "reverse"; },
    "animation-fill-mode": function (info, value) { return info.isForwards = value === "forwards"; }
});
var CssAnimationParser = (function () {
    function CssAnimationParser() {
    }
    CssAnimationParser.keyframeAnimationsFromCSSDeclarations = function (declarations) {
        if (declarations === null || declarations === undefined) {
            return undefined;
        }
        var animations = new Array();
        var animationInfo = undefined;
        declarations.forEach(function (_a) {
            var property = _a.property, value = _a.value;
            if (property === "animation") {
                keyframeAnimationsFromCSSProperty(value, animations);
            }
            else {
                var propertyHandler = ANIMATION_PROPERTY_HANDLERS[property];
                if (propertyHandler) {
                    if (animationInfo === undefined) {
                        animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
                        animations.push(animationInfo);
                    }
                    propertyHandler(animationInfo, value);
                }
            }
        });
        return animations.length === 0 ? undefined : animations;
    };
    CssAnimationParser.keyframesArrayFromCSS = function (keyframes) {
        var parsedKeyframes = new Array();
        for (var _i = 0, keyframes_1 = keyframes; _i < keyframes_1.length; _i++) {
            var keyframe = keyframes_1[_i];
            var declarations = parseKeyframeDeclarations(keyframe.declarations);
            for (var _a = 0, _b = keyframe.values; _a < _b.length; _a++) {
                var time_1 = _b[_a];
                if (time_1 === "from") {
                    time_1 = 0;
                }
                else if (time_1 === "to") {
                    time_1 = 1;
                }
                else {
                    time_1 = parseFloat(time_1) / 100;
                    if (time_1 < 0) {
                        time_1 = 0;
                    }
                    if (time_1 > 100) {
                        time_1 = 100;
                    }
                }
                var current = parsedKeyframes[time_1];
                if (current === undefined) {
                    current = {};
                    current.duration = time_1;
                    parsedKeyframes[time_1] = current;
                }
                for (var _c = 0, _d = keyframe.declarations; _c < _d.length; _c++) {
                    var declaration = _d[_c];
                    if (declaration.property === "animation-timing-function") {
                        current.curve = converters_1.animationTimingFunctionConverter(declaration.value);
                    }
                }
                current.declarations = declarations;
            }
        }
        var array = new Array();
        for (var parsedKeyframe in parsedKeyframes) {
            array.push(parsedKeyframes[parsedKeyframe]);
        }
        array.sort(function (a, b) { return a.duration - b.duration; });
        return array;
    };
    return CssAnimationParser;
}());
exports.CssAnimationParser = CssAnimationParser;
function keyframeAnimationsFromCSSProperty(value, animations) {
    if (typeof value === "string") {
        var values = value.split(/[,]+/);
        for (var _i = 0, values_1 = values; _i < values_1.length; _i++) {
            var parsedValue = values_1[_i];
            var animationInfo = new keyframe_animation_1.KeyframeAnimationInfo();
            var arr = parsedValue.trim().split(/[ ]+/);
            if (arr.length > 0) {
                animationInfo.name = arr[0];
            }
            if (arr.length > 1) {
                animationInfo.duration = converters_1.timeConverter(arr[1]);
            }
            if (arr.length > 2) {
                animationInfo.curve = converters_1.animationTimingFunctionConverter(arr[2]);
            }
            if (arr.length > 3) {
                animationInfo.delay = converters_1.timeConverter(arr[3]);
            }
            if (arr.length > 4) {
                animationInfo.iterations = parseInt(arr[4]);
            }
            if (arr.length > 5) {
                animationInfo.isReverse = arr[4] === "reverse";
            }
            if (arr.length > 6) {
                animationInfo.isForwards = arr[5] === "forwards";
            }
            if (arr.length > 7) {
                throw new Error("Invalid value for animation: " + value);
            }
            animations.push(animationInfo);
        }
    }
}
function parseKeyframeDeclarations(unparsedKeyframeDeclarations) {
    var declarations = unparsedKeyframeDeclarations
        .reduce(function (declarations, _a) {
        var unparsedProperty = _a.property, unparsedValue = _a.value;
        var property = properties_1.CssAnimationProperty._getByCssName(unparsedProperty);
        if (typeof unparsedProperty === "string" && property && property._valueConverter) {
            declarations[property.name] = property._valueConverter(unparsedValue);
        }
        else if (typeof unparsedValue === "string" && unparsedProperty === "transform") {
            var transformations = style_properties_1.transformConverter(unparsedValue);
            Object.assign(declarations, transformations);
        }
        return declarations;
    }, {});
    return Object.keys(declarations).map(function (property) { return ({ property: property, value: declarations[property] }); });
}
exports.parseKeyframeDeclarations = parseKeyframeDeclarations;
//# sourceMappingURL=css-animation-parser.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var Match;
(function (Match) {
    Match.Dynamic = true;
    Match.Static = false;
})(Match || (Match = {}));
function getNodeDirectSibling(node) {
    if (!node.parent || !node.parent.getChildIndex || !node.parent.getChildAt) {
        return null;
    }
    var nodeIndex = node.parent.getChildIndex(node);
    if (nodeIndex === 0) {
        return null;
    }
    return node.parent.getChildAt(nodeIndex - 1);
}
function SelectorProperties(specificity, rarity, dynamic) {
    if (dynamic === void 0) { dynamic = false; }
    return function (cls) {
        cls.prototype.specificity = specificity;
        cls.prototype.rarity = rarity;
        cls.prototype.combinator = undefined;
        cls.prototype.dynamic = dynamic;
        return cls;
    };
}
var SelectorCore = (function () {
    function SelectorCore() {
    }
    SelectorCore.prototype.lookupSort = function (sorter, base) { sorter.sortAsUniversal(base || this); };
    SelectorCore = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], SelectorCore);
    return SelectorCore;
}());
exports.SelectorCore = SelectorCore;
var SimpleSelector = (function (_super) {
    __extends(SimpleSelector, _super);
    function SimpleSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SimpleSelector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        else if (this.mayMatch(node)) {
            this.trackChanges(node, map);
            return true;
        }
        return false;
    };
    SimpleSelector.prototype.mayMatch = function (node) { return this.match(node); };
    SimpleSelector.prototype.trackChanges = function (node, map) {
    };
    return SimpleSelector;
}(SelectorCore));
exports.SimpleSelector = SimpleSelector;
function wrap(text) {
    return text ? " " + text + " " : "";
}
var InvalidSelector = (function (_super) {
    __extends(InvalidSelector, _super);
    function InvalidSelector(e) {
        var _this = _super.call(this) || this;
        _this.e = e;
        return _this;
    }
    InvalidSelector.prototype.toString = function () { return "<error: " + this.e + ">"; };
    InvalidSelector.prototype.match = function (node) { return false; };
    InvalidSelector.prototype.lookupSort = function (sorter, base) {
    };
    InvalidSelector = __decorate([
        SelectorProperties(0, 4, Match.Static)
    ], InvalidSelector);
    return InvalidSelector;
}(SimpleSelector));
exports.InvalidSelector = InvalidSelector;
var UniversalSelector = (function (_super) {
    __extends(UniversalSelector, _super);
    function UniversalSelector() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UniversalSelector.prototype.toString = function () { return "*" + wrap(this.combinator); };
    UniversalSelector.prototype.match = function (node) { return true; };
    UniversalSelector = __decorate([
        SelectorProperties(0, 0, Match.Static)
    ], UniversalSelector);
    return UniversalSelector;
}(SimpleSelector));
exports.UniversalSelector = UniversalSelector;
var IdSelector = (function (_super) {
    __extends(IdSelector, _super);
    function IdSelector(id) {
        var _this = _super.call(this) || this;
        _this.id = id;
        return _this;
    }
    IdSelector.prototype.toString = function () { return "#" + this.id + wrap(this.combinator); };
    IdSelector.prototype.match = function (node) { return node.id === this.id; };
    IdSelector.prototype.lookupSort = function (sorter, base) { sorter.sortById(this.id, base || this); };
    IdSelector = __decorate([
        SelectorProperties(65536, 3, Match.Static)
    ], IdSelector);
    return IdSelector;
}(SimpleSelector));
exports.IdSelector = IdSelector;
var TypeSelector = (function (_super) {
    __extends(TypeSelector, _super);
    function TypeSelector(cssType) {
        var _this = _super.call(this) || this;
        _this.cssType = cssType;
        return _this;
    }
    TypeSelector.prototype.toString = function () { return "" + this.cssType + wrap(this.combinator); };
    TypeSelector.prototype.match = function (node) { return node.cssType === this.cssType; };
    TypeSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByType(this.cssType, base || this); };
    TypeSelector = __decorate([
        SelectorProperties(1, 1, Match.Static)
    ], TypeSelector);
    return TypeSelector;
}(SimpleSelector));
exports.TypeSelector = TypeSelector;
var ClassSelector = (function (_super) {
    __extends(ClassSelector, _super);
    function ClassSelector(cssClass) {
        var _this = _super.call(this) || this;
        _this.cssClass = cssClass;
        return _this;
    }
    ClassSelector.prototype.toString = function () { return "." + this.cssClass + wrap(this.combinator); };
    ClassSelector.prototype.match = function (node) { return node.cssClasses && node.cssClasses.has(this.cssClass); };
    ClassSelector.prototype.lookupSort = function (sorter, base) { sorter.sortByClass(this.cssClass, base || this); };
    ClassSelector = __decorate([
        SelectorProperties(256, 2, Match.Static)
    ], ClassSelector);
    return ClassSelector;
}(SimpleSelector));
exports.ClassSelector = ClassSelector;
var AttributeSelector = (function (_super) {
    __extends(AttributeSelector, _super);
    function AttributeSelector(attribute, test, value) {
        var _this = _super.call(this) || this;
        _this.attribute = attribute;
        _this.test = test;
        _this.value = value;
        if (!test) {
            _this.match = function (node) { return !types_1.isNullOrUndefined(node[attribute]); };
            return _this;
        }
        if (!value) {
            _this.match = function (node) { return false; };
        }
        var escapedValue = utils_common_1.escapeRegexSymbols(value);
        var regexp = null;
        switch (test) {
            case "^=":
                regexp = new RegExp("^" + escapedValue);
                break;
            case "$=":
                regexp = new RegExp(escapedValue + "$");
                break;
            case "*=":
                regexp = new RegExp(escapedValue);
                break;
            case "=":
                regexp = new RegExp("^" + escapedValue + "$");
                break;
            case "~=":
                if (/\s/.test(value)) {
                    _this.match = function (node) { return false; };
                    return _this;
                }
                regexp = new RegExp("(^|\\s)" + escapedValue + "(\\s|$)");
                break;
            case "|=":
                regexp = new RegExp("^" + escapedValue + "(-|$)");
                break;
        }
        if (regexp) {
            _this.match = function (node) { return regexp.test(node[attribute] + ""); };
            return _this;
        }
        else {
            _this.match = function (node) { return false; };
            return _this;
        }
    }
    AttributeSelector.prototype.toString = function () { return "[" + this.attribute + wrap(this.test) + ((this.test && this.value) || "") + "]" + wrap(this.combinator); };
    AttributeSelector.prototype.match = function (node) { return false; };
    AttributeSelector.prototype.mayMatch = function (node) { return true; };
    AttributeSelector.prototype.trackChanges = function (node, map) { map.addAttribute(node, this.attribute); };
    AttributeSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], AttributeSelector);
    return AttributeSelector;
}(SimpleSelector));
exports.AttributeSelector = AttributeSelector;
var PseudoClassSelector = (function (_super) {
    __extends(PseudoClassSelector, _super);
    function PseudoClassSelector(cssPseudoClass) {
        var _this = _super.call(this) || this;
        _this.cssPseudoClass = cssPseudoClass;
        return _this;
    }
    PseudoClassSelector.prototype.toString = function () { return ":" + this.cssPseudoClass + wrap(this.combinator); };
    PseudoClassSelector.prototype.match = function (node) { return node.cssPseudoClasses && node.cssPseudoClasses.has(this.cssPseudoClass); };
    PseudoClassSelector.prototype.mayMatch = function (node) { return true; };
    PseudoClassSelector.prototype.trackChanges = function (node, map) { map.addPseudoClass(node, this.cssPseudoClass); };
    PseudoClassSelector = __decorate([
        SelectorProperties(256, 0, Match.Dynamic)
    ], PseudoClassSelector);
    return PseudoClassSelector;
}(SimpleSelector));
exports.PseudoClassSelector = PseudoClassSelector;
var SimpleSelectorSequence = (function (_super) {
    __extends(SimpleSelectorSequence, _super);
    function SimpleSelectorSequence(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.head = _this.selectors.reduce(function (prev, curr) { return !prev || (curr.rarity > prev.rarity) ? curr : prev; }, null);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    SimpleSelectorSequence.prototype.toString = function () { return "" + this.selectors.join("") + wrap(this.combinator); };
    SimpleSelectorSequence.prototype.match = function (node) { return this.selectors.every(function (sel) { return sel.match(node); }); };
    SimpleSelectorSequence.prototype.mayMatch = function (node) {
        return this.selectors.every(function (sel) { return sel.mayMatch(node); });
    };
    SimpleSelectorSequence.prototype.trackChanges = function (node, map) {
        this.selectors.forEach(function (sel) { return sel.trackChanges(node, map); });
    };
    SimpleSelectorSequence.prototype.lookupSort = function (sorter, base) {
        this.head.lookupSort(sorter, base || this);
    };
    return SimpleSelectorSequence;
}(SimpleSelector));
exports.SimpleSelectorSequence = SimpleSelectorSequence;
var Selector = (function (_super) {
    __extends(Selector, _super);
    function Selector(selectors) {
        var _this = _super.call(this) || this;
        _this.selectors = selectors;
        var supportedCombinator = [undefined, " ", ">", "+"];
        var siblingGroup;
        var lastGroup;
        var groups = [];
        selectors.reverse().forEach(function (sel) {
            if (supportedCombinator.indexOf(sel.combinator) === -1) {
                throw new Error("Unsupported combinator \"" + sel.combinator + "\".");
            }
            if (sel.combinator === undefined || sel.combinator === " ") {
                groups.push(lastGroup = [siblingGroup = []]);
            }
            if (sel.combinator === ">") {
                lastGroup.push(siblingGroup = []);
            }
            siblingGroup.push(sel);
        });
        _this.groups = groups.map(function (g) {
            return new Selector.ChildGroup(g.map(function (sg) {
                return new Selector.SiblingGroup(sg);
            }));
        });
        _this.last = selectors[0];
        _this.specificity = selectors.reduce(function (sum, sel) { return sel.specificity + sum; }, 0);
        _this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        return _this;
    }
    Selector.prototype.toString = function () { return this.selectors.join(""); };
    Selector.prototype.match = function (node) {
        return this.groups.every(function (group, i) {
            if (i === 0) {
                node = group.match(node);
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    if (node = group.match(ancestor)) {
                        return true;
                    }
                }
                return false;
            }
        });
    };
    Selector.prototype.lookupSort = function (sorter, base) {
        this.last.lookupSort(sorter, this);
    };
    Selector.prototype.accumulateChanges = function (node, map) {
        if (!this.dynamic) {
            return this.match(node);
        }
        var bounds = [];
        var mayMatch = this.groups.every(function (group, i) {
            if (i === 0) {
                var nextNode = group.mayMatch(node);
                bounds.push({ left: node, right: node });
                node = nextNode;
                return !!node;
            }
            else {
                var ancestor = node;
                while (ancestor = ancestor.parent) {
                    var nextNode = group.mayMatch(ancestor);
                    if (nextNode) {
                        bounds.push({ left: ancestor, right: null });
                        node = nextNode;
                        return true;
                    }
                }
                return false;
            }
        });
        if (!mayMatch) {
            return false;
        }
        if (!map) {
            return mayMatch;
        }
        for (var i = 0; i < this.groups.length; i++) {
            var group_1 = this.groups[i];
            if (!group_1.dynamic) {
                continue;
            }
            var bound = bounds[i];
            var node_1 = bound.left;
            do {
                if (group_1.mayMatch(node_1)) {
                    group_1.trackChanges(node_1, map);
                }
            } while ((node_1 !== bound.right) && (node_1 = node_1.parent));
        }
        return mayMatch;
    };
    return Selector;
}(SelectorCore));
exports.Selector = Selector;
(function (Selector) {
    var ChildGroup = (function () {
        function ChildGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        ChildGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.match(node); }) ? node : null;
        };
        ChildGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = node.parent) && !!sel.mayMatch(node); }) ? node : null;
        };
        ChildGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = node.parent) && sel.trackChanges(node, map); });
        };
        return ChildGroup;
    }());
    Selector.ChildGroup = ChildGroup;
    var SiblingGroup = (function () {
        function SiblingGroup(selectors) {
            this.selectors = selectors;
            this.dynamic = selectors.some(function (sel) { return sel.dynamic; });
        }
        SiblingGroup.prototype.match = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.match(node); }) ? node : null;
        };
        SiblingGroup.prototype.mayMatch = function (node) {
            return this.selectors.every(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.mayMatch(node); }) ? node : null;
        };
        SiblingGroup.prototype.trackChanges = function (node, map) {
            this.selectors.forEach(function (sel, i) { return (i === 0 ? node : node = getNodeDirectSibling(node)) && sel.trackChanges(node, map); });
        };
        return SiblingGroup;
    }());
    Selector.SiblingGroup = SiblingGroup;
})(Selector = exports.Selector || (exports.Selector = {}));
exports.Selector = Selector;
var RuleSet = (function () {
    function RuleSet(selectors, declarations) {
        var _this = this;
        this.selectors = selectors;
        this.declarations = declarations;
        this.selectors.forEach(function (sel) { return sel.ruleset = _this; });
    }
    RuleSet.prototype.toString = function () { return this.selectors.join(", ") + " {" + this.declarations.map(function (d, i) { return "" + (i === 0 ? " " : "") + d.property + ": " + d.value; }).join("; ") + " }"; };
    RuleSet.prototype.lookupSort = function (sorter) { this.selectors.forEach(function (sel) { return sel.lookupSort(sorter); }); };
    return RuleSet;
}());
exports.RuleSet = RuleSet;
function fromAstNodes(astRules) {
    return astRules.filter(isRule).map(function (rule) {
        var declarations = rule.declarations.filter(isDeclaration).map(createDeclaration);
        var selectors = rule.selectors.map(createSelector);
        var ruleset = new RuleSet(selectors, declarations);
        return ruleset;
    });
}
exports.fromAstNodes = fromAstNodes;
function createDeclaration(decl) {
    return { property: decl.property.toLowerCase(), value: decl.value };
}
function createSimpleSelectorFromAst(ast) {
    switch (ast.type) {
        case "*": return new UniversalSelector();
        case "#": return new IdSelector(ast.identifier);
        case "": return new TypeSelector(ast.identifier.replace(/-/, "").toLowerCase());
        case ".": return new ClassSelector(ast.identifier);
        case ":": return new PseudoClassSelector(ast.identifier);
        case "[]": return ast.test ? new AttributeSelector(ast.property, ast.test, ast.value) : new AttributeSelector(ast.property);
    }
}
function createSimpleSelectorSequenceFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty simple selector sequence."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorFromAst(ast[0]);
    }
    else {
        return new SimpleSelectorSequence(ast.map(createSimpleSelectorFromAst));
    }
}
function createSelectorFromAst(ast) {
    if (ast.length === 0) {
        return new InvalidSelector(new Error("Empty selector."));
    }
    else if (ast.length === 1) {
        return createSimpleSelectorSequenceFromAst(ast[0][0]);
    }
    else {
        var simpleSelectorSequences = [];
        var simpleSelectorSequence = void 0;
        var combinator = void 0;
        for (var i = 0; i < ast.length; i++) {
            simpleSelectorSequence = createSimpleSelectorSequenceFromAst(ast[i][0]);
            combinator = ast[i][1];
            if (combinator) {
                simpleSelectorSequence.combinator = combinator;
            }
            simpleSelectorSequences.push(simpleSelectorSequence);
        }
        return new Selector(simpleSelectorSequences);
    }
}
function createSelector(sel) {
    try {
        var parsedSelector = parser.parseSelector(sel);
        if (!parsedSelector) {
            return new InvalidSelector(new Error("Empty selector"));
        }
        return createSelectorFromAst(parsedSelector.value);
    }
    catch (e) {
        return new InvalidSelector(e);
    }
}
exports.createSelector = createSelector;
function isRule(node) {
    return node.type === "rule";
}
function isDeclaration(node) {
    return node.type === "declaration";
}
var SelectorsMap = (function () {
    function SelectorsMap(rulesets) {
        var _this = this;
        this.id = {};
        this.class = {};
        this.type = {};
        this.universal = [];
        this.position = 0;
        rulesets.forEach(function (rule) { return rule.lookupSort(_this); });
    }
    SelectorsMap.prototype.query = function (node) {
        var _this = this;
        var selectorClasses = [
            this.universal,
            this.id[node.id],
            this.type[node.cssType]
        ];
        if (node.cssClasses) {
            node.cssClasses.forEach(function (c) { return selectorClasses.push(_this.class[c]); });
        }
        var selectors = selectorClasses
            .filter(function (arr) { return !!arr; })
            .reduce(function (cur, next) { return cur.concat(next); }, []);
        var selectorsMatch = new SelectorsMatch();
        selectorsMatch.selectors = selectors
            .filter(function (sel) { return sel.sel.accumulateChanges(node, selectorsMatch); })
            .sort(function (a, b) { return a.sel.specificity - b.sel.specificity || a.pos - b.pos; })
            .map(function (docSel) { return docSel.sel; });
        return selectorsMatch;
    };
    SelectorsMap.prototype.sortById = function (id, sel) { this.addToMap(this.id, id, sel); };
    SelectorsMap.prototype.sortByClass = function (cssClass, sel) {
        this.addToMap(this.class, cssClass, sel);
    };
    SelectorsMap.prototype.sortByType = function (cssType, sel) {
        this.addToMap(this.type, cssType, sel);
    };
    SelectorsMap.prototype.sortAsUniversal = function (sel) { this.universal.push(this.makeDocSelector(sel)); };
    SelectorsMap.prototype.addToMap = function (map, head, sel) {
        this.position++;
        var list = map[head];
        if (list) {
            list.push(this.makeDocSelector(sel));
        }
        else {
            map[head] = [this.makeDocSelector(sel)];
        }
    };
    SelectorsMap.prototype.makeDocSelector = function (sel) {
        return { sel: sel, pos: this.position++ };
    };
    return SelectorsMap;
}());
exports.SelectorsMap = SelectorsMap;
var SelectorsMatch = (function () {
    function SelectorsMatch() {
        this.changeMap = new Map();
    }
    SelectorsMatch.prototype.addAttribute = function (node, attribute) {
        var deps = this.properties(node);
        if (!deps.attributes) {
            deps.attributes = new Set();
        }
        deps.attributes.add(attribute);
    };
    SelectorsMatch.prototype.addPseudoClass = function (node, pseudoClass) {
        var deps = this.properties(node);
        if (!deps.pseudoClasses) {
            deps.pseudoClasses = new Set();
        }
        deps.pseudoClasses.add(pseudoClass);
    };
    SelectorsMatch.prototype.properties = function (node) {
        var set = this.changeMap.get(node);
        if (!set) {
            this.changeMap.set(node, set = {});
        }
        return set;
    };
    return SelectorsMatch;
}());
exports.SelectorsMatch = SelectorsMatch;
//# sourceMappingURL=css-selector.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font-common.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var Font = (function () {
    function Font(fontFamily, fontSize, fontStyle, fontWeight) {
        this.fontFamily = fontFamily;
        this.fontSize = fontSize;
        this.fontStyle = fontStyle;
        this.fontWeight = fontWeight;
    }
    Object.defineProperty(Font.prototype, "isItalic", {
        get: function () {
            return this.fontStyle === FontStyle.ITALIC;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Font.prototype, "isBold", {
        get: function () {
            return this.fontWeight === FontWeight.SEMI_BOLD ||
                this.fontWeight === FontWeight.BOLD ||
                this.fontWeight === "700" ||
                this.fontWeight === FontWeight.EXTRA_BOLD ||
                this.fontWeight === FontWeight.BLACK;
        },
        enumerable: true,
        configurable: true
    });
    Font.equals = function (value1, value2) {
        if (!value1 && !value2) {
            return true;
        }
        if (!value1 || !value2) {
            return false;
        }
        return value1.fontFamily === value2.fontFamily &&
            value1.fontSize === value2.fontSize &&
            value1.fontStyle === value2.fontStyle &&
            value1.fontWeight === value2.fontWeight;
    };
    Font.default = undefined;
    return Font;
}());
exports.Font = Font;
var FontStyle;
(function (FontStyle) {
    FontStyle.NORMAL = "normal";
    FontStyle.ITALIC = "italic";
    FontStyle.isValid = properties_1.makeValidator(FontStyle.NORMAL, FontStyle.ITALIC);
    FontStyle.parse = properties_1.makeParser(FontStyle.isValid);
})(FontStyle = exports.FontStyle || (exports.FontStyle = {}));
var FontWeight;
(function (FontWeight) {
    FontWeight.THIN = "100";
    FontWeight.EXTRA_LIGHT = "200";
    FontWeight.LIGHT = "300";
    FontWeight.NORMAL = "normal";
    FontWeight.MEDIUM = "500";
    FontWeight.SEMI_BOLD = "600";
    FontWeight.BOLD = "bold";
    FontWeight.EXTRA_BOLD = "800";
    FontWeight.BLACK = "900";
    FontWeight.isValid = properties_1.makeValidator(FontWeight.THIN, FontWeight.EXTRA_LIGHT, FontWeight.LIGHT, FontWeight.NORMAL, "400", FontWeight.MEDIUM, FontWeight.SEMI_BOLD, FontWeight.BOLD, "700", FontWeight.EXTRA_BOLD, FontWeight.BLACK);
    FontWeight.parse = properties_1.makeParser(FontWeight.isValid);
})(FontWeight = exports.FontWeight || (exports.FontWeight = {}));
function parseFontFamily(value) {
    var result = new Array();
    if (!value) {
        return result;
    }
    var split = value.split(",");
    for (var i = 0; i < split.length; i++) {
        var str = split[i].trim().replace(/['"]+/g, "");
        if (str) {
            result.push(str);
        }
    }
    return result;
}
exports.parseFontFamily = parseFontFamily;
var genericFontFamilies;
(function (genericFontFamilies) {
    genericFontFamilies.serif = "serif";
    genericFontFamilies.sansSerif = "sans-serif";
    genericFontFamilies.monospace = "monospace";
    genericFontFamilies.system = "system";
})(genericFontFamilies = exports.genericFontFamilies || (exports.genericFontFamilies = {}));
var styles = new Set();
[
    FontStyle.NORMAL,
    FontStyle.ITALIC
].forEach(function (val, i, a) { return styles.add(val); });
var weights = new Set();
[
    FontWeight.THIN,
    FontWeight.EXTRA_LIGHT,
    FontWeight.LIGHT,
    FontWeight.NORMAL,
    "400",
    FontWeight.MEDIUM,
    FontWeight.SEMI_BOLD,
    FontWeight.BOLD,
    "700",
    FontWeight.EXTRA_BOLD,
    FontWeight.BLACK
].forEach(function (val, i, a) { return weights.add(val); });
function parseFont(fontValue) {
    var result = {
        fontStyle: "normal",
        fontVariant: "normal",
        fontWeight: "normal"
    };
    var parts = fontValue.split(/\s+/);
    var part;
    while (part = parts.shift()) {
        if (part === "normal") {
        }
        else if (part === "small-caps") {
            result.fontVariant = part;
        }
        else if (styles.has(part)) {
            result.fontStyle = part;
        }
        else if (weights.has(part)) {
            result.fontWeight = part;
        }
        else if (!result.fontSize) {
            var sizes = part.split("/");
            result.fontSize = sizes[0];
            result.lineHeight = sizes.length > 1 ? sizes[1] : undefined;
        }
        else {
            result.fontFamily = part;
            if (parts.length) {
                result.fontFamily += " " + parts.join(" ");
            }
            break;
        }
    }
    return result;
}
exports.parseFont = parseFont;
//# sourceMappingURL=font-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/font.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var fs = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/styling/font-common.js"));
var EMULATE_OBLIQUE = true;
var OBLIQUE_TRANSFORM = CGAffineTransformMake(1, 0, 0.2, 1, 0, 0);
var DEFAULT_SERIF = "Times New Roman";
var DEFAULT_MONOSPACE = "Courier New";
var SUPPORT_FONT_WEIGHTS = parseFloat(platform_1.device.osVersion) >= 10.0;
var Font = (function (_super) {
    __extends(Font, _super);
    function Font(family, size, style, weight) {
        return _super.call(this, family, size, style, weight) || this;
    }
    Font.prototype.withFontFamily = function (family) {
        return new Font(family, this.fontSize, this.fontStyle, this.fontWeight);
    };
    Font.prototype.withFontStyle = function (style) {
        return new Font(this.fontFamily, this.fontSize, style, this.fontWeight);
    };
    Font.prototype.withFontWeight = function (weight) {
        return new Font(this.fontFamily, this.fontSize, this.fontStyle, weight);
    };
    Font.prototype.withFontSize = function (size) {
        return new Font(this.fontFamily, size, this.fontStyle, this.fontWeight);
    };
    Font.prototype.getUIFont = function (defaultFont) {
        if (!this._uiFont) {
            this._uiFont = createUIFont(this, defaultFont);
        }
        return this._uiFont;
    };
    Font.prototype.getAndroidTypeface = function () {
        return undefined;
    };
    Font.default = new Font(undefined, undefined, font_common_1.FontStyle.NORMAL, font_common_1.FontWeight.NORMAL);
    return Font;
}(font_common_1.Font));
exports.Font = Font;
function getFontFamilyRespectingGenericFonts(fontFamily) {
    if (!fontFamily) {
        return fontFamily;
    }
    switch (fontFamily.toLowerCase()) {
        case font_common_1.genericFontFamilies.serif:
            return DEFAULT_SERIF;
        case font_common_1.genericFontFamilies.monospace:
            return DEFAULT_MONOSPACE;
        default:
            return fontFamily;
    }
}
function shouldUseSystemFont(fontFamily) {
    return !fontFamily ||
        fontFamily === font_common_1.genericFontFamilies.sansSerif ||
        fontFamily === font_common_1.genericFontFamilies.system;
}
function getNativeFontWeight(fontWeight) {
    switch (fontWeight) {
        case font_common_1.FontWeight.THIN:
            return UIFontWeightUltraLight;
        case font_common_1.FontWeight.EXTRA_LIGHT:
            return UIFontWeightThin;
        case font_common_1.FontWeight.LIGHT:
            return UIFontWeightLight;
        case font_common_1.FontWeight.NORMAL:
        case "400":
        case undefined:
        case null:
            return UIFontWeightRegular;
        case font_common_1.FontWeight.MEDIUM:
            return UIFontWeightMedium;
        case font_common_1.FontWeight.SEMI_BOLD:
            return UIFontWeightSemibold;
        case font_common_1.FontWeight.BOLD:
        case "700":
            return UIFontWeightBold;
        case font_common_1.FontWeight.EXTRA_BOLD:
            return UIFontWeightHeavy;
        case font_common_1.FontWeight.BLACK:
            return UIFontWeightBlack;
        default:
            throw new Error("Invalid font weight: \"" + fontWeight + "\"");
    }
}
function getSystemFont(size, nativeWeight, italic, symbolicTraits) {
    var result = UIFont.systemFontOfSizeWeight(size, nativeWeight);
    if (italic) {
        var descriptor = result.fontDescriptor.fontDescriptorWithSymbolicTraits(symbolicTraits);
        result = UIFont.fontWithDescriptorSize(descriptor, size);
    }
    return result;
}
function createUIFont(font, defaultFont) {
    var _a, _b;
    var result;
    var size = font.fontSize || defaultFont.pointSize;
    var nativeWeight = getNativeFontWeight(font.fontWeight);
    var fontFamilies = font_common_1.parseFontFamily(font.fontFamily);
    var symbolicTraits = 0;
    if (font.isBold) {
        symbolicTraits |= 2;
    }
    if (font.isItalic) {
        symbolicTraits |= 1;
    }
    var fontDescriptorTraits = (_a = {},
        _a[UIFontSymbolicTrait] = symbolicTraits,
        _a);
    if (SUPPORT_FONT_WEIGHTS) {
        fontDescriptorTraits[UIFontWeightTrait] = nativeWeight;
    }
    for (var i = 0; i < fontFamilies.length; i++) {
        var fontFamily = getFontFamilyRespectingGenericFonts(fontFamilies[i]);
        if (shouldUseSystemFont(fontFamily)) {
            result = getSystemFont(size, nativeWeight, font.isItalic, symbolicTraits);
            break;
        }
        else {
            var fontAttributes = (_b = {},
                _b[UIFontDescriptorFamilyAttribute] = fontFamily,
                _b[UIFontDescriptorTraitsAttribute] = fontDescriptorTraits,
                _b);
            var descriptor = UIFontDescriptor.fontDescriptorWithFontAttributes(fontAttributes);
            result = UIFont.fontWithDescriptorSize(descriptor, size);
            var actualItalic = result.fontDescriptor.symbolicTraits & 1;
            if (font.isItalic && !actualItalic && EMULATE_OBLIQUE) {
                descriptor = descriptor.fontDescriptorWithMatrix(OBLIQUE_TRANSFORM);
                result = UIFont.fontWithDescriptorSize(descriptor, size);
            }
            if (result.familyName === fontFamily) {
                break;
            }
            else {
                result = null;
            }
        }
    }
    if (!result) {
        result = getSystemFont(size, nativeWeight, font.isItalic, symbolicTraits);
    }
    return result;
}
var ios;
(function (ios) {
    function registerFont(fontFile) {
        var filePath = fs.path.join(fs.knownFolders.currentApp().path, "fonts", fontFile);
        if (!fs.File.exists(filePath)) {
            filePath = fs.path.join(fs.knownFolders.currentApp().path, fontFile);
        }
        var fontData = NSFileManager.defaultManager.contentsAtPath(filePath);
        if (!fontData) {
            throw new Error("Could not load font from: " + fontFile);
        }
        var provider = CGDataProviderCreateWithCFData(fontData);
        var font = CGFontCreateWithDataProvider(provider);
        if (!font) {
            throw new Error("Could not load font from: " + fontFile);
        }
        var error = new interop.Reference();
        if (!CTFontManagerRegisterGraphicsFont(font, error)) {
            if (trace_1.isEnabled()) {
                trace_1.write("Error occur while registering font: " + CFErrorCopyDescription(error.value), trace_1.categories.Error, trace_1.messageType.error);
            }
        }
    }
    ios.registerFont = registerFont;
})(ios = exports.ios || (exports.ios = {}));
function registerFontsInFolder(fontsFolderPath) {
    var fontsFolder = fs.Folder.fromPath(fontsFolderPath);
    fontsFolder.eachEntity(function (fileEntity) {
        if (fs.Folder.exists(fs.path.join(fontsFolderPath, fileEntity.name))) {
            return true;
        }
        if (fileEntity instanceof fs.File &&
            (fileEntity.extension === ".ttf" || fileEntity.extension === ".otf")) {
            ios.registerFont(fileEntity.name);
        }
        return true;
    });
}
function registerCustomFonts() {
    var appDir = fs.knownFolders.currentApp().path;
    var fontsDir = fs.path.join(appDir, "fonts");
    if (fs.Folder.exists(fontsDir)) {
        registerFontsInFolder(fontsDir);
    }
}
registerCustomFonts();
//# sourceMappingURL=font.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/linear-gradient.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var LinearGradient = (function () {
    function LinearGradient() {
    }
    LinearGradient.parse = function (value) {
        var result = new LinearGradient();
        result.angle = value.angle;
        result.colorStops = value.colors.map(function (color) {
            var offset = color.offset || null;
            var offsetUnit;
            if (offset && offset.unit === "%") {
                offsetUnit = {
                    unit: "%",
                    value: offset.value
                };
            }
            return {
                color: new color_1.Color(color.argb),
                offset: offsetUnit
            };
        });
        return result;
    };
    LinearGradient.equals = function (first, second) {
        if (!first && !second) {
            return true;
        }
        else if (!first || !second) {
            return false;
        }
        if (first.angle !== second.angle) {
            return false;
        }
        if (first.colorStops.length !== second.colorStops.length) {
            return false;
        }
        for (var i = 0; i < first.colorStops.length; i++) {
            var firstStop = first.colorStops[i];
            var secondStop = second.colorStops[i];
            if (firstStop.offset !== secondStop.offset) {
                return false;
            }
            if (!color_1.Color.equals(firstStop.color, secondStop.color)) {
                return false;
            }
        }
        return true;
    };
    return LinearGradient;
}());
exports.LinearGradient = LinearGradient;
//# sourceMappingURL=linear-gradient.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-properties.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var color_1 = __webpack_require__("../node_modules/tns-core-modules/color/color.js");
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils.js");
var background_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/background.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var number_utils_1 = __webpack_require__("../node_modules/tns-core-modules/utils/number-utils.js");
var matrix_1 = __webpack_require__("../node_modules/tns-core-modules/matrix/matrix.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var parser = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var linear_gradient_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/linear-gradient.js");
function equalsCommon(a, b) {
    if (a == "auto") {
        return b == "auto";
    }
    if (typeof a === "number") {
        if (b == "auto") {
            return false;
        }
        if (typeof b === "number") {
            return a == b;
        }
        if (!b) {
            return false;
        }
        return b.unit == "dip" && a == b.value;
    }
    if (b == "auto") {
        return false;
    }
    if (typeof b === "number") {
        return a ? (a.unit == "dip" && a.value == b) : false;
    }
    if (!a || !b) {
        return false;
    }
    return a.value == b.value && a.unit == b.unit;
}
function convertToStringCommon(length) {
    if (length == "auto") {
        return "auto";
    }
    if (typeof length === "number") {
        return length.toString();
    }
    var val = length.value;
    if (length.unit === "%") {
        val *= 100;
    }
    return val + length.unit;
}
function toDevicePixelsCommon(length, auto, parentAvailableWidth) {
    if (auto === void 0) { auto = Number.NaN; }
    if (parentAvailableWidth === void 0) { parentAvailableWidth = Number.NaN; }
    if (length == "auto") {
        return auto;
    }
    if (typeof length === "number") {
        return utils_1.layout.round(utils_1.layout.toDevicePixels(length));
    }
    if (!length) {
        return auto;
    }
    switch (length.unit) {
        case "px":
            return utils_1.layout.round(length.value);
        case "%":
            return utils_1.layout.round(parentAvailableWidth * length.value);
        case "dip":
        default:
            return utils_1.layout.round(utils_1.layout.toDevicePixels(length.value));
    }
}
var PercentLength;
(function (PercentLength) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            var percentIndex = stringValue.indexOf("%");
            if (percentIndex !== -1) {
                var value = void 0;
                if (percentIndex !== (stringValue.length - 1) || percentIndex === 0) {
                    value = Number.NaN;
                }
                else {
                    value = parseFloat(stringValue.substring(0, stringValue.length - 1).trim()) / 100;
                }
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "%", value: value };
            }
            else if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + fromValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    PercentLength.parse = parse;
    PercentLength.equals = equalsCommon;
    PercentLength.toDevicePixels = toDevicePixelsCommon;
    PercentLength.convertToString = convertToStringCommon;
})(PercentLength = exports.PercentLength || (exports.PercentLength = {}));
var Length;
(function (Length) {
    function parse(fromValue) {
        if (fromValue == "auto") {
            return "auto";
        }
        if (typeof fromValue === "string") {
            var stringValue = fromValue.trim();
            if (stringValue.indexOf("px") !== -1) {
                stringValue = stringValue.replace("px", "").trim();
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return { unit: "px", value: value };
            }
            else {
                var value = parseFloat(stringValue);
                if (isNaN(value) || !isFinite(value)) {
                    throw new Error("Invalid value: " + stringValue);
                }
                return value;
            }
        }
        else {
            return fromValue;
        }
    }
    Length.parse = parse;
    Length.equals = equalsCommon;
    Length.toDevicePixels = toDevicePixelsCommon;
    Length.convertToString = convertToStringCommon;
})(Length = exports.Length || (exports.Length = {}));
exports.zeroLength = { value: 0, unit: "px" };
exports.minWidthProperty = new properties_1.CssProperty({
    name: "minWidth", cssName: "min-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinWidth = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minWidthProperty.register(properties_1.Style);
exports.minHeightProperty = new properties_1.CssProperty({
    name: "minHeight", cssName: "min-height", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectiveMinHeight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.minHeightProperty.register(properties_1.Style);
exports.widthProperty = new properties_1.CssAnimationProperty({
    name: "width", cssName: "width", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse
});
exports.widthProperty.register(properties_1.Style);
exports.heightProperty = new properties_1.CssAnimationProperty({
    name: "height", cssName: "height", defaultValue: "auto", equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        if (platform_1.isIOS) {
            var view = target.viewRef.get();
            if (view) {
                view.requestLayout();
            }
        }
    }, valueConverter: PercentLength.parse,
});
exports.heightProperty.register(properties_1.Style);
var marginProperty = new properties_1.ShorthandProperty({
    name: "margin", cssName: "margin",
    getter: function () {
        if (PercentLength.equals(this.marginTop, this.marginRight) &&
            PercentLength.equals(this.marginTop, this.marginBottom) &&
            PercentLength.equals(this.marginTop, this.marginLeft)) {
            return this.marginTop;
        }
        return PercentLength.convertToString(this.marginTop) + " " + PercentLength.convertToString(this.marginRight) + " " + PercentLength.convertToString(this.marginBottom) + " " + PercentLength.convertToString(this.marginLeft);
    },
    converter: convertToMargins
});
marginProperty.register(properties_1.Style);
exports.marginLeftProperty = new properties_1.CssProperty({ name: "marginLeft", cssName: "margin-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginLeftProperty.register(properties_1.Style);
exports.marginRightProperty = new properties_1.CssProperty({ name: "marginRight", cssName: "margin-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginRightProperty.register(properties_1.Style);
exports.marginTopProperty = new properties_1.CssProperty({ name: "marginTop", cssName: "margin-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginTopProperty.register(properties_1.Style);
exports.marginBottomProperty = new properties_1.CssProperty({ name: "marginBottom", cssName: "margin-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals, valueConverter: PercentLength.parse });
exports.marginBottomProperty.register(properties_1.Style);
var paddingProperty = new properties_1.ShorthandProperty({
    name: "padding", cssName: "padding",
    getter: function () {
        if (Length.equals(this.paddingTop, this.paddingRight) &&
            Length.equals(this.paddingTop, this.paddingBottom) &&
            Length.equals(this.paddingTop, this.paddingLeft)) {
            return this.paddingTop;
        }
        return Length.convertToString(this.paddingTop) + " " + Length.convertToString(this.paddingRight) + " " + Length.convertToString(this.paddingBottom) + " " + Length.convertToString(this.paddingLeft);
    },
    converter: convertToPaddings
});
paddingProperty.register(properties_1.Style);
exports.paddingLeftProperty = new properties_1.CssProperty({
    name: "paddingLeft", cssName: "padding-left", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingLeft = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingLeftProperty.register(properties_1.Style);
exports.paddingRightProperty = new properties_1.CssProperty({
    name: "paddingRight", cssName: "padding-right", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingRight = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingRightProperty.register(properties_1.Style);
exports.paddingTopProperty = new properties_1.CssProperty({
    name: "paddingTop", cssName: "padding-top", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingTop = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingTopProperty.register(properties_1.Style);
exports.paddingBottomProperty = new properties_1.CssProperty({
    name: "paddingBottom", cssName: "padding-bottom", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.effectivePaddingBottom = Length.toDevicePixels(newValue, 0);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }, valueConverter: Length.parse
});
exports.paddingBottomProperty.register(properties_1.Style);
var HorizontalAlignment;
(function (HorizontalAlignment) {
    HorizontalAlignment.LEFT = "left";
    HorizontalAlignment.CENTER = "center";
    HorizontalAlignment.RIGHT = "right";
    HorizontalAlignment.STRETCH = "stretch";
    HorizontalAlignment.isValid = properties_1.makeValidator(HorizontalAlignment.LEFT, HorizontalAlignment.CENTER, HorizontalAlignment.RIGHT, HorizontalAlignment.STRETCH);
    HorizontalAlignment.parse = properties_1.makeParser(HorizontalAlignment.isValid);
})(HorizontalAlignment = exports.HorizontalAlignment || (exports.HorizontalAlignment = {}));
exports.horizontalAlignmentProperty = new properties_1.CssProperty({ name: "horizontalAlignment", cssName: "horizontal-align", defaultValue: HorizontalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: HorizontalAlignment.parse });
exports.horizontalAlignmentProperty.register(properties_1.Style);
var VerticalAlignment;
(function (VerticalAlignment) {
    VerticalAlignment.TOP = "top";
    VerticalAlignment.MIDDLE = "middle";
    VerticalAlignment.BOTTOM = "bottom";
    VerticalAlignment.STRETCH = "stretch";
    VerticalAlignment.isValid = properties_1.makeValidator(VerticalAlignment.TOP, VerticalAlignment.MIDDLE, VerticalAlignment.BOTTOM, VerticalAlignment.STRETCH);
    VerticalAlignment.parse = function (value) { return value.toLowerCase() === "center" ? VerticalAlignment.MIDDLE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(VerticalAlignment.isValid);
})(VerticalAlignment = exports.VerticalAlignment || (exports.VerticalAlignment = {}));
exports.verticalAlignmentProperty = new properties_1.CssProperty({ name: "verticalAlignment", cssName: "vertical-align", defaultValue: VerticalAlignment.STRETCH, affectsLayout: platform_1.isIOS, valueConverter: VerticalAlignment.parse });
exports.verticalAlignmentProperty.register(properties_1.Style);
function parseThickness(value) {
    if (typeof value === "string") {
        var arr = value.split(/[ ,]+/);
        var top_1;
        var right = void 0;
        var bottom = void 0;
        var left = void 0;
        if (arr.length === 1) {
            top_1 = arr[0];
            right = arr[0];
            bottom = arr[0];
            left = arr[0];
        }
        else if (arr.length === 2) {
            top_1 = arr[0];
            bottom = arr[0];
            right = arr[1];
            left = arr[1];
        }
        else if (arr.length === 3) {
            top_1 = arr[0];
            right = arr[1];
            left = arr[1];
            bottom = arr[2];
        }
        else if (arr.length === 4) {
            top_1 = arr[0];
            right = arr[1];
            bottom = arr[2];
            left = arr[3];
        }
        else {
            throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
        }
        return {
            top: top_1,
            right: right,
            bottom: bottom,
            left: left
        };
    }
    else {
        return value;
    }
}
function convertToMargins(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.marginTopProperty, PercentLength.parse(thickness.top)],
            [exports.marginRightProperty, PercentLength.parse(thickness.right)],
            [exports.marginBottomProperty, PercentLength.parse(thickness.bottom)],
            [exports.marginLeftProperty, PercentLength.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.marginTopProperty, value],
            [exports.marginRightProperty, value],
            [exports.marginBottomProperty, value],
            [exports.marginLeftProperty, value]
        ];
    }
}
function convertToPaddings(value) {
    if (typeof value === "string" && value !== "auto") {
        var thickness = parseThickness(value);
        return [
            [exports.paddingTopProperty, Length.parse(thickness.top)],
            [exports.paddingRightProperty, Length.parse(thickness.right)],
            [exports.paddingBottomProperty, Length.parse(thickness.bottom)],
            [exports.paddingLeftProperty, Length.parse(thickness.left)]
        ];
    }
    else {
        return [
            [exports.paddingTopProperty, value],
            [exports.paddingRightProperty, value],
            [exports.paddingBottomProperty, value],
            [exports.paddingLeftProperty, value]
        ];
    }
}
exports.rotateProperty = new properties_1.CssAnimationProperty({ name: "rotate", cssName: "rotate", defaultValue: 0, valueConverter: parseFloat });
exports.rotateProperty.register(properties_1.Style);
exports.scaleXProperty = new properties_1.CssAnimationProperty({ name: "scaleX", cssName: "scaleX", defaultValue: 1, valueConverter: parseFloat });
exports.scaleXProperty.register(properties_1.Style);
exports.scaleYProperty = new properties_1.CssAnimationProperty({ name: "scaleY", cssName: "scaleY", defaultValue: 1, valueConverter: parseFloat });
exports.scaleYProperty.register(properties_1.Style);
function parseDIPs(value) {
    if (value.indexOf("px") !== -1) {
        return utils_1.layout.toDeviceIndependentPixels(parseFloat(value.replace("px", "").trim()));
    }
    else {
        return parseFloat(value.replace("dip", "").trim());
    }
}
exports.translateXProperty = new properties_1.CssAnimationProperty({ name: "translateX", cssName: "translateX", defaultValue: 0, valueConverter: parseDIPs });
exports.translateXProperty.register(properties_1.Style);
exports.translateYProperty = new properties_1.CssAnimationProperty({ name: "translateY", cssName: "translateY", defaultValue: 0, valueConverter: parseDIPs });
exports.translateYProperty.register(properties_1.Style);
var transformProperty = new properties_1.ShorthandProperty({
    name: "transform", cssName: "transform",
    getter: function () {
        var scaleX = this.scaleX;
        var scaleY = this.scaleY;
        var translateX = this.translateX;
        var translateY = this.translateY;
        var rotate = this.rotate;
        var result = "";
        if (translateX !== 0 || translateY !== 0) {
            result += "translate(" + translateX + ", " + translateY + ") ";
        }
        if (scaleX !== 1 || scaleY !== 1) {
            result += "scale(" + scaleX + ", " + scaleY + ") ";
        }
        if (rotate !== 0) {
            result += "rotate (" + rotate + ")";
        }
        return result.trim();
    },
    converter: convertToTransform
});
transformProperty.register(properties_1.Style);
var IDENTITY_TRANSFORMATION = {
    translate: { x: 0, y: 0 },
    rotate: 0,
    scale: { x: 1, y: 1 },
};
var TRANSFORM_SPLITTER = new RegExp(/\s*(.+?)\((.*?)\)/g);
var TRANSFORMATIONS = Object.freeze([
    "rotate",
    "translate",
    "translate3d",
    "translateX",
    "translateY",
    "scale",
    "scale3d",
    "scaleX",
    "scaleY",
]);
var STYLE_TRANSFORMATION_MAP = Object.freeze({
    "scale": function (value) { return ({ property: "scale", value: value }); },
    "scale3d": function (value) { return ({ property: "scale", value: value }); },
    "scaleX": function (_a) {
        var x = _a.x;
        return ({ property: "scale", value: { x: x, y: IDENTITY_TRANSFORMATION.scale.y } });
    },
    "scaleY": function (_a) {
        var y = _a.y;
        return ({ property: "scale", value: { y: y, x: IDENTITY_TRANSFORMATION.scale.x } });
    },
    "translate": function (value) { return ({ property: "translate", value: value }); },
    "translate3d": function (value) { return ({ property: "translate", value: value }); },
    "translateX": function (_a) {
        var x = _a.x;
        return ({ property: "translate", value: { x: x, y: IDENTITY_TRANSFORMATION.translate.y } });
    },
    "translateY": function (_a) {
        var y = _a.y;
        return ({ property: "translate", value: { y: y, x: IDENTITY_TRANSFORMATION.translate.x } });
    },
    "rotate": function (value) { return ({ property: "rotate", value: value }); },
});
function convertToTransform(value) {
    if (value === properties_1.unsetValue) {
        value = "none";
    }
    var _a = transformConverter(value), translate = _a.translate, rotate = _a.rotate, scale = _a.scale;
    return [
        [exports.translateXProperty, translate.x],
        [exports.translateYProperty, translate.y],
        [exports.scaleXProperty, scale.x],
        [exports.scaleYProperty, scale.y],
        [exports.rotateProperty, rotate],
    ];
}
function transformConverter(text) {
    var transformations = parseTransformString(text);
    if (text === "none" || text === "" || !transformations.length) {
        return IDENTITY_TRANSFORMATION;
    }
    var usedTransforms = transformations.map(function (t) { return t.property; });
    if (!utils_1.hasDuplicates(usedTransforms)) {
        var fullTransformations_1 = __assign({}, IDENTITY_TRANSFORMATION);
        transformations.forEach(function (transform) {
            fullTransformations_1[transform.property] = transform.value;
        });
        return fullTransformations_1;
    }
    var affineMatrix = transformations
        .map(matrix_1.getTransformMatrix)
        .reduce(matrix_1.multiplyAffine2d);
    var cssMatrix = matrix_1.matrixArrayToCssMatrix(affineMatrix);
    return matrix_1.decompose2DTransformMatrix(cssMatrix);
}
exports.transformConverter = transformConverter;
function parseTransformString(text) {
    var matches = [];
    var match;
    while ((match = TRANSFORM_SPLITTER.exec(text)) !== null) {
        var property = match[1];
        var value = convertTransformValue(property, match[2]);
        if (TRANSFORMATIONS.indexOf(property) !== -1) {
            matches.push(normalizeTransformation({ property: property, value: value }));
        }
    }
    return matches;
}
function normalizeTransformation(_a) {
    var property = _a.property, value = _a.value;
    return STYLE_TRANSFORMATION_MAP[property](value);
}
function convertTransformValue(property, stringValue) {
    var _a = stringValue.split(",").map(parseFloat), x = _a[0], _b = _a[1], y = _b === void 0 ? x : _b;
    if (property === "rotate") {
        return stringValue.slice(-3) === "rad" ? number_utils_1.radiansToDegrees(x) : x;
    }
    return { x: x, y: y };
}
var backgroundProperty = new properties_1.ShorthandProperty({
    name: "background", cssName: "background",
    getter: function () {
        return this.backgroundColor + " " + this.backgroundImage + " " + this.backgroundRepeat + " " + this.backgroundPosition;
    },
    converter: convertToBackgrounds
});
backgroundProperty.register(properties_1.Style);
exports.backgroundInternalProperty = new properties_1.CssProperty({
    name: "backgroundInternal",
    cssName: "_backgroundInternal",
    defaultValue: background_1.Background.default
});
exports.backgroundInternalProperty.register(properties_1.Style);
exports.backgroundImageProperty = new properties_1.CssProperty({
    name: "backgroundImage", cssName: "background-image", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withImage(newValue);
        target.backgroundInternal = background;
    },
    equalityComparer: function (value1, value2) {
        if (value1 instanceof linear_gradient_1.LinearGradient && value2 instanceof linear_gradient_1.LinearGradient) {
            return linear_gradient_1.LinearGradient.equals(value1, value2);
        }
        else {
            return value1 === value2;
        }
    },
    valueConverter: function (value) {
        if (typeof value === "string") {
            var parsed = parser.parseBackground(value);
            if (parsed) {
                var background = parsed.value;
                value = (typeof background.image === "object") ? linear_gradient_1.LinearGradient.parse(background.image) : value;
            }
        }
        return value;
    }
});
exports.backgroundImageProperty.register(properties_1.Style);
exports.backgroundColorProperty = new properties_1.CssAnimationProperty({
    name: "backgroundColor", cssName: "background-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.backgroundColorProperty.register(properties_1.Style);
var BackgroundRepeat;
(function (BackgroundRepeat) {
    BackgroundRepeat.REPEAT = "repeat";
    BackgroundRepeat.REPEAT_X = "repeat-x";
    BackgroundRepeat.REPEAT_Y = "repeat-y";
    BackgroundRepeat.NO_REPEAT = "no-repeat";
    BackgroundRepeat.isValid = properties_1.makeValidator(BackgroundRepeat.REPEAT, BackgroundRepeat.REPEAT_X, BackgroundRepeat.REPEAT_Y, BackgroundRepeat.NO_REPEAT);
    BackgroundRepeat.parse = properties_1.makeParser(BackgroundRepeat.isValid);
})(BackgroundRepeat = exports.BackgroundRepeat || (exports.BackgroundRepeat = {}));
exports.backgroundRepeatProperty = new properties_1.CssProperty({
    name: "backgroundRepeat", cssName: "background-repeat", valueConverter: BackgroundRepeat.parse,
    valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withRepeat(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundRepeatProperty.register(properties_1.Style);
exports.backgroundSizeProperty = new properties_1.CssProperty({
    name: "backgroundSize", cssName: "background-size", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withSize(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundSizeProperty.register(properties_1.Style);
exports.backgroundPositionProperty = new properties_1.CssProperty({
    name: "backgroundPosition", cssName: "background-position", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withPosition(newValue);
        target.backgroundInternal = background;
    }
});
exports.backgroundPositionProperty.register(properties_1.Style);
function convertToBackgrounds(value) {
    if (typeof value === "string") {
        var backgrounds = parser.parseBackground(value).value;
        var backgroundColor = backgrounds.color ? new color_1.Color(backgrounds.color) : properties_1.unsetValue;
        var backgroundImage = void 0;
        if (typeof backgrounds.image === "object" && backgrounds.image) {
            backgroundImage = linear_gradient_1.LinearGradient.parse(backgrounds.image);
        }
        else {
            backgroundImage = backgrounds.image || properties_1.unsetValue;
        }
        var backgroundRepeat = backgrounds.repeat || properties_1.unsetValue;
        var backgroundPosition = backgrounds.position ? backgrounds.position.text : properties_1.unsetValue;
        return [
            [exports.backgroundColorProperty, backgroundColor],
            [exports.backgroundImageProperty, backgroundImage],
            [exports.backgroundRepeatProperty, backgroundRepeat],
            [exports.backgroundPositionProperty, backgroundPosition]
        ];
    }
    else {
        return [
            [exports.backgroundColorProperty, properties_1.unsetValue],
            [exports.backgroundImageProperty, properties_1.unsetValue],
            [exports.backgroundRepeatProperty, properties_1.unsetValue],
            [exports.backgroundPositionProperty, properties_1.unsetValue]
        ];
    }
}
function parseBorderColor(value) {
    var result = { top: undefined, right: undefined, bottom: undefined, left: undefined };
    if (value.indexOf("rgb") === 0) {
        result.top = result.right = result.bottom = result.left = new color_1.Color(value);
        return result;
    }
    var arr = value.split(/[ ,]+/);
    if (arr.length === 1) {
        var arr0 = new color_1.Color(arr[0]);
        result.top = arr0;
        result.right = arr0;
        result.bottom = arr0;
        result.left = arr0;
    }
    else if (arr.length === 2) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr0;
        result.left = arr1;
    }
    else if (arr.length === 3) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr1;
    }
    else if (arr.length === 4) {
        var arr0 = new color_1.Color(arr[0]);
        var arr1 = new color_1.Color(arr[1]);
        var arr2 = new color_1.Color(arr[2]);
        var arr3 = new color_1.Color(arr[3]);
        result.top = arr0;
        result.right = arr1;
        result.bottom = arr2;
        result.left = arr3;
    }
    else {
        throw new Error("Expected 1, 2, 3 or 4 parameters. Actual: " + value);
    }
    return result;
}
var borderColorProperty = new properties_1.ShorthandProperty({
    name: "borderColor", cssName: "border-color",
    getter: function () {
        if (color_1.Color.equals(this.borderTopColor, this.borderRightColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderBottomColor) &&
            color_1.Color.equals(this.borderTopColor, this.borderLeftColor)) {
            return this.borderTopColor;
        }
        else {
            return this.borderTopColor + " " + this.borderRightColor + " " + this.borderBottomColor + " " + this.borderLeftColor;
        }
    },
    converter: function (value) {
        if (typeof value === "string") {
            var fourColors = parseBorderColor(value);
            return [
                [exports.borderTopColorProperty, fourColors.top],
                [exports.borderRightColorProperty, fourColors.right],
                [exports.borderBottomColorProperty, fourColors.bottom],
                [exports.borderLeftColorProperty, fourColors.left]
            ];
        }
        else {
            return [
                [exports.borderTopColorProperty, value],
                [exports.borderRightColorProperty, value],
                [exports.borderBottomColorProperty, value],
                [exports.borderLeftColorProperty, value]
            ];
        }
    }
});
borderColorProperty.register(properties_1.Style);
exports.borderTopColorProperty = new properties_1.CssProperty({
    name: "borderTopColor", cssName: "border-top-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderTopColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderTopColorProperty.register(properties_1.Style);
exports.borderRightColorProperty = new properties_1.CssProperty({
    name: "borderRightColor", cssName: "border-right-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderRightColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderRightColorProperty.register(properties_1.Style);
exports.borderBottomColorProperty = new properties_1.CssProperty({
    name: "borderBottomColor", cssName: "border-bottom-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderBottomColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderBottomColorProperty.register(properties_1.Style);
exports.borderLeftColorProperty = new properties_1.CssProperty({
    name: "borderLeftColor", cssName: "border-left-color", valueChanged: function (target, oldValue, newValue) {
        var background = target.backgroundInternal.withBorderLeftColor(newValue);
        target.backgroundInternal = background;
    }, equalityComparer: color_1.Color.equals, valueConverter: function (value) { return new color_1.Color(value); }
});
exports.borderLeftColorProperty.register(properties_1.Style);
var borderWidthProperty = new properties_1.ShorthandProperty({
    name: "borderWidth", cssName: "border-width",
    getter: function () {
        if (Length.equals(this.borderTopWidth, this.borderRightWidth) &&
            Length.equals(this.borderTopWidth, this.borderBottomWidth) &&
            Length.equals(this.borderTopWidth, this.borderLeftWidth)) {
            return this.borderTopWidth;
        }
        else {
            return Length.convertToString(this.borderTopWidth) + " " + Length.convertToString(this.borderRightWidth) + " " + Length.convertToString(this.borderBottomWidth) + " " + Length.convertToString(this.borderLeftWidth);
        }
    },
    converter: function (value) {
        if (typeof value === "string" && value !== "auto") {
            var borderWidths = parseThickness(value);
            return [
                [exports.borderTopWidthProperty, borderWidths.top],
                [exports.borderRightWidthProperty, borderWidths.right],
                [exports.borderBottomWidthProperty, borderWidths.bottom],
                [exports.borderLeftWidthProperty, borderWidths.left]
            ];
        }
        else {
            return [
                [exports.borderTopWidthProperty, value],
                [exports.borderRightWidthProperty, value],
                [exports.borderBottomWidthProperty, value],
                [exports.borderLeftWidthProperty, value]
            ];
        }
    }
});
borderWidthProperty.register(properties_1.Style);
exports.borderTopWidthProperty = new properties_1.CssProperty({
    name: "borderTopWidth", cssName: "border-top-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderTopWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderTopWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopWidthProperty.register(properties_1.Style);
exports.borderRightWidthProperty = new properties_1.CssProperty({
    name: "borderRightWidth", cssName: "border-right-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-right-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderRightWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderRightWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderRightWidthProperty.register(properties_1.Style);
exports.borderBottomWidthProperty = new properties_1.CssProperty({
    name: "borderBottomWidth", cssName: "border-bottom-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderBottomWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderBottomWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomWidthProperty.register(properties_1.Style);
exports.borderLeftWidthProperty = new properties_1.CssProperty({
    name: "borderLeftWidth", cssName: "border-left-width", defaultValue: exports.zeroLength, affectsLayout: platform_1.isIOS, equalityComparer: Length.equals,
    valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-left-width should be Non-Negative Finite number. Value: " + value);
        }
        var view = target.viewRef.get();
        if (view) {
            view.effectiveBorderLeftWidth = value;
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
        var background = target.backgroundInternal.withBorderLeftWidth(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderLeftWidthProperty.register(properties_1.Style);
var borderRadiusProperty = new properties_1.ShorthandProperty({
    name: "borderRadius", cssName: "border-radius",
    getter: function () {
        if (Length.equals(this.borderTopLeftRadius, this.borderTopRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomRightRadius) &&
            Length.equals(this.borderTopLeftRadius, this.borderBottomLeftRadius)) {
            return this.borderTopLeftRadius;
        }
        return Length.convertToString(this.borderTopLeftRadius) + " " + Length.convertToString(this.borderTopRightRadius) + " " + Length.convertToString(this.borderBottomRightRadius) + " " + Length.convertToString(this.borderBottomLeftRadius);
    },
    converter: function (value) {
        if (typeof value === "string") {
            var borderRadius = parseThickness(value);
            return [
                [exports.borderTopLeftRadiusProperty, borderRadius.top],
                [exports.borderTopRightRadiusProperty, borderRadius.right],
                [exports.borderBottomRightRadiusProperty, borderRadius.bottom],
                [exports.borderBottomLeftRadiusProperty, borderRadius.left]
            ];
        }
        else {
            return [
                [exports.borderTopLeftRadiusProperty, value],
                [exports.borderTopRightRadiusProperty, value],
                [exports.borderBottomRightRadiusProperty, value],
                [exports.borderBottomLeftRadiusProperty, value]
            ];
        }
    }
});
borderRadiusProperty.register(properties_1.Style);
exports.borderTopLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderTopLeftRadius", cssName: "border-top-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopLeftRadiusProperty.register(properties_1.Style);
exports.borderTopRightRadiusProperty = new properties_1.CssProperty({
    name: "borderTopRightRadius", cssName: "border-top-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-top-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderTopRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderTopRightRadiusProperty.register(properties_1.Style);
exports.borderBottomRightRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomRightRadius", cssName: "border-bottom-right-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-right-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomRightRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomRightRadiusProperty.register(properties_1.Style);
exports.borderBottomLeftRadiusProperty = new properties_1.CssProperty({
    name: "borderBottomLeftRadius", cssName: "border-bottom-left-radius", defaultValue: 0, affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var value = Length.toDevicePixels(newValue, 0);
        if (!isNonNegativeFiniteNumber(value)) {
            throw new Error("border-bottom-left-radius should be Non-Negative Finite number. Value: " + value);
        }
        var background = target.backgroundInternal.withBorderBottomLeftRadius(value);
        target.backgroundInternal = background;
    }, valueConverter: Length.parse
});
exports.borderBottomLeftRadiusProperty.register(properties_1.Style);
function isNonNegativeFiniteNumber(value) {
    return isFinite(value) && !isNaN(value) && value >= 0;
}
var supportedPaths = ["rect", "circle", "ellipse", "polygon", "inset"];
function isClipPathValid(value) {
    if (!value) {
        return true;
    }
    var functionName = value.substring(0, value.indexOf("(")).trim();
    return supportedPaths.indexOf(functionName) !== -1;
}
exports.clipPathProperty = new properties_1.CssProperty({
    name: "clipPath", cssName: "clip-path", valueChanged: function (target, oldValue, newValue) {
        if (!isClipPathValid(newValue)) {
            throw new Error("clip-path is not valid.");
        }
        var background = target.backgroundInternal.withClipPath(newValue);
        target.backgroundInternal = background;
    }
});
exports.clipPathProperty.register(properties_1.Style);
function isFloatValueConverter(value) {
    var newValue = parseFloat(value);
    if (isNaN(newValue)) {
        throw new Error("Invalid value: " + newValue);
    }
    return newValue;
}
exports.zIndexProperty = new properties_1.CssProperty({ name: "zIndex", cssName: "z-index", valueConverter: isFloatValueConverter });
exports.zIndexProperty.register(properties_1.Style);
function opacityConverter(value) {
    var newValue = parseFloat(value);
    if (!isNaN(newValue) && 0 <= newValue && newValue <= 1) {
        return newValue;
    }
    throw new Error("Opacity should be between [0, 1]. Value: " + newValue);
}
exports.opacityProperty = new properties_1.CssAnimationProperty({ name: "opacity", cssName: "opacity", defaultValue: 1, valueConverter: opacityConverter });
exports.opacityProperty.register(properties_1.Style);
exports.colorProperty = new properties_1.InheritedCssProperty({ name: "color", cssName: "color", equalityComparer: color_1.Color.equals, valueConverter: function (v) { return new color_1.Color(v); } });
exports.colorProperty.register(properties_1.Style);
exports.fontInternalProperty = new properties_1.CssProperty({ name: "fontInternal", cssName: "_fontInternal", defaultValue: font_1.Font.default });
exports.fontInternalProperty.register(properties_1.Style);
exports.fontFamilyProperty = new properties_1.InheritedCssProperty({
    name: "fontFamily", cssName: "font-family", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontFamily !== newValue) {
            var newFont = currentFont.withFontFamily(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontFamilyProperty.register(properties_1.Style);
exports.fontSizeProperty = new properties_1.InheritedCssProperty({
    name: "fontSize", cssName: "font-size", affectsLayout: platform_1.isIOS, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontSize !== newValue) {
            var newFont = currentFont.withFontSize(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    },
    valueConverter: function (v) { return parseFloat(v); }
});
exports.fontSizeProperty.register(properties_1.Style);
exports.fontStyleProperty = new properties_1.InheritedCssProperty({
    name: "fontStyle", cssName: "font-style", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontStyle.NORMAL, valueConverter: font_1.FontStyle.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontStyle !== newValue) {
            var newFont = currentFont.withFontStyle(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontStyleProperty.register(properties_1.Style);
exports.fontWeightProperty = new properties_1.InheritedCssProperty({
    name: "fontWeight", cssName: "font-weight", affectsLayout: platform_1.isIOS, defaultValue: font_1.FontWeight.NORMAL, valueConverter: font_1.FontWeight.parse, valueChanged: function (target, oldValue, newValue) {
        var currentFont = target.fontInternal;
        if (currentFont.fontWeight !== newValue) {
            var newFont = currentFont.withFontWeight(newValue);
            target.fontInternal = font_1.Font.equals(font_1.Font.default, newFont) ? properties_1.unsetValue : newFont;
        }
    }
});
exports.fontWeightProperty.register(properties_1.Style);
var fontProperty = new properties_1.ShorthandProperty({
    name: "font", cssName: "font",
    getter: function () {
        return this.fontStyle + " " + this.fontWeight + " " + this.fontSize + " " + this.fontFamily;
    },
    converter: function (value) {
        if (value === properties_1.unsetValue) {
            return [
                [exports.fontStyleProperty, properties_1.unsetValue],
                [exports.fontWeightProperty, properties_1.unsetValue],
                [exports.fontSizeProperty, properties_1.unsetValue],
                [exports.fontFamilyProperty, properties_1.unsetValue]
            ];
        }
        else {
            var font = font_1.parseFont(value);
            var fontSize = parseFloat(font.fontSize);
            return [
                [exports.fontStyleProperty, font.fontStyle],
                [exports.fontWeightProperty, font.fontWeight],
                [exports.fontSizeProperty, fontSize],
                [exports.fontFamilyProperty, font.fontFamily]
            ];
        }
    }
});
fontProperty.register(properties_1.Style);
var Visibility;
(function (Visibility) {
    Visibility.VISIBLE = "visible";
    Visibility.HIDDEN = "hidden";
    Visibility.COLLAPSE = "collapse";
    Visibility.isValid = properties_1.makeValidator(Visibility.VISIBLE, Visibility.HIDDEN, Visibility.COLLAPSE);
    Visibility.parse = function (value) { return value.toLowerCase() === "collapsed" ? Visibility.COLLAPSE : parseStrict(value); };
    var parseStrict = properties_1.makeParser(Visibility.isValid);
})(Visibility = exports.Visibility || (exports.Visibility = {}));
exports.visibilityProperty = new properties_1.CssProperty({
    name: "visibility", cssName: "visibility", defaultValue: Visibility.VISIBLE, affectsLayout: platform_1.isIOS, valueConverter: Visibility.parse, valueChanged: function (target, oldValue, newValue) {
        var view = target.viewRef.get();
        if (view) {
            view.isCollapsed = (newValue === Visibility.COLLAPSE);
        }
        else {
            trace_1.write(newValue + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
        }
    }
});
exports.visibilityProperty.register(properties_1.Style);
exports.androidElevationProperty = new properties_1.CssProperty({ name: "androidElevation", cssName: "android-elevation", valueConverter: parseFloat });
exports.androidElevationProperty.register(properties_1.Style);
exports.androidDynamicElevationOffsetProperty = new properties_1.CssProperty({ name: "androidDynamicElevationOffset", cssName: "android-dynamic-elevation-offset", valueConverter: parseFloat });
exports.androidDynamicElevationOffsetProperty.register(properties_1.Style);
//# sourceMappingURL=style-properties.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style-scope.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var properties_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/properties/properties.js");
var css_1 = __webpack_require__("../node_modules/tns-core-modules/css/index.js");
var parser_1 = __webpack_require__("../node_modules/tns-core-modules/css/parser.js");
var css_selector_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-selector/css-selector.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var applicationCommon = __webpack_require__("../node_modules/tns-core-modules/application/application-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
var keyframeAnimationModule;
function ensureKeyframeAnimationModule() {
    if (!keyframeAnimationModule) {
        keyframeAnimationModule = __webpack_require__("../node_modules/tns-core-modules/ui/animation/keyframe-animation.js");
    }
}
var cssAnimationParserModule;
function ensureCssAnimationParserModule() {
    if (!cssAnimationParserModule) {
        cssAnimationParserModule = __webpack_require__("../node_modules/tns-core-modules/ui/styling/css-animation-parser.js");
    }
}
var parser = "rework";
try {
    var appConfig = __webpack_require__("./package.json");
    if (appConfig && appConfig.cssParser === "nativescript") {
        parser = "nativescript";
    }
}
catch (e) {
}
function mergeCssSelectors() {
    applicationCssSelectors = applicationSelectors.slice();
    applicationCssSelectors.push.apply(applicationCssSelectors, applicationAdditionalSelectors);
    applicationCssSelectorVersion++;
}
exports.mergeCssSelectors = mergeCssSelectors;
var applicationCssSelectors = [];
var applicationCssSelectorVersion = 0;
var applicationSelectors = [];
var applicationAdditionalSelectors = [];
var applicationKeyframes = {};
var animationsSymbol = Symbol("animations");
var pattern = /('|")(.*?)\1/;
var CSSSource = (function () {
    function CSSSource(_ast, _url, _file, _keyframes, _source) {
        this._ast = _ast;
        this._url = _url;
        this._file = _file;
        this._keyframes = _keyframes;
        this._source = _source;
        this._selectors = [];
        this.parse();
    }
    CSSSource.fromURI = function (uri, keyframes) {
        var appRelativeUri = CSSSource.pathRelativeToApp(uri);
        try {
            var cssOrAst = global.loadModule(appRelativeUri, true);
            if (cssOrAst) {
                if (typeof cssOrAst === "string") {
                    return CSSSource.fromSource(cssOrAst, keyframes, appRelativeUri);
                }
                else if (typeof cssOrAst === "object" && cssOrAst.type === "stylesheet" && cssOrAst.stylesheet && cssOrAst.stylesheet.rules) {
                    return CSSSource.fromAST(cssOrAst, keyframes, appRelativeUri);
                }
                else {
                    return CSSSource.fromSource(cssOrAst.toString(), keyframes, appRelativeUri);
                }
            }
        }
        catch (e) {
        }
        return CSSSource.fromFile(appRelativeUri, keyframes);
    };
    CSSSource.pathRelativeToApp = function (uri) {
        if (!uri.startsWith("/")) {
            return uri;
        }
        var appPath = file_system_1.knownFolders.currentApp().path;
        if (!uri.startsWith(appPath)) {
            trace_1.write(uri + " does not start with " + appPath, trace_1.categories.Error, trace_1.messageType.error);
            return uri;
        }
        var relativeUri = "." + uri.substr(appPath.length);
        return relativeUri;
    };
    CSSSource.fromFile = function (url, keyframes) {
        var cssFileUrl = url.replace(/\..\w+$/, ".css");
        if (cssFileUrl !== url) {
            var cssFile = CSSSource.resolveCSSPathFromURL(cssFileUrl);
            if (cssFile) {
                return new CSSSource(undefined, url, cssFile, keyframes, undefined);
            }
        }
        var file = CSSSource.resolveCSSPathFromURL(url);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.fromFileImport = function (url, keyframes, importSource) {
        var file = CSSSource.resolveCSSPathFromURL(url, importSource);
        return new CSSSource(undefined, url, file, keyframes, undefined);
    };
    CSSSource.resolveCSSPathFromURL = function (url, importSource) {
        var app = file_system_1.knownFolders.currentApp().path;
        var file = resolveFileNameFromUrl(url, app, file_system_1.File.exists, importSource);
        return file;
    };
    CSSSource.fromSource = function (source, keyframes, url) {
        return new CSSSource(undefined, url, undefined, keyframes, source);
    };
    CSSSource.fromAST = function (ast, keyframes, url) {
        return new CSSSource(ast, url, undefined, keyframes, undefined);
    };
    Object.defineProperty(CSSSource.prototype, "selectors", {
        get: function () { return this._selectors; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CSSSource.prototype, "source", {
        get: function () { return this._source; },
        enumerable: true,
        configurable: true
    });
    CSSSource.prototype.load = function () {
        var file = file_system_1.File.fromPath(this._file);
        this._source = file.readTextSync();
    };
    CSSSource.prototype.parse = function () {
        try {
            if (!this._ast) {
                if (!this._source && this._file) {
                    this.load();
                }
                if (this._source && this.source !== "[object Object]") {
                    this.parseCSSAst();
                }
            }
            if (this._ast) {
                this.createSelectors();
            }
            else {
                this._selectors = [];
            }
        }
        catch (e) {
            trace_1.write("Css styling failed: " + e, trace_1.categories.Error, trace_1.messageType.error);
            this._selectors = [];
        }
    };
    CSSSource.prototype.parseCSSAst = function () {
        if (this._source) {
            switch (parser) {
                case "nativescript":
                    var cssparser = new parser_1.CSS3Parser(this._source);
                    var stylesheet = cssparser.parseAStylesheet();
                    var cssNS = new parser_1.CSSNativeScript();
                    this._ast = cssNS.parseStylesheet(stylesheet);
                    return;
                case "rework":
                    this._ast = css_1.parse(this._source, { source: this._file });
                    return;
            }
        }
    };
    CSSSource.prototype.createSelectors = function () {
        if (this._ast) {
            this._selectors = this.createSelectorsFromImports().concat(this.createSelectorsFromSyntaxTree());
        }
    };
    CSSSource.prototype.createSelectorsFromImports = function () {
        var _this = this;
        var imports = this._ast["stylesheet"]["rules"].filter(function (r) { return r.type === "import"; });
        var urlFromImportObject = function (importObject) {
            var importItem = importObject["import"];
            var urlMatch = importItem && importItem.match(pattern);
            return urlMatch && urlMatch[2];
        };
        var sourceFromImportObject = function (importObject) {
            return importObject["position"] && importObject["position"]["source"];
        };
        var toUrlSourcePair = function (importObject) { return ({
            url: urlFromImportObject(importObject),
            source: sourceFromImportObject(importObject),
        }); };
        var getCssFile = function (_a) {
            var url = _a.url, source = _a.source;
            return source ?
                CSSSource.fromFileImport(url, _this._keyframes, source) :
                CSSSource.fromURI(url, _this._keyframes);
        };
        var cssFiles = imports
            .map(toUrlSourcePair)
            .filter(function (_a) {
            var url = _a.url;
            return !!url;
        })
            .map(getCssFile);
        var selectors = cssFiles.map(function (file) { return (file && file.selectors) || []; });
        return selectors.reduce(function (acc, val) { return acc.concat(val); }, []);
    };
    CSSSource.prototype.createSelectorsFromSyntaxTree = function () {
        var _this = this;
        var nodes = this._ast.stylesheet.rules;
        nodes.filter(isKeyframe).forEach(function (node) { return _this._keyframes[node.name] = node; });
        var rulesets = css_selector_1.fromAstNodes(nodes);
        if (rulesets && rulesets.length) {
            ensureCssAnimationParserModule();
            rulesets.forEach(function (rule) {
                rule[animationsSymbol] = cssAnimationParserModule.CssAnimationParser
                    .keyframeAnimationsFromCSSDeclarations(rule.declarations);
            });
        }
        return rulesets;
    };
    CSSSource.prototype.toString = function () {
        return this._file || this._url || "(in-memory)";
    };
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "load", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parse", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "parseCSSAst", null);
    __decorate([
        profiling_1.profile
    ], CSSSource.prototype, "createSelectors", null);
    __decorate([
        profiling_1.profile
    ], CSSSource, "resolveCSSPathFromURL", null);
    return CSSSource;
}());
function removeTaggedAdditionalCSS(tag) {
    var changed = false;
    for (var i = 0; i < applicationAdditionalSelectors.length; i++) {
        if (applicationAdditionalSelectors[i].tag === tag) {
            applicationAdditionalSelectors.splice(i, 1);
            i--;
            changed = true;
        }
    }
    if (changed) {
        mergeCssSelectors();
    }
    return changed;
}
exports.removeTaggedAdditionalCSS = removeTaggedAdditionalCSS;
function addTaggedAdditionalCSS(cssText, tag) {
    var parsed = CSSSource.fromSource(cssText, applicationKeyframes, undefined).selectors;
    var changed = false;
    if (parsed && parsed.length) {
        changed = true;
        if (tag != null) {
            for (var i = 0; i < parsed.length; i++) {
                parsed[i].tag = tag;
            }
        }
        applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
        mergeCssSelectors();
    }
    return changed;
}
exports.addTaggedAdditionalCSS = addTaggedAdditionalCSS;
var onCssChanged = profiling_1.profile("\"style-scope\".onCssChanged", function (args) {
    if (args.cssText) {
        var parsed = CSSSource.fromSource(args.cssText, applicationKeyframes, args.cssFile).selectors;
        if (parsed) {
            applicationAdditionalSelectors.push.apply(applicationAdditionalSelectors, parsed);
            mergeCssSelectors();
        }
    }
    else if (args.cssFile) {
        loadCss(args.cssFile);
    }
});
function onLiveSync(args) {
    loadCss(applicationCommon.getCssFileName());
}
var loadCss = profiling_1.profile("\"style-scope\".loadCss", function (cssFile) {
    if (!cssFile) {
        return undefined;
    }
    var result = CSSSource.fromURI(cssFile, applicationKeyframes).selectors;
    if (result.length > 0) {
        applicationSelectors = result;
        mergeCssSelectors();
    }
});
applicationCommon.on("cssChanged", onCssChanged);
applicationCommon.on("livesync", onLiveSync);
exports.loadAppCSS = profiling_1.profile("\"style-scope\".loadAppCSS", function (args) {
    loadCss(args.cssFile);
    applicationCommon.off("loadAppCss", exports.loadAppCSS);
});
if (applicationCommon.hasLaunched()) {
    exports.loadAppCSS({ eventName: "loadAppCss", object: applicationCommon, cssFile: applicationCommon.getCssFileName() });
}
else {
    applicationCommon.on("loadAppCss", exports.loadAppCSS);
}
var CssState = (function () {
    function CssState(viewRef) {
        var _this = this;
        this.viewRef = viewRef;
        this._onDynamicStateChangeHandler = function () { return _this.updateDynamicState(); };
    }
    CssState.prototype.onChange = function () {
        var view = this.viewRef.get();
        if (view && view.isLoaded) {
            this.unsubscribeFromDynamicUpdates();
            this.updateMatch();
            this.subscribeForDynamicUpdates();
            this.updateDynamicState();
        }
        else {
            this._matchInvalid = true;
        }
    };
    CssState.prototype.isSelectorsLatestVersionApplied = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("isSelectorsLatestVersionApplied returns default value \"false\" because \"this.viewRef\" cleared.", trace_1.categories.Style, trace_1.messageType.warn);
            return false;
        }
        return this.viewRef.get()._styleScope._getSelectorsVersion() === this._appliedSelectorsVersion;
    };
    CssState.prototype.onLoaded = function () {
        if (this._matchInvalid) {
            this.updateMatch();
        }
        this.subscribeForDynamicUpdates();
        this.updateDynamicState();
    };
    CssState.prototype.onUnloaded = function () {
        this.unsubscribeFromDynamicUpdates();
    };
    CssState.prototype.updateMatch = function () {
        var view = this.viewRef.get();
        if (view && view._styleScope) {
            this._match = view._styleScope.matchSelectors(view);
            this._appliedSelectorsVersion = view._styleScope._getSelectorsVersion();
        }
        else {
            this._match = CssState.emptyMatch;
        }
        this._matchInvalid = false;
    };
    CssState.prototype.updateDynamicState = function () {
        var _this = this;
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("updateDynamicState not executed to view because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var matchingSelectors = this._match.selectors.filter(function (sel) { return sel.dynamic ? sel.match(view) : true; });
        view._batchUpdate(function () {
            _this.stopKeyframeAnimations();
            _this.setPropertyValues(matchingSelectors);
            _this.playKeyframeAnimations(matchingSelectors);
        });
    };
    CssState.prototype.playKeyframeAnimations = function (matchingSelectors) {
        var animations = [];
        matchingSelectors.forEach(function (selector) {
            var ruleAnimations = selector.ruleset[animationsSymbol];
            if (ruleAnimations) {
                ensureKeyframeAnimationModule();
                for (var _i = 0, ruleAnimations_1 = ruleAnimations; _i < ruleAnimations_1.length; _i++) {
                    var animationInfo = ruleAnimations_1[_i];
                    var animation = keyframeAnimationModule.KeyframeAnimation.keyframeAnimationFromInfo(animationInfo);
                    if (animation) {
                        animations.push(animation);
                    }
                }
            }
        });
        if (this._playsKeyframeAnimations = animations.length > 0) {
            var view_1 = this.viewRef.get();
            if (!view_1) {
                trace_1.write("KeyframeAnimations cannot play because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
                return;
            }
            animations.map(function (animation) { return animation.play(view_1); });
            Object.freeze(animations);
            this._appliedAnimations = animations;
        }
    };
    CssState.prototype.stopKeyframeAnimations = function () {
        if (!this._playsKeyframeAnimations) {
            return;
        }
        this._appliedAnimations
            .filter(function (animation) { return animation.isPlaying; })
            .forEach(function (animation) { return animation.cancel(); });
        this._appliedAnimations = CssState.emptyAnimationArray;
        var view = this.viewRef.get();
        if (view) {
            view.style["keyframe:rotate"] = properties_1.unsetValue;
            view.style["keyframe:scaleX"] = properties_1.unsetValue;
            view.style["keyframe:scaleY"] = properties_1.unsetValue;
            view.style["keyframe:translateX"] = properties_1.unsetValue;
            view.style["keyframe:translateY"] = properties_1.unsetValue;
            view.style["keyframe:backgroundColor"] = properties_1.unsetValue;
            view.style["keyframe:opacity"] = properties_1.unsetValue;
        }
        else {
            trace_1.write("KeyframeAnimations cannot be stopped because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
        }
        this._playsKeyframeAnimations = false;
    };
    CssState.prototype.setPropertyValues = function (matchingSelectors) {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write(matchingSelectors + " not set to view's property because \".viewRef\" is cleared", trace_1.categories.Style, trace_1.messageType.warn);
            return;
        }
        var newPropertyValues = new view.style.PropertyBag();
        matchingSelectors.forEach(function (selector) {
            return selector.ruleset.declarations.forEach(function (declaration) {
                return newPropertyValues[declaration.property] = declaration.value;
            });
        });
        Object.freeze(newPropertyValues);
        var oldProperties = this._appliedPropertyValues;
        for (var key in oldProperties) {
            if (!(key in newPropertyValues)) {
                if (key in view.style) {
                    view.style["css:" + key] = properties_1.unsetValue;
                }
                else {
                }
            }
        }
        for (var property in newPropertyValues) {
            if (oldProperties && property in oldProperties && oldProperties[property] === newPropertyValues[property]) {
                continue;
            }
            var value = newPropertyValues[property];
            try {
                if (property in view.style) {
                    view.style["css:" + property] = value;
                }
                else {
                    var camelCasedProperty = property.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase(); });
                    view[camelCasedProperty] = value;
                }
            }
            catch (e) {
                trace_1.write("Failed to apply property [" + property + "] with value [" + value + "] to " + view + ". " + e, trace_1.categories.Error, trace_1.messageType.error);
            }
        }
        this._appliedPropertyValues = newPropertyValues;
    };
    CssState.prototype.subscribeForDynamicUpdates = function () {
        var _this = this;
        var changeMap = this._match.changeMap;
        changeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.addEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.addEventListener(":" + pseudoClass, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](+1);
                    }
                });
            }
        });
        this._appliedChangeMap = changeMap;
    };
    CssState.prototype.unsubscribeFromDynamicUpdates = function () {
        var _this = this;
        this._appliedChangeMap.forEach(function (changes, view) {
            if (changes.attributes) {
                changes.attributes.forEach(function (attribute) {
                    view.removeEventListener(attribute + "Change", _this._onDynamicStateChangeHandler);
                });
            }
            if (changes.pseudoClasses) {
                changes.pseudoClasses.forEach(function (pseudoClass) {
                    var eventName = ":" + pseudoClass;
                    view.removeEventListener(eventName, _this._onDynamicStateChangeHandler);
                    if (view[eventName]) {
                        view[eventName](-1);
                    }
                });
            }
        });
        this._appliedChangeMap = CssState.emptyChangeMap;
    };
    CssState.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of CssState cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + "._cssState";
    };
    CssState.emptyChangeMap = Object.freeze(new Map());
    CssState.emptyPropertyBag = Object.freeze({});
    CssState.emptyAnimationArray = Object.freeze([]);
    CssState.emptyMatch = { selectors: [], changeMap: new Map() };
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateMatch", null);
    __decorate([
        profiling_1.profile
    ], CssState.prototype, "updateDynamicState", null);
    return CssState;
}());
exports.CssState = CssState;
CssState.prototype._appliedChangeMap = CssState.emptyChangeMap;
CssState.prototype._appliedPropertyValues = CssState.emptyPropertyBag;
CssState.prototype._appliedAnimations = CssState.emptyAnimationArray;
CssState.prototype._matchInvalid = true;
var StyleScope = (function () {
    function StyleScope() {
        this._css = "";
        this._localCssSelectors = [];
        this._localCssSelectorVersion = 0;
        this._localCssSelectorsAppliedVersion = 0;
        this._applicationCssSelectorsAppliedVersion = 0;
        this._keyframes = new Map();
    }
    Object.defineProperty(StyleScope.prototype, "css", {
        get: function () {
            return this._css;
        },
        set: function (value) {
            this.setCss(value);
        },
        enumerable: true,
        configurable: true
    });
    StyleScope.prototype.addCss = function (cssString, cssFileName) {
        this.appendCss(cssString, cssFileName);
    };
    StyleScope.prototype.addCssFile = function (cssFileName) {
        this.appendCss(null, cssFileName);
    };
    StyleScope.prototype.changeCssFile = function (cssFileName) {
        if (!cssFileName) {
            return;
        }
        var cssSelectors = CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = cssSelectors.source;
        this._localCssSelectors = cssSelectors.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.setCss = function (cssString, cssFileName) {
        this._css = cssString;
        var cssFile = CSSSource.fromSource(cssString, this._keyframes, cssFileName);
        this._localCssSelectors = cssFile.selectors;
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.appendCss = function (cssString, cssFileName) {
        if (!cssString && !cssFileName) {
            return;
        }
        var parsedCssSelectors = cssString ? CSSSource.fromSource(cssString, this._keyframes, cssFileName) : CSSSource.fromURI(cssFileName, this._keyframes);
        this._css = this._css + parsedCssSelectors.source;
        this._localCssSelectors.push.apply(this._localCssSelectors, parsedCssSelectors.selectors);
        this._localCssSelectorVersion++;
        this.ensureSelectors();
    };
    StyleScope.prototype.getKeyframeAnimationWithName = function (animationName) {
        var cssKeyframes = this._keyframes[animationName];
        if (!cssKeyframes) {
            return;
        }
        ensureKeyframeAnimationModule();
        var animation = new keyframeAnimationModule.KeyframeAnimationInfo();
        ensureCssAnimationParserModule();
        animation.keyframes = cssAnimationParserModule
            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframes.keyframes);
        return animation;
    };
    StyleScope.prototype.ensureSelectors = function () {
        if (!this.isApplicationCssSelectorsLatestVersionApplied() ||
            !this.isLocalCssSelectorsLatestVersionApplied() ||
            !this._mergedCssSelectors) {
            this._createSelectors();
        }
        return this._getSelectorsVersion();
    };
    StyleScope.prototype.isApplicationCssSelectorsLatestVersionApplied = function () {
        return this._applicationCssSelectorsAppliedVersion === applicationCssSelectorVersion;
    };
    StyleScope.prototype.isLocalCssSelectorsLatestVersionApplied = function () {
        return this._localCssSelectorsAppliedVersion === this._localCssSelectorVersion;
    };
    StyleScope.prototype._createSelectors = function () {
        var toMerge = [];
        toMerge.push(applicationCssSelectors);
        this._applicationCssSelectorsAppliedVersion = applicationCssSelectorVersion;
        toMerge.push(this._localCssSelectors);
        this._localCssSelectorsAppliedVersion = this._localCssSelectorVersion;
        for (var keyframe in applicationKeyframes) {
            this._keyframes[keyframe] = applicationKeyframes[keyframe];
        }
        if (toMerge.length > 0) {
            this._mergedCssSelectors = toMerge.filter(function (m) { return !!m; }).reduce(function (merged, next) { return merged.concat(next); }, []);
            this._applyKeyframesOnSelectors();
            this._selectors = new css_selector_1.SelectorsMap(this._mergedCssSelectors);
        }
    };
    StyleScope.prototype.matchSelectors = function (view) {
        this.ensureSelectors();
        return this._selectors.query(view);
    };
    StyleScope.prototype.query = function (node) {
        this.ensureSelectors();
        return this._selectors.query(node).selectors;
    };
    StyleScope.prototype._getSelectorsVersion = function () {
        return 100000 * this._applicationCssSelectorsAppliedVersion + this._localCssSelectorsAppliedVersion;
    };
    StyleScope.prototype._applyKeyframesOnSelectors = function () {
        for (var i = this._mergedCssSelectors.length - 1; i >= 0; i--) {
            var ruleset = this._mergedCssSelectors[i];
            var animations = ruleset[animationsSymbol];
            if (animations !== undefined && animations.length) {
                ensureCssAnimationParserModule();
                for (var _i = 0, animations_1 = animations; _i < animations_1.length; _i++) {
                    var animation = animations_1[_i];
                    var cssKeyframe = this._keyframes[animation.name];
                    if (cssKeyframe !== undefined) {
                        animation.keyframes = cssAnimationParserModule
                            .CssAnimationParser.keyframesArrayFromCSS(cssKeyframe.keyframes);
                    }
                }
            }
        }
    };
    StyleScope.prototype.getAnimations = function (ruleset) {
        return ruleset[animationsSymbol];
    };
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "setCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "appendCss", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "_createSelectors", null);
    __decorate([
        profiling_1.profile
    ], StyleScope.prototype, "matchSelectors", null);
    return StyleScope;
}());
exports.StyleScope = StyleScope;
function resolveFileNameFromUrl(url, appDirectory, fileExists, importSource) {
    var fileName = typeof url === "string" ? url.trim() : "";
    if (fileName.indexOf("~/") === 0) {
        fileName = fileName.replace("~/", "");
    }
    var isAbsolutePath = fileName.indexOf("/") === 0;
    var absolutePath = isAbsolutePath ? fileName : file_system_1.path.join(appDirectory, fileName);
    if (fileExists(absolutePath)) {
        return absolutePath;
    }
    if (!isAbsolutePath) {
        if (fileName[0] === "~" && fileName[1] !== "/" && fileName[1] !== "\"") {
            fileName = fileName.substr(1);
        }
        if (importSource) {
            var importFile = resolveFilePathFromImport(importSource, fileName);
            if (fileExists(importFile)) {
                return importFile;
            }
        }
        var external_1 = file_system_1.path.join(appDirectory, "tns_modules", fileName);
        if (fileExists(external_1)) {
            return external_1;
        }
    }
    return null;
}
exports.resolveFileNameFromUrl = resolveFileNameFromUrl;
function resolveFilePathFromImport(importSource, fileName) {
    var importSourceParts = importSource.split(file_system_1.path.separator);
    var fileNameParts = fileName.split(file_system_1.path.separator)
        .filter(function (p) { return !isCurrentDirectory(p); });
    importSourceParts.pop();
    fileNameParts.forEach(function (p) { return isParentDirectory(p) ? importSourceParts.pop() : importSourceParts.push(p); });
    return importSourceParts.join(file_system_1.path.separator);
}
exports.applyInlineStyle = profiling_1.profile(function applyInlineStyle(view, styleStr) {
    var localStyle = "local { " + styleStr + " }";
    var inlineRuleSet = CSSSource.fromSource(localStyle, new Map()).selectors;
    var style = view.style;
    inlineRuleSet[0].declarations.forEach(function (d) {
        var name = d.property;
        try {
            if (name in style) {
                style[name] = d.value;
            }
            else {
                view[name] = d.value;
            }
        }
        catch (e) {
            trace_1.write("Failed to apply property [" + d.property + "] with value [" + d.value + "] to " + view + ". " + e, trace_1.categories.Error, trace_1.messageType.error);
        }
    });
});
function isCurrentDirectory(uriPart) {
    return uriPart === ".";
}
function isParentDirectory(uriPart) {
    return uriPart === "..";
}
function isKeyframe(node) {
    return node.type === "keyframes";
}
//# sourceMappingURL=style-scope.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/styling/style/style.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var observable_1 = __webpack_require__("../node_modules/tns-core-modules/data/observable/observable.js");
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var Style = (function (_super) {
    __extends(Style, _super);
    function Style(ownerView) {
        var _this = _super.call(this) || this;
        if (ownerView.constructor.toString().indexOf("[native code]") !== -1) {
            _this.viewRef = ownerView;
        }
        else {
            _this.viewRef = new WeakRef(ownerView);
        }
        return _this;
    }
    Style.prototype.toString = function () {
        var view = this.viewRef.get();
        if (!view) {
            trace_1.write("toString() of Style cannot execute correctly because \".viewRef\" is cleared", trace_1.categories.Animation, trace_1.messageType.warn);
            return "";
        }
        return view + ".style";
    };
    Object.defineProperty(Style.prototype, "view", {
        get: function () {
            if (this.viewRef) {
                return this.viewRef.get();
            }
            return undefined;
        },
        enumerable: true,
        configurable: true
    });
    return Style;
}(observable_1.Observable));
exports.Style = Style;
Style.prototype.PropertyBag = (function () {
    function class_1() {
    }
    return class_1;
}());
//# sourceMappingURL=style.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var view_1 = __webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js");
var formatted_string_1 = __webpack_require__("../node_modules/tns-core-modules/text/formatted-string.js");
exports.FormattedString = formatted_string_1.FormattedString;
exports.Span = formatted_string_1.Span;
__export(__webpack_require__("../node_modules/tns-core-modules/ui/core/view/view.js"));
var CHILD_SPAN = "Span";
var CHILD_FORMATTED_TEXT = "formattedText";
var CHILD_FORMATTED_STRING = "FormattedString";
var TextBaseCommon = (function (_super) {
    __extends(TextBaseCommon, _super);
    function TextBaseCommon() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Object.defineProperty(TextBaseCommon.prototype, "nativeTextViewProtected", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontFamily", {
        get: function () {
            return this.style.fontFamily;
        },
        set: function (value) {
            this.style.fontFamily = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontSize", {
        get: function () {
            return this.style.fontSize;
        },
        set: function (value) {
            this.style.fontSize = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontStyle", {
        get: function () {
            return this.style.fontStyle;
        },
        set: function (value) {
            this.style.fontStyle = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "fontWeight", {
        get: function () {
            return this.style.fontWeight;
        },
        set: function (value) {
            this.style.fontWeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "letterSpacing", {
        get: function () {
            return this.style.letterSpacing;
        },
        set: function (value) {
            this.style.letterSpacing = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "lineHeight", {
        get: function () {
            return this.style.lineHeight;
        },
        set: function (value) {
            this.style.lineHeight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textAlignment", {
        get: function () {
            return this.style.textAlignment;
        },
        set: function (value) {
            this.style.textAlignment = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textDecoration", {
        get: function () {
            return this.style.textDecoration;
        },
        set: function (value) {
            this.style.textDecoration = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "textTransform", {
        get: function () {
            return this.style.textTransform;
        },
        set: function (value) {
            this.style.textTransform = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "whiteSpace", {
        get: function () {
            return this.style.whiteSpace;
        },
        set: function (value) {
            this.style.whiteSpace = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "padding", {
        get: function () {
            return this.style.padding;
        },
        set: function (value) {
            this.style.padding = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingTop", {
        get: function () {
            return this.style.paddingTop;
        },
        set: function (value) {
            this.style.paddingTop = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingRight", {
        get: function () {
            return this.style.paddingRight;
        },
        set: function (value) {
            this.style.paddingRight = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingBottom", {
        get: function () {
            return this.style.paddingBottom;
        },
        set: function (value) {
            this.style.paddingBottom = value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TextBaseCommon.prototype, "paddingLeft", {
        get: function () {
            return this.style.paddingLeft;
        },
        set: function (value) {
            this.style.paddingLeft = value;
        },
        enumerable: true,
        configurable: true
    });
    TextBaseCommon.prototype._onFormattedTextContentsChanged = function (data) {
        if (this.nativeViewProtected) {
            this[exports.formattedTextProperty.setNative](data.value);
        }
    };
    TextBaseCommon.prototype._addChildFromBuilder = function (name, value) {
        if (name === CHILD_SPAN) {
            if (!this.formattedText) {
                var formattedText = new formatted_string_1.FormattedString();
                formattedText.spans.push(value);
                this.formattedText = formattedText;
            }
            else {
                this.formattedText.spans.push(value);
            }
        }
        else if (name === CHILD_FORMATTED_TEXT || name === CHILD_FORMATTED_STRING) {
            this.formattedText = value;
        }
    };
    TextBaseCommon.prototype._requestLayoutOnTextChanged = function () {
        this.requestLayout();
    };
    TextBaseCommon.prototype.eachChild = function (callback) {
        var text = this.formattedText;
        if (text) {
            callback(text);
        }
    };
    TextBaseCommon.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
    };
    return TextBaseCommon;
}(view_1.View));
exports.TextBaseCommon = TextBaseCommon;
TextBaseCommon.prototype._isSingleLine = false;
function isBold(fontWeight) {
    return fontWeight === "bold" || fontWeight === "700" || fontWeight === "800" || fontWeight === "900";
}
exports.isBold = isBold;
exports.textProperty = new view_1.Property({ name: "text", defaultValue: "", affectsLayout: view_1.isAndroid });
exports.textProperty.register(TextBaseCommon);
exports.formattedTextProperty = new view_1.Property({ name: "formattedText", affectsLayout: true, valueChanged: onFormattedTextPropertyChanged });
exports.formattedTextProperty.register(TextBaseCommon);
function onFormattedTextPropertyChanged(textBase, oldValue, newValue) {
    if (oldValue) {
        oldValue.off(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
        textBase._removeView(oldValue);
    }
    if (newValue) {
        var oldParent = newValue.parent;
        if (oldParent) {
            oldParent._removeView(newValue);
        }
        textBase._addView(newValue);
        newValue.on(view_1.Observable.propertyChangeEvent, textBase._onFormattedTextContentsChanged, textBase);
    }
}
var textAlignmentConverter = view_1.makeParser(view_1.makeValidator("initial", "left", "center", "right"));
exports.textAlignmentProperty = new view_1.InheritedCssProperty({ name: "textAlignment", cssName: "text-align", defaultValue: "initial", valueConverter: textAlignmentConverter });
exports.textAlignmentProperty.register(view_1.Style);
var textTransformConverter = view_1.makeParser(view_1.makeValidator("initial", "none", "capitalize", "uppercase", "lowercase"));
exports.textTransformProperty = new view_1.CssProperty({ name: "textTransform", cssName: "text-transform", defaultValue: "initial", valueConverter: textTransformConverter });
exports.textTransformProperty.register(view_1.Style);
var whiteSpaceConverter = view_1.makeParser(view_1.makeValidator("initial", "normal", "nowrap"));
exports.whiteSpaceProperty = new view_1.CssProperty({ name: "whiteSpace", cssName: "white-space", defaultValue: "initial", affectsLayout: view_1.isIOS, valueConverter: whiteSpaceConverter });
exports.whiteSpaceProperty.register(view_1.Style);
var textDecorationConverter = view_1.makeParser(view_1.makeValidator("none", "underline", "line-through", "underline line-through"));
exports.textDecorationProperty = new view_1.CssProperty({ name: "textDecoration", cssName: "text-decoration", defaultValue: "none", valueConverter: textDecorationConverter });
exports.textDecorationProperty.register(view_1.Style);
exports.letterSpacingProperty = new view_1.CssProperty({ name: "letterSpacing", cssName: "letter-spacing", defaultValue: 0, affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.letterSpacingProperty.register(view_1.Style);
exports.lineHeightProperty = new view_1.CssProperty({ name: "lineHeight", cssName: "line-height", affectsLayout: view_1.isIOS, valueConverter: function (v) { return parseFloat(v); } });
exports.lineHeightProperty.register(view_1.Style);
exports.resetSymbol = Symbol("textPropertyDefault");
//# sourceMappingURL=text-base-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-base/text-base.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var font_1 = __webpack_require__("../node_modules/tns-core-modules/ui/styling/font.js");
var text_base_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js");
var types_1 = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-base/text-base-common.js"));
var TextBase = (function (_super) {
    __extends(TextBase, _super);
    function TextBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextBase.prototype[text_base_common_1.textProperty.getDefault] = function () {
        return text_base_common_1.resetSymbol;
    };
    TextBase.prototype[text_base_common_1.textProperty.setNative] = function (value) {
        var reset = value === text_base_common_1.resetSymbol;
        if (!reset && this.formattedText) {
            return;
        }
        this._setNativeText(reset);
        this._requestLayoutOnTextChanged();
    };
    TextBase.prototype[text_base_common_1.formattedTextProperty.setNative] = function (value) {
        this._setNativeText();
        text_base_common_1.textProperty.nativeValueChange(this, !value ? "" : value.toString());
        this._requestLayoutOnTextChanged();
    };
    TextBase.prototype[text_base_common_1.colorProperty.getDefault] = function () {
        var nativeView = this.nativeTextViewProtected;
        if (nativeView instanceof UIButton) {
            return nativeView.titleColorForState(0);
        }
        else {
            return nativeView.textColor;
        }
    };
    TextBase.prototype[text_base_common_1.colorProperty.setNative] = function (value) {
        var color = value instanceof text_base_common_1.Color ? value.ios : value;
        var nativeView = this.nativeTextViewProtected;
        if (nativeView instanceof UIButton) {
            nativeView.setTitleColorForState(color, 0);
            nativeView.titleLabel.textColor = color;
        }
        else {
            nativeView.textColor = color;
        }
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.getDefault] = function () {
        var nativeView = this.nativeTextViewProtected;
        nativeView = nativeView instanceof UIButton ? nativeView.titleLabel : nativeView;
        return nativeView.font;
    };
    TextBase.prototype[text_base_common_1.fontInternalProperty.setNative] = function (value) {
        if (!(value instanceof font_1.Font) || !this.formattedText) {
            var nativeView = this.nativeTextViewProtected;
            nativeView = nativeView instanceof UIButton ? nativeView.titleLabel : nativeView;
            var font = value instanceof font_1.Font ? value.getUIFont(nativeView.font) : value;
            nativeView.font = font;
        }
    };
    TextBase.prototype[text_base_common_1.textAlignmentProperty.setNative] = function (value) {
        var nativeView = this.nativeTextViewProtected;
        switch (value) {
            case "initial":
            case "left":
                nativeView.textAlignment = 0;
                break;
            case "center":
                nativeView.textAlignment = 1;
                break;
            case "right":
                nativeView.textAlignment = 2;
                break;
        }
    };
    TextBase.prototype[text_base_common_1.textDecorationProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype[text_base_common_1.textTransformProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype[text_base_common_1.letterSpacingProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype[text_base_common_1.lineHeightProperty.setNative] = function (value) {
        this._setNativeText();
    };
    TextBase.prototype._setNativeText = function (reset) {
        if (reset === void 0) { reset = false; }
        if (reset) {
            var nativeView = this.nativeTextViewProtected;
            if (nativeView instanceof UIButton) {
                nativeView.setAttributedTitleForState(null, 0);
                nativeView.setTitleForState(null, 0);
            }
            else {
                nativeView.attributedText = null;
                nativeView.text = null;
            }
            return;
        }
        if (this.formattedText) {
            this.setFormattedTextDecorationAndTransform();
        }
        else {
            this.setTextDecorationAndTransform();
        }
    };
    TextBase.prototype.setFormattedTextDecorationAndTransform = function () {
        var attrText = this.createNSMutableAttributedString(this.formattedText);
        if (this.letterSpacing !== 0) {
            attrText.addAttributeValueRange(NSKernAttributeName, this.letterSpacing * this.nativeTextViewProtected.font.pointSize, { location: 0, length: attrText.length });
        }
        if (this.style.lineHeight) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.lineSpacing = this.lineHeight;
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            if (this.nativeTextViewProtected instanceof UILabel) {
                paragraphStyle.lineBreakMode = this.nativeTextViewProtected.lineBreakMode;
            }
            attrText.addAttributeValueRange(NSParagraphStyleAttributeName, paragraphStyle, { location: 0, length: attrText.length });
        }
        else if (this.nativeTextViewProtected instanceof UITextView) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            attrText.addAttributeValueRange(NSParagraphStyleAttributeName, paragraphStyle, { location: 0, length: attrText.length });
        }
        if (this.nativeTextViewProtected instanceof UIButton) {
            this.nativeTextViewProtected.setAttributedTitleForState(attrText, 0);
        }
        else {
            this.nativeTextViewProtected.attributedText = attrText;
        }
    };
    TextBase.prototype.setTextDecorationAndTransform = function () {
        var style = this.style;
        var dict = new Map();
        switch (style.textDecoration) {
            case "none":
                break;
            case "underline":
                dict.set(NSUnderlineStyleAttributeName, 1);
                break;
            case "line-through":
                dict.set(NSStrikethroughStyleAttributeName, 1);
                break;
            case "underline line-through":
                dict.set(NSUnderlineStyleAttributeName, 1);
                dict.set(NSStrikethroughStyleAttributeName, 1);
                break;
            default:
                throw new Error("Invalid text decoration value: " + style.textDecoration + ". Valid values are: 'none', 'underline', 'line-through', 'underline line-through'.");
        }
        if (style.letterSpacing !== 0) {
            dict.set(NSKernAttributeName, style.letterSpacing * this.nativeTextViewProtected.font.pointSize);
        }
        var isTextView = this.nativeTextViewProtected instanceof UITextView;
        if (style.lineHeight) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.lineSpacing = style.lineHeight;
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            if (this.nativeTextViewProtected instanceof UILabel) {
                paragraphStyle.lineBreakMode = this.nativeTextViewProtected.lineBreakMode;
            }
            dict.set(NSParagraphStyleAttributeName, paragraphStyle);
        }
        else if (isTextView) {
            var paragraphStyle = NSMutableParagraphStyle.alloc().init();
            paragraphStyle.alignment = this.nativeTextViewProtected.textAlignment;
            dict.set(NSParagraphStyleAttributeName, paragraphStyle);
        }
        if (style.color && (dict.size > 0 || isTextView)) {
            dict.set(NSForegroundColorAttributeName, style.color.ios);
        }
        var text = this.text;
        var string = (text === undefined || text === null) ? "" : text.toString();
        var source = getTransformedText(string, this.textTransform);
        if (dict.size > 0 || isTextView) {
            if (isTextView) {
                dict.set(NSFontAttributeName, this.nativeTextViewProtected.font);
            }
            var result = NSMutableAttributedString.alloc().initWithString(source);
            result.setAttributesRange(dict, { location: 0, length: source.length });
            if (this.nativeTextViewProtected instanceof UIButton) {
                this.nativeTextViewProtected.setAttributedTitleForState(result, 0);
            }
            else {
                this.nativeTextViewProtected.attributedText = result;
            }
        }
        else {
            if (this.nativeTextViewProtected instanceof UIButton) {
                this.nativeTextViewProtected.setAttributedTitleForState(null, 0);
                this.nativeTextViewProtected.setTitleForState(source, 0);
            }
            else {
                this.nativeTextViewProtected.attributedText = undefined;
                this.nativeTextViewProtected.text = source;
            }
        }
    };
    TextBase.prototype.createNSMutableAttributedString = function (formattedString) {
        var mas = NSMutableAttributedString.alloc().init();
        if (formattedString && formattedString.parent) {
            for (var i = 0, spanStart = 0, length_1 = formattedString.spans.length; i < length_1; i++) {
                var span = formattedString.spans.getItem(i);
                var text = span.text;
                var textTransform = formattedString.parent.textTransform;
                var spanText = (text === null || text === undefined) ? "" : text.toString();
                if (textTransform !== "none" && textTransform !== "initial") {
                    spanText = getTransformedText(spanText, textTransform);
                }
                var nsAttributedString = this.createMutableStringForSpan(span, spanText);
                mas.insertAttributedStringAtIndex(nsAttributedString, spanStart);
                spanStart += spanText.length;
            }
        }
        return mas;
    };
    TextBase.prototype.createMutableStringForSpan = function (span, text) {
        var viewFont = this.nativeTextViewProtected.font;
        var attrDict = {};
        var style = span.style;
        var bold = text_base_common_1.isBold(style.fontWeight);
        var italic = style.fontStyle === "italic";
        var fontFamily = span.fontFamily;
        var fontSize = span.fontSize;
        if (bold || italic || fontFamily || fontSize) {
            var font = new font_1.Font(style.fontFamily, style.fontSize, style.fontStyle, style.fontWeight);
            var iosFont = font.getUIFont(viewFont);
            attrDict[NSFontAttributeName] = iosFont;
        }
        var color = span.color;
        if (color) {
            attrDict[NSForegroundColorAttributeName] = color.ios;
        }
        var backgroundColor = (style.backgroundColor
            || span.parent.backgroundColor
            || span.parent.parent.backgroundColor);
        if (backgroundColor) {
            attrDict[NSBackgroundColorAttributeName] = backgroundColor.ios;
        }
        var valueSource;
        if (text_base_common_1.textDecorationProperty.isSet(style)) {
            valueSource = style;
        }
        else if (text_base_common_1.textDecorationProperty.isSet(span.parent.style)) {
            valueSource = span.parent.style;
        }
        else if (text_base_common_1.textDecorationProperty.isSet(span.parent.parent.style)) {
            valueSource = span.parent.parent.style;
        }
        if (valueSource) {
            var textDecorations = valueSource.textDecoration;
            var underline_1 = textDecorations.indexOf("underline") !== -1;
            if (underline_1) {
                attrDict[NSUnderlineStyleAttributeName] = underline_1;
            }
            var strikethrough = textDecorations.indexOf("line-through") !== -1;
            if (strikethrough) {
                attrDict[NSStrikethroughStyleAttributeName] = strikethrough;
            }
        }
        return NSMutableAttributedString.alloc().initWithStringAttributes(text, attrDict);
    };
    return TextBase;
}(text_base_common_1.TextBaseCommon));
exports.TextBase = TextBase;
function getTransformedText(text, textTransform) {
    if (!text || !types_1.isString(text)) {
        return "";
    }
    switch (textTransform) {
        case "uppercase":
            return NSStringFromNSAttributedString(text).uppercaseString;
        case "lowercase":
            return NSStringFromNSAttributedString(text).lowercaseString;
        case "capitalize":
            return NSStringFromNSAttributedString(text).capitalizedString;
        default:
            return text;
    }
}
exports.getTransformedText = getTransformedText;
function NSStringFromNSAttributedString(source) {
    return NSString.stringWithString(source instanceof NSAttributedString && source.string || source);
}
//# sourceMappingURL=text-base.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var editable_text_base_1 = __webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/editable-text-base/editable-text-base.js"));
var TextFieldBase = (function (_super) {
    __extends(TextFieldBase, _super);
    function TextFieldBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextFieldBase.returnPressEvent = "returnPress";
    TextFieldBase = __decorate([
        editable_text_base_1.CSSType("TextField")
    ], TextFieldBase);
    return TextFieldBase;
}(editable_text_base_1.EditableTextBase));
exports.TextFieldBase = TextFieldBase;
TextFieldBase.prototype.recycleNativeView = "auto";
exports.secureProperty = new editable_text_base_1.Property({ name: "secure", defaultValue: false, valueConverter: editable_text_base_1.booleanConverter });
exports.secureProperty.register(TextFieldBase);
//# sourceMappingURL=text-field-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/text-field/text-field.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var text_field_common_1 = __webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js");
var profiling_1 = __webpack_require__("../node_modules/tns-core-modules/profiling/profiling.js");
__export(__webpack_require__("../node_modules/tns-core-modules/ui/text-field/text-field-common.js"));
var zeroLength = {
    value: 0,
    unit: "px"
};
var UITextFieldDelegateImpl = (function (_super) {
    __extends(UITextFieldDelegateImpl, _super);
    function UITextFieldDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITextFieldDelegateImpl.initWithOwner = function (owner) {
        var delegate = UITextFieldDelegateImpl.new();
        delegate._owner = owner;
        return delegate;
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldBeginEditing = function (textField) {
        this.firstEdit = true;
        var owner = this._owner.get();
        if (owner) {
            return owner.editable;
        }
        return true;
    };
    UITextFieldDelegateImpl.prototype.textFieldDidBeginEditing = function (textField) {
        var owner = this._owner.get();
        if (owner) {
            owner.notify({ eventName: TextField.focusEvent, object: owner });
        }
    };
    UITextFieldDelegateImpl.prototype.textFieldDidEndEditing = function (textField) {
        var owner = this._owner.get();
        if (owner) {
            if (owner.updateTextTrigger === "focusLost") {
                text_field_common_1.textProperty.nativeValueChange(owner, textField.text);
            }
            owner.dismissSoftInput();
        }
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldClear = function (textField) {
        this.firstEdit = false;
        var owner = this._owner.get();
        if (owner) {
            text_field_common_1.textProperty.nativeValueChange(owner, "");
        }
        return true;
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldReturn = function (textField) {
        var owner = this._owner.get();
        if (owner) {
            owner.dismissSoftInput();
            owner.notify({ eventName: TextField.returnPressEvent, object: owner });
        }
        return true;
    };
    UITextFieldDelegateImpl.prototype.textFieldShouldChangeCharactersInRangeReplacementString = function (textField, range, replacementString) {
        var owner = this._owner.get();
        if (owner) {
            var delta = replacementString.length - range.length;
            if (delta > 0) {
                if (textField.text.length + delta > owner.maxLength) {
                    return false;
                }
            }
            if (owner.updateTextTrigger === "textChanged") {
                if (textField.secureTextEntry && this.firstEdit) {
                    text_field_common_1.textProperty.nativeValueChange(owner, replacementString);
                }
                else {
                    if (range.location <= textField.text.length) {
                        var newText = NSString.stringWithString(textField.text).stringByReplacingCharactersInRangeWithString(range, replacementString);
                        text_field_common_1.textProperty.nativeValueChange(owner, newText);
                    }
                }
            }
            if (owner.formattedText) {
                text_field_common_1._updateCharactersInRangeReplacementString(owner.formattedText, range.location, range.length, replacementString);
            }
        }
        this.firstEdit = false;
        return true;
    };
    UITextFieldDelegateImpl.ObjCProtocols = [UITextFieldDelegate];
    return UITextFieldDelegateImpl;
}(NSObject));
var UITextFieldImpl = (function (_super) {
    __extends(UITextFieldImpl, _super);
    function UITextFieldImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UITextFieldImpl.initWithOwner = function (owner) {
        var handler = UITextFieldImpl.new();
        handler._owner = owner;
        return handler;
    };
    UITextFieldImpl.prototype._getTextRectForBounds = function (bounds) {
        var owner = this._owner ? this._owner.get() : null;
        if (!owner) {
            return bounds;
        }
        var size = bounds.size;
        var x = text_field_common_1.layout.toDeviceIndependentPixels(owner.effectiveBorderLeftWidth + owner.effectivePaddingLeft);
        var y = text_field_common_1.layout.toDeviceIndependentPixels(owner.effectiveBorderTopWidth + owner.effectivePaddingTop);
        var width = text_field_common_1.layout.toDeviceIndependentPixels(text_field_common_1.layout.toDevicePixels(size.width) - (owner.effectiveBorderLeftWidth + owner.effectivePaddingLeft + owner.effectivePaddingRight + owner.effectiveBorderRightWidth));
        var height = text_field_common_1.layout.toDeviceIndependentPixels(text_field_common_1.layout.toDevicePixels(size.height) - (owner.effectiveBorderTopWidth + owner.effectivePaddingTop + owner.effectivePaddingBottom + owner.effectiveBorderBottomWidth));
        return CGRectMake(x, y, width, height);
    };
    UITextFieldImpl.prototype.textRectForBounds = function (bounds) {
        return this._getTextRectForBounds(bounds);
    };
    UITextFieldImpl.prototype.editingRectForBounds = function (bounds) {
        return this._getTextRectForBounds(bounds);
    };
    return UITextFieldImpl;
}(UITextField));
var TextField = (function (_super) {
    __extends(TextField, _super);
    function TextField() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    TextField.prototype.createNativeView = function () {
        return UITextFieldImpl.initWithOwner(new WeakRef(this));
    };
    TextField.prototype.initNativeView = function () {
        _super.prototype.initNativeView.call(this);
        this._delegate = UITextFieldDelegateImpl.initWithOwner(new WeakRef(this));
    };
    TextField.prototype.disposeNativeView = function () {
        this._delegate = null;
        _super.prototype.disposeNativeView.call(this);
    };
    TextField.prototype.onLoaded = function () {
        _super.prototype.onLoaded.call(this);
        this.ios.delegate = this._delegate;
    };
    TextField.prototype.onUnloaded = function () {
        this.ios.delegate = null;
        _super.prototype.onUnloaded.call(this);
    };
    Object.defineProperty(TextField.prototype, "ios", {
        get: function () {
            return this.nativeViewProtected;
        },
        enumerable: true,
        configurable: true
    });
    TextField.prototype[text_field_common_1.hintProperty.getDefault] = function () {
        return this.nativeTextViewProtected.placeholder;
    };
    TextField.prototype[text_field_common_1.hintProperty.setNative] = function (value) {
        this._updateAttributedPlaceholder();
    };
    TextField.prototype[text_field_common_1.secureProperty.getDefault] = function () {
        return this.nativeTextViewProtected.secureTextEntry;
    };
    TextField.prototype[text_field_common_1.secureProperty.setNative] = function (value) {
        this.nativeTextViewProtected.secureTextEntry = value;
    };
    TextField.prototype[text_field_common_1.colorProperty.getDefault] = function () {
        return {
            textColor: this.nativeTextViewProtected.textColor,
            tintColor: this.nativeTextViewProtected.tintColor
        };
    };
    TextField.prototype[text_field_common_1.colorProperty.setNative] = function (value) {
        if (value instanceof text_field_common_1.Color) {
            var color = value instanceof text_field_common_1.Color ? value.ios : value;
            this.nativeTextViewProtected.textColor = color;
            this.nativeTextViewProtected.tintColor = color;
        }
        else {
            this.nativeTextViewProtected.textColor = value.textColor;
            this.nativeTextViewProtected.tintColor = value.tintColor;
        }
    };
    TextField.prototype[text_field_common_1.placeholderColorProperty.getDefault] = function () {
        return null;
    };
    TextField.prototype[text_field_common_1.placeholderColorProperty.setNative] = function (value) {
        this._updateAttributedPlaceholder();
    };
    TextField.prototype._updateAttributedPlaceholder = function () {
        var stringValue = this.hint;
        if (stringValue === null || stringValue === void 0) {
            stringValue = "";
        }
        else {
            stringValue = stringValue + "";
        }
        if (stringValue === "") {
            stringValue = " ";
        }
        var attributes = {};
        if (this.style.placeholderColor) {
            attributes[NSForegroundColorAttributeName] = this.style.placeholderColor.ios;
        }
        var attributedPlaceholder = NSAttributedString.alloc().initWithStringAttributes(stringValue, attributes);
        this.nativeTextViewProtected.attributedPlaceholder = attributedPlaceholder;
    };
    TextField.prototype[text_field_common_1.paddingTopProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingTopProperty.setNative] = function (value) {
    };
    TextField.prototype[text_field_common_1.paddingRightProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingRightProperty.setNative] = function (value) {
    };
    TextField.prototype[text_field_common_1.paddingBottomProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingBottomProperty.setNative] = function (value) {
    };
    TextField.prototype[text_field_common_1.paddingLeftProperty.getDefault] = function () {
        return zeroLength;
    };
    TextField.prototype[text_field_common_1.paddingLeftProperty.setNative] = function (value) {
    };
    __decorate([
        profiling_1.profile
    ], TextField.prototype, "onLoaded", null);
    return TextField;
}(text_field_common_1.TextFieldBase));
exports.TextField = TextField;
//# sourceMappingURL=text-field.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/fade-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var FadeTransition = (function (_super) {
    __extends(FadeTransition, _super);
    function FadeTransition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    FadeTransition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        var originalToViewAlpha = toView.alpha;
        var originalFromViewAlpha = fromView.alpha;
        toView.alpha = 0.0;
        fromView.alpha = 1.0;
        switch (operation) {
            case 1:
                containerView.insertSubviewAboveSubview(toView, fromView);
                break;
            case 2:
                containerView.insertSubviewBelowSubview(toView, fromView);
                break;
        }
        var duration = this.getDuration();
        var curve = this.getCurve();
        UIView.animateWithDurationAnimationsCompletion(duration, function () {
            UIView.setAnimationCurve(curve);
            toView.alpha = 1.0;
            fromView.alpha = 0.0;
        }, function (finished) {
            toView.alpha = originalToViewAlpha;
            fromView.alpha = originalFromViewAlpha;
            completion(finished);
        });
    };
    return FadeTransition;
}(transition_1.Transition));
exports.FadeTransition = FadeTransition;
//# sourceMappingURL=fade-transition.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/slide-transition.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var transition_1 = __webpack_require__("../node_modules/tns-core-modules/ui/transition/transition.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
var screenWidth = platform_1.screen.mainScreen.widthDIPs;
var screenHeight = platform_1.screen.mainScreen.heightDIPs;
var leftEdge = CGAffineTransformMakeTranslation(-screenWidth, 0);
var rightEdge = CGAffineTransformMakeTranslation(screenWidth, 0);
var topEdge = CGAffineTransformMakeTranslation(0, -screenHeight);
var bottomEdge = CGAffineTransformMakeTranslation(0, screenHeight);
var SlideTransition = (function (_super) {
    __extends(SlideTransition, _super);
    function SlideTransition(direction, duration, curve) {
        var _this = _super.call(this, duration, curve) || this;
        _this._direction = direction;
        return _this;
    }
    SlideTransition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        var originalToViewTransform = toView.transform;
        var originalFromViewTransform = fromView.transform;
        var fromViewEndTransform;
        var toViewBeginTransform;
        var push = (operation === 1);
        switch (this._direction) {
            case "left":
                toViewBeginTransform = push ? rightEdge : leftEdge;
                fromViewEndTransform = push ? leftEdge : rightEdge;
                break;
            case "right":
                toViewBeginTransform = push ? leftEdge : rightEdge;
                fromViewEndTransform = push ? rightEdge : leftEdge;
                break;
            case "top":
                toViewBeginTransform = push ? bottomEdge : topEdge;
                fromViewEndTransform = push ? topEdge : bottomEdge;
                break;
            case "bottom":
                toViewBeginTransform = push ? topEdge : bottomEdge;
                fromViewEndTransform = push ? bottomEdge : topEdge;
                break;
        }
        toView.transform = toViewBeginTransform;
        fromView.transform = CGAffineTransformIdentity;
        switch (operation) {
            case 1:
                containerView.insertSubviewAboveSubview(toView, fromView);
                break;
            case 2:
                containerView.insertSubviewBelowSubview(toView, fromView);
                break;
        }
        var duration = this.getDuration();
        var curve = this.getCurve();
        UIView.animateWithDurationAnimationsCompletion(duration, function () {
            UIView.setAnimationCurve(curve);
            toView.transform = CGAffineTransformIdentity;
            fromView.transform = fromViewEndTransform;
        }, function (finished) {
            toView.transform = originalToViewTransform;
            fromView.transform = originalFromViewTransform;
            completion(finished);
        });
    };
    return SlideTransition;
}(transition_1.Transition));
exports.SlideTransition = SlideTransition;
//# sourceMappingURL=slide-transition.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/ui/transition/transition.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var transitionId = 0;
var Transition = (function () {
    function Transition(duration, curve) {
        if (curve === void 0) { curve = 0; }
        this._duration = duration ? (duration / 1000) : 0.35;
        this._curve = curve;
        this._id = transitionId++;
    }
    Transition.prototype.getDuration = function () {
        return this._duration;
    };
    Transition.prototype.getCurve = function () {
        return this._curve;
    };
    Transition.prototype.animateIOSTransition = function (containerView, fromView, toView, operation, completion) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.createAndroidAnimator = function (transitionType) {
        throw new Error("Abstract method call");
    };
    Transition.prototype.toString = function () {
        return "Transition@" + this._id;
    };
    return Transition;
}());
exports.Transition = Transition;
//# sourceMappingURL=transition.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/debug.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var file_system_1 = __webpack_require__("../node_modules/tns-core-modules/file-system/file-system.js");
var platform_1 = __webpack_require__("../node_modules/tns-core-modules/platform/platform.js");
exports.debug = true;
var applicationRootPath;
function ensureAppRootPath() {
    if (!applicationRootPath) {
        applicationRootPath = file_system_1.knownFolders.currentApp().path;
        applicationRootPath = applicationRootPath.substr(0, applicationRootPath.length - "app/".length);
    }
}
var Source = (function () {
    function Source(uri, line, column) {
        ensureAppRootPath();
        if (uri.length > applicationRootPath.length && uri.substr(0, applicationRootPath.length) === applicationRootPath) {
            this._uri = "file://" + uri.substr(applicationRootPath.length);
        }
        else {
            this._uri = uri;
        }
        this._line = line;
        this._column = column;
    }
    Object.defineProperty(Source.prototype, "uri", {
        get: function () { return this._uri; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "line", {
        get: function () { return this._line; },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Source.prototype, "column", {
        get: function () { return this._column; },
        enumerable: true,
        configurable: true
    });
    Source.prototype.toString = function () {
        return this._uri + ":" + this._line + ":" + this._column;
    };
    Source.get = function (object) {
        return object[Source._source];
    };
    Source.set = function (object, src) {
        object[Source._source] = src;
    };
    Source._source = Symbol("source");
    return Source;
}());
exports.Source = Source;
var ScopeError = (function (_super) {
    __extends(ScopeError, _super);
    function ScopeError(inner, message) {
        var _this = this;
        var formattedMessage;
        if (message && inner.message) {
            formattedMessage = message + "\n > " + inner.message.replace("\n", "\n  ");
        }
        else {
            formattedMessage = message || inner.message || undefined;
        }
        _this = _super.call(this, formattedMessage) || this;
        _this.stack = platform_1.isAndroid ? "Error: " + _this.message + "\n" + inner.stack.substr(inner.stack.indexOf("\n") + 1) : inner.stack;
        _this.message = formattedMessage;
        return _this;
    }
    return ScopeError;
}(Error));
exports.ScopeError = ScopeError;
var SourceError = (function (_super) {
    __extends(SourceError, _super);
    function SourceError(child, source, message) {
        return _super.call(this, child, message ? message + " @" + source + "" : source + "") || this;
    }
    return SourceError;
}(ScopeError));
exports.SourceError = SourceError;
//# sourceMappingURL=debug.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/mainthread-helper.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function dispatchToMainThread(func) {
    NSOperationQueue.mainQueue.addOperationWithBlock(func);
}
exports.dispatchToMainThread = dispatchToMainThread;
function isMainThread() {
    return NSThread.isMainThread;
}
exports.isMainThread = isMainThread;
//# sourceMappingURL=mainthread-helper.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/number-utils.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
var epsilon = 1E-05;
function areClose(value1, value2) {
    return (Math.abs(value1 - value2) < epsilon);
}
exports.areClose = areClose;
function greaterThanOrClose(value1, value2) {
    return (value1 > value2) || areClose(value1, value2);
}
exports.greaterThanOrClose = greaterThanOrClose;
function greaterThan(value1, value2) {
    return (value1 > value2) && !areClose(value1, value2);
}
exports.greaterThan = greaterThan;
function lessThan(value1, value2) {
    return (value1 < value2) && !areClose(value1, value2);
}
exports.lessThan = lessThan;
function isZero(value) {
    return (Math.abs(value) < epsilon);
}
exports.isZero = isZero;
function greaterThanZero(value) {
    return value > 0;
}
exports.greaterThanZero = greaterThanZero;
function notNegative(value) {
    return value >= 0;
}
exports.notNegative = notNegative;
exports.radiansToDegrees = function (a) { return a * (180 / Math.PI); };
exports.degreesToRadians = function (a) { return a * (Math.PI / 180); };
//# sourceMappingURL=number-utils.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/types.js":
/***/ (function(module, exports) {

Object.defineProperty(exports, "__esModule", { value: true });
function isString(value) {
    return typeof value === "string" || value instanceof String;
}
exports.isString = isString;
function isNumber(value) {
    return typeof value === "number" || value instanceof Number;
}
exports.isNumber = isNumber;
function isBoolean(value) {
    return typeof value === "boolean" || value instanceof Boolean;
}
exports.isBoolean = isBoolean;
function isFunction(value) {
    if (!value) {
        return false;
    }
    return typeof value === "function";
}
exports.isFunction = isFunction;
function isObject(value) {
    if (!value) {
        return false;
    }
    return typeof value === "object";
}
exports.isObject = isObject;
function isUndefined(value) {
    return value === undefined;
}
exports.isUndefined = isUndefined;
function isDefined(value) {
    return typeof value !== "undefined";
}
exports.isDefined = isDefined;
function isNullOrUndefined(value) {
    return value === undefined || value === null;
}
exports.isNullOrUndefined = isNullOrUndefined;
function verifyCallback(value) {
    if (value && !isFunction(value)) {
        throw new TypeError("Callback must be a valid function.");
    }
}
exports.verifyCallback = verifyCallback;
var classInfosMap = new Map();
var funcNameRegex = /function ([_a-zA-Z0-9]{1,})\(/;
function getClass(object) {
    return getClassInfo(object).name;
}
exports.getClass = getClass;
function getClassInfo(object) {
    var constructor = object.constructor;
    var result = classInfosMap.get(constructor);
    if (!result) {
        result = new ClassInfo(constructor);
        classInfosMap.set(constructor, result);
    }
    return result;
}
exports.getClassInfo = getClassInfo;
function getBaseClasses(object) {
    var result = [];
    var info = getClassInfo(object);
    while (info) {
        result.push(info.name);
        info = info.baseClassInfo;
    }
    return result;
}
exports.getBaseClasses = getBaseClasses;
var ClassInfo = (function () {
    function ClassInfo(typeCosntructor) {
        this._typeCosntructor = typeCosntructor;
    }
    Object.defineProperty(ClassInfo.prototype, "name", {
        get: function () {
            if (!this._name) {
                var results = (funcNameRegex).exec(this._typeCosntructor.toString());
                this._name = (results && results.length > 1) ? results[1] : "";
            }
            return this._name;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ClassInfo.prototype, "baseClassInfo", {
        get: function () {
            if (isUndefined(this._baseClassInfo)) {
                this._baseClassInfo = ClassInfo._getBase(this);
                if (this._baseClassInfo && this._baseClassInfo.name === this.name) {
                    this._baseClassInfo = ClassInfo._getBase(this._baseClassInfo);
                }
            }
            return this._baseClassInfo;
        },
        enumerable: true,
        configurable: true
    });
    ClassInfo._getBase = function (info) {
        var result = null;
        var constructorProto = info._typeCosntructor.prototype;
        if (constructorProto.__proto__) {
            result = getClassInfo(constructorProto.__proto__);
        }
        return result;
    };
    return ClassInfo;
}());
exports.ClassInfo = ClassInfo;
function toUIString(obj) {
    return isNullOrUndefined(obj) ? "" : obj + "";
}
exports.toUIString = toUIString;
//# sourceMappingURL=types.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils-common.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var mainthread_helper_1 = __webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js");
var module_name_sanitizer_1 = __webpack_require__("../node_modules/tns-core-modules/ui/builder/module-name-sanitizer.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/mainthread-helper.js"));
exports.RESOURCE_PREFIX = "res://";
exports.FILE_PREFIX = "file:///";
function escapeRegexSymbols(source) {
    var escapeRegex = /[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;
    return source.replace(escapeRegex, "\\$&");
}
exports.escapeRegexSymbols = escapeRegexSymbols;
function convertString(value) {
    var result;
    if (!types.isString(value) || value.trim() === "") {
        result = value;
    }
    else {
        var valueAsNumber = +value;
        if (!isNaN(valueAsNumber)) {
            result = valueAsNumber;
        }
        else if (value && (value.toLowerCase() === "true" || value.toLowerCase() === "false")) {
            result = value.toLowerCase() === "true" ? true : false;
        }
        else {
            result = value;
        }
    }
    return result;
}
exports.convertString = convertString;
function getModuleName(path) {
    var moduleName = path.replace("./", "");
    return module_name_sanitizer_1.sanitizeModuleName(moduleName);
}
exports.getModuleName = getModuleName;
var layoutCommon;
(function (layoutCommon) {
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    layoutCommon.UNSPECIFIED = 0 << MODE_SHIFT;
    layoutCommon.EXACTLY = 1 << MODE_SHIFT;
    layoutCommon.AT_MOST = 2 << MODE_SHIFT;
    layoutCommon.MEASURED_HEIGHT_STATE_SHIFT = 0x00000010;
    layoutCommon.MEASURED_STATE_TOO_SMALL = 0x01000000;
    layoutCommon.MEASURED_STATE_MASK = 0xff000000;
    layoutCommon.MEASURED_SIZE_MASK = 0x00ffffff;
    function getMode(mode) {
        switch (mode) {
            case layoutCommon.EXACTLY:
                return "Exact";
            case layoutCommon.AT_MOST:
                return "AtMost";
            default:
                return "Unspecified";
        }
    }
    layoutCommon.getMode = getMode;
    function getMeasureSpecMode(spec) {
        return (spec & MODE_MASK);
    }
    layoutCommon.getMeasureSpecMode = getMeasureSpecMode;
    function getMeasureSpecSize(spec) {
        return (spec & ~MODE_MASK);
    }
    layoutCommon.getMeasureSpecSize = getMeasureSpecSize;
    function measureSpecToString(measureSpec) {
        var mode = getMeasureSpecMode(measureSpec);
        var size = getMeasureSpecSize(measureSpec);
        var text = "MeasureSpec: ";
        if (mode === layoutCommon.UNSPECIFIED) {
            text += "UNSPECIFIED ";
        }
        else if (mode === layoutCommon.EXACTLY) {
            text += "EXACTLY ";
        }
        else if (mode === layoutCommon.AT_MOST) {
            text += "AT_MOST ";
        }
        text += size;
        return text;
    }
    layoutCommon.measureSpecToString = measureSpecToString;
    function round(value) {
        var res = Math.floor(value + 0.5);
        if (res !== 0) {
            return res;
        }
        else if (value === 0) {
            return 0;
        }
        else if (value > 0) {
            return 1;
        }
        return -1;
    }
    layoutCommon.round = round;
})(layoutCommon = exports.layoutCommon || (exports.layoutCommon = {}));
function isFileOrResourcePath(path) {
    if (!types.isString(path)) {
        return false;
    }
    return path.indexOf("~/") === 0 ||
        path.indexOf("/") === 0 ||
        path.indexOf(exports.RESOURCE_PREFIX) === 0;
}
exports.isFileOrResourcePath = isFileOrResourcePath;
function isFontIconURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split("//")[0];
    return firstSegment && firstSegment.indexOf("font:") === 0;
}
exports.isFontIconURI = isFontIconURI;
function isDataURI(uri) {
    if (!types.isString(uri)) {
        return false;
    }
    var firstSegment = uri.trim().split(",")[0];
    return firstSegment && firstSegment.indexOf("data:") === 0 && firstSegment.indexOf("base64") >= 0;
}
exports.isDataURI = isDataURI;
function mergeSort(arr, compareFunc) {
    if (arr.length < 2) {
        return arr;
    }
    var middle = arr.length / 2;
    var left = arr.slice(0, middle);
    var right = arr.slice(middle, arr.length);
    return merge(mergeSort(left, compareFunc), mergeSort(right, compareFunc), compareFunc);
}
exports.mergeSort = mergeSort;
function merge(left, right, compareFunc) {
    var result = [];
    while (left.length && right.length) {
        if (compareFunc(left[0], right[0]) <= 0) {
            result.push(left.shift());
        }
        else {
            result.push(right.shift());
        }
    }
    while (left.length) {
        result.push(left.shift());
    }
    while (right.length) {
        result.push(right.shift());
    }
    return result;
}
exports.merge = merge;
function hasDuplicates(arr) {
    return arr.length !== eliminateDuplicates(arr).length;
}
exports.hasDuplicates = hasDuplicates;
function eliminateDuplicates(arr) {
    return Array.from(new Set(arr));
}
exports.eliminateDuplicates = eliminateDuplicates;
function executeOnMainThread(func) {
    if (mainthread_helper_1.isMainThread()) {
        return func();
    }
    else {
        mainthread_helper_1.dispatchToMainThread(func);
    }
}
exports.executeOnMainThread = executeOnMainThread;
function mainThreadify(func) {
    return function () {
        var _this = this;
        var argsToPass = arguments;
        executeOnMainThread(function () { return func.apply(_this, argsToPass); });
    };
}
exports.mainThreadify = mainThreadify;
//# sourceMappingURL=utils-common.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/utils/utils.js":
/***/ (function(module, exports, __webpack_require__) {

function __export(m) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}
Object.defineProperty(exports, "__esModule", { value: true });
var trace_1 = __webpack_require__("../node_modules/tns-core-modules/trace/trace.js");
var utils_common_1 = __webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js");
__export(__webpack_require__("../node_modules/tns-core-modules/utils/utils-common.js"));
var mainScreenScale;
function isOrientationLandscape(orientation) {
    return orientation === 3 || orientation === 4;
}
var layout;
(function (layout) {
    var MODE_SHIFT = 30;
    var MODE_MASK = 0x3 << MODE_SHIFT;
    function makeMeasureSpec(size, mode) {
        return (Math.round(Math.max(0, size)) & ~MODE_MASK) | (mode & MODE_MASK);
    }
    layout.makeMeasureSpec = makeMeasureSpec;
    function getDisplayDensity() {
        return mainScreenScale;
    }
    layout.getDisplayDensity = getDisplayDensity;
    function toDevicePixels(value) {
        return value * mainScreenScale;
    }
    layout.toDevicePixels = toDevicePixels;
    function toDeviceIndependentPixels(value) {
        return value / mainScreenScale;
    }
    layout.toDeviceIndependentPixels = toDeviceIndependentPixels;
    function measureNativeView(nativeView, width, widthMode, height, heightMode) {
        var view = nativeView;
        var nativeSize = view.sizeThatFits({
            width: widthMode === 0 ? Number.POSITIVE_INFINITY : toDeviceIndependentPixels(width),
            height: heightMode === 0 ? Number.POSITIVE_INFINITY : toDeviceIndependentPixels(height)
        });
        nativeSize.width = utils_common_1.layoutCommon.round(toDevicePixels(nativeSize.width));
        nativeSize.height = utils_common_1.layoutCommon.round(toDevicePixels(nativeSize.height));
        return nativeSize;
    }
    layout.measureNativeView = measureNativeView;
})(layout = exports.layout || (exports.layout = {}));
Object.assign(layout, utils_common_1.layoutCommon);
var ios;
(function (ios) {
    function getter(_this, property) {
        console.log("utils.ios.getter() is deprecated; use the respective native property instead");
        if (typeof property === "function") {
            return property.call(_this);
        }
        else {
            return property;
        }
    }
    ios.getter = getter;
    var collections;
    (function (collections) {
        function jsArrayToNSArray(str) {
            return NSArray.arrayWithArray(str);
        }
        collections.jsArrayToNSArray = jsArrayToNSArray;
        function nsArrayToJSArray(a) {
            var arr = [];
            if (a !== undefined) {
                var count = a.count;
                for (var i = 0; i < count; i++) {
                    arr.push(a.objectAtIndex(i));
                }
            }
            return arr;
        }
        collections.nsArrayToJSArray = nsArrayToJSArray;
    })(collections = ios.collections || (ios.collections = {}));
    function isLandscape() {
        var device = UIDevice.currentDevice;
        var statusBarOrientation = UIApplication.sharedApplication.statusBarOrientation;
        var isStatusBarOrientationLandscape = isOrientationLandscape(statusBarOrientation);
        return isOrientationLandscape(device.orientation) || isStatusBarOrientationLandscape;
    }
    ios.isLandscape = isLandscape;
    ios.MajorVersion = NSString.stringWithString(UIDevice.currentDevice.systemVersion).intValue;
    function openFile(filePath) {
        try {
            var appPath = getCurrentAppPath();
            var path = filePath.replace("~", appPath);
            var controller = UIDocumentInteractionController.interactionControllerWithURL(NSURL.fileURLWithPath(path));
            controller.delegate = new UIDocumentInteractionControllerDelegateImpl();
            return controller.presentPreviewAnimated(true);
        }
        catch (e) {
            trace_1.write("Error in openFile", trace_1.categories.Error, trace_1.messageType.error);
        }
        return false;
    }
    ios.openFile = openFile;
    function getCurrentAppPath() {
        var currentDir = __dirname;
        var tnsModulesIndex = currentDir.indexOf("/tns_modules");
        var appPath = currentDir;
        if (tnsModulesIndex !== -1) {
            appPath = currentDir.substring(0, tnsModulesIndex);
        }
        return appPath;
    }
    ios.getCurrentAppPath = getCurrentAppPath;
    function joinPaths() {
        var paths = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            paths[_i] = arguments[_i];
        }
        if (!paths || paths.length === 0) {
            return "";
        }
        return NSString.stringWithString(NSString.pathWithComponents(paths)).stringByStandardizingPath;
    }
    ios.joinPaths = joinPaths;
    function getVisibleViewController(rootViewController) {
        if (rootViewController.presentedViewController) {
            return getVisibleViewController(rootViewController.presentedViewController);
        }
        if (rootViewController.isKindOfClass(UINavigationController.class())) {
            return getVisibleViewController(rootViewController.visibleViewController);
        }
        if (rootViewController.isKindOfClass(UITabBarController.class())) {
            return getVisibleViewController(rootViewController);
        }
        return rootViewController;
    }
    ios.getVisibleViewController = getVisibleViewController;
})(ios = exports.ios || (exports.ios = {}));
function GC() {
    __collect();
}
exports.GC = GC;
function releaseNativeObject(object) {
    __releaseNativeCounterpart(object);
}
exports.releaseNativeObject = releaseNativeObject;
function openUrl(location) {
    try {
        var url = NSURL.URLWithString(location.trim());
        if (UIApplication.sharedApplication.canOpenURL(url)) {
            return UIApplication.sharedApplication.openURL(url);
        }
    }
    catch (e) {
        trace_1.write("Error in OpenURL", trace_1.categories.Error, trace_1.messageType.error);
    }
    return false;
}
exports.openUrl = openUrl;
var UIDocumentInteractionControllerDelegateImpl = (function (_super) {
    __extends(UIDocumentInteractionControllerDelegateImpl, _super);
    function UIDocumentInteractionControllerDelegateImpl() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    UIDocumentInteractionControllerDelegateImpl.prototype.getViewController = function () {
        var app = UIApplication.sharedApplication;
        return app.keyWindow.rootViewController;
    };
    UIDocumentInteractionControllerDelegateImpl.prototype.documentInteractionControllerViewControllerForPreview = function (controller) {
        return this.getViewController();
    };
    UIDocumentInteractionControllerDelegateImpl.prototype.documentInteractionControllerViewForPreview = function (controller) {
        return this.getViewController().view;
    };
    UIDocumentInteractionControllerDelegateImpl.prototype.documentInteractionControllerRectForPreview = function (controller) {
        return this.getViewController().view.frame;
    };
    UIDocumentInteractionControllerDelegateImpl.ObjCProtocols = [UIDocumentInteractionControllerDelegate];
    return UIDocumentInteractionControllerDelegateImpl;
}(NSObject));
mainScreenScale = UIScreen.mainScreen.scale;
//# sourceMappingURL=utils.ios.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xhr/xhr.js":
/***/ (function(module, exports, __webpack_require__) {

Object.defineProperty(exports, "__esModule", { value: true });
var http = __webpack_require__("../node_modules/tns-core-modules/http/http.js");
var types = __webpack_require__("../node_modules/tns-core-modules/utils/types.js");
var XMLHttpRequestResponseType;
(function (XMLHttpRequestResponseType) {
    XMLHttpRequestResponseType.empty = "";
    XMLHttpRequestResponseType.text = "text";
    XMLHttpRequestResponseType.json = "json";
})(XMLHttpRequestResponseType || (XMLHttpRequestResponseType = {}));
var XMLHttpRequest = (function () {
    function XMLHttpRequest() {
        this.UNSENT = 0;
        this.OPENED = 1;
        this.HEADERS_RECEIVED = 2;
        this.LOADING = 3;
        this.DONE = 4;
        this._responseType = "";
        this.textTypes = [
            "text/plain",
            "application/xml",
            "application/rss+xml",
            "text/html",
            "text/xml"
        ];
        this._listeners = new Map();
        this._readyState = this.UNSENT;
    }
    XMLHttpRequest.prototype.open = function (method, url, async, user, password) {
        if (types.isString(method) && types.isString(url)) {
            this._options = { url: url, method: method };
            this._options.headers = {};
            if (types.isString(user)) {
                this._options.headers["user"] = user;
            }
            if (types.isString(password)) {
                this._options.headers["password"] = password;
            }
            this._setReadyState(this.OPENED);
        }
    };
    XMLHttpRequest.prototype.abort = function () {
        this._errorFlag = true;
        this._response = null;
        this._responseTextReader = null;
        this._headers = null;
        this._status = null;
        if (this._readyState === this.UNSENT || this._readyState === this.OPENED || this._readyState === this.DONE) {
            this._readyState = this.UNSENT;
        }
        else {
            this._setReadyState(this.DONE);
        }
    };
    XMLHttpRequest.prototype.send = function (data) {
        var _this = this;
        this._errorFlag = false;
        this._response = null;
        this._responseTextReader = null;
        this._headers = null;
        this._status = null;
        if (types.isDefined(this._options)) {
            if (types.isString(data) && this._options.method !== "GET") {
                this._options.content = data;
            }
            else if (data instanceof FormData) {
                this._options.content = data.toString();
            }
            http.request(this._options).then(function (r) {
                if (!_this._errorFlag) {
                    _this._loadResponse(r);
                }
            }).catch(function (e) {
                _this._errorFlag = true;
                _this._setReadyState(_this.DONE, e);
            });
        }
    };
    XMLHttpRequest.prototype._loadResponse = function (r) {
        this._status = r.statusCode;
        this._response = r.content.raw + "";
        this._headers = r.headers;
        this._setReadyState(this.HEADERS_RECEIVED);
        this._setReadyState(this.LOADING);
        this._setResponseType();
        this._responseTextReader = function () { return r.content.toString(); };
        this._addToStringOnResponse();
        if (this.responseType === XMLHttpRequestResponseType.json) {
            this._response = JSON.parse(this.responseText);
        }
        else if (this.responseType === XMLHttpRequestResponseType.text) {
            this._response = this.responseText;
        }
        this._setReadyState(this.DONE);
    };
    XMLHttpRequest.prototype._addToStringOnResponse = function () {
        var _this = this;
        if (types.isObject(this.response)) {
            Object.defineProperty(this._response, "toString", {
                configurable: true,
                enumerable: false,
                writable: true,
                value: function () { return _this.responseText; }
            });
        }
    };
    XMLHttpRequest.prototype.isTextContentType = function (contentType) {
        var result = false;
        for (var i = 0; i < this.textTypes.length; i++) {
            if (contentType.toLowerCase().indexOf(this.textTypes[i]) >= 0) {
                result = true;
                break;
            }
        }
        return result;
    };
    XMLHttpRequest.prototype._setResponseType = function () {
        var header = this.getResponseHeader("Content-Type");
        var contentType = header && header.toLowerCase();
        if (contentType) {
            if (contentType.indexOf("application/json") >= 0 || contentType.indexOf("+json") >= 0) {
                this.responseType = XMLHttpRequestResponseType.json;
            }
            else if (this.isTextContentType(contentType)) {
                this.responseType = XMLHttpRequestResponseType.text;
            }
        }
        else {
            this.responseType = XMLHttpRequestResponseType.text;
        }
    };
    XMLHttpRequest.prototype.addEventListener = function (eventName, handler) {
        if (eventName !== "load" && eventName !== "error" && eventName !== "progress") {
            throw new Error("Event not supported: " + eventName);
        }
        var handlers = this._listeners.get(eventName) || [];
        handlers.push(handler);
        this._listeners.set(eventName, handlers);
    };
    XMLHttpRequest.prototype.removeEventListener = function (eventName, toDetach) {
        var handlers = this._listeners.get(eventName) || [];
        handlers = handlers.filter(function (handler) { return handler !== toDetach; });
        this._listeners.set(eventName, handlers);
    };
    XMLHttpRequest.prototype.emitEvent = function (eventName) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var handlers = this._listeners.get(eventName) || [];
        handlers.forEach(function (handler) {
            handler.apply(void 0, args);
        });
    };
    XMLHttpRequest.prototype.setRequestHeader = function (header, value) {
        if (types.isDefined(this._options) && types.isString(header) && types.isString(value)) {
            this._options.headers[header] = value;
        }
    };
    XMLHttpRequest.prototype.getAllResponseHeaders = function () {
        if (this._readyState < 2 || this._errorFlag) {
            return "";
        }
        var result = "";
        for (var i in this._headers) {
            result += i + ": " + this._headers[i] + "\r\n";
        }
        return result.substr(0, result.length - 2);
    };
    XMLHttpRequest.prototype.getResponseHeader = function (header) {
        if (types.isString(header) && this._readyState > 1
            && this._headers
            && !this._errorFlag) {
            header = header.toLowerCase();
            for (var i in this._headers) {
                if (i.toLowerCase() === header) {
                    return this._headers[i];
                }
            }
        }
        return null;
    };
    XMLHttpRequest.prototype.overrideMimeType = function (mime) {
    };
    Object.defineProperty(XMLHttpRequest.prototype, "readyState", {
        get: function () {
            return this._readyState;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "responseType", {
        get: function () {
            return this._responseType;
        },
        set: function (value) {
            if (value === XMLHttpRequestResponseType.empty || value in XMLHttpRequestResponseType) {
                this._responseType = value;
            }
            else {
                throw new Error("Response type of '" + value + "' not supported.");
            }
        },
        enumerable: true,
        configurable: true
    });
    XMLHttpRequest.prototype._setReadyState = function (value, error) {
        if (this._readyState !== value) {
            this._readyState = value;
            if (types.isFunction(this.onreadystatechange)) {
                this.onreadystatechange();
            }
        }
        if (this._readyState === this.DONE) {
            if (this._errorFlag) {
                if (types.isFunction(this.onerror)) {
                    this.onerror(error);
                }
                this.emitEvent("error", error);
            }
            else {
                if (types.isFunction(this.onload)) {
                    this.onload();
                }
                this.emitEvent("load");
            }
        }
    };
    Object.defineProperty(XMLHttpRequest.prototype, "responseText", {
        get: function () {
            if (types.isFunction(this._responseTextReader)) {
                return this._responseTextReader();
            }
            return "";
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "response", {
        get: function () {
            return this._response;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "status", {
        get: function () {
            return this._status;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(XMLHttpRequest.prototype, "statusText", {
        get: function () {
            if (this._readyState === this.UNSENT || this._readyState === this.OPENED || this._errorFlag) {
                return "";
            }
            return statuses[this._status];
        },
        enumerable: true,
        configurable: true
    });
    return XMLHttpRequest;
}());
exports.XMLHttpRequest = XMLHttpRequest;
var statuses = {
    100: "Continue",
    101: "Switching Protocols",
    200: "OK",
    201: "Created",
    202: "Accepted",
    203: "Non - Authoritative Information",
    204: "No Content",
    205: "Reset Content",
    206: "Partial Content",
    300: "Multiple Choices",
    301: "Moved Permanently",
    302: "Found",
    303: "See Other",
    304: "Not Modified",
    305: "Use Proxy",
    307: "Temporary Redirect",
    400: "Bad Request",
    401: "Unauthorized",
    402: "Payment Required",
    403: "Forbidden",
    404: "Not Found",
    405: "Method Not Allowed",
    406: "Not Acceptable",
    407: "Proxy Authentication Required",
    408: "Request Timeout",
    409: "Conflict",
    410: "Gone",
    411: "Length Required",
    412: "Precondition Failed",
    413: "Request Entity Too Large",
    414: "Request - URI Too Long",
    415: "Unsupported Media Type",
    416: "Requested Range Not Satisfiable",
    417: "Expectation Failed",
    500: "Internal Server Error",
    501: "Not Implemented",
    502: "Bad Gateway",
    503: "Service Unavailable",
    504: "Gateway Timeout",
    505: "HTTP Version Not Supported"
};
var FormData = (function () {
    function FormData() {
        this._data = new Map();
    }
    FormData.prototype.append = function (name, value) {
        this._data.set(name, value);
    };
    FormData.prototype.toString = function () {
        var arr = new Array();
        this._data.forEach(function (value, name, map) {
            arr.push(encodeURIComponent(name) + "=" + encodeURIComponent(value));
        });
        return arr.join("&");
    };
    return FormData;
}());
exports.FormData = FormData;
//# sourceMappingURL=xhr.js.map

/***/ }),

/***/ "../node_modules/tns-core-modules/xml/xml.js":
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(global) {Object.defineProperty(exports, "__esModule", { value: true });
var easysax = __webpack_require__("../node_modules/tns-core-modules/js-libs/easysax/easysax.js");
var ParserEventType = (function () {
    function ParserEventType() {
    }
    ParserEventType.StartElement = "StartElement";
    ParserEventType.EndElement = "EndElement";
    ParserEventType.Text = "Text";
    ParserEventType.CDATA = "CDATA";
    ParserEventType.Comment = "Comment";
    return ParserEventType;
}());
exports.ParserEventType = ParserEventType;
var ParserEvent = (function () {
    function ParserEvent(eventType, position, prefix, namespace, elementName, attributes, data) {
        this._eventType = eventType;
        this._position = position;
        this._prefix = prefix;
        this._namespace = namespace;
        this._elementName = elementName;
        this._attributes = attributes;
        this._data = data;
    }
    ParserEvent.prototype.toString = function () {
        return JSON.stringify({
            eventType: this.eventType,
            position: this.position,
            prefix: this.prefix,
            namespace: this.namespace,
            elementName: this.elementName,
            attributes: this.attributes,
            data: this.data
        });
    };
    Object.defineProperty(ParserEvent.prototype, "eventType", {
        get: function () {
            return this._eventType;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "position", {
        get: function () {
            return this._position;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "prefix", {
        get: function () {
            return this._prefix;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "namespace", {
        get: function () {
            return this._namespace;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "elementName", {
        get: function () {
            return this._elementName;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "attributes", {
        get: function () {
            return this._attributes;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParserEvent.prototype, "data", {
        get: function () {
            return this._data;
        },
        enumerable: true,
        configurable: true
    });
    return ParserEvent;
}());
exports.ParserEvent = ParserEvent;
var _ampCodes;
var _entitySearchRegEx = /&#(\d+);|&#x([0123456789abcdef]+);|&(\w+);/ig;
function _generateAmpMap() {
    var objCodes = { Tab: 9, NewLine: 10, excl: 33, quot: 34, QUOT: 34, num: 35, dollar: 36, percent: 37, amp: 38, AMP: 38, apos: 39, lpar: 40, rpar: 41, ast: 42, midast: 42, plus: 43, comma: 44, period: 46, sol: 47, colon: 58, semi: 59, lt: 60, LT: 60, equals: 61, gt: 62, GT: 62, quest: 63, commat: 64, lsqb: 91, lbrack: 91, bsol: 92, rsqb: 92, rbrack: 92, Hat: 94, lowbar: 95, grave: 96, DiacriticalGrave: 96, lcub: 123, lbrace: 123, verbar: 124, vert: 124, VerticalLine: 124, rcub: 125, rbrace: 125, nbsp: 160, iexcl: 161, cent: 162, pound: 163, curren: 164, yen: 165, brvbar: 166, brkbar: 166, sect: 167, uml: 168, copy: 169, ordf: 170, laquo: 171, not: 172, shy: 173, reg: 174, macr: 175, hibar: 175, deg: 176, plusmn: 177, sup2: 178, sup3: 179, acute: 180, micro: 181, para: 182, middot: 183, cedil: 184, sup1: 185, ordm: 186, raquo: 187, frac14: 188, frac12: 189, frac34: 190, iquest: 191, Agrave: 192, Aacute: 193, Acirc: 194, Atilde: 195, Auml: 196, Aring: 197, AElig: 198, Ccedil: 199, Egrave: 200, Eacute: 201, Ecirc: 202, Euml: 203, Igrave: 204, Iacute: 205, Icirc: 206, Iuml: 207, ETH: 208, Dstrok: 208, Ntilde: 209, Ograve: 210, Oacute: 211, Ocirc: 212, Otilde: 213, Ouml: 214, times: 215, Oslash: 216, Ugrave: 217, Uacute: 218, Ucirc: 219, Uuml: 220, Yacute: 221, THORN: 222, szlig: 223, agrave: 224, aacute: 225, acirc: 226, atilde: 227, auml: 228, aring: 229, aelig: 230, ccedil: 231, egrave: 232, eacute: 233, ecirc: 234, euml: 235, igrave: 236, iacute: 237, icirc: 238, iuml: 239, eth: 240, ntilde: 241, ograve: 242, oacute: 243, ocirc: 244, otilde: 245, ouml: 246, divide: 247, oslash: 248, ugrave: 249, uacute: 250, ucirc: 251, uuml: 252, yacute: 253, thorn: 254, yuml: 255, fnof: 402, imped: 437, gacute: 501, jmath: 567, circ: 710, caron: 711, Hacek: 711, breve: 728, Breve: 728, dot: 729, DiacriticalDot: 729, ring: 730, ogon: 731, tilde: 732, DiacriticalTilde: 732, dblac: 733, DiacriticalDoubleAcute: 733, DownBreve: 785, UnderBar: 818, Alpha: 913, Beta: 914, Gamma: 915, Delta: 916, Epsilon: 917, Zeta: 918, Eta: 919, Theta: 920, Iota: 921, Kappa: 922, Lambda: 923, Mu: 924, Nu: 925, Xi: 926, Omicron: 927, Pi: 928, Rho: 929, Sigma: 931, Tau: 932, Upsilon: 933, Phi: 934, Chi: 935, Psi: 936, Omega: 937, alpha: 945, beta: 946, gamma: 947, delta: 948, epsilon: 949, epsiv: 949, varepsilon: 949, zeta: 950, eta: 951, theta: 952, iota: 953, kappa: 954, lambda: 955, mu: 956, nu: 957, xi: 958, omicron: 959, pi: 960, rho: 961, sigmaf: 962, sigmav: 962, varsigma: 962, sigma: 963, tau: 964, upsilon: 965, phi: 966, chi: 967, psi: 968, omega: 969, thetav: 977, vartheta: 977, thetasym: 977, Upsi: 978, upsih: 978, straightphi: 981, piv: 982, varpi: 982, Gammad: 988, gammad: 989, digamma: 989, kappav: 1008, varkappa: 1008, rhov: 1009, varrho: 1009, epsi: 1013, straightepsilon: 1013, bepsi: 1014, backepsilon: 1014, euro: 8364, trade: 8482, TRADE: 8482, forall: 8704, part: 8706, larr: 8592, rarr: 8593, hyphen: 8208, dash: 8208, ndash: 8211, mdash: 8212, horbar: 8213, Vert: 8214, Verbar: 8214, lsquo: 8216, OpenCurlyQuote: 8216, rsquo: 8217, rsquor: 8217, CloseCurlyQuote: 8217, lsquor: 8218, sbquo: 8218, ldquo: 8220, OpenCurlyDoubleQuote: 8220, rdquo: 8221, rdquor: 8221, CloseCurlyDoubleQuote: 8221, ldquor: 8222, bdquo: 8222, dagger: 8224, Dagger: 8225, ddagger: 8225, bull: 8226, bullet: 8226, nldr: 8229, hellip: 8230, mldr: 8230, hybull: 8259, tdot: 8411, TripleDot: 8411, DotDot: 8412, star: 9734, phone: 9742, spades: 9824, clubs: 9827, hearts: 9829, diams: 9830, female: 9792, male: 9794, check: 10003, checkmark: 10003, cross: 10007, VerticalSeparator: 10072, EmptySmallSquare: 9723, FilledSmallSquare: 9724, starf: 9733, bigstar: 9733, square: 9633, squ: 9633, Square: 9633 };
    var ampCodes = new Map();
    for (var key in objCodes) {
        if (objCodes.hasOwnProperty(key)) {
            ampCodes.set(key, objCodes[key]);
        }
    }
    return ampCodes;
}
if (global.__snapshot) {
    _ampCodes = _generateAmpMap();
}
function _HandleAmpEntities(found, decimalValue, hexValue, wordValue) {
    if (wordValue) {
        if (!_ampCodes) {
            _ampCodes = _generateAmpMap();
        }
        var res = _ampCodes.get(wordValue);
        if (res) {
            return String.fromCharCode(res);
        }
        return found;
    }
    if (decimalValue) {
        return String.fromCharCode(parseInt(decimalValue, 10));
    }
    return String.fromCharCode(parseInt(hexValue, 16));
}
var XmlParser = (function () {
    function XmlParser(onEvent, onError, processNamespaces) {
        this._processNamespaces = processNamespaces;
        this._parser = new easysax.EasySAXParser();
        var that = this;
        this._parser.on("startNode", function (elem, attr, uq, tagend, str, pos) {
            var attributes = attr();
            if (attributes === true) {
                attributes = undefined;
            }
            if (attributes) {
                for (var key in attributes) {
                    if (attributes.hasOwnProperty(key)) {
                        attributes[key] = XmlParser._dereferenceEntities(attributes[key]);
                    }
                }
            }
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var stackEntry = XmlParser._getNamespacesStackEntry(attributes);
                that._namespaceStack.push(stackEntry);
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.StartElement, pos(), prefix, namespace, name, attributes, undefined));
        });
        this._parser.on("textNode", function (text, uq, pos) {
            var data = uq(XmlParser._dereferenceEntities(text));
            onEvent(new ParserEvent(ParserEventType.Text, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("endNode", function (elem, uq, tagstart, str, pos) {
            var prefix = undefined;
            var namespace = undefined;
            var name = elem;
            if (that._processNamespaces) {
                var resolved = that._resolveNamespace(name);
                prefix = resolved.prefix;
                namespace = resolved.namespace;
                name = resolved.name;
            }
            onEvent(new ParserEvent(ParserEventType.EndElement, pos(), prefix, namespace, name, undefined, undefined));
            if (that._processNamespaces) {
                that._namespaceStack.pop();
            }
        });
        this._parser.on("cdata", function (data, res, pos) {
            onEvent(new ParserEvent(ParserEventType.CDATA, pos(), undefined, undefined, undefined, undefined, data));
        });
        this._parser.on("comment", function (text, uq, pos) {
            onEvent(new ParserEvent(ParserEventType.Comment, pos(), undefined, undefined, undefined, undefined, text));
        });
        if (onError) {
            this._parser.on("error", function (msg, pos) {
                onError(new Error(msg), pos());
            });
        }
    }
    Object.defineProperty(XmlParser.prototype, "angularSyntax", {
        get: function () {
            return this._parser.angularSyntax;
        },
        set: function (value) {
            this._parser.angularSyntax = value;
        },
        enumerable: true,
        configurable: true
    });
    XmlParser.prototype.parse = function (xmlString) {
        if (this._processNamespaces) {
            this._namespaceStack = [];
        }
        this._parser.parse(xmlString);
    };
    XmlParser._getNamespacesStackEntry = function (attributes) {
        var stackEntry = {};
        if (!attributes) {
            return stackEntry;
        }
        var attributeName;
        var namespacePrefix;
        for (var key in attributes) {
            if (!attributes.hasOwnProperty(key)) {
                continue;
            }
            attributeName = key;
            if (attributeName.indexOf("xmlns") !== 0) {
                continue;
            }
            namespacePrefix = "";
            if (attributeName.indexOf(":") !== -1) {
                namespacePrefix = attributeName.split(":")[1];
            }
            stackEntry[namespacePrefix] = attributes[key];
        }
        return stackEntry;
    };
    XmlParser.prototype._resolveNamespace = function (fullName) {
        var result = { prefix: undefined, namespace: undefined, name: undefined };
        result.prefix = "";
        if (fullName.indexOf(":") !== -1) {
            var split = fullName.split(":");
            result.prefix = split[0];
            result.name = split[1];
        }
        else {
            result.name = fullName;
        }
        var stackEntry;
        for (var i = this._namespaceStack.length - 1; i >= 0; i--) {
            stackEntry = this._namespaceStack[i];
            for (var key in stackEntry) {
                if (!stackEntry.hasOwnProperty(key)) {
                    continue;
                }
                if (result.prefix === key) {
                    result.namespace = stackEntry[key];
                    return result;
                }
            }
        }
        return result;
    };
    XmlParser._dereferenceEntities = function (s) {
        s = String(s);
        if (s.length > 3 && s.indexOf("&") !== -1) {
            s = s.replace(_entitySearchRegEx, _HandleAmpEntities);
        }
        return s;
    };
    return XmlParser;
}());
exports.XmlParser = XmlParser;
//# sourceMappingURL=xml.js.map
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__("../node_modules/webpack/buildin/global.js")))

/***/ }),

/***/ "../node_modules/tslib/tslib.es6.js":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__extends", function() { return __extends; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__assign", function() { return __assign; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__rest", function() { return __rest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__decorate", function() { return __decorate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__param", function() { return __param; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__metadata", function() { return __metadata; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__awaiter", function() { return __awaiter; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__generator", function() { return __generator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__exportStar", function() { return __exportStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__values", function() { return __values; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__read", function() { return __read; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spread", function() { return __spread; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__spreadArrays", function() { return __spreadArrays; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__await", function() { return __await; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncGenerator", function() { return __asyncGenerator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncDelegator", function() { return __asyncDelegator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__asyncValues", function() { return __asyncValues; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__makeTemplateObject", function() { return __makeTemplateObject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importStar", function() { return __importStar; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "__importDefault", function() { return __importDefault; });
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __spreadArrays() {
    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
    for (var r = Array(s), k = 0, i = 0; i < il; i++)
        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
            r[k] = a[j];
    return r;
};

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}


/***/ }),

/***/ "../node_modules/webpack/buildin/global.js":
/***/ (function(module, exports) {

var g;

// This works in non-strict mode
g = (function() {
	return this;
})();

try {
	// This works if eval is allowed (see CSP)
	g = g || new Function("return this")();
} catch (e) {
	// This works if the window reference is available
	if (typeof window === "object") g = window;
}

// g can still be undefined, but nothing to do about it...
// We return undefined, instead of nothing here, so it's
// easier to handle this case. if(!global) { ...}

module.exports = g;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC10aGVtZS1jb3JlL2Nzcy9jb3JlLmxpZ2h0LmNzcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9obXIvaG1yLXVwZGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL25hdGl2ZXNjcmlwdC1kZXYtd2VicGFjay9obXIvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9uYXRpdmVzY3JpcHQtZGV2LXdlYnBhY2svaG90LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvbmF0aXZlc2NyaXB0LWRldi13ZWJwYWNrL2xvYWQtYXBwbGljYXRpb24tY3NzLWFuZ3VsYXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy9uYXRpdmVzY3JpcHQtZGV2LXdlYnBhY2svbG9hZC1hcHBsaWNhdGlvbi1jc3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2FwcGxpY2F0aW9uL2FwcGxpY2F0aW9uLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvYXBwbGljYXRpb24vYXBwbGljYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2NvbG9yL2NvbG9yLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29sb3IvY29sb3IuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2NvbG9yL2tub3duLWNvbG9ycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY29uc29sZS9jb25zb2xlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9jc3MtdmFsdWUvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2Nzcy9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzL2xpYi9wYXJzZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvY3NzL3BhcnNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGF0YS9vYnNlcnZhYmxlLWFycmF5L29ic2VydmFibGUtYXJyYXkuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2RhdGEvb2JzZXJ2YWJsZS9vYnNlcnZhYmxlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9kZWJ1Z2dlci9kZWJ1Z2dlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvZGVidWdnZXIvZG9tLW5vZGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ZldGNoL2ZldGNoLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9maWxlLXN5c3RlbS9maWxlLXN5c3RlbS1hY2Nlc3MuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ZpbGUtc3lzdGVtL2ZpbGUtc3lzdGVtLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9nbG9iYWxzL2dsb2JhbHMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvcmVnaXN0ZXItbW9kdWxlLWhlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2dsb2JhbHMvdHMtaGVscGVycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaHR0cC9odHRwLXJlcXVlc3QvaHR0cC1yZXF1ZXN0LWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvaHR0cC9odHRwLXJlcXVlc3QvaHR0cC1yZXF1ZXN0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9odHRwL2h0dHAuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2ltYWdlLXNvdXJjZS9pbWFnZS1zb3VyY2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL2pzLWxpYnMvZWFzeXNheC9lYXN5c2F4LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL2VzcHJpbWEvZXNwcmltYS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvanMtbGlicy9wb2x5bWVyLWV4cHJlc3Npb25zL3BhdGgtcGFyc2VyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9qcy1saWJzL3BvbHltZXItZXhwcmVzc2lvbnMvcG9seW1lci1leHByZXNzaW9ucy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbWF0cml4L21hdHJpeC5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvbW9kdWxlLW5hbWUtcmVzb2x2ZXIvbW9kdWxlLW5hbWUtcmVzb2x2ZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL21vZHVsZS1uYW1lLXJlc29sdmVyL25vbi1idW5kbGUtd29ya2Zsb3ctY29tcGF0LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy9tb2R1bGUtbmFtZS1yZXNvbHZlci9xdWFsaWZpZXItbWF0Y2hlci9xdWFsaWZpZXItbWF0Y2hlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvcGxhdGZvcm0vcGxhdGZvcm0uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3Byb2ZpbGluZy9wcm9maWxpbmcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RleHQvZm9ybWF0dGVkLXN0cmluZy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdGV4dC9zcGFuLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90ZXh0L3RleHQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3RpbWVyL3RpbWVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy90cmFjZS90cmFjZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYW5pbWF0aW9uL2FuaW1hdGlvbi1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2FuaW1hdGlvbi9rZXlmcmFtZS1hbmltYXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1aWxkZXIvYmluZGluZy1idWlsZGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idWlsZGVyL2J1aWxkZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1aWxkZXIvY29tcG9uZW50LWJ1aWxkZXIvY29tcG9uZW50LWJ1aWxkZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2J1aWxkZXIvbW9kdWxlLW5hbWUtc2FuaXRpemVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9idXR0b24vYnV0dG9uLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvYnV0dG9uL2J1dHRvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS9iaW5kYWJsZS9iaW5kYWJsZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS9jb250cm9sLXN0YXRlLWNoYW5nZS9jb250cm9sLXN0YXRlLWNoYW5nZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS9wcm9wZXJ0aWVzL3Byb3BlcnRpZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2NvcmUvdmlldy1iYXNlL3ZpZXctYmFzZS5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS92aWV3L3ZpZXctY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9jb3JlL3ZpZXcvdmlldy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvY29yZS93ZWFrLWV2ZW50LWxpc3RlbmVyL3dlYWstZXZlbnQtbGlzdGVuZXIuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2RpYWxvZ3MvZGlhbG9ncy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2RpYWxvZ3MvZGlhbG9ncy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZWRpdGFibGUtdGV4dC1iYXNlL2VkaXRhYmxlLXRleHQtYmFzZS1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2VkaXRhYmxlLXRleHQtYmFzZS9lZGl0YWJsZS10ZXh0LWJhc2UuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2VudW1zL2VudW1zLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9mcmFtZS9mcmFnbWVudC50cmFuc2l0aW9ucy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhbWUtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9mcmFtZS9mcmFtZS1zdGFjay5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZnJhbWUvZnJhbWUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2dlc3R1cmVzL2dlc3R1cmVzLWNvbW1vbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvZ2VzdHVyZXMvZ2VzdHVyZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL2xhYmVsL2xhYmVsLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2JhY2tncm91bmQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2JhY2tncm91bmQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvY29udmVydGVycy5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9jc3MtYW5pbWF0aW9uLXBhcnNlci5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdWkvc3R5bGluZy9jc3Mtc2VsZWN0b3IvY3NzLXNlbGVjdG9yLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2ZvbnQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL2ZvbnQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvbGluZWFyLWdyYWRpZW50LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvc3R5bGUtc2NvcGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3N0eWxpbmcvc3R5bGUvc3R5bGUuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RleHQtYmFzZS90ZXh0LWJhc2UtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWJhc2UvdGV4dC1iYXNlLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWZpZWxkL3RleHQtZmllbGQtY29tbW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90ZXh0LWZpZWxkL3RleHQtZmllbGQuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RyYW5zaXRpb24vZmFkZS10cmFuc2l0aW9uLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91aS90cmFuc2l0aW9uL3NsaWRlLXRyYW5zaXRpb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3VpL3RyYW5zaXRpb24vdHJhbnNpdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi4vbm9kZV9tb2R1bGVzL3Rucy1jb3JlLW1vZHVsZXMvdXRpbHMvZGVidWcuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL21haW50aHJlYWQtaGVscGVyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy9udW1iZXItdXRpbHMuanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL3R5cGVzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy91dGlscy91dGlscy1jb21tb24uanMiLCJ3ZWJwYWNrOi8vLy4uL25vZGVfbW9kdWxlcy90bnMtY29yZS1tb2R1bGVzL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy94aHIveGhyLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdG5zLWNvcmUtbW9kdWxlcy94bWwveG1sLmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwid2VicGFjazovLy8uLi9ub2RlX21vZHVsZXMvd2VicGFjay9idWlsZGluL2dsb2JhbC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLDJCQUEyQixtQkFBTyxDQUFDLGdEQUFzQztBQUN6RTtBQUNBLGNBQWMsUUFBUyxvUEFBb1AsV0FBVyxZQUFZLHNCQUFzQixTQUFTLFdBQVcsWUFBWSxzQkFBc0IsUUFBUSxjQUFjLFdBQVcseUJBQXlCLFFBQVEsY0FBYyxXQUFXLHlCQUF5QixZQUFZLGNBQWMsZUFBZSx5QkFBeUIsU0FBUyxjQUFjLFlBQVkseUJBQXlCLFVBQVUsY0FBYyxhQUFhLHlCQUF5QixRQUFRLGNBQWMsV0FBVyx5QkFBeUIsY0FBYyxjQUFjLGlCQUFpQix5QkFBeUIsYUFBYSxjQUFjLGdCQUFnQix5QkFBeUIsVUFBVSxjQUFjLGFBQWEseUJBQXlCLFNBQVMsY0FBYyxZQUFZLHlCQUF5QixRQUFRLGNBQWMsV0FBVyx5QkFBeUIsVUFBVSxjQUFjLGFBQWEseUJBQXlCLFFBQVEsY0FBYyxXQUFXLHlCQUF5QixPQUFPLGNBQWMsVUFBVSx5QkFBeUIsUUFBUSxXQUFXLE9BQU8sVUFBVSxRQUFRLFlBQVksT0FBTyxXQUFXLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLEtBQUssU0FBUyxPQUFPLGFBQWEsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLE9BQU8sY0FBYyxPQUFPLGVBQWUsY0FBYyxPQUFPLGFBQWEsZ0JBQWdCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLE1BQU0sVUFBVSxRQUFRLGNBQWMsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsUUFBUSxlQUFlLFFBQVEsZ0JBQWdCLGVBQWUsUUFBUSxjQUFjLGlCQUFpQixNQUFNLFVBQVUsUUFBUSxjQUFjLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLFFBQVEsZUFBZSxRQUFRLGdCQUFnQixlQUFlLFFBQVEsY0FBYyxpQkFBaUIsTUFBTSxVQUFVLFFBQVEsY0FBYyxRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixRQUFRLGVBQWUsUUFBUSxnQkFBZ0IsZUFBZSxRQUFRLGNBQWMsaUJBQWlCLEtBQUssVUFBVSxPQUFPLGNBQWMsT0FBTyxnQkFBZ0IsT0FBTyxpQkFBaUIsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLGVBQWUsT0FBTyxjQUFjLGlCQUFpQixLQUFLLFVBQVUsT0FBTyxjQUFjLE9BQU8sZ0JBQWdCLE9BQU8saUJBQWlCLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixlQUFlLE9BQU8sY0FBYyxpQkFBaUIsS0FBSyxVQUFVLE9BQU8sY0FBYyxPQUFPLGdCQUFnQixPQUFPLGlCQUFpQixPQUFPLGVBQWUsT0FBTyxnQkFBZ0IsZUFBZSxPQUFPLGNBQWMsaUJBQWlCLEtBQUssVUFBVSxPQUFPLGNBQWMsT0FBTyxnQkFBZ0IsT0FBTyxpQkFBaUIsT0FBTyxlQUFlLE9BQU8sZ0JBQWdCLGVBQWUsT0FBTyxjQUFjLGlCQUFpQixLQUFLLFVBQVUsT0FBTyxjQUFjLE9BQU8sZ0JBQWdCLE9BQU8saUJBQWlCLE9BQU8sZUFBZSxPQUFPLGdCQUFnQixlQUFlLE9BQU8sY0FBYyxpQkFBaUIsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFRLGlCQUFpQixRQUFRLGtCQUFrQixRQUFRLGdCQUFnQixRQUFRLGlCQUFpQixnQkFBZ0IsUUFBUSxlQUFlLGtCQUFrQixNQUFNLFdBQVcsUUFBUSxlQUFlLFFBQVEsaUJBQWlCLFFBQVEsa0JBQWtCLFFBQVEsZ0JBQWdCLFFBQVEsaUJBQWlCLGdCQUFnQixRQUFRLGVBQWUsa0JBQWtCLE1BQU0sV0FBVyxRQUFRLGVBQWUsUUFBUSxpQkFBaUIsUUFBUSxrQkFBa0IsUUFBUSxnQkFBZ0IsUUFBUSxpQkFBaUIsZ0JBQWdCLFFBQVEsZUFBZSxrQkFBa0IsTUFBTSxXQUFXLFFBQVEsZUFBZSxRQUFR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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsd0ZBQXdGO0FBQzdIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHdFQUF3RTtBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsbUdBQW1HO0FBQ3hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFDQUFxQyxnR0FBZ0c7QUFDckk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHFHQUFxRztBQUMxSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBLHdDQUF3QztBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxxQzs7Ozs7OztBQ3BCQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0M7Ozs7Ozs7QUNsS0EsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxtQzs7Ozs7Ozs7QUN4QkE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7Ozs7QUNoSEEsZ0JBQWdCLG1CQUFPLENBQUMseURBQWE7Ozs7Ozs7O0FDQXJDO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxvQkFBb0I7QUFDcEI7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0JBQW9CO0FBQ3BCOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNENBQTRDO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQSxzRUFBc0U7O0FBRXRFO0FBQ0E7QUFD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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0I7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQSxzQ0FBc0M7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsK0VBQStFO0FBQy9FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLEtBQUs7QUFDbkI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyw4QkFBOEIsRUFBRTtBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsMkNBQTJDLEVBQUU7QUFDcEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixvQ0FBb0M7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBLHVDQUF1Qyx3REFBd0Q7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHdEQUF3RDtBQUN2RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0Esa0M7Ozs7Ozs7QUM1dkNBLDhDQUE4QyxjQUFjO0FBQzVELGlCQUFpQixtQkFBTyxDQUFDLGdFQUFlO0FBQ3hDLFlBQVksbUJBQU8sQ0FBQyxpREFBbUI7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsT0FBTztBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELE9BQU87QUFDMUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixRQUFRO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw0Qzs7Ozs7OztBQ2hNQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbURBQW1EO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxPQUFPO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsT0FBTztBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsUUFBUTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsT0FBTztBQUNqRDtBQUNBLHlCQUF5QixtQ0FBbUM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixpQkFBaUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsK0JBQStCLG1CQUFtQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0M7Ozs7Ozs7QUM1TkEsNEZBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxtRUFBbUU7QUFDcEUsb0M7Ozs7Ozs7O0FDM0hBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isc0NBQXNDO0FBQzlEO0FBQ0Esa0RBQWtELFFBQVEsbUJBQU8sQ0FBQyxpRUFBZ0MsZ0NBQWdDLEVBQUU7QUFDcEksNkNBQTZDLFFBQVEsbUJBQU8sQ0FBQyxtRUFBdUIsbUJBQW1CLEVBQUU7QUFDekcsaURBQWlELFFBQVEsbUJBQU8sQ0FBQyxtRUFBdUIsdUJBQXVCLEVBQUU7QUFDakg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MscURBQXFELEVBQUU7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLDJCQUEyQixFQUFFO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0QscUJBQXFCLEVBQUU7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLG9DOzs7Ozs7O0FDN0xBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLGtCQUFrQixtQkFBTyxDQUFDLDZDQUFLO0FBQy9CO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYixTQUFTO0FBQ1Q7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYixTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsYUFBYTs7QUFFYjtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBLENBQUMsSTs7Ozs7Ozs7QUMvVUQsOENBQThDLGNBQWM7QUFDNUQsYUFBYSxtQkFBTyxDQUFDLCtDQUFTO0FBQzlCLGNBQWMsbUJBQU8sQ0FBQyxpREFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIscUJBQXFCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSxrRDs7Ozs7OztBQzVVQSw4Q0FBOEMsY0FBYztBQUM1RCwyQkFBMkIsbUJBQU8sQ0FBQyxvRUFBc0I7QUFDekQsa0JBQWtCLG1CQUFPLENBQUMseURBQWM7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsbUJBQU8sQ0FBQyx1REFBVTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIseUNBQXlDO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsc0JBQXNCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSyxrREFBa0Q7QUFDdkQsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix1QkFBdUI7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLDJDQUEyQztBQUM1Qyx1Qzs7Ozs7OztBQy9sQkEsNEZBQThDLGNBQWM7QUFDNUQsbUJBQU8s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O0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUM7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsZUFBZTtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Qzs7Ozs7OztBQzVRQTtBQUNBO0FBQ0E7O0FBRUEsb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7O0FBR0g7QUFDQTtBQUNBLEdBQUc7O0FBRUg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSjtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBO0FBQ0E7QUFDQSxHQUFHOztBQUVIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRzs7QUFFSDtBQUNBLEdBQUc7OztBQUdIO0FBQ0E7QUFDQSxHQUFHOztBQUVILHVDQUF1QyxFQUFFO0FBQ3pDLHdDQUF3QyxFQUFFOztBQUUxQztBQUNBLGlCQUFpQixJQUFJO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTs7QUFFQTs7O0FBR0EsSUFBSSxJQUEyQjtBQUMvQjtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCO0FBQ2xCO0FBQ0E7OztBQUdBLHVCQUF1QjtBQUN2Qix3QkFBd0I7QUFDeEIsZUFBZTtBQUNmOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esb0RBQW9EO0FBQ3BELDREQUE0RDtBQUM1RCx3REFBd0Q7QUFDeEQsMERBQTBEO0FBQzFELG9EQUFvRDs7QUFFcEQsNENBQTRDLDBCQUEwQjtBQUN0RSw4Q0FBOEMsMkJBQTJCLE9BQU87QUFDaEYsZ0RBQWdELDRCQUE0QixPQUFPO0FBQ25GO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCOztBQUVqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EseUJBQXlCOztBQUV6Qjs7QUFFQTs7QUFFQSxLQUFLO0FBQ0w7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBLGVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw4QkFBOEI7QUFDekQsMkJBQTJCLDhCQUE4QjtBQUN6RCw2QkFBNkIsZ0NBQWdDOztBQUU3RDtBQUNBLG1DQUFtQywwQkFBMEIsUUFBUTtBQUNyRTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSxTQUFTLE9BQU87QUFDaEI7O0FBRUEseUNBQXlDO0FBQ3pDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLDBGQUEwRjtBQUMxRix5Q0FBeUM7QUFDekM7O0FBRUEsc0JBQXNCLE9BQU8sT0FBTztBQUNwQzs7QUFFQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUEsaURBQWlEO0FBQ2pEO0FBQ0E7QUFDQSxhQUFhLHFCQUFxQjtBQUNsQztBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxpREFBaUQ7QUFDakQ7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx5Q0FBeUM7QUFDekM7O0FBRUE7O0FBRUE7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ0EsMkJBQTJCO0FBQzNCOztBQUVBLGFBQWE7QUFDYjtBQUNBOztBQUVBLGlCQUFpQixPQUFPO0FBQ3hCLGlEQUFpRDtBQUNqRDtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlDQUF5QztBQUN6Qzs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQSxvQkFBb0I7QUFDcEIsY0FBYzs7QUFFZCwrQkFBK0I7QUFDL0I7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSx3Q0FBd0M7QUFDeEM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQSxvQ0FBb0M7QUFDcEM7OztBQUdBO0FBQ0E7O0FBRUEseUNBQXlDLE9BQU87QUFDaEQ7O0FBRUE7QUFDQSx3QkFBd0I7QUFDeEIsZ0RBQWdEO0FBQ2hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUEsdUNBQXVDO0FBQ3ZDO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUEsdUJBQXVCOztBQUV2QjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBLHVCQUF1QjtBQUN2QjtBQUNBLDhEQUE4RDtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBLHlEQUF5RDtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLFNBQVM7QUFDVCwyQkFBMkI7QUFDM0I7QUFDQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0Esc0JBQXNCLE1BQU07QUFDNUI7QUFDQTs7QUFFQSwrQkFBK0I7QUFDL0I7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDLDBCQUEwQjtBQUMxQjtBQUNBLGFBQWE7QUFDYixtQ0FBbUMsZ0JBQWdCO0FBQ25EO0FBQ0E7O0FBRUEsc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTs7QUFFQSw2QkFBNkI7O0FBRTdCLDJDQUEyQztBQUMzQyx1QkFBdUI7QUFDdkI7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGlCQUFpQixPQUFPO0FBQ3hCOztBQUVBLGlEQUFpRDtBQUNqRDtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxTQUFTO0FBQ1QsOENBQThDO0FBQzlDOztBQUVBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLG9DQUFvQyxPQUFPO0FBQzNDOztBQUVBO0FBQ0E7QUFDQTs7QUFFQSxnREFBZ0Q7QUFDaEQ7QUFDQSx5Q0FBeUM7QUFDekM7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsaUJBQWlCO0FBQ2pCO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxhQUFhO0FBQ2I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCLGtDQUFrQztBQUNsQztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLDhDQUE4Qzs7QUFFOUMsdUJBQXVCO0FBQ3ZCO0FBQ0E7O0FBRUE7QUFDQSxvREFBb0QseUJBQXlCO0FBQzdFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7Ozs7Ozs7O0FDN3dCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHNDQUFzQztBQUN0Qzs7O0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0Esb0NBQW9DO0FBQ3BDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DO0FBQ25DOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNUO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQSwyQkFBMkI7QUFDM0IsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFF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QTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUyxrQkFBa0I7QUFDM0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULHlCQUF5QjtBQUN6QixTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7OztBQUdBOztBQUVBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGtCOzs7Ozs7OztBQ2poQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFYTs7QUFFYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsOENBQThDO0FBQzlDO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBLHFDQUFxQztBQUNyQyxrQkFBa0IsWUFBWSxFQUFFO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLOztBQUVMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSzs7QUFFTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7O0FBRUw7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxpQkFBaUI7O0FBRWpCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxTQUFTOztBQUVUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFF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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdEQUF3RCxzQkFBc0IsRUFBRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQSxzRDs7Ozs7Ozs7QUNwRkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLGdDQUFnQztBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQix1QkFBdUI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkM7Ozs7Ozs7QUMxSEEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLHNFQUFzRTtBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHNEQUFzRCxjQUFjO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBCQUEwQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsOEJBQThCO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxv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QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCxjQUFjO0FBQzdFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsNEM7Ozs7Ozs7QUNwT0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQseUJBQXlCLG1CQUFPLENBQUMsbUVBQW9CO0FBQ3JELHlCQUF5QixtQkFBTyxDQUFDLGlFQUE2QjtBQUM5RCxpQkFBaUIsbUJBQU8sQ0FBQyx1REFBZ0I7QUFDekMsU0FBUyxtQkFBTyxDQUFDLG1FQUFvQjtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxZQUFZO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEM7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSw4Qzs7Ozs7OztBQy9QQSw4Q0FBOEMsY0FBYztBQUM1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLCtFQUErRTtBQUNoRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLG1CQUFtQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQiwwQkFBMEI7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsa0JBQWtCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQzs7Ozs7OztBQ25MQSw0RkFBOEMsY0FBYztBQUM1RCxjQUFjLG1CQUFPLENBQUMsaURBQW1CO0FBQ3pDLFVBQVUsbUJBQU8sQ0FBQyw2Q0FBVztBQUM3QixjQUFjLG1CQUFPLENBQUMsaURBQW1CO0FBQ3pDLDBCQUEwQixtQkFBTyxDQUFDLG9GQUFxQjtBQUN2RCxpQkFBaUIsbUJBQU8sQ0FBQyx1REFBZ0I7QUFDekMsa0JBQWtCLG1CQUFPLENBQUMseURBQWlCO0FBQzNDLDhCQUE4QixtQkFBTyxDQUFDLHNFQUF5QjtBQUMvRCw2QkFBNkIsbUJBQU8sQ0FBQywrRUFBNEI7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHdCQUF3QjtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRDtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBLENBQUM7QUFDRCxzQzs7Ozs7OztBQy9OQSw0RkFBOEMsY0FBYztBQUM1RCxtQkFBbUIsbUJBQU8sQ0FBQyxtRUFBZTtBQUMxQyxtQkFBbUIsbUJBQU8sQ0FBQyxnRUFBMEI7QUFDckQ7QUFDQTtBQUNBLDRCQUE0QixtQkFBTyxDQUFDLHFGQUF3QjtBQUM1RCx3QkFBd0IsbUJBQU8sQ0FBQyxnRUFBK0I7QUFDL0QsY0FBYyxtQkFBTyxDQUFDLGlEQUFzQjtBQUM1QyxjQUFjLG1CQUFPLENBQUMsaURBQWdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtQkFBTyxDQUFDLGlEQUFzQjtBQUMxQyx3QkFBd0IsbUJBQU8sQ0FBQyxvRUFBeUM7QUFDekUseUJBQXlCLG1CQUFPLENBQUMscUZBQXNDO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxrQkFBa0I7QUFDbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZELHNCQUFzQjtBQUNuRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLDhDQUE4QztBQUMzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0RBQStELGNBQWM7QUFDN0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwr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QTtBQUNBO0FBQ0EsaUVBQWlFLGdDQUFnQyxFQUFFO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msb0dBQW9HO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsbUdBQW1HO0FBQ3BJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QztBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxtR0FBbUc7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaURBQWlELDRCQUE0QixFQUFFLGdCQUFnQixxQkFBcUIsRUFBRTtBQUN0SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLG1HQUFtRztBQUN4STtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLG1HQUFtRztBQUNwSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsZ0JBQWdCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsZ0JBQWdCO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkVBQTJFLHlCQUF5QixFQUFFO0FBQ3RHO0FBQ0E7QUFDQTtBQUNBLDZFQUE2RSwyQkFBMkIsRUFBRTtBQUMxRztBQUNBO0FBQ0EscUJBQXFCLDZDQUE2QztBQUNsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBDQUEwQztBQUNyRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixzQkFBc0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsK0JBQStCO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0U7QUFDcEU7QUFDQTtBQUNBO0FB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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9EQUFvRCxrREFBa0Q7QUFDdEc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQ0FBbUMsbUJBQW1CO0FBQ3REO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLG1CQUFtQjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLDRCQUE0QjtBQUM3RixvQkFBb0I7QUFDcEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsdUJBQXVCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsc0JBQXNCO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpQkFBaUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbU9BQW1PO0FBQ25PO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0I7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxxREFBcUQ7QUFDbkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFLHdDQUF3QyxFQUFFO0FBQzFHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQjtBQUNoQjtBQUNBO0FBQ0E7QUFDQSw0QkFBNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCO0FBQ2hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxRUFBcUUsOEVBQThFO0FBQ25KO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNFQUFzRSw4QkFBOEIsRUFBRTtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUFzRCw4QkFBOEIsRUFBRTtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsMENBQTBDLEVBQUU7QUFDdkc7QUFDQSxrRkFBa0YsZ0RBQWdELEVBQUU7QUFDcEk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtGQUErRjtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdHQUFnRztBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLGlFQUFpRSwwQkFBMEI7QUFDM0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVEQUF1RCw0QkFBNEI7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELGdDQUFnQztBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsMkRBQTJELG9DQUFvQyxFQUFFO0FBQ2pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHVCQUF1QjtBQUMvQztBQUNBLENBQUM7QUFDRDtBQUNBLDJEQUEyRCxpRkFBaUY7QUFDNUk7QUFDQSx3Qzs7Ozs7OztBQzNrQkEsOENBQThDLGNBQWM7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDOzs7Ozs7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELGtCQUFrQixtQkFBTyxDQUFDLHlEQUFpQjtBQUMzQyxxQkFBcUIsbUJBQU8sQ0FBQywyREFBZ0I7QUFDN0MsNkJBQTZCLG1CQUFPLENBQUMsbUVBQXdCO0FBQzdELFlBQVksbUJBQU8sQ0FBQyxpREFBbUI7QUFDdkMsU0FBUyxtQkFBTyxDQUFDLDJEQUFnQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEM7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdIQUF3SDtBQUN4SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDBCQUEwQjtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBIQUEwSDtBQUMxSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpS0FBaUs7QUFDaks7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9IQUFvSDtBQUNwSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpSEFBaUg7QUFDakg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnREFBZ0QsZ0NBQWdDO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsNERBQTREO0FBQzNGLDZCQUE2QjtBQUM3QjtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUlBQXVJO0FBQ3ZJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0lBQXdJO0FBQ3hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEdBQThHO0FBQzlHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0lBQXdJO0FBQ3hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0QscUM7Ozs7Ozs7QUN4aUJBLDhDQUE4QyxjQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxrRkFBa0Y7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyx5RUFBeUU7QUFDMUU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxnRUFBZ0U7QUFDakU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpQkFBaUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBLDJDOzs7Ozs7O0FDM0lBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELHdCQUF3QixtQkFBTyxDQUFDLGlFQUFtQjtBQUNuRCxTQUFTLG1CQUFPLENBQUMsaUVBQW1CO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLGlCQUFpQixFQUFFO0FBQ25ELGdDQUFnQyxpQkFBaUIsRUFBRTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRUFBZ0UsaUJBQWlCO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELHdDOzs7Ozs7O0FDL2FBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxjQUFjO0FBQzVELG1CQUFtQixtQkFBTyxDQUFDLDJEQUF1QjtBQUNsRCxrQkFBa0IsbUJBQU8sQ0FBQyw0REFBYztBQUN4QyxtQkFBbUIsbUJBQU8sQ0FBQywyREFBdUI7QUFDbEQsU0FBUyxtQkFBTyxDQUFDLDREQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsOEJBQThCO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxxQzs7Ozs7OztBQ3ZNQSw4Q0FBOEMsY0FBYztBQUM1RCx3QkFBd0IsbUJBQU8sQ0FBQyxnRUFBbUI7QUFDbkQsY0FBYyxtQkFBTyxDQUFDLGlEQUFhO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4REFBOEQseUNBQXlDO0FBQ3ZHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWU7QUFDZixlQUFlO0FBQ2YsZUFBZTtBQUNmLGVBQWU7QUFDZixlQUFlO0FBQ2YsZUFBZTtBQUNmLGVBQWU7QUFDZixlQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDO0FBQ2hDLDhCQUE4QjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsZ0JBQWdCO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQzs7Ozs7OztBQzNyQkEsOENBQThDLGNBQWM7QUFDNUQsY0FBYyxtQkFBTyxDQUFDLG9EQUFVO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQywrRUFBK0U7QUFDaEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUssNEVBQTRFLGlDQUFpQztBQUNsSCxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvRUFBb0UsWUFBWSxFQUFFLGtDQUFrQyw0QkFBNEIsRUFBRTtBQUNsSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxRQUFRO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDBCQUEwQjtBQUNyRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsK0JBQStCLEVBQUU7QUFDL0Q7QUFDQSx3Q0FBd0MsbUZBQW1GLEVBQUU7QUFDN0g7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLG1CQUFtQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDOzs7Ozs7OztBQ2x0QkEsOENBQThDLGNBQWM7QUFDNUQsbUJBQW1CLG1CQUFPLENBQUMsZ0VBQTBCO0FBQ3JELGNBQWMsbUJBQU8sQ0FBQyxpREFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsaUM7Ozs7Ozs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsYUFBYSxtQkFBTyxDQUFDLHVEQUFjO0FBQ25DLHlCQUF5QixtQkFBTyxDQUFDLDJEQUE2QjtBQUM5RDtBQUNBO0FBQ0EsU0FBUyxtQkFBTyxDQUFDLHVEQUFjO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsZUFBZTtBQUM5QztBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QyxrRUFBa0U7QUFDOUc7QUFDQSxxREFBcUQsMkZBQTJGO0FBQ2hKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUVBQWlFLGdIQUFnSDtBQUNqTDtBQUNBO0FBQ0Esd0RBQXdELG9IQUFvSDtBQUM1SztBQUNBO0FBQ0EscURBQXFELHdJQUF3STtBQUM3TDtBQUNBO0FBQ0EseURBQXlELG9IQUFvSDtBQUM3SztBQUNBLHdEQUF3RCwrSEFBK0gsc0JBQXNCLEVBQUUsRUFBRTtBQUNqTjtBQUNBLHFEQUFxRCx3R0FBd0csc0JBQXNCLEVBQUUsRUFBRTtBQUN2TDtBQUNBO0FBQ0EsNEM7Ozs7Ozs7QUN6UEE7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsYUFBYSxtQkFBTyxDQUFDLHFEQUFpQjtBQUN0Qyx5QkFBeUIsbUJBQU8sQ0FBQyxtRUFBb0I7QUFDckQsY0FBYyxtQkFBTyxDQUFDLGlEQUFtQjtBQUN6QyxTQUFTLG1CQUFPLENBQUMsbUVBQW9CO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGVBQWU7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvSUFBb0ksdUNBQXVDO0FBQzNLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0RkFBNEYsdUNBQXVDO0FBQ25JO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEZBQTRGLHVDQUF1QztBQUNuSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkNBQTZDLHFDQUFxQztBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtRkFBbUYsY0FBYztBQUNqRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUM7Ozs7Ozs7QUNqU0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLGNBQWM7QUFDNUQsMkJBQTJCLG1CQUFPLENBQUMsOEVBQXVCO0FBQzFELFNBQVMsbUJBQU8sQ0FBQyw4RUFBdUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLDREQUE0RCw2RkFBNkY7QUFDeko7QUFDQSw2Qzs7Ozs7OztBQ3JCQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEMsY0FBYztBQUM1RCwwQkFBMEIsbUJBQU8sQ0FBQyxxRUFBcUI7QUFDdkQsa0JBQWtCLG1CQUFPLENBQUMseURBQWlCO0FBQzNDLFNBQVMsbUJBQU8sQ0FBQyxxRUFBcUI7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsaURBQWlEO0FBQzNFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsdURBQXVEO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxtRUFBbUU7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLHNDQUFzQyxFQUFFO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBLHdDOzs7Ozs7O0FDckxBO0FBQ0E7QUFDQTtBQUNBLDhD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QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1REFBdUQsNkJBQTZCLEVBQUU7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsdUJBQXVCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQSwrQjs7Ozs7OztBQ25VQSw0RkFBOEMsY0FBYztBQUM1RCxjQUFjLG1CQUFPLENBQUMsNkRBQW9CO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBLGtDQUFrQywwQkFBMEIsUUFBUTtBQUNwRTtBQUNBLG9CQUFvQjtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELFFBQVE7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsK0I7Ozs7Ozs7OztBQzdQQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FB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Q2xLLDRDQUE0QyxzQ0FBc0MsVUFBVSxvQkFBb0IsRUFBRSxFQUFFLFVBQVU7QUFDOUg7O0FBRU87QUFDUCxnQ0FBZ0MsdUNBQXVDLGFBQWEsRUFBRSxFQUFFLE9BQU8sa0JBQWtCO0FBQ2pIO0FBQ0E7O0FBRU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRU87QUFDUCw0Q0FBNEM7QUFDNUM7Ozs7Ozs7O0FDbk1BOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsNENBQTRDOztBQUU1QyIsImZpbGUiOiJ2ZW5kb3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnRzID0gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiLi4vLi4vY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpKGZhbHNlKTtcbi8vIE1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwiLyohXFxyXFxuICogTmF0aXZlU2NyaXB0IFRoZW1lIHYxLjAuNiAoaHR0cHM6Ly9uYXRpdmVzY3JpcHQub3JnKVxcclxcbiAqIENvcHlyaWdodCAyMDE2LTIwMTYgVGhlIFRoZW1lIEF1dGhvcnNcXHJcXG4gKiBDb3B5cmlnaHQgMjAxNi0yMDE2IFRlbGVyaWtcXHJcXG4gKiBMaWNlbnNlZCB1bmRlciBNSVQgKGh0dHBzOi8vZ2l0aHViLmNvbS9OYXRpdmVTY3JpcHQvdGhlbWUvYmxvYi9tYXN0ZXIvTElDRU5TRSlcXHJcXG4gKi8uYy13aGl0ZXtjb2xvcjojZmZmfS5jLWJnLXdoaXRle2JhY2tncm91bmQtY29sb3I6I2ZmZn0uYy1ibGFja3tjb2xvcjojMDAwfS5jLWJnLWJsYWNre2JhY2tncm91bmQtY29sb3I6IzAwMH0uYy1hcXVhe2NvbG9yOiMwMGNhYWJ9LmMtYmctYXF1YXtiYWNrZ3JvdW5kLWNvbG9yOiMwMGNhYWJ9LmMtYmx1ZXtjb2xvcjojM2Q1YWZlfS5jLWJnLWJsdWV7YmFja2dyb3VuZC1jb2xvcjojM2Q1YWZlfS5jLWNoYXJjb2Fse2NvbG9yOiMzMDMwMzB9LmMtYmctY2hhcmNvYWx7YmFja2dyb3VuZC1jb2xvcjojMzAzMDMwfS5jLWJyb3due2NvbG9yOiM3OTU1NDh9LmMtYmctYnJvd257YmFja2dyb3VuZC1jb2xvcjojNzk1NTQ4fS5jLWZvcmVzdHtjb2xvcjojMDA2OTY4fS5jLWJnLWZvcmVzdHtiYWNrZ3JvdW5kLWNvbG9yOiMwMDY5Njh9LmMtZ3JleXtjb2xvcjojZTBlMGUwfS5jLWJnLWdyZXl7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwfS5jLWdyZXktbGlnaHR7Y29sb3I6I2JhYmFiYX0uYy1iZy1ncmV5LWxpZ2h0e2JhY2tncm91bmQtY29sb3I6I2JhYmFiYX0uYy1ncmV5LWRhcmt7Y29sb3I6IzVjNjg3Y30uYy1iZy1ncmV5LWRhcmt7YmFja2dyb3VuZC1jb2xvcjojNWM2ODdjfS5jLXB1cnBsZXtjb2xvcjojODEzMGZmfS5jLWJnLXB1cnBsZXtiYWNrZ3JvdW5kLWNvbG9yOiM4MTMwZmZ9LmMtbGVtb257Y29sb3I6I2ZmZWEwMH0uYy1iZy1sZW1vbntiYWNrZ3JvdW5kLWNvbG9yOiNmZmVhMDB9LmMtbGltZXtjb2xvcjojYWVlNDA2fS5jLWJnLWxpbWV7YmFja2dyb3VuZC1jb2xvcjojYWVlNDA2fS5jLW9yYW5nZXtjb2xvcjojZjU3YzAwfS5jLWJnLW9yYW5nZXtiYWNrZ3JvdW5kLWNvbG9yOiNmNTdjMDB9LmMtcnVieXtjb2xvcjojZmYxNzQ0fS5jLWJnLXJ1Ynl7YmFja2dyb3VuZC1jb2xvcjojZmYxNzQ0fS5jLXNreXtjb2xvcjojMzBiY2ZmfS5jLWJnLXNreXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LnctZnVsbHt3aWR0aDoxMDAlfS53LTEwMHt3aWR0aDoxMDB9LmgtZnVsbHtoZWlnaHQ6MTAwJX0uaC0xMDB7aGVpZ2h0OjEwMH0ubS0we21hcmdpbjowfS5tLXQtMHttYXJnaW4tdG9wOjB9Lm0tci0we21hcmdpbi1yaWdodDowfS5tLWItMHttYXJnaW4tYm90dG9tOjB9Lm0tbC0we21hcmdpbi1sZWZ0OjB9Lm0teC0we21hcmdpbi1yaWdodDowO21hcmdpbi1sZWZ0OjB9Lm0teS0we21hcmdpbi10b3A6MDttYXJnaW4tYm90dG9tOjB9Lm0tMnttYXJnaW46Mn0ubS10LTJ7bWFyZ2luLXRvcDoyfS5tLXItMnttYXJnaW4tcmlnaHQ6Mn0ubS1iLTJ7bWFyZ2luLWJvdHRvbToyfS5tLWwtMnttYXJnaW4tbGVmdDoyfS5tLXgtMnttYXJnaW4tcmlnaHQ6MjttYXJnaW4tbGVmdDoyfS5tLXktMnttYXJnaW4tdG9wOjI7bWFyZ2luLWJvdHRvbToyfS5tLTR7bWFyZ2luOjR9Lm0tdC00e21hcmdpbi10b3A6NH0ubS1yLTR7bWFyZ2luLXJpZ2h0OjR9Lm0tYi00e21hcmdpbi1ib3R0b206NH0ubS1sLTR7bWFyZ2luLWxlZnQ6NH0ubS14LTR7bWFyZ2luLXJpZ2h0OjQ7bWFyZ2luLWxlZnQ6NH0ubS15LTR7bWFyZ2luLXRvcDo0O21hcmdpbi1ib3R0b206NH0ubS01e21hcmdpbjo1fS5tLXQtNXttYXJnaW4tdG9wOjV9Lm0tci01e21hcmdpbi1yaWdodDo1fS5tLWItNXttYXJnaW4tYm90dG9tOjV9Lm0tbC01e21hcmdpbi1sZWZ0OjV9Lm0teC01e21hcmdpbi1yaWdodDo1O21hcmdpbi1sZWZ0OjV9Lm0teS01e21hcmdpbi10b3A6NTttYXJnaW4tYm90dG9tOjV9Lm0tOHttYXJnaW46OH0ubS10LTh7bWFyZ2luLXRvcDo4fS5tLXItOHttYXJnaW4tcmlnaHQ6OH0ubS1iLTh7bWFyZ2luLWJvdHRvbTo4fS5tLWwtOHttYXJnaW4tbGVmdDo4fS5tLXgtOHttYXJnaW4tcmlnaHQ6ODttYXJnaW4tbGVmdDo4fS5tLXktOHttYXJnaW4tdG9wOjg7bWFyZ2luLWJvdHRvbTo4fS5tLTEwe21hcmdpbjoxMH0ubS10LTEwe21hcmdpbi10b3A6MTB9Lm0tci0xMHttYXJnaW4tcmlnaHQ6MTB9Lm0tYi0xMHttYXJnaW4tYm90dG9tOjEwfS5tLWwtMTB7bWFyZ2luLWxlZnQ6MTB9Lm0teC0xMHttYXJnaW4tcmlnaHQ6MTA7bWFyZ2luLWxlZnQ6MTB9Lm0teS0xMHttYXJnaW4tdG9wOjEwO21hcmdpbi1ib3R0b206MTB9Lm0tMTJ7bWFyZ2luOjEyfS5tLXQtMTJ7bWFyZ2luLXRvcDoxMn0ubS1yLTEye21hcmdpbi1yaWdodDoxMn0ubS1iLTEye21hcmdpbi1ib3R0b206MTJ9Lm0tbC0xMnttYXJnaW4tbGVmdDoxMn0ubS14LTEye21hcmdpbi1yaWdodDoxMjttYXJnaW4tbGVmdDoxMn0ubS15LTEye21hcmdpbi10b3A6MTI7bWFyZ2luLWJvdHRvbToxMn0ubS0xNXttYXJnaW46MTV9Lm0tdC0xNXttYXJnaW4tdG9wOjE1fS5tLXItMTV7bWFyZ2luLXJpZ2h0OjE1fS5tLWItMTV7bWFyZ2luLWJvdHRvbToxNX0ubS1sLTE1e21hcmdpbi1sZWZ0OjE1fS5tLXgtMTV7bWFyZ2luLXJpZ2h0OjE1O21hcmdpbi1sZWZ0OjE1fS5tLXktMTV7bWFyZ2luLXRvcDoxNTttYXJnaW4tYm90dG9tOjE1fS5tLTE2e21hcmdpbjoxNn0ubS10LTE2e21hcmdpbi10b3A6MTZ9Lm0tci0xNnttYXJnaW4tcmlnaHQ6MTZ9Lm0tYi0xNnttYXJnaW4tYm90dG9tOjE2fS5tLWwtMTZ7bWFyZ2luLWxlZnQ6MTZ9Lm0teC0xNnttYXJnaW4tcmlnaHQ6MTY7bWFyZ2luLWxlZnQ6MTZ9Lm0teS0xNnttYXJnaW4tdG9wOjE2O21hcmdpbi1ib3R0b206MTZ9Lm0tMjB7bWFyZ2luOjIwfS5tLXQtMjB7bWFyZ2luLXRvcDoyMH0ubS1yLTIwe21hcmdpbi1yaWdodDoyMH0ubS1iLTIwe21hcmdpbi1ib3R0b206MjB9Lm0tbC0yMHttYXJnaW4tbGVmdDoyMH0ubS14LTIwe21hcmdpbi1yaWdodDoyMDttYXJnaW4tbGVmdDoyMH0ubS15LTIwe21hcmdpbi10b3A6MjA7bWFyZ2luLWJvdHRvbToyMH0ubS0yNHttYXJnaW46MjR9Lm0tdC0yNHttYXJnaW4tdG9wOjI0fS5tLXItMjR7bWFyZ2luLXJpZ2h0OjI0fS5tLWItMjR7bWFyZ2luLWJvdHRvbToyNH0ubS1sLTI0e21hcmdpbi1sZWZ0OjI0fS5tLXgtMjR7bWFyZ2luLXJpZ2h0OjI0O21hcmdpbi1sZWZ0OjI0fS5tLXktMjR7bWFyZ2luLXRvcDoyNDttYXJnaW4tYm90dG9tOjI0fS5tLTI1e21hcmdpbjoyNX0ubS10LTI1e21hcmdpbi10b3A6MjV9Lm0tci0yNXttYXJnaW4tcmlnaHQ6MjV9Lm0tYi0yNXttYXJnaW4tYm90dG9tOjI1fS5tLWwtMjV7bWFyZ2luLWxlZnQ6MjV9Lm0teC0yNXttYXJnaW4tcmlnaHQ6MjU7bWFyZ2luLWxlZnQ6MjV9Lm0teS0yNXttYXJnaW4tdG9wOjI1O21hcmdpbi1ib3R0b206MjV9Lm0tMjh7bWFyZ2luOjI4fS5tLXQtMjh7bWFyZ2luLXRvcDoyOH0ubS1yLTI4e21hcmdpbi1yaWdodDoyOH0ubS1iLTI4e21hcmdpbi1ib3R0b206Mjh9Lm0tbC0yOHttYXJnaW4tbGVmdDoyOH0ubS14LTI4e21hcmdpbi1yaWdodDoyODttYXJnaW4tbGVmdDoyOH0ubS15LTI4e21hcmdpbi10b3A6Mjg7bWFyZ2luLWJvdHRvbToyOH0ubS0zMHttYXJnaW46MzB9Lm0tdC0zMHttYXJnaW4tdG9wOjMwfS5tLXItMzB7bWFyZ2luLXJpZ2h0OjMwfS5tLWItMzB7bWFyZ2luLWJvdHRvbTozMH0ubS1sLTMwe21hcmdpbi1sZWZ0OjMwfS5tLXgtMzB7bWFyZ2luLXJpZ2h0OjMwO21hcmdpbi1sZWZ0OjMwfS5tLXktMzB7bWFyZ2luLXRvcDozMDttYXJnaW4tYm90dG9tOjMwfS5wLTB7cGFkZGluZzowfS5wLXQtMHtwYWRkaW5nLXRvcDowfS5wLXItMHtwYWRkaW5nLXJpZ2h0OjB9LnAtYi0we3BhZGRpbmctYm90dG9tOjB9LnAtbC0we3BhZGRpbmctbGVmdDowfS5wLXgtMHtwYWRkaW5nLXJpZ2h0OjA7cGFkZGluZy1sZWZ0OjB9LnAteS0we3BhZGRpbmctdG9wOjA7cGFkZGluZy1ib3R0b206MH0ucC0ye3BhZGRpbmc6Mn0ucC10LTJ7cGFkZGluZy10b3A6Mn0ucC1yLTJ7cGFkZGluZy1yaWdodDoyfS5wLWItMntwYWRkaW5nLWJvdHRvbToyfS5wLWwtMntwYWRkaW5nLWxlZnQ6Mn0ucC14LTJ7cGFkZGluZy1yaWdodDoyO3BhZGRpbmctbGVmdDoyfS5wLXktMntwYWRkaW5nLXRvcDoyO3BhZGRpbmctYm90dG9tOjJ9LnAtNHtwYWRkaW5nOjR9LnAtdC00e3BhZGRpbmctdG9wOjR9LnAtci00e3BhZGRpbmctcmlnaHQ6NH0ucC1iLTR7cGFkZGluZy1ib3R0b206NH0ucC1sLTR7cGFkZGluZy1sZWZ0OjR9LnAteC00e3BhZGRpbmctcmlnaHQ6NDtwYWRkaW5nLWxlZnQ6NH0ucC15LTR7cGFkZGluZy10b3A6NDtwYWRkaW5nLWJvdHRvbTo0fS5wLTV7cGFkZGluZzo1fS5wLXQtNXtwYWRkaW5nLXRvcDo1fS5wLXItNXtwYWRkaW5nLXJpZ2h0OjV9LnAtYi01e3BhZGRpbmctYm90dG9tOjV9LnAtbC01e3BhZGRpbmctbGVmdDo1fS5wLXgtNXtwYWRkaW5nLXJpZ2h0OjU7cGFkZGluZy1sZWZ0OjV9LnAteS01e3BhZGRpbmctdG9wOjU7cGFkZGluZy1ib3R0b206NX0ucC04e3BhZGRpbmc6OH0ucC10LTh7cGFkZGluZy10b3A6OH0ucC1yLTh7cGFkZGluZy1yaWdodDo4fS5wLWItOHtwYWRkaW5nLWJvdHRvbTo4fS5wLWwtOHtwYWRkaW5nLWxlZnQ6OH0ucC14LTh7cGFkZGluZy1yaWdodDo4O3BhZGRpbmctbGVmdDo4fS5wLXktOHtwYWRkaW5nLXRvcDo4O3BhZGRpbmctYm90dG9tOjh9LnAtMTB7cGFkZGluZzoxMH0ucC10LTEwe3BhZGRpbmctdG9wOjEwfS5wLXItMTB7cGFkZGluZy1yaWdodDoxMH0ucC1iLTEwe3BhZGRpbmctYm90dG9tOjEwfS5wLWwtMTB7cGFkZGluZy1sZWZ0OjEwfS5wLXgtMTB7cGFkZGluZy1yaWdodDoxMDtwYWRkaW5nLWxlZnQ6MTB9LnAteS0xMHtwYWRkaW5nLXRvcDoxMDtwYWRkaW5nLWJvdHRvbToxMH0ucC0xMntwYWRkaW5nOjEyfS5wLXQtMTJ7cGFkZGluZy10b3A6MTJ9LnAtci0xMntwYWRkaW5nLXJpZ2h0OjEyfS5wLWItMTJ7cGFkZGluZy1ib3R0b206MTJ9LnAtbC0xMntwYWRkaW5nLWxlZnQ6MTJ9LnAteC0xMntwYWRkaW5nLXJpZ2h0OjEyO3BhZGRpbmctbGVmdDoxMn0ucC15LTEye3BhZGRpbmctdG9wOjEyO3BhZGRpbmctYm90dG9tOjEyfS5wLTE1e3BhZGRpbmc6MTV9LnAtdC0xNXtwYWRkaW5nLXRvcDoxNX0ucC1yLTE1e3BhZGRpbmctcmlnaHQ6MTV9LnAtYi0xNXtwYWRkaW5nLWJvdHRvbToxNX0ucC1sLTE1e3BhZGRpbmctbGVmdDoxNX0ucC14LTE1e3BhZGRpbmctcmlnaHQ6MTU7cGFkZGluZy1sZWZ0OjE1fS5wLXktMTV7cGFkZGluZy10b3A6MTU7cGFkZGluZy1ib3R0b206MTV9LnAtMTZ7cGFkZGluZzoxNn0ucC10LTE2e3BhZGRpbmctdG9wOjE2fS5wLXItMTZ7cGFkZGluZy1yaWdodDoxNn0ucC1iLTE2e3BhZGRpbmctYm90dG9tOjE2fS5wLWwtMTZ7cGFkZGluZy1sZWZ0OjE2fS5wLXgtMTZ7cGFkZGluZy1yaWdodDoxNjtwYWRkaW5nLWxlZnQ6MTZ9LnAteS0xNntwYWRkaW5nLXRvcDoxNjtwYWRkaW5nLWJvdHRvbToxNn0ucC0yMHtwYWRkaW5nOjIwfS5wLXQtMjB7cGFkZGluZy10b3A6MjB9LnAtci0yMHtwYWRkaW5nLXJpZ2h0OjIwfS5wLWItMjB7cGFkZGluZy1ib3R0b206MjB9LnAtbC0yMHtwYWRkaW5nLWxlZnQ6MjB9LnAteC0yMHtwYWRkaW5nLXJpZ2h0OjIwO3BhZGRpbmctbGVmdDoyMH0ucC15LTIwe3BhZGRpbmctdG9wOjIwO3BhZGRpbmctYm90dG9tOjIwfS5wLTI0e3BhZGRpbmc6MjR9LnAtdC0yNHtwYWRkaW5nLXRvcDoyNH0ucC1yLTI0e3BhZGRpbmctcmlnaHQ6MjR9LnAtYi0yNHtwYWRkaW5nLWJvdHRvbToyNH0ucC1sLTI0e3BhZGRpbmctbGVmdDoyNH0ucC14LTI0e3BhZGRpbmctcmlnaHQ6MjQ7cGFkZGluZy1sZWZ0OjI0fS5wLXktMjR7cGFkZGluZy10b3A6MjQ7cGFkZGluZy1ib3R0b206MjR9LnAtMjV7cGFkZGluZzoyNX0ucC10LTI1e3BhZGRpbmctdG9wOjI1fS5wLXItMjV7cGFkZGluZy1yaWdodDoyNX0ucC1iLTI1e3BhZGRpbmctYm90dG9tOjI1fS5wLWwtMjV7cGFkZGluZy1sZWZ0OjI1fS5wLXgtMjV7cGFkZGluZy1yaWdodDoyNTtwYWRkaW5nLWxlZnQ6MjV9LnAteS0yNXtwYWRkaW5nLXRvcDoyNTtwYWRkaW5nLWJvdHRvbToyNX0ucC0yOHtwYWRkaW5nOjI4fS5wLXQtMjh7cGFkZGluZy10b3A6Mjh9LnAtci0yOHtwYWRkaW5nLXJpZ2h0OjI4fS5wLWItMjh7cGFkZGluZy1ib3R0b206Mjh9LnAtbC0yOHtwYWRkaW5nLWxlZnQ6Mjh9LnAteC0yOHtwYWRkaW5nLXJpZ2h0OjI4O3BhZGRpbmctbGVmdDoyOH0ucC15LTI4e3BhZGRpbmctdG9wOjI4O3BhZGRpbmctYm90dG9tOjI4fS5wLTMwe3BhZGRpbmc6MzB9LnAtdC0zMHtwYWRkaW5nLXRvcDozMH0ucC1yLTMwe3BhZGRpbmctcmlnaHQ6MzB9LnAtYi0zMHtwYWRkaW5nLWJvdHRvbTozMH0ucC1sLTMwe3BhZGRpbmctbGVmdDozMH0ucC14LTMwe3BhZGRpbmctcmlnaHQ6MzA7cGFkZGluZy1sZWZ0OjMwfS5wLXktMzB7cGFkZGluZy10b3A6MzA7cGFkZGluZy1ib3R0b206MzB9LmhyLWxpZ2h0e2hlaWdodDoxO2JhY2tncm91bmQtY29sb3I6I2UwZTBlMDt3aWR0aDoxMDAlfS5oci1kYXJre2hlaWdodDoxO2JhY2tncm91bmQtY29sb3I6IzMwMzAzMDt3aWR0aDoxMDAlfS50ZXh0LWxlZnR7dGV4dC1hbGlnbjpsZWZ0fS50ZXh0LXJpZ2h0e3RleHQtYWxpZ246cmlnaHR9LnRleHQtY2VudGVye3RleHQtYWxpZ246Y2VudGVyfS50ZXh0LWxvd2VyY2FzZXt0ZXh0LXRyYW5zZm9ybTpsb3dlcmNhc2V9LnRleHQtdXBwZXJjYXNle3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZX0udGV4dC1jYXBpdGFsaXple3RleHQtdHJhbnNmb3JtOmNhcGl0YWxpemV9LmZvbnQtd2VpZ2h0LW5vcm1hbHtmb250LXdlaWdodDpub3JtYWx9LmZvbnQtd2VpZ2h0LWJvbGR7Zm9udC13ZWlnaHQ6Ym9sZH0uZm9udC1pdGFsaWN7Zm9udC1zdHlsZTppdGFsaWN9LnQtMTB7Zm9udC1zaXplOjEwfS50LTEye2ZvbnQtc2l6ZToxMn0udC0xNHtmb250LXNpemU6MTR9LnQtMTV7Zm9udC1zaXplOjE1fS50LTE2e2ZvbnQtc2l6ZToxNn0udC0xN3tmb250LXNpemU6MTd9LnQtMTh7Zm9udC1zaXplOjE4fS50LTE5e2ZvbnQtc2l6ZToxOX0udC0yMHtmb250LXNpemU6MjB9LnQtMjV7Zm9udC1zaXplOjI1fS50LTMwe2ZvbnQtc2l6ZTozMH0uaW1nLXJvdW5kZWR7Ym9yZGVyLXJhZGl1czo1fS5pbWctY2lyY2xle2JvcmRlci1yYWRpdXM6MjB9LmltZy10aHVtYm5haWx7Ym9yZGVyLXJhZGl1czowfS5pbnZpc2libGV7dmlzaWJpbGl0eTpjb2xsYXBzZX0ucHVsbC1sZWZ0e2hvcml6b250YWwtYWxpZ246bGVmdH0ucHVsbC1yaWdodHtob3Jpem9udGFsLWFsaWduOnJpZ2h0fS5tLXgtYXV0b3tob3Jpem9udGFsLWFsaWduOmNlbnRlcn0ubS15LWF1dG97dmVydGljYWwtYWxpZ246Y2VudGVyfS50ZXh0LXByaW1hcnl7Y29sb3I6IzMwYmNmZn0udGV4dC1kYW5nZXJ7Y29sb3I6I2Q1MDAwMH0udGV4dC1tdXRlZHtjb2xvcjojOWU5ZTllfS5iZy1wcmltYXJ5e2JhY2tncm91bmQtY29sb3I6IzMwYmNmZjtjb2xvcjojZmZmfS5iZy1kYW5nZXJ7YmFja2dyb3VuZC1jb2xvcjojZDUwMDAwO2NvbG9yOiNmZmZ9LmFjdGlvbi1iYXJ7YmFja2dyb3VuZC1jb2xvcjojRjhGOEY4O2NvbG9yOiMyMTIxMjF9LmFjdGlvbi1iYXIgLmFjdGlvbi1iYXItdGl0bGV7Zm9udC13ZWlnaHQ6Ym9sZDtmb250LXNpemU6MTc7dmVydGljYWwtYWxpZ246Y2VudGVyfS5hY3Rpb24tYmFyIC5hY3Rpb24taXRlbXtmb250LXdlaWdodDpub3JtYWx9LmFjdGl2aXR5LWluZGljYXRvcntjb2xvcjojMzBiY2ZmO3dpZHRoOjMwO2hlaWdodDozMH0uYnRue2NvbG9yOiMzMGJjZmY7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudDttaW4taGVpZ2h0OjM2O21pbi13aWR0aDo2NDtwYWRkaW5nOjEwIDEwIDEwIDEwO2ZvbnQtc2l6ZToxODttYXJnaW46OCAxNiA4IDE2fS5idG4uYnRuLWFjdGl2ZTpoaWdobGlnaHRlZHtjb2xvcjojZmZmO2JhY2tncm91bmQtY29sb3I6I2MwZWJmZn0uYnRuLXByaW1hcnl7YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmO2JvcmRlci1jb2xvcjojMzBiY2ZmO2NvbG9yOiNmZmZ9LmJ0bi1wcmltYXJ5LmJ0bi1hY3RpdmU6aGlnaGxpZ2h0ZWR7YmFja2dyb3VuZC1jb2xvcjojMDFhMGVjO2JvcmRlci1jb2xvcjojMDFhMGVjfS5idG4tcHJpbWFyeS5idG4tYXF1YXtiYWNrZ3JvdW5kLWNvbG9yOiMwMGNhYWJ9LmJ0bi1wcmltYXJ5LmJ0bi1ibHVle2JhY2tncm91bmQtY29sb3I6IzNkNWFmZX0uYnRuLXByaW1hcnkuYnRuLWJyb3due2JhY2tncm91bmQtY29sb3I6Izc5NTU0OH0uYnRuLXByaW1hcnkuYnRuLWZvcmVzdHtiYWNrZ3JvdW5kLWNvbG9yOiMwMDY5Njh9LmJ0bi1wcmltYXJ5LmJ0bi1ncmV5e2JhY2tncm91bmQtY29sb3I6IzVjNjg3Y30uYnRuLXByaW1hcnkuYnRuLWxlbW9ue2JhY2tncm91bmQtY29sb3I6I2ZmZWEwMDtjb2xvcjojMDAwfS5idG4tcHJpbWFyeS5idG4tbGltZXtiYWNrZ3JvdW5kLWNvbG9yOiNhZWU0MDY7Y29sb3I6IzAwMH0uYnRuLXByaW1hcnkuYnRuLW9yYW5nZXtiYWNrZ3JvdW5kLWNvbG9yOiNmNTdjMDB9LmJ0bi1wcmltYXJ5LmJ0bi1wdXJwbGV7YmFja2dyb3VuZC1jb2xvcjojODEzMGZmfS5idG4tcHJpbWFyeS5idG4tcnVieXtiYWNrZ3JvdW5kLWNvbG9yOiNmZjE3NDR9LmJ0bi1wcmltYXJ5LmJ0bi1za3l7YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmfS5idG4tb3V0bGluZXtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci1jb2xvcjojMzBiY2ZmO2NvbG9yOiMzMGJjZmZ9LmJ0bi1vdXRsaW5lLmJ0bi1hY3RpdmU6aGlnaGxpZ2h0ZWR7YmFja2dyb3VuZC1jb2xvcjojYzBlYmZmfS5idG5baXNFbmFibGVkPWZhbHNlXXtjb2xvcjojYTRhNGE0O2JhY2tncm91bmQtY29sb3I6I2UwZTBlMDtib3JkZXItY29sb3I6I2UwZTBlMH0uZmF7Zm9udC1mYW1pbHk6Rm9udEF3ZXNvbWUsIGZvbnRhd2Vzb21lLXdlYmZvbnR9LmZvcm0gLmlucHV0e3BhZGRpbmc6MTYgOCAxNiA4O2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnR9LmZvcm0gLmlucHV0LmlucHV0LWJvcmRlcntib3JkZXItd2lkdGg6MTtib3JkZXItY29sb3I6I2UwZTBlMDtib3JkZXItcmFkaXVzOjI7cGFkZGluZzoxNn0uZm9ybSAuaW5wdXQuaW5wdXQtcm91bmRlZHtib3JkZXItd2lkdGg6MTtib3JkZXItY29sb3I6I2UwZTBlMDtib3JkZXItcmFkaXVzOjI4O3BhZGRpbmc6MTZ9LmZvcm0gLmlucHV0W2lzRW5hYmxlZD0nZmFsc2UnXXtiYWNrZ3JvdW5kLWNvbG9yOiNmYWZhZmF9LmZvcm0gLmlucHV0LWZpZWxke21hcmdpbjo4fS5mb3JtIC5pbnB1dC1maWVsZCAubGFiZWx7Zm9udC1zaXplOjEyO2NvbG9yOiNiYWJhYmF9LmZvcm0gLmlucHV0LWZpZWxkIC5pbnB1dHtwYWRkaW5nOjA7bWFyZ2luOjAgMCA4IDB9LmZvcm0gLmlucHV0LWZpZWxkIC5oci1saWdodC5hY3RpdmUsLmZvcm0gLmlucHV0LWZpZWxkIC5oci1kYXJrLmFjdGl2ZXtiYWNrZ3JvdW5kLWNvbG9yOiMzMGJjZmZ9LmZvcm0gLmlucHV0LWZpZWxkLmlucHV0LXNpZGVzIC5sYWJlbHtmb250LXNpemU6MTg7bWFyZ2luOjAgMCA4IDB9LmgxLC5oMiwuaDMsLmg0LC5oNSwuaDZ7bWFyZ2luLWJvdHRvbTo0O2ZvbnQtd2VpZ2h0Om5vcm1hbDtjb2xvcjojMjEyMTIxfS5ib2R5LC5ib2R5MiwuZm9vdG5vdGV7Zm9udC13ZWlnaHQ6bm9ybWFsO2NvbG9yOiM3NTc1NzV9Lmgxe2ZvbnQtc2l6ZTozMn0uaDJ7Zm9udC1zaXplOjIyfS5oM3tmb250LXNpemU6MTV9Lmg0e2ZvbnQtc2l6ZToxMn0uaDV7Zm9udC1zaXplOjExfS5oNntmb250LXNpemU6MTB9LmJvZHl7Zm9udC1zaXplOjE0fS5ib2R5Mntmb250LXNpemU6MTd9LmZvb3Rub3Rle2ZvbnQtc2l6ZToxM30ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVte2NvbG9yOiMyMTIxMjE7Zm9udC1zaXplOjE2O21hcmdpbjowO3BhZGRpbmc6MTZ9Lmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbSBMYWJlbHt2ZXJ0aWNhbC1hbGlnbjpjZW50ZXJ9Lmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbSAudGh1bWJ7c3RyZXRjaDpmaWxsO3dpZHRoOjQwO2hlaWdodDo0MDttYXJnaW4tcmlnaHQ6MTZ9Lmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbS5hY3RpdmV7YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwfS5saXN0LWdyb3VwIC5saXN0LWdyb3VwLWl0ZW0gLmxpc3QtZ3JvdXAtaXRlbS10ZXh0e2NvbG9yOiM3NTc1NzU7Zm9udC1zaXplOjE0fS5wYWdle2JhY2tncm91bmQtY29sb3I6I2ZmZn0ucHJvZ3Jlc3N7Y29sb3I6IzMwYmNmZjtiYWNrZ3JvdW5kLWNvbG9yOiNiYWJhYmF9LnNlZ21lbnRlZC1iYXJ7Zm9udC1zaXplOjEzO2JhY2tncm91bmQtY29sb3I6I2ZmZjtjb2xvcjojMjEyMTIxO3NlbGVjdGVkLWJhY2tncm91bmQtY29sb3I6IzMwYmNmZn0uc2lkZWRyYXdlci1sZWZ0LC5zaWRlZHJhd2VyLWNlbnRlcntiYWNrZ3JvdW5kLWNvbG9yOiNmYWZhZmF9LnNpZGVkcmF3ZXItaGVhZGVye2JhY2tncm91bmQtY29sb3I6I2ZhZmFmYTtoZWlnaHQ6MTQ4O3dpZHRoOjEwMCV9LnNpZGVkcmF3ZXItbGVmdCAuc2lkZWRyYXdlci1oZWFkZXJ7cGFkZGluZzoxNiAxNiAwIDE2fS5zaWRlZHJhd2VyLWNlbnRlciAuc2lkZWRyYXdlci1oZWFkZXJ7cGFkZGluZzoyMCAxNSAwIDE1fS5zaWRlZHJhd2VyLWhlYWRlci1pbWFnZXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTB9LnNpZGVkcmF3ZXItbGVmdCAuc2lkZWRyYXdlci1oZWFkZXItaW1hZ2V7aGVpZ2h0OjY0O3dpZHRoOjY0O2JvcmRlci1yYWRpdXM6MzI7aG9yaXpvbnRhbC1hbGlnbjpsZWZ0O21hcmdpbi1ib3R0b206MzZ9LnNpZGVkcmF3ZXItY2VudGVyIC5zaWRlZHJhd2VyLWhlYWRlci1pbWFnZXtoZWlnaHQ6NzQ7d2lkdGg6NzQ7Ym9yZGVyLXJhZGl1czozNztob3Jpem9udGFsLWFsaWduOmNlbnRlcjttYXJnaW4tYm90dG9tOjI0fS5zaWRlZHJhd2VyLWhlYWRlci1icmFuZHtjb2xvcjojNzM3MzczfS5zaWRlZHJhd2VyLWxlZnQgLnNpZGVkcmF3ZXItaGVhZGVyLWJyYW5ke2hvcml6b250YWwtYWxpZ246bGVmdDtmb250LXNpemU6MTR9LnNpZGVkcmF3ZXItY2VudGVyIC5zaWRlZHJhd2VyLWhlYWRlci1icmFuZHtob3Jpem9udGFsLWFsaWduOmNlbnRlcjtmb250LXNpemU6MTV9LnNpZGVkcmF3ZXItbGlzdC1pdGVte2hlaWdodDo0ODtob3Jpem9udGFsLWFsaWduOmxlZnQ7d2lkdGg6MTAwJTtvcmllbnRhdGlvbjpob3Jpem9udGFsfS5zaWRlZHJhd2VyLWxpc3QtaXRlbSAuc2lkZWRyYXdlci1saXN0LWl0ZW0taWNvbnt3aWR0aDoyNDt0ZXh0LWFsaWduOmNlbnRlcjtmb250LXNpemU6MjA7aGVpZ2h0OjQ4O3ZlcnRpY2FsLWFsaWduOmNlbnRlcn0uc2lkZWRyYXdlci1saXN0LWl0ZW0uYWN0aXZle2NvbG9yOiNmZmY7YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmfS5zaWRlZHJhd2VyLWxpc3QtaXRlbS5hY3RpdmUgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLWljb257Y29sb3I6I2ZmZn0uc2lkZWRyYXdlci1sZWZ0IC5zaWRlZHJhd2VyLWxpc3QtaXRlbS1pY29ue21hcmdpbjowIDE2IDAgMTZ9LnNpZGVkcmF3ZXItY2VudGVyIC5zaWRlZHJhd2VyLWxpc3QtaXRlbS1pY29ue21hcmdpbjowIDAgMCAxNX0uc2lkZWRyYXdlci1saXN0LWl0ZW0tdGV4dHtob3Jpem9udGFsLWFsaWduOmxlZnQ7dGV4dC1hbGlnbjpsZWZ0O2ZvbnQtc2l6ZToxNTtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50O2JvcmRlci13aWR0aDowLjE7d2lkdGg6ODAlO3ZlcnRpY2FsLWFsaWduOmNlbnRlcn0uc2lkZWRyYXdlci1sZWZ0IC5zaWRlZHJhd2VyLWxpc3QtaXRlbS10ZXh0e3BhZGRpbmctbGVmdDoxNn0uc2lkZWRyYXdlci1jZW50ZXIgLnNpZGVkcmF3ZXItbGlzdC1pdGVtLXRleHR7cGFkZGluZy1sZWZ0OjE1fS5zbGlkZXJ7YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmfS5zbGlkZXJbaXNFbmFibGVkPWZhbHNlXXtiYWNrZ3JvdW5kLWNvbG9yOiNlMGUwZTA7Y29sb3I6I2UwZTBlMH0uc3dpdGNoW2NoZWNrZWQ9dHJ1ZV17YmFja2dyb3VuZC1jb2xvcjojMzBiY2ZmO2NvbG9yOiMzMGJjZmZ9LnN3aXRjaFtjaGVja2VkPXRydWVdW2lzRW5hYmxlZD1mYWxzZV17YmFja2dyb3VuZC1jb2xvcjojZTBlMGUwO2NvbG9yOiNmZmZ9LnN3aXRjaFtpc0VuYWJsZWQ9ZmFsc2Vde2JhY2tncm91bmQtY29sb3I6I2UwZTBlMDtjb2xvcjojZTBlMGUwfS50YWItdmlld3tzZWxlY3RlZC1jb2xvcjojMzBiY2ZmO3RhYnMtYmFja2dyb3VuZC1jb2xvcjojZmZmfS50YWItdmlldyAudGFiLXZpZXctaXRlbXtiYWNrZ3JvdW5kLWNvbG9yOiNmZmY7dGFicy1iYWNrZ3JvdW5kLWNvbG9yOiNmZmZ9I2xvZ2luLWJhY2tncm91bmR7bWFyZ2luLXRvcDotMjA7YmFja2dyb3VuZC1zaXplOmNvdmVyO2JhY2tncm91bmQtcG9zaXRpb246Y2VudGVyfS5sb2dpbi13cmFwe3BhZGRpbmc6MCA0MH0ubG9nby13cmFwe21hcmdpbjo2MCAwIDEwIDA7cGFkZGluZzoyMCAwfS5sb2dvLXdyYXAgLmxvZ2luLWxvZ297dGV4dC1hbGlnbjpjZW50ZXI7Zm9udC1zaXplOjMwO2ZvbnQtd2VpZ2h0OmJvbGQ7bWFyZ2luLWJvdHRvbToxMDtvcGFjaXR5OjE7Y29sb3I6IzIxMjEyMTtvcGFjaXR5Oi45fS5sb2dvLXdyYXAgLmxvZ2luLWxvZ28tc3Vie2NvbG9yOiMyMTIxMjE7b3BhY2l0eTouODt0ZXh0LWFsaWduOmNlbnRlcn0ubG9naW4td3JhcHBlcntwYWRkaW5nOjIwO2JhY2tncm91bmQtY29sb3I6I2ZmZjtib3JkZXItcmFkaXVzOjN9LmxvZ2luLXdyYXBwZXIgVGV4dEZpZWxke3BhZGRpbmc6MTAgMTA7bWFyZ2luOjEwIDAgMCAwfS5nby1iYWNre2ZvbnQtc2l6ZToxNDt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjojMjEyMTIxO21hcmdpbi10b3A6MTB9LmJ0bntib3JkZXItd2lkdGg6MDtmb250LWZhbWlseTonU0YgVUkgVGV4dCBNZWRpdW0nO2ZvbnQtc2l6ZToxNX0uYnRuLW91dGxpbmV7Ym9yZGVyLXdpZHRoOjF9LmJ0bi1yb3VuZGVkLXNte2JvcmRlci1yYWRpdXM6NH0uYnRuLXJvdW5kZWQtbGd7Ym9yZGVyLXJhZGl1czoxOX0uZm9ybXtmb250LWZhbWlseTonU0YgVUkgVGV4dCBSZWd1bGFyJ30uZm9ybSAuaW5wdXR7Zm9udC1zaXplOjE1fS5mb3JtIC5pbnB1dC5pbnB1dC1yb3VuZGVke2JvcmRlci1yYWRpdXM6Mjd9Lmgxe2ZvbnQtc2l6ZTozMn0uc2xpZGVye21hcmdpbjoxMCAxNX0uc2lkZWRyYXdlci1saXN0LWl0ZW0taWNvbiwuc2lkZWRyYXdlci1saXN0LWl0ZW17Y29sb3I6Izk0OTQ5NH0uc3dpdGNoe21hcmdpbjo4IDE1fS5saXN0LWdyb3VwIC5saXN0LWdyb3VwLWl0ZW17cGFkZGluZzoxNiAxNSAxNiAxNX0ubGlzdC1ncm91cCAubGlzdC1ncm91cC1pdGVtIC50aHVtYnttYXJnaW4tcmlnaHQ6MTV9Lmxpc3QtZ3JvdXAgLmxpc3QtZ3JvdXAtaXRlbSAubGlzdC1ncm91cC1pdGVtLWhlYWRpbmd7bWFyZ2luLWJvdHRvbTo1fS5zZWdtZW50ZWQtYmFye21hcmdpbjowIDE1O2NvbG9yOiMzMGJjZmZ9XFxuXCIsIFwiXCJdKTtcblxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qXG4gIE1JVCBMaWNlbnNlIGh0dHA6Ly93d3cub3BlbnNvdXJjZS5vcmcvbGljZW5zZXMvbWl0LWxpY2Vuc2UucGhwXG4gIEF1dGhvciBUb2JpYXMgS29wcGVycyBAc29rcmFcbiovXG4vLyBjc3MgYmFzZSBjb2RlLCBpbmplY3RlZCBieSB0aGUgY3NzLWxvYWRlclxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXNlU291cmNlTWFwKSB7XG4gIHZhciBsaXN0ID0gW107IC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcblxuICBsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICB2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblxuICAgICAgaWYgKGl0ZW1bMl0pIHtcbiAgICAgICAgcmV0dXJuICdAbWVkaWEgJyArIGl0ZW1bMl0gKyAneycgKyBjb250ZW50ICsgJ30nO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICB9XG4gICAgfSkuam9pbignJyk7XG4gIH07IC8vIGltcG9ydCBhIGxpc3Qgb2YgbW9kdWxlcyBpbnRvIHRoZSBsaXN0XG5cblxuICBsaXN0LmkgPSBmdW5jdGlvbiAobW9kdWxlcywgbWVkaWFRdWVyeSkge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIG1vZHVsZXMgPSBbW251bGwsIG1vZHVsZXMsICcnXV07XG4gICAgfVxuXG4gICAgdmFyIGFscmVhZHlJbXBvcnRlZE1vZHVsZXMgPSB7fTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGlkID0gdGhpc1tpXVswXTtcblxuICAgICAgaWYgKGlkICE9IG51bGwpIHtcbiAgICAgICAgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IG1vZHVsZXNbaV07IC8vIHNraXAgYWxyZWFkeSBpbXBvcnRlZCBtb2R1bGVcbiAgICAgIC8vIHRoaXMgaW1wbGVtZW50YXRpb24gaXMgbm90IDEwMCUgcGVyZmVjdCBmb3Igd2VpcmQgbWVkaWEgcXVlcnkgY29tYmluYXRpb25zXG4gICAgICAvLyB3aGVuIGEgbW9kdWxlIGlzIGltcG9ydGVkIG11bHRpcGxlIHRpbWVzIHdpdGggZGlmZmVyZW50IG1lZGlhIHF1ZXJpZXMuXG4gICAgICAvLyBJIGhvcGUgdGhpcyB3aWxsIG5ldmVyIG9jY3VyIChIZXkgdGhpcyB3YXkgd2UgaGF2ZSBzbWFsbGVyIGJ1bmRsZXMpXG5cbiAgICAgIGlmIChpdGVtWzBdID09IG51bGwgfHwgIWFscmVhZHlJbXBvcnRlZE1vZHVsZXNbaXRlbVswXV0pIHtcbiAgICAgICAgaWYgKG1lZGlhUXVlcnkgJiYgIWl0ZW1bMl0pIHtcbiAgICAgICAgICBpdGVtWzJdID0gbWVkaWFRdWVyeTtcbiAgICAgICAgfSBlbHNlIGlmIChtZWRpYVF1ZXJ5KSB7XG4gICAgICAgICAgaXRlbVsyXSA9ICcoJyArIGl0ZW1bMl0gKyAnKSBhbmQgKCcgKyBtZWRpYVF1ZXJ5ICsgJyknO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICByZXR1cm4gbGlzdDtcbn07XG5cbmZ1bmN0aW9uIGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKSB7XG4gIHZhciBjb250ZW50ID0gaXRlbVsxXSB8fCAnJztcbiAgdmFyIGNzc01hcHBpbmcgPSBpdGVtWzNdO1xuXG4gIGlmICghY3NzTWFwcGluZykge1xuICAgIHJldHVybiBjb250ZW50O1xuICB9XG5cbiAgaWYgKHVzZVNvdXJjZU1hcCAmJiB0eXBlb2YgYnRvYSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHZhciBzb3VyY2VNYXBwaW5nID0gdG9Db21tZW50KGNzc01hcHBpbmcpO1xuICAgIHZhciBzb3VyY2VVUkxzID0gY3NzTWFwcGluZy5zb3VyY2VzLm1hcChmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICByZXR1cm4gJy8qIyBzb3VyY2VVUkw9JyArIGNzc01hcHBpbmcuc291cmNlUm9vdCArIHNvdXJjZSArICcgKi8nO1xuICAgIH0pO1xuICAgIHJldHVybiBbY29udGVudF0uY29uY2F0KHNvdXJjZVVSTHMpLmNvbmNhdChbc291cmNlTWFwcGluZ10pLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgcmV0dXJuIFtjb250ZW50XS5qb2luKCdcXG4nKTtcbn0gLy8gQWRhcHRlZCBmcm9tIGNvbnZlcnQtc291cmNlLW1hcCAoTUlUKVxuXG5cbmZ1bmN0aW9uIHRvQ29tbWVudChzb3VyY2VNYXApIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVuZGVmXG4gIHZhciBiYXNlNjQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpO1xuICB2YXIgZGF0YSA9ICdzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCwnICsgYmFzZTY0O1xuICByZXR1cm4gJy8qIyAnICsgZGF0YSArICcgKi8nO1xufSIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuY29uc3QgaG90ID0gcmVxdWlyZShcIi4uL2hvdFwiKTtcbmNvbnN0IGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwidG5zLWNvcmUtbW9kdWxlcy9maWxlLXN5c3RlbVwiKTtcbmZ1bmN0aW9uIGhtclVwZGF0ZSgpIHtcbiAgICBjb25zdCBhcHBsaWNhdGlvbkZpbGVzID0gZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpO1xuICAgIGNvbnN0IGxhdGVzdEhhc2ggPSBfX3dlYnBhY2tfcmVxdWlyZV9fW1wiaFwiXSgpO1xuICAgIHJldHVybiBob3QobGF0ZXN0SGFzaCwgZmlsZW5hbWUgPT4gYXBwbGljYXRpb25GaWxlcy5nZXRGaWxlKGZpbGVuYW1lKSk7XG59XG5leHBvcnRzLmhtclVwZGF0ZSA9IGhtclVwZGF0ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhtci11cGRhdGUuanMubWFwIiwiXCJ1c2Ugc3RyaWN0XCI7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaG1yX3VwZGF0ZV8xID0gcmVxdWlyZShcIi4vaG1yLXVwZGF0ZVwiKTtcbmV4cG9ydHMuaG1yVXBkYXRlID0gaG1yX3VwZGF0ZV8xLmhtclVwZGF0ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImNvbnN0IGhtclByZWZpeCA9ICdITVI6JztcbmNvbnN0IGxvZyA9IHtcbiAgICBpbmZvOiAobWVzc2FnZSkgPT4gY29uc29sZS5pbmZvKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxuICAgIHdhcm46IChtZXNzYWdlKSA9PiBjb25zb2xlLndhcm4oYCR7aG1yUHJlZml4fSAke21lc3NhZ2V9YCksXG4gICAgZXJyb3I6IChtZXNzYWdlKSA9PiBjb25zb2xlLmVycm9yKGAke2htclByZWZpeH0gJHttZXNzYWdlfWApLFxufTtcbmNvbnN0IHJlZnJlc2ggPSAnQXBwbGljYXRpb24gbmVlZHMgdG8gYmUgcmVzdGFydGVkIGluIG9yZGVyIHRvIGFwcGx5IHRoZSBjaGFuZ2VzLic7XG5jb25zdCBob3RPcHRpb25zID0ge1xuICAgIGlnbm9yZVVuYWNjZXB0ZWQ6IGZhbHNlLFxuICAgIGlnbm9yZURlY2xpbmVkOiBmYWxzZSxcbiAgICBpZ25vcmVFcnJvcmVkOiBmYWxzZSxcbiAgICBvblVuYWNjZXB0ZWQoZGF0YSkge1xuICAgICAgICBjb25zdCBjaGFpbiA9IFtdLmNvbmNhdChkYXRhLmNoYWluKTtcbiAgICAgICAgY29uc3QgbGFzdCA9IGNoYWluW2NoYWluLmxlbmd0aCAtIDFdO1xuXG4gICAgICAgIGlmIChsYXN0ID09PSAwKSB7XG4gICAgICAgICAgICBjaGFpbi5wb3AoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvZy53YXJuKGBJZ25vcmVkIGFuIHVwZGF0ZSB0byB1bmFjY2VwdGVkIG1vZHVsZTogYCk7XG4gICAgICAgIGNoYWluLmZvckVhY2gobW9kID0+IGxvZy53YXJuKGAgICAgICAgICDinq0gJHttb2R9YCkpO1xuICAgIH0sXG4gICAgb25EZWNsaW5lZChkYXRhKSB7XG4gICAgICAgIGxvZy53YXJuKGBJZ25vcmVkIGFuIHVwZGF0ZSB0byBkZWNsaW5lZCBtb2R1bGU6YCk7XG4gICAgICAgIGRhdGEuY2hhaW4uZm9yRWFjaChtb2QgPT4gbG9nLndhcm4oYCAgICAgICAgIOKerSAke21vZH1gKSk7XG4gICAgfSxcbiAgICBvbkVycm9yZWQoZGF0YSkge1xuICAgICAgICBsb2cud2FybihcbiAgICAgICAgICAgIGBJZ25vcmVkIGFuIGVycm9yIHdoaWxlIHVwZGF0aW5nIG1vZHVsZSAke2RhdGEubW9kdWxlSWR9IDwke2RhdGEudHlwZX0+YFxuICAgICAgICApO1xuICAgICAgICBsb2cud2FybihkYXRhLmVycm9yKTtcbiAgICB9LFxufTtcblxubGV0IG5leHRIYXNoO1xubGV0IGN1cnJlbnRIYXNoO1xuXG5mdW5jdGlvbiB1cFRvRGF0ZSgpIHtcbiAgICByZXR1cm4gbmV4dEhhc2guaW5kZXhPZihfX3dlYnBhY2tfaGFzaF9fKSA+PSAwO1xufVxuXG5mdW5jdGlvbiByZXN1bHQobW9kdWxlcywgYXBwbGllZE1vZHVsZXMpIHtcbiAgICBjb25zdCB1bmFjY2VwdGVkID0gbW9kdWxlcy5maWx0ZXIoXG4gICAgICAgIChtb2R1bGVJZCkgPT4gYXBwbGllZE1vZHVsZXMgJiYgYXBwbGllZE1vZHVsZXMuaW5kZXhPZihtb2R1bGVJZCkgPCAwXG4gICAgKTtcblxuICAgIGlmICh1bmFjY2VwdGVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbG9nLndhcm4oJ1RoZSBmb2xsb3dpbmcgbW9kdWxlcyBjb3VsZCBub3QgYmUgdXBkYXRlZDonKTtcblxuICAgICAgICBmb3IgKGNvbnN0IG1vZHVsZUlkIG9mIHVuYWNjZXB0ZWQpIHtcbiAgICAgICAgICAgIGxvZy53YXJuKGAgICAgICAgICAg4qa7ICR7bW9kdWxlSWR9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIShhcHBsaWVkTW9kdWxlcyB8fCBbXSkubGVuZ3RoKSB7XG4gICAgICAgIGxvZy5pbmZvKCdObyBNb2R1bGVzIFVwZGF0ZWQuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbG9nLmluZm8oJ1RoZSBmb2xsb3dpbmcgbW9kdWxlcyB3ZXJlIHVwZGF0ZWQ6Jyk7XG5cbiAgICAgICAgZm9yIChjb25zdCBtb2R1bGVJZCBvZiBhcHBsaWVkTW9kdWxlcykge1xuICAgICAgICAgICAgbG9nLmluZm8oYCAgICAgICAgIOKGuyAke21vZHVsZUlkfWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgbnVtYmVySWRzID0gYXBwbGllZE1vZHVsZXMuZXZlcnkoXG4gICAgICAgICAgICAobW9kdWxlSWQpID0+IHR5cGVvZiBtb2R1bGVJZCA9PT0gJ251bWJlcidcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKG51bWJlcklkcykge1xuICAgICAgICAgICAgbG9nLmluZm8oXG4gICAgICAgICAgICAgICAgJ1BsZWFzZSBjb25zaWRlciB1c2luZyB0aGUgTmFtZWRNb2R1bGVzUGx1Z2luIGZvciBtb2R1bGUgbmFtZXMuJ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gY2hlY2sob3B0aW9ucykge1xuICAgIHJldHVybiBtb2R1bGUuaG90XG4gICAgICAgIC5jaGVjaygpXG4gICAgICAgIC50aGVuKChtb2R1bGVzKSA9PiB7XG4gICAgICAgICAgICBpZiAoIW1vZHVsZXMpIHtcbiAgICAgICAgICAgICAgICBsb2cud2FybihcbiAgICAgICAgICAgICAgICAgICAgYENhbm5vdCBmaW5kIHVwZGF0ZS4gJHtyZWZyZXNofWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlLmhvdFxuICAgICAgICAgICAgICAgIC5hcHBseShob3RPcHRpb25zKVxuICAgICAgICAgICAgICAgIC50aGVuKChhcHBsaWVkTW9kdWxlcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmV4dENoZWNrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXVwVG9EYXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRDaGVjayA9IGNoZWNrKG9wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0KG1vZHVsZXMsIGFwcGxpZWRNb2R1bGVzKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXBUb0RhdGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90IG1vZGlmeSBtZXNzYWdlIC0gQ0xJIGRlcGVuZHMgb24gdGhpcyBleGFjdCBjb250ZW50IHRvIGRldGVybWluZSBobXIgb3BlcmF0aW9uIHN0YXR1cy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5pbmZvKGBTdWNjZXNzZnVsbHkgYXBwbGllZCB1cGRhdGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS4gQXBwIGlzIHVwIHRvIGRhdGUuYCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV4dENoZWNrIHx8IG51bGw7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXMgPSBtb2R1bGUuaG90LnN0YXR1cygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoWydhYm9ydCcsICdmYWlsJ10uaW5kZXhPZihzdGF0dXMpID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIG5vdCBtb2RpZnkgbWVzc2FnZSAtIENMSSBkZXBlbmRzIG9uIHRoaXMgZXhhY3QgY29udGVudCB0byBkZXRlcm1pbmUgaG1yIG9wZXJhdGlvbiBzdGF0dXMuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2cuZXJyb3IoYENhbm5vdCBhcHBseSB1cGRhdGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvZy5lcnJvcihlcnIubWVzc2FnZSB8fCBlcnIuc3RhY2spO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9nLmVycm9yKGBVcGRhdGUgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVyci5zdGFja31gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RhdHVzID0gbW9kdWxlLmhvdC5zdGF0dXMoKTtcbiAgICAgICAgICAgIGlmIChbJ2Fib3J0JywgJ2ZhaWwnXS5pbmRleE9mKHN0YXR1cykgPj0gMCkge1xuICAgICAgICAgICAgICAgIGxvZy5lcnJvcihgQ2Fubm90IGNoZWNrIGZvciB1cGRhdGUuICR7cmVmcmVzaH1gKTtcbiAgICAgICAgICAgICAgICBsb2cuZXJyb3IoZXJyLm1lc3NhZ2UgfHwgZXJyLnN0YWNrKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9nLmVycm9yKGBVcGRhdGUgY2hlY2sgZmFpbGVkOiAke2Vyci5tZXNzYWdlIHx8IGVyci5zdGFja31gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG59XG5cbmlmIChtb2R1bGUuaG90KSB7XG4gICAgbG9nLmluZm8oJ0hvdCBNb2R1bGUgUmVwbGFjZW1lbnQgRW5hYmxlZC4gV2FpdGluZyBmb3Igc2lnbmFsLicpO1xufSBlbHNlIHtcbiAgICBsb2cuZXJyb3IoJ0hvdCBNb2R1bGUgUmVwbGFjZW1lbnQgaXMgZGlzYWJsZWQuJyk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZShsYXRlc3RIYXNoLCBvcHRpb25zKSB7XG4gICAgbmV4dEhhc2ggPSBsYXRlc3RIYXNoO1xuICAgIGlmICghdXBUb0RhdGUoKSkge1xuICAgICAgICBjb25zdCBzdGF0dXMgPSBtb2R1bGUuaG90LnN0YXR1cygpO1xuXG4gICAgICAgIGlmIChzdGF0dXMgPT09ICdpZGxlJykge1xuICAgICAgICAgICAgLy9EbyBub3QgbW9kaWZ5IG1lc3NhZ2UgLSBDTEkgZGVwZW5kcyBvbiB0aGlzIGV4YWN0IGNvbnRlbnQgdG8gZGV0ZXJtaW5lIGhtciBvcGVyYXRpb24gc3RhdHVzLlxuICAgICAgICAgICAgbG9nLmluZm8oYENoZWNraW5nIGZvciB1cGRhdGVzIHRvIHRoZSBidW5kbGUgd2l0aCBobXIgaGFzaCAke2N1cnJlbnRIYXNofS5gKTtcbiAgICAgICAgICAgIHJldHVybiBjaGVjayhvcHRpb25zKTtcbiAgICAgICAgfSBlbHNlIGlmIChbJ2Fib3J0JywgJ2ZhaWwnXS5pbmRleE9mKHN0YXR1cykgPj0gMCkge1xuICAgICAgICAgICAgbG9nLndhcm4oXG4gICAgICAgICAgICAgICAgYENhbm5vdCBhcHBseSB1cGRhdGUuIEEgcHJldmlvdXMgdXBkYXRlICR7c3RhdHVzfWVkLiAke3JlZnJlc2h9YFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmZ1bmN0aW9uIGdldE5leHRIYXNoKGhhc2gsIGdldEZpbGVDb250ZW50KSB7XG4gICAgY29uc3QgZmlsZSA9IGdldEZpbGVDb250ZW50KGAke2hhc2h9LmhvdC11cGRhdGUuanNvbmApO1xuICAgIHJldHVybiBmaWxlLnJlYWRUZXh0KCkudGhlbihob3RVcGRhdGVDb250ZW50ID0+IHtcbiAgICAgICAgaWYgKGhvdFVwZGF0ZUNvbnRlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hbmlmZXN0ID0gSlNPTi5wYXJzZShob3RVcGRhdGVDb250ZW50KTtcbiAgICAgICAgICAgIGNvbnN0IG5ld0hhc2ggPSBtYW5pZmVzdC5oO1xuICAgICAgICAgICAgcmV0dXJuIGdldE5leHRIYXNoKG5ld0hhc2gsIGdldEZpbGVDb250ZW50KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoaGFzaCk7XG4gICAgICAgIH1cbiAgICB9KS5jYXRjaChlcnJvciA9PiBQcm9taXNlLnJlamVjdChlcnJvcikpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNoZWNrU3RhdGUoaW5pdGlhbEhhc2gsIGdldEZpbGVDb250ZW50KSB7XG4gICAgY3VycmVudEhhc2ggPSBpbml0aWFsSGFzaDtcbiAgICByZXR1cm4gZ2V0TmV4dEhhc2goaW5pdGlhbEhhc2gsIGdldEZpbGVDb250ZW50KS50aGVuKG5leHRIYXNoID0+IHtcbiAgICAgICAgaWYgKG5leHRIYXNoICE9IGluaXRpYWxIYXNoKSB7XG4gICAgICAgICAgICByZXR1cm4gdXBkYXRlKG5leHRIYXNoLCB7fSk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuIiwiY29uc3QgbG9hZENzcyA9IHJlcXVpcmUoXCIuL2xvYWQtYXBwbGljYXRpb24tY3NzXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCkge1xuICAgIGxvYWRDc3MoZnVuY3Rpb24oKSB7XG4gICAgICAgIGdsb2JhbC5yZWdpc3Rlck1vZHVsZShcIi4vYXBwLmNzc1wiLCAoKSA9PiByZXF1aXJlKFwifi9hcHBcIikpO1xuICAgIH0pO1xufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAobG9hZE1vZHVsZUZuKSB7XG4gICAgY29uc3QgYXBwbGljYXRpb24gPSByZXF1aXJlKFwidG5zLWNvcmUtbW9kdWxlcy9hcHBsaWNhdGlvblwiKTtcbiAgICByZXF1aXJlKFwidG5zLWNvcmUtbW9kdWxlcy91aS9zdHlsaW5nL3N0eWxlLXNjb3BlXCIpO1xuXG4gICAgbG9hZE1vZHVsZUZuKCk7XG5cbiAgICBhcHBsaWNhdGlvbi5sb2FkQXBwQ3NzKCk7XG59XG4iLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiZ2xvYmFsc1wiKTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xuZXhwb3J0cy5PYnNlcnZhYmxlID0gb2JzZXJ2YWJsZV8xLk9ic2VydmFibGU7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vcHJvZmlsaW5nXCIpO1xudmFyIGV2ZW50cyA9IG5ldyBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSgpO1xudmFyIGxhdW5jaGVkID0gZmFsc2U7XG5mdW5jdGlvbiBzZXRMYXVuY2hlZCgpIHtcbiAgICBsYXVuY2hlZCA9IHRydWU7XG4gICAgZXZlbnRzLm9mZihcImxhdW5jaFwiLCBzZXRMYXVuY2hlZCk7XG59XG5ldmVudHMub24oXCJsYXVuY2hcIiwgc2V0TGF1bmNoZWQpO1xuaWYgKHByb2ZpbGluZ18xLmxldmVsKCkgPiAwKSB7XG4gICAgZXZlbnRzLm9uKFwiZGlzcGxheWVkXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGR1cmF0aW9uID0gcHJvZmlsaW5nXzEudXB0aW1lKCk7XG4gICAgICAgIHZhciBlbmQgPSBwcm9maWxpbmdfMS50aW1lKCk7XG4gICAgICAgIHZhciBzdGFydCA9IGVuZCAtIGR1cmF0aW9uO1xuICAgICAgICBwcm9maWxpbmdfMS50cmFjZShcIkRpc3BsYXllZCBpbiBcIiArIGR1cmF0aW9uLnRvRml4ZWQoMikgKyBcIm1zXCIsIHN0YXJ0LCBlbmQpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gaGFzTGF1bmNoZWQoKSB7XG4gICAgcmV0dXJuIGxhdW5jaGVkO1xufVxuZXhwb3J0cy5oYXNMYXVuY2hlZCA9IGhhc0xhdW5jaGVkO1xuZXhwb3J0cy5sYXVuY2hFdmVudCA9IFwibGF1bmNoXCI7XG5leHBvcnRzLnN1c3BlbmRFdmVudCA9IFwic3VzcGVuZFwiO1xuZXhwb3J0cy5kaXNwbGF5ZWRFdmVudCA9IFwiZGlzcGxheWVkXCI7XG5leHBvcnRzLnJlc3VtZUV2ZW50ID0gXCJyZXN1bWVcIjtcbmV4cG9ydHMuZXhpdEV2ZW50ID0gXCJleGl0XCI7XG5leHBvcnRzLmxvd01lbW9yeUV2ZW50ID0gXCJsb3dNZW1vcnlcIjtcbmV4cG9ydHMudW5jYXVnaHRFcnJvckV2ZW50ID0gXCJ1bmNhdWdodEVycm9yXCI7XG5leHBvcnRzLmRpc2NhcmRlZEVycm9yRXZlbnQgPSBcImRpc2NhcmRlZEVycm9yXCI7XG5leHBvcnRzLm9yaWVudGF0aW9uQ2hhbmdlZEV2ZW50ID0gXCJvcmllbnRhdGlvbkNoYW5nZWRcIjtcbnZhciBjc3NGaWxlID0gXCIuL2FwcC5jc3NcIjtcbnZhciByZXNvdXJjZXMgPSB7fTtcbmZ1bmN0aW9uIGdldFJlc291cmNlcygpIHtcbiAgICByZXR1cm4gcmVzb3VyY2VzO1xufVxuZXhwb3J0cy5nZXRSZXNvdXJjZXMgPSBnZXRSZXNvdXJjZXM7XG5mdW5jdGlvbiBzZXRSZXNvdXJjZXMocmVzKSB7XG4gICAgcmVzb3VyY2VzID0gcmVzO1xufVxuZXhwb3J0cy5zZXRSZXNvdXJjZXMgPSBzZXRSZXNvdXJjZXM7XG5leHBvcnRzLmFuZHJvaWQgPSB1bmRlZmluZWQ7XG5leHBvcnRzLmlvcyA9IHVuZGVmaW5lZDtcbmV4cG9ydHMub24gPSBldmVudHMub24uYmluZChldmVudHMpO1xuZXhwb3J0cy5vZmYgPSBldmVudHMub2ZmLmJpbmQoZXZlbnRzKTtcbmV4cG9ydHMubm90aWZ5ID0gZXZlbnRzLm5vdGlmeS5iaW5kKGV2ZW50cyk7XG5leHBvcnRzLmhhc0xpc3RlbmVycyA9IGV2ZW50cy5oYXNMaXN0ZW5lcnMuYmluZChldmVudHMpO1xudmFyIGFwcDtcbmZ1bmN0aW9uIHNldEFwcGxpY2F0aW9uKGluc3RhbmNlKSB7XG4gICAgYXBwID0gaW5zdGFuY2U7XG59XG5leHBvcnRzLnNldEFwcGxpY2F0aW9uID0gc2V0QXBwbGljYXRpb247XG5mdW5jdGlvbiBsaXZlc3luYyhyb290VmlldywgY29udGV4dCkge1xuICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IFwibGl2ZXN5bmNcIiwgb2JqZWN0OiBhcHAgfSk7XG4gICAgdmFyIGxpdmVTeW5jQ29yZSA9IGdsb2JhbC5fX29uTGl2ZVN5bmNDb3JlO1xuICAgIHZhciByZWFwcGx5QXBwU3R5bGVzID0gZmFsc2U7XG4gICAgaWYgKGNvbnRleHQgJiYgY29udGV4dC5wYXRoKSB7XG4gICAgICAgIHZhciBzdHlsZUV4dGVuc2lvbnMgPSBbXCJjc3NcIiwgXCJzY3NzXCJdO1xuICAgICAgICB2YXIgYXBwU3R5bGVzRnVsbEZpbGVOYW1lID0gZ2V0Q3NzRmlsZU5hbWUoKTtcbiAgICAgICAgdmFyIGFwcFN0eWxlc0ZpbGVOYW1lXzEgPSBhcHBTdHlsZXNGdWxsRmlsZU5hbWUuc3Vic3RyaW5nKDAsIGFwcFN0eWxlc0Z1bGxGaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIikgKyAxKTtcbiAgICAgICAgcmVhcHBseUFwcFN0eWxlcyA9IHN0eWxlRXh0ZW5zaW9ucy5zb21lKGZ1bmN0aW9uIChleHQpIHsgcmV0dXJuIGNvbnRleHQucGF0aCA9PT0gYXBwU3R5bGVzRmlsZU5hbWVfMS5jb25jYXQoZXh0KTsgfSk7XG4gICAgfVxuICAgIGlmIChyZWFwcGx5QXBwU3R5bGVzICYmIHJvb3RWaWV3KSB7XG4gICAgICAgIHJvb3RWaWV3Ll9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGxpdmVTeW5jQ29yZSkge1xuICAgICAgICBsaXZlU3luY0NvcmUoY29udGV4dCk7XG4gICAgfVxufVxuZXhwb3J0cy5saXZlc3luYyA9IGxpdmVzeW5jO1xuZnVuY3Rpb24gc2V0Q3NzRmlsZU5hbWUoY3NzRmlsZU5hbWUpIHtcbiAgICBjc3NGaWxlID0gY3NzRmlsZU5hbWU7XG4gICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJjc3NDaGFuZ2VkXCIsIG9iamVjdDogYXBwLCBjc3NGaWxlOiBjc3NGaWxlTmFtZSB9KTtcbn1cbmV4cG9ydHMuc2V0Q3NzRmlsZU5hbWUgPSBzZXRDc3NGaWxlTmFtZTtcbmZ1bmN0aW9uIGdldENzc0ZpbGVOYW1lKCkge1xuICAgIHJldHVybiBjc3NGaWxlO1xufVxuZXhwb3J0cy5nZXRDc3NGaWxlTmFtZSA9IGdldENzc0ZpbGVOYW1lO1xuZnVuY3Rpb24gbG9hZEFwcENzcygpIHtcbiAgICB0cnkge1xuICAgICAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBcImxvYWRBcHBDc3NcIiwgb2JqZWN0OiBhcHAsIGNzc0ZpbGU6IGdldENzc0ZpbGVOYW1lKCkgfSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBmaWxlIFwiICsgZ2V0Q3NzRmlsZU5hbWUoKSArIFwiIGNvdWxkbid0IGJlIGxvYWRlZCEgXCIgK1xuICAgICAgICAgICAgXCJZb3UgbWF5IG5lZWQgdG8gcmVnaXN0ZXIgaXQgaW5zaWRlIC4vYXBwL3ZlbmRvci50cy5cIik7XG4gICAgfVxufVxuZXhwb3J0cy5sb2FkQXBwQ3NzID0gbG9hZEFwcENzcztcbmZ1bmN0aW9uIGFkZENzcyhjc3NUZXh0KSB7XG4gICAgZXZlbnRzLm5vdGlmeSh7IGV2ZW50TmFtZTogXCJjc3NDaGFuZ2VkXCIsIG9iamVjdDogYXBwLCBjc3NUZXh0OiBjc3NUZXh0IH0pO1xufVxuZXhwb3J0cy5hZGRDc3MgPSBhZGRDc3M7XG5nbG9iYWwuX19vblVuY2F1Z2h0RXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBldmVudHMubm90aWZ5KHsgZXZlbnROYW1lOiBleHBvcnRzLnVuY2F1Z2h0RXJyb3JFdmVudCwgb2JqZWN0OiBhcHAsIGFuZHJvaWQ6IGVycm9yLCBpb3M6IGVycm9yLCBlcnJvcjogZXJyb3IgfSk7XG59O1xuZ2xvYmFsLl9fb25EaXNjYXJkZWRFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgIGV2ZW50cy5ub3RpZnkoeyBldmVudE5hbWU6IGV4cG9ydHMuZGlzY2FyZGVkRXJyb3JFdmVudCwgb2JqZWN0OiBhcHAsIGVycm9yOiBlcnJvciB9KTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbi1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBhcHBsaWNhdGlvbl9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2FwcGxpY2F0aW9uLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2FwcGxpY2F0aW9uLWNvbW1vblwiKSk7XG52YXIgYnVpbGRlcl8xID0gcmVxdWlyZShcIi4uL3VpL2J1aWxkZXJcIik7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL3VpL2NvcmUvdmlld1wiKTtcbnZhciBmcmFtZV8xID0gcmVxdWlyZShcIi4uL3VpL2ZyYW1lXCIpO1xudmFyIHV0aWxzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvdXRpbHNcIik7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vcHJvZmlsaW5nXCIpO1xudmFyIGdldFZpc2libGVWaWV3Q29udHJvbGxlciA9IHV0aWxzXzEuaW9zLmdldFZpc2libGVWaWV3Q29udHJvbGxlcjtcbnZhciBSZXNwb25kZXIgPSBVSVJlc3BvbmRlci5leHRlbmQoe1xuICAgIGdldCB3aW5kb3coKSB7XG4gICAgICAgIHJldHVybiBpb3NBcHAgPyBpb3NBcHAud2luZG93IDogdW5kZWZpbmVkO1xuICAgIH0sXG4gICAgc2V0IHdpbmRvdyhzZXRXaW5kb3cpIHtcbiAgICB9XG59LCB7XG4gICAgcHJvdG9jb2xzOiBbVUlBcHBsaWNhdGlvbkRlbGVnYXRlXVxufSk7XG52YXIgTm90aWZpY2F0aW9uT2JzZXJ2ZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOb3RpZmljYXRpb25PYnNlcnZlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOb3RpZmljYXRpb25PYnNlcnZlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBOb3RpZmljYXRpb25PYnNlcnZlci5pbml0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKG9uUmVjZWl2ZUNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBvYnNlcnZlciA9IF9zdXBlci5uZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgb2JzZXJ2ZXIuX29uUmVjZWl2ZUNhbGxiYWNrID0gb25SZWNlaXZlQ2FsbGJhY2s7XG4gICAgICAgIHJldHVybiBvYnNlcnZlcjtcbiAgICB9O1xuICAgIE5vdGlmaWNhdGlvbk9ic2VydmVyLnByb3RvdHlwZS5vblJlY2VpdmUgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIHRoaXMuX29uUmVjZWl2ZUNhbGxiYWNrKG5vdGlmaWNhdGlvbik7XG4gICAgfTtcbiAgICBOb3RpZmljYXRpb25PYnNlcnZlci5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwib25SZWNlaXZlXCI6IHsgcmV0dXJuczogaW50ZXJvcC50eXBlcy52b2lkLCBwYXJhbXM6IFtOU05vdGlmaWNhdGlvbl0gfVxuICAgIH07XG4gICAgcmV0dXJuIE5vdGlmaWNhdGlvbk9ic2VydmVyO1xufShOU09iamVjdCkpO1xudmFyIGRpc3BsYXllZE9uY2UgPSBmYWxzZTtcbnZhciBkaXNwbGF5ZWRMaW5rVGFyZ2V0O1xudmFyIGRpc3BsYXllZExpbms7XG52YXIgQ0FEaXNwbGF5TGlua1RhcmdldCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENBRGlzcGxheUxpbmtUYXJnZXQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ0FEaXNwbGF5TGlua1RhcmdldCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDQURpc3BsYXlMaW5rVGFyZ2V0LnByb3RvdHlwZS5vbkRpc3BsYXllZCA9IGZ1bmN0aW9uIChsaW5rKSB7XG4gICAgICAgIGxpbmsuaW52YWxpZGF0ZSgpO1xuICAgICAgICB2YXIgaW9zID0gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbjtcbiAgICAgICAgdmFyIG9iamVjdCA9IGlvc0FwcDtcbiAgICAgICAgZGlzcGxheWVkT25jZSA9IHRydWU7XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEuZGlzcGxheWVkRXZlbnQsIG9iamVjdDogb2JqZWN0LCBpb3M6IGlvcyB9KTtcbiAgICAgICAgZGlzcGxheWVkTGlua1RhcmdldCA9IG51bGw7XG4gICAgICAgIGRpc3BsYXllZExpbmsgPSBudWxsO1xuICAgIH07XG4gICAgQ0FEaXNwbGF5TGlua1RhcmdldC5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwib25EaXNwbGF5ZWRcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW0NBRGlzcGxheUxpbmtdIH1cbiAgICB9O1xuICAgIHJldHVybiBDQURpc3BsYXlMaW5rVGFyZ2V0O1xufShOU09iamVjdCkpO1xudmFyIElPU0FwcGxpY2F0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJT1NBcHBsaWNhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fY3VycmVudE9yaWVudGF0aW9uID0gVUlEZXZpY2UuY3VycmVudERldmljZS5vcmllbnRhdGlvbjtcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuYWRkTm90aWZpY2F0aW9uT2JzZXJ2ZXIoVUlBcHBsaWNhdGlvbkRpZEZpbmlzaExhdW5jaGluZ05vdGlmaWNhdGlvbiwgdGhpcy5kaWRGaW5pc2hMYXVuY2hpbmdXaXRoT3B0aW9ucy5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5hZGROb3RpZmljYXRpb25PYnNlcnZlcihVSUFwcGxpY2F0aW9uRGlkQmVjb21lQWN0aXZlTm90aWZpY2F0aW9uLCB0aGlzLmRpZEJlY29tZUFjdGl2ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5hZGROb3RpZmljYXRpb25PYnNlcnZlcihVSUFwcGxpY2F0aW9uRGlkRW50ZXJCYWNrZ3JvdW5kTm90aWZpY2F0aW9uLCB0aGlzLmRpZEVudGVyQmFja2dyb3VuZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5hZGROb3RpZmljYXRpb25PYnNlcnZlcihVSUFwcGxpY2F0aW9uV2lsbFRlcm1pbmF0ZU5vdGlmaWNhdGlvbiwgdGhpcy53aWxsVGVybWluYXRlLmJpbmQodGhpcykpO1xuICAgICAgICB0aGlzLmFkZE5vdGlmaWNhdGlvbk9ic2VydmVyKFVJQXBwbGljYXRpb25EaWRSZWNlaXZlTWVtb3J5V2FybmluZ05vdGlmaWNhdGlvbiwgdGhpcy5kaWRSZWNlaXZlTWVtb3J5V2FybmluZy5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5hZGROb3RpZmljYXRpb25PYnNlcnZlcihVSURldmljZU9yaWVudGF0aW9uRGlkQ2hhbmdlTm90aWZpY2F0aW9uLCB0aGlzLm9yaWVudGF0aW9uRGlkQ2hhbmdlLmJpbmQodGhpcykpO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLCBcInJvb3RDb250cm9sbGVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fd2luZG93LnJvb3RWaWV3Q29udHJvbGxlcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJuYXRpdmVBcHBcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLCBcIndpbmRvd1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dpbmRvdztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJkZWxlZ2F0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RlbGVnYXRlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2RlbGVnYXRlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbGVnYXRlID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUsIFwicm9vdFZpZXdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yb290VmlldztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLmFkZE5vdGlmaWNhdGlvbk9ic2VydmVyID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbk5hbWUsIG9uUmVjZWl2ZUNhbGxiYWNrKSB7XG4gICAgICAgIHZhciBvYnNlcnZlciA9IE5vdGlmaWNhdGlvbk9ic2VydmVyLmluaXRXaXRoQ2FsbGJhY2sob25SZWNlaXZlQ2FsbGJhY2spO1xuICAgICAgICBOU05vdGlmaWNhdGlvbkNlbnRlci5kZWZhdWx0Q2VudGVyLmFkZE9ic2VydmVyU2VsZWN0b3JOYW1lT2JqZWN0KG9ic2VydmVyLCBcIm9uUmVjZWl2ZVwiLCBub3RpZmljYXRpb25OYW1lLCBudWxsKTtcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpO1xuICAgICAgICByZXR1cm4gb2JzZXJ2ZXI7XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUucmVtb3ZlTm90aWZpY2F0aW9uT2JzZXJ2ZXIgPSBmdW5jdGlvbiAob2JzZXJ2ZXIsIG5vdGlmaWNhdGlvbk5hbWUpIHtcbiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5fb2JzZXJ2ZXJzLmluZGV4T2Yob2JzZXJ2ZXIpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICBOU05vdGlmaWNhdGlvbkNlbnRlci5kZWZhdWx0Q2VudGVyLnJlbW92ZU9ic2VydmVyTmFtZU9iamVjdChvYnNlcnZlciwgbm90aWZpY2F0aW9uTmFtZSwgbnVsbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5kaWRGaW5pc2hMYXVuY2hpbmdXaXRoT3B0aW9ucyA9IGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgaWYgKCFkaXNwbGF5ZWRPbmNlKSB7XG4gICAgICAgICAgICBkaXNwbGF5ZWRMaW5rVGFyZ2V0ID0gQ0FEaXNwbGF5TGlua1RhcmdldC5uZXcoKTtcbiAgICAgICAgICAgIGRpc3BsYXllZExpbmsgPSBDQURpc3BsYXlMaW5rLmRpc3BsYXlMaW5rV2l0aFRhcmdldFNlbGVjdG9yKGRpc3BsYXllZExpbmtUYXJnZXQsIFwib25EaXNwbGF5ZWRcIik7XG4gICAgICAgICAgICBkaXNwbGF5ZWRMaW5rLmFkZFRvUnVuTG9vcEZvck1vZGUoTlNSdW5Mb29wLm1haW5SdW5Mb29wLCBOU0RlZmF1bHRSdW5Mb29wTW9kZSk7XG4gICAgICAgICAgICBkaXNwbGF5ZWRMaW5rLmFkZFRvUnVuTG9vcEZvck1vZGUoTlNSdW5Mb29wLm1haW5SdW5Mb29wLCBVSVRyYWNraW5nUnVuTG9vcE1vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3dpbmRvdyA9IFVJV2luZG93LmFsbG9jKCkuaW5pdFdpdGhGcmFtZShVSVNjcmVlbi5tYWluU2NyZWVuLmJvdW5kcyk7XG4gICAgICAgIHRoaXMuX3dpbmRvdy5iYWNrZ3JvdW5kQ29sb3IgPSBVSUNvbG9yLndoaXRlQ29sb3I7XG4gICAgICAgIHRoaXMubm90aWZ5QXBwU3RhcnRlZChub3RpZmljYXRpb24pO1xuICAgIH07XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLm5vdGlmeUFwcFN0YXJ0ZWQgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBhcHBsaWNhdGlvbl9jb21tb25fMS5sYXVuY2hFdmVudCxcbiAgICAgICAgICAgIG9iamVjdDogdGhpcyxcbiAgICAgICAgICAgIGlvczogbm90aWZpY2F0aW9uICYmIG5vdGlmaWNhdGlvbi51c2VySW5mbyAmJiBub3RpZmljYXRpb24udXNlckluZm8ub2JqZWN0Rm9yS2V5KFwiVUlBcHBsaWNhdGlvbkxhdW5jaE9wdGlvbnNMb2NhbE5vdGlmaWNhdGlvbktleVwiKSB8fCBudWxsXG4gICAgICAgIH07XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeShhcmdzKTtcbiAgICAgICAgYXBwbGljYXRpb25fY29tbW9uXzEubm90aWZ5KHsgZXZlbnROYW1lOiBcImxvYWRBcHBDc3NcIiwgb2JqZWN0OiB0aGlzLCBjc3NGaWxlOiBhcHBsaWNhdGlvbl9jb21tb25fMS5nZXRDc3NGaWxlTmFtZSgpIH0pO1xuICAgICAgICBpZiAodGhpcy5fd2luZG93KSB7XG4gICAgICAgICAgICB0aGlzLnNldFdpbmRvd0NvbnRlbnQoYXJncy5yb290KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3dpbmRvdyA9IFVJQXBwbGljYXRpb24uc2hhcmVkQXBwbGljYXRpb24uZGVsZWdhdGUud2luZG93O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUuZGlkQmVjb21lQWN0aXZlID0gZnVuY3Rpb24gKG5vdGlmaWNhdGlvbikge1xuICAgICAgICB2YXIgaW9zID0gVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbjtcbiAgICAgICAgdmFyIG9iamVjdCA9IHRoaXM7XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEucmVzdW1lRXZlbnQsIG9iamVjdDogb2JqZWN0LCBpb3M6IGlvcyB9KTtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIGlmIChyb290VmlldyAmJiAhcm9vdFZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHJvb3RWaWV3LmNhbGxMb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLmRpZEVudGVyQmFja2dyb3VuZCA9IGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgYXBwbGljYXRpb25fY29tbW9uXzEubm90aWZ5KHsgZXZlbnROYW1lOiBhcHBsaWNhdGlvbl9jb21tb25fMS5zdXNwZW5kRXZlbnQsIG9iamVjdDogdGhpcywgaW9zOiBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uIH0pO1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSB0aGlzLl9yb290VmlldztcbiAgICAgICAgaWYgKHJvb3RWaWV3ICYmIHJvb3RWaWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICByb290Vmlldy5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLndpbGxUZXJtaW5hdGUgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7IGV2ZW50TmFtZTogYXBwbGljYXRpb25fY29tbW9uXzEuZXhpdEV2ZW50LCBvYmplY3Q6IHRoaXMsIGlvczogVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbiB9KTtcbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gdGhpcy5fcm9vdFZpZXc7XG4gICAgICAgIGlmIChyb290VmlldyAmJiByb290Vmlldy5pc0xvYWRlZCkge1xuICAgICAgICAgICAgcm9vdFZpZXcuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5kaWRSZWNlaXZlTWVtb3J5V2FybmluZyA9IGZ1bmN0aW9uIChub3RpZmljYXRpb24pIHtcbiAgICAgICAgYXBwbGljYXRpb25fY29tbW9uXzEubm90aWZ5KHsgZXZlbnROYW1lOiBhcHBsaWNhdGlvbl9jb21tb25fMS5sb3dNZW1vcnlFdmVudCwgb2JqZWN0OiB0aGlzLCBpb3M6IFVJQXBwbGljYXRpb24uc2hhcmVkQXBwbGljYXRpb24gfSk7XG4gICAgfTtcbiAgICBJT1NBcHBsaWNhdGlvbi5wcm90b3R5cGUub3JpZW50YXRpb25EaWRDaGFuZ2UgPSBmdW5jdGlvbiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIHZhciBvcmllbnRhdGlvbiA9IFVJRGV2aWNlLmN1cnJlbnREZXZpY2Uub3JpZW50YXRpb247XG4gICAgICAgIGlmICh0aGlzLl9jdXJyZW50T3JpZW50YXRpb24gIT09IG9yaWVudGF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50T3JpZW50YXRpb24gPSBvcmllbnRhdGlvbjtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgIHN3aXRjaCAob3JpZW50YXRpb24pIHtcbiAgICAgICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IFwibGFuZHNjYXBlXCI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gXCJwb3J0cmFpdFwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IFwidW5rbm93blwiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLm5vdGlmeSh7XG4gICAgICAgICAgICAgICAgZXZlbnROYW1lOiBhcHBsaWNhdGlvbl9jb21tb25fMS5vcmllbnRhdGlvbkNoYW5nZWRFdmVudCxcbiAgICAgICAgICAgICAgICBpb3M6IHRoaXMsXG4gICAgICAgICAgICAgICAgbmV3VmFsdWU6IG5ld1ZhbHVlLFxuICAgICAgICAgICAgICAgIG9iamVjdDogdGhpc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5fb25MaXZlc3luYyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIHZhciBpc0FwcFJvb3RNb2R1bGVDaGFuZ2VkID0gY29udGV4dCAmJiBjb250ZXh0LnBhdGggJiYgY29udGV4dC5wYXRoLmluY2x1ZGVzKGdldE1haW5FbnRyeSgpLm1vZHVsZU5hbWUpICYmIGNvbnRleHQudHlwZSAhPT0gXCJzdHlsZVwiO1xuICAgICAgICBpZiAoaXNBcHBSb290TW9kdWxlQ2hhbmdlZCB8fCAodGhpcy5fcm9vdFZpZXcgJiYgIXRoaXMuX3Jvb3RWaWV3Ll9vbkxpdmVzeW5jKGNvbnRleHQpKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRXaW5kb3dDb250ZW50KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIElPU0FwcGxpY2F0aW9uLnByb3RvdHlwZS5zZXRXaW5kb3dDb250ZW50ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Jvb3RWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLl9yb290Vmlldy5fb25Sb290Vmlld1Jlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3RWaWV3ID0gY3JlYXRlUm9vdFZpZXcodmlldyk7XG4gICAgICAgIHZhciBjb250cm9sbGVyID0gZ2V0Vmlld0NvbnRyb2xsZXIocm9vdFZpZXcpO1xuICAgICAgICB0aGlzLl9yb290VmlldyA9IHJvb3RWaWV3O1xuICAgICAgICBpZiAoY3JlYXRlUm9vdEZyYW1lLnZhbHVlKSB7XG4gICAgICAgICAgICByb290Vmlldy5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByb290Vmlldy5fc2V0dXBBc1Jvb3RWaWV3KHt9KTtcbiAgICAgICAgfVxuICAgICAgICBzZXRWaWV3Q29udHJvbGxlclZpZXcocm9vdFZpZXcpO1xuICAgICAgICB2YXIgaGF2ZUNvbnRyb2xsZXIgPSB0aGlzLl93aW5kb3cucm9vdFZpZXdDb250cm9sbGVyICE9PSBudWxsO1xuICAgICAgICB0aGlzLl93aW5kb3cucm9vdFZpZXdDb250cm9sbGVyID0gY29udHJvbGxlcjtcbiAgICAgICAgaWYgKCFoYXZlQ29udHJvbGxlcikge1xuICAgICAgICAgICAgdGhpcy5fd2luZG93Lm1ha2VLZXlBbmRWaXNpYmxlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLCBcImRpZEZpbmlzaExhdW5jaGluZ1dpdGhPcHRpb25zXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgSU9TQXBwbGljYXRpb24ucHJvdG90eXBlLCBcImRpZEJlY29tZUFjdGl2ZVwiLCBudWxsKTtcbiAgICByZXR1cm4gSU9TQXBwbGljYXRpb247XG59KCkpO1xudmFyIGlvc0FwcCA9IG5ldyBJT1NBcHBsaWNhdGlvbigpO1xuZXhwb3J0cy5pb3MgPSBpb3NBcHA7XG5hcHBsaWNhdGlvbl9jb21tb25fMS5zZXRBcHBsaWNhdGlvbihpb3NBcHApO1xuZ2xvYmFsLl9fb25MaXZlU3luY0NvcmUgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgIGlvc0FwcC5fb25MaXZlc3luYyhjb250ZXh0KTtcbn07XG52YXIgbWFpbkVudHJ5O1xuZnVuY3Rpb24gY3JlYXRlUm9vdFZpZXcodikge1xuICAgIHZhciByb290VmlldyA9IHY7XG4gICAgaWYgKCFyb290Vmlldykge1xuICAgICAgICBpZiAoIW1haW5FbnRyeSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWFpbiBlbnRyeSBpcyBtaXNzaW5nLiBBcHAgY2Fubm90IGJlIHN0YXJ0ZWQuIFZlcmlmeSBhcHAgYm9vdHN0cmFwLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjcmVhdGVSb290RnJhbWUudmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSByb290VmlldyA9IG5ldyBmcmFtZV8xLkZyYW1lKCk7XG4gICAgICAgICAgICAgICAgZnJhbWUubmF2aWdhdGUobWFpbkVudHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJvb3RWaWV3ID0gYnVpbGRlcl8xLmNyZWF0ZVZpZXdGcm9tRW50cnkobWFpbkVudHJ5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcm9vdFZpZXc7XG59XG5mdW5jdGlvbiBnZXRNYWluRW50cnkoKSB7XG4gICAgcmV0dXJuIG1haW5FbnRyeTtcbn1cbmV4cG9ydHMuZ2V0TWFpbkVudHJ5ID0gZ2V0TWFpbkVudHJ5O1xuZnVuY3Rpb24gZ2V0Um9vdFZpZXcoKSB7XG4gICAgcmV0dXJuIGlvc0FwcC5yb290Vmlldztcbn1cbmV4cG9ydHMuZ2V0Um9vdFZpZXcgPSBnZXRSb290VmlldztcbnZhciBjcmVhdGVSb290RnJhbWUgPSB7IHZhbHVlOiB0cnVlIH07XG52YXIgc3RhcnRlZCA9IGZhbHNlO1xuZnVuY3Rpb24gX3N0YXJ0KGVudHJ5KSB7XG4gICAgbWFpbkVudHJ5ID0gdHlwZW9mIGVudHJ5ID09PSBcInN0cmluZ1wiID8geyBtb2R1bGVOYW1lOiBlbnRyeSB9IDogZW50cnk7XG4gICAgc3RhcnRlZCA9IHRydWU7XG4gICAgaWYgKCFpb3NBcHAubmF0aXZlQXBwKSB7XG4gICAgICAgIFVJQXBwbGljYXRpb25NYWluKDAsIG51bGwsIG51bGwsIGlvc0FwcCAmJiBpb3NBcHAuZGVsZWdhdGUgPyBOU1N0cmluZ0Zyb21DbGFzcyhpb3NBcHAuZGVsZWdhdGUpIDogTlNTdHJpbmdGcm9tQ2xhc3MoUmVzcG9uZGVyKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSBjcmVhdGVSb290VmlldygpO1xuICAgICAgICBpZiAocm9vdFZpZXcpIHtcbiAgICAgICAgICAgIHZhciB3aW5kb3dfMSA9IGlvc0FwcC5uYXRpdmVBcHAua2V5V2luZG93IHx8IChpb3NBcHAubmF0aXZlQXBwLndpbmRvd3MuY291bnQgPiAwICYmIGlvc0FwcC5uYXRpdmVBcHAud2luZG93c1swXSk7XG4gICAgICAgICAgICBpZiAod2luZG93XzEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm9vdENvbnRyb2xsZXIgPSB3aW5kb3dfMS5yb290Vmlld0NvbnRyb2xsZXI7XG4gICAgICAgICAgICAgICAgaWYgKHJvb3RDb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb250cm9sbGVyID0gZ2V0Vmlld0NvbnRyb2xsZXIocm9vdFZpZXcpO1xuICAgICAgICAgICAgICAgICAgICByb290Vmlldy5fc2V0dXBBc1Jvb3RWaWV3KHt9KTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVtYmVkZGVyRGVsZWdhdGUgPSBOYXRpdmVTY3JpcHRFbWJlZGRlci5zaGFyZWRJbnN0YW5jZSgpLmRlbGVnYXRlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW1iZWRkZXJEZWxlZ2F0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW1iZWRkZXJEZWxlZ2F0ZS5wcmVzZW50TmF0aXZlU2NyaXB0QXBwKGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZpc2libGVWQyA9IGdldFZpc2libGVWaWV3Q29udHJvbGxlcihyb290Q29udHJvbGxlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aXNpYmxlVkMucHJlc2VudFZpZXdDb250cm9sbGVyQW5pbWF0ZWRDb21wbGV0aW9uKGNvbnRyb2xsZXIsIHRydWUsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlvc0FwcC5ub3RpZnlBcHBTdGFydGVkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5fc3RhcnQgPSBfc3RhcnQ7XG5mdW5jdGlvbiBydW4oZW50cnkpIHtcbiAgICBjcmVhdGVSb290RnJhbWUudmFsdWUgPSBmYWxzZTtcbiAgICBfc3RhcnQoZW50cnkpO1xufVxuZXhwb3J0cy5ydW4gPSBydW47XG5mdW5jdGlvbiBfcmVzZXRSb290VmlldyhlbnRyeSkge1xuICAgIGNyZWF0ZVJvb3RGcmFtZS52YWx1ZSA9IGZhbHNlO1xuICAgIG1haW5FbnRyeSA9IHR5cGVvZiBlbnRyeSA9PT0gXCJzdHJpbmdcIiA/IHsgbW9kdWxlTmFtZTogZW50cnkgfSA6IGVudHJ5O1xuICAgIGlvc0FwcC5zZXRXaW5kb3dDb250ZW50KCk7XG59XG5leHBvcnRzLl9yZXNldFJvb3RWaWV3ID0gX3Jlc2V0Um9vdFZpZXc7XG5mdW5jdGlvbiBnZXROYXRpdmVBcHBsaWNhdGlvbigpIHtcbiAgICByZXR1cm4gaW9zQXBwLm5hdGl2ZUFwcDtcbn1cbmV4cG9ydHMuZ2V0TmF0aXZlQXBwbGljYXRpb24gPSBnZXROYXRpdmVBcHBsaWNhdGlvbjtcbmZ1bmN0aW9uIGdldFZpZXdDb250cm9sbGVyKHZpZXcpIHtcbiAgICB2YXIgdmlld0NvbnRyb2xsZXIgPSB2aWV3LnZpZXdDb250cm9sbGVyIHx8IHZpZXcuaW9zO1xuICAgIGlmICh2aWV3Q29udHJvbGxlciBpbnN0YW5jZW9mIFVJVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgcmV0dXJuIHZpZXdDb250cm9sbGVyO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdmlld0NvbnRyb2xsZXIgPSB2aWV3XzEuaW9zLlVJTGF5b3V0Vmlld0NvbnRyb2xsZXIuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih2aWV3KSk7XG4gICAgICAgIHZpZXcudmlld0NvbnRyb2xsZXIgPSB2aWV3Q29udHJvbGxlcjtcbiAgICAgICAgcmV0dXJuIHZpZXdDb250cm9sbGVyO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNldFZpZXdDb250cm9sbGVyVmlldyh2aWV3KSB7XG4gICAgdmFyIHZpZXdDb250cm9sbGVyID0gdmlldy52aWV3Q29udHJvbGxlciB8fCB2aWV3LmlvcztcbiAgICB2YXIgbmF0aXZlVmlldyA9IHZpZXcuaW9zIHx8IHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICBpZiAoIW5hdGl2ZVZpZXcgfHwgIXZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJvb3Qgc2hvdWxkIGJlIGVpdGhlciBVSVZpZXdDb250cm9sbGVyIG9yIFVJVmlld1wiKTtcbiAgICB9XG4gICAgaWYgKHZpZXdDb250cm9sbGVyIGluc3RhbmNlb2Ygdmlld18xLmlvcy5VSUxheW91dFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgIHZpZXdDb250cm9sbGVyLnZpZXcuYWRkU3VidmlldyhuYXRpdmVWaWV3KTtcbiAgICB9XG59XG5nbG9iYWwuX19vbkxpdmVTeW5jID0gZnVuY3Rpb24gX19vbkxpdmVTeW5jKGNvbnRleHQpIHtcbiAgICBpZiAoIXN0YXJ0ZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcm9vdFZpZXcgPSBnZXRSb290VmlldygpO1xuICAgIGFwcGxpY2F0aW9uX2NvbW1vbl8xLmxpdmVzeW5jKHJvb3RWaWV3LCBjb250ZXh0KTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHBsaWNhdGlvbi5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGtub3duQ29sb3JzID0gcmVxdWlyZShcIi4va25vd24tY29sb3JzXCIpO1xudmFyIFNIQVJQID0gXCIjXCI7XG52YXIgSEVYX1JFR0VYID0gLyheI1swLTlBLUZdezZ9JCl8KF4jWzAtOUEtRl17M30kKXwoXiNbMC05QS1GXXs4fSQpL2k7XG52YXIgQ29sb3IgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbG9yKCkge1xuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc1N0cmluZyhhcmcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlzUmdiT3JSZ2JhKGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IGFyZ2JGcm9tUmdiT3JSZ2JhKGFyZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGtub3duQ29sb3JzLmlzS25vd25OYW1lKGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhleCA9IGtub3duQ29sb3JzLmdldEtub3duQ29sb3IoYXJnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbmFtZSA9IGFyZztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IHRoaXMuX2FyZ2JGcm9tU3RyaW5nKGhleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKEhFWF9SRUdFWC50ZXN0KGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGhleCA9IHRoaXMuX25vcm1hbGl6ZUhleChhcmcpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hcmdiID0gdGhpcy5fYXJnYkZyb21TdHJpbmcoaGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgY29sb3I6IFwiICsgYXJnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlcy5pc051bWJlcihhcmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJnYiA9IGFyZyA+Pj4gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEgb3IgNCBjb25zdHJ1Y3RvciBwYXJhbWV0ZXJzLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICB0aGlzLl9hcmdiID0gKGFyZ3VtZW50c1swXSAmIDB4RkYpICogMHgwMTAwMDAwMFxuICAgICAgICAgICAgICAgICsgKGFyZ3VtZW50c1sxXSAmIDB4RkYpICogMHgwMDAxMDAwMFxuICAgICAgICAgICAgICAgICsgKGFyZ3VtZW50c1syXSAmIDB4RkYpICogMHgwMDAwMDEwMFxuICAgICAgICAgICAgICAgICsgKGFyZ3VtZW50c1szXSAmIDB4RkYpICogMHgwMDAwMDAwMTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEgb3IgNCBjb25zdHJ1Y3RvciBwYXJhbWV0ZXJzLlwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMTAwMDAwMCkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcInJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMDAxMDAwMCkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMDAwMDEwMCkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICh0aGlzLl9hcmdiIC8gMHgwMDAwMDAwMSkgJiAweEZGOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImFyZ2JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcmdiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImhleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuYSA9PT0gMHhGRikge1xuICAgICAgICAgICAgICAgIHJldHVybiAoXCIjXCIgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLnIpICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5nKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMuYikpLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFwiI1wiICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5hKSArIHRoaXMuX2NvbXBvbmVudFRvSGV4KHRoaXMucikgKyB0aGlzLl9jb21wb25lbnRUb0hleCh0aGlzLmcpICsgdGhpcy5fY29tcG9uZW50VG9IZXgodGhpcy5iKSkudG9VcHBlckNhc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbG9yLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDb2xvci5wcm90b3R5cGUsIFwiYW5kcm9pZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ29sb3IucHJvdG90eXBlLl9hcmdiRnJvbVN0cmluZyA9IGZ1bmN0aW9uIChoZXgpIHtcbiAgICAgICAgaWYgKGhleC5jaGFyQXQoMCkgPT09IFwiI1wiKSB7XG4gICAgICAgICAgICBoZXggPSBoZXguc3Vic3RyKDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChoZXgubGVuZ3RoID09PSAzKSB7XG4gICAgICAgICAgICBoZXggPSBoZXhbMF0gKyBoZXhbMF0gKyBoZXhbMV0gKyBoZXhbMV0gKyBoZXhbMl0gKyBoZXhbMl07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoaGV4Lmxlbmd0aCA9PT0gNCkge1xuICAgICAgICAgICAgaGV4ID0gaGV4WzBdICsgaGV4WzBdICsgaGV4WzFdICsgaGV4WzFdICsgaGV4WzJdICsgaGV4WzJdICsgaGV4WzNdICsgaGV4WzNdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpbnRWYWwgPSBwYXJzZUludChoZXgsIDE2KTtcbiAgICAgICAgaWYgKGhleC5sZW5ndGggPT09IDYpIHtcbiAgICAgICAgICAgIGludFZhbCA9IChpbnRWYWwgJiAweDAwRkZGRkZGKSArIDB4RkYwMDAwMDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGludFZhbDtcbiAgICB9O1xuICAgIENvbG9yLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlICYmIHRoaXMuYXJnYiA9PT0gdmFsdWUuYXJnYjtcbiAgICB9O1xuICAgIENvbG9yLmVxdWFscyA9IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAoIXZhbHVlMSAmJiAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlMSB8fCAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlMS5lcXVhbHModmFsdWUyKTtcbiAgICB9O1xuICAgIENvbG9yLmlzVmFsaWQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzTnVsbE9yVW5kZWZpbmVkKHZhbHVlKSB8fCB2YWx1ZSBpbnN0YW5jZW9mIENvbG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChrbm93bkNvbG9ycy5pc0tub3duTmFtZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBIRVhfUkVHRVgudGVzdCh2YWx1ZSkgfHwgaXNSZ2JPclJnYmEodmFsdWUpO1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLl9jb21wb25lbnRUb0hleCA9IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICAgICAgdmFyIGhleCA9IGNvbXBvbmVudC50b1N0cmluZygxNik7XG4gICAgICAgIGlmIChoZXgubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBoZXggPSBcIjBcIiArIGhleDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGV4O1xuICAgIH07XG4gICAgQ29sb3IucHJvdG90eXBlLl9ub3JtYWxpemVIZXggPSBmdW5jdGlvbiAoaGV4U3RyKSB7XG4gICAgICAgIGlmIChoZXhTdHIuY2hhckF0KDApID09PSBTSEFSUCAmJiBoZXhTdHIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgICAgICBoZXhTdHIgPSBoZXhTdHIuY2hhckF0KDApXG4gICAgICAgICAgICAgICAgKyBoZXhTdHIuY2hhckF0KDEpICsgaGV4U3RyLmNoYXJBdCgxKVxuICAgICAgICAgICAgICAgICsgaGV4U3RyLmNoYXJBdCgyKSArIGhleFN0ci5jaGFyQXQoMilcbiAgICAgICAgICAgICAgICArIGhleFN0ci5jaGFyQXQoMykgKyBoZXhTdHIuY2hhckF0KDMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoZXhTdHI7XG4gICAgfTtcbiAgICBDb2xvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhleDtcbiAgICB9O1xuICAgIHJldHVybiBDb2xvcjtcbn0oKSk7XG5leHBvcnRzLkNvbG9yID0gQ29sb3I7XG5mdW5jdGlvbiBpc1JnYk9yUmdiYSh2YWx1ZSkge1xuICAgIHZhciB0b0xvd2VyID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICByZXR1cm4gKHRvTG93ZXIuaW5kZXhPZihcInJnYihcIikgPT09IDAgfHwgdG9Mb3dlci5pbmRleE9mKFwicmdiYShcIikgPT09IDApICYmIHRvTG93ZXIuaW5kZXhPZihcIilcIikgPT09ICh0b0xvd2VyLmxlbmd0aCAtIDEpO1xufVxuZnVuY3Rpb24gYXJnYkZyb21SZ2JPclJnYmEodmFsdWUpIHtcbiAgICB2YXIgdG9Mb3dlciA9IHZhbHVlLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFyIHBhcnRzID0gdG9Mb3dlci5yZXBsYWNlKFwicmdiYShcIiwgXCJcIikucmVwbGFjZShcInJnYihcIiwgXCJcIikucmVwbGFjZShcIilcIiwgXCJcIikudHJpbSgpLnNwbGl0KFwiLFwiKTtcbiAgICB2YXIgciA9IDI1NTtcbiAgICB2YXIgZyA9IDI1NTtcbiAgICB2YXIgYiA9IDI1NTtcbiAgICB2YXIgYSA9IDI1NTtcbiAgICBpZiAocGFydHNbMF0pIHtcbiAgICAgICAgciA9IHBhcnNlSW50KHBhcnRzWzBdLnRyaW0oKSk7XG4gICAgfVxuICAgIGlmIChwYXJ0c1sxXSkge1xuICAgICAgICBnID0gcGFyc2VJbnQocGFydHNbMV0udHJpbSgpKTtcbiAgICB9XG4gICAgaWYgKHBhcnRzWzJdKSB7XG4gICAgICAgIGIgPSBwYXJzZUludChwYXJ0c1syXS50cmltKCkpO1xuICAgIH1cbiAgICBpZiAocGFydHNbM10pIHtcbiAgICAgICAgYSA9IE1hdGgucm91bmQocGFyc2VGbG9hdChwYXJ0c1szXS50cmltKCkpICogMjU1KTtcbiAgICB9XG4gICAgcmV0dXJuIChhICYgMHhGRikgKiAweDAxMDAwMDAwXG4gICAgICAgICsgKHIgJiAweEZGKSAqIDB4MDAwMTAwMDBcbiAgICAgICAgKyAoZyAmIDB4RkYpICogMHgwMDAwMDEwMFxuICAgICAgICArIChiICYgMHhGRikgKiAweDAwMDAwMDAxO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29sb3ItY29tbW9uLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb21tb24gPSByZXF1aXJlKFwiLi9jb2xvci1jb21tb25cIik7XG52YXIgQ29sb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb2xvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2xvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ29sb3IucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9pb3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb3MgPSBVSUNvbG9yLmFsbG9jKCkuaW5pdFdpdGhSZWRHcmVlbkJsdWVBbHBoYSh0aGlzLnIgLyAyNTUsIHRoaXMuZyAvIDI1NSwgdGhpcy5iIC8gMjU1LCB0aGlzLmEgLyAyNTUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lvcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIENvbG9yO1xufShjb21tb24uQ29sb3IpKTtcbmV4cG9ydHMuQ29sb3IgPSBDb2xvcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbG9yLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgX2FsbENvbG9ycyA9IHt9O1xuZnVuY3Rpb24gcmVnaXN0ZXJDb2xvcihuYW1lLCB2YWx1ZSkge1xuICAgIF9hbGxDb2xvcnNbbmFtZS50b0xvd2VyQ2FzZSgpXSA9IHZhbHVlO1xuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGlzS25vd25OYW1lKG5hbWUpIHtcbiAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKSBpbiBfYWxsQ29sb3JzO1xufVxuZXhwb3J0cy5pc0tub3duTmFtZSA9IGlzS25vd25OYW1lO1xuZnVuY3Rpb24gZ2V0S25vd25Db2xvcihuYW1lKSB7XG4gICAgaWYgKCFuYW1lKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIHJldHVybiBfYWxsQ29sb3JzW25hbWUudG9Mb3dlckNhc2UoKV07XG59XG5leHBvcnRzLmdldEtub3duQ29sb3IgPSBnZXRLbm93bkNvbG9yO1xuZXhwb3J0cy5UcmFuc3BhcmVudCA9IHJlZ2lzdGVyQ29sb3IoXCJUcmFuc3BhcmVudFwiLCBcIiMwMDAwMDAwMFwiKTtcbmV4cG9ydHMuQWxpY2VCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkFsaWNlQmx1ZVwiLCBcIiNGMEY4RkZcIik7XG5leHBvcnRzLkFudGlxdWVXaGl0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJBbnRpcXVlV2hpdGVcIiwgXCIjRkFFQkQ3XCIpO1xuZXhwb3J0cy5BcXVhID0gcmVnaXN0ZXJDb2xvcihcIkFxdWFcIiwgXCIjMDBGRkZGXCIpO1xuZXhwb3J0cy5BcXVhbWFyaW5lID0gcmVnaXN0ZXJDb2xvcihcIkFxdWFtYXJpbmVcIiwgXCIjN0ZGRkQ0XCIpO1xuZXhwb3J0cy5BenVyZSA9IHJlZ2lzdGVyQ29sb3IoXCJBenVyZVwiLCBcIiNGMEZGRkZcIik7XG5leHBvcnRzLkJlaWdlID0gcmVnaXN0ZXJDb2xvcihcIkJlaWdlXCIsIFwiI0Y1RjVEQ1wiKTtcbmV4cG9ydHMuQmlzcXVlID0gcmVnaXN0ZXJDb2xvcihcIkJpc3F1ZVwiLCBcIiNGRkU0QzRcIik7XG5leHBvcnRzLkJsYWNrID0gcmVnaXN0ZXJDb2xvcihcIkJsYWNrXCIsIFwiIzAwMDAwMFwiKTtcbmV4cG9ydHMuQmxhbmNoZWRBbG1vbmQgPSByZWdpc3RlckNvbG9yKFwiQmxhbmNoZWRBbG1vbmRcIiwgXCIjRkZFQkNEXCIpO1xuZXhwb3J0cy5CbHVlID0gcmVnaXN0ZXJDb2xvcihcIkJsdWVcIiwgXCIjMDAwMEZGXCIpO1xuZXhwb3J0cy5CbHVlVmlvbGV0ID0gcmVnaXN0ZXJDb2xvcihcIkJsdWVWaW9sZXRcIiwgXCIjOEEyQkUyXCIpO1xuZXhwb3J0cy5Ccm93biA9IHJlZ2lzdGVyQ29sb3IoXCJCcm93blwiLCBcIiNBNTJBMkFcIik7XG5leHBvcnRzLkJ1cmx5V29vZCA9IHJlZ2lzdGVyQ29sb3IoXCJCdXJseVdvb2RcIiwgXCIjREVCODg3XCIpO1xuZXhwb3J0cy5DYWRldEJsdWUgPSByZWdpc3RlckNvbG9yKFwiQ2FkZXRCbHVlXCIsIFwiIzVGOUVBMFwiKTtcbmV4cG9ydHMuQ2hhcnRyZXVzZSA9IHJlZ2lzdGVyQ29sb3IoXCJDaGFydHJldXNlXCIsIFwiIzdGRkYwMFwiKTtcbmV4cG9ydHMuQ2hvY29sYXRlID0gcmVnaXN0ZXJDb2xvcihcIkNob2NvbGF0ZVwiLCBcIiNEMjY5MUVcIik7XG5leHBvcnRzLkNvcmFsID0gcmVnaXN0ZXJDb2xvcihcIkNvcmFsXCIsIFwiI0ZGN0Y1MFwiKTtcbmV4cG9ydHMuQ29ybmZsb3dlckJsdWUgPSByZWdpc3RlckNvbG9yKFwiQ29ybmZsb3dlckJsdWVcIiwgXCIjNjQ5NUVEXCIpO1xuZXhwb3J0cy5Db3Juc2lsayA9IHJlZ2lzdGVyQ29sb3IoXCJDb3Juc2lsa1wiLCBcIiNGRkY4RENcIik7XG5leHBvcnRzLkNyaW1zb24gPSByZWdpc3RlckNvbG9yKFwiQ3JpbXNvblwiLCBcIiNEQzE0M0NcIik7XG5leHBvcnRzLkN5YW4gPSByZWdpc3RlckNvbG9yKFwiQ3lhblwiLCBcIiMwMEZGRkZcIik7XG5leHBvcnRzLkRhcmtCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtCbHVlXCIsIFwiIzAwMDA4QlwiKTtcbmV4cG9ydHMuRGFya0N5YW4gPSByZWdpc3RlckNvbG9yKFwiRGFya0N5YW5cIiwgXCIjMDA4QjhCXCIpO1xuZXhwb3J0cy5EYXJrR29sZGVuUm9kID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtHb2xkZW5Sb2RcIiwgXCIjQjg4NjBCXCIpO1xuZXhwb3J0cy5EYXJrR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrR3JheVwiLCBcIiNBOUE5QTlcIik7XG5leHBvcnRzLkRhcmtHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrR3JlZW5cIiwgXCIjMDA2NDAwXCIpO1xuZXhwb3J0cy5EYXJrS2hha2kgPSByZWdpc3RlckNvbG9yKFwiRGFya0toYWtpXCIsIFwiI0JEQjc2QlwiKTtcbmV4cG9ydHMuRGFya01hZ2VudGEgPSByZWdpc3RlckNvbG9yKFwiRGFya01hZ2VudGFcIiwgXCIjOEIwMDhCXCIpO1xuZXhwb3J0cy5EYXJrT2xpdmVHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrT2xpdmVHcmVlblwiLCBcIiM1NTZCMkZcIik7XG5leHBvcnRzLkRhcmtPcmFuZ2UgPSByZWdpc3RlckNvbG9yKFwiRGFya09yYW5nZVwiLCBcIiNGRjhDMDBcIik7XG5leHBvcnRzLkRhcmtPcmNoaWQgPSByZWdpc3RlckNvbG9yKFwiRGFya09yY2hpZFwiLCBcIiM5OTMyQ0NcIik7XG5leHBvcnRzLkRhcmtSZWQgPSByZWdpc3RlckNvbG9yKFwiRGFya1JlZFwiLCBcIiM4QjAwMDBcIik7XG5leHBvcnRzLkRhcmtTYWxtb24gPSByZWdpc3RlckNvbG9yKFwiRGFya1NhbG1vblwiLCBcIiNFOTk2N0FcIik7XG5leHBvcnRzLkRhcmtTZWFHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJEYXJrU2VhR3JlZW5cIiwgXCIjOEZCQzhGXCIpO1xuZXhwb3J0cy5EYXJrU2xhdGVCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtTbGF0ZUJsdWVcIiwgXCIjNDgzRDhCXCIpO1xuZXhwb3J0cy5EYXJrU2xhdGVHcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtTbGF0ZUdyYXlcIiwgXCIjMkY0RjRGXCIpO1xuZXhwb3J0cy5EYXJrVHVycXVvaXNlID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtUdXJxdW9pc2VcIiwgXCIjMDBDRUQxXCIpO1xuZXhwb3J0cy5EYXJrVmlvbGV0ID0gcmVnaXN0ZXJDb2xvcihcIkRhcmtWaW9sZXRcIiwgXCIjOTQwMEQzXCIpO1xuZXhwb3J0cy5EZWVwUGluayA9IHJlZ2lzdGVyQ29sb3IoXCJEZWVwUGlua1wiLCBcIiNGRjE0OTNcIik7XG5leHBvcnRzLkRlZXBTa3lCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkRlZXBTa3lCbHVlXCIsIFwiIzAwQkZGRlwiKTtcbmV4cG9ydHMuRGltR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJEaW1HcmF5XCIsIFwiIzY5Njk2OVwiKTtcbmV4cG9ydHMuRG9kZ2VyQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJEb2RnZXJCbHVlXCIsIFwiIzFFOTBGRlwiKTtcbmV4cG9ydHMuRmlyZUJyaWNrID0gcmVnaXN0ZXJDb2xvcihcIkZpcmVCcmlja1wiLCBcIiNCMjIyMjJcIik7XG5leHBvcnRzLkZsb3JhbFdoaXRlID0gcmVnaXN0ZXJDb2xvcihcIkZsb3JhbFdoaXRlXCIsIFwiI0ZGRkFGMFwiKTtcbmV4cG9ydHMuRm9yZXN0R3JlZW4gPSByZWdpc3RlckNvbG9yKFwiRm9yZXN0R3JlZW5cIiwgXCIjMjI4QjIyXCIpO1xuZXhwb3J0cy5GdWNoc2lhID0gcmVnaXN0ZXJDb2xvcihcIkZ1Y2hzaWFcIiwgXCIjRkYwMEZGXCIpO1xuZXhwb3J0cy5HYWluc2Jvcm8gPSByZWdpc3RlckNvbG9yKFwiR2FpbnNib3JvXCIsIFwiI0RDRENEQ1wiKTtcbmV4cG9ydHMuR2hvc3RXaGl0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJHaG9zdFdoaXRlXCIsIFwiI0Y4RjhGRlwiKTtcbmV4cG9ydHMuR29sZCA9IHJlZ2lzdGVyQ29sb3IoXCJHb2xkXCIsIFwiI0ZGRDcwMFwiKTtcbmV4cG9ydHMuR29sZGVuUm9kID0gcmVnaXN0ZXJDb2xvcihcIkdvbGRlblJvZFwiLCBcIiNEQUE1MjBcIik7XG5leHBvcnRzLkdyYXkgPSByZWdpc3RlckNvbG9yKFwiR3JheVwiLCBcIiM4MDgwODBcIik7XG5leHBvcnRzLkdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkdyZWVuXCIsIFwiIzAwODAwMFwiKTtcbmV4cG9ydHMuR3JlZW5ZZWxsb3cgPSByZWdpc3RlckNvbG9yKFwiR3JlZW5ZZWxsb3dcIiwgXCIjQURGRjJGXCIpO1xuZXhwb3J0cy5Ib25leURldyA9IHJlZ2lzdGVyQ29sb3IoXCJIb25leURld1wiLCBcIiNGMEZGRjBcIik7XG5leHBvcnRzLkhvdFBpbmsgPSByZWdpc3RlckNvbG9yKFwiSG90UGlua1wiLCBcIiNGRjY5QjRcIik7XG5leHBvcnRzLkluZGlhblJlZCA9IHJlZ2lzdGVyQ29sb3IoXCJJbmRpYW5SZWRcIiwgXCIjQ0Q1QzVDXCIpO1xuZXhwb3J0cy5JbmRpZ28gPSByZWdpc3RlckNvbG9yKFwiSW5kaWdvXCIsIFwiIzRCMDA4MlwiKTtcbmV4cG9ydHMuSXZvcnkgPSByZWdpc3RlckNvbG9yKFwiSXZvcnlcIiwgXCIjRkZGRkYwXCIpO1xuZXhwb3J0cy5LaGFraSA9IHJlZ2lzdGVyQ29sb3IoXCJLaGFraVwiLCBcIiNGMEU2OENcIik7XG5leHBvcnRzLkxhdmVuZGVyID0gcmVnaXN0ZXJDb2xvcihcIkxhdmVuZGVyXCIsIFwiI0U2RTZGQVwiKTtcbmV4cG9ydHMuTGF2ZW5kZXJCbHVzaCA9IHJlZ2lzdGVyQ29sb3IoXCJMYXZlbmRlckJsdXNoXCIsIFwiI0ZGRjBGNVwiKTtcbmV4cG9ydHMuTGF3bkdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIkxhd25HcmVlblwiLCBcIiM3Q0ZDMDBcIik7XG5leHBvcnRzLkxlbW9uQ2hpZmZvbiA9IHJlZ2lzdGVyQ29sb3IoXCJMZW1vbkNoaWZmb25cIiwgXCIjRkZGQUNEXCIpO1xuZXhwb3J0cy5MaWdodEJsdWUgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRCbHVlXCIsIFwiI0FERDhFNlwiKTtcbmV4cG9ydHMuTGlnaHRDb3JhbCA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodENvcmFsXCIsIFwiI0YwODA4MFwiKTtcbmV4cG9ydHMuTGlnaHRDeWFuID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0Q3lhblwiLCBcIiNFMEZGRkZcIik7XG5leHBvcnRzLkxpZ2h0R29sZGVuUm9kWWVsbG93ID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0R29sZGVuUm9kWWVsbG93XCIsIFwiI0ZBRkFEMlwiKTtcbmV4cG9ydHMuTGlnaHRHcmF5ID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0R3JheVwiLCBcIiNEM0QzRDNcIik7XG5leHBvcnRzLkxpZ2h0R3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTGlnaHRHcmVlblwiLCBcIiM5MEVFOTBcIik7XG5leHBvcnRzLkxpZ2h0UGluayA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFBpbmtcIiwgXCIjRkZCNkMxXCIpO1xuZXhwb3J0cy5MaWdodFNhbG1vbiA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFNhbG1vblwiLCBcIiNGRkEwN0FcIik7XG5leHBvcnRzLkxpZ2h0U2VhR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTGlnaHRTZWFHcmVlblwiLCBcIiMyMEIyQUFcIik7XG5leHBvcnRzLkxpZ2h0U2t5Qmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFNreUJsdWVcIiwgXCIjODdDRUZBXCIpO1xuZXhwb3J0cy5MaWdodFNsYXRlR3JheSA9IHJlZ2lzdGVyQ29sb3IoXCJMaWdodFNsYXRlR3JheVwiLCBcIiM3Nzg4OTlcIik7XG5leHBvcnRzLkxpZ2h0U3RlZWxCbHVlID0gcmVnaXN0ZXJDb2xvcihcIkxpZ2h0U3RlZWxCbHVlXCIsIFwiI0IwQzRERVwiKTtcbmV4cG9ydHMuTGlnaHRZZWxsb3cgPSByZWdpc3RlckNvbG9yKFwiTGlnaHRZZWxsb3dcIiwgXCIjRkZGRkUwXCIpO1xuZXhwb3J0cy5MaW1lID0gcmVnaXN0ZXJDb2xvcihcIkxpbWVcIiwgXCIjMDBGRjAwXCIpO1xuZXhwb3J0cy5MaW1lR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiTGltZUdyZWVuXCIsIFwiIzMyQ0QzMlwiKTtcbmV4cG9ydHMuTGluZW4gPSByZWdpc3RlckNvbG9yKFwiTGluZW5cIiwgXCIjRkFGMEU2XCIpO1xuZXhwb3J0cy5NYWdlbnRhID0gcmVnaXN0ZXJDb2xvcihcIk1hZ2VudGFcIiwgXCIjRkYwMEZGXCIpO1xuZXhwb3J0cy5NYXJvb24gPSByZWdpc3RlckNvbG9yKFwiTWFyb29uXCIsIFwiIzgwMDAwMFwiKTtcbmV4cG9ydHMuTWVkaXVtQXF1YU1hcmluZSA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1BcXVhTWFyaW5lXCIsIFwiIzY2Q0RBQVwiKTtcbmV4cG9ydHMuTWVkaXVtQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1CbHVlXCIsIFwiIzAwMDBDRFwiKTtcbmV4cG9ydHMuTWVkaXVtT3JjaGlkID0gcmVnaXN0ZXJDb2xvcihcIk1lZGl1bU9yY2hpZFwiLCBcIiNCQTU1RDNcIik7XG5leHBvcnRzLk1lZGl1bVB1cnBsZSA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1QdXJwbGVcIiwgXCIjOTM3MERCXCIpO1xuZXhwb3J0cy5NZWRpdW1TZWFHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1TZWFHcmVlblwiLCBcIiMzQ0IzNzFcIik7XG5leHBvcnRzLk1lZGl1bVNsYXRlQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1TbGF0ZUJsdWVcIiwgXCIjN0I2OEVFXCIpO1xuZXhwb3J0cy5NZWRpdW1TcHJpbmdHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1TcHJpbmdHcmVlblwiLCBcIiMwMEZBOUFcIik7XG5leHBvcnRzLk1lZGl1bVR1cnF1b2lzZSA9IHJlZ2lzdGVyQ29sb3IoXCJNZWRpdW1UdXJxdW9pc2VcIiwgXCIjNDhEMUNDXCIpO1xuZXhwb3J0cy5NZWRpdW1WaW9sZXRSZWQgPSByZWdpc3RlckNvbG9yKFwiTWVkaXVtVmlvbGV0UmVkXCIsIFwiI0M3MTU4NVwiKTtcbmV4cG9ydHMuTWlkbmlnaHRCbHVlID0gcmVnaXN0ZXJDb2xvcihcIk1pZG5pZ2h0Qmx1ZVwiLCBcIiMxOTE5NzBcIik7XG5leHBvcnRzLk1pbnRDcmVhbSA9IHJlZ2lzdGVyQ29sb3IoXCJNaW50Q3JlYW1cIiwgXCIjRjVGRkZBXCIpO1xuZXhwb3J0cy5NaXN0eVJvc2UgPSByZWdpc3RlckNvbG9yKFwiTWlzdHlSb3NlXCIsIFwiI0ZGRTRFMVwiKTtcbmV4cG9ydHMuTW9jY2FzaW4gPSByZWdpc3RlckNvbG9yKFwiTW9jY2FzaW5cIiwgXCIjRkZFNEI1XCIpO1xuZXhwb3J0cy5OYXZham9XaGl0ZSA9IHJlZ2lzdGVyQ29sb3IoXCJOYXZham9XaGl0ZVwiLCBcIiNGRkRFQURcIik7XG5leHBvcnRzLk5hdnkgPSByZWdpc3RlckNvbG9yKFwiTmF2eVwiLCBcIiMwMDAwODBcIik7XG5leHBvcnRzLk9sZExhY2UgPSByZWdpc3RlckNvbG9yKFwiT2xkTGFjZVwiLCBcIiNGREY1RTZcIik7XG5leHBvcnRzLk9saXZlID0gcmVnaXN0ZXJDb2xvcihcIk9saXZlXCIsIFwiIzgwODAwMFwiKTtcbmV4cG9ydHMuT2xpdmVEcmFiID0gcmVnaXN0ZXJDb2xvcihcIk9saXZlRHJhYlwiLCBcIiM2QjhFMjNcIik7XG5leHBvcnRzLk9yYW5nZSA9IHJlZ2lzdGVyQ29sb3IoXCJPcmFuZ2VcIiwgXCIjRkZBNTAwXCIpO1xuZXhwb3J0cy5PcmFuZ2VSZWQgPSByZWdpc3RlckNvbG9yKFwiT3JhbmdlUmVkXCIsIFwiI0ZGNDUwMFwiKTtcbmV4cG9ydHMuT3JjaGlkID0gcmVnaXN0ZXJDb2xvcihcIk9yY2hpZFwiLCBcIiNEQTcwRDZcIik7XG5leHBvcnRzLlBhbGVHb2xkZW5Sb2QgPSByZWdpc3RlckNvbG9yKFwiUGFsZUdvbGRlblJvZFwiLCBcIiNFRUU4QUFcIik7XG5leHBvcnRzLlBhbGVHcmVlbiA9IHJlZ2lzdGVyQ29sb3IoXCJQYWxlR3JlZW5cIiwgXCIjOThGQjk4XCIpO1xuZXhwb3J0cy5QYWxlVHVycXVvaXNlID0gcmVnaXN0ZXJDb2xvcihcIlBhbGVUdXJxdW9pc2VcIiwgXCIjQUZFRUVFXCIpO1xuZXhwb3J0cy5QYWxlVmlvbGV0UmVkID0gcmVnaXN0ZXJDb2xvcihcIlBhbGVWaW9sZXRSZWRcIiwgXCIjREI3MDkzXCIpO1xuZXhwb3J0cy5QYXBheWFXaGlwID0gcmVnaXN0ZXJDb2xvcihcIlBhcGF5YVdoaXBcIiwgXCIjRkZFRkQ1XCIpO1xuZXhwb3J0cy5QZWFjaFB1ZmYgPSByZWdpc3RlckNvbG9yKFwiUGVhY2hQdWZmXCIsIFwiI0ZGREFCOVwiKTtcbmV4cG9ydHMuUGVydSA9IHJlZ2lzdGVyQ29sb3IoXCJQZXJ1XCIsIFwiI0NEODUzRlwiKTtcbmV4cG9ydHMuUGluayA9IHJlZ2lzdGVyQ29sb3IoXCJQaW5rXCIsIFwiI0ZGQzBDQlwiKTtcbmV4cG9ydHMuUGx1bSA9IHJlZ2lzdGVyQ29sb3IoXCJQbHVtXCIsIFwiI0REQTBERFwiKTtcbmV4cG9ydHMuUG93ZGVyQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJQb3dkZXJCbHVlXCIsIFwiI0IwRTBFNlwiKTtcbmV4cG9ydHMuUHVycGxlID0gcmVnaXN0ZXJDb2xvcihcIlB1cnBsZVwiLCBcIiM4MDAwODBcIik7XG5leHBvcnRzLlJlYmVjY2FQdXJwbGUgPSByZWdpc3RlckNvbG9yKFwiUmViZWNjYVB1cnBsZVwiLCBcIiM2NjMzOTlcIik7XG5leHBvcnRzLlJlZCA9IHJlZ2lzdGVyQ29sb3IoXCJSZWRcIiwgXCIjRkYwMDAwXCIpO1xuZXhwb3J0cy5Sb3N5QnJvd24gPSByZWdpc3RlckNvbG9yKFwiUm9zeUJyb3duXCIsIFwiI0JDOEY4RlwiKTtcbmV4cG9ydHMuUm95YWxCbHVlID0gcmVnaXN0ZXJDb2xvcihcIlJveWFsQmx1ZVwiLCBcIiM0MTY5RTFcIik7XG5leHBvcnRzLlNhZGRsZUJyb3duID0gcmVnaXN0ZXJDb2xvcihcIlNhZGRsZUJyb3duXCIsIFwiIzhCNDUxM1wiKTtcbmV4cG9ydHMuU2FsbW9uID0gcmVnaXN0ZXJDb2xvcihcIlNhbG1vblwiLCBcIiNGQTgwNzJcIik7XG5leHBvcnRzLlNhbmR5QnJvd24gPSByZWdpc3RlckNvbG9yKFwiU2FuZHlCcm93blwiLCBcIiNGNEE0NjBcIik7XG5leHBvcnRzLlNlYUdyZWVuID0gcmVnaXN0ZXJDb2xvcihcIlNlYUdyZWVuXCIsIFwiIzJFOEI1N1wiKTtcbmV4cG9ydHMuU2VhU2hlbGwgPSByZWdpc3RlckNvbG9yKFwiU2VhU2hlbGxcIiwgXCIjRkZGNUVFXCIpO1xuZXhwb3J0cy5TaWVubmEgPSByZWdpc3RlckNvbG9yKFwiU2llbm5hXCIsIFwiI0EwNTIyRFwiKTtcbmV4cG9ydHMuU2lsdmVyID0gcmVnaXN0ZXJDb2xvcihcIlNpbHZlclwiLCBcIiNDMEMwQzBcIik7XG5leHBvcnRzLlNreUJsdWUgPSByZWdpc3RlckNvbG9yKFwiU2t5Qmx1ZVwiLCBcIiM4N0NFRUJcIik7XG5leHBvcnRzLlNsYXRlQmx1ZSA9IHJlZ2lzdGVyQ29sb3IoXCJTbGF0ZUJsdWVcIiwgXCIjNkE1QUNEXCIpO1xuZXhwb3J0cy5TbGF0ZUdyYXkgPSByZWdpc3RlckNvbG9yKFwiU2xhdGVHcmF5XCIsIFwiIzcwODA5MFwiKTtcbmV4cG9ydHMuU25vdyA9IHJlZ2lzdGVyQ29sb3IoXCJTbm93XCIsIFwiI0ZGRkFGQVwiKTtcbmV4cG9ydHMuU3ByaW5nR3JlZW4gPSByZWdpc3RlckNvbG9yKFwiU3ByaW5nR3JlZW5cIiwgXCIjMDBGRjdGXCIpO1xuZXhwb3J0cy5TdGVlbEJsdWUgPSByZWdpc3RlckNvbG9yKFwiU3RlZWxCbHVlXCIsIFwiIzQ2ODJCNFwiKTtcbmV4cG9ydHMuVGFuID0gcmVnaXN0ZXJDb2xvcihcIlRhblwiLCBcIiNEMkI0OENcIik7XG5leHBvcnRzLlRlYWwgPSByZWdpc3RlckNvbG9yKFwiVGVhbFwiLCBcIiMwMDgwODBcIik7XG5leHBvcnRzLlRoaXN0bGUgPSByZWdpc3RlckNvbG9yKFwiVGhpc3RsZVwiLCBcIiNEOEJGRDhcIik7XG5leHBvcnRzLlRvbWF0byA9IHJlZ2lzdGVyQ29sb3IoXCJUb21hdG9cIiwgXCIjRkY2MzQ3XCIpO1xuZXhwb3J0cy5UdXJxdW9pc2UgPSByZWdpc3RlckNvbG9yKFwiVHVycXVvaXNlXCIsIFwiIzQwRTBEMFwiKTtcbmV4cG9ydHMuVmlvbGV0ID0gcmVnaXN0ZXJDb2xvcihcIlZpb2xldFwiLCBcIiNFRTgyRUVcIik7XG5leHBvcnRzLldoZWF0ID0gcmVnaXN0ZXJDb2xvcihcIldoZWF0XCIsIFwiI0Y1REVCM1wiKTtcbmV4cG9ydHMuV2hpdGUgPSByZWdpc3RlckNvbG9yKFwiV2hpdGVcIiwgXCIjRkZGRkZGXCIpO1xuZXhwb3J0cy5XaGl0ZVNtb2tlID0gcmVnaXN0ZXJDb2xvcihcIldoaXRlU21va2VcIiwgXCIjRjVGNUY1XCIpO1xuZXhwb3J0cy5ZZWxsb3cgPSByZWdpc3RlckNvbG9yKFwiWWVsbG93XCIsIFwiI0ZGRkYwMFwiKTtcbmV4cG9ydHMuWWVsbG93R3JlZW4gPSByZWdpc3RlckNvbG9yKFwiWWVsbG93R3JlZW5cIiwgXCIjOUFDRDMyXCIpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9a25vd24tY29sb3JzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBDb25zb2xlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb25zb2xlKCkge1xuICAgIH1cbiAgICBDb25zb2xlLnByb3RvdHlwZS50aW1lID0gZnVuY3Rpb24gKHJlcG9ydE5hbWUpIHtcbiAgICB9O1xuICAgIENvbnNvbGUucHJvdG90eXBlLnRpbWVFbmQgPSBmdW5jdGlvbiAocmVwb3J0TmFtZSkge1xuICAgIH07XG4gICAgQ29uc29sZS5wcm90b3R5cGUuYXNzZXJ0ID0gZnVuY3Rpb24gKHRlc3QsIG1lc3NhZ2UpIHtcbiAgICB9O1xuICAgIENvbnNvbGUucHJvdG90eXBlLmluZm8gPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIH07XG4gICAgQ29uc29sZS5wcm90b3R5cGUud2FybiA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgfTtcbiAgICBDb25zb2xlLnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgfTtcbiAgICBDb25zb2xlLnByb3RvdHlwZS5sb2cgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgIH07XG4gICAgQ29uc29sZS5wcm90b3R5cGUudHJhY2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBDb25zb2xlLnByb3RvdHlwZS5kaXIgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgfTtcbiAgICByZXR1cm4gQ29uc29sZTtcbn0oKSk7XG5leHBvcnRzLkNvbnNvbGUgPSBDb25zb2xlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uc29sZS5qcy5tYXAiLCJcbmV4cG9ydHMucGFyc2UgPSBwYXJzZTtcblxuZnVuY3Rpb24gcGFyc2Uoc3RyKSB7XG4gIHJldHVybiBuZXcgUGFyc2VyKHN0cikucGFyc2UoKTtcbn1cblxuZnVuY3Rpb24gUGFyc2VyKHN0cikge1xuICB0aGlzLnN0ciA9IHN0cjtcbn1cblxuUGFyc2VyLnByb3RvdHlwZS5za2lwID0gZnVuY3Rpb24obSl7XG4gIHRoaXMuc3RyID0gdGhpcy5zdHIuc2xpY2UobVswXS5sZW5ndGgpO1xufTtcblxuUGFyc2VyLnByb3RvdHlwZS5jb21tYSA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL14sICovLmV4ZWModGhpcy5zdHIpO1xuICBpZiAoIW0pIHJldHVybjtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4geyB0eXBlOiAnY29tbWEnLCBzdHJpbmc6ICcsJyB9O1xufTtcblxuUGFyc2VyLnByb3RvdHlwZS5pZGVudCA9IGZ1bmN0aW9uKCl7XG4gIHZhciBtID0gL14oW1xcdy1dKykgKi8uZXhlYyh0aGlzLnN0cik7XG4gIGlmICghbSkgcmV0dXJuO1xuICB0aGlzLnNraXAobSk7XG4gIHJldHVybiB7XG4gICAgdHlwZTogJ2lkZW50JyxcbiAgICBzdHJpbmc6IG1bMV1cbiAgfVxufTtcblxuUGFyc2VyLnByb3RvdHlwZS5pbnQgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eKChbLVxcK10/XFxkKykoXFxTKyk/KSAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm47XG4gIHRoaXMuc2tpcChtKTtcbiAgdmFyIG4gPSB+fm1bMl07XG4gIHZhciB1ID0gbVszXTtcblxuICByZXR1cm4ge1xuICAgIHR5cGU6ICdudW1iZXInLFxuICAgIHN0cmluZzogbVsxXSxcbiAgICB1bml0OiB1IHx8ICcnLFxuICAgIHZhbHVlOiBuXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuZmxvYXQgPSBmdW5jdGlvbigpe1xuICB2YXIgbSA9IC9eKCgoPzpbLVxcK10/XFxkKyk/XFwuXFxkKykoXFxTKyk/KSAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm47XG4gIHRoaXMuc2tpcChtKTtcbiAgdmFyIG4gPSBwYXJzZUZsb2F0KG1bMl0pO1xuICB2YXIgdSA9IG1bM107XG5cbiAgcmV0dXJuIHtcbiAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICBzdHJpbmc6IG1bMV0sXG4gICAgdW5pdDogdSB8fCAnJyxcbiAgICB2YWx1ZTogblxuICB9XG59O1xuXG5QYXJzZXIucHJvdG90eXBlLm51bWJlciA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLmZsb2F0KCkgfHwgdGhpcy5pbnQoKTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUuZG91YmxlID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXlwiKFteXCJdKilcIiAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm4gbTtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIHF1b3RlOiAnXCInLFxuICAgIHN0cmluZzogJ1wiJyArIG1bMV0gKyAnXCInLFxuICAgIHZhbHVlOiBtWzFdXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuc2luZ2xlID0gZnVuY3Rpb24oKXtcbiAgdmFyIG0gPSAvXicoW14nXSopJyAqLy5leGVjKHRoaXMuc3RyKTtcbiAgaWYgKCFtKSByZXR1cm4gbTtcbiAgdGhpcy5za2lwKG0pO1xuICByZXR1cm4ge1xuICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgIHF1b3RlOiBcIidcIixcbiAgICBzdHJpbmc6IFwiJ1wiICsgbVsxXSArIFwiJ1wiLFxuICAgIHZhbHVlOiBtWzFdXG4gIH1cbn07XG5cblBhcnNlci5wcm90b3R5cGUuc3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgcmV0dXJuIHRoaXMuc2luZ2xlKCkgfHwgdGhpcy5kb3VibGUoKTtcbn07XG5cblxuUGFyc2VyLnByb3RvdHlwZS52YWx1ZSA9IGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLm51bWJlcigpXG4gICAgfHwgdGhpcy5pZGVudCgpXG4gICAgfHwgdGhpcy5zdHJpbmcoKVxuICAgIHx8IHRoaXMuY29tbWEoKTtcbn07XG5cblBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbigpe1xuICB2YXIgdmFscyA9IFtdO1xuXG4gIHdoaWxlICh0aGlzLnN0ci5sZW5ndGgpIHtcbiAgICB2YXIgb2JqID0gdGhpcy52YWx1ZSgpO1xuICAgIGlmICghb2JqKSB0aHJvdyBuZXcgRXJyb3IoJ2ZhaWxlZCB0byBwYXJzZSBuZWFyIGAnICsgdGhpcy5zdHIuc2xpY2UoMCwgMTApICsgJy4uLmAnKTtcbiAgICB2YWxzLnB1c2gob2JqKTtcbiAgfVxuXG4gIHJldHVybiB2YWxzO1xufTtcbiIsImV4cG9ydHMucGFyc2UgPSByZXF1aXJlKCcuL2xpYi9wYXJzZScpO1xuIiwiLy8gaHR0cDovL3d3dy53My5vcmcvVFIvQ1NTMjEvZ3JhbW1hci5odG1sXG4vLyBodHRwczovL2dpdGh1Yi5jb20vdmlzaW9ubWVkaWEvY3NzLXBhcnNlL3B1bGwvNDkjaXNzdWVjb21tZW50LTMwMDg4MDI3XG52YXIgY29tbWVudHJlID0gL1xcL1xcKlteKl0qXFwqKyhbXi8qXVteKl0qXFwqKykqXFwvL2dcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihjc3MsIG9wdGlvbnMpe1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcblxuICAvKipcbiAgICogUG9zaXRpb25hbC5cbiAgICovXG5cbiAgdmFyIGxpbmVubyA9IDE7XG4gIHZhciBjb2x1bW4gPSAxO1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgbGluZW5vIGFuZCBjb2x1bW4gYmFzZWQgb24gYHN0cmAuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIHVwZGF0ZVBvc2l0aW9uKHN0cikge1xuICAgIHZhciBsaW5lcyA9IHN0ci5tYXRjaCgvXFxuL2cpO1xuICAgIGlmIChsaW5lcykgbGluZW5vICs9IGxpbmVzLmxlbmd0aDtcbiAgICB2YXIgaSA9IHN0ci5sYXN0SW5kZXhPZignXFxuJyk7XG4gICAgY29sdW1uID0gfmkgPyBzdHIubGVuZ3RoIC0gaSA6IGNvbHVtbiArIHN0ci5sZW5ndGg7XG4gIH1cblxuICAvKipcbiAgICogTWFyayBwb3NpdGlvbiBhbmQgcGF0Y2ggYG5vZGUucG9zaXRpb25gLlxuICAgKi9cblxuICBmdW5jdGlvbiBwb3NpdGlvbigpIHtcbiAgICB2YXIgc3RhcnQgPSB7IGxpbmU6IGxpbmVubywgY29sdW1uOiBjb2x1bW4gfTtcbiAgICByZXR1cm4gZnVuY3Rpb24obm9kZSl7XG4gICAgICBub2RlLnBvc2l0aW9uID0gbmV3IFBvc2l0aW9uKHN0YXJ0KTtcbiAgICAgIHdoaXRlc3BhY2UoKTtcbiAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogU3RvcmUgcG9zaXRpb24gaW5mb3JtYXRpb24gZm9yIGEgbm9kZVxuICAgKi9cblxuICBmdW5jdGlvbiBQb3NpdGlvbihzdGFydCkge1xuICAgIHRoaXMuc3RhcnQgPSBzdGFydDtcbiAgICB0aGlzLmVuZCA9IHsgbGluZTogbGluZW5vLCBjb2x1bW46IGNvbHVtbiB9O1xuICAgIHRoaXMuc291cmNlID0gb3B0aW9ucy5zb3VyY2U7XG4gIH1cblxuICAvKipcbiAgICogTm9uLWVudW1lcmFibGUgc291cmNlIHN0cmluZ1xuICAgKi9cblxuICBQb3NpdGlvbi5wcm90b3R5cGUuY29udGVudCA9IGNzcztcblxuICAvKipcbiAgICogRXJyb3IgYG1zZ2AuXG4gICAqL1xuXG4gIHZhciBlcnJvcnNMaXN0ID0gW107XG5cbiAgZnVuY3Rpb24gZXJyb3IobXNnKSB7XG4gICAgdmFyIGVyciA9IG5ldyBFcnJvcihvcHRpb25zLnNvdXJjZSArICc6JyArIGxpbmVubyArICc6JyArIGNvbHVtbiArICc6ICcgKyBtc2cpO1xuICAgIGVyci5yZWFzb24gPSBtc2c7XG4gICAgZXJyLmZpbGVuYW1lID0gb3B0aW9ucy5zb3VyY2U7XG4gICAgZXJyLmxpbmUgPSBsaW5lbm87XG4gICAgZXJyLmNvbHVtbiA9IGNvbHVtbjtcbiAgICBlcnIuc291cmNlID0gY3NzO1xuXG4gICAgaWYgKG9wdGlvbnMuc2lsZW50KSB7XG4gICAgICBlcnJvcnNMaXN0LnB1c2goZXJyKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBzdHlsZXNoZWV0LlxuICAgKi9cblxuICBmdW5jdGlvbiBzdHlsZXNoZWV0KCkge1xuICAgIHZhciBydWxlc0xpc3QgPSBydWxlcygpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdzdHlsZXNoZWV0JyxcbiAgICAgIHN0eWxlc2hlZXQ6IHtcbiAgICAgICAgcnVsZXM6IHJ1bGVzTGlzdCxcbiAgICAgICAgcGFyc2luZ0Vycm9yczogZXJyb3JzTGlzdFxuICAgICAgfVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogT3BlbmluZyBicmFjZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gb3BlbigpIHtcbiAgICByZXR1cm4gbWF0Y2goL157XFxzKi8pO1xuICB9XG5cbiAgLyoqXG4gICAqIENsb3NpbmcgYnJhY2UuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgIHJldHVybiBtYXRjaCgvXn0vKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBydWxlc2V0LlxuICAgKi9cblxuICBmdW5jdGlvbiBydWxlcygpIHtcbiAgICB2YXIgbm9kZTtcbiAgICB2YXIgcnVsZXMgPSBbXTtcbiAgICB3aGl0ZXNwYWNlKCk7XG4gICAgY29tbWVudHMocnVsZXMpO1xuICAgIHdoaWxlIChjc3MubGVuZ3RoICYmIGNzcy5jaGFyQXQoMCkgIT0gJ30nICYmIChub2RlID0gYXRydWxlKCkgfHwgcnVsZSgpKSkge1xuICAgICAgaWYgKG5vZGUgIT09IGZhbHNlKSB7XG4gICAgICAgIHJ1bGVzLnB1c2gobm9kZSk7XG4gICAgICAgIGNvbW1lbnRzKHJ1bGVzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJ1bGVzO1xuICB9XG5cbiAgLyoqXG4gICAqIE1hdGNoIGByZWAgYW5kIHJldHVybiBjYXB0dXJlcy5cbiAgICovXG5cbiAgZnVuY3Rpb24gbWF0Y2gocmUpIHtcbiAgICB2YXIgbSA9IHJlLmV4ZWMoY3NzKTtcbiAgICBpZiAoIW0pIHJldHVybjtcbiAgICB2YXIgc3RyID0gbVswXTtcbiAgICB1cGRhdGVQb3NpdGlvbihzdHIpO1xuICAgIGNzcyA9IGNzcy5zbGljZShzdHIubGVuZ3RoKTtcbiAgICByZXR1cm4gbTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSB3aGl0ZXNwYWNlLlxuICAgKi9cblxuICBmdW5jdGlvbiB3aGl0ZXNwYWNlKCkge1xuICAgIG1hdGNoKC9eXFxzKi8pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGNvbW1lbnRzO1xuICAgKi9cblxuICBmdW5jdGlvbiBjb21tZW50cyhydWxlcykge1xuICAgIHZhciBjO1xuICAgIHJ1bGVzID0gcnVsZXMgfHwgW107XG4gICAgd2hpbGUgKGMgPSBjb21tZW50KCkpIHtcbiAgICAgIGlmIChjICE9PSBmYWxzZSkge1xuICAgICAgICBydWxlcy5wdXNoKGMpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcnVsZXM7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgY29tbWVudC5cbiAgICovXG5cbiAgZnVuY3Rpb24gY29tbWVudCgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICBpZiAoJy8nICE9IGNzcy5jaGFyQXQoMCkgfHwgJyonICE9IGNzcy5jaGFyQXQoMSkpIHJldHVybjtcblxuICAgIHZhciBpID0gMjtcbiAgICB3aGlsZSAoXCJcIiAhPSBjc3MuY2hhckF0KGkpICYmICgnKicgIT0gY3NzLmNoYXJBdChpKSB8fCAnLycgIT0gY3NzLmNoYXJBdChpICsgMSkpKSArK2k7XG4gICAgaSArPSAyO1xuXG4gICAgaWYgKFwiXCIgPT09IGNzcy5jaGFyQXQoaS0xKSkge1xuICAgICAgcmV0dXJuIGVycm9yKCdFbmQgb2YgY29tbWVudCBtaXNzaW5nJyk7XG4gICAgfVxuXG4gICAgdmFyIHN0ciA9IGNzcy5zbGljZSgyLCBpIC0gMik7XG4gICAgY29sdW1uICs9IDI7XG4gICAgdXBkYXRlUG9zaXRpb24oc3RyKTtcbiAgICBjc3MgPSBjc3Muc2xpY2UoaSk7XG4gICAgY29sdW1uICs9IDI7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdjb21tZW50JyxcbiAgICAgIGNvbW1lbnQ6IHN0clxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHNlbGVjdG9yLlxuICAgKi9cblxuICBmdW5jdGlvbiBzZWxlY3RvcigpIHtcbiAgICB2YXIgbSA9IG1hdGNoKC9eKFtee10rKS8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIC8qIEBmaXggUmVtb3ZlIGFsbCBjb21tZW50cyBmcm9tIHNlbGVjdG9yc1xuICAgICAqIGh0dHA6Ly9vc3Rlcm1pbGxlci5vcmcvZmluZGNvbW1lbnQuaHRtbCAqL1xuICAgIHJldHVybiB0cmltKG1bMF0pXG4gICAgICAucmVwbGFjZSgvXFwvXFwqKFteKl18W1xcclxcbl18KFxcKisoW14qL118W1xcclxcbl0pKSkqXFwqXFwvKy9nLCAnJylcbiAgICAgIC5yZXBsYWNlKC9cIig/OlxcXFxcInxbXlwiXSkqXCJ8Jyg/OlxcXFwnfFteJ10pKicvZywgZnVuY3Rpb24obSkge1xuICAgICAgICByZXR1cm4gbS5yZXBsYWNlKC8sL2csICdcXHUyMDBDJyk7XG4gICAgICB9KVxuICAgICAgLnNwbGl0KC9cXHMqKD8hW14oXSpcXCkpLFxccyovKVxuICAgICAgLm1hcChmdW5jdGlvbihzKSB7XG4gICAgICAgIHJldHVybiBzLnJlcGxhY2UoL1xcdTIwMEMvZywgJywnKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGRlY2xhcmF0aW9uLlxuICAgKi9cblxuICBmdW5jdGlvbiBkZWNsYXJhdGlvbigpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcblxuICAgIC8vIHByb3BcbiAgICB2YXIgcHJvcCA9IG1hdGNoKC9eKFxcKj9bLSNcXC9cXCpcXFxcXFx3XSsoXFxbWzAtOWEtel8tXStcXF0pPylcXHMqLyk7XG4gICAgaWYgKCFwcm9wKSByZXR1cm47XG4gICAgcHJvcCA9IHRyaW0ocHJvcFswXSk7XG5cbiAgICAvLyA6XG4gICAgaWYgKCFtYXRjaCgvXjpcXHMqLykpIHJldHVybiBlcnJvcihcInByb3BlcnR5IG1pc3NpbmcgJzonXCIpO1xuXG4gICAgLy8gdmFsXG4gICAgdmFyIHZhbCA9IG1hdGNoKC9eKCg/OicoPzpcXFxcJ3wuKSo/J3xcIig/OlxcXFxcInwuKSo/XCJ8XFwoW15cXCldKj9cXCl8W159O10pKykvKTtcblxuICAgIHZhciByZXQgPSBwb3Moe1xuICAgICAgdHlwZTogJ2RlY2xhcmF0aW9uJyxcbiAgICAgIHByb3BlcnR5OiBwcm9wLnJlcGxhY2UoY29tbWVudHJlLCAnJyksXG4gICAgICB2YWx1ZTogdmFsID8gdHJpbSh2YWxbMF0pLnJlcGxhY2UoY29tbWVudHJlLCAnJykgOiAnJ1xuICAgIH0pO1xuXG4gICAgLy8gO1xuICAgIG1hdGNoKC9eWztcXHNdKi8pO1xuXG4gICAgcmV0dXJuIHJldDtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBkZWNsYXJhdGlvbnMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGRlY2xhcmF0aW9ucygpIHtcbiAgICB2YXIgZGVjbHMgPSBbXTtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJtaXNzaW5nICd7J1wiKTtcbiAgICBjb21tZW50cyhkZWNscyk7XG5cbiAgICAvLyBkZWNsYXJhdGlvbnNcbiAgICB2YXIgZGVjbDtcbiAgICB3aGlsZSAoZGVjbCA9IGRlY2xhcmF0aW9uKCkpIHtcbiAgICAgIGlmIChkZWNsICE9PSBmYWxzZSkge1xuICAgICAgICBkZWNscy5wdXNoKGRlY2wpO1xuICAgICAgICBjb21tZW50cyhkZWNscyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFjbG9zZSgpKSByZXR1cm4gZXJyb3IoXCJtaXNzaW5nICd9J1wiKTtcbiAgICByZXR1cm4gZGVjbHM7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2Uga2V5ZnJhbWUuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGtleWZyYW1lKCkge1xuICAgIHZhciBtO1xuICAgIHZhciB2YWxzID0gW107XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG5cbiAgICB3aGlsZSAobSA9IG1hdGNoKC9eKChcXGQrXFwuXFxkK3xcXC5cXGQrfFxcZCspJT98W2Etel0rKVxccyovKSkge1xuICAgICAgdmFscy5wdXNoKG1bMV0pO1xuICAgICAgbWF0Y2goL14sXFxzKi8pO1xuICAgIH1cblxuICAgIGlmICghdmFscy5sZW5ndGgpIHJldHVybjtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2tleWZyYW1lJyxcbiAgICAgIHZhbHVlczogdmFscyxcbiAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zKClcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZSBrZXlmcmFtZXMuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0a2V5ZnJhbWVzKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AKFstXFx3XSspP2tleWZyYW1lc1xccyovKTtcblxuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIHZhciB2ZW5kb3IgPSBtWzFdO1xuXG4gICAgLy8gaWRlbnRpZmllclxuICAgIHZhciBtID0gbWF0Y2goL14oWy1cXHddKylcXHMqLyk7XG4gICAgaWYgKCFtKSByZXR1cm4gZXJyb3IoXCJAa2V5ZnJhbWVzIG1pc3NpbmcgbmFtZVwiKTtcbiAgICB2YXIgbmFtZSA9IG1bMV07XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQGtleWZyYW1lcyBtaXNzaW5nICd7J1wiKTtcblxuICAgIHZhciBmcmFtZTtcbiAgICB2YXIgZnJhbWVzID0gY29tbWVudHMoKTtcbiAgICB3aGlsZSAoZnJhbWUgPSBrZXlmcmFtZSgpKSB7XG4gICAgICBmcmFtZXMucHVzaChmcmFtZSk7XG4gICAgICBmcmFtZXMgPSBmcmFtZXMuY29uY2F0KGNvbW1lbnRzKCkpO1xuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGtleWZyYW1lcyBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2tleWZyYW1lcycsXG4gICAgICBuYW1lOiBuYW1lLFxuICAgICAgdmVuZG9yOiB2ZW5kb3IsXG4gICAgICBrZXlmcmFtZXM6IGZyYW1lc1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIHN1cHBvcnRzLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdHN1cHBvcnRzKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15Ac3VwcG9ydHMgKihbXntdKykvKTtcblxuICAgIGlmICghbSkgcmV0dXJuO1xuICAgIHZhciBzdXBwb3J0cyA9IHRyaW0obVsxXSk7XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQHN1cHBvcnRzIG1pc3NpbmcgJ3snXCIpO1xuXG4gICAgdmFyIHN0eWxlID0gY29tbWVudHMoKS5jb25jYXQocnVsZXMoKSk7XG5cbiAgICBpZiAoIWNsb3NlKCkpIHJldHVybiBlcnJvcihcIkBzdXBwb3J0cyBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ3N1cHBvcnRzJyxcbiAgICAgIHN1cHBvcnRzOiBzdXBwb3J0cyxcbiAgICAgIHJ1bGVzOiBzdHlsZVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGhvc3QuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0aG9zdCgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQGhvc3RcXHMqLyk7XG5cbiAgICBpZiAoIW0pIHJldHVybjtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAaG9zdCBtaXNzaW5nICd7J1wiKTtcblxuICAgIHZhciBzdHlsZSA9IGNvbW1lbnRzKCkuY29uY2F0KHJ1bGVzKCkpO1xuXG4gICAgaWYgKCFjbG9zZSgpKSByZXR1cm4gZXJyb3IoXCJAaG9zdCBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2hvc3QnLFxuICAgICAgcnVsZXM6IHN0eWxlXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgbWVkaWEuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0bWVkaWEoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBtZWRpYSAqKFtee10rKS8pO1xuXG4gICAgaWYgKCFtKSByZXR1cm47XG4gICAgdmFyIG1lZGlhID0gdHJpbShtWzFdKTtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAbWVkaWEgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgc3R5bGUgPSBjb21tZW50cygpLmNvbmNhdChydWxlcygpKTtcblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQG1lZGlhIG1pc3NpbmcgJ30nXCIpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnbWVkaWEnLFxuICAgICAgbWVkaWE6IG1lZGlhLFxuICAgICAgcnVsZXM6IHN0eWxlXG4gICAgfSk7XG4gIH1cblxuXG4gIC8qKlxuICAgKiBQYXJzZSBjdXN0b20tbWVkaWEuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0Y3VzdG9tbWVkaWEoKSB7XG4gICAgdmFyIHBvcyA9IHBvc2l0aW9uKCk7XG4gICAgdmFyIG0gPSBtYXRjaCgvXkBjdXN0b20tbWVkaWFcXHMrKC0tW15cXHNdKylcXHMqKFteeztdKyk7Lyk7XG4gICAgaWYgKCFtKSByZXR1cm47XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdjdXN0b20tbWVkaWEnLFxuICAgICAgbmFtZTogdHJpbShtWzFdKSxcbiAgICAgIG1lZGlhOiB0cmltKG1bMl0pXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgcGFnZWQgbWVkaWEuXG4gICAqL1xuXG4gIGZ1bmN0aW9uIGF0cGFnZSgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgbSA9IG1hdGNoKC9eQHBhZ2UgKi8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgdmFyIHNlbCA9IHNlbGVjdG9yKCkgfHwgW107XG5cbiAgICBpZiAoIW9wZW4oKSkgcmV0dXJuIGVycm9yKFwiQHBhZ2UgbWlzc2luZyAneydcIik7XG4gICAgdmFyIGRlY2xzID0gY29tbWVudHMoKTtcblxuICAgIC8vIGRlY2xhcmF0aW9uc1xuICAgIHZhciBkZWNsO1xuICAgIHdoaWxlIChkZWNsID0gZGVjbGFyYXRpb24oKSkge1xuICAgICAgZGVjbHMucHVzaChkZWNsKTtcbiAgICAgIGRlY2xzID0gZGVjbHMuY29uY2F0KGNvbW1lbnRzKCkpO1xuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQHBhZ2UgbWlzc2luZyAnfSdcIik7XG5cbiAgICByZXR1cm4gcG9zKHtcbiAgICAgIHR5cGU6ICdwYWdlJyxcbiAgICAgIHNlbGVjdG9yczogc2VsLFxuICAgICAgZGVjbGFyYXRpb25zOiBkZWNsc1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlIGRvY3VtZW50LlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGRvY3VtZW50KCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AKFstXFx3XSspP2RvY3VtZW50ICooW157XSspLyk7XG4gICAgaWYgKCFtKSByZXR1cm47XG5cbiAgICB2YXIgdmVuZG9yID0gdHJpbShtWzFdKTtcbiAgICB2YXIgZG9jID0gdHJpbShtWzJdKTtcblxuICAgIGlmICghb3BlbigpKSByZXR1cm4gZXJyb3IoXCJAZG9jdW1lbnQgbWlzc2luZyAneydcIik7XG5cbiAgICB2YXIgc3R5bGUgPSBjb21tZW50cygpLmNvbmNhdChydWxlcygpKTtcblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGRvY3VtZW50IG1pc3NpbmcgJ30nXCIpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAnZG9jdW1lbnQnLFxuICAgICAgZG9jdW1lbnQ6IGRvYyxcbiAgICAgIHZlbmRvcjogdmVuZG9yLFxuICAgICAgcnVsZXM6IHN0eWxlXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgZm9udC1mYWNlLlxuICAgKi9cblxuICBmdW5jdGlvbiBhdGZvbnRmYWNlKCkge1xuICAgIHZhciBwb3MgPSBwb3NpdGlvbigpO1xuICAgIHZhciBtID0gbWF0Y2goL15AZm9udC1mYWNlXFxzKi8pO1xuICAgIGlmICghbSkgcmV0dXJuO1xuXG4gICAgaWYgKCFvcGVuKCkpIHJldHVybiBlcnJvcihcIkBmb250LWZhY2UgbWlzc2luZyAneydcIik7XG4gICAgdmFyIGRlY2xzID0gY29tbWVudHMoKTtcblxuICAgIC8vIGRlY2xhcmF0aW9uc1xuICAgIHZhciBkZWNsO1xuICAgIHdoaWxlIChkZWNsID0gZGVjbGFyYXRpb24oKSkge1xuICAgICAgZGVjbHMucHVzaChkZWNsKTtcbiAgICAgIGRlY2xzID0gZGVjbHMuY29uY2F0KGNvbW1lbnRzKCkpO1xuICAgIH1cblxuICAgIGlmICghY2xvc2UoKSkgcmV0dXJuIGVycm9yKFwiQGZvbnQtZmFjZSBtaXNzaW5nICd9J1wiKTtcblxuICAgIHJldHVybiBwb3Moe1xuICAgICAgdHlwZTogJ2ZvbnQtZmFjZScsXG4gICAgICBkZWNsYXJhdGlvbnM6IGRlY2xzXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgaW1wb3J0XG4gICAqL1xuXG4gIHZhciBhdGltcG9ydCA9IF9jb21waWxlQXRydWxlKCdpbXBvcnQnKTtcblxuICAvKipcbiAgICogUGFyc2UgY2hhcnNldFxuICAgKi9cblxuICB2YXIgYXRjaGFyc2V0ID0gX2NvbXBpbGVBdHJ1bGUoJ2NoYXJzZXQnKTtcblxuICAvKipcbiAgICogUGFyc2UgbmFtZXNwYWNlXG4gICAqL1xuXG4gIHZhciBhdG5hbWVzcGFjZSA9IF9jb21waWxlQXRydWxlKCduYW1lc3BhY2UnKTtcblxuICAvKipcbiAgICogUGFyc2Ugbm9uLWJsb2NrIGF0LXJ1bGVzXG4gICAqL1xuXG5cbiAgZnVuY3Rpb24gX2NvbXBpbGVBdHJ1bGUobmFtZSkge1xuICAgIHZhciByZSA9IG5ldyBSZWdFeHAoJ15AJyArIG5hbWUgKyAnXFxcXHMqKFteO10rKTsnKTtcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICAgIHZhciBtID0gbWF0Y2gocmUpO1xuICAgICAgaWYgKCFtKSByZXR1cm47XG4gICAgICB2YXIgcmV0ID0geyB0eXBlOiBuYW1lIH07XG4gICAgICByZXRbbmFtZV0gPSBtWzFdLnRyaW0oKTtcbiAgICAgIHJldHVybiBwb3MocmV0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgYXQgcnVsZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gYXRydWxlKCkge1xuICAgIGlmIChjc3NbMF0gIT0gJ0AnKSByZXR1cm47XG5cbiAgICByZXR1cm4gYXRrZXlmcmFtZXMoKVxuICAgICAgfHwgYXRtZWRpYSgpXG4gICAgICB8fCBhdGN1c3RvbW1lZGlhKClcbiAgICAgIHx8IGF0c3VwcG9ydHMoKVxuICAgICAgfHwgYXRpbXBvcnQoKVxuICAgICAgfHwgYXRjaGFyc2V0KClcbiAgICAgIHx8IGF0bmFtZXNwYWNlKClcbiAgICAgIHx8IGF0ZG9jdW1lbnQoKVxuICAgICAgfHwgYXRwYWdlKClcbiAgICAgIHx8IGF0aG9zdCgpXG4gICAgICB8fCBhdGZvbnRmYWNlKCk7XG4gIH1cblxuICAvKipcbiAgICogUGFyc2UgcnVsZS5cbiAgICovXG5cbiAgZnVuY3Rpb24gcnVsZSgpIHtcbiAgICB2YXIgcG9zID0gcG9zaXRpb24oKTtcbiAgICB2YXIgc2VsID0gc2VsZWN0b3IoKTtcblxuICAgIGlmICghc2VsKSByZXR1cm4gZXJyb3IoJ3NlbGVjdG9yIG1pc3NpbmcnKTtcbiAgICBjb21tZW50cygpO1xuXG4gICAgcmV0dXJuIHBvcyh7XG4gICAgICB0eXBlOiAncnVsZScsXG4gICAgICBzZWxlY3RvcnM6IHNlbCxcbiAgICAgIGRlY2xhcmF0aW9uczogZGVjbGFyYXRpb25zKClcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBhZGRQYXJlbnQoc3R5bGVzaGVldCgpKTtcbn07XG5cbi8qKlxuICogVHJpbSBgc3RyYC5cbiAqL1xuXG5mdW5jdGlvbiB0cmltKHN0cikge1xuICByZXR1cm4gc3RyID8gc3RyLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKSA6ICcnO1xufVxuXG4vKipcbiAqIEFkZHMgbm9uLWVudW1lcmFibGUgcGFyZW50IG5vZGUgcmVmZXJlbmNlIHRvIGVhY2ggbm9kZS5cbiAqL1xuXG5mdW5jdGlvbiBhZGRQYXJlbnQob2JqLCBwYXJlbnQpIHtcbiAgdmFyIGlzTm9kZSA9IG9iaiAmJiB0eXBlb2Ygb2JqLnR5cGUgPT09ICdzdHJpbmcnO1xuICB2YXIgY2hpbGRQYXJlbnQgPSBpc05vZGUgPyBvYmogOiBwYXJlbnQ7XG5cbiAgZm9yICh2YXIgayBpbiBvYmopIHtcbiAgICB2YXIgdmFsdWUgPSBvYmpba107XG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICB2YWx1ZS5mb3JFYWNoKGZ1bmN0aW9uKHYpIHsgYWRkUGFyZW50KHYsIGNoaWxkUGFyZW50KTsgfSk7XG4gICAgfSBlbHNlIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICBhZGRQYXJlbnQodmFsdWUsIGNoaWxkUGFyZW50KTtcbiAgICB9XG4gIH1cblxuICBpZiAoaXNOb2RlKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgJ3BhcmVudCcsIHtcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICB2YWx1ZTogcGFyZW50IHx8IG51bGxcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG4iLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdXJsUmVnRXggPSAvXFxzKnVybFxcKCg/OignfFwiKShbXlxcMV0qKVxcMXwoW15cXCldKikpXFwpXFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlVVJMKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdXJsUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IHVybFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSB1cmxSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcmVzdWx0WzJdIHx8IHJlc3VsdFszXTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VVUkwgPSBwYXJzZVVSTDtcbnZhciBoZXhDb2xvclJlZ0V4ID0gL1xccyojKCg/OlswLTlBLUZdezh9KXwoPzpbMC05QS1GXXs2fSl8KD86WzAtOUEtRl17M30pKVxccyovZ2l5O1xuZnVuY3Rpb24gcGFyc2VIZXhDb2xvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGhleENvbG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGhleENvbG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGhleENvbG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBoZXggPSByZXN1bHRbMV07XG4gICAgdmFyIGFyZ2I7XG4gICAgaWYgKGhleC5sZW5ndGggPT09IDgpIHtcbiAgICAgICAgYXJnYiA9IHBhcnNlSW50KFwiMHhcIiArIGhleCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGhleC5sZW5ndGggPT09IDYpIHtcbiAgICAgICAgYXJnYiA9IHBhcnNlSW50KFwiMHhGRlwiICsgaGV4KTtcbiAgICB9XG4gICAgZWxzZSBpZiAoaGV4Lmxlbmd0aCA9PT0gMykge1xuICAgICAgICBhcmdiID0gcGFyc2VJbnQoXCIweEZGXCIgKyBoZXhbMF0gKyBoZXhbMF0gKyBoZXhbMV0gKyBoZXhbMV0gKyBoZXhbMl0gKyBoZXhbMl0pO1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogYXJnYiB9O1xufVxuZXhwb3J0cy5wYXJzZUhleENvbG9yID0gcGFyc2VIZXhDb2xvcjtcbmZ1bmN0aW9uIHJnYmFUb0FyZ2JOdW1iZXIociwgZywgYiwgYSkge1xuICAgIGlmIChhID09PSB2b2lkIDApIHsgYSA9IDE7IH1cbiAgICBpZiAociA+PSAwICYmIHIgPD0gMjU1ICYmIGcgPj0gMCAmJiBnIDw9IDI1NSAmJiBiID49IDAgJiYgYiA8PSAyNTUgJiYgYSA+PSAwICYmIGEgPD0gMSkge1xuICAgICAgICByZXR1cm4gKE1hdGgucm91bmQoYSAqIDB4RkYpICogMHgwMTAwMDAwMCkgKyAociAqIDB4MDEwMDAwKSArIChnICogMHgwMDAxMDApICsgKGIgKiAweDAwMDAwMSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG52YXIgcmdiQ29sb3JSZWdFeCA9IC9cXHMqKHJnYlxcKFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqLFxccyooXFxkKilcXHMqXFwpKS9neTtcbmZ1bmN0aW9uIHBhcnNlUkdCQ29sb3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICByZ2JDb2xvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSByZ2JDb2xvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSByZ2JDb2xvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZXN1bHRbMV0gJiYgcmdiYVRvQXJnYk51bWJlcihwYXJzZUludChyZXN1bHRbMl0pLCBwYXJzZUludChyZXN1bHRbM10pLCBwYXJzZUludChyZXN1bHRbNF0pKTtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VSR0JDb2xvciA9IHBhcnNlUkdCQ29sb3I7XG52YXIgcmdiYUNvbG9yUmVnRXggPSAvXFxzKihyZ2JhXFwoXFxzKihcXGQqKVxccyosXFxzKihcXGQqKVxccyosXFxzKihcXGQqKVxccyosXFxzKihbMDFdP1xcLj9cXGQqKVxccypcXCkpL2d5O1xuZnVuY3Rpb24gcGFyc2VSR0JBQ29sb3IodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICByZ2JhQ29sb3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gcmdiYUNvbG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHJnYmFDb2xvclJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZ2JhVG9BcmdiTnVtYmVyKHBhcnNlSW50KHJlc3VsdFsyXSksIHBhcnNlSW50KHJlc3VsdFszXSksIHBhcnNlSW50KHJlc3VsdFs0XSksIHBhcnNlRmxvYXQocmVzdWx0WzVdKSk7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlUkdCQUNvbG9yID0gcGFyc2VSR0JBQ29sb3I7XG52YXIgY29sb3JzO1xuKGZ1bmN0aW9uIChjb2xvcnMpIHtcbiAgICBjb2xvcnNbY29sb3JzW1widHJhbnNwYXJlbnRcIl0gPSAwXSA9IFwidHJhbnNwYXJlbnRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYWxpY2VibHVlXCJdID0gNDI5Mzk4MjQ2M10gPSBcImFsaWNlYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJhbnRpcXVld2hpdGVcIl0gPSA0Mjk0NjM0NDU1XSA9IFwiYW50aXF1ZXdoaXRlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImFxdWFcIl0gPSA0Mjc4MjU1NjE1XSA9IFwiYXF1YVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJhcXVhbWFyaW5lXCJdID0gNDI4NjU3ODY0NF0gPSBcImFxdWFtYXJpbmVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYXp1cmVcIl0gPSA0MjkzOTg0MjU1XSA9IFwiYXp1cmVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmVpZ2VcIl0gPSA0Mjk0MzA5MzQwXSA9IFwiYmVpZ2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmlzcXVlXCJdID0gNDI5NDk2MDMyNF0gPSBcImJpc3F1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJibGFja1wiXSA9IDQyNzgxOTAwODBdID0gXCJibGFja1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJibGFuY2hlZGFsbW9uZFwiXSA9IDQyOTQ5NjIxMjVdID0gXCJibGFuY2hlZGFsbW9uZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJibHVlXCJdID0gNDI3ODE5MDMzNV0gPSBcImJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiYmx1ZXZpb2xldFwiXSA9IDQyODcyNDUyODJdID0gXCJibHVldmlvbGV0XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJyb3duXCJdID0gNDI4OTAxNDMxNF0gPSBcImJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImJ1cmx5d29vZFwiXSA9IDQyOTI3ODYzMTFdID0gXCJidXJseXdvb2RcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY2FkZXRibHVlXCJdID0gNDI4NDQ1NjYwOF0gPSBcImNhZGV0Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjaGFydHJldXNlXCJdID0gNDI4NjU3ODQzMl0gPSBcImNoYXJ0cmV1c2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY2hvY29sYXRlXCJdID0gNDI5MTk3OTU1MF0gPSBcImNob2NvbGF0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjb3JhbFwiXSA9IDQyOTQ5MzQzNTJdID0gXCJjb3JhbFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjb3JuZmxvd2VyYmx1ZVwiXSA9IDQyODQ3ODIwNjFdID0gXCJjb3JuZmxvd2VyYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjb3Juc2lsa1wiXSA9IDQyOTQ5NjU0NjhdID0gXCJjb3Juc2lsa1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJjcmltc29uXCJdID0gNDI5MjYxMzE4MF0gPSBcImNyaW1zb25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiY3lhblwiXSA9IDQyNzgyNTU2MTVdID0gXCJjeWFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtibHVlXCJdID0gNDI3ODE5MDIxOV0gPSBcImRhcmtibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtjeWFuXCJdID0gNDI3ODIyNTgwM10gPSBcImRhcmtjeWFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtnb2xkZW5yb2RcIl0gPSA0MjkwMjgzMDE5XSA9IFwiZGFya2dvbGRlbnJvZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ3JheVwiXSA9IDQyODkzMDkwOTddID0gXCJkYXJrZ3JheVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrZ3JlZW5cIl0gPSA0Mjc4MjE1NjgwXSA9IFwiZGFya2dyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtncmV5XCJdID0gNDI4OTMwOTA5N10gPSBcImRhcmtncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtraGFraVwiXSA9IDQyOTA2MjMzMzldID0gXCJkYXJra2hha2lcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya21hZ2VudGFcIl0gPSA0Mjg3Mjk5NzIzXSA9IFwiZGFya21hZ2VudGFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya29saXZlZ3JlZW5cIl0gPSA0MjgzNzg4MDc5XSA9IFwiZGFya29saXZlZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya29yYW5nZVwiXSA9IDQyOTQ5Mzc2MDBdID0gXCJkYXJrb3JhbmdlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtvcmNoaWRcIl0gPSA0Mjg4MjMwMDkyXSA9IFwiZGFya29yY2hpZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrcmVkXCJdID0gNDI4NzI5OTU4NF0gPSBcImRhcmtyZWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3NhbG1vblwiXSA9IDQyOTM0OTg0OTBdID0gXCJkYXJrc2FsbW9uXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzZWFncmVlblwiXSA9IDQyODc2MDk5OTldID0gXCJkYXJrc2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3NsYXRlYmx1ZVwiXSA9IDQyODI5MjQ0MjddID0gXCJkYXJrc2xhdGVibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmtzbGF0ZWdyYXlcIl0gPSA0MjgxMjkwNTc1XSA9IFwiZGFya3NsYXRlZ3JheVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkYXJrc2xhdGVncmV5XCJdID0gNDI4MTI5MDU3NV0gPSBcImRhcmtzbGF0ZWdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGFya3R1cnF1b2lzZVwiXSA9IDQyNzgyNDMwMjVdID0gXCJkYXJrdHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRhcmt2aW9sZXRcIl0gPSA0Mjg3ODg5NjE5XSA9IFwiZGFya3Zpb2xldFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkZWVwcGlua1wiXSA9IDQyOTQ5MDcwMjddID0gXCJkZWVwcGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkZWVwc2t5Ymx1ZVwiXSA9IDQyNzgyMzkyMzFdID0gXCJkZWVwc2t5Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJkaW1ncmF5XCJdID0gNDI4NTA5ODM0NV0gPSBcImRpbWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZGltZ3JleVwiXSA9IDQyODUwOTgzNDVdID0gXCJkaW1ncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImRvZGdlcmJsdWVcIl0gPSA0MjgwMTkzMjc5XSA9IFwiZG9kZ2VyYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJmaXJlYnJpY2tcIl0gPSA0Mjg5ODY0MjI2XSA9IFwiZmlyZWJyaWNrXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImZsb3JhbHdoaXRlXCJdID0gNDI5NDk2NjAwMF0gPSBcImZsb3JhbHdoaXRlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImZvcmVzdGdyZWVuXCJdID0gNDI4MDQ1MzkyMl0gPSBcImZvcmVzdGdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImZ1Y2hzaWFcIl0gPSA0Mjk0OTAyMDE1XSA9IFwiZnVjaHNpYVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJnYWluc2Jvcm9cIl0gPSA0MjkyNjY0NTQwXSA9IFwiZ2FpbnNib3JvXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImdob3N0d2hpdGVcIl0gPSA0Mjk0NTA2NzUxXSA9IFwiZ2hvc3R3aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJnb2xkXCJdID0gNDI5NDk1NjgwMF0gPSBcImdvbGRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ29sZGVucm9kXCJdID0gNDI5MjUxOTIwMF0gPSBcImdvbGRlbnJvZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJncmF5XCJdID0gNDI4NjYxMTU4NF0gPSBcImdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JlZW5cIl0gPSA0Mjc4MjIyODQ4XSA9IFwiZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JlZW55ZWxsb3dcIl0gPSA0Mjg5NTkzMTM1XSA9IFwiZ3JlZW55ZWxsb3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiZ3JleVwiXSA9IDQyODY2MTE1ODRdID0gXCJncmV5XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImhvbmV5ZGV3XCJdID0gNDI5Mzk4NDI0MF0gPSBcImhvbmV5ZGV3XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImhvdHBpbmtcIl0gPSA0Mjk0OTI4ODIwXSA9IFwiaG90cGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJpbmRpYW5yZWRcIl0gPSA0MjkxNjQ4NjA0XSA9IFwiaW5kaWFucmVkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImluZGlnb1wiXSA9IDQyODMxMDU0MTBdID0gXCJpbmRpZ29cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wiaXZvcnlcIl0gPSA0Mjk0OTY3MjgwXSA9IFwiaXZvcnlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wia2hha2lcIl0gPSA0MjkzOTc3NzQwXSA9IFwia2hha2lcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGF2ZW5kZXJcIl0gPSA0MjkzMzIyNDkwXSA9IFwibGF2ZW5kZXJcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGF2ZW5kZXJibHVzaFwiXSA9IDQyOTQ5NjM0NDVdID0gXCJsYXZlbmRlcmJsdXNoXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxhd25ncmVlblwiXSA9IDQyODYzODEwNTZdID0gXCJsYXduZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGVtb25jaGlmZm9uXCJdID0gNDI5NDk2NTk2NV0gPSBcImxlbW9uY2hpZmZvblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGJsdWVcIl0gPSA0Mjg5NTgzMzM0XSA9IFwibGlnaHRibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Y29yYWxcIl0gPSA0MjkzOTUxNjE2XSA9IFwibGlnaHRjb3JhbFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodGN5YW5cIl0gPSA0MjkyOTM1Njc5XSA9IFwibGlnaHRjeWFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z29sZGVucm9keWVsbG93XCJdID0gNDI5NDYzODI5MF0gPSBcImxpZ2h0Z29sZGVucm9keWVsbG93XCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z3JheVwiXSA9IDQyOTIwNzI0MDNdID0gXCJsaWdodGdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRncmVlblwiXSA9IDQyODc2ODgzMzZdID0gXCJsaWdodGdyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcImxpZ2h0Z3JleVwiXSA9IDQyOTIwNzI0MDNdID0gXCJsaWdodGdyZXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRwaW5rXCJdID0gNDI5NDk0ODU0NV0gPSBcImxpZ2h0cGlua1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNhbG1vblwiXSA9IDQyOTQ5NDI4NDJdID0gXCJsaWdodHNhbG1vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNlYWdyZWVuXCJdID0gNDI4MDMzMjk3MF0gPSBcImxpZ2h0c2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGlnaHRza3libHVlXCJdID0gNDI4NzA5MDQyNl0gPSBcImxpZ2h0c2t5Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNsYXRlZ3JheVwiXSA9IDQyODYwMjM4MzNdID0gXCJsaWdodHNsYXRlZ3JheVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHNsYXRlZ3JleVwiXSA9IDQyODYwMjM4MzNdID0gXCJsaWdodHNsYXRlZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHN0ZWVsYmx1ZVwiXSA9IDQyODk3NzQ4MTRdID0gXCJsaWdodHN0ZWVsYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaWdodHllbGxvd1wiXSA9IDQyOTQ5NjcyNjRdID0gXCJsaWdodHllbGxvd1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaW1lXCJdID0gNDI3ODI1NTM2MF0gPSBcImxpbWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibGltZWdyZWVuXCJdID0gNDI4MTUxOTQxMF0gPSBcImxpbWVncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJsaW5lblwiXSA9IDQyOTQ2MzU3NTBdID0gXCJsaW5lblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtYWdlbnRhXCJdID0gNDI5NDkwMjAxNV0gPSBcIm1hZ2VudGFcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWFyb29uXCJdID0gNDI4NjU3ODY4OF0gPSBcIm1hcm9vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1hcXVhbWFyaW5lXCJdID0gNDI4NDkyNzQwMl0gPSBcIm1lZGl1bWFxdWFtYXJpbmVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtYmx1ZVwiXSA9IDQyNzgxOTAyODVdID0gXCJtZWRpdW1ibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bW9yY2hpZFwiXSA9IDQyOTA0MDE3NDddID0gXCJtZWRpdW1vcmNoaWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtcHVycGxlXCJdID0gNDI4Nzg1Mjc2M10gPSBcIm1lZGl1bXB1cnBsZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1zZWFncmVlblwiXSA9IDQyODIxNjgxNzddID0gXCJtZWRpdW1zZWFncmVlblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtZWRpdW1zbGF0ZWJsdWVcIl0gPSA0Mjg2Mjc3ODcwXSA9IFwibWVkaXVtc2xhdGVibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXNwcmluZ2dyZWVuXCJdID0gNDI3ODI1NDIzNF0gPSBcIm1lZGl1bXNwcmluZ2dyZWVuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1lZGl1bXR1cnF1b2lzZVwiXSA9IDQyODI5NjIzODBdID0gXCJtZWRpdW10dXJxdW9pc2VcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWVkaXVtdmlvbGV0cmVkXCJdID0gNDI5MTIzNzI1M10gPSBcIm1lZGl1bXZpb2xldHJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtaWRuaWdodGJsdWVcIl0gPSA0Mjc5ODM0OTkyXSA9IFwibWlkbmlnaHRibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm1pbnRjcmVhbVwiXSA9IDQyOTQzMTE5MzBdID0gXCJtaW50Y3JlYW1cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wibWlzdHlyb3NlXCJdID0gNDI5NDk2MDM1M10gPSBcIm1pc3R5cm9zZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJtb2NjYXNpblwiXSA9IDQyOTQ5NjAzMDldID0gXCJtb2NjYXNpblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJuYXZham93aGl0ZVwiXSA9IDQyOTQ5NTg3NjVdID0gXCJuYXZham93aGl0ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJuYXZ5XCJdID0gNDI3ODE5MDIwOF0gPSBcIm5hdnlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wib2xkbGFjZVwiXSA9IDQyOTQ4MzM2MzhdID0gXCJvbGRsYWNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9saXZlXCJdID0gNDI4NjYxMTQ1Nl0gPSBcIm9saXZlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9saXZlZHJhYlwiXSA9IDQyODUyMzg4MTldID0gXCJvbGl2ZWRyYWJcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wib3JhbmdlXCJdID0gNDI5NDk0NDAwMF0gPSBcIm9yYW5nZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJvcmFuZ2VyZWRcIl0gPSA0Mjk0OTE5NDI0XSA9IFwib3JhbmdlcmVkXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcIm9yY2hpZFwiXSA9IDQyOTI1MDU4MTRdID0gXCJvcmNoaWRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGFsZWdvbGRlbnJvZFwiXSA9IDQyOTM4NDcyMTBdID0gXCJwYWxlZ29sZGVucm9kXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGVncmVlblwiXSA9IDQyODgyMTU5NjBdID0gXCJwYWxlZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGFsZXR1cnF1b2lzZVwiXSA9IDQyODk3MjAwNDZdID0gXCJwYWxldHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBhbGV2aW9sZXRyZWRcIl0gPSA0MjkyNTcxMjgzXSA9IFwicGFsZXZpb2xldHJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwYXBheWF3aGlwXCJdID0gNDI5NDk2MzE1N10gPSBcInBhcGF5YXdoaXBcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGVhY2hwdWZmXCJdID0gNDI5NDk1Nzc1M10gPSBcInBlYWNocHVmZlwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwZXJ1XCJdID0gNDI5MTY1OTA3MV0gPSBcInBlcnVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicGlua1wiXSA9IDQyOTQ5NTExMTVdID0gXCJwaW5rXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInBsdW1cIl0gPSA0MjkyNzE0NzE3XSA9IFwicGx1bVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJwb3dkZXJibHVlXCJdID0gNDI4OTc4MTk5MF0gPSBcInBvd2RlcmJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicHVycGxlXCJdID0gNDI4NjU3ODgxNl0gPSBcInB1cnBsZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJyZWJlY2NhcHVycGxlXCJdID0gNDI4NDg4Nzk2MV0gPSBcInJlYmVjY2FwdXJwbGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wicmVkXCJdID0gNDI5NDkwMTc2MF0gPSBcInJlZFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJyb3N5YnJvd25cIl0gPSA0MjkwNTQ3NTk5XSA9IFwicm9zeWJyb3duXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInJveWFsYmx1ZVwiXSA9IDQyODI0NzcwMjVdID0gXCJyb3lhbGJsdWVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2FkZGxlYnJvd25cIl0gPSA0Mjg3MzE3MjY3XSA9IFwic2FkZGxlYnJvd25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2FsbW9uXCJdID0gNDI5NDYwNjk2Ml0gPSBcInNhbG1vblwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzYW5keWJyb3duXCJdID0gNDI5NDIyMjk0NF0gPSBcInNhbmR5YnJvd25cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2VhZ3JlZW5cIl0gPSA0MjgxMjQwNDA3XSA9IFwic2VhZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2Vhc2hlbGxcIl0gPSA0Mjk0OTY0NzE4XSA9IFwic2Vhc2hlbGxcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2llbm5hXCJdID0gNDI4ODY5Njg3N10gPSBcInNpZW5uYVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzaWx2ZXJcIl0gPSA0MjkwODIyMzM2XSA9IFwic2lsdmVyXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNreWJsdWVcIl0gPSA0Mjg3MDkwNDExXSA9IFwic2t5Ymx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzbGF0ZWJsdWVcIl0gPSA0Mjg1MTYwMTQxXSA9IFwic2xhdGVibHVlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInNsYXRlZ3JheVwiXSA9IDQyODU1NjMwMjRdID0gXCJzbGF0ZWdyYXlcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic2xhdGVncmV5XCJdID0gNDI4NTU2MzAyNF0gPSBcInNsYXRlZ3JleVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJzbm93XCJdID0gNDI5NDk2NjAxMF0gPSBcInNub3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic3ByaW5nZ3JlZW5cIl0gPSA0Mjc4MjU1NDg3XSA9IFwic3ByaW5nZ3JlZW5cIjtcbiAgICBjb2xvcnNbY29sb3JzW1wic3RlZWxibHVlXCJdID0gNDI4MjgxMTA2MF0gPSBcInN0ZWVsYmx1ZVwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0YW5cIl0gPSA0MjkxOTk4ODYwXSA9IFwidGFuXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInRlYWxcIl0gPSA0Mjc4MjIyOTc2XSA9IFwidGVhbFwiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0aGlzdGxlXCJdID0gNDI5MjM5NDk2OF0gPSBcInRoaXN0bGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1widG9tYXRvXCJdID0gNDI5NDkyNzE3NV0gPSBcInRvbWF0b1wiO1xuICAgIGNvbG9yc1tjb2xvcnNbXCJ0dXJxdW9pc2VcIl0gPSA0MjgyNDQxOTM2XSA9IFwidHVycXVvaXNlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInZpb2xldFwiXSA9IDQyOTM4MjExNjZdID0gXCJ2aW9sZXRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wid2hlYXRcIl0gPSA0Mjk0MzAzNDExXSA9IFwid2hlYXRcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wid2hpdGVcIl0gPSA0Mjk0OTY3Mjk1XSA9IFwid2hpdGVcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wid2hpdGVzbW9rZVwiXSA9IDQyOTQzMDkzNjVdID0gXCJ3aGl0ZXNtb2tlXCI7XG4gICAgY29sb3JzW2NvbG9yc1tcInllbGxvd1wiXSA9IDQyOTQ5NjcwNDBdID0gXCJ5ZWxsb3dcIjtcbiAgICBjb2xvcnNbY29sb3JzW1wieWVsbG93Z3JlZW5cIl0gPSA0Mjg4MzM1MTU0XSA9IFwieWVsbG93Z3JlZW5cIjtcbn0pKGNvbG9ycyA9IGV4cG9ydHMuY29sb3JzIHx8IChleHBvcnRzLmNvbG9ycyA9IHt9KSk7XG5mdW5jdGlvbiBwYXJzZUNvbG9yS2V5d29yZCh2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIGlmIChrZXl3b3JkICYmIGtleXdvcmQudmFsdWUgaW4gY29sb3JzKSB7XG4gICAgICAgIHZhciBlbmQgPSBrZXl3b3JkLmVuZDtcbiAgICAgICAgdmFyIHZhbHVlXzEgPSBjb2xvcnNba2V5d29yZC52YWx1ZV07XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZV8xIH07XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZXhwb3J0cy5wYXJzZUNvbG9yS2V5d29yZCA9IHBhcnNlQ29sb3JLZXl3b3JkO1xuZnVuY3Rpb24gcGFyc2VDb2xvcih2YWx1ZSwgc3RhcnQsIGtleXdvcmQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBpZiAoa2V5d29yZCA9PT0gdm9pZCAwKSB7IGtleXdvcmQgPSBwYXJzZUtleXdvcmQodmFsdWUsIHN0YXJ0KTsgfVxuICAgIHJldHVybiBwYXJzZUhleENvbG9yKHZhbHVlLCBzdGFydCkgfHwgcGFyc2VDb2xvcktleXdvcmQodmFsdWUsIHN0YXJ0LCBrZXl3b3JkKSB8fCBwYXJzZVJHQkNvbG9yKHZhbHVlLCBzdGFydCkgfHwgcGFyc2VSR0JBQ29sb3IodmFsdWUsIHN0YXJ0KTtcbn1cbmV4cG9ydHMucGFyc2VDb2xvciA9IHBhcnNlQ29sb3I7XG52YXIga2V5d29yZFJlZ0V4ID0gL1xccyooW2Etel1bXFx3XFwtXSopXFxzKi9naXk7XG5mdW5jdGlvbiBwYXJzZUtleXdvcmQodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICBrZXl3b3JkUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGtleXdvcmRSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0ga2V5d29yZFJlZ0V4Lmxhc3RJbmRleDtcbiAgICB2YXIgdmFsdWUgPSByZXN1bHRbMV07XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG52YXIgYmFja2dyb3VuZFJlcGVhdEtleXdvcmRzID0gbmV3IFNldChbXCJyZXBlYXRcIiwgXCJyZXBlYXQteFwiLCBcInJlcGVhdC15XCIsIFwibm8tcmVwZWF0XCJdKTtcbmZ1bmN0aW9uIHBhcnNlUmVwZWF0KHZhbHVlLCBzdGFydCwga2V5d29yZCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGlmIChrZXl3b3JkID09PSB2b2lkIDApIHsga2V5d29yZCA9IHBhcnNlS2V5d29yZCh2YWx1ZSwgc3RhcnQpOyB9XG4gICAgaWYgKGtleXdvcmQgJiYgYmFja2dyb3VuZFJlcGVhdEtleXdvcmRzLmhhcyhrZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICB2YXIgZW5kID0ga2V5d29yZC5lbmQ7XG4gICAgICAgIHZhciB2YWx1ZV8yID0ga2V5d29yZC52YWx1ZTtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlXzIgfTtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnBhcnNlUmVwZWF0ID0gcGFyc2VSZXBlYXQ7XG52YXIgdW5pdFJlZ0V4ID0gL1xccyooW1xcK1xcLV0/KD86XFxkK1xcLlxcZCt8XFxkK3xcXC5cXGQrKSg/OltlRV1bXFwrXFwtXT9cXGQrKT8pKFthLXpBLVpdK3wlKT9cXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VVbml0KHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdW5pdFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSB1bml0UmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHVuaXRSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIHZhbHVlID0gcGFyc2VGbG9hdChyZXN1bHRbMV0pO1xuICAgIHZhciB1bml0ID0gcmVzdWx0WzJdIHx8IFwiZGlwXCI7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdmFsdWU6IHZhbHVlLCB1bml0OiB1bml0IH0gfTtcbn1cbmV4cG9ydHMucGFyc2VVbml0ID0gcGFyc2VVbml0O1xuZnVuY3Rpb24gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgc3RhcnQpIHtcbiAgICBpZiAoc3RhcnQgPT09IHZvaWQgMCkgeyBzdGFydCA9IDA7IH1cbiAgICB2YXIgdW5pdFJlc3VsdCA9IHBhcnNlVW5pdCh0ZXh0LCBzdGFydCk7XG4gICAgaWYgKHVuaXRSZXN1bHQpIHtcbiAgICAgICAgdmFyIHN0YXJ0XzEgPSB1bml0UmVzdWx0LnN0YXJ0LCBlbmQgPSB1bml0UmVzdWx0LmVuZDtcbiAgICAgICAgdmFyIHZhbHVlID0gdW5pdFJlc3VsdC52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlLnVuaXQgPT09IFwiJVwiKSB7XG4gICAgICAgICAgICB2YWx1ZS52YWx1ZSAvPSAxMDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXZhbHVlLnVuaXQpIHtcbiAgICAgICAgICAgIHZhbHVlLnVuaXQgPSBcImRpcFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlLnVuaXQgPT09IFwicHhcIiB8fCB2YWx1ZS51bml0ID09PSBcImRpcFwiKSB7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnRfMSwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VQZXJjZW50YWdlT3JMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aDtcbnZhciBhbmdsZVVuaXRzVG9SYWRNYXAgPSB7XG4gICAgXCJkZWdcIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIGRlZykgeyByZXR1cm4gKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IGRlZyAvIDE4MCAqIE1hdGguUEkgfSk7IH0sXG4gICAgXCJyYWRcIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIHJhZCkgeyByZXR1cm4gKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHJhZCB9KTsgfSxcbiAgICBcImdyYWRcIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIGdyYWQpIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiBncmFkIC8gMjAwICogTWF0aC5QSSB9KTsgfSxcbiAgICBcInR1cm5cIjogZnVuY3Rpb24gKHN0YXJ0LCBlbmQsIHR1cm4pIHsgcmV0dXJuICh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB0dXJuICogTWF0aC5QSSAqIDIgfSk7IH1cbn07XG5mdW5jdGlvbiBwYXJzZUFuZ2xlKHZhbHVlLCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciBhbmdsZVJlc3VsdCA9IHBhcnNlVW5pdCh2YWx1ZSwgc3RhcnQpO1xuICAgIGlmIChhbmdsZVJlc3VsdCkge1xuICAgICAgICB2YXIgc3RhcnRfMiA9IGFuZ2xlUmVzdWx0LnN0YXJ0LCBlbmQgPSBhbmdsZVJlc3VsdC5lbmQsIHZhbHVlXzMgPSBhbmdsZVJlc3VsdC52YWx1ZTtcbiAgICAgICAgcmV0dXJuIChhbmdsZVVuaXRzVG9SYWRNYXBbdmFsdWVfMy51bml0XSB8fCAoZnVuY3Rpb24gKF8sIF9fLCBfX18pIHsgcmV0dXJuIG51bGw7IH0pKShzdGFydF8yLCBlbmQsIHZhbHVlXzMudmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VBbmdsZSA9IHBhcnNlQW5nbGU7XG52YXIgYmFja2dyb3VuZFNpemVLZXl3b3JkcyA9IG5ldyBTZXQoW1wiYXV0b1wiLCBcImNvbnRhaW5cIiwgXCJjb3ZlclwiXSk7XG5mdW5jdGlvbiBwYXJzZUJhY2tncm91bmRTaXplKHZhbHVlLCBzdGFydCwga2V5d29yZCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGlmIChrZXl3b3JkID09PSB2b2lkIDApIHsga2V5d29yZCA9IHBhcnNlS2V5d29yZCh2YWx1ZSwgc3RhcnQpOyB9XG4gICAgdmFyIGVuZCA9IHN0YXJ0O1xuICAgIGlmIChrZXl3b3JkICYmIGJhY2tncm91bmRTaXplS2V5d29yZHMuaGFzKGtleXdvcmQudmFsdWUpKSB7XG4gICAgICAgIGVuZCA9IGtleXdvcmQuZW5kO1xuICAgICAgICB2YXIgdmFsdWVfNCA9IGtleXdvcmQudmFsdWU7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZV80IH07XG4gICAgfVxuICAgIHZhciBmaXJzdExlbmd0aCA9IHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHZhbHVlLCBlbmQpO1xuICAgIGlmIChmaXJzdExlbmd0aCkge1xuICAgICAgICBlbmQgPSBmaXJzdExlbmd0aC5lbmQ7XG4gICAgICAgIHZhciBzZWNvbmRMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh2YWx1ZSwgZmlyc3RMZW5ndGguZW5kKTtcbiAgICAgICAgaWYgKHNlY29uZExlbmd0aCkge1xuICAgICAgICAgICAgZW5kID0gc2Vjb25kTGVuZ3RoLmVuZDtcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IGZpcnN0TGVuZ3RoLnZhbHVlLCB5OiBzZWNvbmRMZW5ndGgudmFsdWUgfSB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogZmlyc3RMZW5ndGgudmFsdWUsIHk6IFwiYXV0b1wiIH0gfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbn1cbmV4cG9ydHMucGFyc2VCYWNrZ3JvdW5kU2l6ZSA9IHBhcnNlQmFja2dyb3VuZFNpemU7XG52YXIgYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHMgPSBPYmplY3QuZnJlZXplKG5ldyBTZXQoW1wibGVmdFwiLCBcInJpZ2h0XCIsIFwidG9wXCIsIFwiYm90dG9tXCIsIFwiY2VudGVyXCJdKSk7XG52YXIgYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHNEaXJlY3Rpb24gPSB7XG4gICAgXCJsZWZ0XCI6IFwieFwiLFxuICAgIFwicmlnaHRcIjogXCJ4XCIsXG4gICAgXCJjZW50ZXJcIjogXCJjZW50ZXJcIixcbiAgICBcInRvcFwiOiBcInlcIixcbiAgICBcImJvdHRvbVwiOiBcInlcIlxufTtcbmZ1bmN0aW9uIHBhcnNlQmFja2dyb3VuZFBvc2l0aW9uKHRleHQsIHN0YXJ0LCBrZXl3b3JkKSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgaWYgKGtleXdvcmQgPT09IHZvaWQgMCkgeyBrZXl3b3JkID0gcGFyc2VLZXl3b3JkKHRleHQsIHN0YXJ0KTsgfVxuICAgIGZ1bmN0aW9uIGZvcm1hdEgoYWxpZ24sIG9mZnNldCkge1xuICAgICAgICBpZiAoYWxpZ24udmFsdWUgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcImNlbnRlclwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvZmZzZXQgJiYgb2Zmc2V0LnZhbHVlLnZhbHVlICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4geyBhbGlnbjogYWxpZ24udmFsdWUsIG9mZnNldDogb2Zmc2V0LnZhbHVlIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsaWduLnZhbHVlO1xuICAgIH1cbiAgICBmdW5jdGlvbiBmb3JtYXRWKGFsaWduLCBvZmZzZXQpIHtcbiAgICAgICAgaWYgKGFsaWduLnZhbHVlID09PSBcImNlbnRlclwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJjZW50ZXJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAob2Zmc2V0ICYmIG9mZnNldC52YWx1ZS52YWx1ZSAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgYWxpZ246IGFsaWduLnZhbHVlLCBvZmZzZXQ6IG9mZnNldC52YWx1ZSB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhbGlnbi52YWx1ZTtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHN0YXJ0O1xuICAgIGlmIChrZXl3b3JkICYmIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzLmhhcyhrZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICBlbmQgPSBrZXl3b3JkLmVuZDtcbiAgICAgICAgdmFyIGZpcnN0RGlyZWN0aW9uID0gYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHNEaXJlY3Rpb25ba2V5d29yZC52YWx1ZV07XG4gICAgICAgIHZhciBmaXJzdExlbmd0aCA9IGZpcnN0RGlyZWN0aW9uICE9PSBcImNlbnRlclwiICYmIHBhcnNlUGVyY2VudGFnZU9yTGVuZ3RoKHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChmaXJzdExlbmd0aCkge1xuICAgICAgICAgICAgZW5kID0gZmlyc3RMZW5ndGguZW5kO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzZWNvbmRLZXl3b3JkID0gcGFyc2VLZXl3b3JkKHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChzZWNvbmRLZXl3b3JkICYmIGJhY2tncm91bmRQb3NpdGlvbktleXdvcmRzLmhhcyhzZWNvbmRLZXl3b3JkLnZhbHVlKSkge1xuICAgICAgICAgICAgZW5kID0gc2Vjb25kS2V5d29yZC5lbmQ7XG4gICAgICAgICAgICB2YXIgc2Vjb25kRGlyZWN0aW9uID0gYmFja2dyb3VuZFBvc2l0aW9uS2V5d29yZHNEaXJlY3Rpb25bc2Vjb25kS2V5d29yZC5lbmRdO1xuICAgICAgICAgICAgaWYgKGZpcnN0RGlyZWN0aW9uID09PSBzZWNvbmREaXJlY3Rpb24gJiYgZmlyc3REaXJlY3Rpb24gIT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBzZWNvbmRMZW5ndGggPSBzZWNvbmREaXJlY3Rpb24gIT09IFwiY2VudGVyXCIgJiYgcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICAgICAgICAgIGlmIChzZWNvbmRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBlbmQgPSBzZWNvbmRMZW5ndGguZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChmaXJzdERpcmVjdGlvbiA9PT0gc2Vjb25kRGlyZWN0aW9uICYmIHNlY29uZERpcmVjdGlvbiA9PT0gXCJjZW50ZXJcIikgfHwgKGZpcnN0RGlyZWN0aW9uID09PSBcInhcIiB8fCBzZWNvbmREaXJlY3Rpb24gPT09IFwieVwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4OiBmb3JtYXRIKGtleXdvcmQsIGZpcnN0TGVuZ3RoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHk6IGZvcm1hdFYoc2Vjb25kS2V5d29yZCwgc2Vjb25kTGVuZ3RoKVxuICAgICAgICAgICAgICAgICAgICB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgeDogZm9ybWF0SChzZWNvbmRLZXl3b3JkLCBzZWNvbmRMZW5ndGgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgeTogZm9ybWF0VihrZXl3b3JkLCBmaXJzdExlbmd0aCksXG4gICAgICAgICAgICAgICAgICAgIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChmaXJzdERpcmVjdGlvbiA9PT0gXCJjZW50ZXJcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IHg6IFwiY2VudGVyXCIsIHk6IFwiY2VudGVyXCIgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZmlyc3REaXJlY3Rpb24gPT09IFwieFwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogZm9ybWF0SChrZXl3b3JkLCBmaXJzdExlbmd0aCksIHk6IFwiY2VudGVyXCIgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogXCJjZW50ZXJcIiwgeTogZm9ybWF0VihrZXl3b3JkLCBmaXJzdExlbmd0aCkgfSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgZmlyc3RMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh0ZXh0LCBlbmQpO1xuICAgICAgICBpZiAoZmlyc3RMZW5ndGgpIHtcbiAgICAgICAgICAgIGVuZCA9IGZpcnN0TGVuZ3RoLmVuZDtcbiAgICAgICAgICAgIHZhciBzZWNvbmRMZW5ndGggPSBwYXJzZVBlcmNlbnRhZ2VPckxlbmd0aCh0ZXh0LCBlbmQpO1xuICAgICAgICAgICAgaWYgKHNlY29uZExlbmd0aCkge1xuICAgICAgICAgICAgICAgIGVuZCA9IHNlY29uZExlbmd0aC5lbmQ7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgeDogeyBhbGlnbjogXCJsZWZ0XCIsIG9mZnNldDogZmlyc3RMZW5ndGgudmFsdWUgfSwgeTogeyBhbGlnbjogXCJ0b3BcIiwgb2Zmc2V0OiBzZWNvbmRMZW5ndGgudmFsdWUgfSB9IH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB4OiB7IGFsaWduOiBcImxlZnRcIiwgb2Zmc2V0OiBmaXJzdExlbmd0aC52YWx1ZSB9LCB5OiBcImNlbnRlclwiIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5wYXJzZUJhY2tncm91bmRQb3NpdGlvbiA9IHBhcnNlQmFja2dyb3VuZFBvc2l0aW9uO1xudmFyIGRpcmVjdGlvblJlZ0V4ID0gL1xccyp0b1xccyoobGVmdHxyaWdodHx0b3B8Ym90dG9tKVxccyoobGVmdHxyaWdodHx0b3B8Ym90dG9tKT9cXHMqL2d5O1xudmFyIHNpZGVEaXJlY3Rpb25zID0ge1xuICAgIHRvcDogTWF0aC5QSSAqIDAgLyAyLFxuICAgIHJpZ2h0OiBNYXRoLlBJICogMSAvIDIsXG4gICAgYm90dG9tOiBNYXRoLlBJICogMiAvIDIsXG4gICAgbGVmdDogTWF0aC5QSSAqIDMgLyAyXG59O1xudmFyIGNvcm5lckRpcmVjdGlvbnMgPSB7XG4gICAgdG9wOiB7XG4gICAgICAgIHJpZ2h0OiBNYXRoLlBJICogMSAvIDQsXG4gICAgICAgIGxlZnQ6IE1hdGguUEkgKiA3IC8gNFxuICAgIH0sXG4gICAgcmlnaHQ6IHtcbiAgICAgICAgdG9wOiBNYXRoLlBJICogMSAvIDQsXG4gICAgICAgIGJvdHRvbTogTWF0aC5QSSAqIDMgLyA0XG4gICAgfSxcbiAgICBib3R0b206IHtcbiAgICAgICAgcmlnaHQ6IE1hdGguUEkgKiAzIC8gNCxcbiAgICAgICAgbGVmdDogTWF0aC5QSSAqIDUgLyA0XG4gICAgfSxcbiAgICBsZWZ0OiB7XG4gICAgICAgIHRvcDogTWF0aC5QSSAqIDcgLyA0LFxuICAgICAgICBib3R0b206IE1hdGguUEkgKiA1IC8gNFxuICAgIH1cbn07XG5mdW5jdGlvbiBwYXJzZURpcmVjdGlvbih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGRpcmVjdGlvblJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBkaXJlY3Rpb25SZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gZGlyZWN0aW9uUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBmaXJzdERpcmVjdGlvbiA9IHJlc3VsdFsxXTtcbiAgICBpZiAocmVzdWx0WzJdKSB7XG4gICAgICAgIHZhciBzZWNvbmREaXJlY3Rpb24gPSByZXN1bHRbMl07XG4gICAgICAgIHZhciB2YWx1ZSA9IGNvcm5lckRpcmVjdGlvbnNbZmlyc3REaXJlY3Rpb25dW3NlY29uZERpcmVjdGlvbl07XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogc2lkZURpcmVjdGlvbnNbZmlyc3REaXJlY3Rpb25dIH07XG4gICAgfVxufVxudmFyIG9wZW5pbmdCcmFja2V0UmVnRXggPSAvXFxzKlxcKFxccyovZ3k7XG52YXIgY2xvc2luZ0JyYWNrZXRSZWdFeCA9IC9cXHMqXFwpXFxzKi9neTtcbnZhciBjbG9zaW5nQnJhY2tldE9yQ29tbWFSZWdFeCA9IC9cXHMqKFxcKXwsKVxccyovZ3k7XG5mdW5jdGlvbiBwYXJzZUFyZ3VtZW50c0xpc3QodGV4dCwgc3RhcnQsIGFyZ3VtZW50KSB7XG4gICAgb3BlbmluZ0JyYWNrZXRSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgb3BlbmluZ0JyYWNrZXQgPSBvcGVuaW5nQnJhY2tldFJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFvcGVuaW5nQnJhY2tldCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IG9wZW5pbmdCcmFja2V0UmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IFtdO1xuICAgIGNsb3NpbmdCcmFja2V0UmVnRXgubGFzdEluZGV4ID0gZW5kO1xuICAgIHZhciBjbG9zaW5nQnJhY2tldCA9IGNsb3NpbmdCcmFja2V0UmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoY2xvc2luZ0JyYWNrZXQpIHtcbiAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgfVxuICAgIGZvciAodmFyIGluZGV4XzEgPSAwOyB0cnVlOyBpbmRleF8xKyspIHtcbiAgICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50KHRleHQsIGVuZCwgaW5kZXhfMSk7XG4gICAgICAgIGlmICghYXJnKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBlbmQgPSBhcmcuZW5kO1xuICAgICAgICB2YWx1ZS5wdXNoKGFyZyk7XG4gICAgICAgIGNsb3NpbmdCcmFja2V0T3JDb21tYVJlZ0V4Lmxhc3RJbmRleCA9IGVuZDtcbiAgICAgICAgdmFyIGNsb3NpbmdCcmFja2V0T3JDb21tYSA9IGNsb3NpbmdCcmFja2V0T3JDb21tYVJlZ0V4LmV4ZWModGV4dCk7XG4gICAgICAgIGlmIChjbG9zaW5nQnJhY2tldE9yQ29tbWEpIHtcbiAgICAgICAgICAgIGVuZCA9IGNsb3NpbmdCcmFja2V0T3JDb21tYVJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgICAgIGlmIChjbG9zaW5nQnJhY2tldE9yQ29tbWFbMV0gPT09IFwiLFwiKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChjbG9zaW5nQnJhY2tldE9yQ29tbWFbMV0gPT09IFwiKVwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHBhcnNlQ29sb3JTdG9wKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdmFyIGNvbG9yID0gcGFyc2VDb2xvcih0ZXh0LCBzdGFydCk7XG4gICAgaWYgKCFjb2xvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGNvbG9yLmVuZDtcbiAgICB2YXIgb2Zmc2V0ID0gcGFyc2VQZXJjZW50YWdlT3JMZW5ndGgodGV4dCwgZW5kKTtcbiAgICBpZiAob2Zmc2V0KSB7XG4gICAgICAgIGVuZCA9IG9mZnNldC5lbmQ7XG4gICAgICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IGFyZ2I6IGNvbG9yLnZhbHVlLCBvZmZzZXQ6IG9mZnNldC52YWx1ZSB9IH07XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB7IGFyZ2I6IGNvbG9yLnZhbHVlIH0gfTtcbn1cbmV4cG9ydHMucGFyc2VDb2xvclN0b3AgPSBwYXJzZUNvbG9yU3RvcDtcbnZhciBsaW5lYXJHcmFkaWVudFN0YXJ0UmVnRXggPSAvXFxzKmxpbmVhci1ncmFkaWVudFxccyovZ3k7XG5mdW5jdGlvbiBwYXJzZUxpbmVhckdyYWRpZW50KHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgbGluZWFyR3JhZGllbnRTdGFydFJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciBsZ3MgPSBsaW5lYXJHcmFkaWVudFN0YXJ0UmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIWxncykge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGxpbmVhckdyYWRpZW50U3RhcnRSZWdFeC5sYXN0SW5kZXg7XG4gICAgdmFyIGFuZ2xlID0gTWF0aC5QSTtcbiAgICB2YXIgY29sb3JzID0gW107XG4gICAgdmFyIHBhcnNlZEFyZ3MgPSBwYXJzZUFyZ3VtZW50c0xpc3QodGV4dCwgZW5kLCBmdW5jdGlvbiAodGV4dCwgc3RhcnQsIGluZGV4KSB7XG4gICAgICAgIGlmIChpbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGFuZ2xlQXJnID0gcGFyc2VBbmdsZSh0ZXh0LCBzdGFydCkgfHwgcGFyc2VEaXJlY3Rpb24odGV4dCwgc3RhcnQpO1xuICAgICAgICAgICAgaWYgKGFuZ2xlQXJnKSB7XG4gICAgICAgICAgICAgICAgYW5nbGUgPSBhbmdsZUFyZy52YWx1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYW5nbGVBcmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbG9yU3RvcCA9IHBhcnNlQ29sb3JTdG9wKHRleHQsIHN0YXJ0KTtcbiAgICAgICAgaWYgKGNvbG9yU3RvcCkge1xuICAgICAgICAgICAgY29sb3JzLnB1c2goY29sb3JTdG9wLnZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBjb2xvclN0b3A7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSk7XG4gICAgaWYgKCFwYXJzZWRBcmdzKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBlbmQgPSBwYXJzZWRBcmdzLmVuZDtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyBhbmdsZTogYW5nbGUsIGNvbG9yczogY29sb3JzIH0gfTtcbn1cbmV4cG9ydHMucGFyc2VMaW5lYXJHcmFkaWVudCA9IHBhcnNlTGluZWFyR3JhZGllbnQ7XG52YXIgc2xhc2hSZWdFeCA9IC9cXHMqKFxcLylcXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VTbGFzaCh0ZXh0LCBzdGFydCkge1xuICAgIHNsYXNoUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHNsYXNoID0gc2xhc2hSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghc2xhc2gpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBzbGFzaFJlZ0V4Lmxhc3RJbmRleDtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogXCIvXCIgfTtcbn1cbmZ1bmN0aW9uIHBhcnNlQmFja2dyb3VuZCh0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciB2YWx1ZSA9IHt9O1xuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICB3aGlsZSAoZW5kIDwgdGV4dC5sZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleXdvcmQgPSBwYXJzZUtleXdvcmQodGV4dCwgZW5kKTtcbiAgICAgICAgdmFyIGNvbG9yID0gcGFyc2VDb2xvcih0ZXh0LCBlbmQsIGtleXdvcmQpO1xuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIHZhbHVlLmNvbG9yID0gY29sb3IudmFsdWU7XG4gICAgICAgICAgICBlbmQgPSBjb2xvci5lbmQ7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVwZWF0ID0gcGFyc2VSZXBlYXQodGV4dCwgZW5kLCBrZXl3b3JkKTtcbiAgICAgICAgaWYgKHJlcGVhdCkge1xuICAgICAgICAgICAgdmFsdWUucmVwZWF0ID0gcmVwZWF0LnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gcmVwZWF0LmVuZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwb3NpdGlvbiA9IHBhcnNlQmFja2dyb3VuZFBvc2l0aW9uKHRleHQsIGVuZCwga2V5d29yZCk7XG4gICAgICAgIGlmIChwb3NpdGlvbikge1xuICAgICAgICAgICAgcG9zaXRpb24udmFsdWUudGV4dCA9IHRleHQuc3Vic3RyaW5nKHBvc2l0aW9uLnN0YXJ0LCBwb3NpdGlvbi5lbmQpO1xuICAgICAgICAgICAgdmFsdWUucG9zaXRpb24gPSBwb3NpdGlvbi52YWx1ZTtcbiAgICAgICAgICAgIGVuZCA9IHBvc2l0aW9uLmVuZDtcbiAgICAgICAgICAgIHZhciBzbGFzaCA9IHBhcnNlU2xhc2godGV4dCwgZW5kKTtcbiAgICAgICAgICAgIGlmIChzbGFzaCkge1xuICAgICAgICAgICAgICAgIGVuZCA9IHNsYXNoLmVuZDtcbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IHBhcnNlQmFja2dyb3VuZFNpemUodGV4dCwgZW5kKTtcbiAgICAgICAgICAgICAgICBpZiAoIXNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhbHVlLnNpemUgPSBzaXplLnZhbHVlO1xuICAgICAgICAgICAgICAgIGVuZCA9IHNpemUuZW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHVybCA9IHBhcnNlVVJMKHRleHQsIGVuZCk7XG4gICAgICAgIGlmICh1cmwpIHtcbiAgICAgICAgICAgIHZhbHVlLmltYWdlID0gdXJsLnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gdXJsLmVuZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBncmFkaWVudCA9IHBhcnNlTGluZWFyR3JhZGllbnQodGV4dCwgZW5kKTtcbiAgICAgICAgaWYgKGdyYWRpZW50KSB7XG4gICAgICAgICAgICB2YWx1ZS5pbWFnZSA9IGdyYWRpZW50LnZhbHVlO1xuICAgICAgICAgICAgZW5kID0gZ3JhZGllbnQuZW5kO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZUJhY2tncm91bmQgPSBwYXJzZUJhY2tncm91bmQ7XG52YXIgdW5pdmVyc2FsU2VsZWN0b3JSZWdFeCA9IC9cXCovZ3k7XG5mdW5jdGlvbiBwYXJzZVVuaXZlcnNhbFNlbGVjdG9yKHRleHQsIHN0YXJ0KSB7XG4gICAgaWYgKHN0YXJ0ID09PSB2b2lkIDApIHsgc3RhcnQgPSAwOyB9XG4gICAgdW5pdmVyc2FsU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gdW5pdmVyc2FsU2VsZWN0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gdW5pdmVyc2FsU2VsZWN0b3JSZWdFeC5sYXN0SW5kZXg7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHsgdHlwZTogXCIqXCIgfSB9O1xufVxuZXhwb3J0cy5wYXJzZVVuaXZlcnNhbFNlbGVjdG9yID0gcGFyc2VVbml2ZXJzYWxTZWxlY3RvcjtcbnZhciBzaW1wbGVJZGVudGlmaWVyU2VsZWN0b3JSZWdFeCA9IC8oI3xcXC58OnxcXGIpKFtfLVxcd11bXy1cXHdcXGRdKikvZ3k7XG5mdW5jdGlvbiBwYXJzZVNpbXBsZUlkZW50aWZpZXJTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHNpbXBsZUlkZW50aWZpZXJTZWxlY3RvclJlZ0V4Lmxhc3RJbmRleCA9IHN0YXJ0O1xuICAgIHZhciByZXN1bHQgPSBzaW1wbGVJZGVudGlmaWVyU2VsZWN0b3JSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICB2YXIgZW5kID0gc2ltcGxlSWRlbnRpZmllclNlbGVjdG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB0eXBlID0gcmVzdWx0WzFdO1xuICAgIHZhciBpZGVudGlmaWVyID0gcmVzdWx0WzJdO1xuICAgIHZhciB2YWx1ZSA9IHsgdHlwZTogdHlwZSwgaWRlbnRpZmllcjogaWRlbnRpZmllciB9O1xuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZVNpbXBsZUlkZW50aWZpZXJTZWxlY3RvciA9IHBhcnNlU2ltcGxlSWRlbnRpZmllclNlbGVjdG9yO1xudmFyIGF0dHJpYnV0ZVNlbGVjdG9yUmVnRXggPSAvXFxbXFxzKihbXy1cXHddW18tXFx3XFxkXSopXFxzKig/Oig9fFxcXj18XFwkPXxcXCo9fFxcfj18XFx8PSlcXHMqKD86KFtfLVxcd11bXy1cXHdcXGRdKil8XCIoKD86W15cXFxcXCJdfFxcXFwoPzpcInxufHJ8ZnxcXFxcfDAtOWEtZikpKilcInwnKCg/OlteXFxcXCddfFxcXFwoPzonfG58cnxmfFxcXFx8MC05YS1mKSkqKScpXFxzKik/XFxdL2d5O1xuZnVuY3Rpb24gcGFyc2VBdHRyaWJ1dGVTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGF0dHJpYnV0ZVNlbGVjdG9yUmVnRXgubGFzdEluZGV4ID0gc3RhcnQ7XG4gICAgdmFyIHJlc3VsdCA9IGF0dHJpYnV0ZVNlbGVjdG9yUmVnRXguZXhlYyh0ZXh0KTtcbiAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IGF0dHJpYnV0ZVNlbGVjdG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciBwcm9wZXJ0eSA9IHJlc3VsdFsxXTtcbiAgICBpZiAocmVzdWx0WzJdKSB7XG4gICAgICAgIHZhciB0ZXN0XzEgPSByZXN1bHRbMl07XG4gICAgICAgIHZhciB2YWx1ZSA9IHJlc3VsdFszXSB8fCByZXN1bHRbNF0gfHwgcmVzdWx0WzVdO1xuICAgICAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB0eXBlOiBcIltdXCIsIHByb3BlcnR5OiBwcm9wZXJ0eSwgdGVzdDogdGVzdF8xLCB2YWx1ZTogdmFsdWUgfSB9O1xuICAgIH1cbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogeyB0eXBlOiBcIltdXCIsIHByb3BlcnR5OiBwcm9wZXJ0eSB9IH07XG59XG5leHBvcnRzLnBhcnNlQXR0cmlidXRlU2VsZWN0b3IgPSBwYXJzZUF0dHJpYnV0ZVNlbGVjdG9yO1xuZnVuY3Rpb24gcGFyc2VTaW1wbGVTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHJldHVybiBwYXJzZVVuaXZlcnNhbFNlbGVjdG9yKHRleHQsIHN0YXJ0KSB8fFxuICAgICAgICBwYXJzZVNpbXBsZUlkZW50aWZpZXJTZWxlY3Rvcih0ZXh0LCBzdGFydCkgfHxcbiAgICAgICAgcGFyc2VBdHRyaWJ1dGVTZWxlY3Rvcih0ZXh0LCBzdGFydCk7XG59XG5leHBvcnRzLnBhcnNlU2ltcGxlU2VsZWN0b3IgPSBwYXJzZVNpbXBsZVNlbGVjdG9yO1xuZnVuY3Rpb24gcGFyc2VTaW1wbGVTZWxlY3RvclNlcXVlbmNlKHRleHQsIHN0YXJ0KSB7XG4gICAgdmFyIHNpbXBsZVNlbGVjdG9yID0gcGFyc2VTaW1wbGVTZWxlY3Rvcih0ZXh0LCBzdGFydCk7XG4gICAgaWYgKCFzaW1wbGVTZWxlY3Rvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIGVuZCA9IHNpbXBsZVNlbGVjdG9yLmVuZDtcbiAgICB2YXIgdmFsdWUgPSBbXTtcbiAgICB3aGlsZSAoc2ltcGxlU2VsZWN0b3IpIHtcbiAgICAgICAgdmFsdWUucHVzaChzaW1wbGVTZWxlY3Rvci52YWx1ZSk7XG4gICAgICAgIGVuZCA9IHNpbXBsZVNlbGVjdG9yLmVuZDtcbiAgICAgICAgc2ltcGxlU2VsZWN0b3IgPSBwYXJzZVNpbXBsZVNlbGVjdG9yKHRleHQsIGVuZCk7XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQsIHZhbHVlOiB2YWx1ZSB9O1xufVxuZXhwb3J0cy5wYXJzZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSBwYXJzZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2U7XG52YXIgY29tYmluYXRvclJlZ0V4ID0gL1xccyooXFwrfH58Pik/XFxzKi9neTtcbmZ1bmN0aW9uIHBhcnNlQ29tYmluYXRvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIGNvbWJpbmF0b3JSZWdFeC5sYXN0SW5kZXggPSBzdGFydDtcbiAgICB2YXIgcmVzdWx0ID0gY29tYmluYXRvclJlZ0V4LmV4ZWModGV4dCk7XG4gICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBlbmQgPSBjb21iaW5hdG9yUmVnRXgubGFzdEluZGV4O1xuICAgIHZhciB2YWx1ZSA9IHJlc3VsdFsxXSB8fCBcIiBcIjtcbiAgICByZXR1cm4geyBzdGFydDogc3RhcnQsIGVuZDogZW5kLCB2YWx1ZTogdmFsdWUgfTtcbn1cbmV4cG9ydHMucGFyc2VDb21iaW5hdG9yID0gcGFyc2VDb21iaW5hdG9yO1xudmFyIHdoaXRlU3BhY2VSZWdFeCA9IC9cXHMqL2d5O1xuZnVuY3Rpb24gcGFyc2VTZWxlY3Rvcih0ZXh0LCBzdGFydCkge1xuICAgIGlmIChzdGFydCA9PT0gdm9pZCAwKSB7IHN0YXJ0ID0gMDsgfVxuICAgIHZhciBlbmQgPSBzdGFydDtcbiAgICB3aGl0ZVNwYWNlUmVnRXgubGFzdEluZGV4ID0gZW5kO1xuICAgIHZhciBsZWFkaW5nV2hpdGVTcGFjZSA9IHdoaXRlU3BhY2VSZWdFeC5leGVjKHRleHQpO1xuICAgIGlmIChsZWFkaW5nV2hpdGVTcGFjZSkge1xuICAgICAgICBlbmQgPSB3aGl0ZVNwYWNlUmVnRXgubGFzdEluZGV4O1xuICAgIH1cbiAgICB2YXIgdmFsdWUgPSBbXTtcbiAgICB2YXIgY29tYmluYXRvcjtcbiAgICB2YXIgZXhwZWN0U2ltcGxlU2VsZWN0b3IgPSB0cnVlO1xuICAgIHZhciBwYWlyO1xuICAgIGRvIHtcbiAgICAgICAgdmFyIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSBwYXJzZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2UodGV4dCwgZW5kKTtcbiAgICAgICAgaWYgKCFzaW1wbGVTZWxlY3RvclNlcXVlbmNlKSB7XG4gICAgICAgICAgICBpZiAoZXhwZWN0U2ltcGxlU2VsZWN0b3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVuZCA9IHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UuZW5kO1xuICAgICAgICBpZiAoY29tYmluYXRvcikge1xuICAgICAgICAgICAgcGFpclsxXSA9IGNvbWJpbmF0b3IudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcGFpciA9IFtzaW1wbGVTZWxlY3RvclNlcXVlbmNlLnZhbHVlLCB1bmRlZmluZWRdO1xuICAgICAgICB2YWx1ZS5wdXNoKHBhaXIpO1xuICAgICAgICBjb21iaW5hdG9yID0gcGFyc2VDb21iaW5hdG9yKHRleHQsIGVuZCk7XG4gICAgICAgIGlmIChjb21iaW5hdG9yKSB7XG4gICAgICAgICAgICBlbmQgPSBjb21iaW5hdG9yLmVuZDtcbiAgICAgICAgfVxuICAgICAgICBleHBlY3RTaW1wbGVTZWxlY3RvciA9IGNvbWJpbmF0b3IgJiYgY29tYmluYXRvci52YWx1ZSAhPT0gXCIgXCI7XG4gICAgfSB3aGlsZSAoY29tYmluYXRvcik7XG4gICAgcmV0dXJuIHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCwgdmFsdWU6IHZhbHVlIH07XG59XG5leHBvcnRzLnBhcnNlU2VsZWN0b3IgPSBwYXJzZVNlbGVjdG9yO1xudmFyIHdoaXRlc3BhY2VSZWdFeCA9IC9bXFxzXFx0XFxuXFxyXFxmXSovZ3ltO1xudmFyIHNpbmdsZVF1b3RlU3RyaW5nUmVnRXggPSAvJygoPzpbXlxcblxcclxcZlxcJ118XFxcXCg/OlxcJHxcXG58WzAtOWEtZkEtRl17MSw2fVxccz8pKSopKDo/J3wkKS9neW07XG52YXIgZG91YmxlUXVvdGVTdHJpbmdSZWdFeCA9IC9cIigoPzpbXlxcblxcclxcZlxcXCJdfFxcXFwoPzpcXCR8XFxufFswLTlhLWZBLUZdezEsNn1cXHM/KSkqKSg6P1wifCQpL2d5bTtcbnZhciBjb21tZW50UmVnRXggPSAvKFxcL1xcKig/OlteXFwqXXxcXCpbXlxcL10pKlxcKlxcLykvZ3ltO1xudmFyIG51bWJlclJlZ0V4ID0gL1tcXCtcXC1dPyg/OlxcZCtcXC5cXGQrfFxcZCt8XFwuXFxkKykoPzpbZUVdW1xcK1xcLV0/XFxkKyk/L2d5bTtcbnZhciBuYW1lUmVnRXggPSAvLT8oPzooPzpbYS16QS1aX118W15cXHgwMC1cXHg3Rl18XFxcXCg/OlxcJHxcXG58WzAtOWEtZkEtRl17MSw2fVxccz8pKSg/OlthLXpBLVpfMC05XFwtXSp8XFxcXCg/OlxcJHxcXG58WzAtOWEtZkEtRl17MSw2fVxccz8pKSopL2d5bTtcbnZhciBDU1MzUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDU1MzUGFyc2VyKHRleHQpIHtcbiAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDtcbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IDA7XG4gICAgfVxuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLnRva2VuaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9rZW5zID0gW107XG4gICAgICAgIHZhciBpbnB1dFRva2VuO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCk7XG4gICAgICAgICAgICB0b2tlbnMucHVzaChpbnB1dFRva2VuKTtcbiAgICAgICAgfSB3aGlsZSAoaW5wdXRUb2tlbik7XG4gICAgICAgIHJldHVybiB0b2tlbnM7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5yZWNvbnN1bWVkSW5wdXRUb2tlbikge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMucmVjb25zdW1lZElucHV0VG9rZW47XG4gICAgICAgICAgICB0aGlzLnJlY29uc3VtZWRJbnB1dFRva2VuID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoYXIgPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF07XG4gICAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICAgICAgY2FzZSBcIlxcXCJcIjogcmV0dXJuIHRoaXMuY29uc3VtZUFTdHJpbmdUb2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIidcIjogcmV0dXJuIHRoaXMuY29uc3VtZUFTdHJpbmdUb2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIihcIjpcbiAgICAgICAgICAgIGNhc2UgXCIpXCI6XG4gICAgICAgICAgICBjYXNlIFwiLFwiOlxuICAgICAgICAgICAgY2FzZSBcIjpcIjpcbiAgICAgICAgICAgIGNhc2UgXCI7XCI6XG4gICAgICAgICAgICBjYXNlIFwiW1wiOlxuICAgICAgICAgICAgY2FzZSBcIl1cIjpcbiAgICAgICAgICAgIGNhc2UgXCJ7XCI6XG4gICAgICAgICAgICBjYXNlIFwifVwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hhcjtcbiAgICAgICAgICAgIGNhc2UgXCIjXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBSGFzaFRva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIgXCI6XG4gICAgICAgICAgICBjYXNlIFwiXFx0XCI6XG4gICAgICAgICAgICBjYXNlIFwiXFxuXCI6XG4gICAgICAgICAgICBjYXNlIFwiXFxyXCI6XG4gICAgICAgICAgICBjYXNlIFwiXFxmXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFXaGl0ZXNwYWNlKCk7XG4gICAgICAgICAgICBjYXNlIFwiQFwiOiByZXR1cm4gdGhpcy5jb25zdW1lQXRLZXl3b3JkKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCJcXFxcXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBbklkZW50TGlrZVRva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCIwXCI6XG4gICAgICAgICAgICBjYXNlIFwiMVwiOlxuICAgICAgICAgICAgY2FzZSBcIjJcIjpcbiAgICAgICAgICAgIGNhc2UgXCIzXCI6XG4gICAgICAgICAgICBjYXNlIFwiNFwiOlxuICAgICAgICAgICAgY2FzZSBcIjVcIjpcbiAgICAgICAgICAgIGNhc2UgXCI2XCI6XG4gICAgICAgICAgICBjYXNlIFwiN1wiOlxuICAgICAgICAgICAgY2FzZSBcIjhcIjpcbiAgICAgICAgICAgIGNhc2UgXCI5XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFOdW1lcmljVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCJ1XCI6XG4gICAgICAgICAgICBjYXNlIFwiVVwiOlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArIDFdID09PSBcIitcIikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGhpcmRDaGFyID0gdGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXJkQ2hhciA+PSBcIjBcIiAmJiB0aGlyZENoYXIgPD0gXCI5XCIgfHwgdGhpcmRDaGFyID09PSBcIj9cIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5pY29kZSB0b2tlbnMgbm90IHN1cHBvcnRlZCFcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFuSWRlbnRMaWtlVG9rZW4oKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIiRcIjpcbiAgICAgICAgICAgIGNhc2UgXCIqXCI6XG4gICAgICAgICAgICBjYXNlIFwiXlwiOlxuICAgICAgICAgICAgY2FzZSBcInxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJ+XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFNYXRjaFRva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgICAgIGNhc2UgXCItXCI6IHJldHVybiB0aGlzLmNvbnN1bWVBTnVtZXJpY1Rva2VuKCkgfHwgdGhpcy5jb25zdW1lQW5JZGVudExpa2VUb2tlbigpIHx8IHRoaXMuY29uc3VtZUNEQygpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiK1wiOlxuICAgICAgICAgICAgY2FzZSBcIi5cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQU51bWVyaWNUb2tlbigpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIFwiL1wiOiByZXR1cm4gdGhpcy5jb25zdW1lQUNvbW1lbnQoKSB8fCB0aGlzLmNvbnN1bWVBRGVsaW1Ub2tlbigpO1xuICAgICAgICAgICAgY2FzZSBcIjxcIjogcmV0dXJuIHRoaXMuY29uc3VtZUNETygpIHx8IHRoaXMuY29uc3VtZUFEZWxpbVRva2VuKCk7XG4gICAgICAgICAgICBjYXNlIHVuZGVmaW5lZDogcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIGRlZmF1bHQ6IHJldHVybiB0aGlzLmNvbnN1bWVBbklkZW50TGlrZVRva2VuKCkgfHwgdGhpcy5jb25zdW1lQURlbGltVG9rZW4oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFEZWxpbVRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4geyB0eXBlOiAyLCB0ZXh0OiB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrXSB9O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFXaGl0ZXNwYWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB3aGl0ZXNwYWNlUmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgd2hpdGVzcGFjZVJlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IHdoaXRlc3BhY2VSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIHJldHVybiBcIiBcIjtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBSGFzaFRva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgIHZhciBoYXNoTmFtZSA9IHRoaXMuY29uc3VtZUFOYW1lKCk7XG4gICAgICAgIGlmIChoYXNoTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogMTIsIHRleHQ6IFwiI1wiICsgaGFzaE5hbWUudGV4dCB9O1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgtLTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQ0RPID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZXh0LnN1YnN0cih0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LCA0KSA9PT0gXCI8IS0tXCIpIHtcbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKz0gNDtcbiAgICAgICAgICAgIHJldHVybiBcIjwhLS1cIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVDREMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnRleHQuc3Vic3RyKHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgsIDMpID09PSBcIi0tPlwiKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICs9IDM7XG4gICAgICAgICAgICByZXR1cm4gXCItLT5cIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBTWF0Y2hUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ICsgMV0gPT09IFwiPVwiKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW4gPSB0aGlzLnRleHQuc3Vic3RyKHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgsIDIpO1xuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCArPSAyO1xuICAgICAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFOdW1lcmljVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG51bWJlclJlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgIHZhciByZXN1bHQgPSBudW1iZXJSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gbnVtYmVyUmVnRXgubGFzdEluZGV4O1xuICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXhdID09PSBcIiVcIikge1xuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogNCwgdGV4dDogcmVzdWx0WzBdIH07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hbWUgPSB0aGlzLmNvbnN1bWVBTmFtZSgpO1xuICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogNSwgdGV4dDogcmVzdWx0WzBdICsgbmFtZS50ZXh0IH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgdHlwZTogMywgdGV4dDogcmVzdWx0WzBdIH07XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQW5JZGVudExpa2VUb2tlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hbWUgPSB0aGlzLmNvbnN1bWVBTmFtZSgpO1xuICAgICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0gPT09IFwiKFwiKSB7XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICBpZiAobmFtZS50ZXh0LnRvTG93ZXJDYXNlKCkgPT09IFwidXJsXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQVVSTFRva2VuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiA4LCBuYW1lOiBuYW1lLnRleHQsIHRleHQ6IG5hbWUudGV4dCArIFwiKFwiIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQVN0cmluZ1Rva2VuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2hhciA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XTtcbiAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgaWYgKGNoYXIgPT09IFwiJ1wiKSB7XG4gICAgICAgICAgICBzaW5nbGVRdW90ZVN0cmluZ1JlZ0V4Lmxhc3RJbmRleCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICByZXN1bHQgPSBzaW5nbGVRdW90ZVN0cmluZ1JlZ0V4LmV4ZWModGhpcy50ZXh0KTtcbiAgICAgICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gc2luZ2xlUXVvdGVTdHJpbmdSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoY2hhciA9PT0gXCJcXFwiXCIpIHtcbiAgICAgICAgICAgIGRvdWJsZVF1b3RlU3RyaW5nUmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgICAgIHJlc3VsdCA9IGRvdWJsZVF1b3RlU3RyaW5nUmVnRXguZXhlYyh0aGlzLnRleHQpO1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPSBkb3VibGVRdW90ZVN0cmluZ1JlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB0eXBlOiAxLCB0ZXh0OiByZXN1bHRbMF0gfTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBVVJMVG9rZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdGFydCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggLSAzIC0gMTtcbiAgICAgICAgdmFyIHVybFRva2VuID0geyB0eXBlOiA3LCB0ZXh0OiB1bmRlZmluZWQgfTtcbiAgICAgICAgdGhpcy5jb25zdW1lQVdoaXRlc3BhY2UoKTtcbiAgICAgICAgaWYgKHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPj0gdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHVybFRva2VuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXh0SW5wdXRDb2RlUG9pbnQgPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF07XG4gICAgICAgIGlmIChuZXh0SW5wdXRDb2RlUG9pbnQgPT09IFwiXFxcIlwiIHx8IG5leHRJbnB1dENvZGVQb2ludCA9PT0gXCInXCIpIHtcbiAgICAgICAgICAgIHZhciBzdHJpbmdUb2tlbiA9IHRoaXMuY29uc3VtZUFTdHJpbmdUb2tlbigpO1xuICAgICAgICAgICAgdXJsVG9rZW4udGV4dCA9IHN0cmluZ1Rva2VuLnRleHQ7XG4gICAgICAgICAgICB0aGlzLmNvbnN1bWVBV2hpdGVzcGFjZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XSA9PT0gXCIpXCIgfHwgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA+PSB0aGlzLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgICAgIHVybFRva2VuLnRleHQgPSB0aGlzLnRleHQuc3Vic3RyaW5nKHN0YXJ0LCBlbmQpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1cmxUb2tlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHdoaWxlICh0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4IDwgdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgdmFyIGNoYXIgPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrXTtcbiAgICAgICAgICAgIHN3aXRjaCAoY2hhcikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCIpXCI6IHJldHVybiB1cmxUb2tlbjtcbiAgICAgICAgICAgICAgICBjYXNlIFwiIFwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXHRcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFxuXCI6XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcclwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCJcXGZcIjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25zdW1lQVdoaXRlc3BhY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XSA9PT0gXCIpXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXgrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB1cmxUb2tlbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBcIlxcXCJcIjpcbiAgICAgICAgICAgICAgICBjYXNlIFwiXFwnXCI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJcXFxcXCI6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVzY2FwaW5nIG5vdCB5ZXQgc3VwcG9ydGVkIVwiKTtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB1cmxUb2tlbi50ZXh0ICs9IGNoYXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVybFRva2VuO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFOYW1lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBuYW1lUmVnRXgubGFzdEluZGV4ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG5hbWVSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4ID0gbmFtZVJlZ0V4Lmxhc3RJbmRleDtcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogNiwgdGV4dDogcmVzdWx0WzBdIH07XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQXRLZXl3b3JkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgIHZhciBuYW1lID0gdGhpcy5jb25zdW1lQU5hbWUoKTtcbiAgICAgICAgaWYgKG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IDExLCB0ZXh0OiBuYW1lLnRleHQgfTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4LS07XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFDb21tZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50ZXh0W3RoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggKyAxXSA9PT0gXCIqXCIpIHtcbiAgICAgICAgICAgIGNvbW1lbnRSZWdFeC5sYXN0SW5kZXggPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGNvbW1lbnRSZWdFeC5leGVjKHRoaXMudGV4dCk7XG4gICAgICAgICAgICBpZiAoIXJlc3VsdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCA9IGNvbW1lbnRSZWdFeC5sYXN0SW5kZXg7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25zdW1lQVRva2VuKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbiA9IGZ1bmN0aW9uIChjdXJyZW50SW5wdXRUb2tlbikge1xuICAgICAgICB0aGlzLnJlY29uc3VtZWRJbnB1dFRva2VuID0gY3VycmVudElucHV0VG9rZW47XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5wYXJzZUFTdHlsZXNoZWV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLnRvcExldmVsRmxhZyA9IHRydWU7XG4gICAgICAgIHZhciBzdHlsZXNoZWV0ID0ge1xuICAgICAgICAgICAgcnVsZXM6IHRoaXMuY29uc3VtZUFMaXN0T2ZSdWxlcygpXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzdHlsZXNoZWV0O1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFMaXN0T2ZSdWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJ1bGVzID0gW107XG4gICAgICAgIHZhciBpbnB1dFRva2VuO1xuICAgICAgICB3aGlsZSAoaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGlucHV0VG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiIFwiOiBjb250aW51ZTtcbiAgICAgICAgICAgICAgICBjYXNlIFwiPCEtLVwiOlxuICAgICAgICAgICAgICAgIGNhc2UgXCItLT5cIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudG9wTGV2ZWxGbGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXRSdWxlID0gdGhpcy5jb25zdW1lQW5BdFJ1bGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0UnVsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcnVsZXMucHVzaChhdFJ1bGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4udHlwZSA9PT0gMTEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlY29uc3VtZVRoZUN1cnJlbnRJbnB1dFRva2VuKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgICAgIHZhciBhdFJ1bGUgPSB0aGlzLmNvbnN1bWVBbkF0UnVsZSgpO1xuICAgICAgICAgICAgICAgIGlmIChhdFJ1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcnVsZXMucHVzaChhdFJ1bGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVjb25zdW1lVGhlQ3VycmVudElucHV0VG9rZW4oaW5wdXRUb2tlbik7XG4gICAgICAgICAgICB2YXIgcXVhbGlmaWVkUnVsZSA9IHRoaXMuY29uc3VtZUFRdWFsaWZpZWRSdWxlKCk7XG4gICAgICAgICAgICBpZiAocXVhbGlmaWVkUnVsZSkge1xuICAgICAgICAgICAgICAgIHJ1bGVzLnB1c2gocXVhbGlmaWVkUnVsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJ1bGVzO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFuQXRSdWxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaW5wdXRUb2tlbiA9IHRoaXMuY29uc3VtZUFUb2tlbigpO1xuICAgICAgICB2YXIgYXRSdWxlID0ge1xuICAgICAgICAgICAgdHlwZTogXCJhdC1ydWxlXCIsXG4gICAgICAgICAgICBuYW1lOiBpbnB1dFRva2VuLnRleHQsXG4gICAgICAgICAgICBwcmVsdWRlOiBbXSxcbiAgICAgICAgICAgIGJsb2NrOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgd2hpbGUgKGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKSkge1xuICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4gPT09IFwiO1wiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGF0UnVsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGlucHV0VG9rZW4gPT09IFwie1wiKSB7XG4gICAgICAgICAgICAgICAgYXRSdWxlLmJsb2NrID0gdGhpcy5jb25zdW1lQVNpbXBsZUJsb2NrKGlucHV0VG9rZW4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBhdFJ1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpbnB1dFRva2VuLnR5cGUgPT09IDkgJiYgaW5wdXRUb2tlbi5hc3NvY2lhdGVkVG9rZW4gPT09IFwie1wiKSB7XG4gICAgICAgICAgICAgICAgYXRSdWxlLmJsb2NrID0gaW5wdXRUb2tlbjtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXRSdWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgIHZhciBjb21wb25lbnQgPSB0aGlzLmNvbnN1bWVBQ29tcG9uZW50VmFsdWUoKTtcbiAgICAgICAgICAgIGlmIChjb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICBhdFJ1bGUucHJlbHVkZS5wdXNoKGNvbXBvbmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF0UnVsZTtcbiAgICB9O1xuICAgIENTUzNQYXJzZXIucHJvdG90eXBlLmNvbnN1bWVBUXVhbGlmaWVkUnVsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHF1YWxpZmllZFJ1bGUgPSB7XG4gICAgICAgICAgICB0eXBlOiBcInF1YWxpZmllZC1ydWxlXCIsXG4gICAgICAgICAgICBwcmVsdWRlOiBbXSxcbiAgICAgICAgICAgIGJsb2NrOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGlucHV0VG9rZW47XG4gICAgICAgIHdoaWxlIChpbnB1dFRva2VuID0gdGhpcy5jb25zdW1lQVRva2VuKCkpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dFRva2VuID09PSBcIntcIikge1xuICAgICAgICAgICAgICAgIHZhciBibG9jayA9IHRoaXMuY29uc3VtZUFTaW1wbGVCbG9jayhpbnB1dFRva2VuKTtcbiAgICAgICAgICAgICAgICBxdWFsaWZpZWRSdWxlLmJsb2NrID0gYmxvY2s7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHF1YWxpZmllZFJ1bGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpbnB1dFRva2VuLnR5cGUgPT09IDkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2ltcGxlQmxvY2sgPSBpbnB1dFRva2VuO1xuICAgICAgICAgICAgICAgIGlmIChzaW1wbGVCbG9jay5hc3NvY2lhdGVkVG9rZW4gPT09IFwie1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1YWxpZmllZFJ1bGUuYmxvY2sgPSBzaW1wbGVCbG9jaztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1YWxpZmllZFJ1bGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5yZWNvbnN1bWVUaGVDdXJyZW50SW5wdXRUb2tlbihpbnB1dFRva2VuKTtcbiAgICAgICAgICAgIHZhciBjb21wb25lbnRWYWx1ZSA9IHRoaXMuY29uc3VtZUFDb21wb25lbnRWYWx1ZSgpO1xuICAgICAgICAgICAgaWYgKGNvbXBvbmVudFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcXVhbGlmaWVkUnVsZS5wcmVsdWRlLnB1c2goY29tcG9uZW50VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFDb21wb25lbnRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGlucHV0VG9rZW4gPSB0aGlzLmNvbnN1bWVBVG9rZW4oKTtcbiAgICAgICAgc3dpdGNoIChpbnB1dFRva2VuKSB7XG4gICAgICAgICAgICBjYXNlIFwie1wiOlxuICAgICAgICAgICAgY2FzZSBcIltcIjpcbiAgICAgICAgICAgIGNhc2UgXCIoXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCsrO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnN1bWVBU2ltcGxlQmxvY2soaW5wdXRUb2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcIm9iamVjdFwiICYmIGlucHV0VG9rZW4udHlwZSA9PT0gOCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29uc3VtZUFGdW5jdGlvbihpbnB1dFRva2VuLm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbnB1dFRva2VuO1xuICAgIH07XG4gICAgQ1NTM1BhcnNlci5wcm90b3R5cGUuY29uc3VtZUFTaW1wbGVCbG9jayA9IGZ1bmN0aW9uIChhc3NvY2lhdGVkVG9rZW4pIHtcbiAgICAgICAgdmFyIGVuZGlhblRva2VuID0ge1xuICAgICAgICAgICAgXCJbXCI6IFwiXVwiLFxuICAgICAgICAgICAgXCJ7XCI6IFwifVwiLFxuICAgICAgICAgICAgXCIoXCI6IFwiKVwiXG4gICAgICAgIH1bYXNzb2NpYXRlZFRva2VuXTtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleCAtIDE7XG4gICAgICAgIHZhciBibG9jayA9IHtcbiAgICAgICAgICAgIHR5cGU6IDksXG4gICAgICAgICAgICB0ZXh0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICBhc3NvY2lhdGVkVG9rZW46IGFzc29jaWF0ZWRUb2tlbixcbiAgICAgICAgICAgIHZhbHVlczogW11cbiAgICAgICAgfTtcbiAgICAgICAgdmFyIG5leHRJbnB1dFRva2VuO1xuICAgICAgICB3aGlsZSAobmV4dElucHV0VG9rZW4gPSB0aGlzLnRleHRbdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleF0pIHtcbiAgICAgICAgICAgIGlmIChuZXh0SW5wdXRUb2tlbiA9PT0gZW5kaWFuVG9rZW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXg7XG4gICAgICAgICAgICAgICAgYmxvY2sudGV4dCA9IHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGJsb2NrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5jb25zdW1lQUNvbXBvbmVudFZhbHVlKCk7XG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBibG9jay52YWx1ZXMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYmxvY2sudGV4dCA9IHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQpO1xuICAgICAgICByZXR1cm4gYmxvY2s7XG4gICAgfTtcbiAgICBDU1MzUGFyc2VyLnByb3RvdHlwZS5jb25zdW1lQUZ1bmN0aW9uID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gdGhpcy5uZXh0SW5wdXRDb2RlUG9pbnRJbmRleDtcbiAgICAgICAgdmFyIGZ1bmNUb2tlbiA9IHsgdHlwZTogMTQsIG5hbWU6IG5hbWUsIHRleHQ6IHVuZGVmaW5lZCwgY29tcG9uZW50czogW10gfTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgaWYgKHRoaXMubmV4dElucHV0Q29kZVBvaW50SW5kZXggPj0gdGhpcy50ZXh0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZ1bmNUb2tlbi50ZXh0ID0gbmFtZSArIFwiKFwiICsgdGhpcy50ZXh0LnN1YnN0cmluZyhzdGFydCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmNUb2tlbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBuZXh0SW5wdXRUb2tlbiA9IHRoaXMudGV4dFt0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4XTtcbiAgICAgICAgICAgIHN3aXRjaCAobmV4dElucHV0VG9rZW4pIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiKVwiOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4Kys7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSB0aGlzLm5leHRJbnB1dENvZGVQb2ludEluZGV4O1xuICAgICAgICAgICAgICAgICAgICBmdW5jVG9rZW4udGV4dCA9IG5hbWUgKyBcIihcIiArIHRoaXMudGV4dC5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jVG9rZW47XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IHRoaXMuY29uc3VtZUFDb21wb25lbnRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jVG9rZW4uY29tcG9uZW50cy5wdXNoKGNvbXBvbmVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSAodHJ1ZSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ1NTM1BhcnNlcjtcbn0oKSk7XG5leHBvcnRzLkNTUzNQYXJzZXIgPSBDU1MzUGFyc2VyO1xudmFyIENTU05hdGl2ZVNjcmlwdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQ1NTTmF0aXZlU2NyaXB0KCkge1xuICAgIH1cbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlU3R5bGVzaGVldCA9IGZ1bmN0aW9uIChzdHlsZXNoZWV0KSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBcInN0eWxlc2hlZXRcIixcbiAgICAgICAgICAgIHN0eWxlc2hlZXQ6IHtcbiAgICAgICAgICAgICAgICBydWxlczogdGhpcy5wYXJzZVJ1bGVzKHN0eWxlc2hlZXQucnVsZXMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnBhcnNlUnVsZXMgPSBmdW5jdGlvbiAocnVsZXMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHJ1bGVzLm1hcChmdW5jdGlvbiAocnVsZSkgeyByZXR1cm4gX3RoaXMucGFyc2VSdWxlKHJ1bGUpOyB9KTtcbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucGFyc2VSdWxlID0gZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgaWYgKHJ1bGUudHlwZSA9PT0gXCJhdC1ydWxlXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlQXRSdWxlKHJ1bGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHJ1bGUudHlwZSA9PT0gXCJxdWFsaWZpZWQtcnVsZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJzZVF1YWxpZmllZFJ1bGUocnVsZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucGFyc2VBdFJ1bGUgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICBpZiAocnVsZS5uYW1lID09PSBcImltcG9ydFwiKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGltcG9ydDogcnVsZS5wcmVsdWRlLm1hcChmdW5jdGlvbiAobSkgeyByZXR1cm4gdHlwZW9mIG0gPT09IFwic3RyaW5nXCIgPyBtIDogbS50ZXh0OyB9KS5qb2luKFwiXCIpLnRyaW0oKSxcbiAgICAgICAgICAgICAgICB0eXBlOiBcImltcG9ydFwiXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuICAgIENTU05hdGl2ZVNjcmlwdC5wcm90b3R5cGUucGFyc2VRdWFsaWZpZWRSdWxlID0gZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFwicnVsZVwiLFxuICAgICAgICAgICAgc2VsZWN0b3JzOiB0aGlzLnByZWx1ZGVUb1NlbGVjdG9yc1N0cmluZ0FycmF5KHJ1bGUucHJlbHVkZSksXG4gICAgICAgICAgICBkZWNsYXJhdGlvbnM6IHRoaXMucnVsZUJsb2NrVG9EZWNsYXJhdGlvbnMocnVsZS5ibG9jay52YWx1ZXMpXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBDU1NOYXRpdmVTY3JpcHQucHJvdG90eXBlLnJ1bGVCbG9ja1RvRGVjbGFyYXRpb25zID0gZnVuY3Rpb24gKGRlY2xhcmF0aW9uc0lucHV0VG9rZW5zKSB7XG4gICAgICAgIHZhciBkZWNsYXJhdGlvbnMgPSBbXTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gXCJcIjtcbiAgICAgICAgdmFyIHZhbHVlID0gXCJcIjtcbiAgICAgICAgdmFyIHJlYWRpbmcgPSBcInByb3BlcnR5XCI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGVjbGFyYXRpb25zSW5wdXRUb2tlbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpbnB1dFRva2VuID0gZGVjbGFyYXRpb25zSW5wdXRUb2tlbnNbaV07XG4gICAgICAgICAgICBpZiAocmVhZGluZyA9PT0gXCJwcm9wZXJ0eVwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4gPT09IFwiOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRpbmcgPSBcInZhbHVlXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBpbnB1dFRva2VuID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5ICs9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSArPSBpbnB1dFRva2VuLnRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0VG9rZW4gPT09IFwiO1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5ID0gcHJvcGVydHkudHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgICAgICAgICAgZGVjbGFyYXRpb25zLnB1c2goeyB0eXBlOiBcImRlY2xhcmF0aW9uXCIsIHByb3BlcnR5OiBwcm9wZXJ0eSwgdmFsdWU6IHZhbHVlIH0pO1xuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgcmVhZGluZyA9IFwicHJvcGVydHlcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGlucHV0VG9rZW4gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgKz0gaW5wdXRUb2tlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlICs9IGlucHV0VG9rZW4udGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcHJvcGVydHkgPSBwcm9wZXJ0eS50cmltKCk7XG4gICAgICAgIHZhbHVlID0gdmFsdWUudHJpbSgpO1xuICAgICAgICBpZiAocHJvcGVydHkgfHwgdmFsdWUpIHtcbiAgICAgICAgICAgIGRlY2xhcmF0aW9ucy5wdXNoKHsgdHlwZTogXCJkZWNsYXJhdGlvblwiLCBwcm9wZXJ0eTogcHJvcGVydHksIHZhbHVlOiB2YWx1ZSB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVjbGFyYXRpb25zO1xuICAgIH07XG4gICAgQ1NTTmF0aXZlU2NyaXB0LnByb3RvdHlwZS5wcmVsdWRlVG9TZWxlY3RvcnNTdHJpbmdBcnJheSA9IGZ1bmN0aW9uIChwcmVsdWRlKSB7XG4gICAgICAgIHZhciBzZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgdmFyIHNlbGVjdG9yID0gXCJcIjtcbiAgICAgICAgcHJlbHVkZS5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dFRva2VuKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGlucHV0VG9rZW4gPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAoaW5wdXRUb2tlbiA9PT0gXCIsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcnMucHVzaChzZWxlY3Rvci50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yID0gXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yICs9IGlucHV0VG9rZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZW9mIGlucHV0VG9rZW4gPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RvciArPSBpbnB1dFRva2VuLnRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoc2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHNlbGVjdG9ycy5wdXNoKHNlbGVjdG9yLnRyaW0oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGVjdG9ycztcbiAgICB9O1xuICAgIHJldHVybiBDU1NOYXRpdmVTY3JpcHQ7XG59KCkpO1xuZXhwb3J0cy5DU1NOYXRpdmVTY3JpcHQgPSBDU1NOYXRpdmVTY3JpcHQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYXJzZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG9ic2VydmFibGUgPSByZXF1aXJlKFwiLi4vb2JzZXJ2YWJsZVwiKTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBDaGFuZ2VUeXBlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDaGFuZ2VUeXBlKCkge1xuICAgIH1cbiAgICBDaGFuZ2VUeXBlLkFkZCA9IFwiYWRkXCI7XG4gICAgQ2hhbmdlVHlwZS5EZWxldGUgPSBcImRlbGV0ZVwiO1xuICAgIENoYW5nZVR5cGUuVXBkYXRlID0gXCJ1cGRhdGVcIjtcbiAgICBDaGFuZ2VUeXBlLlNwbGljZSA9IFwic3BsaWNlXCI7XG4gICAgcmV0dXJuIENoYW5nZVR5cGU7XG59KCkpO1xuZXhwb3J0cy5DaGFuZ2VUeXBlID0gQ2hhbmdlVHlwZTtcbnZhciBDSEFOR0UgPSBcImNoYW5nZVwiO1xudmFyIE9ic2VydmFibGVBcnJheSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE9ic2VydmFibGVBcnJheSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBPYnNlcnZhYmxlQXJyYXkoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxICYmIEFycmF5LmlzQXJyYXkoYXJndW1lbnRzWzBdKSkge1xuICAgICAgICAgICAgX3RoaXMuX2FycmF5ID0gYXJndW1lbnRzWzBdLnNsaWNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5fYXJyYXkgPSBBcnJheS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIF90aGlzLl9hZGRBcmdzID0ge1xuICAgICAgICAgICAgZXZlbnROYW1lOiBDSEFOR0UsIG9iamVjdDogX3RoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuQWRkLFxuICAgICAgICAgICAgaW5kZXg6IG51bGwsXG4gICAgICAgICAgICByZW1vdmVkOiBuZXcgQXJyYXkoKSxcbiAgICAgICAgICAgIGFkZGVkQ291bnQ6IDFcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuX2RlbGV0ZUFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IENIQU5HRSwgb2JqZWN0OiBfdGhpcyxcbiAgICAgICAgICAgIGFjdGlvbjogQ2hhbmdlVHlwZS5EZWxldGUsXG4gICAgICAgICAgICBpbmRleDogbnVsbCxcbiAgICAgICAgICAgIHJlbW92ZWQ6IG51bGwsXG4gICAgICAgICAgICBhZGRlZENvdW50OiAwXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5nZXRJdGVtID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheVtpbmRleF07XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNldEl0ZW0gPSBmdW5jdGlvbiAoaW5kZXgsIHZhbHVlKSB7XG4gICAgICAgIHZhciBvbGRWYWx1ZSA9IHRoaXMuX2FycmF5W2luZGV4XTtcbiAgICAgICAgdGhpcy5fYXJyYXlbaW5kZXhdID0gdmFsdWU7XG4gICAgICAgIHRoaXMubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogQ0hBTkdFLCBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuVXBkYXRlLFxuICAgICAgICAgICAgaW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgcmVtb3ZlZDogW29sZFZhbHVlXSxcbiAgICAgICAgICAgIGFkZGVkQ291bnQ6IDFcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZSwgXCJsZW5ndGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNOdW1iZXIodmFsdWUpICYmIHRoaXMuX2FycmF5ICYmIHRoaXMuX2FycmF5Lmxlbmd0aCAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNwbGljZSh2YWx1ZSwgdGhpcy5fYXJyYXkubGVuZ3RoIC0gdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkudG9TdHJpbmcoKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUudG9Mb2NhbGVTdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS50b0xvY2FsZVN0cmluZygpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5jb25jYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuaW5kZXggPSB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5jb25jYXQuYXBwbHkodGhpcy5fYXJyYXksIGFyZ3VtZW50cyk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmpvaW4gPSBmdW5jdGlvbiAoc2VwYXJhdG9yKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5qb2luKHNlcGFyYXRvcik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnBvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5pbmRleCA9IHRoaXMuX2FycmF5Lmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5wb3AoKTtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5yZW1vdmVkID0gW3Jlc3VsdF07XG4gICAgICAgIHRoaXMubm90aWZ5KHRoaXMuX2RlbGV0ZUFyZ3MpO1xuICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYWRkQXJncy5pbmRleCA9IHRoaXMuX2FycmF5Lmxlbmd0aDtcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEgJiYgQXJyYXkuaXNBcnJheShhcmd1bWVudHNbMF0pKSB7XG4gICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBzb3VyY2UubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXJyYXkucHVzaChzb3VyY2VbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fYXJyYXkucHVzaC5hcHBseSh0aGlzLl9hcnJheSwgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9hZGRBcmdzLmFkZGVkQ291bnQgPSB0aGlzLl9hcnJheS5sZW5ndGggLSB0aGlzLl9hZGRBcmdzLmluZGV4O1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9hZGRBcmdzKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLl9ub3RpZnlMZW5ndGhDaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsZW5ndGhDaGFuZ2VkRGF0YSA9IHRoaXMuX2NyZWF0ZVByb3BlcnR5Q2hhbmdlRGF0YShcImxlbmd0aFwiLCB0aGlzLl9hcnJheS5sZW5ndGgpO1xuICAgICAgICB0aGlzLm5vdGlmeShsZW5ndGhDaGFuZ2VkRGF0YSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnJldmVyc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5yZXZlcnNlKCk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNoaWZ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkuc2hpZnQoKTtcbiAgICAgICAgdGhpcy5fZGVsZXRlQXJncy5pbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX2RlbGV0ZUFyZ3MucmVtb3ZlZCA9IFtyZXN1bHRdO1xuICAgICAgICB0aGlzLm5vdGlmeSh0aGlzLl9kZWxldGVBcmdzKTtcbiAgICAgICAgdGhpcy5fbm90aWZ5TGVuZ3RoQ2hhbmdlKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNsaWNlID0gZnVuY3Rpb24gKHN0YXJ0LCBlbmQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FycmF5LnNsaWNlKHN0YXJ0LCBlbmQpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zb3J0ID0gZnVuY3Rpb24gKGNvbXBhcmVGbikge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuc29ydChjb21wYXJlRm4pO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5zcGxpY2UgPSBmdW5jdGlvbiAoc3RhcnQsIGRlbGV0ZUNvdW50KSB7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLl9hcnJheS5sZW5ndGg7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9hcnJheS5zcGxpY2UuYXBwbHkodGhpcy5fYXJyYXksIGFyZ3VtZW50cyk7XG4gICAgICAgIHRoaXMubm90aWZ5KHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogQ0hBTkdFLCBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBhY3Rpb246IENoYW5nZVR5cGUuU3BsaWNlLFxuICAgICAgICAgICAgaW5kZXg6IHN0YXJ0LFxuICAgICAgICAgICAgcmVtb3ZlZDogcmVzdWx0LFxuICAgICAgICAgICAgYWRkZWRDb3VudDogdGhpcy5fYXJyYXkubGVuZ3RoICsgcmVzdWx0Lmxlbmd0aCAtIGxlbmd0aFxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX2FycmF5Lmxlbmd0aCAhPT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLl9ub3RpZnlMZW5ndGhDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS51bnNoaWZ0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgbGVuZ3RoID0gdGhpcy5fYXJyYXkubGVuZ3RoO1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fYXJyYXkudW5zaGlmdC5hcHBseSh0aGlzLl9hcnJheSwgYXJndW1lbnRzKTtcbiAgICAgICAgdGhpcy5fYWRkQXJncy5pbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX2FkZEFyZ3MuYWRkZWRDb3VudCA9IHJlc3VsdCAtIGxlbmd0aDtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fYWRkQXJncyk7XG4gICAgICAgIHRoaXMuX25vdGlmeUxlbmd0aENoYW5nZSgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUFycmF5LnByb3RvdHlwZS5pbmRleE9mID0gZnVuY3Rpb24gKHNlYXJjaEVsZW1lbnQsIGZyb21JbmRleCkge1xuICAgICAgICB2YXIgaW5kZXggPSBmcm9tSW5kZXggPyBmcm9tSW5kZXggOiAwO1xuICAgICAgICBmb3IgKHZhciBpID0gaW5kZXgsIGwgPSB0aGlzLl9hcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hcnJheVtpXSA9PT0gc2VhcmNoRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUubGFzdEluZGV4T2YgPSBmdW5jdGlvbiAoc2VhcmNoRWxlbWVudCwgZnJvbUluZGV4KSB7XG4gICAgICAgIHZhciBpbmRleCA9IGZyb21JbmRleCA/IGZyb21JbmRleCA6IHRoaXMuX2FycmF5Lmxlbmd0aCAtIDE7XG4gICAgICAgIGZvciAodmFyIGkgPSBpbmRleDsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hcnJheVtpXSA9PT0gc2VhcmNoRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuZXZlcnkgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuZXZlcnkoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnNvbWUgPSBmdW5jdGlvbiAoY2FsbGJhY2tmbiwgdGhpc0FyZykge1xuICAgICAgICByZXR1cm4gdGhpcy5fYXJyYXkuc29tZShjYWxsYmFja2ZuLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGVBcnJheS5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHRoaXMuX2FycmF5LmZvckVhY2goY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLm1hcCA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5tYXAoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCB0aGlzQXJnKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcnJheS5maWx0ZXIoY2FsbGJhY2tmbiwgdGhpc0FyZyk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnJlZHVjZSA9IGZ1bmN0aW9uIChjYWxsYmFja2ZuLCBpbml0aWFsVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGluaXRpYWxWYWx1ZSAhPT0gdW5kZWZpbmVkID8gdGhpcy5fYXJyYXkucmVkdWNlKGNhbGxiYWNrZm4sIGluaXRpYWxWYWx1ZSkgOiB0aGlzLl9hcnJheS5yZWR1Y2UoY2FsbGJhY2tmbik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkucHJvdG90eXBlLnJlZHVjZVJpZ2h0ID0gZnVuY3Rpb24gKGNhbGxiYWNrZm4sIGluaXRpYWxWYWx1ZSkge1xuICAgICAgICByZXR1cm4gaW5pdGlhbFZhbHVlICE9PSB1bmRlZmluZWQgPyB0aGlzLl9hcnJheS5yZWR1Y2VSaWdodChjYWxsYmFja2ZuLCBpbml0aWFsVmFsdWUpIDogdGhpcy5fYXJyYXkucmVkdWNlUmlnaHQoY2FsbGJhY2tmbik7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQgPSBDSEFOR0U7XG4gICAgcmV0dXJuIE9ic2VydmFibGVBcnJheTtcbn0ob2JzZXJ2YWJsZS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLk9ic2VydmFibGVBcnJheSA9IE9ic2VydmFibGVBcnJheTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmFibGUtYXJyYXkuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIF93cmFwcGVkSW5kZXggPSAwO1xudmFyIFdyYXBwZWRWYWx1ZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gV3JhcHBlZFZhbHVlKHdyYXBwZWQpIHtcbiAgICAgICAgdGhpcy53cmFwcGVkID0gd3JhcHBlZDtcbiAgICB9XG4gICAgV3JhcHBlZFZhbHVlLnVud3JhcCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gKHZhbHVlIGluc3RhbmNlb2YgV3JhcHBlZFZhbHVlKSA/IHZhbHVlLndyYXBwZWQgOiB2YWx1ZTtcbiAgICB9O1xuICAgIFdyYXBwZWRWYWx1ZS53cmFwID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciB3ID0gX3dyYXBwZWRWYWx1ZXNbX3dyYXBwZWRJbmRleCsrICUgNV07XG4gICAgICAgIHcud3JhcHBlZCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdztcbiAgICB9O1xuICAgIHJldHVybiBXcmFwcGVkVmFsdWU7XG59KCkpO1xuZXhwb3J0cy5XcmFwcGVkVmFsdWUgPSBXcmFwcGVkVmFsdWU7XG52YXIgX3dyYXBwZWRWYWx1ZXMgPSBbXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKSxcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpLFxuICAgIG5ldyBXcmFwcGVkVmFsdWUobnVsbCksXG4gICAgbmV3IFdyYXBwZWRWYWx1ZShudWxsKSxcbiAgICBuZXcgV3JhcHBlZFZhbHVlKG51bGwpXG5dO1xudmFyIE9ic2VydmFibGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE9ic2VydmFibGUoKSB7XG4gICAgICAgIHRoaXMuX29ic2VydmVycyA9IHt9O1xuICAgIH1cbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpc1tuYW1lXTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB2YXIgb2xkVmFsdWUgPSB0aGlzW25hbWVdO1xuICAgICAgICBpZiAodGhpc1tuYW1lXSA9PT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3VmFsdWUgPSBXcmFwcGVkVmFsdWUudW53cmFwKHZhbHVlKTtcbiAgICAgICAgdGhpc1tuYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKG5hbWUsIG5ld1ZhbHVlLCBvbGRWYWx1ZSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uIChldmVudE5hbWVzLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uIChldmVudCwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9nZXRFdmVudExpc3QoZXZlbnQsIHRydWUpO1xuICAgICAgICBsaXN0LnB1c2goeyBjYWxsYmFjazogY2FsbGJhY2ssIHRoaXNBcmc6IHRoaXNBcmcsIG9uY2U6IHRydWUgfSk7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnROYW1lcywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBldmVudE5hbWVzICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRXZlbnRzIG5hbWUocykgbXVzdCBiZSBzdHJpbmcuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImNhbGxiYWNrIG11c3QgYmUgZnVuY3Rpb24uXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBldmVudHMgPSBldmVudE5hbWVzLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBldmVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRfMSA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2dldEV2ZW50TGlzdChldmVudF8xLCB0cnVlKTtcbiAgICAgICAgICAgIGxpc3QucHVzaCh7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgICAgICAgICAgICAgIHRoaXNBcmc6IHRoaXNBcmdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZXMsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXZlbnROYW1lcyAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkV2ZW50cyBuYW1lKHMpIG11c3QgYmUgc3RyaW5nLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FsbGJhY2sgJiYgdHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJjYWxsYmFjayBtdXN0IGJlIGZ1bmN0aW9uLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZXZlbnRzID0gZXZlbnROYW1lcy5zcGxpdChcIixcIik7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gZXZlbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGV2ZW50XzIgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9nZXRFdmVudExpc3QoZXZlbnRfMiwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChsaXN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleF8xID0gdGhpcy5faW5kZXhPZkxpc3RlbmVyKGxpc3QsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4XzEgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC5zcGxpY2UoaW5kZXhfMSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50XzJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50XzJdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLl9vYnNlcnZlcnNbZXZlbnRfMl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLm5vdGlmeSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBvYnNlcnZlcnMgPSB0aGlzLl9vYnNlcnZlcnNbZGF0YS5ldmVudE5hbWVdO1xuICAgICAgICBpZiAoIW9ic2VydmVycykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSBvYnNlcnZlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IG9ic2VydmVyc1tpXTtcbiAgICAgICAgICAgIGlmIChlbnRyeS5vbmNlKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXJzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbnRyeS50aGlzQXJnKSB7XG4gICAgICAgICAgICAgICAgZW50cnkuY2FsbGJhY2suYXBwbHkoZW50cnkudGhpc0FyZywgW2RhdGFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGVudHJ5LmNhbGxiYWNrKGRhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5ub3RpZnlQcm9wZXJ0eUNoYW5nZSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkodGhpcy5fY3JlYXRlUHJvcGVydHlDaGFuZ2VEYXRhKG5hbWUsIHZhbHVlLCBvbGRWYWx1ZSkpO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuaGFzTGlzdGVuZXJzID0gZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgICByZXR1cm4gZXZlbnROYW1lIGluIHRoaXMuX29ic2VydmVycztcbiAgICB9O1xuICAgIE9ic2VydmFibGUucHJvdG90eXBlLl9jcmVhdGVQcm9wZXJ0eUNoYW5nZURhdGEgPSBmdW5jdGlvbiAocHJvcGVydHlOYW1lLCB2YWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHsgZXZlbnROYW1lOiBPYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIG9iamVjdDogdGhpcywgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH07XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5fZW1pdCA9IGZ1bmN0aW9uIChldmVudE5hbWVzKSB7XG4gICAgICAgIHZhciBldmVudHMgPSBldmVudE5hbWVzLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBldmVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnRfMyA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeSh7IGV2ZW50TmFtZTogZXZlbnRfMywgb2JqZWN0OiB0aGlzIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3RvdHlwZS5fZ2V0RXZlbnRMaXN0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgY3JlYXRlSWZOZWVkZWQpIHtcbiAgICAgICAgaWYgKCFldmVudE5hbWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJFdmVudE5hbWUgbXVzdCBiZSB2YWxpZCBzdHJpbmcuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBsaXN0ID0gdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50TmFtZV07XG4gICAgICAgIGlmICghbGlzdCAmJiBjcmVhdGVJZk5lZWRlZCkge1xuICAgICAgICAgICAgbGlzdCA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZXJzW2V2ZW50TmFtZV0gPSBsaXN0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZS5wcm90b3R5cGUuX2luZGV4T2ZMaXN0ZW5lciA9IGZ1bmN0aW9uIChsaXN0LCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBlbnRyeSA9IGxpc3RbaV07XG4gICAgICAgICAgICBpZiAodGhpc0FyZykge1xuICAgICAgICAgICAgICAgIGlmIChlbnRyeS5jYWxsYmFjayA9PT0gY2FsbGJhY2sgJiYgZW50cnkudGhpc0FyZyA9PT0gdGhpc0FyZykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoZW50cnkuY2FsbGJhY2sgPT09IGNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfTtcbiAgICBPYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQgPSBcInByb3BlcnR5Q2hhbmdlXCI7XG4gICAgcmV0dXJuIE9ic2VydmFibGU7XG59KCkpO1xuZXhwb3J0cy5PYnNlcnZhYmxlID0gT2JzZXJ2YWJsZTtcbnZhciBPYnNlcnZhYmxlRnJvbU9iamVjdCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKE9ic2VydmFibGVGcm9tT2JqZWN0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE9ic2VydmFibGVGcm9tT2JqZWN0KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX21hcCA9IHt9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9ic2VydmFibGVGcm9tT2JqZWN0LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWFwW25hbWVdO1xuICAgIH07XG4gICAgT2JzZXJ2YWJsZUZyb21PYmplY3QucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gdGhpcy5fbWFwW25hbWVdO1xuICAgICAgICBpZiAoY3VycmVudFZhbHVlID09PSB2YWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdWYWx1ZSA9IFdyYXBwZWRWYWx1ZS51bndyYXAodmFsdWUpO1xuICAgICAgICB0aGlzLl9tYXBbbmFtZV0gPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZShuYW1lLCBuZXdWYWx1ZSwgY3VycmVudFZhbHVlKTtcbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZhYmxlRnJvbU9iamVjdDtcbn0oT2JzZXJ2YWJsZSkpO1xuZnVuY3Rpb24gZGVmaW5lTmV3UHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eU5hbWUpIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBwcm9wZXJ0eU5hbWUsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGFyZ2V0Ll9tYXBbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRhcmdldC5zZXQocHJvcGVydHlOYW1lLCB2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xufVxuZnVuY3Rpb24gYWRkUHJvcGVydGllc0Zyb21PYmplY3Qob2JzZXJ2YWJsZSwgc291cmNlLCByZWN1cnNpdmUpIHtcbiAgICBpZiAocmVjdXJzaXZlID09PSB2b2lkIDApIHsgcmVjdXJzaXZlID0gZmFsc2U7IH1cbiAgICBPYmplY3Qua2V5cyhzb3VyY2UpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgdmFyIHZhbHVlID0gc291cmNlW3Byb3BdO1xuICAgICAgICBpZiAocmVjdXJzaXZlXG4gICAgICAgICAgICAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSlcbiAgICAgICAgICAgICYmIHZhbHVlXG4gICAgICAgICAgICAmJiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCJcbiAgICAgICAgICAgICYmICEodmFsdWUgaW5zdGFuY2VvZiBPYnNlcnZhYmxlKSkge1xuICAgICAgICAgICAgdmFsdWUgPSBmcm9tT2JqZWN0UmVjdXJzaXZlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBkZWZpbmVOZXdQcm9wZXJ0eShvYnNlcnZhYmxlLCBwcm9wKTtcbiAgICAgICAgb2JzZXJ2YWJsZS5zZXQocHJvcCwgdmFsdWUpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZnJvbU9iamVjdChzb3VyY2UpIHtcbiAgICB2YXIgb2JzZXJ2YWJsZSA9IG5ldyBPYnNlcnZhYmxlRnJvbU9iamVjdCgpO1xuICAgIGFkZFByb3BlcnRpZXNGcm9tT2JqZWN0KG9ic2VydmFibGUsIHNvdXJjZSwgZmFsc2UpO1xuICAgIHJldHVybiBvYnNlcnZhYmxlO1xufVxuZXhwb3J0cy5mcm9tT2JqZWN0ID0gZnJvbU9iamVjdDtcbmZ1bmN0aW9uIGZyb21PYmplY3RSZWN1cnNpdmUoc291cmNlKSB7XG4gICAgdmFyIG9ic2VydmFibGUgPSBuZXcgT2JzZXJ2YWJsZUZyb21PYmplY3QoKTtcbiAgICBhZGRQcm9wZXJ0aWVzRnJvbU9iamVjdChvYnNlcnZhYmxlLCBzb3VyY2UsIHRydWUpO1xuICAgIHJldHVybiBvYnNlcnZhYmxlO1xufVxuZXhwb3J0cy5mcm9tT2JqZWN0UmVjdXJzaXZlID0gZnJvbU9iamVjdFJlY3Vyc2l2ZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW9ic2VydmFibGUuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG5ldHdvcms7XG5mdW5jdGlvbiBnZXROZXR3b3JrKCkge1xuICAgIHJldHVybiBuZXR3b3JrO1xufVxuZXhwb3J0cy5nZXROZXR3b3JrID0gZ2V0TmV0d29yaztcbmZ1bmN0aW9uIHNldE5ldHdvcmsobmV3TmV0d29yaykge1xuICAgIG5ldHdvcmsgPSBuZXdOZXR3b3JrO1xufVxuZXhwb3J0cy5zZXROZXR3b3JrID0gc2V0TmV0d29yaztcbnZhciBkb207XG5mdW5jdGlvbiBnZXRET00oKSB7XG4gICAgcmV0dXJuIGRvbTtcbn1cbmV4cG9ydHMuZ2V0RE9NID0gZ2V0RE9NO1xuZnVuY3Rpb24gc2V0RE9NKG5ld0RPTSkge1xuICAgIGRvbSA9IG5ld0RPTTtcbn1cbmV4cG9ydHMuc2V0RE9NID0gc2V0RE9NO1xudmFyIGNzcztcbmZ1bmN0aW9uIGdldENTUygpIHtcbiAgICByZXR1cm4gY3NzO1xufVxuZXhwb3J0cy5nZXRDU1MgPSBnZXRDU1M7XG5mdW5jdGlvbiBzZXRDU1MobmV3Q1NTKSB7XG4gICAgY3NzID0gbmV3Q1NTO1xufVxuZXhwb3J0cy5zZXRDU1MgPSBzZXRDU1M7XG52YXIgTmV0d29ya0FnZW50O1xuKGZ1bmN0aW9uIChOZXR3b3JrQWdlbnQpIHtcbiAgICBmdW5jdGlvbiByZXNwb25zZVJlY2VpdmVkKHJlcXVlc3RJZCwgcmVzdWx0LCBoZWFkZXJzKSB7XG4gICAgICAgIHZhciByZXF1ZXN0SWRTdHIgPSByZXF1ZXN0SWQudG9TdHJpbmcoKTtcbiAgICAgICAgdmFyIG1pbWVUeXBlID0gaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXSB8fCBoZWFkZXJzW1wiY29udGVudC10eXBlXCJdIHx8IFwiYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtXCI7XG4gICAgICAgIHZhciBjb250ZW50TGVuZ3RoSGVhZGVyID0gaGVhZGVyc1tcIkNvbnRlbnQtTGVuZ3RoXCJdIHx8IGhlYWRlcnNbXCJjb250ZW50LWxlbmd0aFwiXTtcbiAgICAgICAgdmFyIGNvbnRlbnRMZW5ndGggPSBwYXJzZUludChjb250ZW50TGVuZ3RoSGVhZGVyLCAxMCk7XG4gICAgICAgIGlmIChpc05hTihjb250ZW50TGVuZ3RoKSkge1xuICAgICAgICAgICAgY29udGVudExlbmd0aCA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3BvbnNlID0ge1xuICAgICAgICAgICAgdXJsOiByZXN1bHQudXJsIHx8IFwiXCIsXG4gICAgICAgICAgICBzdGF0dXM6IHJlc3VsdC5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzdWx0LnN0YXR1c1RleHQgfHwgXCJcIixcbiAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICBtaW1lVHlwZTogbWltZVR5cGUsXG4gICAgICAgICAgICBmcm9tRGlza0NhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbm5lY3Rpb25SZXVzZWQ6IHRydWUsXG4gICAgICAgICAgICBjb25uZWN0aW9uSWQ6IDAsXG4gICAgICAgICAgICBlbmNvZGVkRGF0YUxlbmd0aDogY29udGVudExlbmd0aCxcbiAgICAgICAgICAgIHNlY3VyaXR5U3RhdGU6IFwiaW5mb1wiXG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXNwb25zZURhdGEgPSB7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZFN0cixcbiAgICAgICAgICAgIHR5cGU6IG1pbWVUeXBlVG9UeXBlKHJlc3BvbnNlLm1pbWVUeXBlKSxcbiAgICAgICAgICAgIHJlc3BvbnNlOiByZXNwb25zZSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZ2V0VGltZVN0YW1wKClcbiAgICAgICAgfTtcbiAgICAgICAgZ2xvYmFsLl9faW5zcGVjdG9yLnJlc3BvbnNlUmVjZWl2ZWQocmVzcG9uc2VEYXRhKTtcbiAgICAgICAgZ2xvYmFsLl9faW5zcGVjdG9yLmxvYWRpbmdGaW5pc2hlZCh7XG4gICAgICAgICAgICByZXF1ZXN0SWQ6IHJlcXVlc3RJZFN0cixcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZ2V0VGltZVN0YW1wKCksXG4gICAgICAgICAgICBlbmNvZGVkRGF0YUxlbmd0aDogY29udGVudExlbmd0aFxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIGhhc1RleHRDb250ZW50ID0gcmVzcG9uc2VEYXRhLnR5cGUgPT09IFwiRG9jdW1lbnRcIiB8fCByZXNwb25zZURhdGEudHlwZSA9PT0gXCJTY3JpcHRcIjtcbiAgICAgICAgdmFyIGRhdGE7XG4gICAgICAgIGlmICghaGFzVGV4dENvbnRlbnQpIHtcbiAgICAgICAgICAgIGlmIChyZXNwb25zZURhdGEudHlwZSA9PT0gXCJJbWFnZVwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJpdG1hcCA9IHJlc3VsdC5yZXNwb25zZUFzSW1hZ2U7XG4gICAgICAgICAgICAgICAgaWYgKGJpdG1hcCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0cHV0U3RyZWFtID0gbmV3IGphdmEuaW8uQnl0ZUFycmF5T3V0cHV0U3RyZWFtKCk7XG4gICAgICAgICAgICAgICAgICAgIGJpdG1hcC5jb21wcmVzcyhhbmRyb2lkLmdyYXBoaWNzLkJpdG1hcC5Db21wcmVzc0Zvcm1hdC5QTkcsIDEwMCwgb3V0cHV0U3RyZWFtKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJhc2U2NEltYWdlID0gYW5kcm9pZC51dGlsLkJhc2U2NC5lbmNvZGVUb1N0cmluZyhvdXRwdXRTdHJlYW0udG9CeXRlQXJyYXkoKSwgYW5kcm9pZC51dGlsLkJhc2U2NC5ERUZBVUxUKTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGJhc2U2NEltYWdlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRhdGEgPSByZXN1bHQucmVzcG9uc2VBc1N0cmluZztcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3VjY2Vzc2Z1bFJlcXVlc3REYXRhID0ge1xuICAgICAgICAgICAgcmVxdWVzdElkOiByZXF1ZXN0SWRTdHIsXG4gICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgaGFzVGV4dENvbnRlbnQ6IGhhc1RleHRDb250ZW50XG4gICAgICAgIH07XG4gICAgICAgIGdsb2JhbC5fX2luc3BlY3Rvci5kYXRhRm9yUmVxdWVzdElkKHN1Y2Nlc3NmdWxSZXF1ZXN0RGF0YSk7XG4gICAgfVxuICAgIE5ldHdvcmtBZ2VudC5yZXNwb25zZVJlY2VpdmVkID0gcmVzcG9uc2VSZWNlaXZlZDtcbiAgICBmdW5jdGlvbiByZXF1ZXN0V2lsbEJlU2VudChyZXF1ZXN0SWQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHJlcXVlc3QgPSB7XG4gICAgICAgICAgICB1cmw6IG9wdGlvbnMudXJsLFxuICAgICAgICAgICAgbWV0aG9kOiBvcHRpb25zLm1ldGhvZCxcbiAgICAgICAgICAgIGhlYWRlcnM6IG9wdGlvbnMuaGVhZGVycyB8fCB7fSxcbiAgICAgICAgICAgIHBvc3REYXRhOiBvcHRpb25zLmNvbnRlbnQgPyBvcHRpb25zLmNvbnRlbnQudG9TdHJpbmcoKSA6IFwiXCIsXG4gICAgICAgICAgICBpbml0aWFsUHJpb3JpdHk6IFwiTWVkaXVtXCIsXG4gICAgICAgICAgICByZWZlcnJlclBvbGljeTogXCJuby1yZWZlcnJlci13aGVuLWRvd25ncmFkZVwiXG4gICAgICAgIH07XG4gICAgICAgIHZhciByZXF1ZXN0RGF0YSA9IHtcbiAgICAgICAgICAgIHJlcXVlc3RJZDogcmVxdWVzdElkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICB1cmw6IHJlcXVlc3QudXJsLFxuICAgICAgICAgICAgcmVxdWVzdDogcmVxdWVzdCxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogZ2V0VGltZVN0YW1wKCksXG4gICAgICAgICAgICB0eXBlOiBcIkRvY3VtZW50XCIsXG4gICAgICAgICAgICB3YWxsVGltZTogMFxuICAgICAgICB9O1xuICAgICAgICBnbG9iYWwuX19pbnNwZWN0b3IucmVxdWVzdFdpbGxCZVNlbnQocmVxdWVzdERhdGEpO1xuICAgIH1cbiAgICBOZXR3b3JrQWdlbnQucmVxdWVzdFdpbGxCZVNlbnQgPSByZXF1ZXN0V2lsbEJlU2VudDtcbiAgICBmdW5jdGlvbiBnZXRUaW1lU3RhbXAoKSB7XG4gICAgICAgIHZhciBkID0gbmV3IERhdGUoKTtcbiAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoZC5nZXRUaW1lKCkgLyAxMDAwKTtcbiAgICB9XG4gICAgZnVuY3Rpb24gbWltZVR5cGVUb1R5cGUobWltZVR5cGUpIHtcbiAgICAgICAgdmFyIHR5cGUgPSBcIkRvY3VtZW50XCI7XG4gICAgICAgIGlmIChtaW1lVHlwZSkge1xuICAgICAgICAgICAgaWYgKG1pbWVUeXBlLmluZGV4T2YoXCJpbWFnZVwiKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBcIkltYWdlXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChtaW1lVHlwZS5pbmRleE9mKFwiamF2YXNjcmlwdFwiKSAhPT0gLTEgfHwgbWltZVR5cGUuaW5kZXhPZihcImpzb25cIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IFwiU2NyaXB0XCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHR5cGU7XG4gICAgfVxufSkoTmV0d29ya0FnZW50ID0gZXhwb3J0cy5OZXR3b3JrQWdlbnQgfHwgKGV4cG9ydHMuTmV0d29ya0FnZW50ID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRlYnVnZ2VyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciByZWdpc3RlcmVkRG9tTm9kZXMgPSB7fTtcbnZhciBFTEVNRU5UX05PREVfVFlQRSA9IDE7XG52YXIgUk9PVF9OT0RFX1RZUEUgPSA5O1xudmFyIHByb3BlcnR5QmxhY2tsaXN0ID0gW1xuICAgIFwiZWZmZWN0aXZlUGFkZGluZ0xlZnRcIixcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdCb3R0b21cIixcbiAgICBcImVmZmVjdGl2ZVBhZGRpbmdSaWdodFwiLFxuICAgIFwiZWZmZWN0aXZlUGFkZGluZ1RvcFwiLFxuICAgIFwiZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGhcIixcbiAgICBcImVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGhcIixcbiAgICBcImVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVCb3JkZXJMZWZ0V2lkdGhcIixcbiAgICBcImVmZmVjdGl2ZU1pbldpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVNaW5IZWlnaHRcIixcbiAgICBcImVmZmVjdGl2ZVdpZHRoXCIsXG4gICAgXCJlZmZlY3RpdmVIZWlnaHRcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpbkxlZnRcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpblRvcFwiLFxuICAgIFwiZWZmZWN0aXZlTWFyZ2luUmlnaHRcIixcbiAgICBcImVmZmVjdGl2ZU1hcmdpbkJvdHRvbVwiLFxuICAgIFwibm9kZU5hbWVcIixcbiAgICBcIm5vZGVUeXBlXCIsXG4gICAgXCJkZWNvZGVXaWR0aFwiLFxuICAgIFwiZGVjb2RlSGVpZ2h0XCIsXG4gICAgXCJuZy1yZWZsZWN0LWl0ZW1zXCIsXG4gICAgXCJkb21Ob2RlXCIsXG4gICAgXCJ0b3VjaExpc3RlbmVySXNTZXRcIixcbiAgICBcImJpbmRpbmdDb250ZXh0XCIsXG4gICAgXCJuYXRpdmVWaWV3XCJcbl07XG5mdW5jdGlvbiBsYXp5KGFjdGlvbikge1xuICAgIHZhciBfdmFsdWU7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF92YWx1ZSB8fCAoX3ZhbHVlID0gYWN0aW9uKCkpOyB9O1xufVxudmFyIHBlcmNlbnRMZW5ndGhUb1N0cmluZ0xhenkgPSBsYXp5KGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCIuLi91aS9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIikuUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmc7IH0pO1xudmFyIGdldFNldFByb3BlcnRpZXNMYXp5ID0gbGF6eShmdW5jdGlvbiAoKSB7IHJldHVybiByZXF1aXJlKFwiLi4vdWkvY29yZS9wcm9wZXJ0aWVzXCIpLmdldFNldFByb3BlcnRpZXM7IH0pO1xudmFyIGdldENvbXB1dGVkQ3NzVmFsdWVzTGF6eSA9IGxhenkoZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcIi4uL3VpL2NvcmUvcHJvcGVydGllc1wiKS5nZXRDb21wdXRlZENzc1ZhbHVlczsgfSk7XG5mdW5jdGlvbiByZWdpc3Rlckluc3BlY3RvckV2ZW50cyhpbnNwZWN0b3IpIHtcbiAgICBpbnNwZWN0b3JGcm9udGVuZEluc3RhbmNlID0gaW5zcGVjdG9yO1xufVxuZXhwb3J0cy5yZWdpc3Rlckluc3BlY3RvckV2ZW50cyA9IHJlZ2lzdGVySW5zcGVjdG9yRXZlbnRzO1xudmFyIGluc3BlY3RvckZyb250ZW5kSW5zdGFuY2U7XG5mdW5jdGlvbiBub3RpZnlJbnNwZWN0b3IoY2FsbGJhY2spIHtcbiAgICBpZiAoaW5zcGVjdG9yRnJvbnRlbmRJbnN0YW5jZSkge1xuICAgICAgICBjYWxsYmFjayhpbnNwZWN0b3JGcm9udGVuZEluc3RhbmNlKTtcbiAgICB9XG59XG5mdW5jdGlvbiB2YWx1ZVRvU3RyaW5nKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJ1bmRlZmluZWRcIiB8fCB2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlLnVuaXQpIHtcbiAgICAgICAgcmV0dXJuIHBlcmNlbnRMZW5ndGhUb1N0cmluZ0xhenkoKSh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gdmFsdWUgKyBcIlwiO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHByb3BlcnR5RmlsdGVyKF9hKSB7XG4gICAgdmFyIG5hbWUgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcbiAgICBpZiAobmFtZVswXSA9PT0gXCJfXCIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodmFsdWUgIT09IG51bGwgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHByb3BlcnR5QmxhY2tsaXN0LmluZGV4T2YobmFtZSkgPj0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJOb2RlKGRvbU5vZGUpIHtcbiAgICByZWdpc3RlcmVkRG9tTm9kZXNbZG9tTm9kZS5ub2RlSWRdID0gZG9tTm9kZTtcbn1cbmZ1bmN0aW9uIHVucmVnaXN0ZXJOb2RlKGRvbU5vZGUpIHtcbiAgICBkZWxldGUgcmVnaXN0ZXJlZERvbU5vZGVzW2RvbU5vZGUubm9kZUlkXTtcbn1cbmZ1bmN0aW9uIGdldE5vZGVCeUlkKGlkKSB7XG4gICAgcmV0dXJuIHJlZ2lzdGVyZWREb21Ob2Rlc1tpZF07XG59XG5leHBvcnRzLmdldE5vZGVCeUlkID0gZ2V0Tm9kZUJ5SWQ7XG52YXIgRE9NTm9kZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRE9NTm9kZSh2aWV3KSB7XG4gICAgICAgIHRoaXMubm9kZVZhbHVlID0gXCJcIjtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIHRoaXMudmlld1JlZiA9IG5ldyBXZWFrUmVmKHZpZXcpO1xuICAgICAgICB0aGlzLm5vZGVUeXBlID0gdmlldy50eXBlTmFtZSA9PT0gXCJGcmFtZVwiID8gUk9PVF9OT0RFX1RZUEUgOiBFTEVNRU5UX05PREVfVFlQRTtcbiAgICAgICAgdGhpcy5ub2RlSWQgPSB2aWV3Ll9kb21JZDtcbiAgICAgICAgdGhpcy5ub2RlTmFtZSA9IHZpZXcudHlwZU5hbWU7XG4gICAgICAgIHRoaXMubG9jYWxOYW1lID0gdGhpcy5ub2RlTmFtZTtcbiAgICAgICAgdGhpcy5sb2FkQXR0cmlidXRlcygpO1xuICAgICAgICByZWdpc3Rlck5vZGUodGhpcyk7XG4gICAgfVxuICAgIERPTU5vZGUucHJvdG90eXBlLmxvYWRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBbXTtcbiAgICAgICAgZ2V0U2V0UHJvcGVydGllc0xhenkoKSh0aGlzLnZpZXdSZWYuZ2V0KCkpXG4gICAgICAgICAgICAuZmlsdGVyKHByb3BlcnR5RmlsdGVyKVxuICAgICAgICAgICAgLmZvckVhY2goZnVuY3Rpb24gKHBhaXIpIHsgcmV0dXJuIF90aGlzLmF0dHJpYnV0ZXMucHVzaChwYWlyWzBdLCBwYWlyWzFdICsgXCJcIik7IH0pO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERPTU5vZGUucHJvdG90eXBlLCBcImNoaWxkcmVuXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZXMgPSBbXTtcbiAgICAgICAgICAgIHZpZXcuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgICAgIGNoaWxkLmVuc3VyZURvbU5vZGUoKTtcbiAgICAgICAgICAgICAgICByZXMucHVzaChjaGlsZC5kb21Ob2RlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRE9NTm9kZS5wcm90b3R5cGUub25DaGlsZEFkZGVkID0gZnVuY3Rpb24gKGNoaWxkVmlldykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBub3RpZnlJbnNwZWN0b3IoZnVuY3Rpb24gKGlucykge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSBfdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgdmFyIHByZXZpb3VzQ2hpbGQ7XG4gICAgICAgICAgICB2aWV3LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICBpZiAoY2hpbGQgPT09IGNoaWxkVmlldykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByZXZpb3VzQ2hpbGQgPSBjaGlsZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gISFwcmV2aW91c0NoaWxkID8gcHJldmlvdXNDaGlsZC5fZG9tSWQgOiAwO1xuICAgICAgICAgICAgY2hpbGRWaWV3LmVuc3VyZURvbU5vZGUoKTtcbiAgICAgICAgICAgIGlucy5jaGlsZE5vZGVJbnNlcnRlZChfdGhpcy5ub2RlSWQsIGluZGV4LCBjaGlsZFZpZXcuZG9tTm9kZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUub25DaGlsZFJlbW92ZWQgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBub3RpZnlJbnNwZWN0b3IoZnVuY3Rpb24gKGlucykge1xuICAgICAgICAgICAgaW5zLmNoaWxkTm9kZVJlbW92ZWQoX3RoaXMubm9kZUlkLCB2aWV3Ll9kb21JZCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuYXR0cmlidXRlTW9kaWZpZWQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUJsYWNrbGlzdC5pbmRleE9mKG5hbWUpIDwgMCkge1xuICAgICAgICAgICAgICAgIGlucy5hdHRyaWJ1dGVNb2RpZmllZChfdGhpcy5ub2RlSWQsIG5hbWUsIHZhbHVlVG9TdHJpbmcodmFsdWUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBET01Ob2RlLnByb3RvdHlwZS5hdHRyaWJ1dGVSZW1vdmVkID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgbm90aWZ5SW5zcGVjdG9yKGZ1bmN0aW9uIChpbnMpIHtcbiAgICAgICAgICAgIGlucy5hdHRyaWJ1dGVSZW1vdmVkKF90aGlzLm5vZGVJZCwgbmFtZSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRE9NTm9kZS5wcm90b3R5cGUuZ2V0Q29tcHV0ZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IGdldENvbXB1dGVkQ3NzVmFsdWVzTGF6eSgpKHZpZXcpXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChwYWlyKSB7IHJldHVybiBwYWlyWzBdWzBdICE9PSBcIl9cIjsgfSlcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKHBhaXIpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogcGFpclswXSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWVUb1N0cmluZyhwYWlyWzFdKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBET01Ob2RlLnByb3RvdHlwZS5kaXNwb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB1bnJlZ2lzdGVyTm9kZSh0aGlzKTtcbiAgICAgICAgdGhpcy52aWV3UmVmLmNsZWFyKCk7XG4gICAgfTtcbiAgICBET01Ob2RlLnByb3RvdHlwZS50b09iamVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5vZGVJZDogdGhpcy5ub2RlSWQsXG4gICAgICAgICAgICBub2RlVHlwZTogdGhpcy5ub2RlVHlwZSxcbiAgICAgICAgICAgIG5vZGVOYW1lOiB0aGlzLm5vZGVOYW1lLFxuICAgICAgICAgICAgbG9jYWxOYW1lOiB0aGlzLmxvY2FsTmFtZSxcbiAgICAgICAgICAgIG5vZGVWYWx1ZTogdGhpcy5ub2RlVmFsdWUsXG4gICAgICAgICAgICBjaGlsZHJlbjogdGhpcy5jaGlsZHJlbi5tYXAoZnVuY3Rpb24gKGMpIHsgcmV0dXJuIGMudG9PYmplY3QoKTsgfSksXG4gICAgICAgICAgICBhdHRyaWJ1dGVzOiB0aGlzLmF0dHJpYnV0ZXMsXG4gICAgICAgICAgICBiYWNrZW5kTm9kZUlkOiAwXG4gICAgICAgIH07XG4gICAgfTtcbiAgICByZXR1cm4gRE9NTm9kZTtcbn0oKSk7XG5leHBvcnRzLkRPTU5vZGUgPSBET01Ob2RlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZG9tLW5vZGUuanMubWFwIiwi77u/KGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0ID0gZ2xvYmFsLlhNTEh0dHBSZXF1ZXN0O1xuICAgIGV4cG9ydHMuRm9ybURhdGEgPSBnbG9iYWwuRm9ybURhdGE7XG5cbiAgICBpZiAoIWV4cG9ydHMuWE1MSHR0cFJlcXVlc3QpIHtcbiAgICAgICAgdmFyIHhociA9IHJlcXVpcmUoXCJ4aHJcIik7XG4gICAgICAgIGV4cG9ydHMuWE1MSHR0cFJlcXVlc3QgPSB4aHIuWE1MSHR0cFJlcXVlc3Q7XG4gICAgICAgIGV4cG9ydHMuRm9ybURhdGEgPSB4aHIuRm9ybURhdGE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplTmFtZShuYW1lKSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC9bXmEtejAtOVxcLSMkJSYnKisuXFxeX2B8fl0vaS50ZXN0KG5hbWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIGNoYXJhY3RlciBpbiBoZWFkZXIgZmllbGQgbmFtZScpXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZVZhbHVlKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgICAgIHRoaXMubWFwID0ge31cblxuICAgICAgICBpZiAoaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMpIHtcbiAgICAgICAgICAgIGhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIG5hbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZChuYW1lLCB2YWx1ZSlcbiAgICAgICAgICAgIH0sIHRoaXMpXG5cbiAgICAgICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgICAgICAgIH0sIHRoaXMpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBIZWFkZXJzLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgbmFtZSA9IG5vcm1hbGl6ZU5hbWUobmFtZSlcbiAgICAgICAgdmFsdWUgPSBub3JtYWxpemVWYWx1ZSh2YWx1ZSlcbiAgICAgICAgdmFyIGxpc3QgPSB0aGlzLm1hcFtuYW1lXVxuICAgICAgICBpZiAoIWxpc3QpIHtcbiAgICAgICAgICAgIGxpc3QgPSBbXVxuICAgICAgICAgICAgdGhpcy5tYXBbbmFtZV0gPSBsaXN0XG4gICAgICAgIH1cbiAgICAgICAgbGlzdC5wdXNoKHZhbHVlKVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlWydkZWxldGUnXSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgICAgICByZXR1cm4gdmFsdWVzID8gdmFsdWVzWzBdIDogbnVsbFxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSB8fCBbXVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShub3JtYWxpemVOYW1lKG5hbWUpKVxuICAgIH1cblxuICAgIEhlYWRlcnMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXSA9IFtub3JtYWxpemVWYWx1ZSh2YWx1ZSldXG4gICAgfVxuXG4gICAgSGVhZGVycy5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIChjYWxsYmFjaywgdGhpc0FyZykge1xuICAgICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0aGlzLm1hcCkuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdGhpcy5tYXBbbmFtZV0uZm9yRWFjaChmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIHZhbHVlLCBuYW1lLCB0aGlzKVxuICAgICAgICAgICAgfSwgdGhpcylcbiAgICAgICAgfSwgdGhpcylcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb25zdW1lZChib2R5KSB7XG4gICAgICAgIGlmIChib2R5LmJvZHlVc2VkKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcignQWxyZWFkeSByZWFkJykpXG4gICAgICAgIH1cbiAgICAgICAgYm9keS5ib2R5VXNlZCA9IHRydWVcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlc29sdmUocmVhZGVyLnJlc3VsdClcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChyZWFkZXIuZXJyb3IpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGJsb2IpXG4gICAgICAgIHJldHVybiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlYWRCbG9iQXNUZXh0KGJsb2IpIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKClcbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICAgICAgcmV0dXJuIGZpbGVSZWFkZXJSZWFkeShyZWFkZXIpXG4gICAgfVxuXG4gICAgdmFyIHN1cHBvcnQgPSB7XG4gICAgICAgIGJsb2I6ICdGaWxlUmVhZGVyJyBpbiBleHBvcnRzICYmICdCbG9iJyBpbiBleHBvcnRzICYmIChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG5ldyBCbG9iKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKSxcbiAgICAgICAgZm9ybURhdGE6ICdGb3JtRGF0YScgaW4gZXhwb3J0c1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgICAgIHRoaXMuYm9keVVzZWQgPSBmYWxzZVxuXG5cbiAgICAgICAgdGhpcy5faW5pdEJvZHkgPSBmdW5jdGlvbiAoYm9keSkge1xuICAgICAgICAgICAgdGhpcy5fYm9keUluaXQgPSBib2R5XG4gICAgICAgICAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keVRleHQgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuYmxvYiAmJiBCbG9iLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGJvZHkpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYm9keUJsb2IgPSBib2R5XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHN1cHBvcnQuZm9ybURhdGEgJiYgZXhwb3J0cy5Gb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JvZHlGb3JtRGF0YSA9IGJvZHlcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIWJvZHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ib2R5VGV4dCA9ICcnXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VwcG9ydC5ibG9iKSB7XG4gICAgICAgICAgICB0aGlzLmJsb2IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlamVjdGVkID0gY29uc3VtZWQodGhpcylcbiAgICAgICAgICAgICAgICBpZiAocmVqZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGVkXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keUJsb2IpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIGJsb2InKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3RoaXMuX2JvZHlUZXh0XSkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgaWYgKHJlamVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZEJsb2JBc1RleHQodGhpcy5fYm9keUJsb2IpXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZCBub3QgcmVhZCBGb3JtRGF0YSBib2R5IGFzIHRleHQnKVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdGVkID8gcmVqZWN0ZWQgOiBQcm9taXNlLnJlc29sdmUodGhpcy5fYm9keVRleHQpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmpzb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICAvLyBIVFRQIG1ldGhvZHMgd2hvc2UgY2FwaXRhbGl6YXRpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWRcbiAgICB2YXIgbWV0aG9kcyA9IFsnREVMRVRFJywgJ0dFVCcsICdIRUFEJywgJ09QVElPTlMnLCAnUE9TVCcsICdQVVQnXVxuXG4gICAgZnVuY3Rpb24gbm9ybWFsaXplTWV0aG9kKG1ldGhvZCkge1xuICAgICAgICB2YXIgdXBjYXNlZCA9IG1ldGhvZC50b1VwcGVyQ2FzZSgpXG4gICAgICAgIHJldHVybiAobWV0aG9kcy5pbmRleE9mKHVwY2FzZWQpID4gLTEpID8gdXBjYXNlZCA6IG1ldGhvZFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIFJlcXVlc3QodXJsLCBvcHRpb25zKSB7XG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gICAgICAgIHRoaXMudXJsID0gdXJsXG5cbiAgICAgICAgdGhpcy5jcmVkZW50aWFscyA9IG9wdGlvbnMuY3JlZGVudGlhbHMgfHwgJ29taXQnXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG5ldyBIZWFkZXJzKG9wdGlvbnMuaGVhZGVycylcbiAgICAgICAgdGhpcy5tZXRob2QgPSBub3JtYWxpemVNZXRob2Qob3B0aW9ucy5tZXRob2QgfHwgJ0dFVCcpXG4gICAgICAgIHRoaXMubW9kZSA9IG9wdGlvbnMubW9kZSB8fCBudWxsXG4gICAgICAgIHRoaXMucmVmZXJyZXIgPSBudWxsXG5cbiAgICAgICAgaWYgKCh0aGlzLm1ldGhvZCA9PT0gJ0dFVCcgfHwgdGhpcy5tZXRob2QgPT09ICdIRUFEJykgJiYgb3B0aW9ucy5ib2R5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5faW5pdEJvZHkob3B0aW9ucy5ib2R5KVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGRlY29kZShib2R5KSB7XG4gICAgICAgIHZhciBmb3JtID0gbmV3IGV4cG9ydHMuRm9ybURhdGEoKVxuICAgICAgICBib2R5LnRyaW0oKS5zcGxpdCgnJicpLmZvckVhY2goZnVuY3Rpb24gKGJ5dGVzKSB7XG4gICAgICAgICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3BsaXQgPSBieXRlcy5zcGxpdCgnPScpXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzcGxpdC5zaGlmdCgpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgICAgICAgICAgZm9ybS5hcHBlbmQoZGVjb2RlVVJJQ29tcG9uZW50KG5hbWUpLCBkZWNvZGVVUklDb21wb25lbnQodmFsdWUpKVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gZm9ybVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGhlYWRlcnMoeGhyKSB7XG4gICAgICAgIHZhciBoZWFkID0gbmV3IEhlYWRlcnMoKVxuICAgICAgICB2YXIgcGFpcnMgPSB4aHIuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkudHJpbSgpLnNwbGl0KCdcXG4nKVxuICAgICAgICBwYWlycy5mb3JFYWNoKGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgIHZhciBzcGxpdCA9IGhlYWRlci50cmltKCkuc3BsaXQoJzonKVxuICAgICAgICAgICAgdmFyIGtleSA9IHNwbGl0LnNoaWZ0KCkudHJpbSgpXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBzcGxpdC5qb2luKCc6JykudHJpbSgpXG4gICAgICAgICAgICBoZWFkLmFwcGVuZChrZXksIHZhbHVlKVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gaGVhZFxuICAgIH1cblxuICAgIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICAgIGZ1bmN0aW9uIFJlc3BvbnNlKGJvZHlJbml0LCBvcHRpb25zKSB7XG4gICAgICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICAgICAgb3B0aW9ucyA9IHt9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9pbml0Qm9keShib2R5SW5pdClcbiAgICAgICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgICAgIHRoaXMudXJsID0gbnVsbFxuICAgICAgICB0aGlzLnN0YXR1cyA9IG9wdGlvbnMuc3RhdHVzXG4gICAgICAgIHRoaXMub2sgPSB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDBcbiAgICAgICAgdGhpcy5zdGF0dXNUZXh0ID0gb3B0aW9ucy5zdGF0dXNUZXh0XG4gICAgICAgIHRoaXMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyBpbnN0YW5jZW9mIEhlYWRlcnMgPyBvcHRpb25zLmhlYWRlcnMgOiBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gICAgICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgICB9XG5cbiAgICBCb2R5LmNhbGwoUmVzcG9uc2UucHJvdG90eXBlKVxuXG4gICAgZXhwb3J0cy5IZWFkZXJzID0gSGVhZGVycztcbiAgICBleHBvcnRzLlJlcXVlc3QgPSBSZXF1ZXN0O1xuICAgIGV4cG9ydHMuUmVzcG9uc2UgPSBSZXNwb25zZTtcblxuICAgIGV4cG9ydHMuZmV0Y2ggPSBmdW5jdGlvbiAoaW5wdXQsIGluaXQpIHtcbiAgICAgICAgLy8gVE9ETzogUmVxdWVzdCBjb25zdHJ1Y3RvciBzaG91bGQgYWNjZXB0IGlucHV0LCBpbml0XG4gICAgICAgIHZhciByZXF1ZXN0XG4gICAgICAgIGlmIChSZXF1ZXN0LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKGlucHV0KSAmJiAhaW5pdCkge1xuICAgICAgICAgICAgcmVxdWVzdCA9IGlucHV0XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXF1ZXN0ID0gbmV3IFJlcXVlc3QoaW5wdXQsIGluaXQpXG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIHhociA9IG5ldyBleHBvcnRzLlhNTEh0dHBSZXF1ZXN0KClcblxuICAgICAgICAgICAgZnVuY3Rpb24gcmVzcG9uc2VVUkwoKSB7XG4gICAgICAgICAgICAgICAgaWYgKCdyZXNwb25zZVVSTCcgaW4geGhyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VVUkxcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBBdm9pZCBzZWN1cml0eSB3YXJuaW5ncyBvbiBnZXRSZXNwb25zZUhlYWRlciB3aGVuIG5vdCBhbGxvd2VkIGJ5IENPUlNcbiAgICAgICAgICAgICAgICBpZiAoL15YLVJlcXVlc3QtVVJMOi9tLnRlc3QoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geGhyLmdldFJlc3BvbnNlSGVhZGVyKCdYLVJlcXVlc3QtVVJMJylcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXR1cyA9ICh4aHIuc3RhdHVzID09PSAxMjIzKSA/IDIwNCA6IHhoci5zdGF0dXNcbiAgICAgICAgICAgICAgICBpZiAoc3RhdHVzIDwgMTAwIHx8IHN0YXR1cyA+IDU5OSkge1xuICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiB4aHIuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyh4aHIpLFxuICAgICAgICAgICAgICAgICAgICB1cmw6IHJlc3BvbnNlVVJMKClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy92YXIgYm9keSA9ICdyZXNwb25zZScgaW4geGhyID8geGhyLnJlc3BvbnNlIDogeGhyLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgICAgICByZXNvbHZlKG5ldyBSZXNwb25zZSh4aHIucmVzcG9uc2VUZXh0LCBvcHRpb25zKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcihbJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQ6JywgZXJyb3IubWVzc2FnZV0uam9pbignICcpKSlcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLm9wZW4ocmVxdWVzdC5tZXRob2QsIHJlcXVlc3QudXJsLCB0cnVlKVxuXG4gICAgICAgICAgICBpZiAocmVxdWVzdC5jcmVkZW50aWFscyA9PT0gJ2luY2x1ZGUnKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCdyZXNwb25zZVR5cGUnIGluIHhociAmJiBzdXBwb3J0LmJsb2IpIHtcbiAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlcXVlc3QuaGVhZGVycy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgbmFtZSkge1xuICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKG5hbWUsIHZhbHVlKVxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgeGhyLnNlbmQodHlwZW9mIHJlcXVlc3QuX2JvZHlJbml0ID09PSAndW5kZWZpbmVkJyA/IG51bGwgOiByZXF1ZXN0Ll9ib2R5SW5pdClcbiAgICAgICAgfSlcbiAgICB9XG4gICAgZXhwb3J0cy5mZXRjaC5wb2x5ZmlsbCA9IHRydWVcblxufSkoKTsiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dF8xID0gcmVxdWlyZShcIi4uL3RleHRcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcbnZhciBGaWxlU3lzdGVtQWNjZXNzID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlU3lzdGVtQWNjZXNzKCkge1xuICAgIH1cbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRMYXN0TW9kaWZpZWQgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IGZpbGVNYW5hZ2VyLmF0dHJpYnV0ZXNPZkl0ZW1BdFBhdGhFcnJvcihwYXRoKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzLm9iamVjdEZvcktleShcIk5TRmlsZU1vZGlmaWNhdGlvbkRhdGVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RmlsZVNpemUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IGZpbGVNYW5hZ2VyLmF0dHJpYnV0ZXNPZkl0ZW1BdFBhdGhFcnJvcihwYXRoKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVzLm9iamVjdEZvcktleShcIk5TRmlsZVNpemVcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0UGFyZW50ID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgICAgICB2YXIgbnNTdHJpbmcgPSBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKHBhdGgpO1xuICAgICAgICAgICAgdmFyIHBhcmVudFBhdGggPSBuc1N0cmluZy5zdHJpbmdCeURlbGV0aW5nTGFzdFBhdGhDb21wb25lbnQ7XG4gICAgICAgICAgICB2YXIgbmFtZV8xID0gZmlsZU1hbmFnZXIuZGlzcGxheU5hbWVBdFBhdGgocGFyZW50UGF0aCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBhdGg6IHBhcmVudFBhdGgudG9TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXzFcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRGaWxlID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgICAgICB2YXIgZXhpc3RzID0gZmlsZU1hbmFnZXIuZmlsZUV4aXN0c0F0UGF0aChwYXRoKTtcbiAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudFBhdGggPSB0aGlzLmdldFBhcmVudChwYXRoLCBvbkVycm9yKS5wYXRoO1xuICAgICAgICAgICAgICAgIGlmICghZmlsZU1hbmFnZXIuY3JlYXRlRGlyZWN0b3J5QXRQYXRoV2l0aEludGVybWVkaWF0ZURpcmVjdG9yaWVzQXR0cmlidXRlc0Vycm9yKHBhcmVudFBhdGgsIHRydWUsIG51bGwpXG4gICAgICAgICAgICAgICAgICAgIHx8ICFmaWxlTWFuYWdlci5jcmVhdGVGaWxlQXRQYXRoQ29udGVudHNBdHRyaWJ1dGVzKHBhdGgsIG51bGwsIG51bGwpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgZmlsZSBhdCBwYXRoICdcIiArIHBhdGggKyBcIidcIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gZmlsZU1hbmFnZXIuZGlzcGxheU5hbWVBdFBhdGgocGF0aCk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHBhdGg6IHBhdGgsXG4gICAgICAgICAgICAgICAgbmFtZTogZmlsZU5hbWUsXG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uOiB0aGlzLmdldEZpbGVFeHRlbnNpb24ocGF0aClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4Y2VwdGlvbikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGV4Y2VwdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRGb2xkZXIgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgICAgIHZhciBleGlzdHMgPSB0aGlzLmZvbGRlckV4aXN0cyhwYXRoKTtcbiAgICAgICAgICAgIGlmICghZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgZmlsZU1hbmFnZXIuY3JlYXRlRGlyZWN0b3J5QXRQYXRoV2l0aEludGVybWVkaWF0ZURpcmVjdG9yaWVzQXR0cmlidXRlc0Vycm9yKHBhdGgsIHRydWUsIG51bGwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXIgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInOiBcIiArIGV4KSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGlyTmFtZSA9IGZpbGVNYW5hZ2VyLmRpc3BsYXlOYW1lQXRQYXRoKHBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwYXRoOiBwYXRoLFxuICAgICAgICAgICAgICAgIG5hbWU6IGRpck5hbWVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXIgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEV4aXN0aW5nRm9sZGVyID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgICAgICB2YXIgZXhpc3RzID0gdGhpcy5mb2xkZXJFeGlzdHMocGF0aCk7XG4gICAgICAgICAgICBpZiAoZXhpc3RzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRpck5hbWUgPSBmaWxlTWFuYWdlci5kaXNwbGF5TmFtZUF0UGF0aChwYXRoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBwYXRoOiBwYXRoLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBkaXJOYW1lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIGdldCBmb2xkZXIgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInXCIpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVhY2hFbnRpdHkgPSBmdW5jdGlvbiAocGF0aCwgb25FbnRpdHksIG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKCFvbkVudGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW51bUVudGl0aWVzKHBhdGgsIG9uRW50aXR5LCBvbkVycm9yKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldEVudGl0aWVzID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGZpbGVJbmZvcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgb25FbnRpdHkgPSBmdW5jdGlvbiAoZW50aXR5KSB7XG4gICAgICAgICAgICBmaWxlSW5mb3MucHVzaChlbnRpdHkpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBlcnJvck9jY3VycmVkO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVycm9yT2NjdXJyZWQgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmVudW1FbnRpdGllcyhwYXRoLCBvbkVudGl0eSwgbG9jYWxFcnJvcik7XG4gICAgICAgIGlmICghZXJyb3JPY2N1cnJlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZpbGVJbmZvcztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmZpbGVFeGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5leGlzdHMocGF0aCk7XG4gICAgICAgIHJldHVybiByZXN1bHQuZXhpc3RzO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZm9sZGVyRXhpc3RzID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuZXhpc3RzKHBhdGgpO1xuICAgICAgICByZXR1cm4gcmVzdWx0LmV4aXN0cyAmJiByZXN1bHQuaXNEaXJlY3Rvcnk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5leGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgaXNEaXJlY3RvcnkgPSBuZXcgaW50ZXJvcC5SZWZlcmVuY2UoaW50ZXJvcC50eXBlcy5ib29sLCBmYWxzZSk7XG4gICAgICAgIHZhciBleGlzdHMgPSBmaWxlTWFuYWdlci5maWxlRXhpc3RzQXRQYXRoSXNEaXJlY3RvcnkocGF0aCwgaXNEaXJlY3RvcnkpO1xuICAgICAgICByZXR1cm4geyBleGlzdHM6IGV4aXN0cywgaXNEaXJlY3Rvcnk6IGlzRGlyZWN0b3J5LnZhbHVlIH07XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5jb25jYXRQYXRoID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgIHJldHVybiBOU1N0cmluZy5wYXRoV2l0aENvbXBvbmVudHMoW2xlZnQsIHJpZ2h0XSkudG9TdHJpbmcoKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmRlbGV0ZUZpbGUgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB0aGlzLmRlbGV0ZUVudGl0eShwYXRoLCBvbkVycm9yKTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmRlbGV0ZUZvbGRlciA9IGZ1bmN0aW9uIChwYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHRoaXMuZGVsZXRlRW50aXR5KHBhdGgsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZW1wdHlGb2xkZXIgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvcikge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgZW50aXRpZXMgPSB0aGlzLmdldEVudGl0aWVzKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWVudGl0aWVzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbnRpdGllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmaWxlTWFuYWdlci5yZW1vdmVJdGVtQXRQYXRoRXJyb3IoZW50aXRpZXNbaV0ucGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byBlbXB0eSBmb2xkZXIgJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLnJlbmFtZSA9IGZ1bmN0aW9uIChwYXRoLCBuZXdQYXRoLCBvbkVycm9yKSB7XG4gICAgICAgIHZhciBmaWxlTWFuYWdlciA9IE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXI7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmaWxlTWFuYWdlci5tb3ZlSXRlbUF0UGF0aFRvUGF0aEVycm9yKHBhdGgsIG5ld1BhdGgpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byByZW5hbWUgJ1wiICsgcGF0aCArIFwiJyB0byAnXCIgKyBuZXdQYXRoICsgXCInOiBcIiArIGV4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldExvZ2ljYWxSb290UGF0aCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG1haW5CdW5kbGVQYXRoID0gTlNCdW5kbGUubWFpbkJ1bmRsZS5idW5kbGVQYXRoO1xuICAgICAgICB2YXIgcmVzb2x2ZWRQYXRoID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhtYWluQnVuZGxlUGF0aCkuc3RyaW5nQnlSZXNvbHZpbmdTeW1saW5rc0luUGF0aDtcbiAgICAgICAgcmV0dXJuIHJlc29sdmVkUGF0aDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldERvY3VtZW50c0ZvbGRlclBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEtub3duUGF0aCg5KTtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmdldFRlbXBGb2xkZXJQYXRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRLbm93blBhdGgoMTMpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0Q3VycmVudEFwcFBhdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmlvcy5nZXRDdXJyZW50QXBwUGF0aCgpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUucmVhZFRleHQgPSBmdW5jdGlvbiAocGF0aCwgb25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIGFjdHVhbEVuY29kaW5nID0gZW5jb2RpbmcgfHwgdGV4dF8xLmVuY29kaW5nLlVURl84O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG5zU3RyaW5nID0gTlNTdHJpbmcuc3RyaW5nV2l0aENvbnRlbnRzT2ZGaWxlRW5jb2RpbmdFcnJvcihwYXRoLCBhY3R1YWxFbmNvZGluZyk7XG4gICAgICAgICAgICByZXR1cm4gbnNTdHJpbmcudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmVhZCBmaWxlIGF0IHBhdGggJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5yZWFkID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBOU0RhdGEuZGF0YVdpdGhDb250ZW50c09mRmlsZShwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcmVhZCBmaWxlIGF0IHBhdGggJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS53cml0ZVRleHQgPSBmdW5jdGlvbiAocGF0aCwgY29udGVudCwgb25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIG5zU3RyaW5nID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhjb250ZW50KTtcbiAgICAgICAgdmFyIGFjdHVhbEVuY29kaW5nID0gZW5jb2RpbmcgfHwgdGV4dF8xLmVuY29kaW5nLlVURl84O1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgbnNTdHJpbmcud3JpdGVUb0ZpbGVBdG9taWNhbGx5RW5jb2RpbmdFcnJvcihwYXRoLCBmYWxzZSwgYWN0dWFsRW5jb2RpbmcpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byB3cml0ZSB0byBmaWxlICdcIiArIHBhdGggKyBcIic6IFwiICsgZXgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUud3JpdGUgPSBmdW5jdGlvbiAocGF0aCwgY29udGVudCwgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29udGVudC53cml0ZVRvRmlsZUF0b21pY2FsbHkocGF0aCwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IobmV3IEVycm9yKFwiRmFpbGVkIHRvIHdyaXRlIHRvIGZpbGUgJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRLbm93blBhdGggPSBmdW5jdGlvbiAoZm9sZGVyVHlwZSkge1xuICAgICAgICB2YXIgZmlsZU1hbmFnZXIgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyO1xuICAgICAgICB2YXIgcGF0aHMgPSBmaWxlTWFuYWdlci5VUkxzRm9yRGlyZWN0b3J5SW5Eb21haW5zKGZvbGRlclR5cGUsIDEpO1xuICAgICAgICB2YXIgdXJsID0gcGF0aHMub2JqZWN0QXRJbmRleCgwKTtcbiAgICAgICAgcmV0dXJuIHVybC5wYXRoO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZ2V0RmlsZUV4dGVuc2lvbiA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBkb3RJbmRleCA9IHBhdGgubGFzdEluZGV4T2YoXCIuXCIpO1xuICAgICAgICBpZiAoZG90SW5kZXggJiYgZG90SW5kZXggPj0gMCAmJiBkb3RJbmRleCA8IHBhdGgubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGF0aC5zdWJzdHJpbmcoZG90SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuZGVsZXRlRW50aXR5ID0gZnVuY3Rpb24gKHBhdGgsIG9uRXJyb3IpIHtcbiAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGZpbGVNYW5hZ2VyLnJlbW92ZUl0ZW1BdFBhdGhFcnJvcihwYXRoKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZGVsZXRlIGZpbGUgYXQgcGF0aCAnXCIgKyBwYXRoICsgXCInOiBcIiArIGV4KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmVudW1FbnRpdGllcyA9IGZ1bmN0aW9uIChwYXRoLCBjYWxsYmFjaywgb25FcnJvcikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGZpbGVNYW5hZ2VyID0gTlNGaWxlTWFuYWdlci5kZWZhdWx0TWFuYWdlcjtcbiAgICAgICAgICAgIHZhciBmaWxlcyA9IHZvaWQgMDtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgZmlsZXMgPSBmaWxlTWFuYWdlci5jb250ZW50c09mRGlyZWN0b3J5QXRQYXRoRXJyb3IocGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKG5ldyBFcnJvcihcIkZhaWxlZCB0byBlbnVtIGZpbGVzIGZvciBmb2xkZXIgJ1wiICsgcGF0aCArIFwiJzogXCIgKyBleCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVzLmNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGZpbGVzLm9iamVjdEF0SW5kZXgoaSk7XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHRoaXMuY29uY2F0UGF0aChwYXRoLCBmaWxlKSxcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogZmlsZSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uOiBcIlwiXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZm9sZGVyRXhpc3RzKHRoaXMuam9pblBhdGgocGF0aCwgZmlsZSkpKSB7XG4gICAgICAgICAgICAgICAgICAgIGluZm8uZXh0ZW5zaW9uID0gdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKGluZm8ucGF0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciByZXRWYWwgPSBjYWxsYmFjayhpbmZvKTtcbiAgICAgICAgICAgICAgICBpZiAocmV0VmFsID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5nZXRQYXRoU2VwYXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCIvXCI7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtQWNjZXNzLnByb3RvdHlwZS5ub3JtYWxpemVQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIG5zU3RyaW5nID0gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhwYXRoKTtcbiAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSBuc1N0cmluZy5zdHJpbmdCeVN0YW5kYXJkaXppbmdQYXRoO1xuICAgICAgICByZXR1cm4gbm9ybWFsaXplZDtcbiAgICB9O1xuICAgIEZpbGVTeXN0ZW1BY2Nlc3MucHJvdG90eXBlLmpvaW5QYXRoID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgIHZhciBuc1N0cmluZyA9IE5TU3RyaW5nLnN0cmluZ1dpdGhTdHJpbmcobGVmdCk7XG4gICAgICAgIHJldHVybiBuc1N0cmluZy5zdHJpbmdCeUFwcGVuZGluZ1BhdGhDb21wb25lbnQocmlnaHQpO1xuICAgIH07XG4gICAgRmlsZVN5c3RlbUFjY2Vzcy5wcm90b3R5cGUuam9pblBhdGhzID0gZnVuY3Rpb24gKHBhdGhzKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmlvcy5qb2luUGF0aHMuYXBwbHkodXRpbHNfMS5pb3MsIHBhdGhzKTtcbiAgICB9O1xuICAgIHJldHVybiBGaWxlU3lzdGVtQWNjZXNzO1xufSgpKTtcbmV4cG9ydHMuRmlsZVN5c3RlbUFjY2VzcyA9IEZpbGVTeXN0ZW1BY2Nlc3M7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWxlLXN5c3RlbS1hY2Nlc3MuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmaWxlX3N5c3RlbV9hY2Nlc3NfMSA9IHJlcXVpcmUoXCIuL2ZpbGUtc3lzdGVtLWFjY2Vzc1wiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi9wcm9maWxpbmdcIik7XG52YXIgZmlsZUFjY2VzcztcbmZ1bmN0aW9uIGdldEZpbGVBY2Nlc3MoKSB7XG4gICAgaWYgKCFmaWxlQWNjZXNzKSB7XG4gICAgICAgIGZpbGVBY2Nlc3MgPSBuZXcgZmlsZV9zeXN0ZW1fYWNjZXNzXzEuRmlsZVN5c3RlbUFjY2VzcygpO1xuICAgIH1cbiAgICByZXR1cm4gZmlsZUFjY2Vzcztcbn1cbnZhciBwbGF0Zm9ybTtcbmZ1bmN0aW9uIGVuc3VyZVBsYXRmb3JtKCkge1xuICAgIGlmICghcGxhdGZvcm0pIHtcbiAgICAgICAgcGxhdGZvcm0gPSByZXF1aXJlKFwicGxhdGZvcm1cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlRmlsZShpbmZvKSB7XG4gICAgdmFyIGZpbGUgPSBuZXcgRmlsZSgpO1xuICAgIGZpbGUuX3BhdGggPSBpbmZvLnBhdGg7XG4gICAgZmlsZS5fbmFtZSA9IGluZm8ubmFtZTtcbiAgICBmaWxlLl9leHRlbnNpb24gPSBpbmZvLmV4dGVuc2lvbjtcbiAgICByZXR1cm4gZmlsZTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUZvbGRlcihpbmZvKSB7XG4gICAgdmFyIGRvY3VtZW50cyA9IGtub3duRm9sZGVycy5kb2N1bWVudHMoKTtcbiAgICBpZiAoaW5mby5wYXRoID09PSBkb2N1bWVudHMucGF0aCkge1xuICAgICAgICByZXR1cm4gZG9jdW1lbnRzO1xuICAgIH1cbiAgICB2YXIgdGVtcCA9IGtub3duRm9sZGVycy50ZW1wKCk7XG4gICAgaWYgKGluZm8ucGF0aCA9PT0gdGVtcC5wYXRoKSB7XG4gICAgICAgIHJldHVybiB0ZW1wO1xuICAgIH1cbiAgICB2YXIgZm9sZGVyID0gbmV3IEZvbGRlcigpO1xuICAgIGZvbGRlci5fcGF0aCA9IGluZm8ucGF0aDtcbiAgICBmb2xkZXIuX25hbWUgPSBpbmZvLm5hbWU7XG4gICAgcmV0dXJuIGZvbGRlcjtcbn1cbnZhciBGaWxlU3lzdGVtRW50aXR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGaWxlU3lzdGVtRW50aXR5KCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUsIFwicGFyZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb25FcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBmb2xkZXJJbmZvID0gZ2V0RmlsZUFjY2VzcygpLmdldFBhcmVudCh0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFmb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjcmVhdGVGb2xkZXIoZm9sZGVySW5mbyk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5yZW1vdmVTeW5jKGxvY2FsRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZS5yZW1vdmVTeW5jID0gZnVuY3Rpb24gKG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzS25vd24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcih7IG1lc3NhZ2U6IFwiQ2Fubm90IGRlbGV0ZSBrbm93biBmb2xkZXIuXCIgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgRmlsZSkge1xuICAgICAgICAgICAgZmlsZUFjY2Vzcy5kZWxldGVGaWxlKHRoaXMucGF0aCwgb25FcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcyBpbnN0YW5jZW9mIEZvbGRlcikge1xuICAgICAgICAgICAgZmlsZUFjY2Vzcy5kZWxldGVGb2xkZXIodGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUucmVuYW1lID0gZnVuY3Rpb24gKG5ld05hbWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy5yZW5hbWVTeW5jKG5ld05hbWUsIGxvY2FsRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZS5yZW5hbWVTeW5jID0gZnVuY3Rpb24gKG5ld05hbWUsIG9uRXJyb3IpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzS25vd24pIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJDYW5ub3QgcmVuYW1lIGtub3duIGZvbGRlci5cIikpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnRGb2xkZXIgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKCFwYXJlbnRGb2xkZXIpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IoXCJObyBwYXJlbnQgZm9sZGVyLlwiKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHZhciBwYXRoID0gcGFyZW50Rm9sZGVyLnBhdGg7XG4gICAgICAgIHZhciBuZXdQYXRoID0gZmlsZUFjY2Vzcy5qb2luUGF0aChwYXRoLCBuZXdOYW1lKTtcbiAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgZmlsZUFjY2Vzcy5yZW5hbWUodGhpcy5wYXRoLCBuZXdQYXRoLCBsb2NhbEVycm9yKTtcbiAgICAgICAgdGhpcy5fcGF0aCA9IG5ld1BhdGg7XG4gICAgICAgIHRoaXMuX25hbWUgPSBuZXdOYW1lO1xuICAgICAgICBpZiAodGhpcyBpbnN0YW5jZW9mIEZpbGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2V4dGVuc2lvbiA9IGZpbGVBY2Nlc3MuZ2V0RmlsZUV4dGVuc2lvbihuZXdQYXRoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbGVTeXN0ZW1FbnRpdHkucHJvdG90eXBlLCBcIm5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZVN5c3RlbUVudGl0eS5wcm90b3R5cGUsIFwicGF0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhdGg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlU3lzdGVtRW50aXR5LnByb3RvdHlwZSwgXCJsYXN0TW9kaWZpZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX2xhc3RNb2RpZmllZDtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbGFzdE1vZGlmaWVkKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl9sYXN0TW9kaWZpZWQgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0TGFzdE1vZGlmaWVkKHRoaXMucGF0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIHJldHVybiBGaWxlU3lzdGVtRW50aXR5O1xufSgpKTtcbmV4cG9ydHMuRmlsZVN5c3RlbUVudGl0eSA9IEZpbGVTeXN0ZW1FbnRpdHk7XG52YXIgRmlsZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZpbGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRmlsZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBGaWxlLmZyb21QYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZmlsZUluZm8gPSBnZXRGaWxlQWNjZXNzKCkuZ2V0RmlsZShwYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmaWxlSW5mbykge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlRmlsZShmaWxlSW5mbyk7XG4gICAgfTtcbiAgICBGaWxlLmV4aXN0cyA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHJldHVybiBnZXRGaWxlQWNjZXNzKCkuZmlsZUV4aXN0cyhwYXRoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlLnByb3RvdHlwZSwgXCJleHRlbnNpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9leHRlbnNpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGaWxlLnByb3RvdHlwZSwgXCJpc0xvY2tlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5fbG9ja2VkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRmlsZS5wcm90b3R5cGUsIFwic2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGdldEZpbGVBY2Nlc3MoKS5nZXRGaWxlU2l6ZSh0aGlzLnBhdGgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGaWxlLnByb3RvdHlwZS5yZWFkU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBY2Nlc3MoKTtcbiAgICAgICAgdGhpcy5fbG9ja2VkID0gdHJ1ZTtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgdGhhdC5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGVudCA9IGdldEZpbGVBY2Nlc3MoKS5yZWFkKHRoaXMucGF0aCwgbG9jYWxFcnJvcik7XG4gICAgICAgIHRoaXMuX2xvY2tlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICB9O1xuICAgIEZpbGUucHJvdG90eXBlLndyaXRlU3luYyA9IGZ1bmN0aW9uIChjb250ZW50LCBvbkVycm9yKSB7XG4gICAgICAgIHRoaXMuY2hlY2tBY2Nlc3MoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2tlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdGhhdF8xID0gdGhpcztcbiAgICAgICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhhdF8xLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBvbkVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZ2V0RmlsZUFjY2VzcygpLndyaXRlKHRoaXMucGF0aCwgY29udGVudCwgbG9jYWxFcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUucmVhZFRleHQgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IF90aGlzLnJlYWRUZXh0U3luYyhsb2NhbEVycm9yLCBlbmNvZGluZyk7XG4gICAgICAgICAgICBpZiAoIWhhc0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShjb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS5yZWFkVGV4dFN5bmMgPSBmdW5jdGlvbiAob25FcnJvciwgZW5jb2RpbmcpIHtcbiAgICAgICAgdGhpcy5jaGVja0FjY2VzcygpO1xuICAgICAgICB0aGlzLl9sb2NrZWQgPSB0cnVlO1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHZhciBsb2NhbEVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aGF0Ll9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChvbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHZhciBjb250ZW50ID0gZ2V0RmlsZUFjY2VzcygpLnJlYWRUZXh0KHRoaXMucGF0aCwgbG9jYWxFcnJvciwgZW5jb2RpbmcpO1xuICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfTtcbiAgICBGaWxlLnByb3RvdHlwZS53cml0ZVRleHQgPSBmdW5jdGlvbiAoY29udGVudCwgZW5jb2RpbmcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgIHZhciBoYXNFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGxvY2FsRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBoYXNFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBfdGhpcy53cml0ZVRleHRTeW5jKGNvbnRlbnQsIGxvY2FsRXJyb3IsIGVuY29kaW5nKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUud3JpdGVUZXh0U3luYyA9IGZ1bmN0aW9uIChjb250ZW50LCBvbkVycm9yLCBlbmNvZGluZykge1xuICAgICAgICB0aGlzLmNoZWNrQWNjZXNzKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHRoYXRfMiA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRoYXRfMi5fbG9ja2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgb25FcnJvcihlcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdldEZpbGVBY2Nlc3MoKS53cml0ZVRleHQodGhpcy5wYXRoLCBjb250ZW50LCBsb2NhbEVycm9yLCBlbmNvZGluZyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NrZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRmlsZS5wcm90b3R5cGUuY2hlY2tBY2Nlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgYWNjZXNzIGEgbG9ja2VkIGZpbGUuXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZpbGUucHJvdG90eXBlLCBcInJlYWRUZXh0U3luY1wiLCBudWxsKTtcbiAgICByZXR1cm4gRmlsZTtcbn0oRmlsZVN5c3RlbUVudGl0eSkpO1xuZXhwb3J0cy5GaWxlID0gRmlsZTtcbnZhciBGb2xkZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGb2xkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRm9sZGVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZvbGRlci5mcm9tUGF0aCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZvbGRlckluZm8gPSBnZXRGaWxlQWNjZXNzKCkuZ2V0Rm9sZGVyKHBhdGgsIG9uRXJyb3IpO1xuICAgICAgICBpZiAoIWZvbGRlckluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZvbGRlcihmb2xkZXJJbmZvKTtcbiAgICB9O1xuICAgIEZvbGRlci5leGlzdHMgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gZ2V0RmlsZUFjY2VzcygpLmZvbGRlckV4aXN0cyhwYXRoKTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgdmFyIHBhdGggPSBmaWxlQWNjZXNzLmpvaW5QYXRoKHRoaXMucGF0aCwgbmFtZSk7XG4gICAgICAgIGlmIChmaWxlQWNjZXNzLmZpbGVFeGlzdHMocGF0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaWxlQWNjZXNzLmZvbGRlckV4aXN0cyhwYXRoKTtcbiAgICB9O1xuICAgIEZvbGRlci5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB2YXIgaGFzRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaGFzRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgX3RoaXMuY2xlYXJTeW5jKG9uRXJyb3IpO1xuICAgICAgICAgICAgaWYgKCFoYXNFcnJvcikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmNsZWFyU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIGdldEZpbGVBY2Nlc3MoKS5lbXB0eUZvbGRlcih0aGlzLnBhdGgsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvbGRlci5wcm90b3R5cGUsIFwiaXNLbm93blwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lzS25vd247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZvbGRlci5wcm90b3R5cGUuZ2V0RmlsZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBmaWxlQWNjZXNzID0gZ2V0RmlsZUFjY2VzcygpO1xuICAgICAgICB2YXIgcGF0aCA9IGZpbGVBY2Nlc3Muam9pblBhdGgodGhpcy5wYXRoLCBuYW1lKTtcbiAgICAgICAgdmFyIG9uRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgZmlsZUluZm8gPSBmaWxlQWNjZXNzLmdldEZpbGUocGF0aCwgb25FcnJvcik7XG4gICAgICAgIGlmICghZmlsZUluZm8pIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZUZpbGUoZmlsZUluZm8pO1xuICAgIH07XG4gICAgRm9sZGVyLnByb3RvdHlwZS5nZXRGb2xkZXIgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgZmlsZUFjY2VzcyA9IGdldEZpbGVBY2Nlc3MoKTtcbiAgICAgICAgdmFyIHBhdGggPSBmaWxlQWNjZXNzLmpvaW5QYXRoKHRoaXMucGF0aCwgbmFtZSk7XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGZvbGRlckluZm8gPSBmaWxlQWNjZXNzLmdldEZvbGRlcihwYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmVhdGVGb2xkZXIoZm9sZGVySW5mbyk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmdldEVudGl0aWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdmFyIGhhc0Vycm9yID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgbG9jYWxFcnJvciA9IGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGhhc0Vycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBlbnRpdGllcyA9IF90aGlzLmdldEVudGl0aWVzU3luYyhsb2NhbEVycm9yKTtcbiAgICAgICAgICAgIGlmICghaGFzRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGVudGl0aWVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmdldEVudGl0aWVzU3luYyA9IGZ1bmN0aW9uIChvbkVycm9yKSB7XG4gICAgICAgIHZhciBmaWxlSW5mb3MgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0RW50aXRpZXModGhpcy5wYXRoLCBvbkVycm9yKTtcbiAgICAgICAgaWYgKCFmaWxlSW5mb3MpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbnRpdGllcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVJbmZvcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGZpbGVJbmZvc1tpXS5leHRlbnNpb24pIHtcbiAgICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGNyZWF0ZUZpbGUoZmlsZUluZm9zW2ldKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGNyZWF0ZUZvbGRlcihmaWxlSW5mb3NbaV0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW50aXRpZXM7XG4gICAgfTtcbiAgICBGb2xkZXIucHJvdG90eXBlLmVhY2hFbnRpdHkgPSBmdW5jdGlvbiAob25FbnRpdHkpIHtcbiAgICAgICAgaWYgKCFvbkVudGl0eSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBvblN1Y2Nlc3MgPSBmdW5jdGlvbiAoZmlsZUluZm8pIHtcbiAgICAgICAgICAgIHZhciBlbnRpdHk7XG4gICAgICAgICAgICBpZiAoZmlsZUluZm8uZXh0ZW5zaW9uKSB7XG4gICAgICAgICAgICAgICAgZW50aXR5ID0gY3JlYXRlRmlsZShmaWxlSW5mbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbnRpdHkgPSBjcmVhdGVGb2xkZXIoZmlsZUluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9uRW50aXR5KGVudGl0eSk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBvbkVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfTtcbiAgICAgICAgZ2V0RmlsZUFjY2VzcygpLmVhY2hFbnRpdHkodGhpcy5wYXRoLCBvblN1Y2Nlc3MsIG9uRXJyb3IpO1xuICAgIH07XG4gICAgcmV0dXJuIEZvbGRlcjtcbn0oRmlsZVN5c3RlbUVudGl0eSkpO1xuZXhwb3J0cy5Gb2xkZXIgPSBGb2xkZXI7XG52YXIga25vd25Gb2xkZXJzO1xuKGZ1bmN0aW9uIChrbm93bkZvbGRlcnMpIHtcbiAgICB2YXIgX2RvY3VtZW50cztcbiAgICB2YXIgX3RlbXA7XG4gICAgdmFyIF9hcHA7XG4gICAgZnVuY3Rpb24gZG9jdW1lbnRzKCkge1xuICAgICAgICBpZiAoIV9kb2N1bWVudHMpIHtcbiAgICAgICAgICAgIHZhciBwYXRoXzEgPSBnZXRGaWxlQWNjZXNzKCkuZ2V0RG9jdW1lbnRzRm9sZGVyUGF0aCgpO1xuICAgICAgICAgICAgX2RvY3VtZW50cyA9IG5ldyBGb2xkZXIoKTtcbiAgICAgICAgICAgIF9kb2N1bWVudHMuX3BhdGggPSBwYXRoXzE7XG4gICAgICAgICAgICBfZG9jdW1lbnRzLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2RvY3VtZW50cztcbiAgICB9XG4gICAga25vd25Gb2xkZXJzLmRvY3VtZW50cyA9IGRvY3VtZW50cztcbiAgICBmdW5jdGlvbiB0ZW1wKCkge1xuICAgICAgICBpZiAoIV90ZW1wKSB7XG4gICAgICAgICAgICB2YXIgcGF0aF8yID0gZ2V0RmlsZUFjY2VzcygpLmdldFRlbXBGb2xkZXJQYXRoKCk7XG4gICAgICAgICAgICBfdGVtcCA9IG5ldyBGb2xkZXIoKTtcbiAgICAgICAgICAgIF90ZW1wLl9wYXRoID0gcGF0aF8yO1xuICAgICAgICAgICAgX3RlbXAuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGVtcDtcbiAgICB9XG4gICAga25vd25Gb2xkZXJzLnRlbXAgPSB0ZW1wO1xuICAgIGZ1bmN0aW9uIGN1cnJlbnRBcHAoKSB7XG4gICAgICAgIGlmICghX2FwcCkge1xuICAgICAgICAgICAgdmFyIHBhdGhfMyA9IGdldEZpbGVBY2Nlc3MoKS5nZXRDdXJyZW50QXBwUGF0aCgpO1xuICAgICAgICAgICAgX2FwcCA9IG5ldyBGb2xkZXIoKTtcbiAgICAgICAgICAgIF9hcHAuX3BhdGggPSBwYXRoXzM7XG4gICAgICAgICAgICBfYXBwLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gX2FwcDtcbiAgICB9XG4gICAga25vd25Gb2xkZXJzLmN1cnJlbnRBcHAgPSBjdXJyZW50QXBwO1xuICAgIHZhciBpb3M7XG4gICAgKGZ1bmN0aW9uIChpb3MpIHtcbiAgICAgICAgZnVuY3Rpb24gX2NoZWNrUGxhdGZvcm0oa25vd25Gb2xkZXJOYW1lKSB7XG4gICAgICAgICAgICBlbnN1cmVQbGF0Zm9ybSgpO1xuICAgICAgICAgICAgaWYgKCFwbGF0Zm9ybS5pc0lPUykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBcXFwiXCIgKyBrbm93bkZvbGRlck5hbWUgKyBcIlxcXCIga25vd24gZm9sZGVyIGlzIGF2YWlsYWJsZSBvbiBpT1Mgb25seSFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9saWJyYXJ5O1xuICAgICAgICBmdW5jdGlvbiBsaWJyYXJ5KCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJsaWJyYXJ5XCIpO1xuICAgICAgICAgICAgaWYgKCFfbGlicmFyeSkge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oNSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfbGlicmFyeSA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9saWJyYXJ5Ll9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9saWJyYXJ5Ll9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2xpYnJhcnk7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLmxpYnJhcnkgPSBsaWJyYXJ5O1xuICAgICAgICB2YXIgX2RldmVsb3BlcjtcbiAgICAgICAgZnVuY3Rpb24gZGV2ZWxvcGVyKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJkZXZlbG9wZXJcIik7XG4gICAgICAgICAgICBpZiAoIV9kZXZlbG9wZXIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDYpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX2RldmVsb3BlciA9IGV4aXN0aW5nRm9sZGVySW5mby5mb2xkZXI7XG4gICAgICAgICAgICAgICAgICAgIF9kZXZlbG9wZXIuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX2RldmVsb3Blci5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9kZXZlbG9wZXI7XG4gICAgICAgIH1cbiAgICAgICAgaW9zLmRldmVsb3BlciA9IGRldmVsb3BlcjtcbiAgICAgICAgdmFyIF9kZXNrdG9wO1xuICAgICAgICBmdW5jdGlvbiBkZXNrdG9wKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJkZXNrdG9wXCIpO1xuICAgICAgICAgICAgaWYgKCFfZGVza3RvcCkge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTIpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX2Rlc2t0b3AgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfZGVza3RvcC5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfZGVza3RvcC5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9kZXNrdG9wO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5kZXNrdG9wID0gZGVza3RvcDtcbiAgICAgICAgdmFyIF9kb3dubG9hZHM7XG4gICAgICAgIGZ1bmN0aW9uIGRvd25sb2FkcygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwiZG93bmxvYWRzXCIpO1xuICAgICAgICAgICAgaWYgKCFfZG93bmxvYWRzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxNSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfZG93bmxvYWRzID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX2Rvd25sb2Fkcy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfZG93bmxvYWRzLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX2Rvd25sb2FkcztcbiAgICAgICAgfVxuICAgICAgICBpb3MuZG93bmxvYWRzID0gZG93bmxvYWRzO1xuICAgICAgICB2YXIgX21vdmllcztcbiAgICAgICAgZnVuY3Rpb24gbW92aWVzKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJtb3ZpZXNcIik7XG4gICAgICAgICAgICBpZiAoIV9tb3ZpZXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZXhpc3RpbmdGb2xkZXJJbmZvID0gZ2V0RXhpc3RpbmdGb2xkZXJJbmZvKDE3KTtcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdGb2xkZXJJbmZvKSB7XG4gICAgICAgICAgICAgICAgICAgIF9tb3ZpZXMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfbW92aWVzLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9tb3ZpZXMuX2lzS25vd24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBfbW92aWVzO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5tb3ZpZXMgPSBtb3ZpZXM7XG4gICAgICAgIHZhciBfbXVzaWM7XG4gICAgICAgIGZ1bmN0aW9uIG11c2ljKCkge1xuICAgICAgICAgICAgX2NoZWNrUGxhdGZvcm0oXCJtdXNpY1wiKTtcbiAgICAgICAgICAgIGlmICghX211c2ljKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygxOCk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfbXVzaWMgPSBleGlzdGluZ0ZvbGRlckluZm8uZm9sZGVyO1xuICAgICAgICAgICAgICAgICAgICBfbXVzaWMuX3BhdGggPSBleGlzdGluZ0ZvbGRlckluZm8ucGF0aDtcbiAgICAgICAgICAgICAgICAgICAgX211c2ljLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX211c2ljO1xuICAgICAgICB9XG4gICAgICAgIGlvcy5tdXNpYyA9IG11c2ljO1xuICAgICAgICB2YXIgX3BpY3R1cmVzO1xuICAgICAgICBmdW5jdGlvbiBwaWN0dXJlcygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwicGljdHVyZXNcIik7XG4gICAgICAgICAgICBpZiAoIV9waWN0dXJlcykge1xuICAgICAgICAgICAgICAgIHZhciBleGlzdGluZ0ZvbGRlckluZm8gPSBnZXRFeGlzdGluZ0ZvbGRlckluZm8oMTkpO1xuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0ZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICAgICAgX3BpY3R1cmVzID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX3BpY3R1cmVzLl9wYXRoID0gZXhpc3RpbmdGb2xkZXJJbmZvLnBhdGg7XG4gICAgICAgICAgICAgICAgICAgIF9waWN0dXJlcy5faXNLbm93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIF9waWN0dXJlcztcbiAgICAgICAgfVxuICAgICAgICBpb3MucGljdHVyZXMgPSBwaWN0dXJlcztcbiAgICAgICAgdmFyIF9zaGFyZWRQdWJsaWM7XG4gICAgICAgIGZ1bmN0aW9uIHNoYXJlZFB1YmxpYygpIHtcbiAgICAgICAgICAgIF9jaGVja1BsYXRmb3JtKFwic2hhcmVkUHVibGljXCIpO1xuICAgICAgICAgICAgaWYgKCFfc2hhcmVkUHVibGljKSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4aXN0aW5nRm9sZGVySW5mbyA9IGdldEV4aXN0aW5nRm9sZGVySW5mbygyMSk7XG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nRm9sZGVySW5mbykge1xuICAgICAgICAgICAgICAgICAgICBfc2hhcmVkUHVibGljID0gZXhpc3RpbmdGb2xkZXJJbmZvLmZvbGRlcjtcbiAgICAgICAgICAgICAgICAgICAgX3NoYXJlZFB1YmxpYy5fcGF0aCA9IGV4aXN0aW5nRm9sZGVySW5mby5wYXRoO1xuICAgICAgICAgICAgICAgICAgICBfc2hhcmVkUHVibGljLl9pc0tub3duID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gX3NoYXJlZFB1YmxpYztcbiAgICAgICAgfVxuICAgICAgICBpb3Muc2hhcmVkUHVibGljID0gc2hhcmVkUHVibGljO1xuICAgICAgICBmdW5jdGlvbiBnZXRFeGlzdGluZ0ZvbGRlckluZm8ocGF0aERpcmVjdG9yeSkge1xuICAgICAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgICAgICB2YXIgZm9sZGVyUGF0aCA9IGZpbGVBY2Nlc3MuZ2V0S25vd25QYXRoKHBhdGhEaXJlY3RvcnkpO1xuICAgICAgICAgICAgdmFyIGZvbGRlckluZm8gPSBmaWxlQWNjZXNzLmdldEV4aXN0aW5nRm9sZGVyKGZvbGRlclBhdGgpO1xuICAgICAgICAgICAgaWYgKGZvbGRlckluZm8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBmb2xkZXI6IGNyZWF0ZUZvbGRlcihmb2xkZXJJbmZvKSxcbiAgICAgICAgICAgICAgICAgICAgcGF0aDogZm9sZGVyUGF0aFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSkoaW9zID0ga25vd25Gb2xkZXJzLmlvcyB8fCAoa25vd25Gb2xkZXJzLmlvcyA9IHt9KSk7XG59KShrbm93bkZvbGRlcnMgPSBleHBvcnRzLmtub3duRm9sZGVycyB8fCAoZXhwb3J0cy5rbm93bkZvbGRlcnMgPSB7fSkpO1xudmFyIHBhdGg7XG4oZnVuY3Rpb24gKHBhdGhfNCkge1xuICAgIGZ1bmN0aW9uIG5vcm1hbGl6ZShwYXRoKSB7XG4gICAgICAgIHJldHVybiBnZXRGaWxlQWNjZXNzKCkubm9ybWFsaXplUGF0aChwYXRoKTtcbiAgICB9XG4gICAgcGF0aF80Lm5vcm1hbGl6ZSA9IG5vcm1hbGl6ZTtcbiAgICBmdW5jdGlvbiBqb2luKCkge1xuICAgICAgICB2YXIgcGF0aHMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHBhdGhzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZpbGVBY2Nlc3MgPSBnZXRGaWxlQWNjZXNzKCk7XG4gICAgICAgIHJldHVybiBmaWxlQWNjZXNzLmpvaW5QYXRocyhwYXRocyk7XG4gICAgfVxuICAgIHBhdGhfNC5qb2luID0gam9pbjtcbiAgICBwYXRoXzQuc2VwYXJhdG9yID0gZ2V0RmlsZUFjY2VzcygpLmdldFBhdGhTZXBhcmF0b3IoKTtcbn0pKHBhdGggPSBleHBvcnRzLnBhdGggfHwgKGV4cG9ydHMucGF0aCA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1maWxlLXN5c3RlbS5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5yZXF1aXJlKFwiLi90cy1oZWxwZXJzXCIpO1xucmVxdWlyZShcIi4vcmVnaXN0ZXItbW9kdWxlLWhlbHBlcnNcIik7XG5nbG9iYWwubW9kdWxlTWVyZ2UgPSBmdW5jdGlvbiAoc291cmNlRXhwb3J0cywgZGVzdEV4cG9ydHMpIHtcbiAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlRXhwb3J0cykge1xuICAgICAgICBkZXN0RXhwb3J0c1trZXldID0gc291cmNlRXhwb3J0c1trZXldO1xuICAgIH1cbn07XG5nbG9iYWwuem9uZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgIGlmIChnbG9iYWwuem9uZSkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLnpvbmUuYmluZChjYWxsYmFjayk7XG4gICAgfVxuICAgIGlmIChnbG9iYWwuWm9uZSkge1xuICAgICAgICByZXR1cm4gZ2xvYmFsLlpvbmUuY3VycmVudC53cmFwKGNhbGxiYWNrKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjaztcbiAgICB9XG59O1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwidGltZXJcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInRpbWVyXCIpOyB9KTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZShcInVpL2RpYWxvZ3NcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcInVpL2RpYWxvZ3NcIik7IH0pO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwieGhyXCIsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIHJlcXVpcmUoXCJ4aHJcIik7IH0pO1xuZ2xvYmFsLnJlZ2lzdGVyTW9kdWxlKFwiZmV0Y2hcIiwgZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVxdWlyZShcImZldGNoXCIpOyB9KTtcbmdsb2JhbC5TeXN0ZW0gPSB7XG4gICAgaW1wb3J0OiBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGdsb2JhbC5yZXF1aXJlKHBhdGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuZnVuY3Rpb24gcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQobmFtZSwgbW9kdWxlKSB7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbCwgbmFtZSwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBtID0gZ2xvYmFsLmxvYWRNb2R1bGUobW9kdWxlKTtcbiAgICAgICAgICAgIHZhciByZXNvbHZlZFZhbHVlID0gbVtuYW1lXTtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWwsIG5hbWUsIHsgdmFsdWU6IHJlc29sdmVkVmFsdWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRWYWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG59XG52YXIgc25hcHNob3RHbG9iYWxzO1xuZnVuY3Rpb24gaW5zdGFsbCgpIHtcbiAgICBpZiAoZ2xvYmFsLl9fc25hcHNob3QgfHwgZ2xvYmFsLl9fc25hcHNob3RFbmFibGVkKSB7XG4gICAgICAgIGlmICghc25hcHNob3RHbG9iYWxzKSB7XG4gICAgICAgICAgICB2YXIgdGltZXIgPSByZXF1aXJlKFwidGltZXJcIik7XG4gICAgICAgICAgICB2YXIgZGlhbG9ncyA9IHJlcXVpcmUoXCJ1aS9kaWFsb2dzXCIpO1xuICAgICAgICAgICAgdmFyIHhociA9IHJlcXVpcmUoXCJ4aHJcIik7XG4gICAgICAgICAgICB2YXIgZmV0Y2hfMSA9IHJlcXVpcmUoXCJmZXRjaFwiKTtcbiAgICAgICAgICAgIHNuYXBzaG90R2xvYmFscyA9IHNuYXBzaG90R2xvYmFscyB8fCB7XG4gICAgICAgICAgICAgICAgc2V0VGltZW91dDogdGltZXIuc2V0VGltZW91dCxcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQ6IHRpbWVyLmNsZWFyVGltZW91dCxcbiAgICAgICAgICAgICAgICBzZXRJbnRlcnZhbDogdGltZXIuc2V0SW50ZXJ2YWwsXG4gICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbDogdGltZXIuY2xlYXJJbnRlcnZhbCxcbiAgICAgICAgICAgICAgICBhbGVydDogZGlhbG9ncy5hbGVydCxcbiAgICAgICAgICAgICAgICBjb25maXJtOiBkaWFsb2dzLmNvbmZpcm0sXG4gICAgICAgICAgICAgICAgcHJvbXB0OiBkaWFsb2dzLnByb21wdCxcbiAgICAgICAgICAgICAgICBsb2dpbjogZGlhbG9ncy5sb2dpbixcbiAgICAgICAgICAgICAgICBhY3Rpb246IGRpYWxvZ3MuYWN0aW9uLFxuICAgICAgICAgICAgICAgIFhNTEh0dHBSZXF1ZXN0OiB4aHIuWE1MSHR0cFJlcXVlc3QsXG4gICAgICAgICAgICAgICAgRm9ybURhdGE6IHhoci5Gb3JtRGF0YSxcbiAgICAgICAgICAgICAgICBmZXRjaDogZmV0Y2hfMS5mZXRjaCxcbiAgICAgICAgICAgICAgICBIZWFkZXJzOiBmZXRjaF8xLkhlYWRlcnMsXG4gICAgICAgICAgICAgICAgUmVxdWVzdDogZmV0Y2hfMS5SZXF1ZXN0LFxuICAgICAgICAgICAgICAgIFJlc3BvbnNlOiBmZXRjaF8xLlJlc3BvbnNlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29uc29sZU1vZHVsZSA9IHJlcXVpcmUoXCJjb25zb2xlXCIpLkNvbnNvbGU7XG4gICAgICAgIGdsb2JhbC5jb25zb2xlID0gZ2xvYmFsLmNvbnNvbGUgfHwgbmV3IGNvbnNvbGVNb2R1bGUoKTtcbiAgICAgICAgT2JqZWN0LmFzc2lnbihnbG9iYWwsIHNuYXBzaG90R2xvYmFscyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChcInNldFRpbWVvdXRcIiwgXCJ0aW1lclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJjbGVhclRpbWVvdXRcIiwgXCJ0aW1lclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJzZXRJbnRlcnZhbFwiLCBcInRpbWVyXCIpO1xuICAgICAgICByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChcImNsZWFySW50ZXJ2YWxcIiwgXCJ0aW1lclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJhbGVydFwiLCBcInVpL2RpYWxvZ3NcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwiY29uZmlybVwiLCBcInVpL2RpYWxvZ3NcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwicHJvbXB0XCIsIFwidWkvZGlhbG9nc1wiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJsb2dpblwiLCBcInVpL2RpYWxvZ3NcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwiYWN0aW9uXCIsIFwidWkvZGlhbG9nc1wiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJYTUxIdHRwUmVxdWVzdFwiLCBcInhoclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJGb3JtRGF0YVwiLCBcInhoclwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJmZXRjaFwiLCBcImZldGNoXCIpO1xuICAgICAgICByZWdpc3Rlck9uR2xvYmFsQ29udGV4dChcIkhlYWRlcnNcIiwgXCJmZXRjaFwiKTtcbiAgICAgICAgcmVnaXN0ZXJPbkdsb2JhbENvbnRleHQoXCJSZXF1ZXN0XCIsIFwiZmV0Y2hcIik7XG4gICAgICAgIHJlZ2lzdGVyT25HbG9iYWxDb250ZXh0KFwiUmVzcG9uc2VcIiwgXCJmZXRjaFwiKTtcbiAgICB9XG59XG5leHBvcnRzLmluc3RhbGwgPSBpbnN0YWxsO1xuaW5zdGFsbCgpO1xuZnVuY3Rpb24gRGVwcmVjYXRlZCh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZF8xID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleS50b1N0cmluZygpICsgXCIgaXMgZGVwcmVjYXRlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBvcmlnaW5hbE1ldGhvZF8xLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCh0YXJnZXQgJiYgdGFyZ2V0Lm5hbWUgfHwgdGFyZ2V0KSArIFwiIGlzIGRlcHJlY2F0ZWRcIik7XG4gICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgfVxufVxuZXhwb3J0cy5EZXByZWNhdGVkID0gRGVwcmVjYXRlZDtcbmdsb2JhbC5EZXByZWNhdGVkID0gRGVwcmVjYXRlZDtcbmZ1bmN0aW9uIEV4cGVyaW1lbnRhbCh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbE1ldGhvZF8yID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGtleS50b1N0cmluZygpICsgXCIgaXMgZXhwZXJpbWVudGFsXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG9yaWdpbmFsTWV0aG9kXzIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkZXNjcmlwdG9yO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coKHRhcmdldCAmJiB0YXJnZXQubmFtZSB8fCB0YXJnZXQpICsgXCIgaXMgZXhwZXJpbWVudGFsXCIpO1xuICAgICAgICByZXR1cm4gdGFyZ2V0O1xuICAgIH1cbn1cbmV4cG9ydHMuRXhwZXJpbWVudGFsID0gRXhwZXJpbWVudGFsO1xuZ2xvYmFsLkV4cGVyaW1lbnRhbCA9IEV4cGVyaW1lbnRhbDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdsb2JhbHMuanMubWFwIiwidmFyIG1vZHVsZXMgPSBuZXcgTWFwKCk7XG52YXIgbW9kdWxlc0xvYWRlZEZvclVJID0gbmV3IFNldCgpO1xudmFyIGRlZmF1bHRFeHRlbnNpb25NYXAgPSB7XG4gICAgXCIuanNcIjogXCIuanNcIixcbiAgICBcIi50c1wiOiBcIi5qc1wiLFxuICAgIFwiLmNzc1wiOiBcIi5jc3NcIixcbiAgICBcIi5zY3NzXCI6IFwiLmNzc1wiLFxuICAgIFwiLmxlc3NcIjogXCIuY3NzXCIsXG4gICAgXCIuc2Fzc1wiOiBcIi5jc3NcIixcbiAgICBcIi54bWxcIjogXCIueG1sXCJcbn07XG5nbG9iYWwubW9kdWxlUmVzb2x2ZXJzID0gW2dsb2JhbC5yZXF1aXJlXTtcbmdsb2JhbC5yZWdpc3Rlck1vZHVsZSA9IGZ1bmN0aW9uIChuYW1lLCBsb2FkZXIpIHtcbiAgICBtb2R1bGVzLnNldChuYW1lLCB7IGxvYWRlcjogbG9hZGVyLCBtb2R1bGVJZDogbmFtZSB9KTtcbn07XG5nbG9iYWwuX3VucmVnaXN0ZXJNb2R1bGUgPSBmdW5jdGlvbiBfdW5yZWdpc3Rlck1vZHVsZShuYW1lKSB7XG4gICAgbW9kdWxlcy5kZWxldGUobmFtZSk7XG59O1xuZ2xvYmFsLl9pc01vZHVsZUxvYWRlZEZvclVJID0gZnVuY3Rpb24gX2lzTW9kdWxlTG9hZGVkRm9yVUkobW9kdWxlTmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVzTG9hZGVkRm9yVUkuaGFzKG1vZHVsZU5hbWUpO1xufTtcbmdsb2JhbC5yZWdpc3RlcldlYnBhY2tNb2R1bGVzID0gZnVuY3Rpb24gcmVnaXN0ZXJXZWJwYWNrTW9kdWxlcyhjb250ZXh0LCBleHRlbnNpb25NYXApIHtcbiAgICBpZiAoZXh0ZW5zaW9uTWFwID09PSB2b2lkIDApIHsgZXh0ZW5zaW9uTWFwID0ge307IH1cbiAgICBjb250ZXh0LmtleXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGVJZCkge1xuICAgICAgICB2YXIgZXh0RG90SW5kZXggPSBtb2R1bGVJZC5sYXN0SW5kZXhPZihcIi5cIik7XG4gICAgICAgIHZhciBiYXNlID0gbW9kdWxlSWQuc3Vic3RyKDAsIGV4dERvdEluZGV4KTtcbiAgICAgICAgdmFyIG9yaWdpbmFsRXh0ID0gbW9kdWxlSWQuc3Vic3RyKGV4dERvdEluZGV4KTtcbiAgICAgICAgdmFyIHJlZ2lzdGVyRXh0ID0gZXh0ZW5zaW9uTWFwW29yaWdpbmFsRXh0XSB8fCBkZWZhdWx0RXh0ZW5zaW9uTWFwW29yaWdpbmFsRXh0XSB8fCBvcmlnaW5hbEV4dDtcbiAgICAgICAgdmFyIGlzU291cmNlRmlsZSA9IG9yaWdpbmFsRXh0ICE9PSByZWdpc3RlckV4dDtcbiAgICAgICAgdmFyIHJlZ2lzdGVyTmFtZSA9IGJhc2UgKyByZWdpc3RlckV4dDtcbiAgICAgICAgdmFyIHJlZ2lzdGVyV2l0aE5hbWUgPSBmdW5jdGlvbiAobmlja05hbWUpIHtcbiAgICAgICAgICAgIG1vZHVsZXMuc2V0KG5pY2tOYW1lLCB7XG4gICAgICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZUlkLFxuICAgICAgICAgICAgICAgIGxvYWRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dChtb2R1bGVJZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChyZWdpc3Rlck5hbWUuc3RhcnRzV2l0aChcIi4vXCIpICYmIHJlZ2lzdGVyTmFtZS5lbmRzV2l0aChcIi5qc1wiKSkge1xuICAgICAgICAgICAgdmFyIGpzTmlja05hbWVzID0gW1xuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiwgcmVnaXN0ZXJOYW1lLmxlbmd0aCAtIDUpLFxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMCwgcmVnaXN0ZXJOYW1lLmxlbmd0aCAtIDMpLFxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAganNOaWNrTmFtZXMuZm9yRWFjaChmdW5jdGlvbiAoanNOaWNrTmFtZSkge1xuICAgICAgICAgICAgICAgIGlmIChpc1NvdXJjZUZpbGUgfHwgIWdsb2JhbC5tb2R1bGVFeGlzdHMoanNOaWNrTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVnaXN0ZXJXaXRoTmFtZShqc05pY2tOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChyZWdpc3Rlck5hbWUuc3RhcnRzV2l0aChcIi4vXCIpKSB7XG4gICAgICAgICAgICB2YXIgbW9kdWxlTmlja05hbWVzID0gW1xuICAgICAgICAgICAgICAgIHJlZ2lzdGVyTmFtZS5zdWJzdHIoMiksXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgbW9kdWxlTmlja05hbWVzLmZvckVhY2goZnVuY3Rpb24gKG1vZHVsZU5pY2tOYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFnbG9iYWwubW9kdWxlRXhpc3RzKG1vZHVsZU5pY2tOYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICByZWdpc3RlcldpdGhOYW1lKG1vZHVsZU5pY2tOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNTb3VyY2VGaWxlIHx8ICFnbG9iYWwubW9kdWxlRXhpc3RzKHJlZ2lzdGVyTmFtZSkpIHtcbiAgICAgICAgICAgIHJlZ2lzdGVyV2l0aE5hbWUocmVnaXN0ZXJOYW1lKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcbmdsb2JhbC5tb2R1bGVFeGlzdHMgPSBmdW5jdGlvbiBtb2R1bGVFeGlzdHMobmFtZSkge1xuICAgIHJldHVybiBtb2R1bGVzLmhhcyhuYW1lKTtcbn07XG5nbG9iYWwubG9hZE1vZHVsZSA9IGZ1bmN0aW9uIGxvYWRNb2R1bGUobmFtZSwgaXNVSU1vZHVsZSkge1xuICAgIGlmIChpc1VJTW9kdWxlID09PSB2b2lkIDApIHsgaXNVSU1vZHVsZSA9IGZhbHNlOyB9XG4gICAgdmFyIG1vZHVsZUluZm8gPSBtb2R1bGVzLmdldChuYW1lKTtcbiAgICBpZiAobW9kdWxlSW5mbykge1xuICAgICAgICBpZiAoaXNVSU1vZHVsZSkge1xuICAgICAgICAgICAgbW9kdWxlc0xvYWRlZEZvclVJLmFkZChtb2R1bGVJbmZvLm1vZHVsZUlkKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gbW9kdWxlSW5mby5sb2FkZXIobmFtZSk7XG4gICAgICAgIGlmIChyZXN1bHQuZW5hYmxlQXV0b0FjY2VwdCkge1xuICAgICAgICAgICAgcmVzdWx0LmVuYWJsZUF1dG9BY2NlcHQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChyZXNvbHZlcikge1xuICAgICAgICB2YXIgcmVzdWx0ID0gcmVzb2x2ZXIobmFtZSk7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIG1vZHVsZXMuc2V0KG5hbWUsIHsgbW9kdWxlSWQ6IG5hbWUsIGxvYWRlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gcmVzdWx0OyB9IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IHJlc3VsdCB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gZ2xvYmFsLm1vZHVsZVJlc29sdmVyczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHJlc29sdmVyID0gX2FbX2ldO1xuICAgICAgICB2YXIgc3RhdGVfMSA9IF9sb29wXzEocmVzb2x2ZXIpO1xuICAgICAgICBpZiAodHlwZW9mIHN0YXRlXzEgPT09IFwib2JqZWN0XCIpXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVfMS52YWx1ZTtcbiAgICB9XG59O1xuZ2xvYmFsLmdldFJlZ2lzdGVyZWRNb2R1bGVzID0gZnVuY3Rpb24gZ2V0UmVnaXN0ZXJlZE1vZHVsZXMoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20obW9kdWxlcy5rZXlzKCkpO1xufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXJlZ2lzdGVyLW1vZHVsZS1oZWxwZXJzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmlmICghZ2xvYmFsLl9fZXh0ZW5kcykge1xuICAgIGdsb2JhbC5fX2V4dGVuZHMgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBmb3IgKHZhciBwIGluIGIpIHtcbiAgICAgICAgICAgIGlmIChiLmhhc093blByb3BlcnR5KHApKSB7XG4gICAgICAgICAgICAgICAgZFtwXSA9IGJbcF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufVxudmFyIHRzbGliID0gcmVxdWlyZShcInRzbGliXCIpO1xuZm9yICh2YXIgX2kgPSAwLCBfYSA9IE9iamVjdC5rZXlzKHRzbGliKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICB2YXIgZm5OYW1lID0gX2FbX2ldO1xuICAgIGlmICh0eXBlb2YgdHNsaWJbZm5OYW1lXSAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZm5OYW1lIGluIGdsb2JhbCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgZ2xvYmFsW2ZuTmFtZV0gPSB0c2xpYltmbk5hbWVdO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHMtaGVscGVycy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5mdW5jdGlvbiBnZXRGaWxlbmFtZUZyb21VcmwodXJsKSB7XG4gICAgdmFyIGZzID0gcmVxdWlyZShcImZpbGUtc3lzdGVtXCIpO1xuICAgIHZhciBzbGFzaFBvcyA9IHVybC5sYXN0SW5kZXhPZihcIi9cIikgKyAxO1xuICAgIHZhciBxdWVzdGlvbk1hcmtQb3MgPSB1cmwubGFzdEluZGV4T2YoXCI/XCIpO1xuICAgIHZhciBhY3R1YWxGaWxlTmFtZTtcbiAgICBpZiAocXVlc3Rpb25NYXJrUG9zICE9PSAtMSkge1xuICAgICAgICBhY3R1YWxGaWxlTmFtZSA9IHVybC5zdWJzdHJpbmcoc2xhc2hQb3MsIHF1ZXN0aW9uTWFya1Bvcyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhY3R1YWxGaWxlTmFtZSA9IHVybC5zdWJzdHJpbmcoc2xhc2hQb3MpO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0ID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5kb2N1bWVudHMoKS5wYXRoLCBhY3R1YWxGaWxlTmFtZSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0RmlsZW5hbWVGcm9tVXJsID0gZ2V0RmlsZW5hbWVGcm9tVXJsO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1yZXF1ZXN0LWNvbW1vbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgZG9tYWluRGVidWdnZXIgPSByZXF1aXJlKFwiLi4vLi4vZGVidWdnZXIvZGVidWdnZXJcIik7XG52YXIgaHR0cF9yZXF1ZXN0X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0LWNvbW1vblwiKTtcbnZhciBIdHRwUmVzcG9uc2VFbmNvZGluZztcbihmdW5jdGlvbiAoSHR0cFJlc3BvbnNlRW5jb2RpbmcpIHtcbiAgICBIdHRwUmVzcG9uc2VFbmNvZGluZ1tIdHRwUmVzcG9uc2VFbmNvZGluZ1tcIlVURjhcIl0gPSAwXSA9IFwiVVRGOFwiO1xuICAgIEh0dHBSZXNwb25zZUVuY29kaW5nW0h0dHBSZXNwb25zZUVuY29kaW5nW1wiR0JLXCJdID0gMV0gPSBcIkdCS1wiO1xufSkoSHR0cFJlc3BvbnNlRW5jb2RpbmcgPSBleHBvcnRzLkh0dHBSZXNwb25zZUVuY29kaW5nIHx8IChleHBvcnRzLkh0dHBSZXNwb25zZUVuY29kaW5nID0ge30pKTtcbnZhciBjdXJyZW50RGV2aWNlID0gVUlEZXZpY2UuY3VycmVudERldmljZTtcbnZhciBkZXZpY2UgPSBjdXJyZW50RGV2aWNlLnVzZXJJbnRlcmZhY2VJZGlvbSA9PT0gMCA/IFwiUGhvbmVcIiA6IFwiUGFkXCI7XG52YXIgb3NWZXJzaW9uID0gY3VycmVudERldmljZS5zeXN0ZW1WZXJzaW9uO1xudmFyIEdFVCA9IFwiR0VUXCI7XG52YXIgVVNFUl9BR0VOVF9IRUFERVIgPSBcIlVzZXItQWdlbnRcIjtcbnZhciBVU0VSX0FHRU5UID0gXCJNb3ppbGxhLzUuMCAoaVwiICsgZGV2aWNlICsgXCI7IENQVSBPUyBcIiArIG9zVmVyc2lvbi5yZXBsYWNlKFwiLlwiLCBcIl9cIikgKyBcIiBsaWtlIE1hYyBPUyBYKSBBcHBsZVdlYktpdC81MzYuMjYgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uL1wiICsgb3NWZXJzaW9uICsgXCIgTW9iaWxlLzEwQTUzNTVkIFNhZmFyaS84NTM2LjI1XCI7XG52YXIgc2Vzc2lvbkNvbmZpZyA9IE5TVVJMU2Vzc2lvbkNvbmZpZ3VyYXRpb24uZGVmYXVsdFNlc3Npb25Db25maWd1cmF0aW9uO1xudmFyIHF1ZXVlID0gTlNPcGVyYXRpb25RdWV1ZS5tYWluUXVldWU7XG5mdW5jdGlvbiBwYXJzZUpTT04oc291cmNlKSB7XG4gICAgdmFyIHNyYyA9IHNvdXJjZS50cmltKCk7XG4gICAgaWYgKHNyYy5sYXN0SW5kZXhPZihcIilcIikgPT09IHNyYy5sZW5ndGggLSAxKSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHNyYy5zdWJzdHJpbmcoc3JjLmluZGV4T2YoXCIoXCIpICsgMSwgc3JjLmxhc3RJbmRleE9mKFwiKVwiKSkpO1xuICAgIH1cbiAgICByZXR1cm4gSlNPTi5wYXJzZShzcmMpO1xufVxudmFyIE5TVVJMU2Vzc2lvblRhc2tEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhOU1VSTFNlc3Npb25UYXNrRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE5TVVJMU2Vzc2lvblRhc2tEZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgTlNVUkxTZXNzaW9uVGFza0RlbGVnYXRlSW1wbC5wcm90b3R5cGUuVVJMU2Vzc2lvblRhc2tXaWxsUGVyZm9ybUhUVFBSZWRpcmVjdGlvbk5ld1JlcXVlc3RDb21wbGV0aW9uSGFuZGxlciA9IGZ1bmN0aW9uIChzZXNzaW9uLCB0YXNrLCByZXNwb25zZSwgcmVxdWVzdCwgY29tcGxldGlvbkhhbmRsZXIpIHtcbiAgICAgICAgY29tcGxldGlvbkhhbmRsZXIobnVsbCk7XG4gICAgfTtcbiAgICBOU1VSTFNlc3Npb25UYXNrRGVsZWdhdGVJbXBsLk9iakNQcm90b2NvbHMgPSBbTlNVUkxTZXNzaW9uVGFza0RlbGVnYXRlXTtcbiAgICByZXR1cm4gTlNVUkxTZXNzaW9uVGFza0RlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbnZhciBzZXNzaW9uVGFza0RlbGVnYXRlSW5zdGFuY2UgPSBOU1VSTFNlc3Npb25UYXNrRGVsZWdhdGVJbXBsLm5ldygpO1xudmFyIGRlZmF1bHRTZXNzaW9uO1xuZnVuY3Rpb24gZW5zdXJlRGVmYXVsdFNlc3Npb24oKSB7XG4gICAgaWYgKCFkZWZhdWx0U2Vzc2lvbikge1xuICAgICAgICBkZWZhdWx0U2Vzc2lvbiA9IE5TVVJMU2Vzc2lvbi5zZXNzaW9uV2l0aENvbmZpZ3VyYXRpb25EZWxlZ2F0ZURlbGVnYXRlUXVldWUoc2Vzc2lvbkNvbmZpZywgbnVsbCwgcXVldWUpO1xuICAgIH1cbn1cbnZhciBzZXNzaW9uTm90Rm9sbG93aW5nUmVkaXJlY3RzO1xuZnVuY3Rpb24gZW5zdXJlU2Vzc2lvbk5vdEZvbGxvd2luZ1JlZGlyZWN0cygpIHtcbiAgICBpZiAoIXNlc3Npb25Ob3RGb2xsb3dpbmdSZWRpcmVjdHMpIHtcbiAgICAgICAgc2Vzc2lvbk5vdEZvbGxvd2luZ1JlZGlyZWN0cyA9IE5TVVJMU2Vzc2lvbi5zZXNzaW9uV2l0aENvbmZpZ3VyYXRpb25EZWxlZ2F0ZURlbGVnYXRlUXVldWUoc2Vzc2lvbkNvbmZpZywgc2Vzc2lvblRhc2tEZWxlZ2F0ZUluc3RhbmNlLCBxdWV1ZSk7XG4gICAgfVxufVxudmFyIGltYWdlU291cmNlO1xuZnVuY3Rpb24gZW5zdXJlSW1hZ2VTb3VyY2UoKSB7XG4gICAgaWYgKCFpbWFnZVNvdXJjZSkge1xuICAgICAgICBpbWFnZVNvdXJjZSA9IHJlcXVpcmUoXCJpbWFnZS1zb3VyY2VcIik7XG4gICAgfVxufVxudmFyIGZzO1xuZnVuY3Rpb24gZW5zdXJlRmlsZVN5c3RlbSgpIHtcbiAgICBpZiAoIWZzKSB7XG4gICAgICAgIGZzID0gcmVxdWlyZShcImZpbGUtc3lzdGVtXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHJlcXVlc3Qob3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGlmICghb3B0aW9ucy51cmwpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJSZXF1ZXN0IHVybCB3YXMgZW1wdHkuXCIpKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIG5ldHdvcmsgPSBkb21haW5EZWJ1Z2dlci5nZXROZXR3b3JrKCk7XG4gICAgICAgICAgICB2YXIgZGVidWdSZXF1ZXN0XzEgPSBuZXR3b3JrICYmIG5ldHdvcmsuY3JlYXRlKCk7XG4gICAgICAgICAgICB2YXIgdXJsUmVxdWVzdCA9IE5TTXV0YWJsZVVSTFJlcXVlc3QucmVxdWVzdFdpdGhVUkwoTlNVUkwuVVJMV2l0aFN0cmluZyhvcHRpb25zLnVybCkpO1xuICAgICAgICAgICAgdXJsUmVxdWVzdC5IVFRQTWV0aG9kID0gdHlwZXMuaXNEZWZpbmVkKG9wdGlvbnMubWV0aG9kKSA/IG9wdGlvbnMubWV0aG9kIDogR0VUO1xuICAgICAgICAgICAgdXJsUmVxdWVzdC5zZXRWYWx1ZUZvckhUVFBIZWFkZXJGaWVsZChVU0VSX0FHRU5ULCBVU0VSX0FHRU5UX0hFQURFUik7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaGVhZGVyIGluIG9wdGlvbnMuaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICB1cmxSZXF1ZXN0LnNldFZhbHVlRm9ySFRUUEhlYWRlckZpZWxkKG9wdGlvbnMuaGVhZGVyc1toZWFkZXJdICsgXCJcIiwgaGVhZGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNTdHJpbmcob3B0aW9ucy5jb250ZW50KSB8fCBvcHRpb25zLmNvbnRlbnQgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgICAgIHVybFJlcXVlc3QuSFRUUEJvZHkgPSBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKG9wdGlvbnMuY29udGVudC50b1N0cmluZygpKS5kYXRhVXNpbmdFbmNvZGluZyg0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlcy5pc051bWJlcihvcHRpb25zLnRpbWVvdXQpKSB7XG4gICAgICAgICAgICAgICAgdXJsUmVxdWVzdC50aW1lb3V0SW50ZXJ2YWwgPSBvcHRpb25zLnRpbWVvdXQgLyAxMDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHNlc3Npb24gPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNCb29sZWFuKG9wdGlvbnMuZG9udEZvbGxvd1JlZGlyZWN0cykgJiYgb3B0aW9ucy5kb250Rm9sbG93UmVkaXJlY3RzKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlU2Vzc2lvbk5vdEZvbGxvd2luZ1JlZGlyZWN0cygpO1xuICAgICAgICAgICAgICAgIHNlc3Npb24gPSBzZXNzaW9uTm90Rm9sbG93aW5nUmVkaXJlY3RzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlRGVmYXVsdFNlc3Npb24oKTtcbiAgICAgICAgICAgICAgICBzZXNzaW9uID0gZGVmYXVsdFNlc3Npb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZGF0YVRhc2sgPSBzZXNzaW9uLmRhdGFUYXNrV2l0aFJlcXVlc3RDb21wbGV0aW9uSGFuZGxlcih1cmxSZXF1ZXN0LCBmdW5jdGlvbiAoZGF0YSwgcmVzcG9uc2UsIGVycm9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoZXJyb3IubG9jYWxpemVkRGVzY3JpcHRpb24pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzXzEgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLmFsbEhlYWRlckZpZWxkcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGhlYWRlckZpZWxkcyA9IHJlc3BvbnNlLmFsbEhlYWRlckZpZWxkcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlckZpZWxkcy5lbnVtZXJhdGVLZXlzQW5kT2JqZWN0c1VzaW5nQmxvY2soZnVuY3Rpb24gKGtleSwgdmFsdWUsIHN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRIZWFkZXIoaGVhZGVyc18xLCBrZXksIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChkZWJ1Z1JlcXVlc3RfMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdSZXF1ZXN0XzEubWltZVR5cGUgPSByZXNwb25zZS5NSU1FVHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnUmVxdWVzdF8xLmRhdGEgPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlYnVnUmVzcG9uc2UgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBvcHRpb25zLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogTlNIVFRQVVJMUmVzcG9uc2UubG9jYWxpemVkU3RyaW5nRm9yU3RhdHVzQ29kZShyZXNwb25zZS5zdGF0dXNDb2RlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXzEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWltZVR5cGU6IHJlc3BvbnNlLk1JTUVUeXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZyb21EaXNrQ2FjaGU6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdSZXF1ZXN0XzEucmVzcG9uc2VSZWNlaXZlZChkZWJ1Z1Jlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlYnVnUmVxdWVzdF8xLmxvYWRpbmdGaW5pc2hlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhdzogZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b1N0cmluZzogZnVuY3Rpb24gKGVuY29kaW5nKSB7IHJldHVybiBOU0RhdGFUb1N0cmluZyhkYXRhLCBlbmNvZGluZyk7IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9KU09OOiBmdW5jdGlvbiAoZW5jb2RpbmcpIHsgcmV0dXJuIHBhcnNlSlNPTihOU0RhdGFUb1N0cmluZyhkYXRhLCBlbmNvZGluZykpOyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvSW1hZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5zdXJlSW1hZ2VTb3VyY2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFVJSW1hZ2UudG5zX2RlY29kZUltYWdlV2l0aERhdGFDb21wbGV0aW9uKGRhdGEsIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGltYWdlU291cmNlLmZyb21OYXRpdmVTb3VyY2UoaW1hZ2UpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoXCJSZXNwb25zZSBjb250ZW50IG1heSBub3QgYmUgY29udmVydGVkIHRvIGFuIEltYWdlXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b0ZpbGU6IGZ1bmN0aW9uIChkZXN0aW5hdGlvbkZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuc3VyZUZpbGVTeXN0ZW0oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFkZXN0aW5hdGlvbkZpbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXN0aW5hdGlvbkZpbGVQYXRoID0gaHR0cF9yZXF1ZXN0X2NvbW1vbl8xLmdldEZpbGVuYW1lRnJvbVVybChvcHRpb25zLnVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEgaW5zdGFuY2VvZiBOU0RhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZnMuRmlsZS5mcm9tUGF0aChkZXN0aW5hdGlvbkZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEud3JpdGVUb0ZpbGVBdG9taWNhbGx5KGRlc3RpbmF0aW9uRmlsZVBhdGgsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFwiQ2Fubm90IHNhdmUgZmlsZSB3aXRoIHBhdGg6IFwiICsgZGVzdGluYXRpb25GaWxlUGF0aCArIFwiLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNfMVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLnVybCAmJiBkZWJ1Z1JlcXVlc3RfMSkge1xuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0XzEgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogb3B0aW9ucy51cmwsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogb3B0aW9ucy5oZWFkZXJzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBkZWJ1Z1JlcXVlc3RfMS5yZXF1ZXN0V2lsbEJlU2VudChyZXF1ZXN0XzEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGF0YVRhc2sucmVzdW1lKCk7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLnJlcXVlc3QgPSByZXF1ZXN0O1xuZnVuY3Rpb24gTlNEYXRhVG9TdHJpbmcoZGF0YSwgZW5jb2RpbmcpIHtcbiAgICB2YXIgY29kZSA9IE5TVVRGOFN0cmluZ0VuY29kaW5nO1xuICAgIGlmIChlbmNvZGluZyA9PT0gSHR0cFJlc3BvbnNlRW5jb2RpbmcuR0JLKSB7XG4gICAgICAgIGNvZGUgPSAxNTg2O1xuICAgIH1cbiAgICB2YXIgZW5jb2RlZFN0cmluZyA9IE5TU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhEYXRhRW5jb2RpbmcoZGF0YSwgY29kZSk7XG4gICAgaWYgKCFlbmNvZGVkU3RyaW5nKSB7XG4gICAgICAgIGNvZGUgPSBOU0lTT0xhdGluMVN0cmluZ0VuY29kaW5nO1xuICAgICAgICBlbmNvZGVkU3RyaW5nID0gTlNTdHJpbmcuYWxsb2MoKS5pbml0V2l0aERhdGFFbmNvZGluZyhkYXRhLCBjb2RlKTtcbiAgICB9XG4gICAgcmV0dXJuIGVuY29kZWRTdHJpbmcudG9TdHJpbmcoKTtcbn1cbmZ1bmN0aW9uIGFkZEhlYWRlcihoZWFkZXJzLCBrZXksIHZhbHVlKSB7XG4gICAgaWYgKCFoZWFkZXJzW2tleV0pIHtcbiAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoaGVhZGVyc1trZXldKSkge1xuICAgICAgICBoZWFkZXJzW2tleV0ucHVzaCh2YWx1ZSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWVzID0gW2hlYWRlcnNba2V5XV07XG4gICAgICAgIHZhbHVlcy5wdXNoKHZhbHVlKTtcbiAgICAgICAgaGVhZGVyc1trZXldID0gdmFsdWVzO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkSGVhZGVyID0gYWRkSGVhZGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aHR0cC1yZXF1ZXN0Lmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGh0dHBSZXF1ZXN0ID0gcmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0XCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vaHR0cC1yZXF1ZXN0XCIpKTtcbmZ1bmN0aW9uIGdldFN0cmluZyhhcmcpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBodHRwUmVxdWVzdC5yZXF1ZXN0KHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIgPyB7IHVybDogYXJnLCBtZXRob2Q6IFwiR0VUXCIgfSA6IGFyZylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBzdHIgPSByLmNvbnRlbnQudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHJlamVjdChlKTsgfSk7XG4gICAgfSk7XG59XG5leHBvcnRzLmdldFN0cmluZyA9IGdldFN0cmluZztcbmZ1bmN0aW9uIGdldEpTT04oYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgaHR0cFJlcXVlc3QucmVxdWVzdCh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiID8geyB1cmw6IGFyZywgbWV0aG9kOiBcIkdFVFwiIH0gOiBhcmcpXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIganNvbiA9IHIuY29udGVudC50b0pTT04oKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGpzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IHJldHVybiByZWplY3QoZSk7IH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRKU09OID0gZ2V0SlNPTjtcbmZ1bmN0aW9uIGdldEltYWdlKGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIGh0dHBSZXF1ZXN0LnJlcXVlc3QodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIiA/IHsgdXJsOiBhcmcsIG1ldGhvZDogXCJHRVRcIiB9IDogYXJnKVxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyLmNvbnRlbnQudG9JbWFnZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRJbWFnZSA9IGdldEltYWdlO1xuZnVuY3Rpb24gZ2V0RmlsZShhcmcsIGRlc3RpbmF0aW9uRmlsZVBhdGgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICBodHRwUmVxdWVzdC5yZXF1ZXN0KHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIgPyB7IHVybDogYXJnLCBtZXRob2Q6IFwiR0VUXCIgfSA6IGFyZylcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBmaWxlID0gci5jb250ZW50LnRvRmlsZShkZXN0aW5hdGlvbkZpbGVQYXRoKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGZpbGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7IHJldHVybiByZWplY3QoZSk7IH0pO1xuICAgIH0pO1xufVxuZXhwb3J0cy5nZXRGaWxlID0gZ2V0RmlsZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWh0dHAuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi91dGlscy91dGlsc1wiKTtcbmV4cG9ydHMuaXNGaWxlT3JSZXNvdXJjZVBhdGggPSB1dGlsc18xLmlzRmlsZU9yUmVzb3VyY2VQYXRoO1xudmFyIGh0dHA7XG5mdW5jdGlvbiBlbnN1cmVIdHRwKCkge1xuICAgIGlmICghaHR0cCkge1xuICAgICAgICBodHRwID0gcmVxdWlyZShcIi4uL2h0dHBcIik7XG4gICAgfVxufVxudmFyIEltYWdlU291cmNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJbWFnZVNvdXJjZSgpIHtcbiAgICB9XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmZyb21Bc3NldCA9IGZ1bmN0aW9uIChhc3NldCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgYXNzZXQuZ2V0SW1hZ2VBc3luYyhmdW5jdGlvbiAoaW1hZ2UsIGVycikge1xuICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZyb21OYXRpdmVTb3VyY2UoaW1hZ2UpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbVJlc291cmNlID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdGhpcy5pb3MgPSBVSUltYWdlLnRuc19zYWZlSW1hZ2VOYW1lZChuYW1lKSB8fCBVSUltYWdlLnRuc19zYWZlSW1hZ2VOYW1lZChuYW1lICsgXCIuanBnXCIpO1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tUmVzb3VyY2UgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBVSUltYWdlLnRuc19zYWZlRGVjb2RlSW1hZ2VOYW1lZENvbXBsZXRpb24obmFtZSwgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW9zID0gaW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgVUlJbWFnZS50bnNfc2FmZURlY29kZUltYWdlTmFtZWRDb21wbGV0aW9uKG5hbWUgKyBcIi5qcGdcIiwgZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuaW9zID0gaW1hZ2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5sb2FkRnJvbUZpbGUgPSBmdW5jdGlvbiAocGF0aCkge1xuICAgICAgICB0aGlzLmlvcyA9IFVJSW1hZ2UuaW1hZ2VXaXRoQ29udGVudHNPZkZpbGUoZ2V0RmlsZU5hbWUocGF0aCkpO1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tRmlsZSA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFVJSW1hZ2UudG5zX2RlY29kZUltYWdlV2lkdGhDb250ZW50c09mRmlsZUNvbXBsZXRpb24oZ2V0RmlsZU5hbWUocGF0aCksIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pb3MgPSBpbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHRoaXMuaW9zID0gVUlJbWFnZS5pbWFnZVdpdGhEYXRhKGRhdGEpO1xuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tRGF0YSA9IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIFVJSW1hZ2UudG5zX2RlY29kZUltYWdlV2l0aERhdGFDb21wbGV0aW9uKGRhdGEsIGZ1bmN0aW9uIChpbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5pb3MgPSBpbWFnZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSW1hZ2VTb3VyY2UucHJvdG90eXBlLmxvYWRGcm9tQmFzZTY0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBpZiAodHlwZW9mIHNvdXJjZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBOU0RhdGEuYWxsb2MoKS5pbml0V2l0aEJhc2U2NEVuY29kZWRTdHJpbmdPcHRpb25zKHNvdXJjZSwgMSk7XG4gICAgICAgICAgICB0aGlzLmlvcyA9IFVJSW1hZ2UuaW1hZ2VXaXRoRGF0YShkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5pb3MgIT0gbnVsbDtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5mcm9tQmFzZTY0ID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IE5TRGF0YS5hbGxvYygpLmluaXRXaXRoQmFzZTY0RW5jb2RlZFN0cmluZ09wdGlvbnMoc291cmNlLCAxKTtcbiAgICAgICAgICAgICAgICBVSUltYWdlLmltYWdlV2l0aERhdGFbXCJhc3luY1wiXShVSUltYWdlLCBbZGF0YV0pLnRoZW4oZnVuY3Rpb24gKGltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmlvcyA9IGltYWdlO1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUubG9hZEZyb21Gb250SWNvbkNvZGUgPSBmdW5jdGlvbiAoc291cmNlLCBmb250LCBjb2xvcikge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHZhciBmb250U2l6ZSA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZvbnQuZm9udFNpemUpO1xuICAgICAgICBpZiAoIWZvbnRTaXplKSB7XG4gICAgICAgICAgICBmb250U2l6ZSA9IFVJRm9udC5sYWJlbEZvbnRTaXplO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkZW5zaXR5ID0gdXRpbHNfMS5sYXlvdXQuZ2V0RGlzcGxheURlbnNpdHkoKTtcbiAgICAgICAgdmFyIHNjYWxlZEZvbnRTaXplID0gZm9udFNpemUgKiBkZW5zaXR5O1xuICAgICAgICB2YXIgYXR0cmlidXRlcyA9IChfYSA9IHt9LFxuICAgICAgICAgICAgX2FbTlNGb250QXR0cmlidXRlTmFtZV0gPSBmb250LmdldFVJRm9udChVSUZvbnQuc3lzdGVtRm9udE9mU2l6ZShzY2FsZWRGb250U2l6ZSkpLFxuICAgICAgICAgICAgX2EpO1xuICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZXNbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGNvbG9yLmlvcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXR0cmlidXRlZFN0cmluZyA9IE5TQXR0cmlidXRlZFN0cmluZy5hbGxvYygpLmluaXRXaXRoU3RyaW5nQXR0cmlidXRlcyhzb3VyY2UsIGF0dHJpYnV0ZXMpO1xuICAgICAgICBVSUdyYXBoaWNzQmVnaW5JbWFnZUNvbnRleHRXaXRoT3B0aW9ucyhhdHRyaWJ1dGVkU3RyaW5nLnNpemUoKSwgZmFsc2UsIDAuMCk7XG4gICAgICAgIGF0dHJpYnV0ZWRTdHJpbmcuZHJhd0F0UG9pbnQoQ0dQb2ludE1ha2UoMCwgMCkpO1xuICAgICAgICB2YXIgaWNvbkltYWdlID0gVUlHcmFwaGljc0dldEltYWdlRnJvbUN1cnJlbnRJbWFnZUNvbnRleHQoKTtcbiAgICAgICAgVUlHcmFwaGljc0VuZEltYWdlQ29udGV4dCgpO1xuICAgICAgICB0aGlzLmlvcyA9IGljb25JbWFnZTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW9zICE9IG51bGw7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUuc2V0TmF0aXZlU291cmNlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICBpZiAoc291cmNlICYmICEoc291cmNlIGluc3RhbmNlb2YgVUlJbWFnZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSBtZXRob2Qgc2V0TmF0aXZlU291cmNlKCkgZXhwZWN0cyBVSUltYWdlIGluc3RhbmNlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmlvcyA9IHNvdXJjZTtcbiAgICB9O1xuICAgIEltYWdlU291cmNlLnByb3RvdHlwZS5zYXZlVG9GaWxlID0gZnVuY3Rpb24gKHBhdGgsIGZvcm1hdCwgcXVhbGl0eSkge1xuICAgICAgICBpZiAoIXRoaXMuaW9zKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHF1YWxpdHkpIHtcbiAgICAgICAgICAgIHF1YWxpdHkgPSAocXVhbGl0eSAtIDApIC8gKDEwMCAtIDApO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkYXRhID0gZ2V0SW1hZ2VEYXRhKHRoaXMuaW9zLCBmb3JtYXQsIHF1YWxpdHkpO1xuICAgICAgICBpZiAoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIE5TRmlsZU1hbmFnZXIuZGVmYXVsdE1hbmFnZXIuY3JlYXRlRmlsZUF0UGF0aENvbnRlbnRzQXR0cmlidXRlcyhwYXRoLCBkYXRhLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBJbWFnZVNvdXJjZS5wcm90b3R5cGUudG9CYXNlNjRTdHJpbmcgPSBmdW5jdGlvbiAoZm9ybWF0LCBxdWFsaXR5KSB7XG4gICAgICAgIHZhciByZXMgPSBudWxsO1xuICAgICAgICBpZiAoIXRoaXMuaW9zKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChxdWFsaXR5KSB7XG4gICAgICAgICAgICBxdWFsaXR5ID0gKHF1YWxpdHkgLSAwKSAvICgxMDAgLSAwKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGF0YSA9IGdldEltYWdlRGF0YSh0aGlzLmlvcywgZm9ybWF0LCBxdWFsaXR5KTtcbiAgICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgICAgIHJlcyA9IGRhdGEuYmFzZTY0RW5jb2RpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlvcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5zaXplLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBOYU47XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbWFnZVNvdXJjZS5wcm90b3R5cGUsIFwid2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlvcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5zaXplLndpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE5hTjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEltYWdlU291cmNlLnByb3RvdHlwZSwgXCJyb3RhdGlvbkFuZ2xlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gTmFOO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChfdmFsdWUpIHtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIEltYWdlU291cmNlO1xufSgpKTtcbmV4cG9ydHMuSW1hZ2VTb3VyY2UgPSBJbWFnZVNvdXJjZTtcbmZ1bmN0aW9uIGdldEZpbGVOYW1lKHBhdGgpIHtcbiAgICB2YXIgZmlsZU5hbWUgPSB0eXBlb2YgcGF0aCA9PT0gXCJzdHJpbmdcIiA/IHBhdGgudHJpbSgpIDogXCJcIjtcbiAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgIGZpbGVOYW1lID0gZmlsZV9zeXN0ZW1fMS5wYXRoLmpvaW4oZmlsZV9zeXN0ZW1fMS5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIGZpbGVOYW1lLnJlcGxhY2UoXCJ+L1wiLCBcIlwiKSk7XG4gICAgfVxuICAgIHJldHVybiBmaWxlTmFtZTtcbn1cbmZ1bmN0aW9uIGdldEltYWdlRGF0YShpbnN0YW5jZSwgZm9ybWF0LCBxdWFsaXR5KSB7XG4gICAgaWYgKHF1YWxpdHkgPT09IHZvaWQgMCkgeyBxdWFsaXR5ID0gMC45OyB9XG4gICAgdmFyIGRhdGEgPSBudWxsO1xuICAgIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgICAgIGNhc2UgXCJwbmdcIjpcbiAgICAgICAgICAgIGRhdGEgPSBVSUltYWdlUE5HUmVwcmVzZW50YXRpb24oaW5zdGFuY2UpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJqcGVnXCI6XG4gICAgICAgIGNhc2UgXCJqcGdcIjpcbiAgICAgICAgICAgIGRhdGEgPSBVSUltYWdlSlBFR1JlcHJlc2VudGF0aW9uKGluc3RhbmNlLCBxdWFsaXR5KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbn1cbmZ1bmN0aW9uIGZyb21Bc3NldChhc3NldCkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5mcm9tQXNzZXQoYXNzZXQpO1xufVxuZXhwb3J0cy5mcm9tQXNzZXQgPSBmcm9tQXNzZXQ7XG5mdW5jdGlvbiBmcm9tUmVzb3VyY2UobmFtZSkge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5sb2FkRnJvbVJlc291cmNlKG5hbWUpID8gaW1hZ2UgOiBudWxsO1xufVxuZXhwb3J0cy5mcm9tUmVzb3VyY2UgPSBmcm9tUmVzb3VyY2U7XG5mdW5jdGlvbiBmcm9tRmlsZShwYXRoKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tRmlsZShwYXRoKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbUZpbGUgPSBmcm9tRmlsZTtcbmZ1bmN0aW9uIGZyb21Gb250SWNvbkNvZGUoc291cmNlLCBmb250LCBjb2xvcikge1xuICAgIHZhciBpbWFnZSA9IG5ldyBJbWFnZVNvdXJjZSgpO1xuICAgIHJldHVybiBpbWFnZS5sb2FkRnJvbUZvbnRJY29uQ29kZShzb3VyY2UsIGZvbnQsIGNvbG9yKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbUZvbnRJY29uQ29kZSA9IGZyb21Gb250SWNvbkNvZGU7XG5mdW5jdGlvbiBmcm9tRGF0YShkYXRhKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tRGF0YShkYXRhKSA/IGltYWdlIDogbnVsbDtcbn1cbmV4cG9ydHMuZnJvbURhdGEgPSBmcm9tRGF0YTtcbmZ1bmN0aW9uIGZyb21CYXNlNjQoc291cmNlKSB7XG4gICAgdmFyIGltYWdlID0gbmV3IEltYWdlU291cmNlKCk7XG4gICAgcmV0dXJuIGltYWdlLmxvYWRGcm9tQmFzZTY0KHNvdXJjZSkgPyBpbWFnZSA6IG51bGw7XG59XG5leHBvcnRzLmZyb21CYXNlNjQgPSBmcm9tQmFzZTY0O1xuZnVuY3Rpb24gZnJvbU5hdGl2ZVNvdXJjZShzb3VyY2UpIHtcbiAgICB2YXIgaW1hZ2VTb3VyY2UgPSBuZXcgSW1hZ2VTb3VyY2UoKTtcbiAgICBpbWFnZVNvdXJjZS5zZXROYXRpdmVTb3VyY2Uoc291cmNlKTtcbiAgICByZXR1cm4gaW1hZ2VTb3VyY2U7XG59XG5leHBvcnRzLmZyb21OYXRpdmVTb3VyY2UgPSBmcm9tTmF0aXZlU291cmNlO1xuZnVuY3Rpb24gZnJvbVVybCh1cmwpIHtcbiAgICBlbnN1cmVIdHRwKCk7XG4gICAgcmV0dXJuIGh0dHAuZ2V0SW1hZ2UodXJsKTtcbn1cbmV4cG9ydHMuZnJvbVVybCA9IGZyb21Vcmw7XG5mdW5jdGlvbiBmcm9tRmlsZU9yUmVzb3VyY2UocGF0aCkge1xuICAgIGlmICghdXRpbHNfMS5pc0ZpbGVPclJlc291cmNlUGF0aChwYXRoKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXRoIFxcXCJcIiArIFwiXFxcIiBpcyBub3QgYSB2YWxpZCBmaWxlIG9yIHJlc291cmNlLlwiKTtcbiAgICB9XG4gICAgaWYgKHBhdGguaW5kZXhPZih1dGlsc18xLlJFU09VUkNFX1BSRUZJWCkgPT09IDApIHtcbiAgICAgICAgcmV0dXJuIGZyb21SZXNvdXJjZShwYXRoLnN1YnN0cih1dGlsc18xLlJFU09VUkNFX1BSRUZJWC5sZW5ndGgpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21GaWxlKHBhdGgpO1xufVxuZXhwb3J0cy5mcm9tRmlsZU9yUmVzb3VyY2UgPSBmcm9tRmlsZU9yUmVzb3VyY2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1zb3VyY2UuaW9zLmpzLm1hcCIsIu+7v1x0Lypcblx0bmV3IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBwYXJzZXIgPSBuZXcgRWFzeVNBWFBhcnNlcigpO1xuXG5cdFx0cGFyc2VyLm5zKCdyc3MnLCB7IC8vIG9yIGZhbHNlXG5cdFx0XHRyc3M6ICdodHRwOi8vcHVybC5vcmcvcnNzLzEuMC8nLFxuXHRcdFx0YXRvbTogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDUvQXRvbScsXG5cdFx0XHR4aHRtbDogJ2h0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwnLFxuXHRcdFx0bWVkaWE6ICdodHRwOi8vc2VhcmNoLnlhaG9vLmNvbS9tcnNzLydcblx0XHR9KTtcblxuXG5cdFx0cGFyc2VyLm9uKCdlcnJvcicsIGZ1bmN0aW9uKG1zZykge1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhtc2cpXG5cdFx0fSk7XG5cblx0XHRwYXJzZXIub24oJ3N0YXJ0Tm9kZScsIGZ1bmN0aW9uKGVsZW0sIGF0dHIsIHVxLCB0YWdlbmQsIGdldFN0ck5vZGUpIHtcblx0XHRcdGF0dHIoKTtcblx0XHRcdHJldHVybjtcblx0XHRcdGlmICh0YWdlbmQpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJyAgICcrc3RyKVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJysgICcrc3RyKVxuXHRcdFx0fTtcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbignZW5kTm9kZScsIGZ1bmN0aW9uKGVsZW0sIHVxLCB0YWdzdGFydCwgc3RyKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0XHRpZiAoIXRhZ3N0YXJ0KSBjb25zb2xlLmxvZygnLSAgJyArIHN0cilcblx0XHR9KTtcblxuXHRcdHBhcnNlci5vbigndGV4dE5vZGUnLCBmdW5jdGlvbihzLCB1cSkge1xuXHRcdFx0dXEocyk7XG5cdFx0XHRyZXR1cm5cblx0XHRcdGNvbnNvbGUubG9nKCcgICAnK3MpXG5cdFx0fSk7XG5cblx0XHRwYXJzZXIub24oJ2NkYXRhJywgZnVuY3Rpb24oZGF0YSkge1xuXHRcdH0pO1xuXG5cblx0XHRwYXJzZXIub24oJ2NvbW1lbnQnLCBmdW5jdGlvbih0ZXh0KSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCctLScrdGV4dCsnLS0nKVxuXHRcdH0pO1xuXG5cdFx0Ly9wYXJzZXIub24oJ3F1ZXN0aW9uJywgZnVuY3Rpb24oKSB7fSk7IC8vIDw/IC4uLiA/PlxuXHRcdC8vcGFyc2VyLm9uKCdhdHRlbnRpb24nLCBmdW5jdGlvbigpIHt9KTsgLy8gPCFYWFhYWCB6enp6PVwiZWVlZVwiPlxuXG5cdFx0Y29uc29sZS50aW1lKCdlYXN5c2F4Jyk7XG5cdFx0Zm9yKHZhciB6PTEwMDA7ei0tOykge1xuXHRcdFx0cGFyc2VyLnBhcnNlKHhtbClcblx0XHR9O1xuXHRcdGNvbnNvbGUudGltZUVuZCgnZWFzeXNheCcpO1xuXHR9O1xuXG5cblx0Ki9cblxuLy8gPDwgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tID4+IC8vXG5cblxuaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAvKiYmIHRoaXMgPT0gZXhwb3J0cyovKSB7XG5cdG1vZHVsZS5leHBvcnRzLkVhc3lTQVhQYXJzZXIgPSBFYXN5U0FYUGFyc2VyO1xufTtcblxuZnVuY3Rpb24gRWFzeVNBWFBhcnNlcigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGlmICghdGhpcykgcmV0dXJuIG51bGw7XG5cbiAgICB0aGlzLmFuZ3VsYXJTeW50YXggPSBmYWxzZTtcblxuXHRmdW5jdGlvbiBudWxsRnVuYygpIHt9O1xuXG5cdHRoaXMub25UZXh0Tm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25TdGFydE5vZGUgPSBudWxsRnVuYztcbiAgICB0aGlzLm9uRW5kTm9kZSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25DREFUQSA9IG51bGxGdW5jO1xuICAgIHRoaXMub25FcnJvciA9IG51bGxGdW5jO1xuICAgIHRoaXMub25Db21tZW50ID0gbnVsbDtcbiAgICB0aGlzLm9uUXVlc3Rpb24gPSBudWxsO1xuICAgIHRoaXMub25BdHRlbnRpb24gPSBudWxsO1xuXHR0aGlzLmlzX29uQ29tbWVudCA9IHRoaXMuaXNfb25RdWVzdGlvbiA9IHRoaXMuaXNfb25BdHRlbnRpb24gPSBmYWxzZTtcblxuXHR0aGlzLmlzTmFtZXNwYWNlID0gZmFsc2U7XG4gICAgdGhpcy51c2VOUyA9IG51bGw7XG4gICAgdGhpcy5kZWZhdWx0X3htbG5zID0gbnVsbDtcbiAgICB0aGlzLnhtbG5zID0gbnVsbDtcblx0dGhpcy5uc21hdHJpeCA9IHt4bWxuczogdGhpcy54bWxuc307XG5cdHRoaXMuaGFzU3VybWlzZU5TID0gZmFsc2U7XG5cdDtcblxuXG5cdHRoaXMuYXR0cl9zdHJpbmcgPSAnJzsgLy8g0YHRgtGA0L7QutCwINCw0YLRgNC40LHRg9GC0L7QslxuXHR0aGlzLmF0dHJfcG9zc3RhcnQgPSAwOyAvL1xuXHR0aGlzLmF0dHJfcmVzOyAvLyDQt9Cw0LrQtdGI0LjRgNC+0LLQsNC90L3Ri9C5INGA0LXQt9GD0LvRjNGC0LDRgiDRgNCw0LfQsdC+0YDQsCDQsNGC0YDQuNCx0YPRgtC+0LIgLCBudWxsIC0g0YDQsNC30LHQvtGAINC90LUg0L/RgNC+0LLQvtC00LjQu9GB0Y8sIG9iamVjdCAtINGF0LXRiCDQsNGC0YDQuNCx0YPRgtC+0LIsIHRydWUgLSDQvdC10YIg0LDRgtGA0LjQsdGD0YLQvtCyLCBmYWxzZSAtINC90LXQstCw0LvQuNC00L3Ri9C5IHhtbFxufVxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uKG5hbWUsIGNiKSB7XG4gICAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICBpZiAoY2IgIT09IG51bGwpIHJldHVybjtcbiAgICB9O1xuXG4gICAgc3dpdGNoKG5hbWUpIHtcbiAgICAgICAgY2FzZSAnZXJyb3InOiB0aGlzLm9uRXJyb3IgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3N0YXJ0Tm9kZSc6IHRoaXMub25TdGFydE5vZGUgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2VuZE5vZGUnOiB0aGlzLm9uRW5kTm9kZSA9IGNiIHx8IG51bGxGdW5jOyBicmVhaztcbiAgICAgICAgY2FzZSAndGV4dE5vZGUnOiB0aGlzLm9uVGV4dE5vZGUgPSBjYiB8fCBudWxsRnVuYzsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2NkYXRhJzogdGhpcy5vbkNEQVRBID0gY2IgfHwgbnVsbEZ1bmM7IGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2NvbW1lbnQnOiB0aGlzLm9uQ29tbWVudCA9IGNiOyB0aGlzLmlzX29uQ29tbWVudCA9ICEhY2I7IGJyZWFrO1xuICAgICAgICBjYXNlICdxdWVzdGlvbic6IHRoaXMub25RdWVzdGlvbiA9IGNiOyB0aGlzLmlzX29uUXVlc3Rpb24gPSAhIWNiOyBicmVhazsgLy8gPD8gLi4uLiAgPz5cbiAgICAgICAgY2FzZSAnYXR0ZW50aW9uJzogdGhpcy5vbkF0dGVudGlvbiA9IGNiOyB0aGlzLmlzX29uQXR0ZW50aW9uID0gISFjYjsgYnJlYWs7IC8vIDwhWFhYWFggenp6ej1cImVlZWVcIj5cbiAgICB9O1xufTtcblxuRWFzeVNBWFBhcnNlci5wcm90b3R5cGUubnMgPSBmdW5jdGlvbihyb290LCBucykge1xuICAgIGlmICghcm9vdCB8fCB0eXBlb2Ygcm9vdCAhPT0gJ3N0cmluZycgfHwgIW5zKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9O1xuXG4gICAgdmFyIHUsIHggPSB7fSwgb2ssIHYsIGk7XG5cbiAgICBmb3IoaSBpbiBucykge1xuICAgICAgICB2ID0gbnNbaV07XG4gICAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGlmIChyb290ID09PSB2KSBvayA9IHRydWU7XG4gICAgICAgICAgICB4W2ldID0gdjtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgaWYgKG9rKSB7XG4gICAgICAgIHRoaXMuaXNOYW1lc3BhY2UgPSB0cnVlO1xuICAgICAgICB0aGlzLmRlZmF1bHRfeG1sbnMgPSByb290O1xuICAgICAgICB0aGlzLnVzZU5TID0geDtcbiAgICB9O1xufTtcblxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHhtbCkge1xuICAgIGlmICh0eXBlb2YgeG1sICE9PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm47XG4gICAgfTtcblxuICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7XG4gICAgICAgIHRoaXMubnNtYXRyaXggPSB7eG1sbnM6IHRoaXMuZGVmYXVsdF94bWxuc307XG5cbiAgICAgICAgcGFyc2UoeG1sKTtcblxuICAgICAgICB0aGlzLm5zbWF0cml4ID0gZmFsc2U7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICBwYXJzZSh4bWwpO1xuICAgIH07XG5cbiAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTtcbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbnZhciB4aGFyc1F1b3Q9e2NvbnN0cnVjdG9yOiBmYWxzZSwgaGFzT3duUHJvcGVydHk6IGZhbHNlLCBpc1Byb3RvdHlwZU9mOiBmYWxzZSwgcHJvcGVydHlJc0VudW1lcmFibGU6IGZhbHNlLCB0b0xvY2FsZVN0cmluZzogZmFsc2UsIHRvU3RyaW5nOiBmYWxzZSwgdmFsdWVPZjogZmFsc2VcbiAgICAsIHF1b3Q6ICdcIidcbiAgICAsIFFVT1Q6ICdcIidcbiAgICAsIGFtcDogJyYnXG4gICAgLCBBTVA6ICcmJ1xuICAgICwgbmJzcDogJ1xcdTAwQTAnXG4gICAgLCBhcG9zOiAnXFwnJ1xuICAgICwgbHQ6ICc8J1xuICAgICwgTFQ6ICc8J1xuICAgICwgZ3Q6ICc+J1xuICAgICwgR1Q6ICc+J1xuICAgICwgY29weTogJ1xcdTAwQTknXG4gICAgLCBsYXF1bzogJ1xcdTAwQUInXG4gICAgLCByYXF1bzogJ1xcdTAwQkInXG4gICAgLCByZWc6ICdcXHUwMEFFJ1xuICAgICwgZGVnOiAnXFx1MDBCMCdcbiAgICAsIHBsdXNtbjogJ1xcdTAwQjEnXG4gICAgLCBzdXAyOiAnXFx1MDBCMidcbiAgICAsIHN1cDM6ICdcXHUwMEIzJ1xuICAgICwgbWljcm86ICdcXHUwMEI1J1xuICAgICwgcGFyYTogJ1xcdTAwQjYnXG59O1xuXG5cbmZ1bmN0aW9uIHJwRW50aXRpZXMocywgZCwgeCwgeikge1xuICAgIGlmICh6KSB7XG4gICAgICAgIHJldHVybiB4aGFyc1F1b3Rbel0gfHwgJ1xceDAxJztcbiAgICB9O1xuXG4gICAgaWYgKGQpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoZCk7XG4gICAgfTtcblxuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KHgsIDE2KSk7XG59O1xuXG5mdW5jdGlvbiB1bkVudGl0aWVzKHMsIGkpIHtcbiAgICBzID0gU3RyaW5nKHMpO1xuICAgIGlmIChzLmxlbmd0aCA+IDMgJiYgcy5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gICAgICAgIGlmIChzLmluZGV4T2YoJyZndDsnKSAhPT0gLTEpIHMgPSBzLnJlcGxhY2UoLyZndDsvZywgJz4nKTtcbiAgICAgICAgaWYgKHMuaW5kZXhPZignJmx0OycpICE9PSAtMSkgcyA9IHMucmVwbGFjZSgvJmx0Oy9nLCAnPCcpO1xuICAgICAgICBpZiAocy5pbmRleE9mKCcmcXVvdDsnKSAhPT0gLTEpIHMgPSBzLnJlcGxhY2UoLyZxdW90Oy9nLCAnXCInKTtcblxuICAgICAgICBpZiAocy5pbmRleE9mKCcmJykgIT09IC0xKSB7XG4gICAgICAgICAgICBzID0gcy5yZXBsYWNlKC8mIyhcXGQrKTt8JiN4KFswMTIzNDU2Nzg5YWJjZGVmXSspO3wmKFxcdyspOy9pZywgcnBFbnRpdGllcyk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHJldHVybiBzO1xufTtcblxuXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5hbGxvd2VkQW5ndWxhckF0dHJpYnV0ZUNoYXJzID0gZnVuY3Rpb24odykge1xuICAgIGlmICghdGhpcy5hbmd1bGFyU3ludGF4KSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgdyA9PT0gNDAgfHwgLy8gKFxuICAgICAgICAgICAgdyA9PT0gNDEgfHwgLy8gKVxuICAgICAgICAgICAgdyA9PT0gOTEgfHwgLy8gW1xuICAgICAgICAgICAgdyA9PT0gOTMgfHwgLy8gXVxuICAgICAgICAgICAgdyA9PT0gOTQgfHwgLy8gXlxuICAgICAgICAgICAgdyA9PT0gMzUgICAgLy8gI1xuICAgICAgICApO1xuICAgIH1cbn07XG5cblx0Lypcblx0XHTQv9Cw0YDRgdC40YIg0LDRgtGA0LjQsdGD0YLRiyDQv9C+INGC0YDQtdCx0L7QstCw0L3QuNGOLiDQktCw0LbQvdC+ISAtINGE0YPQvdC60YbQuNGPINC90LUg0LPQtdC90LXRgNC40YDRg9C10YIg0LjRgdC60LvRjtGH0LXQvdC40Y8uXG5cblx0XHTQtdGB0LvQuCDQsdGL0LvQsCDQvtGI0LjQsdC60LAg0YDQsNC30LHQvtGA0LAg0LLQvtC30LLRgNCw0YjQsNC10YLRgdGPIGZhbHNlXG5cdFx00LXRgdC70Lgg0LDRgtGA0LjQsdGD0YLQvtCyINC90LXRgiDQuCDRgNCw0LfQsdC+0YAg0YPQtNCw0YfQtdC9INGC0L4g0LLQvtC30LLRgNCw0YjQsNC10YLRgdGPIHRydWVcblx0XHTQtdGB0LvQuCDQtdGB0YLRjCDQsNGC0YDQuNCx0YPRgtGLINGC0L4g0LLQvtC30LLRgNCw0YjQsNC10YLRgdGPINC+0LHRjNC10LrRgijRhdC10YgpXG5cdCovXG5cbkVhc3lTQVhQYXJzZXIucHJvdG90eXBlLmdldEF0dHJzID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuYXR0cl9yZXMgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXM7XG4gICAgfTtcblxuICAgIC8qXG4gICAgaWYgKHh4dGVzdCAhPT0gdSAmJiBhdHRyX3N0cmluZy5pbmRleE9mKHh4dGVzdCkgPT09IC0xKSB7XG4gICAgICAgIC8gKlxuICAgICAgICAgICAgLy8g0LTQu9GPINGD0YHQutC+0YDQtdC90LjRj1xuICAgICAgICAgICAgaWYgKGdldEF0dHJzKCdodG1sJykudHlwZSA9PSAnaHRtbCcpIHtcbiAgICAgICAgICAgICAgICAuLi5cbiAgICAgICAgICAgIH07XG4gICAgICAgICogL1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgICovXG5cbiAgICB2YXIgdVxuICAgICwgcmVzID0ge31cbiAgICAsIHMgPSB0aGlzLmF0dHJfc3RyaW5nXG4gICAgLCBpID0gdGhpcy5hdHRyX3Bvc3N0YXJ0XG4gICAgLCBsID0gcy5sZW5ndGhcbiAgICAsIGF0dHJfbGlzdCA9IHRoaXMuaGFzU3VybWlzZU5TID8gW10gOiBmYWxzZVxuICAgICwgbmFtZSwgdmFsdWUgPSAnJ1xuICAgICwgb2sgPSBmYWxzZVxuICAgICwgbm9WYWx1ZUF0dHJpYnV0ZSA9IGZhbHNlXG4gICAgLCBqLCB3LCBubiwgblxuICAgICwgaGFzTmV3TWF0cml4XG4gICAgLCBhbGlhcywgbmV3YWxpYXNcbiAgICA7XG5cbiAgICBhYTpcbiAgICBmb3IoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHcgPSBzLmNoYXJDb2RlQXQoaSk7XG5cbiAgICAgICAgaWYgKHc9PT0zMiB8fCAodzwxNCAmJiB3ID4gOCkgKSB7IC8vIFxcZlxcblxcclxcdFxcdlxuICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBDaGVjayBmb3IgdmFsaWQgYXR0cmlidXRlIHN0YXJ0IGNoYXJcbiAgICAgICAgaWYgKCh3IDwgNjUgJiYgIXRoaXMuYWxsb3dlZEFuZ3VsYXJBdHRyaWJ1dGVDaGFycyh3KSkgfHxcbiAgICAgICAgICAgICAgICB3ID4gMTIyIHx8ICh3ID4gOTAgJiYgdyA8IDk3ICYmICF0aGlzLmFsbG93ZWRBbmd1bGFyQXR0cmlidXRlQ2hhcnModykpICkgeyAvLyDQvtC20LjQtNCw0LXQvCDRgdC40LzQstC+0LtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIGNoYXJcbiAgICAgICAgfTtcblxuICAgICAgICBmb3IoaiA9IGkgKyAxOyBqIDwgbDsgaisrKSB7IC8vINC/0YDQvtCy0LXRgNGP0LXQvCDQstGB0LUg0YHQuNC80LLQvtC70Ysg0LjQvNC10L3QuCDQsNGC0YDQuNCx0YPRgtCwXG4gICAgICAgICAgICB3ID0gcy5jaGFyQ29kZUF0KGopO1xuXG4gICAgICAgICAgICBpZiAodyA+IDk2ICYmIHcgPCAxMjMgfHwgdyA+IDY0ICYmIHcgPCA5MSB8fCB3ID4gNDcgJiYgdyA8IDU5IHx8IHcgPT09IDQ1IHx8IHcgPT09IDk1IHx8IHcgPT09IDQ2IC8qIGh0dHBzOi8vZ2l0aHViLmNvbS90ZWxlcmlrL3hQbGF0Q29yZS9pc3N1ZXMvMTc5ICovKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vVmFsdWVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgai0tOyAvL1N0YXJ0ZWQgbmV4dCBhdHRyaWJ1dGUuIEdldCBiYWNrIGFuZCBicmVhayBvdXQgb2YgdGhlIGxvb3AuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmFsbG93ZWRBbmd1bGFyQXR0cmlidXRlQ2hhcnModykpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHcgPT09IDMyIHx8ICh3ID4gOCAmJiB3IDwgMTQpICkgeyAgLy8gXFxmXFxuXFxyXFx0XFx2INC/0YDQvtCx0LXQu1xuICAgICAgICAgICAgICAgIG5vVmFsdWVBdHRyaWJ1dGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh3ID09PSA2MSkgeyAvLyBcIj1cIiA9PSA2MVxuICAgICAgICAgICAgICAgIG5vVmFsdWVBdHRyaWJ1dGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZXJyb3IgMicpO1xuICAgICAgICAgICAgICAgIGlmICghbm9WYWx1ZUF0dHJpYnV0ZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH07XG5cbiAgICAgICAgbmFtZSA9IHMuc3Vic3RyaW5nKGksIGopLnRyaW0oKTtcbiAgICAgICAgb2sgPSB0cnVlO1xuXG4gICAgICAgIGlmIChuYW1lID09PSAneG1sbnM6eG1sbnMnKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdlcnJvciA2JylcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJfcmVzID0gZmFsc2U7IC8vIGVycm9yLiBpbnZhbGlkIG5hbWVcbiAgICAgICAgfTtcblxuICAgICAgICB3ID0gcy5jaGFyQ29kZUF0KGorMSk7XG5cbiAgICAgICAgd2hpbGUgKHcgPSBzLmNoYXJDb2RlQXQoaisxKSkge1xuICAgICAgICAgICAgaWYgKHc9PT0zMiB8fCAodyA+IDggJiYgdzwxNCkgKSB7ICAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghbm9WYWx1ZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgaWYgKHcgPT09IDM0KSB7ICAvLyAnXCInXG4gICAgICAgICAgICAgICAgaiA9IHMuaW5kZXhPZignXCInLCBpID0gaisyICk7XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHcgPT09IDM5KSB7XG4gICAgICAgICAgICAgICAgICAgIGogPSBzLmluZGV4T2YoJ1xcJycsIGkgPSBqKzIgKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7ICAvLyBcIidcIlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IGZhbHNlOyAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2Vycm9yIDQnKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTsgLy8gZXJyb3IuIGludmFsaWQgY2hhclxuICAgICAgICB9O1xuXG5cbiAgICAgICAgaWYgKGorMSA8IGwgJiYgIW5vVmFsdWVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHcgPSBzLmNoYXJDb2RlQXQoaisxKTtcblxuICAgICAgICAgICAgaWYgKHcgPiAzMiB8fCB3IDwgOSB8fCAodyA8IDMyICYmIHcgPiAxMykpIHtcbiAgICAgICAgICAgICAgICAvLyBlcnJvci4gaW52YWxpZCBjaGFyXG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnZXJyb3IgNScpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXR0cl9yZXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cblxuICAgICAgICBpZiAobm9WYWx1ZUF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgdmFsdWUgPSAnJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhbHVlID0gcy5zdWJzdHJpbmcoaSwgaik7XG4gICAgICAgIH1cblxuICAgICAgICAvL2kgPSBqICsgMTsgLy8g0YHQu9C10LQuINGB0LXQvNCy0L7QuyDRg9C20LUg0L/RgNC+0LLQtdGA0LXQvSDQv9C+0YLQvtC80YMg0L/RgNC+0LLQtdGA0Y/RgtGMINC90YPQttC90L4g0YHQu9C10LTRg9GO0YjQuNC5XG4gICAgICAgIGkgPSBqOyAvLyDRgdC70LXQtC4g0YHQtdC80LLQvtC7INGD0LbQtSDQv9GA0L7QstC10YDQtdC9INC/0L7RgtC+0LzRgyDQv9GA0L7QstC10YDRj9GC0Ywg0L3Rg9C20L3QviDRgdC70LXQtNGD0Y7RiNC40LlcblxuICAgICAgICBpZiAodGhpcy5pc05hbWVzcGFjZSkgeyAvL1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzU3VybWlzZU5TKSB7XG4gICAgICAgICAgICAgICAgLy8g0LXRgdGC0Ywg0L/QvtC00L7Qt9GA0LXQvdC40LUg0YfRgtC+INCyINCw0YLRgNC40LHRg9GC0LDRhSDQv9GA0LjRgdGD0YLRgdGC0LLRg9C10YIgeG1sbnNcblxuICAgICAgICAgICAgICAgIGlmIChuZXdhbGlhcyA9IG5hbWUgPT09ICd4bWxucycgPyAneG1sbnMnIDogbmFtZS5jaGFyQ29kZUF0KDApID09PSAxMjAgJiYgbmFtZS5zdWJzdHIoMCwgNikgPT09ICd4bWxuczonICYmIG5hbWUuc3Vic3RyKDYpICkge1xuICAgICAgICAgICAgICAgICAgICBhbGlhcyA9IHRoaXMudXNlTlNbdW5FbnRpdGllcyh2YWx1ZSldO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubnNtYXRyaXhbbmV3YWxpYXNdICE9PSBhbGlhcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaGFzTmV3TWF0cml4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc05ld01hdHJpeCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5uID0ge307IGZvciAobiBpbiB0aGlzLm5zbWF0cml4KSBubltuXSA9IHRoaXMubnNtYXRyaXhbbl07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBubjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeFtuZXdhbGlhc10gPSBhbGlhcztcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uc21hdHJpeFtuZXdhbGlhc10pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhhc05ld01hdHJpeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNOZXdNYXRyaXggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBubiA9IHt9OyBmb3IgKG4gaW4gdGhpcy5uc21hdHJpeCkgbm5bbl0gPSB0aGlzLm5zbWF0cml4W25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gbm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXhbbmV3YWxpYXNdID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHJlc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgYXR0cl9saXN0LnB1c2gobmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdyA9IG5hbWUubGVuZ3RoO1xuICAgICAgICAgICAgd2hpbGUoLS13KSB7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUuY2hhckNvZGVBdCh3KSA9PT0gNTgpIHsgLy8gJzonXG4gICAgICAgICAgICAgICAgICAgIGlmICh3ID0gdGhpcy5uc21hdHJpeFtuYW1lLnN1YnN0cmluZygwLCB3KV0gKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXNbdyArIG5hbWUuc3Vic3RyKHcpXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBhYTtcblxuICAgICAgICAgICAgICAgICAgICAvLyAneG1sOmJhc2UnID8/P1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHJlc1tuYW1lXSA9IHZhbHVlO1xuICAgICAgICBub1ZhbHVlQXR0cmlidXRlID0gZmFsc2U7XG4gICAgfTtcblxuXG4gICAgaWYgKCFvaykge1xuICAgICAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IHRydWU7ICAvLyDQsNGC0YDQuNCx0YPRgtC+0LIg0L3QtdGCLCDQvtGI0LjQsdC+0Log0YLQvtC20LUg0L3QtdGCXG4gICAgfTtcblxuXG4gICAgaWYgKHRoaXMuaGFzU3VybWlzZU5TKSAge1xuICAgICAgICBiYjpcblxuICAgICAgICBmb3IgKGkgPSAwLCBsID0gYXR0cl9saXN0Lmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgbmFtZSA9IGF0dHJfbGlzdFtpKytdO1xuXG4gICAgICAgICAgICB3ID0gbmFtZS5sZW5ndGg7XG4gICAgICAgICAgICB3aGlsZSgtLXcpIHsgLy8gbmFtZS5pbmRleE9mKCc6JylcbiAgICAgICAgICAgICAgICBpZiAobmFtZS5jaGFyQ29kZUF0KHcpID09PSA1OCkgeyAvLyAnOidcbiAgICAgICAgICAgICAgICAgICAgaWYgKHcgPSB0aGlzLm5zbWF0cml4W25hbWUuc3Vic3RyaW5nKDAsIHcpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzW3cgKyBuYW1lLnN1YnN0cih3KV0gPSBhdHRyX2xpc3RbaV07XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIGJiO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgcmVzW25hbWVdID0gYXR0cl9saXN0W2ldO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5hdHRyX3JlcyA9IHJlcztcbn07XG5cblxuLy8geG1sIC0gc3RyaW5nXG5FYXN5U0FYUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uKHhtbCkge1xuICAgIHZhciB1XG4gICAgLCB4bWwgPSBTdHJpbmcoeG1sKVxuICAgICwgbm9kZXN0YWNrID0gW11cbiAgICAsIHN0YWNrbnNtYXRyaXggPSBbXVxuICAgIC8vLCBzdHJpbmdfbm9kZVxuICAgICwgZWxlbVxuICAgICwgdGFnZW5kID0gZmFsc2VcbiAgICAsIHRhZ3N0YXJ0ID0gZmFsc2VcbiAgICAsIGogPSAwLCBpID0gMCwgayA9IDAsIGxlblxuICAgICwgeCwgeSwgcSwgd1xuICAgICwgeG1sbnNcbiAgICAsIHN0b3BJbmRleCA9IDBcbiAgICAsIHN0b3AgLy8g0LjRgdC/0L7Qu9GM0LfRg9C10YLRgdGPINC/0YDQuCDRgNCw0LfQsdC+0YDQtSBcIm5hbWVzcGFjZVwiIC4g0LXRgdC70Lgg0LLRgdGC0YDQtdGC0LjQu9GB0Y8g0L3QtdC40LfQstC10YHRgtC90L7QtSDQv9GA0L7RgdGC0YDQsNC90YHRgtCy0L4g0YLQviDRgdC+0LHRi9GC0LjRjyDQvdC1INCz0LXQvdC10YDQuNGA0YPRjtGC0YHRj1xuICAgICwgX25zbWF0cml4XG4gICAgLCBva1xuICAgICwgcG9zID0gMCwgbG4gPSAwLCBsblN0YXJ0ID0gLTIsIGxuRW5kID0gLTFcbiAgICA7XG5cbiAgICBsZW4gPSB4bWwubGVuZ3RoO1xuICAgIGZ1bmN0aW9uIGdldFN0cmluZ05vZGUoKSB7XG4gICAgICAgIHJldHVybiB4bWwuc3Vic3RyaW5nKGksIGorMSlcbiAgICB9O1xuICAgIGZ1bmN0aW9uIGZpbmRMaW5lQW5kQ29sdW1uRnJvbVBvcygpIHtcbiAgICAgICAgd2hpbGUgKGxuU3RhcnQgPCBsbkVuZCAmJiBsbkVuZCA8IHBvcykge1xuICAgICAgICAgICAgbG5TdGFydCA9IGxuRW5kO1xuICAgICAgICAgICAgbG5FbmQgPSB4bWwuaW5kZXhPZihcIlxcblwiLCBsbkVuZCArIDEpO1xuICAgICAgICAgICAgKytsbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyBsaW5lOiBsbiwgY29sdW1uOiBwb3MgLSBsblN0YXJ0IH07XG4gICAgfVxuICAgIGZ1bmN0aW9uIHBvc2l0aW9uKHApIHtcbiAgICAgICAgcG9zID0gcDtcbiAgICAgICAgcmV0dXJuIGZpbmRMaW5lQW5kQ29sdW1uRnJvbVBvcztcbiAgICB9XG5cbiAgICB3aGlsZShqICE9PSAtMSkge1xuICAgICAgICBzdG9wID0gc3RvcEluZGV4ID4gMDtcblxuICAgICAgICBpZiAoeG1sLmNoYXJDb2RlQXQoaikgPT09IDYwKSB7IC8vIFwiPFwiXG4gICAgICAgICAgICBpID0gajtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGkgPSB4bWwuaW5kZXhPZignPCcsIGopO1xuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChpID09PSAtMSkgeyAvLyDQutC+0L3QtdGGINGA0LDQt9Cx0L7RgNCwXG5cbiAgICAgICAgICAgIGlmIChub2Rlc3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdlbmQgZmlsZScsIHBvc2l0aW9uKGopKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKGogIT09IGkgJiYgIXN0b3ApIHtcbiAgICAgICAgICAgIG9rID0gdGhpcy5vblRleHROb2RlKHhtbC5zdWJzdHJpbmcoaiwgaSksIHVuRW50aXRpZXMsIHBvc2l0aW9uKGopKTtcbiAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgfTtcblxuICAgICAgICB3ID0geG1sLmNoYXJDb2RlQXQoaSsxKTtcblxuICAgICAgICBpZiAodyA9PT0gMzMpIHsgLy8gXCIhXCJcbiAgICAgICAgICAgIHcgPSB4bWwuY2hhckNvZGVBdChpKzIpO1xuICAgICAgICAgICAgaWYgKHcgPT09IDkxICYmIHhtbC5zdWJzdHIoaSszLCA2KSA9PT0gJ0NEQVRBWycpIHsgLy8gOTEgPT0gXCJbXCJcbiAgICAgICAgICAgICAgICBqID0geG1sLmluZGV4T2YoJ11dPicsIGkpO1xuICAgICAgICAgICAgICAgIGlmIChqID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2NkYXRhJywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8veCA9IHhtbC5zdWJzdHJpbmcoaSs5LCBqKTtcbiAgICAgICAgICAgICAgICBpZiAoIXN0b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgb2sgPSB0aGlzLm9uQ0RBVEEoeG1sLnN1YnN0cmluZyhpKzksIGopLCBmYWxzZSwgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2sgPT09IGZhbHNlKSByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGogKz0gMztcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh3ID09PSA0NSAmJiB4bWwuY2hhckNvZGVBdChpKzMpID09PSA0NSkgeyAvLyA0NSA9PSBcIi1cIlxuICAgICAgICAgICAgICAgIGogPSB4bWwuaW5kZXhPZignLS0+JywgaSk7XG4gICAgICAgICAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignZXhwZWN0ZWQgLS0+JywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfTtcblxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25Db21tZW50ICYmICFzdG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIG9rID0gdGhpcy5vbkNvbW1lbnQoeG1sLnN1YnN0cmluZyhpKzQsIGopLCB1bkVudGl0aWVzLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaiArPSAzO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaiA9IHhtbC5pbmRleE9mKCc+JywgaSsxKTtcbiAgICAgICAgICAgIGlmIChqID09PSAtMSkge1xuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignZXhwZWN0ZWQgXCI+XCInLCBwb3NpdGlvbihpICsgMSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzX29uQXR0ZW50aW9uICYmICFzdG9wKSB7XG4gICAgICAgICAgICAgICAgb2sgPSB0aGlzLm9uQXR0ZW50aW9uKHhtbC5zdWJzdHJpbmcoaSwgaisxKSwgdW5FbnRpdGllcywgcG9zaXRpb24oaSkpO1xuICAgICAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodyA9PT0gNjMpIHsgLy8gXCI/XCJcbiAgICAgICAgICAgICAgICBqID0geG1sLmluZGV4T2YoJz8+JywgaSk7XG4gICAgICAgICAgICAgICAgaWYgKGogPT09IC0xKSB7IC8vIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignLi4uPz4nLCBwb3NpdGlvbihpKSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNfb25RdWVzdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBvayA9IHRoaXMub25RdWVzdGlvbih4bWwuc3Vic3RyaW5nKGksIGorMiksIHBvc2l0aW9uKGkpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBqICs9IDI7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBpbnNpZGU9ZmFsc2U7XG4gICAgICAgIGZvciAoaz1pLGo9LTE7azxsZW47aysrKSB7XG4gICAgICAgICAgICB2YXIgYyA9IHhtbC5jaGFyQ29kZUF0KGspO1xuICAgICAgICAgICAgaWYgKCFpbnNpZGUpIHtcblxuICAgICAgICAgICAgICAgIGlmIChjID09PSAzNCkgeyAvLyAnXCInXG4gICAgICAgICAgICAgICAgICAgIGluc2lkZSA9IGM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGMgPT09IDM5KSB7IC8vIFwiJ1wiXG4gICAgICAgICAgICAgICAgICAgIGluc2lkZSA9IGM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGMgPT09IDYyKSB7IC8vIDxcbiAgICAgICAgICAgICAgICAgICAgaiA9IGs7IGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGMgPT09IGluc2lkZSkgeyBpbnNpZGUgPSBmYWxzZTsgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGogPT0gLTEpIHsgLy8gZXJyb3JcbiAgICAgICAgICAgIHRoaXMub25FcnJvcignLi4uPicsIHBvc2l0aW9uKGkgKyAxKSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5hdHRyX3JlcyA9IHRydWU7IC8vINCw0YLRgNC40LHRg9GC0L7QsiDQvdC10YJcblxuICAgICAgICAvL2lmICh4bWwuY2hhckNvZGVBdChpKzEpID09PSA0NykgeyAvLyA8Ly4uLlxuICAgICAgICBpZiAodyA9PT0gNDcpIHsgLy8gPC8uLi5cbiAgICAgICAgICAgIHRhZ3N0YXJ0ID0gZmFsc2U7XG4gICAgICAgICAgICB0YWdlbmQgPSB0cnVlO1xuXG4gICAgICAgICAgICAvLyDQv9GA0L7QstC10YDRj9C10Lwg0YfRgtC+INC00L7Qu9C20LXQvSDQsdGL0YLRjCDQt9Cw0LrRgNGL0YIg0YLQvtGC0LbQtSDRgtC10LMg0YfRgtC+INC4INC+0YLQutGA0YvQstCw0LvRgdGPXG4gICAgICAgICAgICB4ID0gZWxlbSA9IG5vZGVzdGFjay5wb3AoKTtcbiAgICAgICAgICAgIHEgPSBpICsgMiArIHgubGVuZ3RoO1xuXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKClcbiAgICAgICAgICAgIGlmICh4bWwuc3Vic3RyaW5nKGkrMiwgcSkgIT09IHgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2Nsb3NlIHRhZ25hbWUnLCBwb3NpdGlvbihpICsgMikpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vINC/0YDQvtCy0LXRgNC40Lwg0YfRgtC+INCyINC30LDQutGA0YvQstCw0Y7RiNC10Lwg0YLQtdCz0LUg0L3QtdGCINC70LjRiNC90LXQs9C+XG4gICAgICAgICAgICBmb3IoOyBxIDwgajsgcSsrKSB7XG4gICAgICAgICAgICAgICAgdyA9IHhtbC5jaGFyQ29kZUF0KHEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHc9PT0zMiB8fCAodyA+IDggJiYgdzwxNCkgKSB7ICAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzLm9uRXJyb3IoJ2Nsb3NlIHRhZycsIHBvc2l0aW9uKGkgKyAyKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHhtbC5jaGFyQ29kZUF0KGotMSkgPT09ICA0NykgeyAvLyAuLi4vPlxuICAgICAgICAgICAgICAgIHggPSBlbGVtID0geG1sLnN1YnN0cmluZyhpKzEsIGotMSk7XG5cbiAgICAgICAgICAgICAgICB0YWdzdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGFnZW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeCA9IGVsZW0gPSB4bWwuc3Vic3RyaW5nKGkrMSwgaik7XG5cbiAgICAgICAgICAgICAgICB0YWdzdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGFnZW5kID0gZmFsc2U7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoICEodyA+IDk2ICAmJiB3IDwgMTIzIHx8IHcgPiA2NCAmJiB3IDw5MSkgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkVycm9yKCdmaXJzdCBjaGFyIG5vZGVOYW1lJywgcG9zaXRpb24oaSArIDEpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IocSA9IDEsIHkgPSB4Lmxlbmd0aDsgcSA8IHk7IHErKykge1xuICAgICAgICAgICAgICAgIHcgPSB4LmNoYXJDb2RlQXQocSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodyA+IDk2ICYmIHcgPCAxMjMgfHwgdyA+IDY0ICYmIHcgPCA5MSB8fCB3ID4gNDcgJiYgdyA8IDU5IHx8IHcgPT09IDQ1IHx8IHcgPT09IDk1IHx8IHcgPT09IDQ2IC8qIGh0dHBzOi8vZ2l0aHViLmNvbS90ZWxlcmlrL3hQbGF0Q29yZS9pc3N1ZXMvMTc5ICovKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodz09PTMyIHx8ICh3PDE0ICYmIHcgPiA4KSkgeyAvLyBcXGZcXG5cXHJcXHRcXHYg0L/RgNC+0LHQtdC7XG4gICAgICAgICAgICAgICAgICAgIGVsZW0gPSB4LnN1YnN0cmluZygwLCBxKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJfcmVzID0gbnVsbDsgLy8g0LLQvtC30LzQvtC20L3QviDQtdGB0YLRjCDQsNGC0LjRgNC40LHRg9GC0YtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXMub25FcnJvcignaW52YWxpZCBub2RlTmFtZScsIHBvc2l0aW9uKGkgKyAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCF0YWdlbmQpIHtcbiAgICAgICAgICAgICAgICBub2Rlc3RhY2sucHVzaChlbGVtKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cblxuICAgICAgICBpZiAodGhpcy5pc05hbWVzcGFjZSkge1xuICAgICAgICAgICAgaWYgKHN0b3ApIHtcbiAgICAgICAgICAgICAgICBpZiAodGFnZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFnc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgtLXN0b3BJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBzdGFja25zbWF0cml4LnBvcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0b3BJbmRleCArPSAxO1xuICAgICAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIF9uc21hdHJpeCA9IHRoaXMubnNtYXRyaXg7XG5cbiAgICAgICAgICAgIGlmICghdGFnZW5kKSB7XG4gICAgICAgICAgICAgICAgc3RhY2tuc21hdHJpeC5wdXNoKHRoaXMubnNtYXRyaXgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXR0cl9yZXMgIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzU3VybWlzZU5TID0geC5pbmRleE9mKCd4bWxucycsIHEpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyX3N0cmluZyA9IHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmF0dHJfcG9zc3RhcnQgPSBxO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEF0dHJzKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU3VybWlzZU5TID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG5cblxuICAgICAgICAgICAgdyA9IGVsZW0uaW5kZXhPZignOicpO1xuICAgICAgICAgICAgaWYgKHcgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgeG1sbnMgPSB0aGlzLm5zbWF0cml4W2VsZW0uc3Vic3RyaW5nKDAsIHcpXTtcbiAgICAgICAgICAgICAgICBlbGVtID0gZWxlbS5zdWJzdHIodysxKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4bWxucyA9IHRoaXMubnNtYXRyaXgueG1sbnM7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoIXhtbG5zKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ2VuZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGFnc3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBfbnNtYXRyaXg7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5zbWF0cml4ID0gc3RhY2tuc21hdHJpeC5wb3AoKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdG9wSW5kZXggPSAxOyAvLyDQv9C10YDQstGL0Lkg0Y3Qu9C10LzQtdC90YIg0LTQu9GPINC60L7RgtC+0YDQvtCz0L4g0L3QtSDQvtC/0YDQtdC00LXQu9C10L3QviDQv9GA0L7RgdGC0YDQsNC90YHRgtCy0L4g0LjQvNC10L1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdHRyX3JlcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGogKz0gMTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGVsZW0gPSB4bWxucyArICc6JyArIGVsZW07XG4gICAgICAgIH07XG5cbiAgICAgICAgLy9zdHJpbmdfbm9kZSA9IHhtbC5zdWJzdHJpbmcoaSwgaisxKTsgLy8g0YLQtdC60YHRgiDQvdC+0LTRiyDQutCw0Log0LXRgdGC0YxcblxuICAgICAgICBpZiAodGFnc3RhcnQpIHsgLy8gaXNfb25TdGFydE5vZGVcbiAgICAgICAgICAgIHRoaXMuYXR0cl9zdHJpbmcgPSB4O1xuICAgICAgICAgICAgdGhpcy5hdHRyX3Bvc3N0YXJ0ID0gcTtcblxuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgb2sgPSB0aGlzLm9uU3RhcnROb2RlKGVsZW0sIGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhhdC5nZXRBdHRycygpIH0sIHVuRW50aXRpZXMsIHRhZ2VuZFxuICAgICAgICAgICAgICAgICwgZ2V0U3RyaW5nTm9kZSwgcG9zaXRpb24oaSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIGlmIChvayA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmF0dHJfcmVzID0gdHJ1ZTtcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAodGFnZW5kKSB7XG4gICAgICAgICAgICBvayA9IHRoaXMub25FbmROb2RlKGVsZW0sIHVuRW50aXRpZXMsIHRhZ3N0YXJ0XG4gICAgICAgICAgICAgICAgLCBnZXRTdHJpbmdOb2RlLCBwb3NpdGlvbihpKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaWYgKG9rID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzTmFtZXNwYWNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhZ3N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubnNtYXRyaXggPSBfbnNtYXRyaXg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uc21hdHJpeCA9IHN0YWNrbnNtYXRyaXgucG9wKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG5cbiAgICAgICAgaiArPSAxO1xuICAgIH07XG59O1xuIiwi77u/LypcbiAgQ29weXJpZ2h0IChDKSAyMDEzIEFyaXlhIEhpZGF5YXQgPGFyaXlhLmhpZGF5YXRAZ21haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTMgVGhhZGRlZSBUeWwgPHRoYWRkZWUudHlsQGdtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIEFyaXlhIEhpZGF5YXQgPGFyaXlhLmhpZGF5YXRAZ21haWwuY29tPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgTWF0aGlhcyBCeW5lbnMgPG1hdGhpYXNAcWl3aS5iZT5cbiAgQ29weXJpZ2h0IChDKSAyMDEyIEpvb3N0LVdpbSBCb2VrZXN0ZWlqbiA8am9vc3Qtd2ltQGJvZWtlc3RlaWpuLm5sPlxuICBDb3B5cmlnaHQgKEMpIDIwMTIgS3JpcyBLb3dhbCA8a3Jpcy5rb3dhbEBjaXhhci5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMiBZdXN1a2UgU3V6dWtpIDx1dGF0YW5lLnRlYUBnbWFpbC5jb20+XG4gIENvcHlyaWdodCAoQykgMjAxMiBBcnBhZCBCb3Jzb3MgPGFycGFkLmJvcnNvc0Bnb29nbGVtYWlsLmNvbT5cbiAgQ29weXJpZ2h0IChDKSAyMDExIEFyaXlhIEhpZGF5YXQgPGFyaXlhLmhpZGF5YXRAZ21haWwuY29tPlxuXG4gIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dFxuICBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMgYXJlIG1ldDpcblxuICAgICogUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHRcbiAgICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAgICAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0XG4gICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlXG4gICAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLlxuXG4gIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIEFORCBDT05UUklCVVRPUlMgXCJBUyBJU1wiXG4gIEFORCBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEVcbiAgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0VcbiAgQVJFIERJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIDxDT1BZUklHSFQgSE9MREVSPiBCRSBMSUFCTEUgRk9SIEFOWVxuICBESVJFQ1QsIElORElSRUNULCBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFU1xuICAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgR09PRFMgT1IgU0VSVklDRVM7XG4gIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuICBPTiBBTlkgVEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElUWSwgT1IgVE9SVFxuICAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GIFRIRSBVU0UgT0ZcbiAgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiovXG5cbihmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIFRva2VuLFxuICAgICAgICBUb2tlbk5hbWUsXG4gICAgICAgIFN5bnRheCxcbiAgICAgICAgTWVzc2FnZXMsXG4gICAgICAgIHNvdXJjZSxcbiAgICAgICAgaW5kZXgsXG4gICAgICAgIGxlbmd0aCxcbiAgICAgICAgZGVsZWdhdGUsXG4gICAgICAgIGxvb2thaGVhZCxcbiAgICAgICAgc3RhdGU7XG5cbiAgICBUb2tlbiA9IHtcbiAgICAgICAgQm9vbGVhbkxpdGVyYWw6IDEsXG4gICAgICAgIEVPRjogMixcbiAgICAgICAgSWRlbnRpZmllcjogMyxcbiAgICAgICAgS2V5d29yZDogNCxcbiAgICAgICAgTnVsbExpdGVyYWw6IDUsXG4gICAgICAgIE51bWVyaWNMaXRlcmFsOiA2LFxuICAgICAgICBQdW5jdHVhdG9yOiA3LFxuICAgICAgICBTdHJpbmdMaXRlcmFsOiA4XG4gICAgfTtcblxuICAgIFRva2VuTmFtZSA9IHt9O1xuICAgIFRva2VuTmFtZVtUb2tlbi5Cb29sZWFuTGl0ZXJhbF0gPSAnQm9vbGVhbic7XG4gICAgVG9rZW5OYW1lW1Rva2VuLkVPRl0gPSAnPGVuZD4nO1xuICAgIFRva2VuTmFtZVtUb2tlbi5JZGVudGlmaWVyXSA9ICdJZGVudGlmaWVyJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uS2V5d29yZF0gPSAnS2V5d29yZCc7XG4gICAgVG9rZW5OYW1lW1Rva2VuLk51bGxMaXRlcmFsXSA9ICdOdWxsJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uTnVtZXJpY0xpdGVyYWxdID0gJ051bWVyaWMnO1xuICAgIFRva2VuTmFtZVtUb2tlbi5QdW5jdHVhdG9yXSA9ICdQdW5jdHVhdG9yJztcbiAgICBUb2tlbk5hbWVbVG9rZW4uU3RyaW5nTGl0ZXJhbF0gPSAnU3RyaW5nJztcblxuICAgIFN5bnRheCA9IHtcbiAgICAgICAgQXJyYXlFeHByZXNzaW9uOiAnQXJyYXlFeHByZXNzaW9uJyxcbiAgICAgICAgQmluYXJ5RXhwcmVzc2lvbjogJ0JpbmFyeUV4cHJlc3Npb24nLFxuICAgICAgICBDYWxsRXhwcmVzc2lvbjogJ0NhbGxFeHByZXNzaW9uJyxcbiAgICAgICAgQ29uZGl0aW9uYWxFeHByZXNzaW9uOiAnQ29uZGl0aW9uYWxFeHByZXNzaW9uJyxcbiAgICAgICAgRW1wdHlTdGF0ZW1lbnQ6ICdFbXB0eVN0YXRlbWVudCcsXG4gICAgICAgIEV4cHJlc3Npb25TdGF0ZW1lbnQ6ICdFeHByZXNzaW9uU3RhdGVtZW50JyxcbiAgICAgICAgSWRlbnRpZmllcjogJ0lkZW50aWZpZXInLFxuICAgICAgICBMaXRlcmFsOiAnTGl0ZXJhbCcsXG4gICAgICAgIExhYmVsZWRTdGF0ZW1lbnQ6ICdMYWJlbGVkU3RhdGVtZW50JyxcbiAgICAgICAgTG9naWNhbEV4cHJlc3Npb246ICdMb2dpY2FsRXhwcmVzc2lvbicsXG4gICAgICAgIE1lbWJlckV4cHJlc3Npb246ICdNZW1iZXJFeHByZXNzaW9uJyxcbiAgICAgICAgT2JqZWN0RXhwcmVzc2lvbjogJ09iamVjdEV4cHJlc3Npb24nLFxuICAgICAgICBQcm9ncmFtOiAnUHJvZ3JhbScsXG4gICAgICAgIFByb3BlcnR5OiAnUHJvcGVydHknLFxuICAgICAgICBUaGlzRXhwcmVzc2lvbjogJ1RoaXNFeHByZXNzaW9uJyxcbiAgICAgICAgVW5hcnlFeHByZXNzaW9uOiAnVW5hcnlFeHByZXNzaW9uJ1xuICAgIH07XG5cbiAgICAvLyBFcnJvciBtZXNzYWdlcyBzaG91bGQgYmUgaWRlbnRpY2FsIHRvIFY4LlxuICAgIE1lc3NhZ2VzID0ge1xuICAgICAgICBVbmV4cGVjdGVkVG9rZW46ICdVbmV4cGVjdGVkIHRva2VuICUwJyxcbiAgICAgICAgVW5rbm93bkxhYmVsOiAnVW5kZWZpbmVkIGxhYmVsIFxcJyUwXFwnJyxcbiAgICAgICAgUmVkZWNsYXJhdGlvbjogJyUwIFxcJyUxXFwnIGhhcyBhbHJlYWR5IGJlZW4gZGVjbGFyZWQnXG4gICAgfTtcblxuICAgIC8vIEVuc3VyZSB0aGUgY29uZGl0aW9uIGlzIHRydWUsIG90aGVyd2lzZSB0aHJvdyBhbiBlcnJvci5cbiAgICAvLyBUaGlzIGlzIG9ubHkgdG8gaGF2ZSBhIGJldHRlciBjb250cmFjdCBzZW1hbnRpYywgaS5lLiBhbm90aGVyIHNhZmV0eSBuZXRcbiAgICAvLyB0byBjYXRjaCBhIGxvZ2ljIGVycm9yLiBUaGUgY29uZGl0aW9uIHNoYWxsIGJlIGZ1bGZpbGxlZCBpbiBub3JtYWwgY2FzZS5cbiAgICAvLyBEbyBOT1QgdXNlIHRoaXMgdG8gZW5mb3JjZSBhIGNlcnRhaW4gY29uZGl0aW9uIG9uIGFueSB1c2VyIGlucHV0LlxuXG4gICAgZnVuY3Rpb24gYXNzZXJ0KGNvbmRpdGlvbiwgbWVzc2FnZSkge1xuICAgICAgICBpZiAoIWNvbmRpdGlvbikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBU1NFUlQ6ICcgKyBtZXNzYWdlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzRGVjaW1hbERpZ2l0KGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPj0gNDggJiYgY2ggPD0gNTcpOyAgIC8vIDAuLjlcbiAgICB9XG5cblxuICAgIC8vIDcuMiBXaGl0ZSBTcGFjZVxuXG4gICAgZnVuY3Rpb24gaXNXaGl0ZVNwYWNlKGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPT09IDMyKSB8fCAgLy8gc3BhY2VcbiAgICAgICAgICAgIChjaCA9PT0gOSkgfHwgICAgICAvLyB0YWJcbiAgICAgICAgICAgIChjaCA9PT0gMHhCKSB8fFxuICAgICAgICAgICAgKGNoID09PSAweEMpIHx8XG4gICAgICAgICAgICAoY2ggPT09IDB4QTApIHx8XG4gICAgICAgICAgICAoY2ggPj0gMHgxNjgwICYmICdcXHUxNjgwXFx1MTgwRVxcdTIwMDBcXHUyMDAxXFx1MjAwMlxcdTIwMDNcXHUyMDA0XFx1MjAwNVxcdTIwMDZcXHUyMDA3XFx1MjAwOFxcdTIwMDlcXHUyMDBBXFx1MjAyRlxcdTIwNUZcXHUzMDAwXFx1RkVGRicuaW5kZXhPZihTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKSkgPiAwKTtcbiAgICB9XG5cbiAgICAvLyA3LjMgTGluZSBUZXJtaW5hdG9yc1xuXG4gICAgZnVuY3Rpb24gaXNMaW5lVGVybWluYXRvcihjaCkge1xuICAgICAgICByZXR1cm4gKGNoID09PSAxMCkgfHwgKGNoID09PSAxMykgfHwgKGNoID09PSAweDIwMjgpIHx8IChjaCA9PT0gMHgyMDI5KTtcbiAgICB9XG5cbiAgICAvLyA3LjYgSWRlbnRpZmllciBOYW1lcyBhbmQgSWRlbnRpZmllcnNcblxuICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllclN0YXJ0KGNoKSB7XG4gICAgICAgIHJldHVybiAoY2ggPT09IDM2KSB8fCAoY2ggPT09IDk1KSB8fCAgLy8gJCAoZG9sbGFyKSBhbmQgXyAodW5kZXJzY29yZSlcbiAgICAgICAgICAgIChjaCA+PSA2NSAmJiBjaCA8PSA5MCkgfHwgICAgICAgICAvLyBBLi5aXG4gICAgICAgICAgICAoY2ggPj0gOTcgJiYgY2ggPD0gMTIyKTsgICAgICAgICAgLy8gYS4uelxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllclBhcnQoY2gpIHtcbiAgICAgICAgcmV0dXJuIChjaCA9PT0gMzYpIHx8IChjaCA9PT0gOTUpIHx8ICAvLyAkIChkb2xsYXIpIGFuZCBfICh1bmRlcnNjb3JlKVxuICAgICAgICAgICAgKGNoID49IDY1ICYmIGNoIDw9IDkwKSB8fCAgICAgICAgIC8vIEEuLlpcbiAgICAgICAgICAgIChjaCA+PSA5NyAmJiBjaCA8PSAxMjIpIHx8ICAgICAgICAvLyBhLi56XG4gICAgICAgICAgICAoY2ggPj0gNDggJiYgY2ggPD0gNTcpOyAgICAgICAgICAgLy8gMC4uOVxuICAgIH1cblxuICAgIC8vIDcuNi4xLjEgS2V5d29yZHNcblxuICAgIGZ1bmN0aW9uIGlzS2V5d29yZChpZCkge1xuICAgICAgICByZXR1cm4gKGlkID09PSAndGhpcycpXG4gICAgfVxuXG4gICAgLy8gNy40IENvbW1lbnRzXG5cbiAgICBmdW5jdGlvbiBza2lwV2hpdGVzcGFjZSgpIHtcbiAgICAgICAgd2hpbGUgKGluZGV4IDwgbGVuZ3RoICYmIGlzV2hpdGVTcGFjZShzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICArK2luZGV4O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0SWRlbnRpZmllcigpIHtcbiAgICAgICAgdmFyIHN0YXJ0LCBjaDtcblxuICAgICAgICBzdGFydCA9IGluZGV4Kys7XG4gICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgY2ggPSBzb3VyY2UuY2hhckNvZGVBdChpbmRleCk7XG4gICAgICAgICAgICBpZiAoaXNJZGVudGlmaWVyUGFydChjaCkpIHtcbiAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzb3VyY2Uuc2xpY2Uoc3RhcnQsIGluZGV4KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzY2FuSWRlbnRpZmllcigpIHtcbiAgICAgICAgdmFyIHN0YXJ0LCBpZCwgdHlwZTtcblxuICAgICAgICBzdGFydCA9IGluZGV4O1xuXG4gICAgICAgIGlkID0gZ2V0SWRlbnRpZmllcigpO1xuXG4gICAgICAgIC8vIFRoZXJlIGlzIG5vIGtleXdvcmQgb3IgbGl0ZXJhbCB3aXRoIG9ubHkgb25lIGNoYXJhY3Rlci5cbiAgICAgICAgLy8gVGh1cywgaXQgbXVzdCBiZSBhbiBpZGVudGlmaWVyLlxuICAgICAgICBpZiAoaWQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uSWRlbnRpZmllcjtcbiAgICAgICAgfSBlbHNlIGlmIChpc0tleXdvcmQoaWQpKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uS2V5d29yZDtcbiAgICAgICAgfSBlbHNlIGlmIChpZCA9PT0gJ251bGwnKSB7XG4gICAgICAgICAgICB0eXBlID0gVG9rZW4uTnVsbExpdGVyYWw7XG4gICAgICAgIH0gZWxzZSBpZiAoaWQgPT09ICd0cnVlJyB8fCBpZCA9PT0gJ2ZhbHNlJykge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLkJvb2xlYW5MaXRlcmFsO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHlwZSA9IFRva2VuLklkZW50aWZpZXI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIHZhbHVlOiBpZCxcbiAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICB9O1xuICAgIH1cblxuXG4gICAgLy8gNy43IFB1bmN0dWF0b3JzXG5cbiAgICBmdW5jdGlvbiBzY2FuUHVuY3R1YXRvcigpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gaW5kZXgsXG4gICAgICAgICAgICBjb2RlID0gc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpLFxuICAgICAgICAgICAgY29kZTIsXG4gICAgICAgICAgICBjaDEgPSBzb3VyY2VbaW5kZXhdLFxuICAgICAgICAgICAgY2gyO1xuXG4gICAgICAgIHN3aXRjaCAoY29kZSkge1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgbW9zdCBjb21tb24gc2luZ2xlLWNoYXJhY3RlciBwdW5jdHVhdG9ycy5cbiAgICAgICAgICAgIGNhc2UgNDY6ICAgLy8gLiBkb3RcbiAgICAgICAgICAgIGNhc2UgNDA6ICAgLy8gKCBvcGVuIGJyYWNrZXRcbiAgICAgICAgICAgIGNhc2UgNDE6ICAgLy8gKSBjbG9zZSBicmFja2V0XG4gICAgICAgICAgICBjYXNlIDU5OiAgIC8vIDsgc2VtaWNvbG9uXG4gICAgICAgICAgICBjYXNlIDQ0OiAgIC8vICwgY29tbWFcbiAgICAgICAgICAgIGNhc2UgMTIzOiAgLy8geyBvcGVuIGN1cmx5IGJyYWNlXG4gICAgICAgICAgICBjYXNlIDEyNTogIC8vIH0gY2xvc2UgY3VybHkgYnJhY2VcbiAgICAgICAgICAgIGNhc2UgOTE6ICAgLy8gW1xuICAgICAgICAgICAgY2FzZSA5MzogICAvLyBdXG4gICAgICAgICAgICBjYXNlIDU4OiAgIC8vIDpcbiAgICAgICAgICAgIGNhc2UgNjM6ICAgLy8gP1xuICAgICAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSksXG4gICAgICAgICAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY29kZTIgPSBzb3VyY2UuY2hhckNvZGVBdChpbmRleCArIDEpO1xuXG4gICAgICAgICAgICAgICAgLy8gJz0nIChjaGFyICM2MSkgbWFya3MgYW4gYXNzaWdubWVudCBvciBjb21wYXJpc29uIG9wZXJhdG9yLlxuICAgICAgICAgICAgICAgIGlmIChjb2RlMiA9PT0gNjEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM3OiAgLy8gJVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzODogIC8vICZcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDI6ICAvLyAqOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0MzogIC8vICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDU6ICAvLyAtXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ3OiAgLy8gL1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2MDogIC8vIDxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjI6ICAvLyA+XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEyNDogLy8gfFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogVG9rZW4uUHVuY3R1YXRvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUyKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzMzogLy8gIVxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA2MTogLy8gPVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ICs9IDI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAhPT0gYW5kID09PVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkgPT09IDYxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICsraW5kZXg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLlB1bmN0dWF0b3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBzb3VyY2Uuc2xpY2Uoc3RhcnQsIGluZGV4KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQZWVrIG1vcmUgY2hhcmFjdGVycy5cblxuICAgICAgICBjaDIgPSBzb3VyY2VbaW5kZXggKyAxXTtcblxuICAgICAgICAvLyBPdGhlciAyLWNoYXJhY3RlciBwdW5jdHVhdG9yczogJiYgfHxcblxuICAgICAgICBpZiAoY2gxID09PSBjaDIgJiYgKCcmfCcuaW5kZXhPZihjaDEpID49IDApKSB7XG4gICAgICAgICAgICBpbmRleCArPSAyO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBjaDEgKyBjaDIsXG4gICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCc8Pj0hKy0qJSZ8Xi8nLmluZGV4T2YoY2gxKSA+PSAwKSB7XG4gICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0eXBlOiBUb2tlbi5QdW5jdHVhdG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBjaDEsXG4gICAgICAgICAgICAgICAgcmFuZ2U6IFtzdGFydCwgaW5kZXhdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgIH1cblxuICAgIC8vIDcuOC4zIE51bWVyaWMgTGl0ZXJhbHNcbiAgICBmdW5jdGlvbiBzY2FuTnVtZXJpY0xpdGVyYWwoKSB7XG4gICAgICAgIHZhciBudW1iZXIsIHN0YXJ0LCBjaDtcblxuICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgIGFzc2VydChpc0RlY2ltYWxEaWdpdChjaC5jaGFyQ29kZUF0KDApKSB8fCAoY2ggPT09ICcuJyksXG4gICAgICAgICAgICAnTnVtZXJpYyBsaXRlcmFsIG11c3Qgc3RhcnQgd2l0aCBhIGRlY2ltYWwgZGlnaXQgb3IgYSBkZWNpbWFsIHBvaW50Jyk7XG5cbiAgICAgICAgc3RhcnQgPSBpbmRleDtcbiAgICAgICAgbnVtYmVyID0gJyc7XG4gICAgICAgIGlmIChjaCAhPT0gJy4nKSB7XG4gICAgICAgICAgICBudW1iZXIgPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICBjaCA9IHNvdXJjZVtpbmRleF07XG5cbiAgICAgICAgICAgIC8vIEhleCBudW1iZXIgc3RhcnRzIHdpdGggJzB4Jy5cbiAgICAgICAgICAgIC8vIE9jdGFsIG51bWJlciBzdGFydHMgd2l0aCAnMCcuXG4gICAgICAgICAgICBpZiAobnVtYmVyID09PSAnMCcpIHtcbiAgICAgICAgICAgICAgICAvLyBkZWNpbWFsIG51bWJlciBzdGFydHMgd2l0aCAnMCcgc3VjaCBhcyAnMDknIGlzIGlsbGVnYWwuXG4gICAgICAgICAgICAgICAgaWYgKGNoICYmIGlzRGVjaW1hbERpZ2l0KGNoLmNoYXJDb2RlQXQoMCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoID0gc291cmNlW2luZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChjaCA9PT0gJy4nKSB7XG4gICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgd2hpbGUgKGlzRGVjaW1hbERpZ2l0KHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KSkpIHtcbiAgICAgICAgICAgICAgICBudW1iZXIgKz0gc291cmNlW2luZGV4KytdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGNoID09PSAnZScgfHwgY2ggPT09ICdFJykge1xuICAgICAgICAgICAgbnVtYmVyICs9IHNvdXJjZVtpbmRleCsrXTtcblxuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXhdO1xuICAgICAgICAgICAgaWYgKGNoID09PSAnKycgfHwgY2ggPT09ICctJykge1xuICAgICAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaXNEZWNpbWFsRGlnaXQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgICAgIHdoaWxlIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkpKSB7XG4gICAgICAgICAgICAgICAgICAgIG51bWJlciArPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvd0Vycm9yKHt9LCBNZXNzYWdlcy5VbmV4cGVjdGVkVG9rZW4sICdJTExFR0FMJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNJZGVudGlmaWVyU3RhcnQoc291cmNlLmNoYXJDb2RlQXQoaW5kZXgpKSkge1xuICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuLCAnSUxMRUdBTCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHR5cGU6IFRva2VuLk51bWVyaWNMaXRlcmFsLFxuICAgICAgICAgICAgdmFsdWU6IHBhcnNlRmxvYXQobnVtYmVyKSxcbiAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vIDcuOC40IFN0cmluZyBMaXRlcmFsc1xuXG4gICAgZnVuY3Rpb24gc2NhblN0cmluZ0xpdGVyYWwoKSB7XG4gICAgICAgIHZhciBzdHIgPSAnJywgcXVvdGUsIHN0YXJ0LCBjaCwgb2N0YWwgPSBmYWxzZTtcblxuICAgICAgICBxdW90ZSA9IHNvdXJjZVtpbmRleF07XG4gICAgICAgIGFzc2VydCgocXVvdGUgPT09ICdcXCcnIHx8IHF1b3RlID09PSAnXCInKSxcbiAgICAgICAgICAgICdTdHJpbmcgbGl0ZXJhbCBtdXN0IHN0YXJ0cyB3aXRoIGEgcXVvdGUnKTtcblxuICAgICAgICBzdGFydCA9IGluZGV4O1xuICAgICAgICArK2luZGV4O1xuXG4gICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXgrK107XG5cbiAgICAgICAgICAgIGlmIChjaCA9PT0gcXVvdGUpIHtcbiAgICAgICAgICAgICAgICBxdW90ZSA9ICcnO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjaCA9PT0gJ1xcXFwnKSB7XG4gICAgICAgICAgICAgICAgY2ggPSBzb3VyY2VbaW5kZXgrK107XG4gICAgICAgICAgICAgICAgaWYgKCFjaCB8fCAhaXNMaW5lVGVybWluYXRvcihjaC5jaGFyQ29kZUF0KDApKSkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICduJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcbic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xccic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcdCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdiJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcYic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdmJzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xcZic7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd2JzpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gJ1xceDBCJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gY2g7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2ggPT09ICdcXHInICYmIHNvdXJjZVtpbmRleF0gPT09ICdcXG4nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICArK2luZGV4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChpc0xpbmVUZXJtaW5hdG9yKGNoLmNoYXJDb2RlQXQoMCkpKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0ciArPSBjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdW90ZSAhPT0gJycpIHtcbiAgICAgICAgICAgIHRocm93RXJyb3Ioe30sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgJ0lMTEVHQUwnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0eXBlOiBUb2tlbi5TdHJpbmdMaXRlcmFsLFxuICAgICAgICAgICAgdmFsdWU6IHN0cixcbiAgICAgICAgICAgIG9jdGFsOiBvY3RhbCxcbiAgICAgICAgICAgIHJhbmdlOiBbc3RhcnQsIGluZGV4XVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGlzSWRlbnRpZmllck5hbWUodG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIHRva2VuLnR5cGUgPT09IFRva2VuLklkZW50aWZpZXIgfHxcbiAgICAgICAgICAgIHRva2VuLnR5cGUgPT09IFRva2VuLktleXdvcmQgfHxcbiAgICAgICAgICAgIHRva2VuLnR5cGUgPT09IFRva2VuLkJvb2xlYW5MaXRlcmFsIHx8XG4gICAgICAgICAgICB0b2tlbi50eXBlID09PSBUb2tlbi5OdWxsTGl0ZXJhbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhZHZhbmNlKCkge1xuICAgICAgICB2YXIgY2g7XG5cbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcblxuICAgICAgICBpZiAoaW5kZXggPj0gbGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHR5cGU6IFRva2VuLkVPRixcbiAgICAgICAgICAgICAgICByYW5nZTogW2luZGV4LCBpbmRleF1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjaCA9IHNvdXJjZS5jaGFyQ29kZUF0KGluZGV4KTtcblxuICAgICAgICAvLyBWZXJ5IGNvbW1vbjogKCBhbmQgKSBhbmQgO1xuICAgICAgICBpZiAoY2ggPT09IDQwIHx8IGNoID09PSA0MSB8fCBjaCA9PT0gNTgpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FuUHVuY3R1YXRvcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3RyaW5nIGxpdGVyYWwgc3RhcnRzIHdpdGggc2luZ2xlIHF1b3RlICgjMzkpIG9yIGRvdWJsZSBxdW90ZSAoIzM0KS5cbiAgICAgICAgaWYgKGNoID09PSAzOSB8fCBjaCA9PT0gMzQpIHtcbiAgICAgICAgICAgIHJldHVybiBzY2FuU3RyaW5nTGl0ZXJhbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzSWRlbnRpZmllclN0YXJ0KGNoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYW5JZGVudGlmaWVyKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEb3QgKC4pIGNoYXIgIzQ2IGNhbiBhbHNvIHN0YXJ0IGEgZmxvYXRpbmctcG9pbnQgbnVtYmVyLCBoZW5jZSB0aGUgbmVlZFxuICAgICAgICAvLyB0byBjaGVjayB0aGUgbmV4dCBjaGFyYWN0ZXIuXG4gICAgICAgIGlmIChjaCA9PT0gNDYpIHtcbiAgICAgICAgICAgIGlmIChpc0RlY2ltYWxEaWdpdChzb3VyY2UuY2hhckNvZGVBdChpbmRleCArIDEpKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzY2FuTnVtZXJpY0xpdGVyYWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzY2FuUHVuY3R1YXRvcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzRGVjaW1hbERpZ2l0KGNoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHNjYW5OdW1lcmljTGl0ZXJhbCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNjYW5QdW5jdHVhdG9yKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGV4KCkge1xuICAgICAgICB2YXIgdG9rZW47XG5cbiAgICAgICAgdG9rZW4gPSBsb29rYWhlYWQ7XG4gICAgICAgIGluZGV4ID0gdG9rZW4ucmFuZ2VbMV07XG5cbiAgICAgICAgbG9va2FoZWFkID0gYWR2YW5jZSgpO1xuXG4gICAgICAgIGluZGV4ID0gdG9rZW4ucmFuZ2VbMV07XG5cbiAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBlZWsoKSB7XG4gICAgICAgIHZhciBwb3M7XG5cbiAgICAgICAgcG9zID0gaW5kZXg7XG4gICAgICAgIGxvb2thaGVhZCA9IGFkdmFuY2UoKTtcbiAgICAgICAgaW5kZXggPSBwb3M7XG4gICAgfVxuXG4gICAgLy8gVGhyb3cgYW4gZXhjZXB0aW9uXG5cbiAgICBmdW5jdGlvbiB0aHJvd0Vycm9yKHRva2VuLCBtZXNzYWdlRm9ybWF0KSB7XG4gICAgICAgIHZhciBlcnJvcixcbiAgICAgICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDIpLFxuICAgICAgICAgICAgbXNnID0gbWVzc2FnZUZvcm1hdC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgIC8lKFxcZCkvZyxcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAod2hvbGUsIGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2VydChpbmRleCA8IGFyZ3MubGVuZ3RoLCAnTWVzc2FnZSByZWZlcmVuY2UgbXVzdCBiZSBpbiByYW5nZScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJnc1tpbmRleF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBlcnJvciA9IG5ldyBFcnJvcihtc2cpO1xuICAgICAgICBlcnJvci5pbmRleCA9IGluZGV4O1xuICAgICAgICBlcnJvci5kZXNjcmlwdGlvbiA9IG1zZztcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuXG4gICAgLy8gVGhyb3cgYW4gZXhjZXB0aW9uIGJlY2F1c2Ugb2YgdGhlIHRva2VuLlxuXG4gICAgZnVuY3Rpb24gdGhyb3dVbmV4cGVjdGVkKHRva2VuKSB7XG4gICAgICAgIHRocm93RXJyb3IodG9rZW4sIE1lc3NhZ2VzLlVuZXhwZWN0ZWRUb2tlbiwgdG9rZW4udmFsdWUpO1xuICAgIH1cblxuICAgIC8vIEV4cGVjdCB0aGUgbmV4dCB0b2tlbiB0byBtYXRjaCB0aGUgc3BlY2lmaWVkIHB1bmN0dWF0b3IuXG4gICAgLy8gSWYgbm90LCBhbiBleGNlcHRpb24gd2lsbCBiZSB0aHJvd24uXG5cbiAgICBmdW5jdGlvbiBleHBlY3QodmFsdWUpIHtcbiAgICAgICAgdmFyIHRva2VuID0gbGV4KCk7XG4gICAgICAgIGlmICh0b2tlbi50eXBlICE9PSBUb2tlbi5QdW5jdHVhdG9yIHx8IHRva2VuLnZhbHVlICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgdGhyb3dVbmV4cGVjdGVkKHRva2VuKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFJldHVybiB0cnVlIGlmIHRoZSBuZXh0IHRva2VuIG1hdGNoZXMgdGhlIHNwZWNpZmllZCBwdW5jdHVhdG9yLlxuXG4gICAgZnVuY3Rpb24gbWF0Y2godmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGxvb2thaGVhZC50eXBlID09PSBUb2tlbi5QdW5jdHVhdG9yICYmIGxvb2thaGVhZC52YWx1ZSA9PT0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIHRydWUgaWYgdGhlIG5leHQgdG9rZW4gbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIGtleXdvcmRcblxuICAgIGZ1bmN0aW9uIG1hdGNoS2V5d29yZChrZXl3b3JkKSB7XG4gICAgICAgIHJldHVybiBsb29rYWhlYWQudHlwZSA9PT0gVG9rZW4uS2V5d29yZCAmJiBsb29rYWhlYWQudmFsdWUgPT09IGtleXdvcmQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29uc3VtZVNlbWljb2xvbigpIHtcbiAgICAgICAgLy8gQ2F0Y2ggdGhlIHZlcnkgY29tbW9uIGNhc2UgZmlyc3Q6IGltbWVkaWF0ZWx5IGEgc2VtaWNvbG9uIChjaGFyICM1OSkuXG4gICAgICAgIGlmIChzb3VyY2UuY2hhckNvZGVBdChpbmRleCkgPT09IDU5KSB7XG4gICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHNraXBXaGl0ZXNwYWNlKCk7XG5cbiAgICAgICAgaWYgKG1hdGNoKCc7JykpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5FT0YgJiYgIW1hdGNoKCd9JykpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZChsb29rYWhlYWQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gMTEuMS40IEFycmF5IEluaXRpYWxpc2VyXG5cbiAgICBmdW5jdGlvbiBwYXJzZUFycmF5SW5pdGlhbGlzZXIoKSB7XG4gICAgICAgIHZhciBlbGVtZW50cyA9IFtdO1xuXG4gICAgICAgIGV4cGVjdCgnWycpO1xuXG4gICAgICAgIHdoaWxlICghbWF0Y2goJ10nKSkge1xuICAgICAgICAgICAgaWYgKG1hdGNoKCcsJykpIHtcbiAgICAgICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5wdXNoKG51bGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50cy5wdXNoKHBhcnNlRXhwcmVzc2lvbigpKTtcblxuICAgICAgICAgICAgICAgIGlmICghbWF0Y2goJ10nKSkge1xuICAgICAgICAgICAgICAgICAgICBleHBlY3QoJywnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBleHBlY3QoJ10nKTtcblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlQXJyYXlFeHByZXNzaW9uKGVsZW1lbnRzKTtcbiAgICB9XG5cbiAgICAvLyAxMS4xLjUgT2JqZWN0IEluaXRpYWxpc2VyXG5cbiAgICBmdW5jdGlvbiBwYXJzZU9iamVjdFByb3BlcnR5S2V5KCkge1xuICAgICAgICB2YXIgdG9rZW47XG5cbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcbiAgICAgICAgdG9rZW4gPSBsZXgoKTtcblxuICAgICAgICAvLyBOb3RlOiBUaGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBvbmx5IGZyb20gcGFyc2VPYmplY3RQcm9wZXJ0eSgpLCB3aGVyZVxuICAgICAgICAvLyBFT0YgYW5kIFB1bmN0dWF0b3IgdG9rZW5zIGFyZSBhbHJlYWR5IGZpbHRlcmVkIG91dC5cbiAgICAgICAgaWYgKHRva2VuLnR5cGUgPT09IFRva2VuLlN0cmluZ0xpdGVyYWwgfHwgdG9rZW4udHlwZSA9PT0gVG9rZW4uTnVtZXJpY0xpdGVyYWwpIHtcbiAgICAgICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVMaXRlcmFsKHRva2VuKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZS5jcmVhdGVJZGVudGlmaWVyKHRva2VuLnZhbHVlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZU9iamVjdFByb3BlcnR5KCkge1xuICAgICAgICB2YXIgdG9rZW4sIGtleTtcblxuICAgICAgICB0b2tlbiA9IGxvb2thaGVhZDtcbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcblxuICAgICAgICBpZiAodG9rZW4udHlwZSA9PT0gVG9rZW4uRU9GIHx8IHRva2VuLnR5cGUgPT09IFRva2VuLlB1bmN0dWF0b3IpIHtcbiAgICAgICAgICAgIHRocm93VW5leHBlY3RlZCh0b2tlbik7XG4gICAgICAgIH1cblxuICAgICAgICBrZXkgPSBwYXJzZU9iamVjdFByb3BlcnR5S2V5KCk7XG4gICAgICAgIGV4cGVjdCgnOicpO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlUHJvcGVydHkoJ2luaXQnLCBrZXksIHBhcnNlRXhwcmVzc2lvbigpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZU9iamVjdEluaXRpYWxpc2VyKCkge1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IFtdO1xuXG4gICAgICAgIGV4cGVjdCgneycpO1xuXG4gICAgICAgIHdoaWxlICghbWF0Y2goJ30nKSkge1xuICAgICAgICAgICAgcHJvcGVydGllcy5wdXNoKHBhcnNlT2JqZWN0UHJvcGVydHkoKSk7XG5cbiAgICAgICAgICAgIGlmICghbWF0Y2goJ30nKSkge1xuICAgICAgICAgICAgICAgIGV4cGVjdCgnLCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwZWN0KCd9Jyk7XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZU9iamVjdEV4cHJlc3Npb24ocHJvcGVydGllcyk7XG4gICAgfVxuXG4gICAgLy8gMTEuMS42IFRoZSBHcm91cGluZyBPcGVyYXRvclxuXG4gICAgZnVuY3Rpb24gcGFyc2VHcm91cEV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciBleHByO1xuXG4gICAgICAgIGV4cGVjdCgnKCcpO1xuXG4gICAgICAgIGV4cHIgPSBwYXJzZUV4cHJlc3Npb24oKTtcblxuICAgICAgICBleHBlY3QoJyknKTtcblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cblxuICAgIC8vIDExLjEgUHJpbWFyeSBFeHByZXNzaW9uc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VQcmltYXJ5RXhwcmVzc2lvbigpIHtcbiAgICAgICAgdmFyIHR5cGUsIHRva2VuLCBleHByO1xuXG4gICAgICAgIGlmIChtYXRjaCgnKCcpKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VHcm91cEV4cHJlc3Npb24oKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHR5cGUgPSBsb29rYWhlYWQudHlwZTtcblxuICAgICAgICBpZiAodHlwZSA9PT0gVG9rZW4uSWRlbnRpZmllcikge1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUlkZW50aWZpZXIobGV4KCkudmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFRva2VuLlN0cmluZ0xpdGVyYWwgfHwgdHlwZSA9PT0gVG9rZW4uTnVtZXJpY0xpdGVyYWwpIHtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVMaXRlcmFsKGxleCgpKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBUb2tlbi5LZXl3b3JkKSB7XG4gICAgICAgICAgICBpZiAobWF0Y2hLZXl3b3JkKCd0aGlzJykpIHtcbiAgICAgICAgICAgICAgICBsZXgoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlVGhpc0V4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBUb2tlbi5Cb29sZWFuTGl0ZXJhbCkge1xuICAgICAgICAgICAgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgICAgIHRva2VuLnZhbHVlID0gKHRva2VuLnZhbHVlID09PSAndHJ1ZScpO1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUxpdGVyYWwodG9rZW4pO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFRva2VuLk51bGxMaXRlcmFsKSB7XG4gICAgICAgICAgICB0b2tlbiA9IGxleCgpO1xuICAgICAgICAgICAgdG9rZW4udmFsdWUgPSBudWxsO1xuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUxpdGVyYWwodG9rZW4pO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoKCdbJykpIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZUFycmF5SW5pdGlhbGlzZXIoKTtcbiAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgneycpKSB7XG4gICAgICAgICAgICBleHByID0gcGFyc2VPYmplY3RJbml0aWFsaXNlcigpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGV4cHIpIHtcbiAgICAgICAgICAgIHJldHVybiBleHByO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3dVbmV4cGVjdGVkKGxleCgpKTtcbiAgICB9XG5cbiAgICAvLyAxMS4yIExlZnQtSGFuZC1TaWRlIEV4cHJlc3Npb25zXG5cbiAgICBmdW5jdGlvbiBwYXJzZUFyZ3VtZW50cygpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcblxuICAgICAgICBleHBlY3QoJygnKTtcblxuICAgICAgICBpZiAoIW1hdGNoKCcpJykpIHtcbiAgICAgICAgICAgIHdoaWxlIChpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGFyZ3MucHVzaChwYXJzZUV4cHJlc3Npb24oKSk7XG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKCcpJykpIHtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGV4cGVjdCgnLCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZXhwZWN0KCcpJyk7XG5cbiAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VOb25Db21wdXRlZFByb3BlcnR5KCkge1xuICAgICAgICB2YXIgdG9rZW47XG5cbiAgICAgICAgdG9rZW4gPSBsZXgoKTtcblxuICAgICAgICBpZiAoIWlzSWRlbnRpZmllck5hbWUodG9rZW4pKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQodG9rZW4pO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlLmNyZWF0ZUlkZW50aWZpZXIodG9rZW4udmFsdWUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlTm9uQ29tcHV0ZWRNZW1iZXIoKSB7XG4gICAgICAgIGV4cGVjdCgnLicpO1xuXG4gICAgICAgIHJldHVybiBwYXJzZU5vbkNvbXB1dGVkUHJvcGVydHkoKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXJzZUNvbXB1dGVkTWVtYmVyKCkge1xuICAgICAgICB2YXIgZXhwcjtcblxuICAgICAgICBleHBlY3QoJ1snKTtcblxuICAgICAgICBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgZXhwZWN0KCddJyk7XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VMZWZ0SGFuZFNpZGVFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwciwgYXJncywgcHJvcGVydHk7XG5cbiAgICAgICAgZXhwciA9IHBhcnNlUHJpbWFyeUV4cHJlc3Npb24oKTtcblxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xuICAgICAgICAgICAgaWYgKG1hdGNoKCdbJykpIHtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IHBhcnNlQ29tcHV0ZWRNZW1iZXIoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlTWVtYmVyRXhwcmVzc2lvbignWycsIGV4cHIsIHByb3BlcnR5KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJy4nKSkge1xuICAgICAgICAgICAgICAgIHByb3BlcnR5ID0gcGFyc2VOb25Db21wdXRlZE1lbWJlcigpO1xuICAgICAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVNZW1iZXJFeHByZXNzaW9uKCcuJywgZXhwciwgcHJvcGVydHkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaCgnKCcpKSB7XG4gICAgICAgICAgICAgICAgYXJncyA9IHBhcnNlQXJndW1lbnRzKCk7XG4gICAgICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUNhbGxFeHByZXNzaW9uKGV4cHIsIGFyZ3MpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuICAgIC8vIDExLjMgUG9zdGZpeCBFeHByZXNzaW9uc1xuXG4gICAgdmFyIHBhcnNlUG9zdGZpeEV4cHJlc3Npb24gPSBwYXJzZUxlZnRIYW5kU2lkZUV4cHJlc3Npb247XG5cbiAgICAvLyAxMS40IFVuYXJ5IE9wZXJhdG9yc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VVbmFyeUV4cHJlc3Npb24oKSB7XG4gICAgICAgIHZhciB0b2tlbiwgZXhwcjtcblxuICAgICAgICBpZiAobG9va2FoZWFkLnR5cGUgIT09IFRva2VuLlB1bmN0dWF0b3IgJiYgbG9va2FoZWFkLnR5cGUgIT09IFRva2VuLktleXdvcmQpIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZVBvc3RmaXhFeHByZXNzaW9uKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobWF0Y2goJysnKSB8fCBtYXRjaCgnLScpIHx8IG1hdGNoKCchJykpIHtcbiAgICAgICAgICAgIHRva2VuID0gbGV4KCk7XG4gICAgICAgICAgICBleHByID0gcGFyc2VVbmFyeUV4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVVbmFyeUV4cHJlc3Npb24odG9rZW4udmFsdWUsIGV4cHIpO1xuICAgICAgICB9IGVsc2UgaWYgKG1hdGNoS2V5d29yZCgnZGVsZXRlJykgfHwgbWF0Y2hLZXl3b3JkKCd2b2lkJykgfHwgbWF0Y2hLZXl3b3JkKCd0eXBlb2YnKSkge1xuICAgICAgICAgICAgdGhyb3dFcnJvcih7fSwgTWVzc2FnZXMuVW5leHBlY3RlZFRva2VuKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGV4cHIgPSBwYXJzZVBvc3RmaXhFeHByZXNzaW9uKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZXhwcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBiaW5hcnlQcmVjZWRlbmNlKHRva2VuKSB7XG4gICAgICAgIHZhciBwcmVjID0gMDtcblxuICAgICAgICBpZiAodG9rZW4udHlwZSAhPT0gVG9rZW4uUHVuY3R1YXRvciAmJiB0b2tlbi50eXBlICE9PSBUb2tlbi5LZXl3b3JkKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAodG9rZW4udmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgJ3x8JzpcbiAgICAgICAgICAgICAgICBwcmVjID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnJiYnOlxuICAgICAgICAgICAgICAgIHByZWMgPSAyO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICc9PSc6XG4gICAgICAgICAgICBjYXNlICchPSc6XG4gICAgICAgICAgICBjYXNlICc9PT0nOlxuICAgICAgICAgICAgY2FzZSAnIT09JzpcbiAgICAgICAgICAgICAgICBwcmVjID0gNjtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAnPCc6XG4gICAgICAgICAgICBjYXNlICc+JzpcbiAgICAgICAgICAgIGNhc2UgJzw9JzpcbiAgICAgICAgICAgIGNhc2UgJz49JzpcbiAgICAgICAgICAgIGNhc2UgJ2luc3RhbmNlb2YnOlxuICAgICAgICAgICAgICAgIHByZWMgPSA3O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlICdpbic6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJysnOlxuICAgICAgICAgICAgY2FzZSAnLSc6XG4gICAgICAgICAgICAgICAgcHJlYyA9IDk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgJyonOlxuICAgICAgICAgICAgY2FzZSAnLyc6XG4gICAgICAgICAgICBjYXNlICclJzpcbiAgICAgICAgICAgICAgICBwcmVjID0gMTE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcHJlYztcbiAgICB9XG5cbiAgICAvLyAxMS41IE11bHRpcGxpY2F0aXZlIE9wZXJhdG9yc1xuICAgIC8vIDExLjYgQWRkaXRpdmUgT3BlcmF0b3JzXG4gICAgLy8gMTEuNyBCaXR3aXNlIFNoaWZ0IE9wZXJhdG9yc1xuICAgIC8vIDExLjggUmVsYXRpb25hbCBPcGVyYXRvcnNcbiAgICAvLyAxMS45IEVxdWFsaXR5IE9wZXJhdG9yc1xuICAgIC8vIDExLjEwIEJpbmFyeSBCaXR3aXNlIE9wZXJhdG9yc1xuICAgIC8vIDExLjExIEJpbmFyeSBMb2dpY2FsIE9wZXJhdG9yc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VCaW5hcnlFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwciwgdG9rZW4sIHByZWMsIHN0YWNrLCByaWdodCwgb3BlcmF0b3IsIGxlZnQsIGk7XG5cbiAgICAgICAgbGVmdCA9IHBhcnNlVW5hcnlFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgdG9rZW4gPSBsb29rYWhlYWQ7XG4gICAgICAgIHByZWMgPSBiaW5hcnlQcmVjZWRlbmNlKHRva2VuKTtcbiAgICAgICAgaWYgKHByZWMgPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBsZWZ0O1xuICAgICAgICB9XG4gICAgICAgIHRva2VuLnByZWMgPSBwcmVjO1xuICAgICAgICBsZXgoKTtcblxuICAgICAgICByaWdodCA9IHBhcnNlVW5hcnlFeHByZXNzaW9uKCk7XG5cbiAgICAgICAgc3RhY2sgPSBbbGVmdCwgdG9rZW4sIHJpZ2h0XTtcblxuICAgICAgICB3aGlsZSAoKHByZWMgPSBiaW5hcnlQcmVjZWRlbmNlKGxvb2thaGVhZCkpID4gMCkge1xuXG4gICAgICAgICAgICAvLyBSZWR1Y2U6IG1ha2UgYSBiaW5hcnkgZXhwcmVzc2lvbiBmcm9tIHRoZSB0aHJlZSB0b3Btb3N0IGVudHJpZXMuXG4gICAgICAgICAgICB3aGlsZSAoKHN0YWNrLmxlbmd0aCA+IDIpICYmIChwcmVjIDw9IHN0YWNrW3N0YWNrLmxlbmd0aCAtIDJdLnByZWMpKSB7XG4gICAgICAgICAgICAgICAgcmlnaHQgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICBvcGVyYXRvciA9IHN0YWNrLnBvcCgpLnZhbHVlO1xuICAgICAgICAgICAgICAgIGxlZnQgPSBzdGFjay5wb3AoKTtcbiAgICAgICAgICAgICAgICBleHByID0gZGVsZWdhdGUuY3JlYXRlQmluYXJ5RXhwcmVzc2lvbihvcGVyYXRvciwgbGVmdCwgcmlnaHQpO1xuICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goZXhwcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNoaWZ0LlxuICAgICAgICAgICAgdG9rZW4gPSBsZXgoKTtcbiAgICAgICAgICAgIHRva2VuLnByZWMgPSBwcmVjO1xuICAgICAgICAgICAgc3RhY2sucHVzaCh0b2tlbik7XG4gICAgICAgICAgICBleHByID0gcGFyc2VVbmFyeUV4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIHN0YWNrLnB1c2goZXhwcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaW5hbCByZWR1Y2UgdG8gY2xlYW4tdXAgdGhlIHN0YWNrLlxuICAgICAgICBpID0gc3RhY2subGVuZ3RoIC0gMTtcbiAgICAgICAgZXhwciA9IHN0YWNrW2ldO1xuICAgICAgICB3aGlsZSAoaSA+IDEpIHtcbiAgICAgICAgICAgIGV4cHIgPSBkZWxlZ2F0ZS5jcmVhdGVCaW5hcnlFeHByZXNzaW9uKHN0YWNrW2kgLSAxXS52YWx1ZSwgc3RhY2tbaSAtIDJdLCBleHByKTtcbiAgICAgICAgICAgIGkgLT0gMjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBleHByO1xuICAgIH1cblxuXG4gICAgLy8gMTEuMTIgQ29uZGl0aW9uYWwgT3BlcmF0b3JcblxuICAgIGZ1bmN0aW9uIHBhcnNlQ29uZGl0aW9uYWxFeHByZXNzaW9uKCkge1xuICAgICAgICB2YXIgZXhwciwgY29uc2VxdWVudCwgYWx0ZXJuYXRlO1xuXG4gICAgICAgIGV4cHIgPSBwYXJzZUJpbmFyeUV4cHJlc3Npb24oKTtcblxuICAgICAgICBpZiAobWF0Y2goJz8nKSkge1xuICAgICAgICAgICAgbGV4KCk7XG4gICAgICAgICAgICBjb25zZXF1ZW50ID0gcGFyc2VDb25kaXRpb25hbEV4cHJlc3Npb24oKTtcbiAgICAgICAgICAgIGV4cGVjdCgnOicpO1xuICAgICAgICAgICAgYWx0ZXJuYXRlID0gcGFyc2VDb25kaXRpb25hbEV4cHJlc3Npb24oKTtcblxuICAgICAgICAgICAgZXhwciA9IGRlbGVnYXRlLmNyZWF0ZUNvbmRpdGlvbmFsRXhwcmVzc2lvbihleHByLCBjb25zZXF1ZW50LCBhbHRlcm5hdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGV4cHI7XG4gICAgfVxuXG4gICAgLy8gU2ltcGxpZmljYXRpb24gc2luY2Ugd2UgZG8gbm90IHN1cHBvcnQgQXNzaWdubWVudEV4cHJlc3Npb24uXG4gICAgdmFyIHBhcnNlRXhwcmVzc2lvbiA9IHBhcnNlQ29uZGl0aW9uYWxFeHByZXNzaW9uO1xuXG4gICAgLy8gUG9seW1lciBTeW50YXggZXh0ZW5zaW9uc1xuXG4gICAgLy8gRmlsdGVyIDo6XG4gICAgLy8gICBJZGVudGlmaWVyXG4gICAgLy8gICBJZGVudGlmaWVyIFwiKFwiIFwiKVwiXG4gICAgLy8gICBJZGVudGlmaWVyIFwiKFwiIEZpbHRlckFyZ3VtZW50cyBcIilcIlxuXG4gICAgZnVuY3Rpb24gcGFyc2VGaWx0ZXIoKSB7XG4gICAgICAgIHZhciBpZGVudGlmaWVyLCBhcmdzO1xuXG4gICAgICAgIGlkZW50aWZpZXIgPSBsZXgoKTtcblxuICAgICAgICBpZiAoaWRlbnRpZmllci50eXBlICE9PSBUb2tlbi5JZGVudGlmaWVyKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQoaWRlbnRpZmllcik7XG4gICAgICAgIH1cblxuICAgICAgICBhcmdzID0gbWF0Y2goJygnKSA/IHBhcnNlQXJndW1lbnRzKCkgOiBbXTtcblxuICAgICAgICByZXR1cm4gZGVsZWdhdGUuY3JlYXRlRmlsdGVyKGlkZW50aWZpZXIudmFsdWUsIGFyZ3MpO1xuICAgIH1cblxuICAgIC8vIEZpbHRlcnMgOjpcbiAgICAvLyAgIFwifFwiIEZpbHRlclxuICAgIC8vICAgRmlsdGVycyBcInxcIiBGaWx0ZXJcblxuICAgIGZ1bmN0aW9uIHBhcnNlRmlsdGVycygpIHtcbiAgICAgICAgd2hpbGUgKG1hdGNoKCd8JykpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgcGFyc2VGaWx0ZXIoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIFRvcExldmVsIDo6XG4gICAgLy8gICBMYWJlbGxlZEV4cHJlc3Npb25zXG4gICAgLy8gICBBc0V4cHJlc3Npb25cbiAgICAvLyAgIEluRXhwcmVzc2lvblxuICAgIC8vICAgRmlsdGVyRXhwcmVzc2lvblxuXG4gICAgLy8gQXNFeHByZXNzaW9uIDo6XG4gICAgLy8gICBGaWx0ZXJFeHByZXNzaW9uIGFzIElkZW50aWZpZXJcblxuICAgIC8vIEluRXhwcmVzc2lvbiA6OlxuICAgIC8vICAgSWRlbnRpZmllciwgSWRlbnRpZmllciBpbiBGaWx0ZXJFeHByZXNzaW9uXG4gICAgLy8gICBJZGVudGlmaWVyIGluIEZpbHRlckV4cHJlc3Npb25cblxuICAgIC8vIEZpbHRlckV4cHJlc3Npb24gOjpcbiAgICAvLyAgIEV4cHJlc3Npb25cbiAgICAvLyAgIEV4cHJlc3Npb24gRmlsdGVyc1xuXG4gICAgZnVuY3Rpb24gcGFyc2VUb3BMZXZlbCgpIHtcbiAgICAgICAgc2tpcFdoaXRlc3BhY2UoKTtcbiAgICAgICAgcGVlaygpO1xuXG4gICAgICAgIHZhciBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG4gICAgICAgIGlmIChleHByKSB7XG4gICAgICAgICAgICBpZiAobG9va2FoZWFkLnZhbHVlID09PSAnLCcgfHwgbG9va2FoZWFkLnZhbHVlID09ICdpbicgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgZXhwci50eXBlID09PSBTeW50YXguSWRlbnRpZmllcikge1xuICAgICAgICAgICAgICAgIHBhcnNlSW5FeHByZXNzaW9uKGV4cHIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJzZUZpbHRlcnMoKTtcbiAgICAgICAgICAgICAgICBpZiAobG9va2FoZWFkLnZhbHVlID09PSAnYXMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlQXNFeHByZXNzaW9uKGV4cHIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGVnYXRlLmNyZWF0ZVRvcExldmVsKGV4cHIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChsb29rYWhlYWQudHlwZSAhPT0gVG9rZW4uRU9GKSB7XG4gICAgICAgICAgICB0aHJvd1VuZXhwZWN0ZWQobG9va2FoZWFkKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlQXNFeHByZXNzaW9uKGV4cHIpIHtcbiAgICAgICAgbGV4KCk7ICAvLyBhc1xuICAgICAgICB2YXIgaWRlbnRpZmllciA9IGxleCgpLnZhbHVlO1xuICAgICAgICBkZWxlZ2F0ZS5jcmVhdGVBc0V4cHJlc3Npb24oZXhwciwgaWRlbnRpZmllcik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGFyc2VJbkV4cHJlc3Npb24oaWRlbnRpZmllcikge1xuICAgICAgICB2YXIgaW5kZXhOYW1lO1xuICAgICAgICBpZiAobG9va2FoZWFkLnZhbHVlID09PSAnLCcpIHtcbiAgICAgICAgICAgIGxleCgpO1xuICAgICAgICAgICAgaWYgKGxvb2thaGVhZC50eXBlICE9PSBUb2tlbi5JZGVudGlmaWVyKVxuICAgICAgICAgICAgICAgIHRocm93VW5leHBlY3RlZChsb29rYWhlYWQpO1xuICAgICAgICAgICAgaW5kZXhOYW1lID0gbGV4KCkudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBsZXgoKTsgIC8vIGluXG4gICAgICAgIHZhciBleHByID0gcGFyc2VFeHByZXNzaW9uKCk7XG4gICAgICAgIHBhcnNlRmlsdGVycygpO1xuICAgICAgICBkZWxlZ2F0ZS5jcmVhdGVJbkV4cHJlc3Npb24oaWRlbnRpZmllci5uYW1lLCBpbmRleE5hbWUsIGV4cHIpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhcnNlKGNvZGUsIGluRGVsZWdhdGUpIHtcbiAgICAgICAgZGVsZWdhdGUgPSBpbkRlbGVnYXRlO1xuICAgICAgICBzb3VyY2UgPSBjb2RlO1xuICAgICAgICBpbmRleCA9IDA7XG4gICAgICAgIGxlbmd0aCA9IHNvdXJjZS5sZW5ndGg7XG4gICAgICAgIGxvb2thaGVhZCA9IG51bGw7XG4gICAgICAgIHN0YXRlID0ge1xuICAgICAgICAgICAgbGFiZWxTZXQ6IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHBhcnNlVG9wTGV2ZWwoKTtcbiAgICB9XG5cbiAgICBnbG9iYWwuZXNwcmltYSA9IHtcbiAgICAgICAgcGFyc2U6IHBhcnNlXG4gICAgfTtcbn0pKG1vZHVsZS5leHBvcnRzKTsiLCLvu78vKlxuICogQ29weXJpZ2h0IChjKSAyMDE0IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG5cbid1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gZGV0ZWN0RXZhbCgpIHtcbiAgICAvLyBEb24ndCB0ZXN0IGZvciBldmFsIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSBDaHJvbWUgQXBwIGVudmlyb25tZW50LlxuICAgIC8vIFdlIGNoZWNrIGZvciBBUElzIHNldCB0aGF0IG9ubHkgZXhpc3QgaW4gYSBDaHJvbWUgQXBwIGNvbnRleHQuXG4gICAgaWYgKHR5cGVvZiBjaHJvbWUgIT09ICd1bmRlZmluZWQnICYmIGNocm9tZS5hcHAgJiYgY2hyb21lLmFwcC5ydW50aW1lKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBGaXJlZm94IE9TIEFwcHMgZG8gbm90IGFsbG93IGV2YWwuIFRoaXMgZmVhdHVyZSBkZXRlY3Rpb24gaXMgdmVyeSBoYWNreVxuICAgIC8vIGJ1dCBldmVuIGlmIHNvbWUgb3RoZXIgcGxhdGZvcm0gYWRkcyBzdXBwb3J0IGZvciB0aGlzIGZ1bmN0aW9uIHRoaXMgY29kZVxuICAgIC8vIHdpbGwgY29udGludWUgdG8gd29yay5cbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IuZ2V0RGV2aWNlU3RvcmFnZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgICAgdmFyIGYgPSBuZXcgRnVuY3Rpb24oJycsICdyZXR1cm4gdHJ1ZTsnKTtcbiAgICAgICAgcmV0dXJuIGYoKTtcbiAgICB9IGNhdGNoIChleCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG52YXIgaGFzRXZhbCA9IGRldGVjdEV2YWwoKTtcblxuZnVuY3Rpb24gaXNJbmRleChzKSB7XG4gICAgcmV0dXJuICtzID09PSBzID4+PiAwICYmIHMgIT09ICcnO1xufVxuXG5mdW5jdGlvbiB0b051bWJlcihzKSB7XG4gICAgcmV0dXJuICtzO1xufVxuXG5mdW5jdGlvbiBpc09iamVjdChvYmopIHtcbiAgICByZXR1cm4gb2JqID09PSBPYmplY3Qob2JqKTtcbn1cblxudmFyIG51bWJlcklzTmFOID0gTnVtYmVyLmlzTmFOIHx8IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzTmFOKHZhbHVlKTtcbn1cblxuZnVuY3Rpb24gYXJlU2FtZVZhbHVlKGxlZnQsIHJpZ2h0KSB7XG4gICAgaWYgKGxlZnQgPT09IHJpZ2h0KVxuICAgICAgICByZXR1cm4gbGVmdCAhPT0gMCB8fCAxIC8gbGVmdCA9PT0gMSAvIHJpZ2h0O1xuICAgIGlmIChudW1iZXJJc05hTihsZWZ0KSAmJiBudW1iZXJJc05hTihyaWdodCkpXG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgcmV0dXJuIGxlZnQgIT09IGxlZnQgJiYgcmlnaHQgIT09IHJpZ2h0O1xufVxuXG52YXIgY3JlYXRlT2JqZWN0ID0gKCdfX3Byb3RvX18nIGluIHt9KSA/XG4gIGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iajsgfSA6XG4gIGZ1bmN0aW9uIChvYmopIHtcbiAgICAgIHZhciBwcm90byA9IG9iai5fX3Byb3RvX187XG4gICAgICBpZiAoIXByb3RvKVxuICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICB2YXIgbmV3T2JqZWN0ID0gT2JqZWN0LmNyZWF0ZShwcm90byk7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobmV3T2JqZWN0LCBuYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBuYW1lKSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBuZXdPYmplY3Q7XG4gIH07XG5cbnZhciBpZGVudFN0YXJ0ID0gJ1tcXCRfYS16QS1aXSc7XG52YXIgaWRlbnRQYXJ0ID0gJ1tcXCRfYS16QS1aMC05XSc7XG52YXIgaWRlbnRSZWdFeHAgPSBuZXcgUmVnRXhwKCdeJyArIGlkZW50U3RhcnQgKyAnKycgKyBpZGVudFBhcnQgKyAnKicgKyAnJCcpO1xuXG5mdW5jdGlvbiBnZXRQYXRoQ2hhclR5cGUoY2hhcikge1xuICAgIGlmIChjaGFyID09PSB1bmRlZmluZWQpXG4gICAgICAgIHJldHVybiAnZW9mJztcblxuICAgIHZhciBjb2RlID0gY2hhci5jaGFyQ29kZUF0KDApO1xuXG4gICAgc3dpdGNoIChjb2RlKSB7XG4gICAgICAgIGNhc2UgMHg1QjogLy8gW1xuICAgICAgICBjYXNlIDB4NUQ6IC8vIF1cbiAgICAgICAgY2FzZSAweDJFOiAvLyAuXG4gICAgICAgIGNhc2UgMHgyMjogLy8gXCJcbiAgICAgICAgY2FzZSAweDI3OiAvLyAnXG4gICAgICAgIGNhc2UgMHgzMDogLy8gMFxuICAgICAgICAgICAgcmV0dXJuIGNoYXI7XG5cbiAgICAgICAgY2FzZSAweDVGOiAvLyBfXG4gICAgICAgIGNhc2UgMHgyNDogLy8gJFxuICAgICAgICAgICAgcmV0dXJuICdpZGVudCc7XG5cbiAgICAgICAgY2FzZSAweDIwOiAvLyBTcGFjZVxuICAgICAgICBjYXNlIDB4MDk6IC8vIFRhYlxuICAgICAgICBjYXNlIDB4MEE6IC8vIE5ld2xpbmVcbiAgICAgICAgY2FzZSAweDBEOiAvLyBSZXR1cm5cbiAgICAgICAgY2FzZSAweEEwOiAgLy8gTm8tYnJlYWsgc3BhY2VcbiAgICAgICAgY2FzZSAweEZFRkY6ICAvLyBCeXRlIE9yZGVyIE1hcmtcbiAgICAgICAgY2FzZSAweDIwMjg6ICAvLyBMaW5lIFNlcGFyYXRvclxuICAgICAgICBjYXNlIDB4MjAyOTogIC8vIFBhcmFncmFwaCBTZXBhcmF0b3JcbiAgICAgICAgICAgIHJldHVybiAnd3MnO1xuICAgIH1cblxuICAgIC8vIGEteiwgQS1aXG4gICAgaWYgKCgweDYxIDw9IGNvZGUgJiYgY29kZSA8PSAweDdBKSB8fCAoMHg0MSA8PSBjb2RlICYmIGNvZGUgPD0gMHg1QSkpXG4gICAgICAgIHJldHVybiAnaWRlbnQnO1xuXG4gICAgLy8gMS05XG4gICAgaWYgKDB4MzEgPD0gY29kZSAmJiBjb2RlIDw9IDB4MzkpXG4gICAgICAgIHJldHVybiAnbnVtYmVyJztcblxuICAgIHJldHVybiAnZWxzZSc7XG59XG5cbnZhciBwYXRoU3RhdGVNYWNoaW5lID0ge1xuICAgICdiZWZvcmVQYXRoJzoge1xuICAgICAgICAnd3MnOiBbJ2JlZm9yZVBhdGgnXSxcbiAgICAgICAgJ2lkZW50JzogWydpbklkZW50JywgJ2FwcGVuZCddLFxuICAgICAgICAnWyc6IFsnYmVmb3JlRWxlbWVudCddLFxuICAgICAgICAnZW9mJzogWydhZnRlclBhdGgnXVxuICAgIH0sXG5cbiAgICAnaW5QYXRoJzoge1xuICAgICAgICAnd3MnOiBbJ2luUGF0aCddLFxuICAgICAgICAnLic6IFsnYmVmb3JlSWRlbnQnXSxcbiAgICAgICAgJ1snOiBbJ2JlZm9yZUVsZW1lbnQnXSxcbiAgICAgICAgJ2VvZic6IFsnYWZ0ZXJQYXRoJ11cbiAgICB9LFxuXG4gICAgJ2JlZm9yZUlkZW50Jzoge1xuICAgICAgICAnd3MnOiBbJ2JlZm9yZUlkZW50J10sXG4gICAgICAgICdpZGVudCc6IFsnaW5JZGVudCcsICdhcHBlbmQnXVxuICAgIH0sXG5cbiAgICAnaW5JZGVudCc6IHtcbiAgICAgICAgJ2lkZW50JzogWydpbklkZW50JywgJ2FwcGVuZCddLFxuICAgICAgICAnMCc6IFsnaW5JZGVudCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ251bWJlcic6IFsnaW5JZGVudCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ3dzJzogWydpblBhdGgnLCAncHVzaCddLFxuICAgICAgICAnLic6IFsnYmVmb3JlSWRlbnQnLCAncHVzaCddLFxuICAgICAgICAnWyc6IFsnYmVmb3JlRWxlbWVudCcsICdwdXNoJ10sXG4gICAgICAgICdlb2YnOiBbJ2FmdGVyUGF0aCcsICdwdXNoJ11cbiAgICB9LFxuXG4gICAgJ2JlZm9yZUVsZW1lbnQnOiB7XG4gICAgICAgICd3cyc6IFsnYmVmb3JlRWxlbWVudCddLFxuICAgICAgICAnMCc6IFsnYWZ0ZXJaZXJvJywgJ2FwcGVuZCddLFxuICAgICAgICAnbnVtYmVyJzogWydpbkluZGV4JywgJ2FwcGVuZCddLFxuICAgICAgICBcIidcIjogWydpblNpbmdsZVF1b3RlJywgJ2FwcGVuZCcsICcnXSxcbiAgICAgICAgJ1wiJzogWydpbkRvdWJsZVF1b3RlJywgJ2FwcGVuZCcsICcnXVxuICAgIH0sXG5cbiAgICAnYWZ0ZXJaZXJvJzoge1xuICAgICAgICAnd3MnOiBbJ2FmdGVyRWxlbWVudCcsICdwdXNoJ10sXG4gICAgICAgICddJzogWydpblBhdGgnLCAncHVzaCddXG4gICAgfSxcblxuICAgICdpbkluZGV4Jzoge1xuICAgICAgICAnMCc6IFsnaW5JbmRleCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ251bWJlcic6IFsnaW5JbmRleCcsICdhcHBlbmQnXSxcbiAgICAgICAgJ3dzJzogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ10nOiBbJ2luUGF0aCcsICdwdXNoJ11cbiAgICB9LFxuXG4gICAgJ2luU2luZ2xlUXVvdGUnOiB7XG4gICAgICAgIFwiJ1wiOiBbJ2FmdGVyRWxlbWVudCddLFxuICAgICAgICAnZW9mJzogWydlcnJvciddLFxuICAgICAgICAnZWxzZSc6IFsnaW5TaW5nbGVRdW90ZScsICdhcHBlbmQnXVxuICAgIH0sXG5cbiAgICAnaW5Eb3VibGVRdW90ZSc6IHtcbiAgICAgICAgJ1wiJzogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ2VvZic6IFsnZXJyb3InXSxcbiAgICAgICAgJ2Vsc2UnOiBbJ2luRG91YmxlUXVvdGUnLCAnYXBwZW5kJ11cbiAgICB9LFxuXG4gICAgJ2FmdGVyRWxlbWVudCc6IHtcbiAgICAgICAgJ3dzJzogWydhZnRlckVsZW1lbnQnXSxcbiAgICAgICAgJ10nOiBbJ2luUGF0aCcsICdwdXNoJ11cbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5vb3AoKSB7IH1cblxuZnVuY3Rpb24gcGFyc2VQYXRoKHBhdGgpIHtcbiAgICB2YXIga2V5cyA9IFtdO1xuICAgIHZhciBpbmRleCA9IC0xO1xuICAgIHZhciBjLCBuZXdDaGFyLCBrZXksIHR5cGUsIHRyYW5zaXRpb24sIGFjdGlvbiwgdHlwZU1hcCwgbW9kZSA9ICdiZWZvcmVQYXRoJztcblxuICAgIHZhciBhY3Rpb25zID0ge1xuICAgICAgICBwdXNoOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcbiAgICAgICAgICAgIGtleSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSxcblxuICAgICAgICBhcHBlbmQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChrZXkgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBrZXkgPSBuZXdDaGFyXG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAga2V5ICs9IG5ld0NoYXI7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gbWF5YmVVbmVzY2FwZVF1b3RlKCkge1xuICAgICAgICBpZiAoaW5kZXggPj0gcGF0aC5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgdmFyIG5leHRDaGFyID0gcGF0aFtpbmRleCArIDFdO1xuICAgICAgICBpZiAoKG1vZGUgPT0gJ2luU2luZ2xlUXVvdGUnICYmIG5leHRDaGFyID09IFwiJ1wiKSB8fFxuICAgICAgICAgICAgKG1vZGUgPT0gJ2luRG91YmxlUXVvdGUnICYmIG5leHRDaGFyID09ICdcIicpKSB7XG4gICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgbmV3Q2hhciA9IG5leHRDaGFyO1xuICAgICAgICAgICAgYWN0aW9ucy5hcHBlbmQoKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd2hpbGUgKG1vZGUpIHtcbiAgICAgICAgaW5kZXgrKztcbiAgICAgICAgYyA9IHBhdGhbaW5kZXhdO1xuXG4gICAgICAgIGlmIChjID09ICdcXFxcJyAmJiBtYXliZVVuZXNjYXBlUXVvdGUobW9kZSkpXG4gICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICB0eXBlID0gZ2V0UGF0aENoYXJUeXBlKGMpO1xuICAgICAgICB0eXBlTWFwID0gcGF0aFN0YXRlTWFjaGluZVttb2RlXTtcbiAgICAgICAgdHJhbnNpdGlvbiA9IHR5cGVNYXBbdHlwZV0gfHwgdHlwZU1hcFsnZWxzZSddIHx8ICdlcnJvcic7XG5cbiAgICAgICAgaWYgKHRyYW5zaXRpb24gPT0gJ2Vycm9yJylcbiAgICAgICAgICAgIHJldHVybjsgLy8gcGFyc2UgZXJyb3I7XG5cbiAgICAgICAgbW9kZSA9IHRyYW5zaXRpb25bMF07XG4gICAgICAgIGFjdGlvbiA9IGFjdGlvbnNbdHJhbnNpdGlvblsxXV0gfHwgbm9vcDtcbiAgICAgICAgbmV3Q2hhciA9IHRyYW5zaXRpb25bMl0gPT09IHVuZGVmaW5lZCA/IGMgOiB0cmFuc2l0aW9uWzJdO1xuICAgICAgICBhY3Rpb24oKTtcblxuICAgICAgICBpZiAobW9kZSA9PT0gJ2FmdGVyUGF0aCcpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXlzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuOyAvLyBwYXJzZSBlcnJvclxufVxuXG5mdW5jdGlvbiBpc0lkZW50KHMpIHtcbiAgICByZXR1cm4gaWRlbnRSZWdFeHAudGVzdChzKTtcbn1cblxudmFyIGNvbnN0cnVjdG9ySXNQcml2YXRlID0ge307XG5cbmZ1bmN0aW9uIFBhdGgocGFydHMsIHByaXZhdGVUb2tlbikge1xuICAgIGlmIChwcml2YXRlVG9rZW4gIT09IGNvbnN0cnVjdG9ySXNQcml2YXRlKVxuICAgICAgICB0aHJvdyBFcnJvcignVXNlIFBhdGguZ2V0IHRvIHJldHJpZXZlIHBhdGggb2JqZWN0cycpO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnB1c2goU3RyaW5nKHBhcnRzW2ldKSk7XG4gICAgfVxuXG4gICAgaWYgKGhhc0V2YWwgJiYgdGhpcy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy5nZXRWYWx1ZUZyb20gPSB0aGlzLmNvbXBpbGVkR2V0VmFsdWVGcm9tRm4oKTtcbiAgICB9XG59XG5cbi8vIFRPRE8ocmFmYWVsdyk6IE1ha2Ugc2ltcGxlIExSVSBjYWNoZVxudmFyIHBhdGhDYWNoZSA9IHt9O1xuXG5mdW5jdGlvbiBnZXRQYXRoKHBhdGhTdHJpbmcpIHtcbiAgICBpZiAocGF0aFN0cmluZyBpbnN0YW5jZW9mIFBhdGgpXG4gICAgICAgIHJldHVybiBwYXRoU3RyaW5nO1xuXG4gICAgaWYgKHBhdGhTdHJpbmcgPT0gbnVsbCB8fCBwYXRoU3RyaW5nLmxlbmd0aCA9PSAwKVxuICAgICAgICBwYXRoU3RyaW5nID0gJyc7XG5cbiAgICBpZiAodHlwZW9mIHBhdGhTdHJpbmcgIT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKGlzSW5kZXgocGF0aFN0cmluZy5sZW5ndGgpKSB7XG4gICAgICAgICAgICAvLyBDb25zdHJ1Y3RlZCB3aXRoIGFycmF5LWxpa2UgKHByZS1wYXJzZWQpIGtleXNcbiAgICAgICAgICAgIHJldHVybiBuZXcgUGF0aChwYXRoU3RyaW5nLCBjb25zdHJ1Y3RvcklzUHJpdmF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBwYXRoU3RyaW5nID0gU3RyaW5nKHBhdGhTdHJpbmcpO1xuICAgIH1cblxuICAgIHZhciBwYXRoID0gcGF0aENhY2hlW3BhdGhTdHJpbmddO1xuICAgIGlmIChwYXRoKVxuICAgICAgICByZXR1cm4gcGF0aDtcblxuICAgIHZhciBwYXJ0cyA9IHBhcnNlUGF0aChwYXRoU3RyaW5nKTtcbiAgICBpZiAoIXBhcnRzKVxuICAgICAgICByZXR1cm4gaW52YWxpZFBhdGg7XG5cbiAgICB2YXIgcGF0aCA9IG5ldyBQYXRoKHBhcnRzLCBjb25zdHJ1Y3RvcklzUHJpdmF0ZSk7XG4gICAgcGF0aENhY2hlW3BhdGhTdHJpbmddID0gcGF0aDtcbiAgICByZXR1cm4gcGF0aDtcbn1cblxuUGF0aC5nZXQgPSBnZXRQYXRoO1xuXG5mdW5jdGlvbiBmb3JtYXRBY2Nlc3NvcihrZXkpIHtcbiAgICBpZiAoaXNJbmRleChrZXkpKSB7XG4gICAgICAgIHJldHVybiAnWycgKyBrZXkgKyAnXSc7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuICdbXCInICsga2V5LnJlcGxhY2UoL1wiL2csICdcXFxcXCInKSArICdcIl0nO1xuICAgIH1cbn1cblxuUGF0aC5wcm90b3R5cGUgPSBjcmVhdGVPYmplY3Qoe1xuICAgIF9fcHJvdG9fXzogW10sXG4gICAgdmFsaWQ6IHRydWUsXG5cbiAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGF0aFN0cmluZyA9ICcnO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSB0aGlzW2ldO1xuICAgICAgICAgICAgaWYgKGlzSWRlbnQoa2V5KSkge1xuICAgICAgICAgICAgICAgIHBhdGhTdHJpbmcgKz0gaSA/ICcuJyArIGtleSA6IGtleTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGF0aFN0cmluZyArPSBmb3JtYXRBY2Nlc3NvcihrZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBhdGhTdHJpbmc7XG4gICAgfSxcblxuICAgIGdldFZhbHVlRnJvbTogZnVuY3Rpb24gKG9iaiwgZGlyZWN0T2JzZXJ2ZXIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAob2JqID09IG51bGwpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgb2JqID0gb2JqW3RoaXNbaV1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcblxuICAgIGl0ZXJhdGVPYmplY3RzOiBmdW5jdGlvbiAob2JqLCBvYnNlcnZlKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGkpXG4gICAgICAgICAgICAgICAgb2JqID0gb2JqW3RoaXNbaSAtIDFdXTtcbiAgICAgICAgICAgIGlmICghaXNPYmplY3Qob2JqKSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICBvYnNlcnZlKG9iaiwgdGhpc1tpXSk7XG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgY29tcGlsZWRHZXRWYWx1ZUZyb21GbjogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RyID0gJyc7XG4gICAgICAgIHZhciBwYXRoU3RyaW5nID0gJ29iaic7XG4gICAgICAgIHN0ciArPSAnaWYgKG9iaiAhPSBudWxsJztcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB2YXIga2V5O1xuICAgICAgICBmb3IgKDsgaSA8ICh0aGlzLmxlbmd0aCAtIDEpIDsgaSsrKSB7XG4gICAgICAgICAgICBrZXkgPSB0aGlzW2ldO1xuICAgICAgICAgICAgcGF0aFN0cmluZyArPSBpc0lkZW50KGtleSkgPyAnLicgKyBrZXkgOiBmb3JtYXRBY2Nlc3NvcihrZXkpO1xuICAgICAgICAgICAgc3RyICs9ICcgJiZcXG4gICAgICcgKyBwYXRoU3RyaW5nICsgJyAhPSBudWxsJztcbiAgICAgICAgfVxuICAgICAgICBzdHIgKz0gJylcXG4nO1xuXG4gICAgICAgIHZhciBrZXkgPSB0aGlzW2ldO1xuICAgICAgICBwYXRoU3RyaW5nICs9IGlzSWRlbnQoa2V5KSA/ICcuJyArIGtleSA6IGZvcm1hdEFjY2Vzc29yKGtleSk7XG5cbiAgICAgICAgc3RyICs9ICcgIHJldHVybiAnICsgcGF0aFN0cmluZyArICc7XFxuZWxzZVxcbiAgcmV0dXJuIHVuZGVmaW5lZDsnO1xuICAgICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdvYmonLCBzdHIpO1xuICAgIH0sXG5cbiAgICBzZXRWYWx1ZUZyb206IGZ1bmN0aW9uIChvYmosIHZhbHVlKSB7XG4gICAgICAgIGlmICghdGhpcy5sZW5ndGgpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFpc09iamVjdChvYmopKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIG9iaiA9IG9ialt0aGlzW2ldXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNPYmplY3Qob2JqKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICBvYmpbdGhpc1tpXV0gPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxufSk7XG5cbnZhciBpbnZhbGlkUGF0aCA9IG5ldyBQYXRoKCcnLCBjb25zdHJ1Y3RvcklzUHJpdmF0ZSk7XG5pbnZhbGlkUGF0aC52YWxpZCA9IGZhbHNlO1xuaW52YWxpZFBhdGguZ2V0VmFsdWVGcm9tID0gaW52YWxpZFBhdGguc2V0VmFsdWVGcm9tID0gZnVuY3Rpb24gKCkgeyB9O1xuXG5leHBvcnRzLlBhdGggPSBQYXRoO1xuIiwi77u/Ly8gQ29weXJpZ2h0IChjKSAyMDE0IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbi8vIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbi8vIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4vLyBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbi8vIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4vLyBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuXG52YXIgZXNwcmltYSA9IHJlcXVpcmUoXCJqcy1saWJzL2VzcHJpbWFcIikuZXNwcmltYTtcbnZhciBQYXRoID0gcmVxdWlyZShcImpzLWxpYnMvcG9seW1lci1leHByZXNzaW9ucy9wYXRoLXBhcnNlclwiKS5QYXRoO1xuXG4oZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIC8vIFRPRE8ocmFmYWVsdyk6IEltcGxlbWVudCBzaW1wbGUgTFJVLlxuICAgIHZhciBleHByZXNzaW9uUGFyc2VDYWNoZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cbiAgICBmdW5jdGlvbiBnZXRFeHByZXNzaW9uKGV4cHJlc3Npb25UZXh0KSB7XG4gICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblBhcnNlQ2FjaGVbZXhwcmVzc2lvblRleHRdO1xuICAgICAgICBpZiAoIWV4cHJlc3Npb24pIHtcbiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZSA9IG5ldyBBU1REZWxlZ2F0ZSgpO1xuICAgICAgICAgICAgZXNwcmltYS5wYXJzZShleHByZXNzaW9uVGV4dCwgZGVsZWdhdGUpO1xuICAgICAgICAgICAgZXhwcmVzc2lvbiA9IG5ldyBFeHByZXNzaW9uKGRlbGVnYXRlKTtcbiAgICAgICAgICAgIGV4cHJlc3Npb25QYXJzZUNhY2hlW2V4cHJlc3Npb25UZXh0XSA9IGV4cHJlc3Npb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb247XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTGl0ZXJhbCh2YWx1ZSkge1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMudmFsdWVGbl8gPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgTGl0ZXJhbC5wcm90b3R5cGUgPSB7XG4gICAgICAgIHZhbHVlRm46IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWx1ZUZuXykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZUZuXyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsdWVGbl87XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBJZGVudFBhdGgobmFtZSkge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnBhdGggPSBQYXRoLmdldChuYW1lKTtcbiAgICB9XG5cbiAgICBJZGVudFBhdGgucHJvdG90eXBlID0ge1xuICAgICAgICB2YWx1ZUZuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVGbl8pIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHRoaXMubmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgcGF0aCA9IHRoaXMucGF0aDtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgY2hhbmdlZE1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmFkZFBhdGgobW9kZWwsIHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFuZ2VkTW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBwYXRoLmdldFZhbHVlRnJvbShjaGFuZ2VkTW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXRoLmdldFZhbHVlRnJvbShtb2RlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUZuXztcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGF0aC5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgICAgIG1vZGVsID0gZmluZFNjb3BlKG1vZGVsLCB0aGlzLnBhdGhbMF0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnNldFZhbHVlRnJvbShtb2RlbCwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIE1lbWJlckV4cHJlc3Npb24ob2JqZWN0LCBwcm9wZXJ0eSwgYWNjZXNzb3IpIHtcbiAgICAgICAgdGhpcy5jb21wdXRlZCA9IGFjY2Vzc29yID09ICdbJztcblxuICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gdHlwZW9mIG9iamVjdCA9PSAnZnVuY3Rpb24nIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICBvYmplY3QuZHluYW1pY0RlcHMgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICh0aGlzLmNvbXB1dGVkICYmICEocHJvcGVydHkgaW5zdGFuY2VvZiBMaXRlcmFsKSk7XG5cbiAgICAgICAgdGhpcy5zaW1wbGVQYXRoID1cbiAgICAgICAgICAgICF0aGlzLmR5bmFtaWNEZXBzICYmXG4gICAgICAgICAgICAocHJvcGVydHkgaW5zdGFuY2VvZiBJZGVudFBhdGggfHwgcHJvcGVydHkgaW5zdGFuY2VvZiBMaXRlcmFsKSAmJlxuICAgICAgICAgICAgKG9iamVjdCBpbnN0YW5jZW9mIE1lbWJlckV4cHJlc3Npb24gfHwgb2JqZWN0IGluc3RhbmNlb2YgSWRlbnRQYXRoKTtcblxuICAgICAgICB0aGlzLm9iamVjdCA9IHRoaXMuc2ltcGxlUGF0aCA/IG9iamVjdCA6IGdldEZuKG9iamVjdCk7XG4gICAgICAgIHRoaXMucHJvcGVydHkgPSAhdGhpcy5jb21wdXRlZCB8fCB0aGlzLnNpbXBsZVBhdGggP1xuICAgICAgICAgICAgcHJvcGVydHkgOiBnZXRGbihwcm9wZXJ0eSk7XG4gICAgfVxuXG4gICAgTWVtYmVyRXhwcmVzc2lvbi5wcm90b3R5cGUgPSB7XG4gICAgICAgIGdldCBmdWxsUGF0aCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mdWxsUGF0aF8pIHtcblxuICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IHRoaXMub2JqZWN0IGluc3RhbmNlb2YgTWVtYmVyRXhwcmVzc2lvbiA/XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2JqZWN0LmZ1bGxQYXRoLnNsaWNlKCkgOiBbdGhpcy5vYmplY3QubmFtZV07XG4gICAgICAgICAgICAgICAgcGFydHMucHVzaCh0aGlzLnByb3BlcnR5IGluc3RhbmNlb2YgSWRlbnRQYXRoID9cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5uYW1lIDogdGhpcy5wcm9wZXJ0eS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5mdWxsUGF0aF8gPSBQYXRoLmdldChwYXJ0cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZ1bGxQYXRoXztcbiAgICAgICAgfSxcblxuICAgICAgICB2YWx1ZUZuOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudmFsdWVGbl8pIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0ID0gdGhpcy5vYmplY3Q7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5zaW1wbGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gdGhpcy5mdWxsUGF0aDtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9ic2VydmVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmFkZFBhdGgobW9kZWwsIHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5nZXRWYWx1ZUZyb20obW9kZWwpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuY29tcHV0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBQYXRoLmdldCh0aGlzLnByb3BlcnR5Lm5hbWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmFsdWVGbl8gPSBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBvYmplY3QobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYnNlcnZlcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYnNlcnZlci5hZGRQYXRoKGNvbnRleHQsIHBhdGgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGF0aC5nZXRWYWx1ZUZyb20oY29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBDb21wdXRlZCBwcm9wZXJ0eS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcy5wcm9wZXJ0eTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlRm5fID0gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb250ZXh0ID0gb2JqZWN0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb3BOYW1lID0gcHJvcGVydHkobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JzZXJ2ZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuYWRkUGF0aChjb250ZXh0LCBbcHJvcE5hbWVdKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQgPyBjb250ZXh0W3Byb3BOYW1lXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUZuXztcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc2ltcGxlUGF0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZnVsbFBhdGguc2V0VmFsdWVGcm9tKG1vZGVsLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ld1ZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb2JqZWN0ID0gdGhpcy5vYmplY3QobW9kZWwpO1xuICAgICAgICAgICAgdmFyIHByb3BOYW1lID0gdGhpcy5wcm9wZXJ0eSBpbnN0YW5jZW9mIElkZW50UGF0aCA/IHRoaXMucHJvcGVydHkubmFtZSA6XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eShtb2RlbCk7XG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0W3Byb3BOYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEZpbHRlcihuYW1lLCBhcmdzKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHRoaXMuYXJnc1tpXSA9IGdldEZuKGFyZ3NbaV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgRmlsdGVyLnByb3RvdHlwZSA9IHtcbiAgICAgICAgdHJhbnNmb3JtOiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSwgdG9Nb2RlbERpcmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsQXJncykge1xuICAgICAgICAgICAgdmFyIGZuID0gZmlsdGVyUmVnaXN0cnlbdGhpcy5uYW1lXTtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gbW9kZWw7XG4gICAgICAgICAgICBpZiAoZm4pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmbiA9IGNvbnRleHRbdGhpcy5uYW1lXTtcbiAgICAgICAgICAgICAgICBpZiAoIWZuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nhbm5vdCBmaW5kIGZ1bmN0aW9uIG9yIGZpbHRlcjogJyArIHRoaXMubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIHRvTW9kZWxEaXJlY3Rpb24gaXMgZmFsc2V5LCB0aGVuIHRoZSBcIm5vcm1hbFwiIChkb20tYm91bmQpIGRpcmVjdGlvblxuICAgICAgICAgICAgLy8gaXMgdXNlZC4gT3RoZXJ3aXNlLCBpdCBsb29rcyBmb3IgYSAndG9Nb2RlbCcgcHJvcGVydHkgZnVuY3Rpb24gb24gdGhlXG4gICAgICAgICAgICAvLyBvYmplY3QuXG4gICAgICAgICAgICBpZiAodG9Nb2RlbERpcmVjdGlvbikge1xuICAgICAgICAgICAgICAgIGZuID0gZm4udG9Nb2RlbDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGZuLnRvVmlldyA9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgZm4gPSBmbi50b1ZpZXc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgZm4gIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Nhbm5vdCBmaW5kIGZ1bmN0aW9uIG9yIGZpbHRlcjogJyArIHRoaXMubmFtZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYXJncyA9IGluaXRpYWxBcmdzIHx8IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goZ2V0Rm4odGhpcy5hcmdzW2ldKShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBub3RJbXBsZW1lbnRlZCgpIHsgdGhyb3cgRXJyb3IoJ05vdCBJbXBsZW1lbnRlZCcpOyB9XG5cbiAgICB2YXIgdW5hcnlPcGVyYXRvcnMgPSB7XG4gICAgICAgICcrJzogZnVuY3Rpb24gKHYpIHsgcmV0dXJuICt2OyB9LFxuICAgICAgICAnLSc6IGZ1bmN0aW9uICh2KSB7IHJldHVybiAtdjsgfSxcbiAgICAgICAgJyEnOiBmdW5jdGlvbiAodikgeyByZXR1cm4gIXY7IH1cbiAgICB9O1xuXG4gICAgdmFyIGJpbmFyeU9wZXJhdG9ycyA9IHtcbiAgICAgICAgJysnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCArIHI7IH0sXG4gICAgICAgICctJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgLSByOyB9LFxuICAgICAgICAnKic6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICogcjsgfSxcbiAgICAgICAgJy8nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAvIHI7IH0sXG4gICAgICAgICclJzogZnVuY3Rpb24gKGwsIHIpIHsgcmV0dXJuIGwgJSByOyB9LFxuICAgICAgICAnPCc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIDwgcjsgfSxcbiAgICAgICAgJz4nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA+IHI7IH0sXG4gICAgICAgICc8PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsIDw9IHI7IH0sXG4gICAgICAgICc+PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsID49IHI7IH0sXG4gICAgICAgICc9PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsID09IHI7IH0sXG4gICAgICAgICchPSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICE9IHI7IH0sXG4gICAgICAgICc9PT0nOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCA9PT0gcjsgfSxcbiAgICAgICAgJyE9PSc6IGZ1bmN0aW9uIChsLCByKSB7IHJldHVybiBsICE9PSByOyB9LFxuICAgICAgICAnJiYnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCAmJiByOyB9LFxuICAgICAgICAnfHwnOiBmdW5jdGlvbiAobCwgcikgeyByZXR1cm4gbCB8fCByOyB9LFxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRGbihhcmcpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBhcmcgPT0gJ2Z1bmN0aW9uJyA/IGFyZyA6IGFyZy52YWx1ZUZuKCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQVNURGVsZWdhdGUoKSB7XG4gICAgICAgIHRoaXMuZXhwcmVzc2lvbiA9IG51bGw7XG4gICAgICAgIHRoaXMuZmlsdGVycyA9IFtdO1xuICAgICAgICB0aGlzLmRlcHMgPSB7fTtcbiAgICAgICAgdGhpcy5jdXJyZW50UGF0aCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmluZGV4SWRlbnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBBU1REZWxlZ2F0ZS5wcm90b3R5cGUgPSB7XG4gICAgICAgIGNyZWF0ZVVuYXJ5RXhwcmVzc2lvbjogZnVuY3Rpb24gKG9wLCBhcmd1bWVudCkge1xuICAgICAgICAgICAgaWYgKCF1bmFyeU9wZXJhdG9yc1tvcF0pXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ0Rpc2FsbG93ZWQgb3BlcmF0b3I6ICcgKyBvcCk7XG5cbiAgICAgICAgICAgIGFyZ3VtZW50ID0gZ2V0Rm4oYXJndW1lbnQpO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdW5hcnlPcGVyYXRvcnNbb3BdKGFyZ3VtZW50KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlQmluYXJ5RXhwcmVzc2lvbjogZnVuY3Rpb24gKG9wLCBsZWZ0LCByaWdodCkge1xuICAgICAgICAgICAgaWYgKCFiaW5hcnlPcGVyYXRvcnNbb3BdKVxuICAgICAgICAgICAgICAgIHRocm93IEVycm9yKCdEaXNhbGxvd2VkIG9wZXJhdG9yOiAnICsgb3ApO1xuXG4gICAgICAgICAgICBsZWZ0ID0gZ2V0Rm4obGVmdCk7XG4gICAgICAgICAgICByaWdodCA9IGdldEZuKHJpZ2h0KTtcblxuICAgICAgICAgICAgc3dpdGNoIChvcCkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3x8JzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5keW5hbWljRGVwcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxlZnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByaWdodChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBjYXNlICcmJic6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBsZWZ0KG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBiaW5hcnlPcGVyYXRvcnNbb3BdKGxlZnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVDb25kaXRpb25hbEV4cHJlc3Npb246IGZ1bmN0aW9uICh0ZXN0LCBjb25zZXF1ZW50LCBhbHRlcm5hdGUpIHtcbiAgICAgICAgICAgIHRlc3QgPSBnZXRGbih0ZXN0KTtcbiAgICAgICAgICAgIGNvbnNlcXVlbnQgPSBnZXRGbihjb25zZXF1ZW50KTtcbiAgICAgICAgICAgIGFsdGVybmF0ZSA9IGdldEZuKGFsdGVybmF0ZSk7XG5cbiAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGVzdChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSA/XG4gICAgICAgICAgICAgICAgICAgIGNvbnNlcXVlbnQobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkgOlxuICAgICAgICAgICAgICAgICAgICBhbHRlcm5hdGUobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlSWRlbnRpZmllcjogZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBpZGVudCA9IG5ldyBJZGVudFBhdGgobmFtZSk7XG4gICAgICAgICAgICBpZGVudC50eXBlID0gJ0lkZW50aWZpZXInO1xuICAgICAgICAgICAgcmV0dXJuIGlkZW50O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZU1lbWJlckV4cHJlc3Npb246IGZ1bmN0aW9uIChhY2Nlc3Nvciwgb2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgICAgICAgICAgdmFyIGV4ID0gbmV3IE1lbWJlckV4cHJlc3Npb24ob2JqZWN0LCBwcm9wZXJ0eSwgYWNjZXNzb3IpO1xuICAgICAgICAgICAgaWYgKGV4LmR5bmFtaWNEZXBzKVxuICAgICAgICAgICAgICAgIHRoaXMuZHluYW1pY0RlcHMgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIGV4O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUNhbGxFeHByZXNzaW9uOiBmdW5jdGlvbiAoZXhwcmVzc2lvbiwgYXJncykge1xuICAgICAgICAgICAgaWYgKCEoZXhwcmVzc2lvbiBpbnN0YW5jZW9mIElkZW50UGF0aCkpXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ09ubHkgaWRlbnRpZmllciBmdW5jdGlvbiBpbnZvY2F0aW9ucyBhcmUgYWxsb3dlZCcpO1xuXG4gICAgICAgICAgICB2YXIgZmlsdGVyID0gbmV3IEZpbHRlcihleHByZXNzaW9uLm5hbWUsIGFyZ3MpO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyLnRyYW5zZm9ybShtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5LCBmYWxzZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZUxpdGVyYWw6IGZ1bmN0aW9uICh0b2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBMaXRlcmFsKHRva2VuLnZhbHVlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVBcnJheUV4cHJlc3Npb246IGZ1bmN0aW9uIChlbGVtZW50cykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICBlbGVtZW50c1tpXSA9IGdldEZuKGVsZW1lbnRzW2ldKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCwgb2JzZXJ2ZXIsIGZpbHRlclJlZ2lzdHJ5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGFyciA9IFtdXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgYXJyLnB1c2goZWxlbWVudHNbaV0obW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSkpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhcnI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlUHJvcGVydHk6IGZ1bmN0aW9uIChraW5kLCBrZXksIHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGtleToga2V5IGluc3RhbmNlb2YgSWRlbnRQYXRoID8ga2V5Lm5hbWUgOiBrZXkudmFsdWUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZU9iamVjdEV4cHJlc3Npb246IGZ1bmN0aW9uIChwcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BlcnRpZXMubGVuZ3RoOyBpKyspXG4gICAgICAgICAgICAgICAgcHJvcGVydGllc1tpXS52YWx1ZSA9IGdldEZuKHByb3BlcnRpZXNbaV0udmFsdWUpO1xuXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKG1vZGVsLCBvYnNlcnZlciwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2JqID0ge307XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wZXJ0aWVzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICBvYmpbcHJvcGVydGllc1tpXS5rZXldID1cbiAgICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXNbaV0udmFsdWUobW9kZWwsIG9ic2VydmVyLCBmaWx0ZXJSZWdpc3RyeSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVGaWx0ZXI6IGZ1bmN0aW9uIChuYW1lLCBhcmdzKSB7XG4gICAgICAgICAgICB0aGlzLmZpbHRlcnMucHVzaChuZXcgRmlsdGVyKG5hbWUsIGFyZ3MpKTtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVBc0V4cHJlc3Npb246IGZ1bmN0aW9uIChleHByZXNzaW9uLCBzY29wZUlkZW50KSB7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgICAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gc2NvcGVJZGVudDtcbiAgICAgICAgfSxcblxuICAgICAgICBjcmVhdGVJbkV4cHJlc3Npb246IGZ1bmN0aW9uIChzY29wZUlkZW50LCBpbmRleElkZW50LCBleHByZXNzaW9uKSB7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgICAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gc2NvcGVJZGVudDtcbiAgICAgICAgICAgIHRoaXMuaW5kZXhJZGVudCA9IGluZGV4SWRlbnQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgY3JlYXRlVG9wTGV2ZWw6IGZ1bmN0aW9uIChleHByZXNzaW9uKSB7XG4gICAgICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBleHByZXNzaW9uO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNyZWF0ZVRoaXNFeHByZXNzaW9uOiBub3RJbXBsZW1lbnRlZFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIEV4cHJlc3Npb24oZGVsZWdhdGUpIHtcbiAgICAgICAgdGhpcy5zY29wZUlkZW50ID0gZGVsZWdhdGUuc2NvcGVJZGVudDtcbiAgICAgICAgdGhpcy5pbmRleElkZW50ID0gZGVsZWdhdGUuaW5kZXhJZGVudDtcblxuICAgICAgICBpZiAoIWRlbGVnYXRlLmV4cHJlc3Npb24pXG4gICAgICAgICAgICB0aHJvdyBFcnJvcignTm8gZXhwcmVzc2lvbiBmb3VuZC4nKTtcblxuICAgICAgICB0aGlzLmV4cHJlc3Npb24gPSBkZWxlZ2F0ZS5leHByZXNzaW9uO1xuICAgICAgICBnZXRGbih0aGlzLmV4cHJlc3Npb24pOyAvLyBmb3JjZXMgZW51bWVyYXRpb24gb2YgcGF0aCBkZXBlbmRlbmNpZXNcblxuICAgICAgICB0aGlzLmZpbHRlcnMgPSBkZWxlZ2F0ZS5maWx0ZXJzO1xuICAgICAgICB0aGlzLmR5bmFtaWNEZXBzID0gZGVsZWdhdGUuZHluYW1pY0RlcHM7XG4gICAgfVxuXG4gICAgRXhwcmVzc2lvbi5wcm90b3R5cGUgPSB7XG4gICAgICAgIGdldFZhbHVlOiBmdW5jdGlvbiAobW9kZWwsIGlzQmFja0NvbnZlcnQsIGNoYW5nZWRNb2RlbCwgb2JzZXJ2ZXIpIHtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGdldEZuKHRoaXMuZXhwcmVzc2lvbikobW9kZWwuY29udGV4dCwgb2JzZXJ2ZXIsIGNoYW5nZWRNb2RlbCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZmlsdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5maWx0ZXJzW2ldLnRyYW5zZm9ybShtb2RlbC5jb250ZXh0LCBvYnNlcnZlciwgbW9kZWwuY29udGV4dCwgaXNCYWNrQ29udmVydCwgW3ZhbHVlXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZXRWYWx1ZTogZnVuY3Rpb24gKG1vZGVsLCBuZXdWYWx1ZSwgZmlsdGVyUmVnaXN0cnkpIHtcbiAgICAgICAgICAgIHZhciBjb3VudCA9IHRoaXMuZmlsdGVycyA/IHRoaXMuZmlsdGVycy5sZW5ndGggOiAwO1xuICAgICAgICAgICAgd2hpbGUgKGNvdW50LS0gPiAwKSB7XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSB0aGlzLmZpbHRlcnNbY291bnRdLnRyYW5zZm9ybShtb2RlbCwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXJSZWdpc3RyeSwgdHJ1ZSwgW25ld1ZhbHVlXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmV4cHJlc3Npb24uc2V0VmFsdWUpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5zZXRWYWx1ZShtb2RlbCwgbmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBzdHlsZSBwcm9wZXJ0eSBuYW1lIHRvIGEgY3NzIHByb3BlcnR5IG5hbWUuIEZvciBleGFtcGxlOlxuICAgICAqIFwiV2Via2l0VXNlclNlbGVjdFwiIHRvIFwiLXdlYmtpdC11c2VyLXNlbGVjdFwiXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29udmVydFN0eWxlUHJvcGVydHlOYW1lKG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZyhuYW1lKS5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbiAoYykge1xuICAgICAgICAgICAgcmV0dXJuICctJyArIGMudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgdmFyIHBhcmVudFNjb3BlTmFtZSA9ICdAJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpO1xuXG4gICAgLy8gU2luZ2xlIGlkZW50IHBhdGhzIG11c3QgYmluZCBkaXJlY3RseSB0byB0aGUgYXBwcm9wcmlhdGUgc2NvcGUgb2JqZWN0LlxuICAgIC8vIEkuZS4gUHVzaGVkIHZhbHVlcyBpbiB0d28tYmluZGluZ3MgbmVlZCB0byBiZSBhc3NpZ25lZCB0byB0aGUgYWN0dWFsIG1vZGVsXG4gICAgLy8gb2JqZWN0LlxuICAgIGZ1bmN0aW9uIGZpbmRTY29wZShtb2RlbCwgcHJvcCkge1xuICAgICAgICB3aGlsZSAobW9kZWxbcGFyZW50U2NvcGVOYW1lXSAmJlxuICAgICAgICAgICAgICAgIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb2RlbCwgcHJvcCkpIHtcbiAgICAgICAgICAgIG1vZGVsID0gbW9kZWxbcGFyZW50U2NvcGVOYW1lXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtb2RlbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc0xpdGVyYWxFeHByZXNzaW9uKHBhdGhTdHJpbmcpIHtcbiAgICAgICAgc3dpdGNoIChwYXRoU3RyaW5nKSB7XG4gICAgICAgICAgICBjYXNlICcnOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgY2FzZSAnZmFsc2UnOlxuICAgICAgICAgICAgY2FzZSAnbnVsbCc6XG4gICAgICAgICAgICBjYXNlICd0cnVlJzpcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghaXNOYU4oTnVtYmVyKHBhdGhTdHJpbmcpKSlcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gUG9seW1lckV4cHJlc3Npb25zKCkgeyB9XG5cbiAgICBQb2x5bWVyRXhwcmVzc2lvbnMucHJvdG90eXBlID0ge1xuICAgICAgICAvLyBcImJ1aWx0LWluXCIgZmlsdGVyc1xuICAgICAgICBzdHlsZU9iamVjdDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcGFydHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2goY29udmVydFN0eWxlUHJvcGVydHlOYW1lKGtleSkgKyAnOiAnICsgdmFsdWVba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGFydHMuam9pbignOyAnKTtcbiAgICAgICAgfSxcblxuICAgICAgICB0b2tlbkxpc3Q6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHRva2VucyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlW2tleV0pXG4gICAgICAgICAgICAgICAgICAgIHRva2Vucy5wdXNoKGtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdG9rZW5zLmpvaW4oJyAnKTtcbiAgICAgICAgfSxcblxuICAgICAgICAvLyBiaW5kaW5nIGRlbGVnYXRlIEFQSVxuICAgICAgICBwcmVwYXJlSW5zdGFuY2VQb3NpdGlvbkNoYW5nZWQ6IGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIGluZGV4SWRlbnQgPSB0ZW1wbGF0ZS5wb2x5bWVyRXhwcmVzc2lvbkluZGV4SWRlbnRfO1xuICAgICAgICAgICAgaWYgKCFpbmRleElkZW50KVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh0ZW1wbGF0ZUluc3RhbmNlLCBpbmRleCkge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlSW5zdGFuY2UubW9kZWxbaW5kZXhJZGVudF0gPSBpbmRleDtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgcHJlcGFyZUluc3RhbmNlTW9kZWw6IGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuICAgICAgICAgICAgdmFyIHNjb3BlTmFtZSA9IHRlbXBsYXRlLnBvbHltZXJFeHByZXNzaW9uU2NvcGVJZGVudF87XG4gICAgICAgICAgICBpZiAoIXNjb3BlTmFtZSlcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBwYXJlbnRTY29wZSA9IHRlbXBsYXRlLnRlbXBsYXRlSW5zdGFuY2UgP1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlLnRlbXBsYXRlSW5zdGFuY2UubW9kZWwgOlxuICAgICAgICAgICAgICAgIHRlbXBsYXRlLm1vZGVsO1xuXG4gICAgICAgICAgICB2YXIgaW5kZXhOYW1lID0gdGVtcGxhdGUucG9seW1lckV4cHJlc3Npb25JbmRleElkZW50XztcblxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChtb2RlbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVTY29wZU9iamVjdChwYXJlbnRTY29wZSwgbW9kZWwsIHNjb3BlTmFtZSwgaW5kZXhOYW1lKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGNyZWF0ZVNjb3BlT2JqZWN0ID0gKCdfX3Byb3RvX18nIGluIHt9KSA/XG4gICAgICBmdW5jdGlvbiAocGFyZW50U2NvcGUsIG1vZGVsLCBzY29wZU5hbWUsIGluZGV4TmFtZSkge1xuICAgICAgICAgIHZhciBzY29wZSA9IHt9O1xuICAgICAgICAgIHNjb3BlW3Njb3BlTmFtZV0gPSBtb2RlbDtcbiAgICAgICAgICBzY29wZVtpbmRleE5hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgIHNjb3BlW3BhcmVudFNjb3BlTmFtZV0gPSBwYXJlbnRTY29wZTtcbiAgICAgICAgICBzY29wZS5fX3Byb3RvX18gPSBwYXJlbnRTY29wZTtcbiAgICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgICB9IDpcbiAgICAgIGZ1bmN0aW9uIChwYXJlbnRTY29wZSwgbW9kZWwsIHNjb3BlTmFtZSwgaW5kZXhOYW1lKSB7XG4gICAgICAgICAgdmFyIHNjb3BlID0gT2JqZWN0LmNyZWF0ZShwYXJlbnRTY29wZSk7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNjb3BlLCBzY29wZU5hbWUsXG4gICAgICAgICAgICAgIHsgdmFsdWU6IG1vZGVsLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pO1xuICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzY29wZSwgaW5kZXhOYW1lLFxuICAgICAgICAgICAgICB7IHZhbHVlOiB1bmRlZmluZWQsIGNvbmZpZ3VyYWJsZTogdHJ1ZSwgd3JpdGFibGU6IHRydWUgfSk7XG4gICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHNjb3BlLCBwYXJlbnRTY29wZU5hbWUsXG4gICAgICAgICAgICAgIHsgdmFsdWU6IHBhcmVudFNjb3BlLCBjb25maWd1cmFibGU6IHRydWUsIHdyaXRhYmxlOiB0cnVlIH0pO1xuICAgICAgICAgIHJldHVybiBzY29wZTtcbiAgICAgIH07XG5cbiAgICBnbG9iYWwuUG9seW1lckV4cHJlc3Npb25zID0gUG9seW1lckV4cHJlc3Npb25zO1xuICAgIFBvbHltZXJFeHByZXNzaW9ucy5nZXRFeHByZXNzaW9uID0gZ2V0RXhwcmVzc2lvbjtcbn0pKG1vZHVsZS5leHBvcnRzKTsiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbnVtYmVyX3V0aWxzXzEgPSByZXF1aXJlKFwiLi4vdXRpbHMvbnVtYmVyLXV0aWxzXCIpO1xuZXhwb3J0cy5nZXRUcmFuc2Zvcm1NYXRyaXggPSBmdW5jdGlvbiAoX2EpIHtcbiAgICB2YXIgcHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdmFsdWUgPSBfYS52YWx1ZTtcbiAgICByZXR1cm4gVFJBTlNGT1JNX01BVFJJWEVTW3Byb3BlcnR5XSh2YWx1ZSk7XG59O1xudmFyIFRSQU5TRk9STV9NQVRSSVhFUyA9IHtcbiAgICBcInNjYWxlXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLngsIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgeCwgMCwgMCxcbiAgICAgICAgICAgIDAsIHksIDAsXG4gICAgICAgICAgICAwLCAwLCAxLFxuICAgICAgICBdO1xuICAgIH0sXG4gICAgXCJ0cmFuc2xhdGVcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB4ID0gX2EueCwgeSA9IF9hLnk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAxLCAwLCB4LFxuICAgICAgICAgICAgMCwgMSwgeSxcbiAgICAgICAgICAgIDAsIDAsIDEsXG4gICAgICAgIF07XG4gICAgfSxcbiAgICBcInJvdGF0ZVwiOiBmdW5jdGlvbiAoYW5nbGVJbkRlZykge1xuICAgICAgICB2YXIgYW5nbGVJblJhZCA9IG51bWJlcl91dGlsc18xLmRlZ3JlZXNUb1JhZGlhbnMoYW5nbGVJbkRlZyk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBNYXRoLmNvcyhhbmdsZUluUmFkKSwgLU1hdGguc2luKGFuZ2xlSW5SYWQpLCAwLFxuICAgICAgICAgICAgTWF0aC5zaW4oYW5nbGVJblJhZCksIE1hdGguY29zKGFuZ2xlSW5SYWQpLCAwLFxuICAgICAgICAgICAgMCwgMCwgMSxcbiAgICAgICAgXTtcbiAgICB9LFxufTtcbmV4cG9ydHMubWF0cml4QXJyYXlUb0Nzc01hdHJpeCA9IGZ1bmN0aW9uIChtKSB7IHJldHVybiBbXG4gICAgbVswXSwgbVszXSwgbVsxXSxcbiAgICBtWzRdLCBtWzJdLCBtWzVdLFxuXTsgfTtcbmZ1bmN0aW9uIG11bHRpcGx5QWZmaW5lMmQobTEsIG0yKSB7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgbTFbMF0gKiBtMlswXSArIG0xWzFdICogbTJbM10sXG4gICAgICAgIG0xWzBdICogbTJbMV0gKyBtMVsxXSAqIG0yWzRdLFxuICAgICAgICBtMVswXSAqIG0yWzJdICsgbTFbMV0gKiBtMls1XSArIG0xWzJdLFxuICAgICAgICBtMVszXSAqIG0yWzBdICsgbTFbNF0gKiBtMlszXSxcbiAgICAgICAgbTFbM10gKiBtMlsxXSArIG0xWzRdICogbTJbNF0sXG4gICAgICAgIG0xWzNdICogbTJbMl0gKyBtMVs0XSAqIG0yWzVdICsgbTFbNV1cbiAgICBdO1xufVxuZXhwb3J0cy5tdWx0aXBseUFmZmluZTJkID0gbXVsdGlwbHlBZmZpbmUyZDtcbmZ1bmN0aW9uIGRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4KG1hdHJpeCkge1xuICAgIHZlcmlmeVRyYW5zZm9ybU1hdHJpeChtYXRyaXgpO1xuICAgIHZhciBfYSA9IG1hdHJpeC5zbGljZSgpLCBBID0gX2FbMF0sIEIgPSBfYVsxXSwgQyA9IF9hWzJdLCBEID0gX2FbM10sIEUgPSBfYVs0XSwgRiA9IF9hWzVdO1xuICAgIHZhciBkZXRlcm1pbmFudCA9IEEgKiBEIC0gQiAqIEM7XG4gICAgdmFyIHRyYW5zbGF0ZSA9IHsgeDogRSB8fCAwLCB5OiBGIHx8IDAgfTtcbiAgICB2YXIgcm90YXRlID0gMDtcbiAgICB2YXIgc2NhbGUgPSB7IHg6IDEsIHk6IDEgfTtcbiAgICBpZiAoQSB8fCBCKSB7XG4gICAgICAgIHZhciBSID0gTWF0aC5zcXJ0KEEgKiBBICsgQiAqIEIpO1xuICAgICAgICByb3RhdGUgPSBCID4gMCA/IE1hdGguYWNvcyhBIC8gUikgOiAtTWF0aC5hY29zKEEgLyBSKTtcbiAgICAgICAgc2NhbGUgPSB7IHg6IFIsIHk6IGRldGVybWluYW50IC8gUiB9O1xuICAgIH1cbiAgICBlbHNlIGlmIChDIHx8IEQpIHtcbiAgICAgICAgdmFyIFIgPSBNYXRoLnNxcnQoQyAqIEMgKyBEICogRCk7XG4gICAgICAgIHJvdGF0ZSA9IE1hdGguUEkgLyAyIC0gKEQgPiAwID8gTWF0aC5hY29zKC1DIC8gUikgOiAtTWF0aC5hY29zKEMgLyBSKSk7XG4gICAgICAgIHNjYWxlID0geyB4OiBkZXRlcm1pbmFudCAvIFIsIHk6IFIgfTtcbiAgICB9XG4gICAgcm90YXRlID0gbnVtYmVyX3V0aWxzXzEucmFkaWFuc1RvRGVncmVlcyhyb3RhdGUpO1xuICAgIHJldHVybiB7IHRyYW5zbGF0ZTogdHJhbnNsYXRlLCByb3RhdGU6IHJvdGF0ZSwgc2NhbGU6IHNjYWxlIH07XG59XG5leHBvcnRzLmRlY29tcG9zZTJEVHJhbnNmb3JtTWF0cml4ID0gZGVjb21wb3NlMkRUcmFuc2Zvcm1NYXRyaXg7XG5mdW5jdGlvbiB2ZXJpZnlUcmFuc2Zvcm1NYXRyaXgobWF0cml4KSB7XG4gICAgaWYgKG1hdHJpeC5sZW5ndGggPCA2KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlRyYW5zZm9ybSBtYXRyaXggc2hvdWxkIGJlIDJ4My5cIik7XG4gICAgfVxufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWF0cml4LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uL3BsYXRmb3JtL3BsYXRmb3JtXCIpO1xudmFyIGFwcENvbW1vbk1vZHVsZSA9IHJlcXVpcmUoXCIuLi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvbi1jb21tb25cIik7XG52YXIgcXVhbGlmaWVyX21hdGNoZXJfMSA9IHJlcXVpcmUoXCIuL3F1YWxpZmllci1tYXRjaGVyXCIpO1xudmFyIG5vbl9idW5kbGVfd29ya2Zsb3dfY29tcGF0XzEgPSByZXF1aXJlKFwiLi9ub24tYnVuZGxlLXdvcmtmbG93LWNvbXBhdFwiKTtcbnZhciBNb2R1bGVOYW1lUmVzb2x2ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1vZHVsZU5hbWVSZXNvbHZlcihjb250ZXh0LCBtb2R1bGVMaXN0UHJvdmlkZXIpIHtcbiAgICAgICAgaWYgKG1vZHVsZUxpc3RQcm92aWRlciA9PT0gdm9pZCAwKSB7IG1vZHVsZUxpc3RQcm92aWRlciA9IGdsb2JhbC5nZXRSZWdpc3RlcmVkTW9kdWxlczsgfVxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICB0aGlzLm1vZHVsZUxpc3RQcm92aWRlciA9IG1vZHVsZUxpc3RQcm92aWRlcjtcbiAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcbiAgICB9XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5yZXNvbHZlTW9kdWxlTmFtZSA9IGZ1bmN0aW9uIChwYXRoLCBleHQpIHtcbiAgICAgICAgdmFyIGtleSA9IHBhdGggKyBleHQ7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9jYWNoZVtrZXldO1xuICAgICAgICBpZiAocmVzdWx0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMucmVzb2x2ZU1vZHVsZU5hbWVJbXBsKHBhdGgsIGV4dCk7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZVtrZXldID0gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBNb2R1bGVOYW1lUmVzb2x2ZXIucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2NhY2hlID0ge307XG4gICAgfTtcbiAgICBNb2R1bGVOYW1lUmVzb2x2ZXIucHJvdG90eXBlLnJlc29sdmVNb2R1bGVOYW1lSW1wbCA9IGZ1bmN0aW9uIChwYXRoLCBleHQpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgIGV4dCA9IGV4dCA/IFwiLlwiICsgZXh0IDogXCJcIjtcbiAgICAgICAgaWYgKCFnbG9iYWwuVE5TX1dFQlBBQ0spIHtcbiAgICAgICAgICAgIG5vbl9idW5kbGVfd29ya2Zsb3dfY29tcGF0XzEucmVnaXN0ZXJNb2R1bGVzRnJvbUZpbGVTeXN0ZW0ocGF0aCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNhbmRpZGF0ZXMgPSB0aGlzLmdldENhbmRpZGF0ZXMocGF0aCwgZXh0KTtcbiAgICAgICAgcmVzdWx0ID0gcXVhbGlmaWVyX21hdGNoZXJfMS5maW5kTWF0Y2gocGF0aCwgZXh0LCBjYW5kaWRhdGVzLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgTW9kdWxlTmFtZVJlc29sdmVyLnByb3RvdHlwZS5nZXRDYW5kaWRhdGVzID0gZnVuY3Rpb24gKHBhdGgsIGV4dCkge1xuICAgICAgICB2YXIgY2FuZGlkYXRlcyA9IHRoaXMubW9kdWxlTGlzdFByb3ZpZGVyKClcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKG1vZHVsZU5hbWUpIHsgcmV0dXJuIG1vZHVsZU5hbWUuc3RhcnRzV2l0aChwYXRoKSAmJiAoIWV4dCB8fCBtb2R1bGVOYW1lLmVuZHNXaXRoKGV4dCkpOyB9KTtcbiAgICAgICAgcmV0dXJuIGNhbmRpZGF0ZXM7XG4gICAgfTtcbiAgICByZXR1cm4gTW9kdWxlTmFtZVJlc29sdmVyO1xufSgpKTtcbmV4cG9ydHMuTW9kdWxlTmFtZVJlc29sdmVyID0gTW9kdWxlTmFtZVJlc29sdmVyO1xudmFyIHJlc29sdmVySW5zdGFuY2U7XG5mdW5jdGlvbiByZXNvbHZlTW9kdWxlTmFtZShwYXRoLCBleHQpIHtcbiAgICBpZiAoIXJlc29sdmVySW5zdGFuY2UpIHtcbiAgICAgICAgcmVzb2x2ZXJJbnN0YW5jZSA9IG5ldyBNb2R1bGVOYW1lUmVzb2x2ZXIoe1xuICAgICAgICAgICAgd2lkdGg6IHBsYXRmb3JtXzEuc2NyZWVuLm1haW5TY3JlZW4ud2lkdGhESVBzLFxuICAgICAgICAgICAgaGVpZ2h0OiBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuLmhlaWdodERJUHMsXG4gICAgICAgICAgICBvczogcGxhdGZvcm1fMS5kZXZpY2Uub3MsXG4gICAgICAgICAgICBkZXZpY2VUeXBlOiBwbGF0Zm9ybV8xLmRldmljZS5kZXZpY2VUeXBlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZXJJbnN0YW5jZS5yZXNvbHZlTW9kdWxlTmFtZShwYXRoLCBleHQpO1xufVxuZXhwb3J0cy5yZXNvbHZlTW9kdWxlTmFtZSA9IHJlc29sdmVNb2R1bGVOYW1lO1xuZnVuY3Rpb24gY2xlYXJDYWNoZSgpIHtcbiAgICBpZiAocmVzb2x2ZXJJbnN0YW5jZSkge1xuICAgICAgICByZXNvbHZlckluc3RhbmNlLmNsZWFyQ2FjaGUoKTtcbiAgICB9XG59XG5leHBvcnRzLmNsZWFyQ2FjaGUgPSBjbGVhckNhY2hlO1xuZnVuY3Rpb24gX3NldFJlc29sdmVyKHJlc29sdmVyKSB7XG4gICAgcmVzb2x2ZXJJbnN0YW5jZSA9IHJlc29sdmVyO1xufVxuZXhwb3J0cy5fc2V0UmVzb2x2ZXIgPSBfc2V0UmVzb2x2ZXI7XG5hcHBDb21tb25Nb2R1bGUub24oXCJsaXZlc3luY1wiLCBmdW5jdGlvbiAoYXJncykgeyByZXR1cm4gY2xlYXJDYWNoZSgpOyB9KTtcbmFwcENvbW1vbk1vZHVsZS5vbihcIm9yaWVudGF0aW9uQ2hhbmdlZFwiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIHJlc29sdmVySW5zdGFuY2UgPSB1bmRlZmluZWQ7XG59KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW1vZHVsZS1uYW1lLXJlc29sdmVyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmcyA9IHJlcXVpcmUoXCIuLi9maWxlLXN5c3RlbS9maWxlLXN5c3RlbVwiKTtcbnZhciBhcHBDb21tb25Nb2R1bGUgPSByZXF1aXJlKFwiLi4vYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIGNhY2hlID0gbmV3IFNldCgpO1xudmFyIGluaXRpYWxpemVkID0gZmFsc2U7XG5mdW5jdGlvbiByZWdpc3RlcihuYW1lLCBsb2FkZXIpIHtcbiAgICBnbG9iYWwucmVnaXN0ZXJNb2R1bGUobmFtZSwgbG9hZGVyKTtcbn1cbmZ1bmN0aW9uIHByb2Nlc3NGaWxlKGZpbGUpIHtcbiAgICB2YXIgZmlsZVBhdGhSZWxhdGl2ZVRvQXBwID0gZmlsZS5wYXRoLnN1YnN0cihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgubGVuZ3RoICsgMSk7XG4gICAgdmFyIGxvYWRDb250ZW50ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZmlsZS5yZWFkVGV4dFN5bmMoKTsgfTtcbiAgICBzd2l0Y2ggKGZpbGUuZXh0ZW5zaW9uLnRvTG9jYWxlTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgY2FzZSBcIi5qc1wiOlxuICAgICAgICAgICAgdmFyIG5vRXh0UGF0aCA9IGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5zdWJzdHIoMCwgZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLmxlbmd0aCAtIFwiLmpzXCIubGVuZ3RoKTtcbiAgICAgICAgICAgIHJlZ2lzdGVyKGZpbGVQYXRoUmVsYXRpdmVUb0FwcCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gZ2xvYmFsLnJlcXVpcmUoZmlsZS5wYXRoKTsgfSk7XG4gICAgICAgICAgICByZWdpc3Rlcihub0V4dFBhdGgsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7IH0pO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCIuY3NzXCI6XG4gICAgICAgICAgICByZWdpc3RlcihmaWxlUGF0aFJlbGF0aXZlVG9BcHAsIGxvYWRDb250ZW50KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiLnhtbFwiOlxuICAgICAgICAgICAgcmVnaXN0ZXIoZmlsZVBhdGhSZWxhdGl2ZVRvQXBwLCBsb2FkQ29udGVudCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG4gICAgaWYgKGZpbGUubmFtZSA9PT0gXCJwYWNrYWdlLmpzb25cIikge1xuICAgICAgICB2YXIganNvbiA9IGdsb2JhbC5yZXF1aXJlKGZpbGUucGF0aCk7XG4gICAgICAgIGlmIChqc29uLm1haW4pIHtcbiAgICAgICAgICAgIHZhciBuYW1lXzEgPSBmaWxlUGF0aFJlbGF0aXZlVG9BcHAuc3Vic3RyKDAsIGZpbGVQYXRoUmVsYXRpdmVUb0FwcC5sZW5ndGggLSBcInBhY2thZ2UuanNvblwiLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgdmFyIHJlcXVpcmVQYXRoXzEgPSBmcy5wYXRoLmpvaW4oZmlsZS5wYXJlbnQucGF0aCwganNvbi5tYWluKTtcbiAgICAgICAgICAgIGlmIChuYW1lXzEuc3RhcnRzV2l0aChcInRuc19tb2R1bGVzXCIpKSB7XG4gICAgICAgICAgICAgICAgbmFtZV8xID0gbmFtZV8xLnN1YnN0cihcInRuc19tb2R1bGVzXCIubGVuZ3RoICsgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWdpc3RlcihuYW1lXzEsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdsb2JhbC5yZXF1aXJlKHJlcXVpcmVQYXRoXzEpOyB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmZ1bmN0aW9uIHByb2Nlc3NGb2xkZXIocGF0aCkge1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHBhdGgpKSB7XG4gICAgICAgIHZhciBmb2xkZXIgPSBmcy5Gb2xkZXIuZnJvbVBhdGgocGF0aCk7XG4gICAgICAgIGZvbGRlci5lYWNoRW50aXR5KGZ1bmN0aW9uIChmaWxlKSB7XG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIGZzLkZpbGUpIHtcbiAgICAgICAgICAgICAgICBwcm9jZXNzRmlsZShmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5mdW5jdGlvbiByZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbShtb2R1bGVOYW1lKSB7XG4gICAgaW5pdGlhbGl6ZSgpO1xuICAgIGlmIChjYWNoZS5oYXMobW9kdWxlTmFtZSkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjYWNoZS5hZGQobW9kdWxlTmFtZSk7XG4gICAgdmFyIHBhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBtb2R1bGVOYW1lKTtcbiAgICBpZiAoZnMuRm9sZGVyLmV4aXN0cyhwYXRoKSkge1xuICAgICAgICBwcm9jZXNzRm9sZGVyKHBhdGgpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBwYXJlbnROYW1lID0gbW9kdWxlTmFtZS5zdWJzdHIoMCwgbW9kdWxlTmFtZS5sYXN0SW5kZXhPZihmcy5wYXRoLnNlcGFyYXRvcikpO1xuICAgIHZhciBwYXJlbnRGb2xkZXJQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgcGFyZW50TmFtZSk7XG4gICAgaWYgKGZzLkZvbGRlci5leGlzdHMocGFyZW50Rm9sZGVyUGF0aCkpIHtcbiAgICAgICAgcHJvY2Vzc0ZvbGRlcihwYXJlbnRGb2xkZXJQYXRoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdG5zTW9kdWxlc1BhdGggPSBmcy5wYXRoLmpvaW4oZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoLCBcInRuc19tb2R1bGVzXCIsIG1vZHVsZU5hbWUpO1xuICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHRuc01vZHVsZXNQYXRoKSkge1xuICAgICAgICBwcm9jZXNzRm9sZGVyKHRuc01vZHVsZXNQYXRoKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAocGFyZW50TmFtZSkge1xuICAgICAgICB2YXIgdG5zUGFyZW50Rm9sZGVyUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIFwidG5zX21vZHVsZXNcIiwgcGFyZW50TmFtZSk7XG4gICAgICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKHRuc1BhcmVudEZvbGRlclBhdGgpKSB7XG4gICAgICAgICAgICBwcm9jZXNzRm9sZGVyKHRuc1BhcmVudEZvbGRlclBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5yZWdpc3Rlck1vZHVsZXNGcm9tRmlsZVN5c3RlbSA9IHJlZ2lzdGVyTW9kdWxlc0Zyb21GaWxlU3lzdGVtO1xuZnVuY3Rpb24gaW5pdGlhbGl6ZSgpIHtcbiAgICBpZiAoIWluaXRpYWxpemVkKSB7XG4gICAgICAgIGFwcENvbW1vbk1vZHVsZS5vbihcImxpdmVzeW5jXCIsIGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBjYWNoZS5jbGVhcigpOyB9KTtcbiAgICAgICAgaW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW5vbi1idW5kbGUtd29ya2Zsb3ctY29tcGF0LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBNSU5fV0ggPSBcIm1pbldIXCI7XG52YXIgTUlOX1cgPSBcIm1pbldcIjtcbnZhciBNSU5fSCA9IFwibWluSFwiO1xudmFyIFBSSU9SSVRZX1NURVAgPSAxMDAwMDtcbnZhciBtaW5XaWR0aEhlaWdodFF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmluZGV4T2YoTUlOX1dIKSA9PT0gMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9XSC5sZW5ndGgpKTtcbiAgICAgICAgaWYgKGlzTmFOKG51bVZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYWN0dWFsTGVuZ3RoID0gTWF0aC5taW4oY29udGV4dC53aWR0aCwgY29udGV4dC5oZWlnaHQpO1xuICAgICAgICBpZiAoYWN0dWFsTGVuZ3RoIDwgbnVtVmFsKSB7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFBSSU9SSVRZX1NURVAgLSAoYWN0dWFsTGVuZ3RoIC0gbnVtVmFsKTtcbiAgICB9XG59O1xudmFyIG1pbldpZHRoUXVhbGlmaWVyID0ge1xuICAgIGlzTWF0Y2g6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUuaW5kZXhPZihNSU5fVykgPT09IDAgJiYgdmFsdWUuaW5kZXhPZihNSU5fV0gpIDwgMDtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgbnVtVmFsID0gcGFyc2VJbnQodmFsdWUuc3Vic3RyKE1JTl9XLmxlbmd0aCkpO1xuICAgICAgICBpZiAoaXNOYU4obnVtVmFsKSkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhY3R1YWxXaWR0aCA9IGNvbnRleHQud2lkdGg7XG4gICAgICAgIGlmIChhY3R1YWxXaWR0aCA8IG51bVZhbCkge1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQUklPUklUWV9TVEVQIC0gKGFjdHVhbFdpZHRoIC0gbnVtVmFsKTtcbiAgICB9XG59O1xudmFyIG1pbkhlaWdodFF1YWxpZmllciA9IHtcbiAgICBpc01hdGNoOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlLmluZGV4T2YoTUlOX0gpID09PSAwICYmIHZhbHVlLmluZGV4T2YoTUlOX1dIKSA8IDA7XG4gICAgfSxcbiAgICBnZXRNYXRjaFZhbHVlOiBmdW5jdGlvbiAodmFsdWUsIGNvbnRleHQpIHtcbiAgICAgICAgdmFyIG51bVZhbCA9IHBhcnNlSW50KHZhbHVlLnN1YnN0cihNSU5fSC5sZW5ndGgpKTtcbiAgICAgICAgaWYgKGlzTmFOKG51bVZhbCkpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYWN0dWFsSGVpZ2h0ID0gY29udGV4dC5oZWlnaHQ7XG4gICAgICAgIGlmIChhY3R1YWxIZWlnaHQgPCBudW1WYWwpIHtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUFJJT1JJVFlfU1RFUCAtIChhY3R1YWxIZWlnaHQgLSBudW1WYWwpO1xuICAgIH1cbn07XG52YXIgcGxhdGZvcm1RdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gXCJhbmRyb2lkXCIgfHxcbiAgICAgICAgICAgIHZhbHVlID09PSBcImlvc1wiO1xuICAgIH0sXG4gICAgZ2V0TWF0Y2hWYWx1ZTogZnVuY3Rpb24gKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gY29udGV4dC5vcy50b0xvd2VyQ2FzZSgpID8gMSA6IC0xO1xuICAgIH1cbn07XG52YXIgb3JpZW50YXRpb25RdWFsaWZpZXIgPSB7XG4gICAgaXNNYXRjaDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gXCJsYW5kXCIgfHxcbiAgICAgICAgICAgIHZhbHVlID09PSBcInBvcnRcIjtcbiAgICB9LFxuICAgIGdldE1hdGNoVmFsdWU6IGZ1bmN0aW9uICh2YWx1ZSwgY29udGV4dCkge1xuICAgICAgICB2YXIgaXNMYW5kc2NhcGUgPSAoY29udGV4dC53aWR0aCA+IGNvbnRleHQuaGVpZ2h0KSA/IDEgOiAtMTtcbiAgICAgICAgcmV0dXJuICh2YWx1ZSA9PT0gXCJsYW5kXCIpID8gaXNMYW5kc2NhcGUgOiAtaXNMYW5kc2NhcGU7XG4gICAgfVxufTtcbnZhciBzdXBwb3J0ZWRRdWFsaWZpZXJzID0gW1xuICAgIG1pbldpZHRoSGVpZ2h0UXVhbGlmaWVyLFxuICAgIG1pbldpZHRoUXVhbGlmaWVyLFxuICAgIG1pbkhlaWdodFF1YWxpZmllcixcbiAgICBvcmllbnRhdGlvblF1YWxpZmllcixcbiAgICBwbGF0Zm9ybVF1YWxpZmllclxuXTtcbmZ1bmN0aW9uIGNoZWNrUXVhbGlmaWVycyhxdWFsaWZpZXJzLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgdmFyIHZhbHVlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcXVhbGlmaWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAocXVhbGlmaWVyc1tpXSkge1xuICAgICAgICAgICAgdmFsdWUgPSBjaGVja1F1YWxpZmllcihxdWFsaWZpZXJzW2ldLCBjb250ZXh0KTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgKz0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNoZWNrUXVhbGlmaWVyKHZhbHVlLCBjb250ZXh0KSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1cHBvcnRlZFF1YWxpZmllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHN1cHBvcnRlZFF1YWxpZmllcnNbaV0uaXNNYXRjaCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHN1cHBvcnRlZFF1YWxpZmllcnNbaV0uZ2V0TWF0Y2hWYWx1ZSh2YWx1ZSwgY29udGV4dCk7XG4gICAgICAgICAgICBpZiAocmVzdWx0ID4gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCArPSAoc3VwcG9ydGVkUXVhbGlmaWVycy5sZW5ndGggLSBpKSAqIFBSSU9SSVRZX1NURVA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbn1cbmZ1bmN0aW9uIGZpbmRNYXRjaChwYXRoLCBleHQsIGNhbmRpZGF0ZXMsIGNvbnRleHQpIHtcbiAgICB2YXIgYmVzdFZhbHVlID0gLTE7XG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYW5kaWRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBmaWxlUGF0aCA9IGNhbmRpZGF0ZXNbaV07XG4gICAgICAgIHZhciBxdWFsaWZpZXJzU3RyID0gZmlsZVBhdGguc3Vic3RyKHBhdGgubGVuZ3RoLCBmaWxlUGF0aC5sZW5ndGggLSBwYXRoLmxlbmd0aCAtIChleHQgPyBleHQubGVuZ3RoIDogMCkpO1xuICAgICAgICB2YXIgcXVhbGlmaWVycyA9IHF1YWxpZmllcnNTdHIuc3BsaXQoXCIuXCIpO1xuICAgICAgICB2YXIgdmFsdWUgPSBjaGVja1F1YWxpZmllcnMocXVhbGlmaWVycywgY29udGV4dCk7XG4gICAgICAgIGlmICh2YWx1ZSA+PSAwICYmIHZhbHVlID4gYmVzdFZhbHVlKSB7XG4gICAgICAgICAgICBiZXN0VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHJlc3VsdCA9IGNhbmRpZGF0ZXNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZmluZE1hdGNoID0gZmluZE1hdGNoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cXVhbGlmaWVyLW1hdGNoZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHBsYXRmb3JtTmFtZXM7XG4oZnVuY3Rpb24gKHBsYXRmb3JtTmFtZXMpIHtcbiAgICBwbGF0Zm9ybU5hbWVzLmFuZHJvaWQgPSBcIkFuZHJvaWRcIjtcbiAgICBwbGF0Zm9ybU5hbWVzLmlvcyA9IFwiaU9TXCI7XG59KShwbGF0Zm9ybU5hbWVzID0gZXhwb3J0cy5wbGF0Zm9ybU5hbWVzIHx8IChleHBvcnRzLnBsYXRmb3JtTmFtZXMgPSB7fSkpO1xudmFyIERldmljZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGV2aWNlKCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJtYW51ZmFjdHVyZXJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBcIkFwcGxlXCI7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcIm9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gcGxhdGZvcm1OYW1lcy5pb3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZXZpY2UucHJvdG90eXBlLCBcIm9zVmVyc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vc1ZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vc1ZlcnNpb24gPSBVSURldmljZS5jdXJyZW50RGV2aWNlLnN5c3RlbVZlcnNpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3NWZXJzaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJtb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9tb2RlbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21vZGVsID0gVUlEZXZpY2UuY3VycmVudERldmljZS5tb2RlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwic2RrVmVyc2lvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9zZGtWZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2RrVmVyc2lvbiA9IFVJRGV2aWNlLmN1cnJlbnREZXZpY2Uuc3lzdGVtVmVyc2lvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZGtWZXJzaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJkZXZpY2VUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2RldmljZVR5cGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoVUlEZXZpY2UuY3VycmVudERldmljZS51c2VySW50ZXJmYWNlSWRpb20gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGV2aWNlVHlwZSA9IFwiUGhvbmVcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RldmljZVR5cGUgPSBcIlRhYmxldFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kZXZpY2VUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJ1dWlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXNlckRlZmF1bHRzID0gTlNVc2VyRGVmYXVsdHMuc3RhbmRhcmRVc2VyRGVmYXVsdHM7XG4gICAgICAgICAgICB2YXIgdXVpZF9rZXkgPSBcIlROU1VVSURcIjtcbiAgICAgICAgICAgIHZhciBhcHBfdXVpZCA9IHVzZXJEZWZhdWx0cy5zdHJpbmdGb3JLZXkodXVpZF9rZXkpO1xuICAgICAgICAgICAgaWYgKCFhcHBfdXVpZCkge1xuICAgICAgICAgICAgICAgIGFwcF91dWlkID0gTlNVVUlELlVVSUQoKS5VVUlEU3RyaW5nO1xuICAgICAgICAgICAgICAgIHVzZXJEZWZhdWx0cy5zZXRPYmplY3RGb3JLZXkoYXBwX3V1aWQsIHV1aWRfa2V5KTtcbiAgICAgICAgICAgICAgICB1c2VyRGVmYXVsdHMuc3luY2hyb25pemUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcHBfdXVpZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KERldmljZS5wcm90b3R5cGUsIFwibGFuZ3VhZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbGFuZ3VhZ2VzID0gTlNMb2NhbGUucHJlZmVycmVkTGFuZ3VhZ2VzO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhbmd1YWdlID0gbGFuZ3VhZ2VzWzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhbmd1YWdlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV2aWNlLnByb3RvdHlwZSwgXCJyZWdpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fcmVnaW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVnaW9uID0gTlNMb2NhbGUuY3VycmVudExvY2FsZS5vYmplY3RGb3JLZXkoTlNMb2NhbGVDb3VudHJ5Q29kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVnaW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gRGV2aWNlO1xufSgpKTtcbnZhciBNYWluU2NyZWVuID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNYWluU2NyZWVuKCkge1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwic2NyZWVuXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX3NjcmVlbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NjcmVlbiA9IFVJU2NyZWVuLm1haW5TY3JlZW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2NyZWVuO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwid2lkdGhQaXhlbHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLndpZHRoRElQcyAqIHRoaXMuc2NhbGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYWluU2NyZWVuLnByb3RvdHlwZSwgXCJoZWlnaHRQaXhlbHNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhlaWdodERJUHMgKiB0aGlzLnNjYWxlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwic2NhbGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNjcmVlbi5zY2FsZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE1haW5TY3JlZW4ucHJvdG90eXBlLCBcIndpZHRoRElQc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyZWVuLmJvdW5kcy5zaXplLndpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTWFpblNjcmVlbi5wcm90b3R5cGUsIFwiaGVpZ2h0RElQc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2NyZWVuLmJvdW5kcy5zaXplLmhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIE1haW5TY3JlZW47XG59KCkpO1xuZXhwb3J0cy5kZXZpY2UgPSBuZXcgRGV2aWNlKCk7XG52YXIgc2NyZWVuO1xuKGZ1bmN0aW9uIChzY3JlZW4pIHtcbiAgICBzY3JlZW4ubWFpblNjcmVlbiA9IG5ldyBNYWluU2NyZWVuKCk7XG59KShzY3JlZW4gPSBleHBvcnRzLnNjcmVlbiB8fCAoZXhwb3J0cy5zY3JlZW4gPSB7fSkpO1xuZXhwb3J0cy5pc0lPUyA9IHRydWU7XG5leHBvcnRzLmlzQW5kcm9pZCA9IGZhbHNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGxhdGZvcm0uaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIHVwdGltZSgpIHtcbiAgICByZXR1cm4gZ2xvYmFsLmFuZHJvaWQgPyBvcmcubmF0aXZlc2NyaXB0LlByb2Nlc3MuZ2V0VXBUaW1lKCkgOiBnbG9iYWwuX190bnNfdXB0aW1lKCk7XG59XG5leHBvcnRzLnVwdGltZSA9IHVwdGltZTtcbmZ1bmN0aW9uIGxvZyhtZXNzYWdlKSB7XG4gICAgaWYgKGdsb2JhbC5fX25zbG9nKSB7XG4gICAgICAgIGdsb2JhbC5fX25zbG9nKFwiQ09OU09MRSBMT0c6IFwiICsgbWVzc2FnZSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xufVxuZXhwb3J0cy5sb2cgPSBsb2c7XG52YXIgdGltZXJzID0ge307XG52YXIgYW55R2xvYmFsID0gZ2xvYmFsO1xudmFyIHByb2ZpbGVOYW1lcyA9IFtdO1xuZXhwb3J0cy50aW1lID0gZ2xvYmFsLl9fdGltZSB8fCBEYXRlLm5vdztcbmZ1bmN0aW9uIHN0YXJ0KG5hbWUpIHtcbiAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICBpZiAoaW5mbykge1xuICAgICAgICBpbmZvLmN1cnJlbnRTdGFydCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICBpbmZvLnJ1bkNvdW50Kys7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBpbmZvID0ge1xuICAgICAgICAgICAgdG90YWxUaW1lOiAwLFxuICAgICAgICAgICAgY291bnQ6IDAsXG4gICAgICAgICAgICBjdXJyZW50U3RhcnQ6IGV4cG9ydHMudGltZSgpLFxuICAgICAgICAgICAgcnVuQ291bnQ6IDFcbiAgICAgICAgfTtcbiAgICAgICAgdGltZXJzW25hbWVdID0gaW5mbztcbiAgICAgICAgcHJvZmlsZU5hbWVzLnB1c2gobmFtZSk7XG4gICAgfVxufVxuZXhwb3J0cy5zdGFydCA9IHN0YXJ0O1xuZnVuY3Rpb24gc3RvcChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgaWYgKCFpbmZvKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHRpbWVyIHN0YXJ0ZWQ6IFwiICsgbmFtZSk7XG4gICAgfVxuICAgIGlmIChpbmZvLnJ1bkNvdW50KSB7XG4gICAgICAgIGluZm8ucnVuQ291bnQtLTtcbiAgICAgICAgaWYgKGluZm8ucnVuQ291bnQpIHtcbiAgICAgICAgICAgIGluZm8uY291bnQrKztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGluZm8ubGFzdFRpbWUgPSBleHBvcnRzLnRpbWUoKSAtIGluZm8uY3VycmVudFN0YXJ0O1xuICAgICAgICAgICAgaW5mby50b3RhbFRpbWUgKz0gaW5mby5sYXN0VGltZTtcbiAgICAgICAgICAgIGluZm8uY291bnQrKztcbiAgICAgICAgICAgIGluZm8uY3VycmVudFN0YXJ0ID0gMDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGltZXIgXCIgKyBuYW1lICsgXCIgcGF1c2VkIG1vcmUgdGltZXMgdGhhbiBzdGFydGVkLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGluZm87XG59XG5leHBvcnRzLnN0b3AgPSBzdG9wO1xuZnVuY3Rpb24gdGltZXIobmFtZSkge1xuICAgIHJldHVybiB0aW1lcnNbbmFtZV07XG59XG5leHBvcnRzLnRpbWVyID0gdGltZXI7XG5mdW5jdGlvbiBwcmludChuYW1lKSB7XG4gICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgaWYgKCFpbmZvKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHRpbWVyIHN0YXJ0ZWQ6IFwiICsgbmFtZSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwiLS0tLSBbXCIgKyBuYW1lICsgXCJdIFNUT1AgdG90YWw6IFwiICsgaW5mby50b3RhbFRpbWUgKyBcIiBjb3VudDpcIiArIGluZm8uY291bnQpO1xuICAgIHJldHVybiBpbmZvO1xufVxuZXhwb3J0cy5wcmludCA9IHByaW50O1xuZnVuY3Rpb24gaXNSdW5uaW5nKG5hbWUpIHtcbiAgICB2YXIgaW5mbyA9IHRpbWVyc1tuYW1lXTtcbiAgICByZXR1cm4gISEoaW5mbyAmJiBpbmZvLnJ1bkNvdW50KTtcbn1cbmV4cG9ydHMuaXNSdW5uaW5nID0gaXNSdW5uaW5nO1xuZnVuY3Rpb24gY291bnRlcnNQcm9maWxlRnVuY3Rpb25GYWN0b3J5KGZuLCBuYW1lLCB0eXBlKSB7XG4gICAgaWYgKHR5cGUgPT09IHZvaWQgMCkgeyB0eXBlID0gMTsgfVxuICAgIHByb2ZpbGVOYW1lcy5wdXNoKG5hbWUpO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHN0YXJ0KG5hbWUpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICBzdG9wKG5hbWUpO1xuICAgICAgICB9XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRpbWVsaW5lUHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShmbiwgbmFtZSwgdHlwZSkge1xuICAgIGlmICh0eXBlID09PSB2b2lkIDApIHsgdHlwZSA9IDE7IH1cbiAgICByZXR1cm4gdHlwZSA9PT0gMSA/IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXJ0ID0gZXhwb3J0cy50aW1lKCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBmaW5hbGx5IHtcbiAgICAgICAgICAgIHZhciBlbmQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVGltZWxpbmU6IE1vZHVsZXM6IFwiICsgbmFtZSArIFwiIFwiICsgdGhpcyArIFwiICAoXCIgKyBzdGFydCArIFwibXMuIC0gXCIgKyBlbmQgKyBcIm1zLilcIik7XG4gICAgICAgIH1cbiAgICB9IDogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RhcnQgPSBleHBvcnRzLnRpbWUoKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgICAgIGZpbmFsbHkge1xuICAgICAgICAgICAgdmFyIGVuZCA9IGV4cG9ydHMudGltZSgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaW1lbGluZTogTW9kdWxlczogXCIgKyBuYW1lICsgXCIgIChcIiArIHN0YXJ0ICsgXCJtcy4gLSBcIiArIGVuZCArIFwibXMuKVwiKTtcbiAgICAgICAgfVxuICAgIH07XG59XG52YXIgTGV2ZWw7XG4oZnVuY3Rpb24gKExldmVsKSB7XG4gICAgTGV2ZWxbTGV2ZWxbXCJub25lXCJdID0gMF0gPSBcIm5vbmVcIjtcbiAgICBMZXZlbFtMZXZlbFtcImxpZmVjeWNsZVwiXSA9IDFdID0gXCJsaWZlY3ljbGVcIjtcbiAgICBMZXZlbFtMZXZlbFtcInRpbWVsaW5lXCJdID0gMl0gPSBcInRpbWVsaW5lXCI7XG59KShMZXZlbCA9IGV4cG9ydHMuTGV2ZWwgfHwgKGV4cG9ydHMuTGV2ZWwgPSB7fSkpO1xudmFyIHRyYWNpbmdMZXZlbCA9IExldmVsLm5vbmU7XG52YXIgcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeTtcbmZ1bmN0aW9uIGVuYWJsZShtb2RlKSB7XG4gICAgaWYgKG1vZGUgPT09IHZvaWQgMCkgeyBtb2RlID0gXCJjb3VudGVyc1wiOyB9XG4gICAgcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSA9IG1vZGUgJiYge1xuICAgICAgICBjb3VudGVyczogY291bnRlcnNQcm9maWxlRnVuY3Rpb25GYWN0b3J5LFxuICAgICAgICB0aW1lbGluZTogdGltZWxpbmVQcm9maWxlRnVuY3Rpb25GYWN0b3J5XG4gICAgfVttb2RlXTtcbiAgICB0cmFjaW5nTGV2ZWwgPSB7XG4gICAgICAgIGxpZmVjeWNsZTogTGV2ZWwubGlmZWN5Y2xlLFxuICAgICAgICB0aW1lbGluZTogTGV2ZWwudGltZWxpbmUsXG4gICAgfVttb2RlXSB8fCBMZXZlbC5ub25lO1xufVxuZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG50cnkge1xuICAgIHZhciBhcHBDb25maWcgPSByZXF1aXJlKFwifi9wYWNrYWdlLmpzb25cIik7XG4gICAgaWYgKGFwcENvbmZpZyAmJiBhcHBDb25maWcucHJvZmlsaW5nKSB7XG4gICAgICAgIGVuYWJsZShhcHBDb25maWcucHJvZmlsaW5nKTtcbiAgICB9XG59XG5jYXRjaCAoZTEpIHtcbiAgICB0cnkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlByb2ZpbGluZyBzdGFydHVwIGZhaWxlZCB0byBmaWd1cmUgb3V0IGRlZmF1bHRzIGZyb20gcGFja2FnZS5qc29uLCBlcnJvcjogXCIgKyBlMSk7XG4gICAgfVxuICAgIGNhdGNoIChlMikge1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRpc2FibGUoKSB7XG4gICAgcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSA9IHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5mdW5jdGlvbiBwcm9maWxlRnVuY3Rpb24oZm4sIGN1c3RvbU5hbWUpIHtcbiAgICByZXR1cm4gcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeShmbiwgY3VzdG9tTmFtZSB8fCBmbi5uYW1lKTtcbn1cbnZhciBwcm9maWxlTWV0aG9kVW5uYW1lZCA9IGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgIGlmIChkZXNjcmlwdG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpO1xuICAgIH1cbiAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIHZhciBjbGFzc05hbWUgPSBcIlwiO1xuICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0LmNvbnN0cnVjdG9yICYmIHRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lKSB7XG4gICAgICAgIGNsYXNzTmFtZSA9IHRhcmdldC5jb25zdHJ1Y3Rvci5uYW1lICsgXCIuXCI7XG4gICAgfVxuICAgIHZhciBuYW1lID0gY2xhc3NOYW1lICsga2V5O1xuICAgIGRlc2NyaXB0b3IudmFsdWUgPSBwcm9maWxlRnVuY3Rpb25GYWN0b3J5KG9yaWdpbmFsTWV0aG9kLCBuYW1lLCAxKTtcbiAgICByZXR1cm4gZGVzY3JpcHRvcjtcbn07XG52YXIgcHJvZmlsZVN0YXRpY01ldGhvZFVubmFtZWQgPSBmdW5jdGlvbiAoY3Rvciwga2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgaWYgKGRlc2NyaXB0b3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihjdG9yLCBrZXkpO1xuICAgIH1cbiAgICB2YXIgb3JpZ2luYWxNZXRob2QgPSBkZXNjcmlwdG9yLnZhbHVlO1xuICAgIHZhciBjbGFzc05hbWUgPSBcIlwiO1xuICAgIGlmIChjdG9yICYmIGN0b3IubmFtZSkge1xuICAgICAgICBjbGFzc05hbWUgPSBjdG9yLm5hbWUgKyBcIi5cIjtcbiAgICB9XG4gICAgdmFyIG5hbWUgPSBjbGFzc05hbWUgKyBrZXk7XG4gICAgZGVzY3JpcHRvci52YWx1ZSA9IHByb2ZpbGVGdW5jdGlvbkZhY3Rvcnkob3JpZ2luYWxNZXRob2QsIG5hbWUsIDApO1xuICAgIHJldHVybiBkZXNjcmlwdG9yO1xufTtcbmZ1bmN0aW9uIHByb2ZpbGVNZXRob2ROYW1lZChuYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSwgZGVzY3JpcHRvcikge1xuICAgICAgICBpZiAoZGVzY3JpcHRvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBkZXNjcmlwdG9yID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcbiAgICAgICAgZGVzY3JpcHRvci52YWx1ZSA9IHByb2ZpbGVGdW5jdGlvbkZhY3Rvcnkob3JpZ2luYWxNZXRob2QsIG5hbWUpO1xuICAgICAgICByZXR1cm4gZGVzY3JpcHRvcjtcbiAgICB9O1xufVxudmFyIHZvaWRNZXRob2REZWNvcmF0b3IgPSBmdW5jdGlvbiAoKSB7XG59O1xuZnVuY3Rpb24gcHJvZmlsZShuYW1lRm5PclRhcmdldCwgZm5PcktleSwgZGVzY3JpcHRvcikge1xuICAgIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwib2JqZWN0XCIgJiYgKHR5cGVvZiBmbk9yS2V5ID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBmbk9yS2V5ID09PSBcInN5bWJvbFwiKSkge1xuICAgICAgICBpZiAoIXByb2ZpbGVGdW5jdGlvbkZhY3RvcnkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZU1ldGhvZFVubmFtZWQobmFtZUZuT3JUYXJnZXQsIGZuT3JLZXksIGRlc2NyaXB0b3IpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwiZnVuY3Rpb25cIiAmJiAodHlwZW9mIGZuT3JLZXkgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGZuT3JLZXkgPT09IFwic3ltYm9sXCIpKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlU3RhdGljTWV0aG9kVW5uYW1lZChuYW1lRm5PclRhcmdldCwgZm5PcktleSwgZGVzY3JpcHRvcik7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJzdHJpbmdcIiAmJiB0eXBlb2YgZm5PcktleSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIGZuT3JLZXk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVGdW5jdGlvbihmbk9yS2V5LCBuYW1lRm5PclRhcmdldCk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBuYW1lRm5PclRhcmdldCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIG5hbWVGbk9yVGFyZ2V0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9maWxlRnVuY3Rpb24obmFtZUZuT3JUYXJnZXQpO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgbmFtZUZuT3JUYXJnZXQgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgaWYgKCFwcm9maWxlRnVuY3Rpb25GYWN0b3J5KSB7XG4gICAgICAgICAgICByZXR1cm4gdm9pZE1ldGhvZERlY29yYXRvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvZmlsZU1ldGhvZE5hbWVkKG5hbWVGbk9yVGFyZ2V0KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGlmICghcHJvZmlsZUZ1bmN0aW9uRmFjdG9yeSkge1xuICAgICAgICAgICAgcmV0dXJuIHZvaWRNZXRob2REZWNvcmF0b3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHByb2ZpbGVNZXRob2RVbm5hbWVkO1xuICAgIH1cbn1cbmV4cG9ydHMucHJvZmlsZSA9IHByb2ZpbGU7XG5mdW5jdGlvbiBkdW1wUHJvZmlsZXMoKSB7XG4gICAgcHJvZmlsZU5hbWVzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGluZm8gPSB0aW1lcnNbbmFtZV07XG4gICAgICAgIGlmIChpbmZvKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0gW1wiICsgbmFtZSArIFwiXSBTVE9QIHRvdGFsOiBcIiArIGluZm8udG90YWxUaW1lICsgXCIgY291bnQ6XCIgKyBpbmZvLmNvdW50KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLSBbXCIgKyBuYW1lICsgXCJdIE5ldmVyIGNhbGxlZFwiKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5kdW1wUHJvZmlsZXMgPSBkdW1wUHJvZmlsZXM7XG5mdW5jdGlvbiByZXNldFByb2ZpbGVzKCkge1xuICAgIHByb2ZpbGVOYW1lcy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBpbmZvID0gdGltZXJzW25hbWVdO1xuICAgICAgICBpZiAoaW5mbykge1xuICAgICAgICAgICAgaWYgKGluZm8ucnVuQ291bnQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi0tLS0gdGltZXIgd2l0aCBuYW1lIFtcIiArIG5hbWUgKyBcIl0gaXMgY3VycmVudGx5IHJ1bm5pbmcgYW5kIHdvbid0IGJlIHJlc2V0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGltZXJzW25hbWVdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLnJlc2V0UHJvZmlsZXMgPSByZXNldFByb2ZpbGVzO1xuZnVuY3Rpb24gc3RhcnRDUFVQcm9maWxlKG5hbWUpIHtcbiAgICBpZiAoYW55R2xvYmFsLmFuZHJvaWQpIHtcbiAgICAgICAgX19zdGFydENQVVByb2ZpbGVyKG5hbWUpO1xuICAgIH1cbn1cbmV4cG9ydHMuc3RhcnRDUFVQcm9maWxlID0gc3RhcnRDUFVQcm9maWxlO1xuZnVuY3Rpb24gc3RvcENQVVByb2ZpbGUobmFtZSkge1xuICAgIGlmIChhbnlHbG9iYWwuYW5kcm9pZCkge1xuICAgICAgICBfX3N0b3BDUFVQcm9maWxlcihuYW1lKTtcbiAgICB9XG59XG5leHBvcnRzLnN0b3BDUFVQcm9maWxlID0gc3RvcENQVVByb2ZpbGU7XG5mdW5jdGlvbiBsZXZlbCgpIHtcbiAgICByZXR1cm4gdHJhY2luZ0xldmVsO1xufVxuZXhwb3J0cy5sZXZlbCA9IGxldmVsO1xuZnVuY3Rpb24gdHJhY2UobWVzc2FnZSwgc3RhcnQsIGVuZCkge1xuICAgIGxvZyhcIlRpbWVsaW5lOiBNb2R1bGVzOiBcIiArIG1lc3NhZ2UgKyBcIiAgKFwiICsgc3RhcnQgKyBcIm1zLiAtIFwiICsgZW5kICsgXCJtcy4pXCIpO1xufVxuZXhwb3J0cy50cmFjZSA9IHRyYWNlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvZmlsaW5nLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBzcGFuXzEgPSByZXF1aXJlKFwiLi9zcGFuXCIpO1xuZXhwb3J0cy5TcGFuID0gc3Bhbl8xLlNwYW47XG52YXIgb2JzZXJ2YWJsZV8xID0gcmVxdWlyZShcIi4uL2RhdGEvb2JzZXJ2YWJsZVwiKTtcbnZhciBvYnNlcnZhYmxlX2FycmF5XzEgPSByZXF1aXJlKFwiLi4vZGF0YS9vYnNlcnZhYmxlLWFycmF5XCIpO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi91aS9jb3JlL3ZpZXdcIik7XG52YXIga25vd25Db2xsZWN0aW9ucztcbihmdW5jdGlvbiAoa25vd25Db2xsZWN0aW9ucykge1xuICAgIGtub3duQ29sbGVjdGlvbnMuc3BhbnMgPSBcInNwYW5zXCI7XG59KShrbm93bkNvbGxlY3Rpb25zID0gZXhwb3J0cy5rbm93bkNvbGxlY3Rpb25zIHx8IChleHBvcnRzLmtub3duQ29sbGVjdGlvbnMgPSB7fSkpO1xudmFyIEZvcm1hdHRlZFN0cmluZyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZvcm1hdHRlZFN0cmluZywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGb3JtYXR0ZWRTdHJpbmcoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9zcGFucyA9IG5ldyBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgICAgIF90aGlzLl9zcGFucy5hZGRFdmVudExpc3RlbmVyKG9ic2VydmFibGVfYXJyYXlfMS5PYnNlcnZhYmxlQXJyYXkuY2hhbmdlRXZlbnQsIF90aGlzLm9uU3BhbnNDb2xsZWN0aW9uQ2hhbmdlZCwgX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImZvbnRGYW1pbHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRGYW1pbHk7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRGYW1pbHkgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwiZm9udFNpemVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTaXplO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250U2l6ZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJmb250U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImZvbnRXZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRXZWlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRXZWlnaHQgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwidGV4dERlY29yYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0dGVkU3RyaW5nLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLCBcImJhY2tncm91bmRDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUsIFwic3BhbnNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc3BhbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zcGFucyA9IG5ldyBvYnNlcnZhYmxlX2FycmF5XzEuT2JzZXJ2YWJsZUFycmF5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3BhbnM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBcIlwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSB0aGlzLl9zcGFucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5fc3BhbnMuZ2V0SXRlbShpKS50ZXh0O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLl9hZGRBcnJheUZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmIChuYW1lID09PSBrbm93bkNvbGxlY3Rpb25zLnNwYW5zKSB7XG4gICAgICAgICAgICB0aGlzLnNwYW5zLnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLl9hZGRDaGlsZEZyb21CdWlsZGVyID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIHNwYW5fMS5TcGFuKSB7XG4gICAgICAgICAgICB0aGlzLnNwYW5zLnB1c2godmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLm9uU3BhbnNDb2xsZWN0aW9uQ2hhbmdlZCA9IGZ1bmN0aW9uIChldmVudERhdGEpIHtcbiAgICAgICAgaWYgKGV2ZW50RGF0YS5hZGRlZENvdW50ID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudERhdGEuYWRkZWRDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNwYW4gPSBldmVudERhdGEub2JqZWN0LmdldEl0ZW0oZXZlbnREYXRhLmluZGV4ICsgaSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWRkVmlldyhzcGFuKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFkZFByb3BlcnR5Q2hhbmdlSGFuZGxlcihzcGFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZXZlbnREYXRhLnJlbW92ZWQgJiYgZXZlbnREYXRhLnJlbW92ZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgcCA9IDA7IHAgPCBldmVudERhdGEucmVtb3ZlZC5sZW5ndGg7IHArKykge1xuICAgICAgICAgICAgICAgIHZhciBzcGFuID0gZXZlbnREYXRhLnJlbW92ZWRbcF07XG4gICAgICAgICAgICAgICAgdGhpcy5yZW1vdmVQcm9wZXJ0eUNoYW5nZUhhbmRsZXIoc3Bhbik7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtb3ZlVmlldyhzcGFuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKFwiLlwiLCB0aGlzKTtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUuYWRkUHJvcGVydHlDaGFuZ2VIYW5kbGVyID0gZnVuY3Rpb24gKHNwYW4pIHtcbiAgICAgICAgdmFyIHN0eWxlID0gc3Bhbi5zdHlsZTtcbiAgICAgICAgc3Bhbi5vbihvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRGYW1pbHlDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJmb250U2l6ZUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRTdHlsZUNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImZvbnRXZWlnaHRDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub24oXCJ0ZXh0RGVjb3JhdGlvbkNoYW5nZVwiLCB0aGlzLm9uUHJvcGVydHlDaGFuZ2UsIHRoaXMpO1xuICAgICAgICBzdHlsZS5vbihcImNvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9uKFwiYmFja2dyb3VuZENvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLnJlbW92ZVByb3BlcnR5Q2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzcGFuKSB7XG4gICAgICAgIHZhciBzdHlsZSA9IHNwYW4uc3R5bGU7XG4gICAgICAgIHNwYW4ub2ZmKG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImZvbnRGYW1pbHlDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiZm9udFNpemVDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiZm9udFN0eWxlQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgICAgIHN0eWxlLm9mZihcImZvbnRXZWlnaHRDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwidGV4dERlY29yYXRpb25DaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiY29sb3JDaGFuZ2VcIiwgdGhpcy5vblByb3BlcnR5Q2hhbmdlLCB0aGlzKTtcbiAgICAgICAgc3R5bGUub2ZmKFwiYmFja2dyb3VuZENvbG9yQ2hhbmdlXCIsIHRoaXMub25Qcm9wZXJ0eUNoYW5nZSwgdGhpcyk7XG4gICAgfTtcbiAgICBGb3JtYXR0ZWRTdHJpbmcucHJvdG90eXBlLm9uUHJvcGVydHlDaGFuZ2UgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKGRhdGEucHJvcGVydHlOYW1lLCB0aGlzKTtcbiAgICB9O1xuICAgIEZvcm1hdHRlZFN0cmluZy5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuc3BhbnMuZm9yRWFjaChmdW5jdGlvbiAodiwgaSwgYXJyKSB7IHJldHVybiBjYWxsYmFjayh2KTsgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gRm9ybWF0dGVkU3RyaW5nO1xufSh2aWV3XzEuVmlld0Jhc2UpKTtcbmV4cG9ydHMuRm9ybWF0dGVkU3RyaW5nID0gRm9ybWF0dGVkU3RyaW5nO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zm9ybWF0dGVkLXN0cmluZy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL3VpL2NvcmUvdmlld1wiKTtcbnZhciBTcGFuID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3BhbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTcGFuKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250RmFtaWx5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250RmFtaWx5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250RmFtaWx5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250U2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmZvbnRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJmb250V2VpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250V2VpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5mb250V2VpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJ0ZXh0RGVjb3JhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnRleHREZWNvcmF0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTcGFuLnByb3RvdHlwZSwgXCJ0ZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90ZXh0ICE9PSB2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RleHQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKFwidGV4dFwiLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFNwYW4ucHJvdG90eXBlLl9zZXRUZXh0SW50ZXJuYWwgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdGV4dCA9IHZhbHVlO1xuICAgIH07XG4gICAgcmV0dXJuIFNwYW47XG59KHZpZXdfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5TcGFuID0gU3Bhbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNwYW4uanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVuY29kaW5nO1xuKGZ1bmN0aW9uIChlbmNvZGluZykge1xuICAgIGVuY29kaW5nLklTT184ODU5XzEgPSA1O1xuICAgIGVuY29kaW5nLlVTX0FTQ0lJID0gMTtcbiAgICBlbmNvZGluZy5VVEZfMTYgPSAxMDtcbiAgICBlbmNvZGluZy5VVEZfMTZCRSA9IDB4OTAwMDAxMDA7XG4gICAgZW5jb2RpbmcuVVRGXzE2TEUgPSAweDk0MDAwMTAwO1xuICAgIGVuY29kaW5nLlVURl84ID0gNDtcbn0pKGVuY29kaW5nID0gZXhwb3J0cy5lbmNvZGluZyB8fCAoZXhwb3J0cy5lbmNvZGluZyA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0Lmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGltZW91dENhbGxiYWNrcyA9IG5ldyBNYXAoKTtcbnZhciB0aW1lcklkID0gMDtcbnZhciBUaW1lclRhcmdldEltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUaW1lclRhcmdldEltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGltZXJUYXJnZXRJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRpbWVyVGFyZ2V0SW1wbC5pbml0V2l0aENhbGxiYWNrID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBpZCwgc2hvdWxkUmVwZWF0KSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gVGltZXJUYXJnZXRJbXBsLm5ldygpO1xuICAgICAgICBoYW5kbGVyLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIGhhbmRsZXIuaWQgPSBpZDtcbiAgICAgICAgaGFuZGxlci5zaG91bGRSZXBlYXQgPSBzaG91bGRSZXBlYXQ7XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVGltZXJUYXJnZXRJbXBsLnByb3RvdHlwZS50aWNrID0gZnVuY3Rpb24gKHRpbWVyKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNwb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFjaygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5zaG91bGRSZXBlYXQpIHtcbiAgICAgICAgICAgIHRoaXMudW5yZWdpc3RlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUaW1lclRhcmdldEltcGwucHJvdG90eXBlLnVucmVnaXN0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5kaXNwb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5kaXNwb3NlZCA9IHRydWU7XG4gICAgICAgICAgICB2YXIgdGltZXIgPSB0aW1lb3V0Q2FsbGJhY2tzLmdldCh0aGlzLmlkKS5rO1xuICAgICAgICAgICAgdGltZXIuaW52YWxpZGF0ZSgpO1xuICAgICAgICAgICAgdGltZW91dENhbGxiYWNrcy5kZWxldGUodGhpcy5pZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRpbWVyVGFyZ2V0SW1wbC5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwidGlja1wiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbTlNUaW1lcl0gfVxuICAgIH07XG4gICAgcmV0dXJuIFRpbWVyVGFyZ2V0SW1wbDtcbn0oTlNPYmplY3QpKTtcbmZ1bmN0aW9uIGNyZWF0ZVRpbWVyQW5kR2V0SWQoY2FsbGJhY2ssIG1pbGxpc2Vjb25kcywgc2hvdWxkUmVwZWF0KSB7XG4gICAgdGltZXJJZCsrO1xuICAgIHZhciBpZCA9IHRpbWVySWQ7XG4gICAgdmFyIHRpbWVyVGFyZ2V0ID0gVGltZXJUYXJnZXRJbXBsLmluaXRXaXRoQ2FsbGJhY2soY2FsbGJhY2ssIGlkLCBzaG91bGRSZXBlYXQpO1xuICAgIHZhciB0aW1lciA9IE5TVGltZXIuc2NoZWR1bGVkVGltZXJXaXRoVGltZUludGVydmFsVGFyZ2V0U2VsZWN0b3JVc2VySW5mb1JlcGVhdHMobWlsbGlzZWNvbmRzIC8gMTAwMCwgdGltZXJUYXJnZXQsIFwidGlja1wiLCBudWxsLCBzaG91bGRSZXBlYXQpO1xuICAgIE5TUnVuTG9vcC5jdXJyZW50UnVuTG9vcC5hZGRUaW1lckZvck1vZGUodGltZXIsIE5TUnVuTG9vcENvbW1vbk1vZGVzKTtcbiAgICB2YXIgcGFpciA9IHsgazogdGltZXIsIHY6IHRpbWVyVGFyZ2V0IH07XG4gICAgdGltZW91dENhbGxiYWNrcy5zZXQoaWQsIHBhaXIpO1xuICAgIHJldHVybiBpZDtcbn1cbmZ1bmN0aW9uIHNldFRpbWVvdXQoY2FsbGJhY2ssIG1pbGxpc2Vjb25kcykge1xuICAgIGlmIChtaWxsaXNlY29uZHMgPT09IHZvaWQgMCkgeyBtaWxsaXNlY29uZHMgPSAwOyB9XG4gICAgdmFyIGFyZ3MgPSBbXTtcbiAgICBmb3IgKHZhciBfaSA9IDI7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICBhcmdzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgaW52b2tlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FsbGJhY2suYXBwbHkodm9pZCAwLCBhcmdzKTsgfTtcbiAgICByZXR1cm4gY3JlYXRlVGltZXJBbmRHZXRJZCh6b25lZENhbGxiYWNrKGludm9rZSksIG1pbGxpc2Vjb25kcywgZmFsc2UpO1xufVxuZXhwb3J0cy5zZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbmZ1bmN0aW9uIGNsZWFyVGltZW91dChpZCkge1xuICAgIHZhciBwYWlyID0gdGltZW91dENhbGxiYWNrcy5nZXQoaWQpO1xuICAgIGlmIChwYWlyKSB7XG4gICAgICAgIHBhaXIudi51bnJlZ2lzdGVyKCk7XG4gICAgfVxufVxuZXhwb3J0cy5jbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG5mdW5jdGlvbiBzZXRJbnRlcnZhbChjYWxsYmFjaywgbWlsbGlzZWNvbmRzKSB7XG4gICAgaWYgKG1pbGxpc2Vjb25kcyA9PT0gdm9pZCAwKSB7IG1pbGxpc2Vjb25kcyA9IDA7IH1cbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2kgLSAyXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgfVxuICAgIHZhciBpbnZva2UgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBjYWxsYmFjay5hcHBseSh2b2lkIDAsIGFyZ3MpOyB9O1xuICAgIHJldHVybiBjcmVhdGVUaW1lckFuZEdldElkKHpvbmVkQ2FsbGJhY2soaW52b2tlKSwgbWlsbGlzZWNvbmRzLCB0cnVlKTtcbn1cbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBzZXRJbnRlcnZhbDtcbmV4cG9ydHMuY2xlYXJJbnRlcnZhbCA9IGNsZWFyVGltZW91dDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRpbWVyLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW5hYmxlZCA9IGZhbHNlO1xudmFyIF9jYXRlZ29yaWVzID0ge307XG52YXIgX3dyaXRlcnMgPSBbXTtcbnZhciBfZXZlbnRMaXN0ZW5lcnMgPSBbXTtcbnZhciBfZXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgIGVuYWJsZWQgPSB0cnVlO1xufVxuZXhwb3J0cy5lbmFibGUgPSBlbmFibGU7XG5mdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIGVuYWJsZWQgPSBmYWxzZTtcbn1cbmV4cG9ydHMuZGlzYWJsZSA9IGRpc2FibGU7XG5mdW5jdGlvbiBpc0VuYWJsZWQoKSB7XG4gICAgcmV0dXJuIGVuYWJsZWQ7XG59XG5leHBvcnRzLmlzRW5hYmxlZCA9IGlzRW5hYmxlZDtcbmZ1bmN0aW9uIGlzQ2F0ZWdvcnlTZXQoY2F0ZWdvcnkpIHtcbiAgICByZXR1cm4gY2F0ZWdvcnkgaW4gX2NhdGVnb3JpZXM7XG59XG5leHBvcnRzLmlzQ2F0ZWdvcnlTZXQgPSBpc0NhdGVnb3J5U2V0O1xuZnVuY3Rpb24gYWRkV3JpdGVyKHdyaXRlcikge1xuICAgIF93cml0ZXJzLnB1c2god3JpdGVyKTtcbn1cbmV4cG9ydHMuYWRkV3JpdGVyID0gYWRkV3JpdGVyO1xuZnVuY3Rpb24gcmVtb3ZlV3JpdGVyKHdyaXRlcikge1xuICAgIHZhciBpbmRleCA9IF93cml0ZXJzLmluZGV4T2Yod3JpdGVyKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBfd3JpdGVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlV3JpdGVyID0gcmVtb3ZlV3JpdGVyO1xuZnVuY3Rpb24gY2xlYXJXcml0ZXJzKCkge1xuICAgIGlmIChfd3JpdGVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIF93cml0ZXJzLnNwbGljZSgwLCBfd3JpdGVycy5sZW5ndGgpO1xuICAgIH1cbn1cbmV4cG9ydHMuY2xlYXJXcml0ZXJzID0gY2xlYXJXcml0ZXJzO1xuZnVuY3Rpb24gc2V0Q2F0ZWdvcmllcyhjYXRlZ29yaWVzKSB7XG4gICAgX2NhdGVnb3JpZXMgPSB7fTtcbiAgICBhZGRDYXRlZ29yaWVzKGNhdGVnb3JpZXMpO1xufVxuZXhwb3J0cy5zZXRDYXRlZ29yaWVzID0gc2V0Q2F0ZWdvcmllcztcbmZ1bmN0aW9uIGFkZENhdGVnb3JpZXMoY2F0ZWdvcmllcykge1xuICAgIHZhciBzcGxpdCA9IGNhdGVnb3JpZXMuc3BsaXQoXCIsXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BsaXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgX2NhdGVnb3JpZXNbc3BsaXRbaV0udHJpbSgpXSA9IHRydWU7XG4gICAgfVxufVxuZXhwb3J0cy5hZGRDYXRlZ29yaWVzID0gYWRkQ2F0ZWdvcmllcztcbmZ1bmN0aW9uIHdyaXRlKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKSB7XG4gICAgdmFyIGk7XG4gICAgaWYgKHR5cGUgPT09IG1lc3NhZ2VUeXBlLmVycm9yKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBfd3JpdGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX3dyaXRlcnNbaV0ud3JpdGUobWVzc2FnZSwgY2F0ZWdvcnksIHR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCFlbmFibGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKCEoY2F0ZWdvcnkgaW4gX2NhdGVnb3JpZXMpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZm9yIChpID0gMDsgaSA8IF93cml0ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIF93cml0ZXJzW2ldLndyaXRlKG1lc3NhZ2UsIGNhdGVnb3J5LCB0eXBlKTtcbiAgICB9XG59XG5leHBvcnRzLndyaXRlID0gd3JpdGU7XG5mdW5jdGlvbiBub3RpZnlFdmVudChvYmplY3QsIG5hbWUsIGRhdGEpIHtcbiAgICBpZiAoIWVuYWJsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaSwgbGlzdGVuZXIsIGZpbHRlcnM7XG4gICAgZm9yIChpID0gMDsgaSA8IF9ldmVudExpc3RlbmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsaXN0ZW5lciA9IF9ldmVudExpc3RlbmVyc1tpXTtcbiAgICAgICAgaWYgKGxpc3RlbmVyLmZpbHRlcikge1xuICAgICAgICAgICAgZmlsdGVycyA9IGxpc3RlbmVyLmZpbHRlci5zcGxpdChcIixcIik7XG4gICAgICAgICAgICBmaWx0ZXJzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnRyaW0oKSA9PT0gbmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lci5vbihvYmplY3QsIG5hbWUsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbGlzdGVuZXIub24ob2JqZWN0LCBuYW1lLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMubm90aWZ5RXZlbnQgPSBub3RpZnlFdmVudDtcbmZ1bmN0aW9uIGFkZEV2ZW50TGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICBfZXZlbnRMaXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XG59XG5leHBvcnRzLmFkZEV2ZW50TGlzdGVuZXIgPSBhZGRFdmVudExpc3RlbmVyO1xuZnVuY3Rpb24gcmVtb3ZlRXZlbnRMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgIHZhciBpbmRleCA9IF9ldmVudExpc3RlbmVycy5pbmRleE9mKGxpc3RlbmVyKTtcbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICBfZXZlbnRMaXN0ZW5lcnMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9XG59XG5leHBvcnRzLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSByZW1vdmVFdmVudExpc3RlbmVyO1xudmFyIG1lc3NhZ2VUeXBlO1xuKGZ1bmN0aW9uIChtZXNzYWdlVHlwZSkge1xuICAgIG1lc3NhZ2VUeXBlLmxvZyA9IDA7XG4gICAgbWVzc2FnZVR5cGUuaW5mbyA9IDE7XG4gICAgbWVzc2FnZVR5cGUud2FybiA9IDI7XG4gICAgbWVzc2FnZVR5cGUuZXJyb3IgPSAzO1xufSkobWVzc2FnZVR5cGUgPSBleHBvcnRzLm1lc3NhZ2VUeXBlIHx8IChleHBvcnRzLm1lc3NhZ2VUeXBlID0ge30pKTtcbnZhciBjYXRlZ29yaWVzO1xuKGZ1bmN0aW9uIChjYXRlZ29yaWVzKSB7XG4gICAgY2F0ZWdvcmllcy5WaXN1YWxUcmVlRXZlbnRzID0gXCJWaXN1YWxUcmVlRXZlbnRzXCI7XG4gICAgY2F0ZWdvcmllcy5MYXlvdXQgPSBcIkxheW91dFwiO1xuICAgIGNhdGVnb3JpZXMuU3R5bGUgPSBcIlN0eWxlXCI7XG4gICAgY2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5ID0gXCJWaWV3SGllcmFyY2h5XCI7XG4gICAgY2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUgPSBcIk5hdGl2ZUxpZmVjeWNsZVwiO1xuICAgIGNhdGVnb3JpZXMuRGVidWcgPSBcIkRlYnVnXCI7XG4gICAgY2F0ZWdvcmllcy5OYXZpZ2F0aW9uID0gXCJOYXZpZ2F0aW9uXCI7XG4gICAgY2F0ZWdvcmllcy5UZXN0ID0gXCJUZXN0XCI7XG4gICAgY2F0ZWdvcmllcy5CaW5kaW5nID0gXCJCaW5kaW5nXCI7XG4gICAgY2F0ZWdvcmllcy5CaW5kaW5nRXJyb3IgPSBcIkJpbmRpbmdFcnJvclwiO1xuICAgIGNhdGVnb3JpZXMuRXJyb3IgPSBcIkVycm9yXCI7XG4gICAgY2F0ZWdvcmllcy5BbmltYXRpb24gPSBcIkFuaW1hdGlvblwiO1xuICAgIGNhdGVnb3JpZXMuVHJhbnNpdGlvbiA9IFwiVHJhbnNpdGlvblwiO1xuICAgIGNhdGVnb3JpZXMuTGl2ZXN5bmMgPSBcIkxpdmVzeW5jXCI7XG4gICAgY2F0ZWdvcmllcy5zZXBhcmF0b3IgPSBcIixcIjtcbiAgICBjYXRlZ29yaWVzLkFsbCA9IGNhdGVnb3JpZXMuVmlzdWFsVHJlZUV2ZW50cyArIGNhdGVnb3JpZXMuc2VwYXJhdG9yXG4gICAgICAgICsgY2F0ZWdvcmllcy5MYXlvdXQgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuU3R5bGUgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSArIGNhdGVnb3JpZXMuc2VwYXJhdG9yXG4gICAgICAgICsgY2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuRGVidWcgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuTmF2aWdhdGlvbiArIGNhdGVnb3JpZXMuc2VwYXJhdG9yXG4gICAgICAgICsgY2F0ZWdvcmllcy5UZXN0ICsgY2F0ZWdvcmllcy5zZXBhcmF0b3JcbiAgICAgICAgKyBjYXRlZ29yaWVzLkJpbmRpbmcgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuRXJyb3IgKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuQW5pbWF0aW9uICsgY2F0ZWdvcmllcy5zZXBhcmF0b3JcbiAgICAgICAgKyBjYXRlZ29yaWVzLlRyYW5zaXRpb24gKyBjYXRlZ29yaWVzLnNlcGFyYXRvclxuICAgICAgICArIGNhdGVnb3JpZXMuTGl2ZXN5bmM7XG4gICAgZnVuY3Rpb24gY29uY2F0KCkge1xuICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKCFyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KGNhdGVnb3JpZXMuc2VwYXJhdG9yLCBhcmd1bWVudHNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGNhdGVnb3JpZXMuY29uY2F0ID0gY29uY2F0O1xufSkoY2F0ZWdvcmllcyA9IGV4cG9ydHMuY2F0ZWdvcmllcyB8fCAoZXhwb3J0cy5jYXRlZ29yaWVzID0ge30pKTtcbnZhciBDb25zb2xlV3JpdGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb25zb2xlV3JpdGVyKCkge1xuICAgIH1cbiAgICBDb25zb2xlV3JpdGVyLnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uIChtZXNzYWdlLCBjYXRlZ29yeSwgdHlwZSkge1xuICAgICAgICBpZiAoIWNvbnNvbGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXNnVHlwZTtcbiAgICAgICAgaWYgKHR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbXNnVHlwZSA9IG1lc3NhZ2VUeXBlLmxvZztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1zZ1R5cGUgPSB0eXBlO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAobXNnVHlwZSkge1xuICAgICAgICAgICAgY2FzZSBtZXNzYWdlVHlwZS5sb2c6XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUuaW5mbzpcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUud2FybjpcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oY2F0ZWdvcnkgKyBcIjogXCIgKyBtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgbWVzc2FnZVR5cGUuZXJyb3I6XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihjYXRlZ29yeSArIFwiOiBcIiArIG1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gQ29uc29sZVdyaXRlcjtcbn0oKSk7XG5hZGRXcml0ZXIobmV3IENvbnNvbGVXcml0ZXIoKSk7XG52YXIgRGVmYXVsdEVycm9ySGFuZGxlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRGVmYXVsdEVycm9ySGFuZGxlcigpIHtcbiAgICB9XG4gICAgRGVmYXVsdEVycm9ySGFuZGxlci5wcm90b3R5cGUuaGFuZGxlckVycm9yID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIHRocm93IGVycm9yO1xuICAgIH07XG4gICAgcmV0dXJuIERlZmF1bHRFcnJvckhhbmRsZXI7XG59KCkpO1xuZXhwb3J0cy5EZWZhdWx0RXJyb3JIYW5kbGVyID0gRGVmYXVsdEVycm9ySGFuZGxlcjtcbnNldEVycm9ySGFuZGxlcihuZXcgRGVmYXVsdEVycm9ySGFuZGxlcigpKTtcbmZ1bmN0aW9uIGdldEVycm9ySGFuZGxlcigpIHtcbiAgICByZXR1cm4gX2Vycm9ySGFuZGxlcjtcbn1cbmV4cG9ydHMuZ2V0RXJyb3JIYW5kbGVyID0gZ2V0RXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gc2V0RXJyb3JIYW5kbGVyKGhhbmRsZXIpIHtcbiAgICBfZXJyb3JIYW5kbGVyID0gaGFuZGxlcjtcbn1cbmV4cG9ydHMuc2V0RXJyb3JIYW5kbGVyID0gc2V0RXJyb3JIYW5kbGVyO1xuZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcbiAgICBpZiAoIV9lcnJvckhhbmRsZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVycm9yID0gbmV3IEVycm9yKGVycm9yKTtcbiAgICB9XG4gICAgX2Vycm9ySGFuZGxlci5oYW5kbGVyRXJyb3IoZXJyb3IpO1xufVxuZXhwb3J0cy5lcnJvciA9IGVycm9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJhY2UuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG5leHBvcnRzLkNvbG9yID0gY29sb3JfMS5Db2xvcjtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xuZXhwb3J0cy50cmFjZUVuYWJsZWQgPSB0cmFjZV8xLmlzRW5hYmxlZDtcbmV4cG9ydHMudHJhY2VXcml0ZSA9IHRyYWNlXzEud3JpdGU7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcmllcyA9IHRyYWNlXzEuY2F0ZWdvcmllcztcbmV4cG9ydHMudHJhY2VUeXBlID0gdHJhY2VfMS5tZXNzYWdlVHlwZTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIFByb3BlcnRpZXM7XG4oZnVuY3Rpb24gKFByb3BlcnRpZXMpIHtcbiAgICBQcm9wZXJ0aWVzLm9wYWNpdHkgPSBcIm9wYWNpdHlcIjtcbiAgICBQcm9wZXJ0aWVzLmJhY2tncm91bmRDb2xvciA9IFwiYmFja2dyb3VuZENvbG9yXCI7XG4gICAgUHJvcGVydGllcy50cmFuc2xhdGUgPSBcInRyYW5zbGF0ZVwiO1xuICAgIFByb3BlcnRpZXMucm90YXRlID0gXCJyb3RhdGVcIjtcbiAgICBQcm9wZXJ0aWVzLnNjYWxlID0gXCJzY2FsZVwiO1xuICAgIFByb3BlcnRpZXMuaGVpZ2h0ID0gXCJoZWlnaHRcIjtcbiAgICBQcm9wZXJ0aWVzLndpZHRoID0gXCJ3aWR0aFwiO1xufSkoUHJvcGVydGllcyA9IGV4cG9ydHMuUHJvcGVydGllcyB8fCAoZXhwb3J0cy5Qcm9wZXJ0aWVzID0ge30pKTtcbnZhciBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDdWJpY0JlemllckFuaW1hdGlvbkN1cnZlKHgxLCB5MSwgeDIsIHkyKSB7XG4gICAgICAgIHRoaXMueDEgPSB4MTtcbiAgICAgICAgdGhpcy55MSA9IHkxO1xuICAgICAgICB0aGlzLngyID0geDI7XG4gICAgICAgIHRoaXMueTIgPSB5MjtcbiAgICB9XG4gICAgcmV0dXJuIEN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmU7XG59KCkpO1xuZXhwb3J0cy5DdWJpY0JlemllckFuaW1hdGlvbkN1cnZlID0gQ3ViaWNCZXppZXJBbmltYXRpb25DdXJ2ZTtcbnZhciBBbmltYXRpb25CYXNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBbmltYXRpb25CYXNlKGFuaW1hdGlvbkRlZmluaXRpb25zLCBwbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgIGlmICghYW5pbWF0aW9uRGVmaW5pdGlvbnMgfHwgYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBhbmltYXRpb24gZGVmaW5pdGlvbnMgc3BlY2lmaWVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQW5hbHl6aW5nIFwiICsgYW5pbWF0aW9uRGVmaW5pdGlvbnMubGVuZ3RoICsgXCIgYW5pbWF0aW9uIGRlZmluaXRpb25zLi4uXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBhbmltYXRpb25EZWZpbml0aW9ucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbnNbaV0uY3VydmUpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSA9IHRoaXMuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZShhbmltYXRpb25EZWZpbml0aW9uc1tpXS5jdXJ2ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMgPSB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMuY29uY2F0KEFuaW1hdGlvbkJhc2UuX2NyZWF0ZVByb3BlcnR5QW5pbWF0aW9ucyhhbmltYXRpb25EZWZpbml0aW9uc1tpXSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOb3RoaW5nIHRvIGFuaW1hdGUuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQ3JlYXRlZCBcIiArIHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGggKyBcIiBpbmRpdmlkdWFsIHByb3BlcnR5IGFuaW1hdGlvbnMuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BsYXlTZXF1ZW50aWFsbHkgPSBwbGF5U2VxdWVudGlhbGx5O1xuICAgIH1cbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5fcmVqZWN0QWxyZWFkeVBsYXlpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZWFzb24gPSBcIkFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCI7XG4gICAgICAgIHRyYWNlXzEud3JpdGUocmVhc29uLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgcmVqZWN0KHJlYXNvbik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUucGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzXzEgPSB0aGlzO1xuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgX3RoaXNfMS5fcmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICBfdGhpc18xLl9yZWplY3QgPSByZWplY3Q7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmZpeHVwQW5pbWF0aW9uUHJvbWlzZShhbmltYXRpb25GaW5pc2hlZFByb21pc2UpO1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSB0cnVlO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUuZml4dXBBbmltYXRpb25Qcm9taXNlID0gZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcHJvbWlzZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5jYW5jZWwoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF90aGVuID0gcHJvbWlzZS50aGVuO1xuICAgICAgICBwcm9taXNlLnRoZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgciA9IF90aGVuLmFwcGx5KHByb21pc2UsIGFyZ3VtZW50cyk7XG4gICAgICAgICAgICBfdGhpcy5maXh1cEFuaW1hdGlvblByb21pc2Uocik7XG4gICAgICAgICAgICByZXR1cm4gcjtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIF9jYXRjaCA9IHByb21pc2UuY2F0Y2g7XG4gICAgICAgIHByb21pc2UuY2F0Y2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgciA9IF9jYXRjaC5hcHBseShwcm9taXNlLCBhcmd1bWVudHMpO1xuICAgICAgICAgICAgX3RoaXMuZml4dXBBbmltYXRpb25Qcm9taXNlKHIpO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQW5pbWF0aW9uQmFzZS5wcm90b3R5cGUsIFwiaXNQbGF5aW5nXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNQbGF5aW5nO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBBbmltYXRpb25CYXNlLnByb3RvdHlwZS5fcmVzb2x2ZUFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5faXNQbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Jlc29sdmUoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkJhc2UucHJvdG90eXBlLl9yZWplY3RBbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWplY3QobmV3IEVycm9yKFwiQW5pbWF0aW9uIGNhbmNlbGxlZC5cIikpO1xuICAgIH07XG4gICAgQW5pbWF0aW9uQmFzZS5fY3JlYXRlUHJvcGVydHlBbmltYXRpb25zID0gZnVuY3Rpb24gKGFuaW1hdGlvbkRlZmluaXRpb24pIHtcbiAgICAgICAgaWYgKCFhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gYW5pbWF0aW9uIHRhcmdldCBzcGVjaWZpZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGl0ZW0gaW4gYW5pbWF0aW9uRGVmaW5pdGlvbikge1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKChpdGVtID09PSBQcm9wZXJ0aWVzLm9wYWNpdHkgfHxcbiAgICAgICAgICAgICAgICBpdGVtID09PSBQcm9wZXJ0aWVzLnJvdGF0ZSB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiZHVyYXRpb25cIiB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiZGVsYXlcIiB8fFxuICAgICAgICAgICAgICAgIGl0ZW0gPT09IFwiaXRlcmF0aW9uc1wiKSAmJiB0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSAhPT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlByb3BlcnR5IFwiICsgaXRlbSArIFwiIG11c3QgYmUgdmFsaWQgbnVtYmVyLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKChpdGVtID09PSBQcm9wZXJ0aWVzLnNjYWxlIHx8IGl0ZW0gPT09IFByb3BlcnRpZXMudHJhbnNsYXRlKSAmJlxuICAgICAgICAgICAgICAgICh0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXS54ICE9PSBcIm51bWJlclwiIHx8IHR5cGVvZiBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dLnkgIT09IFwibnVtYmVyXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBQYWlyLiBWYWx1ZTogXCIgKyBhbmltYXRpb25EZWZpbml0aW9uW2l0ZW1dKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGl0ZW0gPT09IFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yICYmICFjb2xvcl8xLkNvbG9yLmlzVmFsaWQoYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyBpdGVtICsgXCIgbXVzdCBiZSB2YWxpZCBjb2xvci4gVmFsdWU6IFwiICsgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChpdGVtID09PSBQcm9wZXJ0aWVzLndpZHRoIHx8IGl0ZW0gPT09IFByb3BlcnRpZXMuaGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uRGVmaW5pdGlvbltpdGVtXSA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnBhcnNlKGFuaW1hdGlvbkRlZmluaXRpb25baXRlbV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBwcm9wZXJ0eUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24ub3BhY2l0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5vcGFjaXR5LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb25EZWZpbml0aW9uLm9wYWNpdHksXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgICAgIHZhbHVlOiB0eXBlb2YgYW5pbWF0aW9uRGVmaW5pdGlvbi5iYWNrZ3JvdW5kQ29sb3IgPT09IFwic3RyaW5nXCIgP1xuICAgICAgICAgICAgICAgICAgICBuZXcgY29sb3JfMS5Db2xvcihhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcikgOiBhbmltYXRpb25EZWZpbml0aW9uLmJhY2tncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLnRyYW5zbGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy50cmFuc2xhdGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24udHJhbnNsYXRlLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24uc2NhbGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMuc2NhbGUsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24uc2NhbGUsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uRGVmaW5pdGlvbi5yb3RhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMucm90YXRlLFxuICAgICAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb25EZWZpbml0aW9uLnJvdGF0ZSxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uRGVmaW5pdGlvbi5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBkZWxheTogYW5pbWF0aW9uRGVmaW5pdGlvbi5kZWxheSxcbiAgICAgICAgICAgICAgICBpdGVyYXRpb25zOiBhbmltYXRpb25EZWZpbml0aW9uLml0ZXJhdGlvbnMsXG4gICAgICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbkRlZmluaXRpb24uY3VydmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbmltYXRpb25EZWZpbml0aW9uLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb25EZWZpbml0aW9uLnRhcmdldCxcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eTogUHJvcGVydGllcy5oZWlnaHQsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24uaGVpZ2h0LFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBhbmltYXRpb25EZWZpbml0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGRlbGF5OiBhbmltYXRpb25EZWZpbml0aW9uLmRlbGF5LFxuICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbkRlZmluaXRpb24uaXRlcmF0aW9ucyxcbiAgICAgICAgICAgICAgICBjdXJ2ZTogYW5pbWF0aW9uRGVmaW5pdGlvbi5jdXJ2ZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb24ud2lkdGggIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhcmdldDogYW5pbWF0aW9uRGVmaW5pdGlvbi50YXJnZXQsXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IFByb3BlcnRpZXMud2lkdGgsXG4gICAgICAgICAgICAgICAgdmFsdWU6IGFuaW1hdGlvbkRlZmluaXRpb24ud2lkdGgsXG4gICAgICAgICAgICAgICAgZHVyYXRpb246IGFuaW1hdGlvbkRlZmluaXRpb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbkRlZmluaXRpb24uZGVsYXksXG4gICAgICAgICAgICAgICAgaXRlcmF0aW9uczogYW5pbWF0aW9uRGVmaW5pdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgIGN1cnZlOiBhbmltYXRpb25EZWZpbml0aW9uLmN1cnZlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8ga25vd24gYW5pbWF0aW9uIHByb3BlcnRpZXMgc3BlY2lmaWVkXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eUFuaW1hdGlvbnM7XG4gICAgfTtcbiAgICBBbmltYXRpb25CYXNlLl9nZXRBbmltYXRpb25JbmZvID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdGFyZ2V0OiBhbmltYXRpb24udGFyZ2V0LmlkLFxuICAgICAgICAgICAgcHJvcGVydHk6IGFuaW1hdGlvbi5wcm9wZXJ0eSxcbiAgICAgICAgICAgIHZhbHVlOiBhbmltYXRpb24udmFsdWUsXG4gICAgICAgICAgICBkdXJhdGlvbjogYW5pbWF0aW9uLmR1cmF0aW9uLFxuICAgICAgICAgICAgZGVsYXk6IGFuaW1hdGlvbi5kZWxheSxcbiAgICAgICAgICAgIGl0ZXJhdGlvbnM6IGFuaW1hdGlvbi5pdGVyYXRpb25zLFxuICAgICAgICAgICAgY3VydmU6IGFuaW1hdGlvbi5jdXJ2ZVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBBbmltYXRpb25CYXNlO1xufSgpKTtcbmV4cG9ydHMuQW5pbWF0aW9uQmFzZSA9IEFuaW1hdGlvbkJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbmltYXRpb24tY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgYW5pbWF0aW9uX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYW5pbWF0aW9uLWNvbW1vblwiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9hbmltYXRpb24tY29tbW9uXCIpKTtcbnZhciBfdHJhbnNmb3JtID0gXCJfdHJhbnNmb3JtXCI7XG52YXIgX3NraXAgPSBcIl9za2lwXCI7XG52YXIgRkxUX01BWCA9IDM0MDI4MjM0NjYzODUyODg1OTgxMTcwNDE4MzQ4NDUxNjkyNTQ0MC4wMDAwMDA7XG52YXIgQW5pbWF0aW9uSW5mbyA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQW5pbWF0aW9uSW5mbygpIHtcbiAgICB9XG4gICAgcmV0dXJuIEFuaW1hdGlvbkluZm87XG59KCkpO1xudmFyIEFuaW1hdGlvbkRlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEFuaW1hdGlvbkRlbGVnYXRlSW1wbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBBbmltYXRpb25EZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQW5pbWF0aW9uRGVsZWdhdGVJbXBsLmluaXRXaXRoRmluaXNoZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChmaW5pc2hlZENhbGxiYWNrLCBwcm9wZXJ0eUFuaW1hdGlvbiwgdmFsdWVTb3VyY2UpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gQW5pbWF0aW9uRGVsZWdhdGVJbXBsLm5ldygpO1xuICAgICAgICBkZWxlZ2F0ZS5fZmluaXNoZWRDYWxsYmFjayA9IGZpbmlzaGVkQ2FsbGJhY2s7XG4gICAgICAgIGRlbGVnYXRlLl9wcm9wZXJ0eUFuaW1hdGlvbiA9IHByb3BlcnR5QW5pbWF0aW9uO1xuICAgICAgICBkZWxlZ2F0ZS5fdmFsdWVTb3VyY2UgPSB2YWx1ZVNvdXJjZTtcbiAgICAgICAgcmV0dXJuIGRlbGVnYXRlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5hbmltYXRpb25EaWRTdGFydCA9IGZ1bmN0aW9uIChhbmltKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX3Byb3BlcnR5QW5pbWF0aW9uLnZhbHVlO1xuICAgICAgICB2YXIgc2V0TG9jYWwgPSB0aGlzLl92YWx1ZVNvdXJjZSA9PT0gXCJhbmltYXRpb25cIjtcbiAgICAgICAgdmFyIHRhcmdldFN0eWxlID0gdGhpcy5fcHJvcGVydHlBbmltYXRpb24udGFyZ2V0LnN0eWxlO1xuICAgICAgICB0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQuX3N1c3BlbmRQcmVzZW50YXRpb25MYXllclVwZGF0ZXMoKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLl9wcm9wZXJ0eUFuaW1hdGlvbi5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3I6XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMub3BhY2l0eTpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnJvdGF0ZTpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGU6XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLng7XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLnk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLmhlaWdodDpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLmhlaWdodFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy53aWR0aDpcbiAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS53aWR0aFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGU6XG4gICAgICAgICAgICAgICAgdGFyZ2V0U3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS54ID09PSAwID8gMC4wMDEgOiB2YWx1ZS54O1xuICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gdmFsdWUueSA9PT0gMCA/IDAuMDAxIDogdmFsdWUueTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgX3RyYW5zZm9ybTpcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLng7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLnk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXS54O1xuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXS55O1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRTdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHggPT09IDAgPyAwLjAwMSA6IHg7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0geSA9PT0gMCA/IDAuMDAxIDogeTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcHJvcGVydHlBbmltYXRpb24udGFyZ2V0Ll9yZXN1bWVQcmVzZW50YXRpb25MYXllclVwZGF0ZXMoKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbkRlbGVnYXRlSW1wbC5wcm90b3R5cGUuYW5pbWF0aW9uRGlkU3RvcEZpbmlzaGVkID0gZnVuY3Rpb24gKGFuaW0sIGZpbmlzaGVkKSB7XG4gICAgICAgIGlmICh0aGlzLl9maW5pc2hlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9maW5pc2hlZENhbGxiYWNrKCFmaW5pc2hlZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbmlzaGVkICYmIHRoaXMubmV4dEFuaW1hdGlvbikge1xuICAgICAgICAgICAgdGhpcy5uZXh0QW5pbWF0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuaW1hdGlvbkRlbGVnYXRlSW1wbC5PYmpDUHJvdG9jb2xzID0gZ2xvYmFsLkNBQW5pbWF0aW9uRGVsZWdhdGUgPyBbZ2xvYmFsLkNBQW5pbWF0aW9uRGVsZWdhdGVdIDogW107XG4gICAgcmV0dXJuIEFuaW1hdGlvbkRlbGVnYXRlSW1wbDtcbn0oTlNPYmplY3QpKTtcbmZ1bmN0aW9uIF9yZXNvbHZlQW5pbWF0aW9uQ3VydmUoY3VydmUpIHtcbiAgICBzd2l0Y2ggKGN1cnZlKSB7XG4gICAgICAgIGNhc2UgXCJlYXNlSW5cIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uRWFzZUluKTtcbiAgICAgICAgY2FzZSBcImVhc2VPdXRcIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uRWFzZU91dCk7XG4gICAgICAgIGNhc2UgXCJlYXNlSW5PdXRcIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uRWFzZUluRWFzZU91dCk7XG4gICAgICAgIGNhc2UgXCJsaW5lYXJcIjpcbiAgICAgICAgICAgIHJldHVybiBDQU1lZGlhVGltaW5nRnVuY3Rpb24uZnVuY3Rpb25XaXRoTmFtZShrQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uTGluZWFyKTtcbiAgICAgICAgY2FzZSBcInNwcmluZ1wiOlxuICAgICAgICAgICAgcmV0dXJuIGN1cnZlO1xuICAgICAgICBjYXNlIFwiZWFzZVwiOlxuICAgICAgICAgICAgcmV0dXJuIENBTWVkaWFUaW1pbmdGdW5jdGlvbi5mdW5jdGlvbldpdGhDb250cm9sUG9pbnRzKDAuMjUsIDAuMSwgMC4yNSwgMS4wKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGlmIChjdXJ2ZSBpbnN0YW5jZW9mIENBTWVkaWFUaW1pbmdGdW5jdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJ2ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGN1cnZlIGluc3RhbmNlb2YgYW5pbWF0aW9uX2NvbW1vbl8xLkN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uQ3VydmUgPSBjdXJ2ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gQ0FNZWRpYVRpbWluZ0Z1bmN0aW9uLmZ1bmN0aW9uV2l0aENvbnRyb2xQb2ludHMoYW5pbWF0aW9uQ3VydmUueDEsIGFuaW1hdGlvbkN1cnZlLnkxLCBhbmltYXRpb25DdXJ2ZS54MiwgYW5pbWF0aW9uQ3VydmUueTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhbmltYXRpb24gY3VydmU6IFwiICsgY3VydmUpO1xuICAgICAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMuX3Jlc29sdmVBbmltYXRpb25DdXJ2ZSA9IF9yZXNvbHZlQW5pbWF0aW9uQ3VydmU7XG52YXIgQW5pbWF0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5pbWF0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFuaW1hdGlvbihhbmltYXRpb25EZWZpbml0aW9ucywgcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBhbmltYXRpb25EZWZpbml0aW9ucywgcGxheVNlcXVlbnRpYWxseSkgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX3ZhbHVlU291cmNlID0gXCJhbmltYXRpb25cIjtcbiAgICAgICAgaWYgKGFuaW1hdGlvbkRlZmluaXRpb25zLmxlbmd0aCA+IDAgJiYgYW5pbWF0aW9uRGVmaW5pdGlvbnNbMF0udmFsdWVTb3VyY2UgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgX3RoaXMuX3ZhbHVlU291cmNlID0gYW5pbWF0aW9uRGVmaW5pdGlvbnNbMF0udmFsdWVTb3VyY2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJOb24tbWVyZ2VkIFByb3BlcnR5IEFuaW1hdGlvbnM6IFwiICsgX3RoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGgsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF90aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMgPSBBbmltYXRpb24uX21lcmdlQWZmaW5lVHJhbnNmb3JtQW5pbWF0aW9ucyhfdGhpcy5fcHJvcGVydHlBbmltYXRpb25zKTtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25fY29tbW9uXzEudHJhY2VXcml0ZShcIk1lcmdlZCBQcm9wZXJ0eSBBbmltYXRpb25zOiBcIiArIF90aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5fbWVyZ2VkUHJvcGVydHlBbmltYXRpb25zID0gX3RoaXMuX3Byb3BlcnR5QW5pbWF0aW9ucztcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGhhdCA9IF90aGlzO1xuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChjYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGF0Ll9wbGF5U2VxdWVudGlhbGx5KSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhbmNlbGxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9yZWplY3RBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY2FuY2VsbGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2NhbmNlbGxlZEFuaW1hdGlvbnMrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZpbmlzaGVkQW5pbWF0aW9ucysrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhhdC5fY2FuY2VsbGVkQW5pbWF0aW9ucyA+IDAgJiYgKHRoYXQuX2NhbmNlbGxlZEFuaW1hdGlvbnMgKyB0aGF0Ll9maW5pc2hlZEFuaW1hdGlvbnMpID09PSB0aGF0Ll9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKHRoYXQuX2NhbmNlbGxlZEFuaW1hdGlvbnMgKyBcIiBhbmltYXRpb25zIGNhbmNlbGxlZC5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3JlamVjdEFuaW1hdGlvbkZpbmlzaGVkUHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGF0Ll9maW5pc2hlZEFuaW1hdGlvbnMgPT09IHRoYXQuX21lcmdlZFByb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUodGhhdC5fZmluaXNoZWRBbmltYXRpb25zICsgXCIgYW5pbWF0aW9ucyBmaW5pc2hlZC5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLl9pT1NBbmltYXRpb25GdW5jdGlvbiA9IEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24oX3RoaXMuX21lcmdlZFByb3BlcnR5QW5pbWF0aW9ucywgMCwgX3RoaXMuX3BsYXlTZXF1ZW50aWFsbHksIF90aGlzLl92YWx1ZVNvdXJjZSwgYW5pbWF0aW9uRmluaXNoZWRDYWxsYmFjayk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWplY3RBbHJlYWR5UGxheWluZygpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBhbmltYXRpb25GaW5pc2hlZFByb21pc2UgPSBfc3VwZXIucHJvdG90eXBlLnBsYXkuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZmluaXNoZWRBbmltYXRpb25zID0gMDtcbiAgICAgICAgdGhpcy5fY2FuY2VsbGVkQW5pbWF0aW9ucyA9IDA7XG4gICAgICAgIHRoaXMuX2lPU0FuaW1hdGlvbkZ1bmN0aW9uKCk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25GaW5pc2hlZFByb21pc2U7XG4gICAgfTtcbiAgICBBbmltYXRpb24ucHJvdG90eXBlLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykge1xuICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRpb24gaXMgbm90IGN1cnJlbnRseSBwbGF5aW5nLlwiLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaSA9IDA7XG4gICAgICAgIHZhciBsZW5ndGggPSB0aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoO1xuICAgICAgICBmb3IgKDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJvcGVydHlBbmltYXRpb24gPSB0aGlzLl9tZXJnZWRQcm9wZXJ0eUFuaW1hdGlvbnNbaV07XG4gICAgICAgICAgICBwcm9wZXJ0eUFuaW1hdGlvbi50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZC5sYXllci5yZW1vdmVBbGxBbmltYXRpb25zKCk7XG4gICAgICAgICAgICBpZiAocHJvcGVydHlBbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHByb3BlcnR5QW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2socHJvcGVydHlBbmltYXRpb24uX29yaWdpbmFsVmFsdWUsIHRoaXMuX3ZhbHVlU291cmNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzb2x2ZUFuaW1hdGlvbkN1cnZlID0gZnVuY3Rpb24gKGN1cnZlKSB7XG4gICAgICAgIHJldHVybiBfcmVzb2x2ZUFuaW1hdGlvbkN1cnZlKGN1cnZlKTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24gPSBmdW5jdGlvbiAocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCwgcGxheVNlcXVlbnRpYWxseSwgdmFsdWVTb3VyY2UsIGZpbmlzaGVkQ2FsbGJhY2spIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYW5jZWxsZWQpIHtcbiAgICAgICAgICAgIGlmIChjYW5jZWxsZWQgJiYgZmluaXNoZWRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJBbmltYXRpb24gXCIgKyAoaW5kZXggLSAxKS50b1N0cmluZygpICsgXCIgd2FzIGNhbmNlbGxlZC4gV2lsbCBza2lwIHRoZSByZXN0IG9mIGFuaW1hdGlvbnMgYW5kIGNhbGwgZmluaXNoZWRDYWxsYmFjayh0cnVlKS5cIiwgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5BbmltYXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaW5pc2hlZENhbGxiYWNrKGNhbmNlbGxlZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHByb3BlcnR5QW5pbWF0aW9uc1tpbmRleF07XG4gICAgICAgICAgICB2YXIgYXJncyA9IEFuaW1hdGlvbi5fZ2V0TmF0aXZlQW5pbWF0aW9uQXJndW1lbnRzKGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UpO1xuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi5jdXJ2ZSA9PT0gXCJzcHJpbmdcIikge1xuICAgICAgICAgICAgICAgIEFuaW1hdGlvbi5fY3JlYXRlTmF0aXZlU3ByaW5nQW5pbWF0aW9uKHByb3BlcnR5QW5pbWF0aW9ucywgaW5kZXgsIHBsYXlTZXF1ZW50aWFsbHksIGFyZ3MsIGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UsIGZpbmlzaGVkQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgQW5pbWF0aW9uLl9jcmVhdGVOYXRpdmVBbmltYXRpb24ocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCwgcGxheVNlcXVlbnRpYWxseSwgYXJncywgYW5pbWF0aW9uLCB2YWx1ZVNvdXJjZSwgZmluaXNoZWRDYWxsYmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2dldE5hdGl2ZUFuaW1hdGlvbkFyZ3VtZW50cyA9IGZ1bmN0aW9uIChhbmltYXRpb24sIHZhbHVlU291cmNlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gYW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lVG9BbmltYXRlID0gYW5pbWF0aW9uLnByb3BlcnR5O1xuICAgICAgICB2YXIgdG9WYWx1ZSA9IGFuaW1hdGlvbi52YWx1ZTtcbiAgICAgICAgdmFyIGZyb21WYWx1ZTtcbiAgICAgICAgdmFyIHBhcmVudCA9IGFuaW1hdGlvbi50YXJnZXQucGFyZW50O1xuICAgICAgICB2YXIgc2NyZWVuU2NhbGUgPSBwbGF0Zm9ybV8xLnNjcmVlbi5tYWluU2NyZWVuLnNjYWxlO1xuICAgICAgICB2YXIgdGVtcFJvdGF0ZSA9IChhbmltYXRpb24udGFyZ2V0LnJvdGF0ZSB8fCAwKSAqIE1hdGguUEkgLyAxODA7XG4gICAgICAgIHZhciBhYnM7XG4gICAgICAgIHZhciBzZXRMb2NhbCA9IHZhbHVlU291cmNlID09PSBcImFuaW1hdGlvblwiO1xuICAgICAgICBzd2l0Y2ggKGFuaW1hdGlvbi5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5iYWNrZ3JvdW5kQ29sb3I6XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0gYW5pbWF0aW9uLnRhcmdldC5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUsIHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IG5hdGl2ZVZpZXcubGF5ZXIuYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgVUlMYWJlbCkge1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldFZhbHVlRm9yS2V5KFVJQ29sb3IuY2xlYXJDb2xvciwgXCJiYWNrZ3JvdW5kQ29sb3JcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSB0b1ZhbHVlLkNHQ29sb3I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLm9wYWNpdHk6XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0gYW5pbWF0aW9uLnRhcmdldC5vcGFjaXR5O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fcHJvcGVydHlSZXNldENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IG5hdGl2ZVZpZXcubGF5ZXIub3BhY2l0eTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMucm90YXRlOlxuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fb3JpZ2luYWxWYWx1ZSA9IGFuaW1hdGlvbi50YXJnZXQucm90YXRlICE9PSB1bmRlZmluZWQgPyBhbmltYXRpb24udGFyZ2V0LnJvdGF0ZSA6IDA7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUsIHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHByb3BlcnR5TmFtZVRvQW5pbWF0ZSA9IFwidHJhbnNmb3JtLnJvdGF0aW9uXCI7XG4gICAgICAgICAgICAgICAgZnJvbVZhbHVlID0gbmF0aXZlVmlldy5sYXllci52YWx1ZUZvcktleVBhdGgoXCJ0cmFuc2Zvcm0ucm90YXRpb25cIik7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi50YXJnZXQucm90YXRlICE9PSB1bmRlZmluZWQgJiYgYW5pbWF0aW9uLnRhcmdldC5yb3RhdGUgIT09IDAgJiYgTWF0aC5mbG9vcih0b1ZhbHVlIC8gMzYwKSAtIHRvVmFsdWUgLyAzNjAgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbVZhbHVlID0gYW5pbWF0aW9uLnRhcmdldC5yb3RhdGUgKiBNYXRoLlBJIC8gMTgwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0b1ZhbHVlID0gdG9WYWx1ZSAqIE1hdGguUEkgLyAxODA7XG4gICAgICAgICAgICAgICAgYWJzID0gZmFicyhmcm9tVmFsdWUgLSB0b1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoYWJzIDwgMC4wMDEgJiYgZnJvbVZhbHVlICE9PSB0ZW1wUm90YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IHRlbXBSb3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGU6XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0geyB4OiBhbmltYXRpb24udGFyZ2V0LnRyYW5zbGF0ZVgsIHk6IGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWSB9O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fcHJvcGVydHlSZXNldENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS54O1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS55O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lVG9BbmltYXRlID0gXCJ0cmFuc2Zvcm1cIjtcbiAgICAgICAgICAgICAgICBmcm9tVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QobmF0aXZlVmlldy5sYXllci50cmFuc2Zvcm0pO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QoQ0FUcmFuc2Zvcm0zRFRyYW5zbGF0ZShuYXRpdmVWaWV3LmxheWVyLnRyYW5zZm9ybSwgdG9WYWx1ZS54LCB0b1ZhbHVlLnksIDApKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGU6XG4gICAgICAgICAgICAgICAgaWYgKHRvVmFsdWUueCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0b1ZhbHVlLnggPSAwLjAwMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRvVmFsdWUueSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0b1ZhbHVlLnkgPSAwLjAwMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0geyB4OiBhbmltYXRpb24udGFyZ2V0LnNjYWxlWCwgeTogYW5pbWF0aW9uLnRhcmdldC5zY2FsZVkgfTtcbiAgICAgICAgICAgICAgICBhbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjayA9IGZ1bmN0aW9uICh2YWx1ZSwgdmFsdWVTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLng7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkubmFtZSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS55O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcHJvcGVydHlOYW1lVG9BbmltYXRlID0gXCJ0cmFuc2Zvcm1cIjtcbiAgICAgICAgICAgICAgICBmcm9tVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QobmF0aXZlVmlldy5sYXllci50cmFuc2Zvcm0pO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QoQ0FUcmFuc2Zvcm0zRFNjYWxlKG5hdGl2ZVZpZXcubGF5ZXIudHJhbnNmb3JtLCB0b1ZhbHVlLngsIHRvVmFsdWUueSwgMSkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBfdHJhbnNmb3JtOlxuICAgICAgICAgICAgICAgIGZyb21WYWx1ZSA9IE5TVmFsdWUudmFsdWVXaXRoQ0FUcmFuc2Zvcm0zRChuYXRpdmVWaWV3LmxheWVyLnRyYW5zZm9ybSk7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9vcmlnaW5hbFZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICB4czogYW5pbWF0aW9uLnRhcmdldC5zY2FsZVgsIHlzOiBhbmltYXRpb24udGFyZ2V0LnNjYWxlWSxcbiAgICAgICAgICAgICAgICAgICAgeHQ6IGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWCwgeXQ6IGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUsIHZhbHVlU291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQuc3R5bGVbc2V0TG9jYWwgPyBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLnh0O1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSB2YWx1ZS55dDtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHN0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5uYW1lIDogc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHZhbHVlLnhzO1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnN0eWxlW3NldExvY2FsID8gc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5Lm5hbWUgOiBzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gdmFsdWUueXM7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWVUb0FuaW1hdGUgPSBcInRyYW5zZm9ybVwiO1xuICAgICAgICAgICAgICAgIHRvVmFsdWUgPSBOU1ZhbHVlLnZhbHVlV2l0aENBVHJhbnNmb3JtM0QoQW5pbWF0aW9uLl9jcmVhdGVOYXRpdmVBZmZpbmVUcmFuc2Zvcm0oYW5pbWF0aW9uKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLndpZHRoOlxuICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5oZWlnaHQ6XG4gICAgICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IGFuaW1hdGlvbi5wcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICB2YXIgaXNIZWlnaHRfMSA9IGRpcmVjdGlvbiA9PT0gXCJoZWlnaHRcIjtcbiAgICAgICAgICAgICAgICBwcm9wZXJ0eU5hbWVUb0FuaW1hdGUgPSBcImJvdW5kc1wiO1xuICAgICAgICAgICAgICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImNhbm5vdCBhbmltYXRlIFwiICsgZGlyZWN0aW9uICsgXCIgb24gcm9vdCB2aWV3XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgcGFyZW50RXh0ZW50ID0gaXNIZWlnaHRfMSA/IHBhcmVudC5nZXRNZWFzdXJlZEhlaWdodCgpIDogcGFyZW50LmdldE1lYXN1cmVkV2lkdGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgYXNOdW1iZXIgPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC5wYXJzZSh0b1ZhbHVlKSwgcGFyZW50RXh0ZW50LCBwYXJlbnRFeHRlbnQpIC8gc2NyZWVuU2NhbGU7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRCb3VuZHMgPSBuYXRpdmVWaWV3LmxheWVyLmJvdW5kcztcbiAgICAgICAgICAgICAgICB2YXIgZXh0ZW50WCA9IGlzSGVpZ2h0XzEgPyBjdXJyZW50Qm91bmRzLnNpemUud2lkdGggOiBhc051bWJlcjtcbiAgICAgICAgICAgICAgICB2YXIgZXh0ZW50WSA9IGlzSGVpZ2h0XzEgPyBhc051bWJlciA6IGN1cnJlbnRCb3VuZHMuc2l6ZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgZnJvbVZhbHVlID0gTlNWYWx1ZS52YWx1ZVdpdGhDR1JlY3QoY3VycmVudEJvdW5kcyk7XG4gICAgICAgICAgICAgICAgdG9WYWx1ZSA9IE5TVmFsdWUudmFsdWVXaXRoQ0dSZWN0KENHUmVjdE1ha2UoY3VycmVudEJvdW5kcy5vcmlnaW4ueCwgY3VycmVudEJvdW5kcy5vcmlnaW4ueSwgZXh0ZW50WCwgZXh0ZW50WSkpO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fb3JpZ2luYWxWYWx1ZSA9IGFuaW1hdGlvbi50YXJnZXQuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fcHJvcGVydHlSZXNldENhbGxiYWNrID0gZnVuY3Rpb24gKHZhbHVlLCB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IGlzSGVpZ2h0XzEgPyBzdHlsZV9wcm9wZXJ0aWVzXzEuaGVpZ2h0UHJvcGVydHkgOiBzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zdHlsZVtzZXRMb2NhbCA/IHByb3AubmFtZSA6IHByb3Aua2V5ZnJhbWVdID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQW5pbWF0aW5nIHByb3BlcnR5ICdcIiArIGFuaW1hdGlvbi5wcm9wZXJ0eSArIFwiJyBpcyB1bnN1cHBvcnRlZFwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZHVyYXRpb24gPSAwLjM7XG4gICAgICAgIGlmIChhbmltYXRpb24uZHVyYXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgZHVyYXRpb24gPSBhbmltYXRpb24uZHVyYXRpb24gLyAxMDAwLjA7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlbGF5ID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoYW5pbWF0aW9uLmRlbGF5KSB7XG4gICAgICAgICAgICBkZWxheSA9IGFuaW1hdGlvbi5kZWxheSAvIDEwMDAuMDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVwZWF0Q291bnQgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChhbmltYXRpb24uaXRlcmF0aW9ucyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uLml0ZXJhdGlvbnMgPT09IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSkge1xuICAgICAgICAgICAgICAgIHJlcGVhdENvdW50ID0gRkxUX01BWDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcGVhdENvdW50ID0gYW5pbWF0aW9uLml0ZXJhdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZVRvQW5pbWF0ZTogcHJvcGVydHlOYW1lVG9BbmltYXRlLFxuICAgICAgICAgICAgZnJvbVZhbHVlOiBmcm9tVmFsdWUsXG4gICAgICAgICAgICB0b1ZhbHVlOiB0b1ZhbHVlLFxuICAgICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uLFxuICAgICAgICAgICAgcmVwZWF0Q291bnQ6IHJlcGVhdENvdW50LFxuICAgICAgICAgICAgZGVsYXk6IGRlbGF5XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2NyZWF0ZU5hdGl2ZUFuaW1hdGlvbiA9IGZ1bmN0aW9uIChwcm9wZXJ0eUFuaW1hdGlvbnMsIGluZGV4LCBwbGF5U2VxdWVudGlhbGx5LCBhcmdzLCBhbmltYXRpb24sIHZhbHVlU291cmNlLCBmaW5pc2hlZENhbGxiYWNrKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gYW5pbWF0aW9uLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgbmF0aXZlQW5pbWF0aW9uID0gQ0FCYXNpY0FuaW1hdGlvbi5hbmltYXRpb25XaXRoS2V5UGF0aChhcmdzLnByb3BlcnR5TmFtZVRvQW5pbWF0ZSk7XG4gICAgICAgIG5hdGl2ZUFuaW1hdGlvbi5mcm9tVmFsdWUgPSBhcmdzLmZyb21WYWx1ZTtcbiAgICAgICAgbmF0aXZlQW5pbWF0aW9uLnRvVmFsdWUgPSBhcmdzLnRvVmFsdWU7XG4gICAgICAgIG5hdGl2ZUFuaW1hdGlvbi5kdXJhdGlvbiA9IGFyZ3MuZHVyYXRpb247XG4gICAgICAgIGlmIChhcmdzLnJlcGVhdENvdW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5hdGl2ZUFuaW1hdGlvbi5yZXBlYXRDb3VudCA9IGFyZ3MucmVwZWF0Q291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFyZ3MuZGVsYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbmF0aXZlQW5pbWF0aW9uLmJlZ2luVGltZSA9IENBQ3VycmVudE1lZGlhVGltZSgpICsgYXJncy5kZWxheTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYW5pbWF0aW9uLmN1cnZlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIG5hdGl2ZUFuaW1hdGlvbi50aW1pbmdGdW5jdGlvbiA9IGFuaW1hdGlvbi5jdXJ2ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0aW9uRGVsZWdhdGUgPSBBbmltYXRpb25EZWxlZ2F0ZUltcGwuaW5pdFdpdGhGaW5pc2hlZENhbGxiYWNrKGZpbmlzaGVkQ2FsbGJhY2ssIGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UpO1xuICAgICAgICBuYXRpdmVBbmltYXRpb24uc2V0VmFsdWVGb3JLZXkoYW5pbWF0aW9uRGVsZWdhdGUsIFwiZGVsZWdhdGVcIik7XG4gICAgICAgIG5hdGl2ZVZpZXcubGF5ZXIuYWRkQW5pbWF0aW9uRm9yS2V5KG5hdGl2ZUFuaW1hdGlvbiwgYXJncy5wcm9wZXJ0eU5hbWVUb0FuaW1hdGUpO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChpbmRleCArIDEgPCBwcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24ocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCArIDEsIHBsYXlTZXF1ZW50aWFsbHksIHZhbHVlU291cmNlLCBmaW5pc2hlZENhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmICghcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EZWxlZ2F0ZS5uZXh0QW5pbWF0aW9uID0gY2FsbGJhY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fY3JlYXRlTmF0aXZlU3ByaW5nQW5pbWF0aW9uID0gZnVuY3Rpb24gKHByb3BlcnR5QW5pbWF0aW9ucywgaW5kZXgsIHBsYXlTZXF1ZW50aWFsbHksIGFyZ3MsIGFuaW1hdGlvbiwgdmFsdWVTb3VyY2UsIGZpbmlzaGVkQ2FsbGJhY2spIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSBhbmltYXRpb24udGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIG5leHRBbmltYXRpb247XG4gICAgICAgIGlmIChpbmRleCArIDEgPCBwcm9wZXJ0eUFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjYWxsYmFjayA9IEFuaW1hdGlvbi5fY3JlYXRlaU9TQW5pbWF0aW9uRnVuY3Rpb24ocHJvcGVydHlBbmltYXRpb25zLCBpbmRleCArIDEsIHBsYXlTZXF1ZW50aWFsbHksIHZhbHVlU291cmNlLCBmaW5pc2hlZENhbGxiYWNrKTtcbiAgICAgICAgICAgIGlmICghcGxheVNlcXVlbnRpYWxseSkge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXh0QW5pbWF0aW9uID0gY2FsbGJhY2s7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlbGF5ID0gMDtcbiAgICAgICAgaWYgKGFyZ3MuZGVsYXkpIHtcbiAgICAgICAgICAgIGRlbGF5ID0gYXJncy5kZWxheTtcbiAgICAgICAgfVxuICAgICAgICBVSVZpZXcuYW5pbWF0ZVdpdGhEdXJhdGlvbkRlbGF5VXNpbmdTcHJpbmdXaXRoRGFtcGluZ0luaXRpYWxTcHJpbmdWZWxvY2l0eU9wdGlvbnNBbmltYXRpb25zQ29tcGxldGlvbihhcmdzLmR1cmF0aW9uLCBkZWxheSwgMC4yLCAwLCAxOTY2MDgsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLnJlcGVhdENvdW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uUmVwZWF0Q291bnQoYXJncy5yZXBlYXRDb3VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKGFuaW1hdGlvbi5wcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuYmFja2dyb3VuZENvbG9yOlxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LmJhY2tncm91bmRDb2xvciA9IGFyZ3MudG9WYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBhbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5vcGFjaXR5OlxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0Lm9wYWNpdHkgPSBhcmdzLnRvVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuaGVpZ2h0OlxuICAgICAgICAgICAgICAgIGNhc2UgYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMud2lkdGg6XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5fb3JpZ2luYWxWYWx1ZSA9IGFuaW1hdGlvbi50YXJnZXRbYW5pbWF0aW9uLnByb3BlcnR5XTtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5zZXRWYWx1ZUZvcktleShhcmdzLnRvVmFsdWUsIGFyZ3MucHJvcGVydHlOYW1lVG9BbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXRbYW5pbWF0aW9uLnByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnJvdGF0ZTpcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5zZXRWYWx1ZUZvcktleShhcmdzLnRvVmFsdWUsIGFyZ3MucHJvcGVydHlOYW1lVG9BbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNmb3JtOlxuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uX29yaWdpbmFsVmFsdWUgPSBuYXRpdmVWaWV3LmxheWVyLnRyYW5zZm9ybTtcbiAgICAgICAgICAgICAgICAgICAgbmF0aXZlVmlldy5sYXllci5zZXRWYWx1ZUZvcktleShhcmdzLnRvVmFsdWUsIGFyZ3MucHJvcGVydHlOYW1lVG9BbmltYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLl9wcm9wZXJ0eVJlc2V0Q2FsbGJhY2sgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubGF5ZXIudHJhbnNmb3JtID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LCBmdW5jdGlvbiAoYW5pbWF0aW9uRGlkRmluaXNoKSB7XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uRGlkRmluaXNoKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi5wcm9wZXJ0eSA9PT0gX3RyYW5zZm9ybSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uLnZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC50cmFuc2xhdGVYID0gYW5pbWF0aW9uLnZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZV0ueDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbi50YXJnZXQudHJhbnNsYXRlWSA9IGFuaW1hdGlvbi52YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLnk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbi52YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uLnRhcmdldC5zY2FsZVggPSBhbmltYXRpb24udmFsdWVbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMuc2NhbGVdLng7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24udGFyZ2V0LnNjYWxlWSA9IGFuaW1hdGlvbi52YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0ueTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24uX3Byb3BlcnR5UmVzZXRDYWxsYmFjayhhbmltYXRpb24uX29yaWdpbmFsVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChmaW5pc2hlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNhbmNlbGxlZCA9ICFhbmltYXRpb25EaWRGaW5pc2g7XG4gICAgICAgICAgICAgICAgZmluaXNoZWRDYWxsYmFjayhjYW5jZWxsZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFuaW1hdGlvbkRpZEZpbmlzaCAmJiBuZXh0QW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgbmV4dEFuaW1hdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFuaW1hdGlvbi5fY3JlYXRlTmF0aXZlQWZmaW5lVHJhbnNmb3JtID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICB2YXIgdmFsdWUgPSBhbmltYXRpb24udmFsdWU7XG4gICAgICAgIHZhciByZXN1bHQgPSBDQVRyYW5zZm9ybTNESWRlbnRpdHk7XG4gICAgICAgIGlmICh2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHZhciB4ID0gdmFsdWVbYW5pbWF0aW9uX2NvbW1vbl8xLlByb3BlcnRpZXMudHJhbnNsYXRlXS54O1xuICAgICAgICAgICAgdmFyIHkgPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy50cmFuc2xhdGVdLnk7XG4gICAgICAgICAgICByZXN1bHQgPSBDQVRyYW5zZm9ybTNEVHJhbnNsYXRlKHJlc3VsdCwgeCwgeSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB2YXIgeCA9IHZhbHVlW2FuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlXS54O1xuICAgICAgICAgICAgdmFyIHkgPSB2YWx1ZVthbmltYXRpb25fY29tbW9uXzEuUHJvcGVydGllcy5zY2FsZV0ueTtcbiAgICAgICAgICAgIHJlc3VsdCA9IENBVHJhbnNmb3JtM0RTY2FsZShyZXN1bHQsIHggPT09IDAgPyAwLjAwMSA6IHgsIHkgPT09IDAgPyAwLjAwMSA6IHksIDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBBbmltYXRpb24uX2lzQWZmaW5lVHJhbnNmb3JtID0gZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eSA9PT0gX3RyYW5zZm9ybVxuICAgICAgICAgICAgfHwgcHJvcGVydHkgPT09IGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnRyYW5zbGF0ZVxuICAgICAgICAgICAgfHwgcHJvcGVydHkgPT09IGFuaW1hdGlvbl9jb21tb25fMS5Qcm9wZXJ0aWVzLnNjYWxlO1xuICAgIH07XG4gICAgQW5pbWF0aW9uLl9jYW5CZU1lcmdlZCA9IGZ1bmN0aW9uIChhbmltYXRpb24xLCBhbmltYXRpb24yKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBBbmltYXRpb24uX2lzQWZmaW5lVHJhbnNmb3JtKGFuaW1hdGlvbjEucHJvcGVydHkpICYmXG4gICAgICAgICAgICBBbmltYXRpb24uX2lzQWZmaW5lVHJhbnNmb3JtKGFuaW1hdGlvbjIucHJvcGVydHkpICYmXG4gICAgICAgICAgICBhbmltYXRpb24xLnRhcmdldCA9PT0gYW5pbWF0aW9uMi50YXJnZXQgJiZcbiAgICAgICAgICAgIGFuaW1hdGlvbjEuZHVyYXRpb24gPT09IGFuaW1hdGlvbjIuZHVyYXRpb24gJiZcbiAgICAgICAgICAgIGFuaW1hdGlvbjEuZGVsYXkgPT09IGFuaW1hdGlvbjIuZGVsYXkgJiZcbiAgICAgICAgICAgIGFuaW1hdGlvbjEuaXRlcmF0aW9ucyA9PT0gYW5pbWF0aW9uMi5pdGVyYXRpb25zICYmXG4gICAgICAgICAgICBhbmltYXRpb24xLmN1cnZlID09PSBhbmltYXRpb24yLmN1cnZlO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQW5pbWF0aW9uLl9tZXJnZUFmZmluZVRyYW5zZm9ybUFuaW1hdGlvbnMgPSBmdW5jdGlvbiAocHJvcGVydHlBbmltYXRpb25zKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdmFyIGkgPSAwO1xuICAgICAgICB2YXIgajtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHByb3BlcnR5QW5pbWF0aW9ucy5sZW5ndGg7XG4gICAgICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eUFuaW1hdGlvbnNbaV1bX3NraXBdKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIUFuaW1hdGlvbi5faXNBZmZpbmVUcmFuc2Zvcm0ocHJvcGVydHlBbmltYXRpb25zW2ldLnByb3BlcnR5KSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHByb3BlcnR5QW5pbWF0aW9uc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgbmV3VHJhbnNmb3JtQW5pbWF0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHByb3BlcnR5QW5pbWF0aW9uc1tpXS50YXJnZXQsXG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5OiBfdHJhbnNmb3JtLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZToge30sXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBwcm9wZXJ0eUFuaW1hdGlvbnNbaV0uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIGRlbGF5OiBwcm9wZXJ0eUFuaW1hdGlvbnNbaV0uZGVsYXksXG4gICAgICAgICAgICAgICAgICAgIGl0ZXJhdGlvbnM6IHByb3BlcnR5QW5pbWF0aW9uc1tpXS5pdGVyYXRpb25zLFxuICAgICAgICAgICAgICAgICAgICBjdXJ2ZTogcHJvcGVydHlBbmltYXRpb25zW2ldLmN1cnZlXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiQ3VydmU6IFwiICsgcHJvcGVydHlBbmltYXRpb25zW2ldLmN1cnZlLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5ld1RyYW5zZm9ybUFuaW1hdGlvbi52YWx1ZVtwcm9wZXJ0eUFuaW1hdGlvbnNbaV0ucHJvcGVydHldID0gcHJvcGVydHlBbmltYXRpb25zW2ldLnZhbHVlO1xuICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25fY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDcmVhdGVkIG5ldyB0cmFuc2Zvcm0gYW5pbWF0aW9uOiBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhuZXdUcmFuc2Zvcm1BbmltYXRpb24pLCBhbmltYXRpb25fY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLkFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGogPSBpICsgMTtcbiAgICAgICAgICAgICAgICBpZiAoaiA8IGxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKDsgaiA8IGxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoQW5pbWF0aW9uLl9jYW5CZU1lcmdlZChwcm9wZXJ0eUFuaW1hdGlvbnNbaV0sIHByb3BlcnR5QW5pbWF0aW9uc1tqXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZVdyaXRlKFwiTWVyZ2luZyBhbmltYXRpb25zOiBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhuZXdUcmFuc2Zvcm1BbmltYXRpb24pICsgXCIgKyBcIiArIEFuaW1hdGlvbi5fZ2V0QW5pbWF0aW9uSW5mbyhwcm9wZXJ0eUFuaW1hdGlvbnNbal0pICsgXCI7XCIsIGFuaW1hdGlvbl9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuQW5pbWF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VHJhbnNmb3JtQW5pbWF0aW9uLnZhbHVlW3Byb3BlcnR5QW5pbWF0aW9uc1tqXS5wcm9wZXJ0eV0gPSBwcm9wZXJ0eUFuaW1hdGlvbnNbal0udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcGVydHlBbmltYXRpb25zW2pdW19za2lwXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobmV3VHJhbnNmb3JtQW5pbWF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIEFuaW1hdGlvbjtcbn0oYW5pbWF0aW9uX2NvbW1vbl8xLkFuaW1hdGlvbkJhc2UpKTtcbmV4cG9ydHMuQW5pbWF0aW9uID0gQW5pbWF0aW9uO1xuZnVuY3Rpb24gX2dldFRyYW5zZm9ybU1pc21hdGNoRXJyb3JNZXNzYWdlKHZpZXcpIHtcbiAgICB2YXIgcmVzdWx0ID0gQ0dBZmZpbmVUcmFuc2Zvcm1JZGVudGl0eTtcbiAgICB2YXIgdHggPSB2aWV3LnRyYW5zbGF0ZVg7XG4gICAgdmFyIHR5ID0gdmlldy50cmFuc2xhdGVZO1xuICAgIHJlc3VsdCA9IENHQWZmaW5lVHJhbnNmb3JtVHJhbnNsYXRlKHJlc3VsdCwgdHgsIHR5KTtcbiAgICByZXN1bHQgPSBDR0FmZmluZVRyYW5zZm9ybVJvdGF0ZShyZXN1bHQsICh2aWV3LnJvdGF0ZSB8fCAwKSAqIE1hdGguUEkgLyAxODApO1xuICAgIHJlc3VsdCA9IENHQWZmaW5lVHJhbnNmb3JtU2NhbGUocmVzdWx0LCB2aWV3LnNjYWxlWCB8fCAxLCB2aWV3LnNjYWxlWSB8fCAxKTtcbiAgICB2YXIgdmlld1RyYW5zZm9ybSA9IE5TU3RyaW5nRnJvbUNHQWZmaW5lVHJhbnNmb3JtKHJlc3VsdCk7XG4gICAgdmFyIG5hdGl2ZVRyYW5zZm9ybSA9IE5TU3RyaW5nRnJvbUNHQWZmaW5lVHJhbnNmb3JtKHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC50cmFuc2Zvcm0pO1xuICAgIGlmICh2aWV3VHJhbnNmb3JtICE9PSBuYXRpdmVUcmFuc2Zvcm0pIHtcbiAgICAgICAgcmV0dXJuIFwiVmlldyBhbmQgTmF0aXZlIHRyYW5zZm9ybXMgZG8gbm90IG1hdGNoLiBWaWV3OiBcIiArIHZpZXdUcmFuc2Zvcm0gKyBcIjsgTmF0aXZlOiBcIiArIG5hdGl2ZVRyYW5zZm9ybTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuX2dldFRyYW5zZm9ybU1pc21hdGNoRXJyb3JNZXNzYWdlID0gX2dldFRyYW5zZm9ybU1pc21hdGNoRXJyb3JNZXNzYWdlO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YW5pbWF0aW9uLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZW51bXNfMSA9IHJlcXVpcmUoXCIuLi9lbnVtc1wiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIgYW5pbWF0aW9uXzEgPSByZXF1aXJlKFwiLi9hbmltYXRpb25cIik7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciBLZXlmcmFtZXMgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lcygpIHtcbiAgICB9XG4gICAgcmV0dXJuIEtleWZyYW1lcztcbn0oKSk7XG5leHBvcnRzLktleWZyYW1lcyA9IEtleWZyYW1lcztcbnZhciBVbnBhcnNlZEtleWZyYW1lID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBVbnBhcnNlZEtleWZyYW1lKCkge1xuICAgIH1cbiAgICByZXR1cm4gVW5wYXJzZWRLZXlmcmFtZTtcbn0oKSk7XG5leHBvcnRzLlVucGFyc2VkS2V5ZnJhbWUgPSBVbnBhcnNlZEtleWZyYW1lO1xudmFyIEtleWZyYW1lRGVjbGFyYXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEtleWZyYW1lRGVjbGFyYXRpb24oKSB7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZURlY2xhcmF0aW9uO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVEZWNsYXJhdGlvbiA9IEtleWZyYW1lRGVjbGFyYXRpb247XG52YXIgS2V5ZnJhbWVJbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUluZm8oKSB7XG4gICAgICAgIHRoaXMuY3VydmUgPSBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2U7XG4gICAgfVxuICAgIHJldHVybiBLZXlmcmFtZUluZm87XG59KCkpO1xuZXhwb3J0cy5LZXlmcmFtZUluZm8gPSBLZXlmcmFtZUluZm87XG52YXIgS2V5ZnJhbWVBbmltYXRpb25JbmZvID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUFuaW1hdGlvbkluZm8oKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IFwiXCI7XG4gICAgICAgIHRoaXMuZHVyYXRpb24gPSAwLjM7XG4gICAgICAgIHRoaXMuZGVsYXkgPSAwO1xuICAgICAgICB0aGlzLml0ZXJhdGlvbnMgPSAxO1xuICAgICAgICB0aGlzLmN1cnZlID0gXCJlYXNlXCI7XG4gICAgICAgIHRoaXMuaXNGb3J3YXJkcyA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzUmV2ZXJzZSA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gS2V5ZnJhbWVBbmltYXRpb25JbmZvO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVBbmltYXRpb25JbmZvID0gS2V5ZnJhbWVBbmltYXRpb25JbmZvO1xudmFyIEtleWZyYW1lQW5pbWF0aW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBLZXlmcmFtZUFuaW1hdGlvbigpIHtcbiAgICAgICAgdGhpcy5kZWxheSA9IDA7XG4gICAgICAgIHRoaXMuaXRlcmF0aW9ucyA9IDE7XG4gICAgfVxuICAgIEtleWZyYW1lQW5pbWF0aW9uLmtleWZyYW1lQW5pbWF0aW9uRnJvbUluZm8gPSBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICB2YXIgbGVuZ3RoID0gaW5mby5rZXlmcmFtZXMubGVuZ3RoO1xuICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB2YXIgc3RhcnREdXJhdGlvbiA9IDA7XG4gICAgICAgIGlmIChpbmZvLmlzUmV2ZXJzZSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMSA9IGxlbmd0aCAtIDE7IGluZGV4XzEgPj0gMDsgaW5kZXhfMS0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGtleWZyYW1lID0gaW5mby5rZXlmcmFtZXNbaW5kZXhfMV07XG4gICAgICAgICAgICAgICAgc3RhcnREdXJhdGlvbiA9IEtleWZyYW1lQW5pbWF0aW9uLnBhcnNlS2V5ZnJhbWUoaW5mbywga2V5ZnJhbWUsIGFuaW1hdGlvbnMsIHN0YXJ0RHVyYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9yICh2YXIgaW5kZXhfMiA9IDA7IGluZGV4XzIgPCBsZW5ndGg7IGluZGV4XzIrKykge1xuICAgICAgICAgICAgICAgIHZhciBrZXlmcmFtZSA9IGluZm8ua2V5ZnJhbWVzW2luZGV4XzJdO1xuICAgICAgICAgICAgICAgIHN0YXJ0RHVyYXRpb24gPSBLZXlmcmFtZUFuaW1hdGlvbi5wYXJzZUtleWZyYW1lKGluZm8sIGtleWZyYW1lLCBhbmltYXRpb25zLCBzdGFydER1cmF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4XzMgPSBsZW5ndGggLSAxOyBpbmRleF8zID4gMDsgaW5kZXhfMy0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIGExID0gYW5pbWF0aW9uc1tpbmRleF8zXTtcbiAgICAgICAgICAgICAgICB2YXIgYTIgPSBhbmltYXRpb25zW2luZGV4XzMgLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAoYTJbXCJjdXJ2ZVwiXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGExW1wiY3VydmVcIl0gPSBhMltcImN1cnZlXCJdO1xuICAgICAgICAgICAgICAgICAgICBhMltcImN1cnZlXCJdID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBhbmltYXRpb25zLm1hcChmdW5jdGlvbiAoYSkgeyByZXR1cm4gYVtcImN1cnZlXCJdID8gYSA6IE9iamVjdC5hc3NpZ24oYSwgeyBjdXJ2ZTogaW5mby5jdXJ2ZSB9KTsgfSk7XG4gICAgICAgIHZhciBhbmltYXRpb24gPSBuZXcgS2V5ZnJhbWVBbmltYXRpb24oKTtcbiAgICAgICAgYW5pbWF0aW9uLmRlbGF5ID0gaW5mby5kZWxheTtcbiAgICAgICAgYW5pbWF0aW9uLml0ZXJhdGlvbnMgPSBpbmZvLml0ZXJhdGlvbnM7XG4gICAgICAgIGFuaW1hdGlvbi5hbmltYXRpb25zID0gYW5pbWF0aW9ucztcbiAgICAgICAgYW5pbWF0aW9uLl9pc0ZvcndhcmRzID0gaW5mby5pc0ZvcndhcmRzO1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucGFyc2VLZXlmcmFtZSA9IGZ1bmN0aW9uIChpbmZvLCBrZXlmcmFtZSwgYW5pbWF0aW9ucywgc3RhcnREdXJhdGlvbikge1xuICAgICAgICB2YXIgYW5pbWF0aW9uID0ge307XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBrZXlmcmFtZS5kZWNsYXJhdGlvbnM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgZGVjbGFyYXRpb24gPSBfYVtfaV07XG4gICAgICAgICAgICBhbmltYXRpb25bZGVjbGFyYXRpb24ucHJvcGVydHldID0gZGVjbGFyYXRpb24udmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGR1cmF0aW9uID0ga2V5ZnJhbWUuZHVyYXRpb247XG4gICAgICAgIGlmIChkdXJhdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAwLjAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZHVyYXRpb24gPSAoaW5mby5kdXJhdGlvbiAqIGR1cmF0aW9uKSAtIHN0YXJ0RHVyYXRpb247XG4gICAgICAgICAgICBzdGFydER1cmF0aW9uICs9IGR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGFuaW1hdGlvbi5kdXJhdGlvbiA9IGluZm8uaXNSZXZlcnNlID8gaW5mby5kdXJhdGlvbiAtIGR1cmF0aW9uIDogZHVyYXRpb247XG4gICAgICAgIGFuaW1hdGlvbi5jdXJ2ZSA9IGtleWZyYW1lLmN1cnZlO1xuICAgICAgICBhbmltYXRpb24uZm9yY2VMYXllciA9IHRydWU7XG4gICAgICAgIGFuaW1hdGlvbi52YWx1ZVNvdXJjZSA9IFwia2V5ZnJhbWVcIjtcbiAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgIHJldHVybiBzdGFydER1cmF0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZSwgXCJpc1BsYXlpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc1BsYXlpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJLZXlmcmFtZSBhbmltYXRpb24gaXMgYWxyZWFkeSBwbGF5aW5nLlwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuX25hdGl2ZUFuaW1hdGlvbnNbaV07XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9uLmlzUGxheWluZykge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbi5jYW5jZWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbmF0aXZlQW5pbWF0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1swXTtcbiAgICAgICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9uVmFsdWVzKHRoaXMuX3RhcmdldCwgYW5pbWF0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9yZXNldEFuaW1hdGlvbnMoKTtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMuX2lzUGxheWluZykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIktleWZyYW1lIGFuaW1hdGlvbiBpcyBhbHJlYWR5IHBsYXlpbmcuXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHtcbiAgICAgICAgICAgIF90aGlzLl9yZXNvbHZlID0gcmVzb2x2ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gdmlldztcbiAgICAgICAgaWYgKHRoaXMuZGVsYXkgIT09IDApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuYW5pbWF0ZSh2aWV3LCAwLCBfdGhpcy5pdGVyYXRpb25zKTsgfSwgdGhpcy5kZWxheSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGUodmlldywgMCwgdGhpcy5pdGVyYXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW5pbWF0aW9uRmluaXNoZWRQcm9taXNlO1xuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLmFuaW1hdGUgPSBmdW5jdGlvbiAodmlldywgaW5kZXgsIGl0ZXJhdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLl9pc1BsYXlpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB0aGlzLmFuaW1hdGlvbnNbMF07XG4gICAgICAgICAgICBpZiAoXCJiYWNrZ3JvdW5kQ29sb3JcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uYmFja2dyb3VuZENvbG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwic2NhbGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uc2NhbGUueDtcbiAgICAgICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24uc2NhbGUueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInRyYW5zbGF0ZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24udHJhbnNsYXRlLng7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi50cmFuc2xhdGUueTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcInJvdGF0ZVwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5yb3RhdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LmtleWZyYW1lXSA9IGFuaW1hdGlvbi5vcGFjaXR5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKFwiaGVpZ2h0XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuaGVpZ2h0UHJvcGVydHkua2V5ZnJhbWVdID0gYW5pbWF0aW9uLmhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChcIndpZHRoXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBhbmltYXRpb24ud2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmFuaW1hdGUodmlldywgMSwgaXRlcmF0aW9ucyk7IH0sIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLmFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpdGVyYXRpb25zIC09IDE7XG4gICAgICAgICAgICBpZiAoaXRlcmF0aW9ucyA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1hdGUodmlldywgMCwgaXRlcmF0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNGb3J3YXJkcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IHRoaXMuYW5pbWF0aW9uc1t0aGlzLmFuaW1hdGlvbnMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2V0QW5pbWF0aW9uVmFsdWVzKHZpZXcsIGFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc29sdmVBbmltYXRpb25GaW5pc2hlZFByb21pc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBhbmltYXRpb24gPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgY2FjaGVkQW5pbWF0aW9uID0gdGhpcy5fbmF0aXZlQW5pbWF0aW9uc1tpbmRleCAtIDFdO1xuICAgICAgICAgICAgaWYgKGNhY2hlZEFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IGNhY2hlZEFuaW1hdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhbmltYXRpb25EZWYgPSB0aGlzLmFuaW1hdGlvbnNbaW5kZXhdO1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkRlZi50YXJnZXQgPSB2aWV3O1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbiA9IG5ldyBhbmltYXRpb25fMS5BbmltYXRpb24oW2FuaW1hdGlvbkRlZl0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX25hdGl2ZUFuaW1hdGlvbnMucHVzaChhbmltYXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGlzTGFzdEl0ZXJhdGlvbiA9IGl0ZXJhdGlvbnMgLSAxIDw9IDA7XG4gICAgICAgICAgICBhbmltYXRpb24ucGxheShpc0xhc3RJdGVyYXRpb24pLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLmFuaW1hdGUodmlldywgaW5kZXggKyAxLCBpdGVyYXRpb25zKTtcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUodHlwZW9mIGVycm9yID09PSBcInN0cmluZ1wiID8gZXJyb3IgOiBlcnJvci5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZSh0eXBlb2YgZXJyb3IgPT09IFwic3RyaW5nXCIgPyBlcnJvciA6IGVycm9yLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgS2V5ZnJhbWVBbmltYXRpb24ucHJvdG90eXBlLl9yZXNvbHZlQW5pbWF0aW9uRmluaXNoZWRQcm9taXNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9uYXRpdmVBbmltYXRpb25zID0gbmV3IEFycmF5KCk7XG4gICAgICAgIHRoaXMuX2lzUGxheWluZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl90YXJnZXQgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZXNvbHZlKCk7XG4gICAgfTtcbiAgICBLZXlmcmFtZUFuaW1hdGlvbi5wcm90b3R5cGUuX3Jlc2V0QW5pbWF0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fbmF0aXZlQW5pbWF0aW9ucyA9IG5ldyBBcnJheSgpO1xuICAgICAgICB0aGlzLl9pc1BsYXlpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gbnVsbDtcbiAgICB9O1xuICAgIEtleWZyYW1lQW5pbWF0aW9uLnByb3RvdHlwZS5fcmVzZXRBbmltYXRpb25WYWx1ZXMgPSBmdW5jdGlvbiAodmlldywgYW5pbWF0aW9uKSB7XG4gICAgICAgIGlmIChcImJhY2tncm91bmRDb2xvclwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZENvbG9yUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwic2NhbGVcIiBpbiBhbmltYXRpb24pIHtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWFByb3BlcnR5LmtleWZyYW1lXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwidHJhbnNsYXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVZUHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwicm90YXRlXCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5yb3RhdGVQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJvcGFjaXR5XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5vcGFjaXR5UHJvcGVydHkua2V5ZnJhbWVdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiaGVpZ2h0XCIgaW4gYW5pbWF0aW9uKSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW3N0eWxlX3Byb3BlcnRpZXNfMS5oZWlnaHRQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoXCJ3aWR0aFwiIGluIGFuaW1hdGlvbikge1xuICAgICAgICAgICAgdmlldy5zdHlsZVtzdHlsZV9wcm9wZXJ0aWVzXzEud2lkdGhQcm9wZXJ0eS5rZXlmcmFtZV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEtleWZyYW1lQW5pbWF0aW9uO1xufSgpKTtcbmV4cG9ydHMuS2V5ZnJhbWVBbmltYXRpb24gPSBLZXlmcmFtZUFuaW1hdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWtleWZyYW1lLWFuaW1hdGlvbi5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZXhwcmVzc2lvblN5bWJvbHNSZWdleCA9IC9bXFwrXFwtXFwqXFwvJVxcPzo8Pj0hXFx8JlxcKFxcKV5+XS87XG52YXIgYmluZGluZ0NvbnN0YW50cztcbihmdW5jdGlvbiAoYmluZGluZ0NvbnN0YW50cykge1xuICAgIGJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHkgPSBcInNvdXJjZVByb3BlcnR5XCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy50YXJnZXRQcm9wZXJ0eSA9IFwidGFyZ2V0UHJvcGVydHlcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLmV4cHJlc3Npb24gPSBcImV4cHJlc3Npb25cIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnR3b1dheSA9IFwidHdvV2F5XCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5zb3VyY2UgPSBcInNvdXJjZVwiO1xuICAgIGJpbmRpbmdDb25zdGFudHMuYmluZGluZ1ZhbHVlS2V5ID0gXCIkdmFsdWVcIjtcbiAgICBiaW5kaW5nQ29uc3RhbnRzLnBhcmVudFZhbHVlS2V5ID0gXCIkcGFyZW50XCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5wYXJlbnRzVmFsdWVLZXkgPSBcIiRwYXJlbnRzXCI7XG4gICAgYmluZGluZ0NvbnN0YW50cy5uZXdQcm9wZXJ0eVZhbHVlS2V5ID0gXCIkbmV3UHJvcGVydHlWYWx1ZVwiO1xufSkoYmluZGluZ0NvbnN0YW50cyA9IGV4cG9ydHMuYmluZGluZ0NvbnN0YW50cyB8fCAoZXhwb3J0cy5iaW5kaW5nQ29uc3RhbnRzID0ge30pKTtcbnZhciBoYXNFcXVhbFNpZ25SZWdleCA9IC89Ky87XG52YXIgZXF1YWxTaWduQ29tcGFyaXNpb25PcGVyYXRvcnNSZWdleCA9IC8oPT18PT09fD49fDw9fCE9fCE9PSkvO1xuZXhwb3J0cy5wYXJlbnRzUmVnZXggPSAvXFwkcGFyZW50c1xccypcXFtcXHMqKFsnXCJdKilcXHcqXFwxXFxzKlxcXS9nO1xuZnVuY3Rpb24gaXNOYW1lZFBhcmFtKHZhbHVlKSB7XG4gICAgdmFyIGVxdWFsU2lnbkluZGV4ID0gdmFsdWUuc2VhcmNoKGhhc0VxdWFsU2lnblJlZ2V4KTtcbiAgICBpZiAoZXF1YWxTaWduSW5kZXggPiAtMSkge1xuICAgICAgICB2YXIgZXF1YWxTaWduU3Vycm91bmQgPSB2YWx1ZS5zdWJzdHIoZXF1YWxTaWduSW5kZXggPiAwID8gZXF1YWxTaWduSW5kZXggLSAxIDogMCwgMyk7XG4gICAgICAgIGlmIChlcXVhbFNpZ25TdXJyb3VuZC5zZWFyY2goZXF1YWxTaWduQ29tcGFyaXNpb25PcGVyYXRvcnNSZWdleCkgPT09IC0xKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBhcmVOYW1lZFBhcmFtcyhwYXJhbXMpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaXNOYW1lZFBhcmFtKHBhcmFtc1tpXSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbnZhciBuYW1lZFBhcmFtQ29uc3RhbnRzID0ge1xuICAgIHByb3BOYW1lOiBcInByb3BOYW1lXCIsXG4gICAgcHJvcFZhbHVlOiBcInByb3BWYWx1ZVwiXG59O1xuZnVuY3Rpb24gZ2V0UHJvcGVydHlOYW1lVmFsdWVQYWlyKHBhcmFtLCBrbm93bk9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIG5hbWVWYWx1ZVBhaXIgPSB7fTtcbiAgICB2YXIgcHJvcGVydHlOYW1lID0gcGFyYW0uc3Vic3RyKDAsIHBhcmFtLmluZGV4T2YoXCI9XCIpKS50cmltKCk7XG4gICAgdmFyIHByb3BlcnR5VmFsdWUgPSBwYXJhbS5zdWJzdHIocGFyYW0uaW5kZXhPZihcIj1cIikgKyAxKS50cmltKCk7XG4gICAgaWYgKGtub3duT3B0aW9ucykge1xuICAgICAgICBpZiAoIXByb3BlcnR5TmFtZSkge1xuICAgICAgICAgICAgcHJvcGVydHlOYW1lID0ga25vd25PcHRpb25zLmRlZmF1bHRQcm9wZXJ0eTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHByb3BlcnR5TmFtZSA9IHByb3BlcnR5TmFtZSBpbiBrbm93bk9wdGlvbnMgPyBwcm9wZXJ0eU5hbWUgOiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChwcm9wZXJ0eU5hbWUpIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBuYW1lVmFsdWVQYWlyID0gY2FsbGJhY2socHJvcGVydHlOYW1lLCBwcm9wZXJ0eVZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hbWVWYWx1ZVBhaXJbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wTmFtZV0gPSBwcm9wZXJ0eU5hbWU7XG4gICAgICAgICAgICBuYW1lVmFsdWVQYWlyW25hbWVkUGFyYW1Db25zdGFudHMucHJvcFZhbHVlXSA9IHByb3BlcnR5VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5hbWVWYWx1ZVBhaXI7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gcGFyc2VOYW1lZFByb3BlcnRpZXMocGFyYW1ldGVyTGlzdCwga25vd25PcHRpb25zLCBjYWxsYmFjaykge1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICB2YXIgbmFtZVZhbHVlUGFpcjtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcmFtZXRlckxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbmFtZVZhbHVlUGFpciA9IGdldFByb3BlcnR5TmFtZVZhbHVlUGFpcihwYXJhbWV0ZXJMaXN0W2ldLCBrbm93bk9wdGlvbnMsIGNhbGxiYWNrKTtcbiAgICAgICAgaWYgKG5hbWVWYWx1ZVBhaXIpIHtcbiAgICAgICAgICAgIHJlc3VsdFtuYW1lVmFsdWVQYWlyW25hbWVkUGFyYW1Db25zdGFudHMucHJvcE5hbWVdXSA9IG5hbWVWYWx1ZVBhaXJbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wVmFsdWVdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRQYXJhbXNBcnJheSh2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgc2tpcENvbW1hID0gMDtcbiAgICB2YXIgaW5kZXhSZWFjaGVkID0gMDtcbiAgICB2YXIgc2luZ2xlUXVvdGVCbG9jayA9IGZhbHNlO1xuICAgIHZhciBkb3VibGVRdW90ZUJsb2NrID0gZmFsc2U7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YWx1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiXFxcIlwiKSB7XG4gICAgICAgICAgICBkb3VibGVRdW90ZUJsb2NrID0gIWRvdWJsZVF1b3RlQmxvY2s7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2ldID09PSBcIidcIikge1xuICAgICAgICAgICAgc2luZ2xlUXVvdGVCbG9jayA9ICFzaW5nbGVRdW90ZUJsb2NrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVtpXSA9PT0gXCIoXCIgfHwgdmFsdWVbaV0gPT09IFwiW1wiKSB7XG4gICAgICAgICAgICBza2lwQ29tbWErKztcbiAgICAgICAgfVxuICAgICAgICBpZiAodmFsdWVbaV0gPT09IFwiKVwiIHx8IHZhbHVlW2ldID09PSBcIl1cIikge1xuICAgICAgICAgICAgc2tpcENvbW1hLS07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZhbHVlW2ldID09PSBcIixcIiAmJiBza2lwQ29tbWEgPT09IDAgJiYgIShzaW5nbGVRdW90ZUJsb2NrIHx8IGRvdWJsZVF1b3RlQmxvY2spKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaCh2YWx1ZS5zdWJzdHIoaW5kZXhSZWFjaGVkLCBpIC0gaW5kZXhSZWFjaGVkKSk7XG4gICAgICAgICAgICBpbmRleFJlYWNoZWQgPSBpICsgMTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXN1bHQucHVzaCh2YWx1ZS5zdWJzdHIoaW5kZXhSZWFjaGVkKSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGlzRXhwcmVzc2lvbihleHByZXNzaW9uKSB7XG4gICAgaWYgKGV4cHJlc3Npb24uc2VhcmNoKGV4cHJlc3Npb25TeW1ib2xzUmVnZXgpID4gLTEpIHtcbiAgICAgICAgdmFyIHBhcmVudHNNYXRjaGVzID0gZXhwcmVzc2lvbi5tYXRjaChleHBvcnRzLnBhcmVudHNSZWdleCk7XG4gICAgICAgIGlmIChwYXJlbnRzTWF0Y2hlcykge1xuICAgICAgICAgICAgdmFyIHJlc3RPZkV4cHJlc3Npb24gPSBleHByZXNzaW9uLnN1YnN0cihleHByZXNzaW9uLmluZGV4T2YocGFyZW50c01hdGNoZXNbMF0pICsgcGFyZW50c01hdGNoZXNbMF0ubGVuZ3RoKTtcbiAgICAgICAgICAgIGlmICghKHJlc3RPZkV4cHJlc3Npb24uc2VhcmNoKGV4cHJlc3Npb25TeW1ib2xzUmVnZXgpID4gLTEpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBnZXRCaW5kaW5nT3B0aW9ucyhuYW1lLCB2YWx1ZSkge1xuICAgIHZhciBuYW1lZFBhcmFtcyA9IFtdO1xuICAgIHZhciBwYXJhbXMgPSBnZXRQYXJhbXNBcnJheSh2YWx1ZSk7XG4gICAgaWYgKCFhcmVOYW1lZFBhcmFtcyhwYXJhbXMpKSB7XG4gICAgICAgIGlmIChwYXJhbXMubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICB2YXIgdHJpbW1lZFZhbHVlID0gcGFyYW1zWzBdLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VQcm9wID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGlzRXhwcmVzc2lvbih0cmltbWVkVmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgc291cmNlUHJvcCA9IGJpbmRpbmdDb25zdGFudHMuYmluZGluZ1ZhbHVlS2V5O1xuICAgICAgICAgICAgICAgIG5hbWVkUGFyYW1zLnB1c2goYmluZGluZ0NvbnN0YW50cy5leHByZXNzaW9uICsgXCIgPSBcIiArIHRyaW1tZWRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VQcm9wID0gdHJpbW1lZFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZVByb3BlcnR5ICsgXCIgPSBcIiArIHNvdXJjZVByb3ApO1xuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLnR3b1dheSArIFwiID0gdHJ1ZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG5hbWVkUGFyYW1zLnB1c2goYmluZGluZ0NvbnN0YW50cy5zb3VyY2VQcm9wZXJ0eSArIFwiID0gXCIgKyBwYXJhbXNbMF0udHJpbSgpKTtcbiAgICAgICAgICAgIG5hbWVkUGFyYW1zLnB1c2goYmluZGluZ0NvbnN0YW50cy5leHByZXNzaW9uICsgXCIgPSBcIiArIHBhcmFtc1sxXS50cmltKCkpO1xuICAgICAgICAgICAgdmFyIHR3b1dheSA9IHBhcmFtc1syXSA/IHBhcmFtc1syXS50b0xvd2VyQ2FzZSgpLnRyaW0oKSA9PT0gXCJ0cnVlXCIgOiB0cnVlO1xuICAgICAgICAgICAgbmFtZWRQYXJhbXMucHVzaChiaW5kaW5nQ29uc3RhbnRzLnR3b1dheSArIFwiID0gXCIgKyB0d29XYXkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBuYW1lZFBhcmFtcyA9IHBhcmFtcztcbiAgICB9XG4gICAgdmFyIGJpbmRpbmdQcm9wZXJ0eUhhbmRsZXIgPSBmdW5jdGlvbiAocHJvcCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICByZXN1bHRbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wTmFtZV0gPSBwcm9wO1xuICAgICAgICBpZiAocHJvcCA9PT0gYmluZGluZ0NvbnN0YW50cy50d29XYXkpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gXCJ0cnVlXCIpIHtcbiAgICAgICAgICAgICAgICByZXN1bHRbbmFtZWRQYXJhbUNvbnN0YW50cy5wcm9wVmFsdWVdID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdFtuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV0gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdFtuYW1lZFBhcmFtQ29uc3RhbnRzLnByb3BWYWx1ZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgdmFyIGJpbmRpbmdPcHRpb25zUGFyYW1ldGVycyA9IHBhcnNlTmFtZWRQcm9wZXJ0aWVzKG5hbWVkUGFyYW1zLCB4bWxCaW5kaW5nUHJvcGVydGllcywgYmluZGluZ1Byb3BlcnR5SGFuZGxlcik7XG4gICAgdmFyIGJpbmRPcHRpb25zID0ge1xuICAgICAgICB0YXJnZXRQcm9wZXJ0eTogbmFtZVxuICAgIH07XG4gICAgZm9yICh2YXIgcHJvcCBpbiBiaW5kaW5nT3B0aW9uc1BhcmFtZXRlcnMpIHtcbiAgICAgICAgaWYgKGJpbmRpbmdPcHRpb25zUGFyYW1ldGVycy5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICAgICAgYmluZE9wdGlvbnNbcHJvcF0gPSBiaW5kaW5nT3B0aW9uc1BhcmFtZXRlcnNbcHJvcF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGJpbmRPcHRpb25zW2JpbmRpbmdDb25zdGFudHMudHdvV2F5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGJpbmRPcHRpb25zW2JpbmRpbmdDb25zdGFudHMudHdvV2F5XSA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBiaW5kT3B0aW9ucztcbn1cbmV4cG9ydHMuZ2V0QmluZGluZ09wdGlvbnMgPSBnZXRCaW5kaW5nT3B0aW9ucztcbnZhciB4bWxCaW5kaW5nUHJvcGVydGllcyA9IHtcbiAgICBzb3VyY2VQcm9wZXJ0eTogdHJ1ZSxcbiAgICBleHByZXNzaW9uOiB0cnVlLFxuICAgIHR3b1dheTogdHJ1ZSxcbiAgICBzb3VyY2U6IHRydWUsXG4gICAgZGVmYXVsdFByb3BlcnR5OiBiaW5kaW5nQ29uc3RhbnRzLnNvdXJjZVByb3BlcnR5XG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmluZGluZy1idWlsZGVyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBkZWJ1Z18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL2RlYnVnXCIpO1xudmFyIHhtbCA9IHJlcXVpcmUoXCIuLi8uLi94bWxcIik7XG52YXIgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBjb21wb25lbnRfYnVpbGRlcl8xID0gcmVxdWlyZShcIi4vY29tcG9uZW50LWJ1aWxkZXJcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi9wcm9maWxpbmdcIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG52YXIgbW9kdWxlX25hbWVfcmVzb2x2ZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9tb2R1bGUtbmFtZS1yZXNvbHZlclwiKTtcbnZhciBpb3MgPSBwbGF0Zm9ybV8xLnBsYXRmb3JtTmFtZXMuaW9zLnRvTG93ZXJDYXNlKCk7XG52YXIgYW5kcm9pZCA9IHBsYXRmb3JtXzEucGxhdGZvcm1OYW1lcy5hbmRyb2lkLnRvTG93ZXJDYXNlKCk7XG52YXIgZGVmYXVsdE5hbWVTcGFjZU1hdGNoZXIgPSAvdG5zXFwueHNkJC9pO1xuZnVuY3Rpb24gcGFyc2UodmFsdWUsIGNvbnRleHQpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgZXhwb3J0c18xID0gY29udGV4dCA/IGdldEV4cG9ydHMoY29udGV4dCkgOiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBjb21wb25lbnRNb2R1bGUgPSBwYXJzZUludGVybmFsKHZhbHVlLCBleHBvcnRzXzEpO1xuICAgICAgICByZXR1cm4gY29tcG9uZW50TW9kdWxlICYmIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgfVxufVxuZXhwb3J0cy5wYXJzZSA9IHBhcnNlO1xuZnVuY3Rpb24gcGFyc2VNdWx0aXBsZVRlbXBsYXRlcyh2YWx1ZSwgY29udGV4dCkge1xuICAgIHZhciBkdW1teUNvbXBvbmVudCA9IFwiPExpc3RWaWV3PjxMaXN0Vmlldy5pdGVtVGVtcGxhdGVzPlwiICsgdmFsdWUgKyBcIjwvTGlzdFZpZXcuaXRlbVRlbXBsYXRlcz48L0xpc3RWaWV3PlwiO1xuICAgIHJldHVybiBwYXJzZUludGVybmFsKGR1bW15Q29tcG9uZW50LCBjb250ZXh0KS5jb21wb25lbnRbXCJpdGVtVGVtcGxhdGVzXCJdO1xufVxuZXhwb3J0cy5wYXJzZU11bHRpcGxlVGVtcGxhdGVzID0gcGFyc2VNdWx0aXBsZVRlbXBsYXRlcztcbmZ1bmN0aW9uIGxvYWQocGF0aE9yT3B0aW9ucywgY29udGV4dCkge1xuICAgIHZhciBjb21wb25lbnRNb2R1bGU7XG4gICAgaWYgKHR5cGVvZiBwYXRoT3JPcHRpb25zID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHZhciBtb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfc2FuaXRpemVyXzEuc2FuaXRpemVNb2R1bGVOYW1lKHBhdGhPck9wdGlvbnMpO1xuICAgICAgICBjb21wb25lbnRNb2R1bGUgPSBsb2FkSW50ZXJuYWwobW9kdWxlTmFtZSwgY29udGV4dCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBjb21wb25lbnRNb2R1bGUgPSBsb2FkQ3VzdG9tQ29tcG9uZW50KHBhdGhPck9wdGlvbnMucGF0aCwgcGF0aE9yT3B0aW9ucy5uYW1lLCBwYXRoT3JPcHRpb25zLmF0dHJpYnV0ZXMsIHBhdGhPck9wdGlvbnMuZXhwb3J0cywgcGF0aE9yT3B0aW9ucy5wYWdlLCB0cnVlKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudE1vZHVsZSAmJiBjb21wb25lbnRNb2R1bGUuY29tcG9uZW50O1xufVxuZXhwb3J0cy5sb2FkID0gbG9hZDtcbmV4cG9ydHMuY3JlYXRlVmlld0Zyb21FbnRyeSA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJjcmVhdGVWaWV3RnJvbUVudHJ5XCIsIGZ1bmN0aW9uIChlbnRyeSkge1xuICAgIGlmIChlbnRyeS5jcmVhdGUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSBlbnRyeS5jcmVhdGUoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gY3JlYXRlIFZpZXcgd2l0aCBlbnRyeS5jcmVhdGUoKSBmdW5jdGlvbi5cIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfVxuICAgIGVsc2UgaWYgKGVudHJ5Lm1vZHVsZU5hbWUpIHtcbiAgICAgICAgdmFyIG1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUoZW50cnkubW9kdWxlTmFtZSk7XG4gICAgICAgIHZhciByZXNvbHZlZENvZGVNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcIlwiKTtcbiAgICAgICAgdmFyIG1vZHVsZUV4cG9ydHMgPSByZXNvbHZlZENvZGVNb2R1bGVOYW1lID8gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRDb2RlTW9kdWxlTmFtZSwgdHJ1ZSkgOiBudWxsO1xuICAgICAgICBpZiAobW9kdWxlRXhwb3J0cyAmJiBtb2R1bGVFeHBvcnRzLmNyZWF0ZVBhZ2UpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gbW9kdWxlRXhwb3J0cy5jcmVhdGVQYWdlKCk7XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcImNzc1wiKTtcbiAgICAgICAgICAgIGlmIChyZXNvbHZlZENzc01vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgICAgICB2aWV3LmFkZENzc0ZpbGUocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2aWV3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIGNvbXBvbmVudE1vZHVsZSA9IGxvYWRJbnRlcm5hbChtb2R1bGVOYW1lLCBtb2R1bGVFeHBvcnRzKTtcbiAgICAgICAgICAgIHZhciBjb21wb25lbnRWaWV3ID0gY29tcG9uZW50TW9kdWxlICYmIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50VmlldztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBwYWdlIFhNTCBmaWxlIGZvciBtb2R1bGU6IFwiICsgZW50cnkubW9kdWxlTmFtZSk7XG59KTtcbmZ1bmN0aW9uIGxvYWRJbnRlcm5hbChtb2R1bGVOYW1lLCBtb2R1bGVFeHBvcnRzKSB7XG4gICAgdmFyIGNvbXBvbmVudE1vZHVsZTtcbiAgICB2YXIgcmVzb2x2ZWRYbWxNb2R1bGUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwieG1sXCIpO1xuICAgIGlmIChyZXNvbHZlZFhtbE1vZHVsZSkge1xuICAgICAgICB2YXIgdGV4dCA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkWG1sTW9kdWxlLCB0cnVlKTtcbiAgICAgICAgY29tcG9uZW50TW9kdWxlID0gcGFyc2VJbnRlcm5hbCh0ZXh0LCBtb2R1bGVFeHBvcnRzLCByZXNvbHZlZFhtbE1vZHVsZSwgbW9kdWxlTmFtZSk7XG4gICAgfVxuICAgIHZhciBjb21wb25lbnRWaWV3ID0gY29tcG9uZW50TW9kdWxlICYmIGNvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgaWYgKGNvbXBvbmVudFZpZXcpIHtcbiAgICAgICAgY29tcG9uZW50Vmlldy5leHBvcnRzID0gbW9kdWxlRXhwb3J0cztcbiAgICAgICAgY29tcG9uZW50Vmlldy5fbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWU7XG4gICAgfVxuICAgIGlmICghY29tcG9uZW50TW9kdWxlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBsb2FkIGNvbXBvbmVudCBmcm9tIG1vZHVsZTogXCIgKyBtb2R1bGVOYW1lKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudE1vZHVsZTtcbn1cbmZ1bmN0aW9uIGxvYWRDdXN0b21Db21wb25lbnQoY29tcG9uZW50TmFtZXNwYWNlLCBjb21wb25lbnROYW1lLCBhdHRyaWJ1dGVzLCBjb250ZXh0LCBwYXJlbnRQYWdlLCBpc1Jvb3RDb21wb25lbnQsIG1vZHVsZU5hbWVQYXRoKSB7XG4gICAgaWYgKGlzUm9vdENvbXBvbmVudCA9PT0gdm9pZCAwKSB7IGlzUm9vdENvbXBvbmVudCA9IHRydWU7IH1cbiAgICBpZiAoIXBhcmVudFBhZ2UgJiYgY29udGV4dCkge1xuICAgICAgICBwYXJlbnRQYWdlID0gY29udGV4dFtcIl9wYXJlbnRQYWdlXCJdO1xuICAgICAgICBkZWxldGUgY29udGV4dFtcIl9wYXJlbnRQYWdlXCJdO1xuICAgIH1cbiAgICB2YXIgcmVzdWx0O1xuICAgIGNvbXBvbmVudE5hbWVzcGFjZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShjb21wb25lbnROYW1lc3BhY2UpO1xuICAgIHZhciBtb2R1bGVOYW1lID0gY29tcG9uZW50TmFtZXNwYWNlICsgXCIvXCIgKyBjb21wb25lbnROYW1lO1xuICAgIHZhciByZXNvbHZlZENvZGVNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcIlwiKTtcbiAgICB2YXIgcmVzb2x2ZWRYbWxNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcInhtbFwiKTtcbiAgICB2YXIgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVOYW1lLCBcImNzc1wiKTtcbiAgICBpZiAocmVzb2x2ZWRYbWxNb2R1bGVOYW1lKSB7XG4gICAgICAgIHZhciBzdWJFeHBvcnRzID0gY29udGV4dDtcbiAgICAgICAgaWYgKHJlc29sdmVkQ29kZU1vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIHN1YkV4cG9ydHMgPSBnbG9iYWwubG9hZE1vZHVsZShyZXNvbHZlZENvZGVNb2R1bGVOYW1lLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXN1YkV4cG9ydHMpIHtcbiAgICAgICAgICAgIHN1YkV4cG9ydHMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBzdWJFeHBvcnRzW1wiX3BhcmVudFBhZ2VcIl0gPSBwYXJlbnRQYWdlO1xuICAgICAgICByZXN1bHQgPSBsb2FkSW50ZXJuYWwobW9kdWxlTmFtZSwgc3ViRXhwb3J0cyk7XG4gICAgICAgIGlmICh0eXBlc18xLmlzRGVmaW5lZChyZXN1bHQpICYmIHR5cGVzXzEuaXNEZWZpbmVkKHJlc3VsdC5jb21wb25lbnQpICYmIHR5cGVzXzEuaXNEZWZpbmVkKGF0dHJpYnV0ZXMpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBhdHRyIGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRfYnVpbGRlcl8xLnNldFByb3BlcnR5VmFsdWUocmVzdWx0LmNvbXBvbmVudCwgc3ViRXhwb3J0cywgY29udGV4dCwgYXR0ciwgYXR0cmlidXRlc1thdHRyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IGNvbXBvbmVudF9idWlsZGVyXzEuZ2V0Q29tcG9uZW50TW9kdWxlKGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudE5hbWVzcGFjZSwgYXR0cmlidXRlcywgY29udGV4dCwgbW9kdWxlTmFtZVBhdGgsIGlzUm9vdENvbXBvbmVudCk7XG4gICAgICAgIGlmICghcmVzb2x2ZWRDc3NNb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKGNvbXBvbmVudE5hbWVzcGFjZSwgXCJjc3NcIik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHBhcmVudFBhZ2UgJiYgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lKSB7XG4gICAgICAgIHBhcmVudFBhZ2UuYWRkQ3NzRmlsZShyZXNvbHZlZENzc01vZHVsZU5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gZ2V0RXhwb3J0cyhpbnN0YW5jZSkge1xuICAgIHZhciBpc1ZpZXcgPSAhIWluc3RhbmNlLl9kb21JZDtcbiAgICBpZiAoIWlzVmlldykge1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UuZXhwb3J0cyB8fCBpbnN0YW5jZTtcbiAgICB9XG4gICAgdmFyIGV4cG9ydE9iamVjdCA9IGluc3RhbmNlLmV4cG9ydHM7XG4gICAgdmFyIHBhcmVudCA9IGluc3RhbmNlLnBhcmVudDtcbiAgICB3aGlsZSAoZXhwb3J0T2JqZWN0ID09PSB1bmRlZmluZWQgJiYgcGFyZW50KSB7XG4gICAgICAgIGV4cG9ydE9iamVjdCA9IHBhcmVudC5leHBvcnRzO1xuICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgIH1cbiAgICByZXR1cm4gZXhwb3J0T2JqZWN0O1xufVxuZnVuY3Rpb24gcGFyc2VJbnRlcm5hbCh2YWx1ZSwgY29udGV4dCwgeG1sTW9kdWxlLCBtb2R1bGVOYW1lKSB7XG4gICAgdmFyIHN0YXJ0O1xuICAgIHZhciB1aTtcbiAgICB2YXIgZXJyb3JGb3JtYXQgPSAoZGVidWdfMS5kZWJ1ZyAmJiB4bWxNb2R1bGUpID8geG1sMnVpLlNvdXJjZUVycm9yRm9ybWF0KHhtbE1vZHVsZSkgOiB4bWwydWkuUG9zaXRpb25FcnJvckZvcm1hdDtcbiAgICB2YXIgY29tcG9uZW50U291cmNlVHJhY2tlciA9IChkZWJ1Z18xLmRlYnVnICYmIHhtbE1vZHVsZSkgPyB4bWwydWkuQ29tcG9uZW50U291cmNlVHJhY2tlcih4bWxNb2R1bGUpIDogZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgKHN0YXJ0ID0gbmV3IHhtbDJ1aS5YbWxTdHJpbmdQYXJzZXIoZXJyb3JGb3JtYXQpKVxuICAgICAgICAucGlwZShuZXcgeG1sMnVpLlBsYXRmb3JtRmlsdGVyKCkpXG4gICAgICAgIC5waXBlKG5ldyB4bWwydWkuWG1sU3RhdGVQYXJzZXIodWkgPSBuZXcgeG1sMnVpLkNvbXBvbmVudFBhcnNlcihjb250ZXh0LCBlcnJvckZvcm1hdCwgY29tcG9uZW50U291cmNlVHJhY2tlciwgbW9kdWxlTmFtZSkpKTtcbiAgICBzdGFydC5wYXJzZSh2YWx1ZSk7XG4gICAgcmV0dXJuIHVpLnJvb3RDb21wb25lbnRNb2R1bGU7XG59XG52YXIgeG1sMnVpO1xuKGZ1bmN0aW9uICh4bWwydWkpIHtcbiAgICB2YXIgWG1sUHJvZHVjZXJCYXNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gWG1sUHJvZHVjZXJCYXNlKCkge1xuICAgICAgICB9XG4gICAgICAgIFhtbFByb2R1Y2VyQmFzZS5wcm90b3R5cGUucGlwZSA9IGZ1bmN0aW9uIChuZXh0KSB7XG4gICAgICAgICAgICB0aGlzLl9uZXh0ID0gbmV4dDtcbiAgICAgICAgICAgIHJldHVybiBuZXh0O1xuICAgICAgICB9O1xuICAgICAgICBYbWxQcm9kdWNlckJhc2UucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdGhpcy5fbmV4dC5wYXJzZShhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFhtbFByb2R1Y2VyQmFzZTtcbiAgICB9KCkpO1xuICAgIHhtbDJ1aS5YbWxQcm9kdWNlckJhc2UgPSBYbWxQcm9kdWNlckJhc2U7XG4gICAgdmFyIFhtbFN0cmluZ1BhcnNlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhYbWxTdHJpbmdQYXJzZXIsIF9zdXBlcik7XG4gICAgICAgIGZ1bmN0aW9uIFhtbFN0cmluZ1BhcnNlcihlcnJvcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgICAgIF90aGlzLmVycm9yID0gZXJyb3IgfHwgUG9zaXRpb25FcnJvckZvcm1hdDtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgICAgICBYbWxTdHJpbmdQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHhtbFBhcnNlciA9IG5ldyB4bWwuWG1sUGFyc2VyKGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubmV4dChhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgX3RoaXMuZXJyb3IoZSwgYXJncy5wb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUsIHApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBfdGhpcy5lcnJvcihlLCBwKTtcbiAgICAgICAgICAgIH0sIHRydWUpO1xuICAgICAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgeG1sUGFyc2VyLnBhcnNlKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFhtbFN0cmluZ1BhcnNlcjtcbiAgICB9KFhtbFByb2R1Y2VyQmFzZSkpO1xuICAgIHhtbDJ1aS5YbWxTdHJpbmdQYXJzZXIgPSBYbWxTdHJpbmdQYXJzZXI7XG4gICAgZnVuY3Rpb24gUG9zaXRpb25FcnJvckZvcm1hdChlLCBwKSB7XG4gICAgICAgIHJldHVybiBuZXcgZGVidWdfMS5TY29wZUVycm9yKGUsIFwiUGFyc2luZyBYTUwgYXQgXCIgKyBwLmxpbmUgKyBcIjpcIiArIHAuY29sdW1uKTtcbiAgICB9XG4gICAgeG1sMnVpLlBvc2l0aW9uRXJyb3JGb3JtYXQgPSBQb3NpdGlvbkVycm9yRm9ybWF0O1xuICAgIGZ1bmN0aW9uIFNvdXJjZUVycm9yRm9ybWF0KHVyaSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGUsIHApIHtcbiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBwID8gbmV3IGRlYnVnXzEuU291cmNlKHVyaSwgcC5saW5lLCBwLmNvbHVtbikgOiBuZXcgZGVidWdfMS5Tb3VyY2UodXJpLCAtMSwgLTEpO1xuICAgICAgICAgICAgZSA9IG5ldyBkZWJ1Z18xLlNvdXJjZUVycm9yKGUsIHNvdXJjZSwgXCJCdWlsZGluZyBVSSBmcm9tIFhNTC5cIik7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgeG1sMnVpLlNvdXJjZUVycm9yRm9ybWF0ID0gU291cmNlRXJyb3JGb3JtYXQ7XG4gICAgZnVuY3Rpb24gQ29tcG9uZW50U291cmNlVHJhY2tlcih1cmkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjb21wb25lbnQsIHApIHtcbiAgICAgICAgICAgIGlmICghZGVidWdfMS5Tb3VyY2UuZ2V0KGNvbXBvbmVudCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gcCA/IG5ldyBkZWJ1Z18xLlNvdXJjZSh1cmksIHAubGluZSwgcC5jb2x1bW4pIDogbmV3IGRlYnVnXzEuU291cmNlKHVyaSwgLTEsIC0xKTtcbiAgICAgICAgICAgICAgICBkZWJ1Z18xLlNvdXJjZS5zZXQoY29tcG9uZW50LCBzb3VyY2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICB4bWwydWkuQ29tcG9uZW50U291cmNlVHJhY2tlciA9IENvbXBvbmVudFNvdXJjZVRyYWNrZXI7XG4gICAgdmFyIFBsYXRmb3JtRmlsdGVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICAgICAgX19leHRlbmRzKFBsYXRmb3JtRmlsdGVyLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBQbGF0Zm9ybUZpbHRlcigpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgfVxuICAgICAgICBQbGF0Zm9ybUZpbHRlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChQbGF0Zm9ybUZpbHRlci5pc1BsYXRmb3JtKGFyZ3MuZWxlbWVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkFscmVhZHkgaW4gJ1wiICsgdGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0ICsgXCInIHBsYXRmb3JtIGNvbnRleHQgYW5kIGNhbm5vdCBzd2l0Y2ggdG8gJ1wiICsgYXJncy5lbGVtZW50TmFtZSArIFwiJyBwbGF0Zm9ybSEgUGxhdGZvcm0gdGFncyBjYW5ub3QgYmUgbmVzdGVkLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQgPSBhcmdzLmVsZW1lbnROYW1lO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpZiAoUGxhdGZvcm1GaWx0ZXIuaXNQbGF0Zm9ybShhcmdzLmVsZW1lbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQbGF0Zm9ybUNvbnRleHQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50UGxhdGZvcm1Db250ZXh0ICYmICFQbGF0Zm9ybUZpbHRlci5pc0N1cmVudFBsYXRmb3JtKHRoaXMuY3VycmVudFBsYXRmb3JtQ29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm5leHQoYXJncyk7XG4gICAgICAgIH07XG4gICAgICAgIFBsYXRmb3JtRmlsdGVyLmlzUGxhdGZvcm0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciB0b0xvd2VyID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9Mb3dlciA9PT0gYW5kcm9pZCB8fCB0b0xvd2VyID09PSBpb3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH07XG4gICAgICAgIFBsYXRmb3JtRmlsdGVyLmlzQ3VyZW50UGxhdGZvcm0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZSAmJiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBwbGF0Zm9ybV8xLmRldmljZS5vcy50b0xvd2VyQ2FzZSgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gUGxhdGZvcm1GaWx0ZXI7XG4gICAgfShYbWxQcm9kdWNlckJhc2UpKTtcbiAgICB4bWwydWkuUGxhdGZvcm1GaWx0ZXIgPSBQbGF0Zm9ybUZpbHRlcjtcbiAgICB2YXIgWG1sQXJnc1JlcGxheSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgICAgIF9fZXh0ZW5kcyhYbWxBcmdzUmVwbGF5LCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBYbWxBcmdzUmVwbGF5KGFyZ3MsIGVycm9yRm9ybWF0KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICAgICAgX3RoaXMuYXJncyA9IGFyZ3M7XG4gICAgICAgICAgICBfdGhpcy5lcnJvciA9IGVycm9yRm9ybWF0O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIFhtbEFyZ3NSZXBsYXkucHJvdG90eXBlLnJlcGxheSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmFyZ3MuZm9yRWFjaChmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm5leHQoYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IF90aGlzLmVycm9yKGUsIGFyZ3MucG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWG1sQXJnc1JlcGxheTtcbiAgICB9KFhtbFByb2R1Y2VyQmFzZSkpO1xuICAgIHhtbDJ1aS5YbWxBcmdzUmVwbGF5ID0gWG1sQXJnc1JlcGxheTtcbiAgICB2YXIgWG1sU3RhdGVQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBYbWxTdGF0ZVBhcnNlcihzdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgICB9XG4gICAgICAgIFhtbFN0YXRlUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gdGhpcy5zdGF0ZS5wYXJzZShhcmdzKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFhtbFN0YXRlUGFyc2VyO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLlhtbFN0YXRlUGFyc2VyID0gWG1sU3RhdGVQYXJzZXI7XG4gICAgdmFyIFRlbXBsYXRlUGFyc2VyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVGVtcGxhdGVQYXJzZXIocGFyZW50LCB0ZW1wbGF0ZVByb3BlcnR5LCBzZXRUZW1wbGF0ZVByb3BlcnR5KSB7XG4gICAgICAgICAgICBpZiAoc2V0VGVtcGxhdGVQcm9wZXJ0eSA9PT0gdm9pZCAwKSB7IHNldFRlbXBsYXRlUHJvcGVydHkgPSB0cnVlOyB9XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRleHQgPSB0ZW1wbGF0ZVByb3BlcnR5LmNvbnRleHQ7XG4gICAgICAgICAgICB0aGlzLl9yZWNvcmRlZFhtbFN0cmVhbSA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eSA9IHRlbXBsYXRlUHJvcGVydHk7XG4gICAgICAgICAgICB0aGlzLl9uZXN0aW5nTGV2ZWwgPSAwO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSAwO1xuICAgICAgICAgICAgdGhpcy5fc2V0VGVtcGxhdGVQcm9wZXJ0eSA9IHNldFRlbXBsYXRlUHJvcGVydHk7XG4gICAgICAgIH1cbiAgICAgICAgVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlU3RhcnRFbGVtZW50KGFyZ3MucHJlZml4LCBhcmdzLm5hbWVzcGFjZSwgYXJncy5lbGVtZW50TmFtZSwgYXJncy5hdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlRW5kRWxlbWVudChhcmdzLnByZWZpeCwgYXJncy5lbGVtZW50TmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZWNvcmRlZFhtbFN0cmVhbS5wdXNoKGFyZ3MpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXRlID09PSAyID8gdGhpcy5wYXJlbnQgOiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLCBcImVsZW1lbnROYW1lXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl90ZW1wbGF0ZVByb3BlcnR5LmVsZW1lbnROYW1lO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIFRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZS5wYXJzZVN0YXJ0RWxlbWVudCA9IGZ1bmN0aW9uIChwcmVmaXgsIG5hbWVzcGFjZSwgZWxlbWVudE5hbWUsIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuX3N0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGVtcGxhdGUgbXVzdCBoYXZlIGV4YWN0bHkgb25lIHJvb3QgZWxlbWVudCBidXQgbXVsdGlwbGUgZWxlbWVudHMgd2VyZSBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9uZXN0aW5nTGV2ZWwrKztcbiAgICAgICAgfTtcbiAgICAgICAgVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLnBhcnNlRW5kRWxlbWVudCA9IGZ1bmN0aW9uIChwcmVmaXgsIGVsZW1lbnROYW1lKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUZW1wbGF0ZSBtdXN0IGhhdmUgZXhhY3RseSBvbmUgcm9vdCBlbGVtZW50IGJ1dCBub25lIHdhcyBmb3VuZC5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLl9zdGF0ZSA9PT0gMikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIG1vcmUgY2xvc2luZyBlbGVtZW50cyBleHBlY3RlZCBmb3IgdGhpcyB0ZW1wbGF0ZS5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9uZXN0aW5nTGV2ZWwtLTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9uZXN0aW5nTGV2ZWwgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IDI7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NldFRlbXBsYXRlUHJvcGVydHkgJiYgdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5uYW1lIGluIHRoaXMuX3RlbXBsYXRlUHJvcGVydHkucGFyZW50LmNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSB0aGlzLmJ1aWxkVGVtcGxhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdGVtcGxhdGVQcm9wZXJ0eS5wYXJlbnQuY29tcG9uZW50W3RoaXMuX3RlbXBsYXRlUHJvcGVydHkubmFtZV0gPSB0ZW1wbGF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZS5idWlsZFRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcy5fY29udGV4dDtcbiAgICAgICAgICAgIHZhciBlcnJvckZvcm1hdCA9IHRoaXMuX3RlbXBsYXRlUHJvcGVydHkuZXJyb3JGb3JtYXQ7XG4gICAgICAgICAgICB2YXIgc291cmNlVHJhY2tlciA9IHRoaXMuX3RlbXBsYXRlUHJvcGVydHkuc291cmNlVHJhY2tlcjtcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJUZW1wbGF0ZSgpXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQ7XG4gICAgICAgICAgICAgICAgdmFyIHVpO1xuICAgICAgICAgICAgICAgIChzdGFydCA9IG5ldyB4bWwydWkuWG1sQXJnc1JlcGxheShfdGhpcy5fcmVjb3JkZWRYbWxTdHJlYW0sIGVycm9yRm9ybWF0KSlcbiAgICAgICAgICAgICAgICAgICAgLnBpcGUobmV3IFhtbFN0YXRlUGFyc2VyKHVpID0gbmV3IENvbXBvbmVudFBhcnNlcihjb250ZXh0LCBlcnJvckZvcm1hdCwgc291cmNlVHJhY2tlcikpKTtcbiAgICAgICAgICAgICAgICBzdGFydC5yZXBsYXkoKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdWkucm9vdENvbXBvbmVudE1vZHVsZS5jb21wb25lbnQ7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFRlbXBsYXRlUGFyc2VyO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLlRlbXBsYXRlUGFyc2VyID0gVGVtcGxhdGVQYXJzZXI7XG4gICAgdmFyIE11bHRpVGVtcGxhdGVQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBNdWx0aVRlbXBsYXRlUGFyc2VyKHBhcmVudCwgdGVtcGxhdGVQcm9wZXJ0eSkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgICAgICB0aGlzLnRlbXBsYXRlUHJvcGVydHkgPSB0ZW1wbGF0ZVByb3BlcnR5O1xuICAgICAgICAgICAgdGhpcy5fY2hpbGRQYXJzZXJzID0gbmV3IEFycmF5KCk7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KE11bHRpVGVtcGxhdGVQYXJzZXIucHJvdG90eXBlLCBcInZhbHVlXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fdmFsdWU7IH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBNdWx0aVRlbXBsYXRlUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICBpZiAoYXJncy5ldmVudFR5cGUgPT09IHhtbC5QYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50ICYmIGFyZ3MuZWxlbWVudE5hbWUgPT09IFwidGVtcGxhdGVcIikge1xuICAgICAgICAgICAgICAgIHZhciBjaGlsZFBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcih0aGlzLCB0aGlzLnRlbXBsYXRlUHJvcGVydHksIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBjaGlsZFBhcnNlcltcImtleVwiXSA9IGFyZ3MuYXR0cmlidXRlc1tcImtleVwiXTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGlsZFBhcnNlcnMucHVzaChjaGlsZFBhcnNlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNoaWxkUGFyc2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZV8xID0gQ29tcG9uZW50UGFyc2VyLmdldENvbXBsZXhQcm9wZXJ0eU5hbWUoYXJncy5lbGVtZW50TmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWVfMSA9PT0gdGhpcy50ZW1wbGF0ZVByb3BlcnR5Lm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlcyA9IG5ldyBBcnJheSgpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NoaWxkUGFyc2Vycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogdGhpcy5fY2hpbGRQYXJzZXJzW2ldW1wia2V5XCJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZVZpZXc6IHRoaXMuX2NoaWxkUGFyc2Vyc1tpXS5idWlsZFRlbXBsYXRlKClcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3ZhbHVlID0gdGVtcGxhdGVzO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5wYXJlbnQucGFyc2UoYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBNdWx0aVRlbXBsYXRlUGFyc2VyO1xuICAgIH0oKSk7XG4gICAgeG1sMnVpLk11bHRpVGVtcGxhdGVQYXJzZXIgPSBNdWx0aVRlbXBsYXRlUGFyc2VyO1xuICAgIHZhciBDb21wb25lbnRQYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDb21wb25lbnRQYXJzZXIoY29udGV4dCwgZXJyb3JGb3JtYXQsIHNvdXJjZVRyYWNrZXIsIG1vZHVsZU5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubW9kdWxlTmFtZSA9IG1vZHVsZU5hbWU7XG4gICAgICAgICAgICB0aGlzLnBhcmVudHMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgIHRoaXMuY29tcGxleFByb3BlcnRpZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgICAgICB0aGlzLmVycm9yID0gZXJyb3JGb3JtYXQ7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZVRyYWNrZXIgPSBzb3VyY2VUcmFja2VyO1xuICAgICAgICB9XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5wcm90b3R5cGUuYnVpbGRDb21wb25lbnQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgaWYgKGFyZ3MucHJlZml4ICYmIGFyZ3MubmFtZXNwYWNlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRDdXN0b21Db21wb25lbnQoYXJncy5uYW1lc3BhY2UsIGFyZ3MuZWxlbWVudE5hbWUsIGFyZ3MuYXR0cmlidXRlcywgdGhpcy5jb250ZXh0LCB0aGlzLmN1cnJlbnRSb290VmlldywgIXRoaXMuY3VycmVudFJvb3RWaWV3LCB0aGlzLm1vZHVsZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWVzcGFjZSA9IGFyZ3MubmFtZXNwYWNlO1xuICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0TmFtZVNwYWNlTWF0Y2hlci50ZXN0KG5hbWVzcGFjZSB8fCBcIlwiKSkge1xuICAgICAgICAgICAgICAgICAgICBuYW1lc3BhY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnRfYnVpbGRlcl8xLmdldENvbXBvbmVudE1vZHVsZShhcmdzLmVsZW1lbnROYW1lLCBuYW1lc3BhY2UsIGFyZ3MuYXR0cmlidXRlcywgdGhpcy5jb250ZXh0LCB0aGlzLm1vZHVsZU5hbWUsICF0aGlzLmN1cnJlbnRSb290Vmlldyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50c1t0aGlzLnBhcmVudHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB2YXIgY29tcGxleFByb3BlcnR5ID0gdGhpcy5jb21wbGV4UHJvcGVydGllc1t0aGlzLmNvbXBsZXhQcm9wZXJ0aWVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgaWYgKGFyZ3MuZXZlbnRUeXBlID09PSB4bWwuUGFyc2VyRXZlbnRUeXBlLlN0YXJ0RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGlmIChDb21wb25lbnRQYXJzZXIuaXNDb21wbGV4UHJvcGVydHkoYXJncy5lbGVtZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWVfMiA9IENvbXBvbmVudFBhcnNlci5nZXRDb21wbGV4UHJvcGVydHlOYW1lKGFyZ3MuZWxlbWVudE5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGxleFByb3BlcnR5XzEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHBhcmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVfMixcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zOiBbXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXhQcm9wZXJ0aWVzLnB1c2goY29tcGxleFByb3BlcnR5XzEpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoQ29tcG9uZW50UGFyc2VyLmlzS25vd25UZW1wbGF0ZShuYW1lXzIsIHBhcmVudC5leHBvcnRzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBUZW1wbGF0ZVBhcnNlcih0aGlzLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dDogKHBhcmVudCA/IGdldEV4cG9ydHMocGFyZW50LmNvbXBvbmVudCkgOiBudWxsKSB8fCB0aGlzLmNvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZV8yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnROYW1lOiBhcmdzLmVsZW1lbnROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlSXRlbXM6IFtdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yRm9ybWF0OiB0aGlzLmVycm9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZVRyYWNrZXI6IHRoaXMuc291cmNlVHJhY2tlclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0tub3duTXVsdGlUZW1wbGF0ZShuYW1lXzIsIHBhcmVudC5leHBvcnRzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnNlciA9IG5ldyBNdWx0aVRlbXBsYXRlUGFyc2VyKHRoaXMsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiAocGFyZW50ID8gZ2V0RXhwb3J0cyhwYXJlbnQuY29tcG9uZW50KSA6IG51bGwpIHx8IHRoaXMuY29udGV4dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHBhcmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lXzIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudE5hbWU6IGFyZ3MuZWxlbWVudE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVJdGVtczogW10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JGb3JtYXQ6IHRoaXMuZXJyb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlVHJhY2tlcjogdGhpcy5zb3VyY2VUcmFja2VyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXhQcm9wZXJ0eV8xLnBhcnNlciA9IHBhcnNlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZXI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb21wb25lbnRNb2R1bGUgPSB0aGlzLmJ1aWxkQ29tcG9uZW50KGFyZ3MpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50TW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZVRyYWNrZXIoY29tcG9uZW50TW9kdWxlLmNvbXBvbmVudCwgYXJncy5wb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBsZXhQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb21wb25lbnRQYXJzZXIuYWRkVG9Db21wbGV4UHJvcGVydHkocGFyZW50LCBjb21wbGV4UHJvcGVydHksIGNvbXBvbmVudE1vZHVsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBhcmVudC5jb21wb25lbnQuX2FkZENoaWxkRnJvbUJ1aWxkZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmNvbXBvbmVudC5fYWRkQ2hpbGRGcm9tQnVpbGRlcihhcmdzLmVsZW1lbnROYW1lLCBjb21wb25lbnRNb2R1bGUuY29tcG9uZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnBhcmVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290Q29tcG9uZW50TW9kdWxlID0gY29tcG9uZW50TW9kdWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJvb3RDb21wb25lbnRNb2R1bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50Um9vdFZpZXcgPSB0aGlzLnJvb3RDb21wb25lbnRNb2R1bGUuY29tcG9uZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50Um9vdFZpZXcuZXhwb3J0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jdXJyZW50Um9vdFZpZXcuZXhwb3J0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50cy5wdXNoKGNvbXBvbmVudE1vZHVsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChhcmdzLmV2ZW50VHlwZSA9PT0geG1sLlBhcnNlckV2ZW50VHlwZS5FbmRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKENvbXBvbmVudFBhcnNlci5pc0NvbXBsZXhQcm9wZXJ0eShhcmdzLmVsZW1lbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxleFByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tcGxleFByb3BlcnR5LnBhcnNlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5jb21wb25lbnRbY29tcGxleFByb3BlcnR5Lm5hbWVdID0gY29tcGxleFByb3BlcnR5LnBhcnNlci52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBhcmVudCAmJiBwYXJlbnQuY29tcG9uZW50Ll9hZGRBcnJheUZyb21CdWlsZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmNvbXBvbmVudC5fYWRkQXJyYXlGcm9tQnVpbGRlcihjb21wbGV4UHJvcGVydHkubmFtZSwgY29tcGxleFByb3BlcnR5Lml0ZW1zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wbGV4UHJvcGVydHkuaXRlbXMgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXBsZXhQcm9wZXJ0aWVzLnBvcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnRzLnBvcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuaXNDb21wbGV4UHJvcGVydHkgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIHR5cGVzXzEuaXNTdHJpbmcobmFtZSkgJiYgbmFtZS5pbmRleE9mKFwiLlwiKSAhPT0gLTE7XG4gICAgICAgIH07XG4gICAgICAgIENvbXBvbmVudFBhcnNlci5nZXRDb21wbGV4UHJvcGVydHlOYW1lID0gZnVuY3Rpb24gKGZ1bGxOYW1lKSB7XG4gICAgICAgICAgICB2YXIgbmFtZTtcbiAgICAgICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGZ1bGxOYW1lKSkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lcyA9IGZ1bGxOYW1lLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZXNbbmFtZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmlzS25vd25UZW1wbGF0ZSA9IGZ1bmN0aW9uIChuYW1lLCBleHBvcnRzKSB7XG4gICAgICAgICAgICByZXR1cm4gQ29tcG9uZW50UGFyc2VyLktOT1dOVEVNUExBVEVTIGluIGV4cG9ydHMgJiYgZXhwb3J0c1tDb21wb25lbnRQYXJzZXIuS05PV05URU1QTEFURVNdICYmIG5hbWUgaW4gZXhwb3J0c1tDb21wb25lbnRQYXJzZXIuS05PV05URU1QTEFURVNdO1xuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuaXNLbm93bk11bHRpVGVtcGxhdGUgPSBmdW5jdGlvbiAobmFtZSwgZXhwb3J0cykge1xuICAgICAgICAgICAgcmV0dXJuIENvbXBvbmVudFBhcnNlci5LTk9XTk1VTFRJVEVNUExBVEVTIGluIGV4cG9ydHMgJiYgZXhwb3J0c1tDb21wb25lbnRQYXJzZXIuS05PV05NVUxUSVRFTVBMQVRFU10gJiYgbmFtZSBpbiBleHBvcnRzW0NvbXBvbmVudFBhcnNlci5LTk9XTk1VTFRJVEVNUExBVEVTXTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLmFkZFRvQ29tcGxleFByb3BlcnR5ID0gZnVuY3Rpb24gKHBhcmVudCwgY29tcGxleFByb3BlcnR5LCBlbGVtZW50TW9kdWxlKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50Q29tcG9uZW50ID0gcGFyZW50LmNvbXBvbmVudDtcbiAgICAgICAgICAgIGlmIChDb21wb25lbnRQYXJzZXIuaXNLbm93bkNvbGxlY3Rpb24oY29tcGxleFByb3BlcnR5Lm5hbWUsIHBhcmVudC5leHBvcnRzKSkge1xuICAgICAgICAgICAgICAgIGNvbXBsZXhQcm9wZXJ0eS5pdGVtcy5wdXNoKGVsZW1lbnRNb2R1bGUuY29tcG9uZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHBhcmVudENvbXBvbmVudC5fYWRkQ2hpbGRGcm9tQnVpbGRlcikge1xuICAgICAgICAgICAgICAgIHBhcmVudENvbXBvbmVudC5fYWRkQ2hpbGRGcm9tQnVpbGRlcihjb21wbGV4UHJvcGVydHkubmFtZSwgZWxlbWVudE1vZHVsZS5jb21wb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyZW50Q29tcG9uZW50W2NvbXBsZXhQcm9wZXJ0eS5uYW1lXSA9IGVsZW1lbnRNb2R1bGUuY29tcG9uZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuaXNLbm93bkNvbGxlY3Rpb24gPSBmdW5jdGlvbiAobmFtZSwgY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIENvbXBvbmVudFBhcnNlci5LTk9XTkNPTExFQ1RJT05TIGluIGNvbnRleHQgJiYgY29udGV4dFtDb21wb25lbnRQYXJzZXIuS05PV05DT0xMRUNUSU9OU10gJiYgbmFtZSBpbiBjb250ZXh0W0NvbXBvbmVudFBhcnNlci5LTk9XTkNPTExFQ1RJT05TXTtcbiAgICAgICAgfTtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLktOT1dOQ09MTEVDVElPTlMgPSBcImtub3duQ29sbGVjdGlvbnNcIjtcbiAgICAgICAgQ29tcG9uZW50UGFyc2VyLktOT1dOVEVNUExBVEVTID0gXCJrbm93blRlbXBsYXRlc1wiO1xuICAgICAgICBDb21wb25lbnRQYXJzZXIuS05PV05NVUxUSVRFTVBMQVRFUyA9IFwia25vd25NdWx0aVRlbXBsYXRlc1wiO1xuICAgICAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICAgICAgXSwgQ29tcG9uZW50UGFyc2VyLnByb3RvdHlwZSwgXCJidWlsZENvbXBvbmVudFwiLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIENvbXBvbmVudFBhcnNlcjtcbiAgICB9KCkpO1xuICAgIHhtbDJ1aS5Db21wb25lbnRQYXJzZXIgPSBDb21wb25lbnRQYXJzZXI7XG59KSh4bWwydWkgfHwgKHhtbDJ1aSA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1idWlsZGVyLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBiaW5kYWJsZV8xID0gcmVxdWlyZShcIi4uLy4uL2NvcmUvYmluZGFibGVcIik7XG52YXIgYmluZGluZ19idWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vYmluZGluZy1idWlsZGVyXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBwbGF0Zm9ybSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMSA9IHJlcXVpcmUoXCIuLi9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG52YXIgbW9kdWxlX25hbWVfcmVzb2x2ZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9tb2R1bGUtbmFtZS1yZXNvbHZlclwiKTtcbnZhciBVSV9QQVRIID0gXCJ1aS9cIjtcbnZhciBNT0RVTEVTID0ge1xuICAgIFwiVGFiVmlld0l0ZW1cIjogXCJ1aS90YWItdmlld1wiLFxuICAgIFwiVGFiU3RyaXBcIjogXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1zdHJpcFwiLFxuICAgIFwiVGFiU3RyaXBJdGVtXCI6IFwidWkvdGFiLW5hdmlnYXRpb24tYmFzZS90YWItc3RyaXAtaXRlbVwiLFxuICAgIFwiVGFiQ29udGVudEl0ZW1cIjogXCJ1aS90YWItbmF2aWdhdGlvbi1iYXNlL3RhYi1jb250ZW50LWl0ZW1cIixcbiAgICBcIkZvcm1hdHRlZFN0cmluZ1wiOiBcInRleHQvZm9ybWF0dGVkLXN0cmluZ1wiLFxuICAgIFwiU3BhblwiOiBcInRleHQvc3BhblwiLFxuICAgIFwiQWN0aW9uSXRlbVwiOiBcInVpL2FjdGlvbi1iYXJcIixcbiAgICBcIk5hdmlnYXRpb25CdXR0b25cIjogXCJ1aS9hY3Rpb24tYmFyXCIsXG4gICAgXCJTZWdtZW50ZWRCYXJJdGVtXCI6IFwidWkvc2VnbWVudGVkLWJhclwiLFxufTtcbnZhciBDT0RFX0ZJTEUgPSBcImNvZGVGaWxlXCI7XG52YXIgQ1NTX0ZJTEUgPSBcImNzc0ZpbGVcIjtcbnZhciBJTVBPUlQgPSBcImltcG9ydFwiO1xudmFyIGNyZWF0ZUNvbXBvbmVudEluc3RhbmNlID0gcHJvZmlsaW5nXzEucHJvZmlsZShcImNyZWF0ZUNvbXBvbmVudEluc3RhbmNlXCIsIGZ1bmN0aW9uIChlbGVtZW50TmFtZSwgbmFtZXNwYWNlKSB7XG4gICAgdmFyIGluc3RhbmNlO1xuICAgIHZhciBpbnN0YW5jZU1vZHVsZTtcbiAgICB2YXIgcmVzb2x2ZWRNb2R1bGVOYW1lO1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgbmFtZXNwYWNlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICByZXNvbHZlZE1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG5hbWVzcGFjZSwgXCJcIik7XG4gICAgICAgICAgICBpbnN0YW5jZU1vZHVsZSA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkTW9kdWxlTmFtZSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXNvbHZlZE1vZHVsZU5hbWUgPSBNT0RVTEVTW2VsZW1lbnROYW1lXSB8fCBVSV9QQVRIICtcbiAgICAgICAgICAgICAgICAoZWxlbWVudE5hbWUudG9Mb3dlckNhc2UoKS5pbmRleE9mKFwibGF5b3V0XCIpICE9PSAtMSA/IFwibGF5b3V0cy9cIiA6IFwiXCIpICtcbiAgICAgICAgICAgICAgICBlbGVtZW50TmFtZS5zcGxpdCgvKD89W0EtWl0pLykuam9pbihcIi1cIikudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGluc3RhbmNlTW9kdWxlID0gZ2xvYmFsLmxvYWRNb2R1bGUocmVzb2x2ZWRNb2R1bGVOYW1lLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluc3RhbmNlVHlwZSA9IGluc3RhbmNlTW9kdWxlW2VsZW1lbnROYW1lXSB8fCBPYmplY3Q7XG4gICAgICAgIGluc3RhbmNlID0gbmV3IGluc3RhbmNlVHlwZSgpO1xuICAgIH1cbiAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgdmFyIGRlYnVnID0gcmVxdWlyZShcInV0aWxzL2RlYnVnXCIpO1xuICAgICAgICB0aHJvdyBuZXcgZGVidWcuU2NvcGVFcnJvcihleCwgXCJNb2R1bGUgJ1wiICsgcmVzb2x2ZWRNb2R1bGVOYW1lICsgXCInIG5vdCBmb3VuZCBmb3IgZWxlbWVudCAnXCIgKyAobmFtZXNwYWNlID8gbmFtZXNwYWNlICsgXCI6XCIgOiBcIlwiKSArIGVsZW1lbnROYW1lICsgXCInLlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgaW5zdGFuY2U6IGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZTogaW5zdGFuY2VNb2R1bGUgfTtcbn0pO1xudmFyIGdldENvbXBvbmVudE1vZHVsZUV4cG9ydHMgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiZ2V0Q29tcG9uZW50TW9kdWxlRXhwb3J0c1wiLCBmdW5jdGlvbiAoaW5zdGFuY2UsIG1vZHVsZUV4cG9ydHMsIGF0dHJpYnV0ZXMpIHtcbiAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICB2YXIgY29kZUZpbGVBdHRyaWJ1dGUgPSBhdHRyaWJ1dGVzW0NPREVfRklMRV0gfHwgYXR0cmlidXRlc1tJTVBPUlRdO1xuICAgICAgICBpZiAoY29kZUZpbGVBdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgIHZhciByZXNvbHZlZENvZGVGaWxlTW9kdWxlID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUoY29kZUZpbGVBdHRyaWJ1dGUpLCBcIlwiKTtcbiAgICAgICAgICAgIGlmIChyZXNvbHZlZENvZGVGaWxlTW9kdWxlKSB7XG4gICAgICAgICAgICAgICAgbW9kdWxlRXhwb3J0cyA9IGdsb2JhbC5sb2FkTW9kdWxlKHJlc29sdmVkQ29kZUZpbGVNb2R1bGUsIHRydWUpO1xuICAgICAgICAgICAgICAgIGluc3RhbmNlLmV4cG9ydHMgPSBtb2R1bGVFeHBvcnRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ29kZSBmaWxlIHdpdGggcGF0aCBcXFwiXCIgKyBjb2RlRmlsZUF0dHJpYnV0ZSArIFwiXFxcIiBjYW5ub3QgYmUgZm91bmQhIExvb2tpbmcgZm9yIHdlYnBhY2sgbW9kdWxlIHdpdGggbmFtZSBcXFwiXCIgKyByZXNvbHZlZENvZGVGaWxlTW9kdWxlICsgXCJcXFwiXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtb2R1bGVFeHBvcnRzO1xufSk7XG52YXIgYXBwbHlDb21wb25lbnRDc3MgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiYXBwbHlDb21wb25lbnRDc3NcIiwgZnVuY3Rpb24gKGluc3RhbmNlLCBtb2R1bGVOYW1lLCBhdHRyaWJ1dGVzKSB7XG4gICAgdmFyIGNzc0FwcGxpZWQgPSBmYWxzZTtcbiAgICBpZiAoYXR0cmlidXRlcyAmJiBhdHRyaWJ1dGVzW0NTU19GSUxFXSkge1xuICAgICAgICB2YXIgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lID0gbW9kdWxlX25hbWVfcmVzb2x2ZXJfMS5yZXNvbHZlTW9kdWxlTmFtZShtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUoYXR0cmlidXRlc1tDU1NfRklMRV0pLCBcImNzc1wiKTtcbiAgICAgICAgaWYgKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSkge1xuICAgICAgICAgICAgaW5zdGFuY2UuYWRkQ3NzRmlsZShyZXNvbHZlZENzc01vZHVsZU5hbWUpO1xuICAgICAgICAgICAgY3NzQXBwbGllZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDc3MgZmlsZSB3aXRoIHBhdGggXFxcIlwiICsgYXR0cmlidXRlc1tDU1NfRklMRV0gKyBcIlxcXCIgY2Fubm90IGJlIGZvdW5kISBMb29raW5nIGZvciB3ZWJwYWNrIG1vZHVsZSB3aXRoIG5hbWUgXFxcIlwiICsgcmVzb2x2ZWRDc3NNb2R1bGVOYW1lICsgXCJcXFwiXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChtb2R1bGVOYW1lICYmICFjc3NBcHBsaWVkKSB7XG4gICAgICAgIHZhciByZXNvbHZlZENzc01vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9yZXNvbHZlcl8xLnJlc29sdmVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIFwiY3NzXCIpO1xuICAgICAgICBpZiAocmVzb2x2ZWRDc3NNb2R1bGVOYW1lKSB7XG4gICAgICAgICAgICBpbnN0YW5jZS5hZGRDc3NGaWxlKHJlc29sdmVkQ3NzTW9kdWxlTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbnZhciBhcHBseUNvbXBvbmVudEF0dHJpYnV0ZXMgPSBwcm9maWxpbmdfMS5wcm9maWxlKFwiYXBwbHlDb21wb25lbnRBdHRyaWJ1dGVzXCIsIGZ1bmN0aW9uIChpbnN0YW5jZSwgaW5zdGFuY2VNb2R1bGUsIG1vZHVsZUV4cG9ydHMsIGF0dHJpYnV0ZXMpIHtcbiAgICBpZiAoaW5zdGFuY2UgJiYgaW5zdGFuY2VNb2R1bGUpIHtcbiAgICAgICAgZm9yICh2YXIgYXR0ciBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICB2YXIgYXR0clZhbHVlID0gYXR0cmlidXRlc1thdHRyXTtcbiAgICAgICAgICAgIGlmIChhdHRyLmluZGV4T2YoXCI6XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBwbGF0Zm9ybU5hbWUgPSBhdHRyLnNwbGl0KFwiOlwiKVswXS50cmltKCk7XG4gICAgICAgICAgICAgICAgaWYgKHBsYXRmb3JtTmFtZS50b0xvd2VyQ2FzZSgpID09PSBwbGF0Zm9ybS5kZXZpY2Uub3MudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgICAgICAgICBhdHRyID0gYXR0ci5zcGxpdChcIjpcIilbMV0udHJpbSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0dHIuaW5kZXhPZihcIi5cIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1Yk9iaiA9IGluc3RhbmNlO1xuICAgICAgICAgICAgICAgIHZhciBwcm9wZXJ0aWVzID0gYXR0ci5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgdmFyIHN1YlByb3BOYW1lID0gcHJvcGVydGllc1twcm9wZXJ0aWVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcGVydGllcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Yk9iaiAhPT0gdW5kZWZpbmVkICYmIHN1Yk9iaiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3ViT2JqID0gc3ViT2JqW3Byb3BlcnRpZXNbaV1dO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzdWJPYmogIT09IHVuZGVmaW5lZCAmJiBzdWJPYmogIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0UHJvcGVydHlWYWx1ZShzdWJPYmosIGluc3RhbmNlTW9kdWxlLCBtb2R1bGVFeHBvcnRzLCBzdWJQcm9wTmFtZSwgYXR0clZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZXRQcm9wZXJ0eVZhbHVlKGluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSwgbW9kdWxlRXhwb3J0cywgYXR0ciwgYXR0clZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pO1xuZnVuY3Rpb24gZ2V0Q29tcG9uZW50TW9kdWxlKGVsZW1lbnROYW1lLCBuYW1lc3BhY2UsIGF0dHJpYnV0ZXMsIG1vZHVsZUV4cG9ydHMsIG1vZHVsZU5hbWVQYXRoLCBpc1Jvb3RDb21wb25lbnQpIHtcbiAgICBlbGVtZW50TmFtZSA9IGVsZW1lbnROYW1lLnNwbGl0KFwiLVwiKS5tYXAoZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHNbMF0udG9VcHBlckNhc2UoKSArIHMuc3Vic3RyaW5nKDEpOyB9KS5qb2luKFwiXCIpO1xuICAgIHZhciBfYSA9IGNyZWF0ZUNvbXBvbmVudEluc3RhbmNlKGVsZW1lbnROYW1lLCBuYW1lc3BhY2UpLCBpbnN0YW5jZSA9IF9hLmluc3RhbmNlLCBpbnN0YW5jZU1vZHVsZSA9IF9hLmluc3RhbmNlTW9kdWxlO1xuICAgIG1vZHVsZUV4cG9ydHMgPSBnZXRDb21wb25lbnRNb2R1bGVFeHBvcnRzKGluc3RhbmNlLCBtb2R1bGVFeHBvcnRzLCBhdHRyaWJ1dGVzKTtcbiAgICBpZiAoaXNSb290Q29tcG9uZW50KSB7XG4gICAgICAgIGFwcGx5Q29tcG9uZW50Q3NzKGluc3RhbmNlLCBtb2R1bGVOYW1lUGF0aCwgYXR0cmlidXRlcyk7XG4gICAgfVxuICAgIGFwcGx5Q29tcG9uZW50QXR0cmlidXRlcyhpbnN0YW5jZSwgaW5zdGFuY2VNb2R1bGUsIG1vZHVsZUV4cG9ydHMsIGF0dHJpYnV0ZXMpO1xuICAgIHZhciBjb21wb25lbnRNb2R1bGU7XG4gICAgaWYgKGluc3RhbmNlICYmIGluc3RhbmNlTW9kdWxlKSB7XG4gICAgICAgIGNvbXBvbmVudE1vZHVsZSA9IHsgY29tcG9uZW50OiBpbnN0YW5jZSwgZXhwb3J0czogaW5zdGFuY2VNb2R1bGUgfTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbXBvbmVudE1vZHVsZTtcbn1cbmV4cG9ydHMuZ2V0Q29tcG9uZW50TW9kdWxlID0gZ2V0Q29tcG9uZW50TW9kdWxlO1xuZnVuY3Rpb24gc2V0UHJvcGVydHlWYWx1ZShpbnN0YW5jZSwgaW5zdGFuY2VNb2R1bGUsIGV4cG9ydHMsIHByb3BlcnR5TmFtZSwgcHJvcGVydHlWYWx1ZSkge1xuICAgIGlmIChpc0JpbmRpbmcocHJvcGVydHlWYWx1ZSkgJiYgaW5zdGFuY2UuYmluZCkge1xuICAgICAgICB2YXIgYmluZE9wdGlvbnMgPSBiaW5kaW5nX2J1aWxkZXJfMS5nZXRCaW5kaW5nT3B0aW9ucyhwcm9wZXJ0eU5hbWUsIGdldEJpbmRpbmdFeHByZXNzaW9uRnJvbUF0dHJpYnV0ZShwcm9wZXJ0eVZhbHVlKSk7XG4gICAgICAgIGluc3RhbmNlLmJpbmQoe1xuICAgICAgICAgICAgc291cmNlUHJvcGVydHk6IGJpbmRPcHRpb25zW2JpbmRpbmdfYnVpbGRlcl8xLmJpbmRpbmdDb25zdGFudHMuc291cmNlUHJvcGVydHldLFxuICAgICAgICAgICAgdGFyZ2V0UHJvcGVydHk6IGJpbmRPcHRpb25zW2JpbmRpbmdfYnVpbGRlcl8xLmJpbmRpbmdDb25zdGFudHMudGFyZ2V0UHJvcGVydHldLFxuICAgICAgICAgICAgZXhwcmVzc2lvbjogYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy5leHByZXNzaW9uXSxcbiAgICAgICAgICAgIHR3b1dheTogYmluZE9wdGlvbnNbYmluZGluZ19idWlsZGVyXzEuYmluZGluZ0NvbnN0YW50cy50d29XYXldXG4gICAgICAgIH0sIGJpbmRPcHRpb25zW2JpbmRpbmdfYnVpbGRlcl8xLmJpbmRpbmdDb25zdGFudHMuc291cmNlXSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGJpbmRhYmxlXzEuaXNFdmVudE9yR2VzdHVyZShwcm9wZXJ0eU5hbWUsIGluc3RhbmNlKSkge1xuICAgICAgICB2YXIgaGFuZGxlciA9IGV4cG9ydHMgJiYgZXhwb3J0c1twcm9wZXJ0eVZhbHVlXTtcbiAgICAgICAgaWYgKHR5cGVvZiBoYW5kbGVyID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIGluc3RhbmNlLm9uKHByb3BlcnR5TmFtZSwgaGFuZGxlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoaXNLbm93bkZ1bmN0aW9uKHByb3BlcnR5TmFtZSwgaW5zdGFuY2UpICYmIGV4cG9ydHMgJiYgdHlwZW9mIGV4cG9ydHNbcHJvcGVydHlWYWx1ZV0gPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBpbnN0YW5jZVtwcm9wZXJ0eU5hbWVdID0gZXhwb3J0c1twcm9wZXJ0eVZhbHVlXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGluc3RhbmNlW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eVZhbHVlO1xuICAgIH1cbn1cbmV4cG9ydHMuc2V0UHJvcGVydHlWYWx1ZSA9IHNldFByb3BlcnR5VmFsdWU7XG5mdW5jdGlvbiBnZXRCaW5kaW5nRXhwcmVzc2lvbkZyb21BdHRyaWJ1dGUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUucmVwbGFjZShcInt7XCIsIFwiXCIpLnJlcGxhY2UoXCJ9fVwiLCBcIlwiKS50cmltKCk7XG59XG5mdW5jdGlvbiBpc0JpbmRpbmcodmFsdWUpIHtcbiAgICB2YXIgaXNCaW5kaW5nO1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIHN0ciA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgaXNCaW5kaW5nID0gc3RyLmluZGV4T2YoXCJ7e1wiKSA9PT0gMCAmJiBzdHIubGFzdEluZGV4T2YoXCJ9fVwiKSA9PT0gc3RyLmxlbmd0aCAtIDI7XG4gICAgfVxuICAgIHJldHVybiBpc0JpbmRpbmc7XG59XG52YXIgS05PV05fRlVOQ1RJT05TID0gXCJrbm93bkZ1bmN0aW9uc1wiO1xuZnVuY3Rpb24gaXNLbm93bkZ1bmN0aW9uKG5hbWUsIGluc3RhbmNlKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLmNvbnN0cnVjdG9yXG4gICAgICAgICYmIEtOT1dOX0ZVTkNUSU9OUyBpbiBpbnN0YW5jZS5jb25zdHJ1Y3RvclxuICAgICAgICAmJiBpbnN0YW5jZS5jb25zdHJ1Y3RvcltLTk9XTl9GVU5DVElPTlNdLmluZGV4T2YobmFtZSkgIT09IC0xO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29tcG9uZW50LWJ1aWxkZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gc2FuaXRpemVNb2R1bGVOYW1lKG1vZHVsZU5hbWUsIHJlbW92ZUV4dGVuc2lvbikge1xuICAgIGlmIChyZW1vdmVFeHRlbnNpb24gPT09IHZvaWQgMCkgeyByZW1vdmVFeHRlbnNpb24gPSB0cnVlOyB9XG4gICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUudHJpbSgpO1xuICAgIGlmIChtb2R1bGVOYW1lLnN0YXJ0c1dpdGgoXCJ+L1wiKSkge1xuICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlTmFtZS5zdWJzdHJpbmcoMik7XG4gICAgfVxuICAgIGVsc2UgaWYgKG1vZHVsZU5hbWUuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICBpZiAocmVtb3ZlRXh0ZW5zaW9uKSB7XG4gICAgICAgIHZhciBsYXN0RG90ID0gbW9kdWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIik7XG4gICAgICAgIGlmIChsYXN0RG90ID4gMCkge1xuICAgICAgICAgICAgbW9kdWxlTmFtZSA9IG1vZHVsZU5hbWUuc3Vic3RyKDAsIGxhc3REb3QpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtb2R1bGVOYW1lO1xufVxuZXhwb3J0cy5zYW5pdGl6ZU1vZHVsZU5hbWUgPSBzYW5pdGl6ZU1vZHVsZU5hbWU7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2R1bGUtbmFtZS1zYW5pdGl6ZXIuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0ZXh0X2Jhc2VfMSA9IHJlcXVpcmUoXCIuLi90ZXh0LWJhc2VcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpKTtcbnZhciBCdXR0b25CYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQnV0dG9uQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCdXR0b25CYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShCdXR0b25CYXNlLnByb3RvdHlwZSwgXCJ0ZXh0V3JhcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9PT0gXCJub3JtYWxcIjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdHlsZS53aGl0ZVNwYWNlID0gdmFsdWUgPyBcIm5vcm1hbFwiIDogXCJub3dyYXBcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQnV0dG9uQmFzZS50YXBFdmVudCA9IFwidGFwXCI7XG4gICAgQnV0dG9uQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB0ZXh0X2Jhc2VfMS5DU1NUeXBlKFwiQnV0dG9uXCIpXG4gICAgXSwgQnV0dG9uQmFzZSk7XG4gICAgcmV0dXJuIEJ1dHRvbkJhc2U7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkJ1dHRvbkJhc2UgPSBCdXR0b25CYXNlO1xuQnV0dG9uQmFzZS5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1dHRvbi1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBjb250cm9sX3N0YXRlX2NoYW5nZV8xID0gcmVxdWlyZShcIi4uL2NvcmUvY29udHJvbC1zdGF0ZS1jaGFuZ2VcIik7XG52YXIgYnV0dG9uX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vYnV0dG9uLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2J1dHRvbi1jb21tb25cIikpO1xudmFyIEJ1dHRvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCdXR0b24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQnV0dG9uLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gVUlCdXR0b24uYnV0dG9uV2l0aFR5cGUoMSk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLmluaXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmluaXROYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB0aGlzLl90YXBIYW5kbGVyID0gVGFwSGFuZGxlckltcGwuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgICAgIG5hdGl2ZVZpZXcuYWRkVGFyZ2V0QWN0aW9uRm9yQ29udHJvbEV2ZW50cyh0aGlzLl90YXBIYW5kbGVyLCBcInRhcFwiLCA2NCk7XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl90YXBIYW5kbGVyID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEJ1dHRvbi5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBCdXR0b24ucHJvdG90eXBlLm9uVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25VbmxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5fc3RhdGVDaGFuZ2VkSGFuZGxlcikge1xuICAgICAgICAgICAgdGhpcy5fc3RhdGVDaGFuZ2VkSGFuZGxlci5zdG9wKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGUuX3VwZGF0ZUJ1dHRvblN0YXRlQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uIChzdWJzY3JpYmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHN1YnNjcmliZSkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9zdGF0ZUNoYW5nZWRIYW5kbGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGVDaGFuZ2VkSGFuZGxlciA9IG5ldyBjb250cm9sX3N0YXRlX2NoYW5nZV8xLkNvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2dvVG9WaXN1YWxTdGF0ZShzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3N0YXRlQ2hhbmdlZEhhbmRsZXIuc3RhcnQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlQ2hhbmdlZEhhbmRsZXIuc3RvcCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5ib3JkZXJUb3BXaWR0aFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy50b3AsXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLmJvcmRlclRvcFdpZHRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciB0b3AgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiB0b3AsIGxlZnQ6IGluc2V0LmxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMucmlnaHQsXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBpbnNldCA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cztcbiAgICAgICAgdmFyIHJpZ2h0ID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzID0geyB0b3A6IGluc2V0LnRvcCwgbGVmdDogaW5zZXQubGVmdCwgYm90dG9tOiBpbnNldC5ib3R0b20sIHJpZ2h0OiByaWdodCB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMuYm90dG9tLFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGluc2V0ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzO1xuICAgICAgICB2YXIgYm90dG9tID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSArIHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGgpO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMgPSB7IHRvcDogaW5zZXQudG9wLCBsZWZ0OiBpbnNldC5sZWZ0LCBib3R0b206IGJvdHRvbSwgcmlnaHQ6IGluc2V0LnJpZ2h0IH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMubGVmdCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciBsZWZ0ID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiBpbnNldC50b3AsIGxlZnQ6IGxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdUb3BQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMudG9wLFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciB0b3AgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nVG9wICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiB0b3AsIGxlZnQ6IGluc2V0LmxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdmFsdWU6IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cy5yaWdodCxcbiAgICAgICAgICAgIHVuaXQ6IFwicHhcIlxuICAgICAgICB9O1xuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZVtidXR0b25fY29tbW9uXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciByaWdodCA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyUmlnaHRXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiBpbnNldC50b3AsIGxlZnQ6IGluc2V0LmxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogcmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHZhbHVlOiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHMuYm90dG9tLFxuICAgICAgICAgICAgdW5pdDogXCJweFwiXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBCdXR0b24ucHJvdG90eXBlW2J1dHRvbl9jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciBib3R0b20gPSBidXR0b25fY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiBpbnNldC50b3AsIGxlZnQ6IGluc2V0LmxlZnQsIGJvdHRvbTogYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRFZGdlSW5zZXRzLmxlZnQsXG4gICAgICAgICAgICB1bml0OiBcInB4XCJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgaW5zZXQgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udGVudEVkZ2VJbnNldHM7XG4gICAgICAgIHZhciBsZWZ0ID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50RWRnZUluc2V0cyA9IHsgdG9wOiBpbnNldC50b3AsIGxlZnQ6IGxlZnQsIGJvdHRvbTogaW5zZXQuYm90dG9tLCByaWdodDogaW5zZXQucmlnaHQgfTtcbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRpdGxlTGFiZWwudGV4dEFsaWdubWVudCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRIb3Jpem9udGFsQWxpZ25tZW50ID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJpbml0aWFsXCI6XG4gICAgICAgICAgICBjYXNlIFwiY2VudGVyXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRpdGxlTGFiZWwudGV4dEFsaWdubWVudCA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnRlbnRIb3Jpem9udGFsQWxpZ25tZW50ID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC50aXRsZUxhYmVsLnRleHRBbGlnbm1lbnQgPSAyO1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5jb250ZW50SG9yaXpvbnRhbEFsaWdubWVudCA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJ1dHRvbi5wcm90b3R5cGVbYnV0dG9uX2NvbW1vbl8xLndoaXRlU3BhY2VQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRpdGxlTGFiZWw7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJub3JtYWxcIjpcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmxpbmVCcmVha01vZGUgPSAwO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubnVtYmVyT2ZMaW5lcyA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm93cmFwXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW5pdGlhbFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubGluZUJyZWFrTW9kZSA9IDU7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5udW1iZXJPZkxpbmVzID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgQnV0dG9uLnByb3RvdHlwZS5vbk1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgaWYgKCF0aGlzLnRleHRXcmFwKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5vbk1lYXN1cmUuY2FsbCh0aGlzLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBidXR0b25fY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciB3aWR0aE1vZGUgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSBidXR0b25fY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBob3Jpem9udGFsUGFkZGluZyA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ICsgdGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoO1xuICAgICAgICAgICAgdmFyIHZlcnRpY2FsUGFkZGluZyA9IHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCArIHRoaXMuZWZmZWN0aXZlQm9yZGVyVG9wV2lkdGggKyB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gKyB0aGlzLmVmZmVjdGl2ZUJvcmRlckJvdHRvbVdpZHRoO1xuICAgICAgICAgICAgaWYgKHZlcnRpY2FsUGFkZGluZyA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHZlcnRpY2FsUGFkZGluZyA9IGJ1dHRvbl9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoMTIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlc2lyZWRTaXplID0gYnV0dG9uX2NvbW1vbl8xLmxheW91dC5tZWFzdXJlTmF0aXZlVmlldyhuYXRpdmVWaWV3LnRpdGxlTGFiZWwsIHdpZHRoIC0gaG9yaXpvbnRhbFBhZGRpbmcsIHdpZHRoTW9kZSwgaGVpZ2h0IC0gdmVydGljYWxQYWRkaW5nLCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIGRlc2lyZWRTaXplLndpZHRoID0gZGVzaXJlZFNpemUud2lkdGggKyBob3Jpem9udGFsUGFkZGluZztcbiAgICAgICAgICAgIGRlc2lyZWRTaXplLmhlaWdodCA9IGRlc2lyZWRTaXplLmhlaWdodCArIHZlcnRpY2FsUGFkZGluZztcbiAgICAgICAgICAgIHZhciBtZWFzdXJlV2lkdGggPSBNYXRoLm1heChkZXNpcmVkU2l6ZS53aWR0aCwgdGhpcy5lZmZlY3RpdmVNaW5XaWR0aCk7XG4gICAgICAgICAgICB2YXIgbWVhc3VyZUhlaWdodCA9IE1hdGgubWF4KGRlc2lyZWRTaXplLmhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBidXR0b25fY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVXaWR0aCwgd2lkdGgsIHdpZHRoTW9kZSwgMCk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0QW5kU3RhdGUgPSBidXR0b25fY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVIZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgICAgICB0aGlzLnNldE1lYXN1cmVkRGltZW5zaW9uKHdpZHRoQW5kU3RhdGUsIGhlaWdodEFuZFN0YXRlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIGJ1dHRvbl9jb21tb25fMS5Qc2V1ZG9DbGFzc0hhbmRsZXIoXCJub3JtYWxcIiwgXCJoaWdobGlnaHRlZFwiLCBcInByZXNzZWRcIiwgXCJhY3RpdmVcIilcbiAgICBdLCBCdXR0b24ucHJvdG90eXBlLCBcIl91cGRhdGVCdXR0b25TdGF0ZUNoYW5nZUhhbmRsZXJcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEJ1dHRvbjtcbn0oYnV0dG9uX2NvbW1vbl8xLkJ1dHRvbkJhc2UpKTtcbmV4cG9ydHMuQnV0dG9uID0gQnV0dG9uO1xudmFyIFRhcEhhbmRsZXJJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVGFwSGFuZGxlckltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGFwSGFuZGxlckltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVGFwSGFuZGxlckltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgaGFuZGxlciA9IFRhcEhhbmRsZXJJbXBsLm5ldygpO1xuICAgICAgICBoYW5kbGVyLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gaGFuZGxlcjtcbiAgICB9O1xuICAgIFRhcEhhbmRsZXJJbXBsLnByb3RvdHlwZS50YXAgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBvd25lci5fZW1pdChidXR0b25fY29tbW9uXzEuQnV0dG9uQmFzZS50YXBFdmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhcEhhbmRsZXJJbXBsLk9iakNFeHBvc2VkTWV0aG9kcyA9IHtcbiAgICAgICAgXCJ0YXBcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW2ludGVyb3AudHlwZXMuaWRdIH1cbiAgICB9O1xuICAgIHJldHVybiBUYXBIYW5kbGVySW1wbDtcbn0oTlNPYmplY3QpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJ1dHRvbi5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9wcm9wZXJ0aWVzXCIpO1xudmFyIG9ic2VydmFibGVfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9kYXRhL29ic2VydmFibGVcIik7XG5leHBvcnRzLk9ic2VydmFibGUgPSBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZTtcbmV4cG9ydHMuV3JhcHBlZFZhbHVlID0gb2JzZXJ2YWJsZV8xLldyYXBwZWRWYWx1ZTtcbnZhciB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEgPSByZXF1aXJlKFwiLi4vd2Vhay1ldmVudC1saXN0ZW5lclwiKTtcbnZhciBiaW5kaW5nX2J1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9idWlsZGVyL2JpbmRpbmctYnVpbGRlclwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdHJhY2VcIik7XG5leHBvcnRzLnRyYWNlRW5hYmxlZCA9IHRyYWNlXzEuaXNFbmFibGVkO1xuZXhwb3J0cy50cmFjZVdyaXRlID0gdHJhY2VfMS53cml0ZTtcbmV4cG9ydHMudHJhY2VFcnJvciA9IHRyYWNlXzEuZXJyb3I7XG5leHBvcnRzLnRyYWNlQ2F0ZWdvcmllcyA9IHRyYWNlXzEuY2F0ZWdvcmllcztcbmV4cG9ydHMudHJhY2VOb3RpZnlFdmVudCA9IHRyYWNlXzEubm90aWZ5RXZlbnQ7XG5leHBvcnRzLmlzQ2F0ZWdvcnlTZXQgPSB0cmFjZV8xLmlzQ2F0ZWdvcnlTZXQ7XG5leHBvcnRzLnRyYWNlTWVzc2FnZVR5cGUgPSB0cmFjZV8xLm1lc3NhZ2VUeXBlO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4uLy4uLy4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIGFwcGxpY2F0aW9uQ29tbW9uID0gcmVxdWlyZShcIi4uLy4uLy4uL2FwcGxpY2F0aW9uL2FwcGxpY2F0aW9uLWNvbW1vblwiKTtcbnZhciBwb2x5bWVyRXhwcmVzc2lvbnMgPSByZXF1aXJlKFwiLi4vLi4vLi4vanMtbGlicy9wb2x5bWVyLWV4cHJlc3Npb25zXCIpO1xudmFyIGNvbnRleHRLZXkgPSBcImNvbnRleHRcIjtcbnZhciBwYXJhbXNSZWdleCA9IC9cXFtcXHMqKFsnXCJdKSooXFx3KilcXDFcXHMqXFxdLztcbnZhciBiYyA9IGJpbmRpbmdfYnVpbGRlcl8xLmJpbmRpbmdDb25zdGFudHM7XG52YXIgZW1wdHlBcnJheSA9IFtdO1xudmFyIHByb3BlcnRpZXNDYWNoZSA9IHt9O1xuZnVuY3Rpb24gZ2V0UHJvcGVydGllcyhwcm9wZXJ0eSkge1xuICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgcmV0dXJuIGVtcHR5QXJyYXk7XG4gICAgfVxuICAgIHZhciByZXN1bHQgPSBwcm9wZXJ0aWVzQ2FjaGVbcHJvcGVydHldO1xuICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdmFyIHBhcmVudHNNYXRjaGVzID0gcHJvcGVydHkubWF0Y2goYmluZGluZ19idWlsZGVyXzEucGFyZW50c1JlZ2V4KTtcbiAgICByZXN1bHQgPSBwcm9wZXJ0eS5yZXBsYWNlKGJpbmRpbmdfYnVpbGRlcl8xLnBhcmVudHNSZWdleCwgXCJwYXJlbnRzTWF0Y2hcIilcbiAgICAgICAgLnJlcGxhY2UoL1xcXS9nLCBcIlwiKVxuICAgICAgICAuc3BsaXQoL1xcLnxcXFsvKTtcbiAgICB2YXIgcGFyZW50c01hdGNoZXNDb3VudGVyID0gMDtcbiAgICBmb3IgKHZhciBpID0gMCwgcmVzdWx0TGVuZ3RoID0gcmVzdWx0Lmxlbmd0aDsgaSA8IHJlc3VsdExlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChyZXN1bHRbaV0gPT09IFwicGFyZW50c01hdGNoXCIpIHtcbiAgICAgICAgICAgIHJlc3VsdFtpXSA9IHBhcmVudHNNYXRjaGVzW3BhcmVudHNNYXRjaGVzQ291bnRlcisrXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcm9wZXJ0aWVzQ2FjaGVbcHJvcGVydHldID0gcmVzdWx0O1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBnZXRFdmVudE9yR2VzdHVyZU5hbWUobmFtZSkge1xuICAgIHJldHVybiBuYW1lLmluZGV4T2YoXCJvblwiKSA9PT0gMCA/IG5hbWUuc3Vic3RyKDIsIG5hbWUubGVuZ3RoIC0gMikgOiBuYW1lO1xufVxuZXhwb3J0cy5nZXRFdmVudE9yR2VzdHVyZU5hbWUgPSBnZXRFdmVudE9yR2VzdHVyZU5hbWU7XG5mdW5jdGlvbiBpc0dlc3R1cmUoZXZlbnRPckdlc3R1cmVOYW1lKSB7XG4gICAgdmFyIHQgPSBldmVudE9yR2VzdHVyZU5hbWUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIHQgPT09IFwidGFwXCJcbiAgICAgICAgfHwgdCA9PT0gXCJkb3VibGV0YXBcIlxuICAgICAgICB8fCB0ID09PSBcInBpbmNoXCJcbiAgICAgICAgfHwgdCA9PT0gXCJwYW5cIlxuICAgICAgICB8fCB0ID09PSBcInN3aXBlXCJcbiAgICAgICAgfHwgdCA9PT0gXCJyb3RhdGlvblwiXG4gICAgICAgIHx8IHQgPT09IFwibG9uZ3ByZXNzXCJcbiAgICAgICAgfHwgdCA9PT0gXCJ0b3VjaFwiO1xufVxuZXhwb3J0cy5pc0dlc3R1cmUgPSBpc0dlc3R1cmU7XG5mdW5jdGlvbiBpc0V2ZW50T3JHZXN0dXJlKG5hbWUsIHZpZXcpIHtcbiAgICBpZiAodHlwZW9mIG5hbWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIGV2ZW50T3JHZXN0dXJlTmFtZSA9IGdldEV2ZW50T3JHZXN0dXJlTmFtZShuYW1lKTtcbiAgICAgICAgdmFyIGV2dCA9IGV2ZW50T3JHZXN0dXJlTmFtZSArIFwiRXZlbnRcIjtcbiAgICAgICAgcmV0dXJuIHZpZXcuY29uc3RydWN0b3IgJiYgZXZ0IGluIHZpZXcuY29uc3RydWN0b3IgfHwgaXNHZXN0dXJlKGV2ZW50T3JHZXN0dXJlTmFtZS50b0xvd2VyQ2FzZSgpKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZXhwb3J0cy5pc0V2ZW50T3JHZXN0dXJlID0gaXNFdmVudE9yR2VzdHVyZTtcbnZhciBCaW5kaW5nID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCaW5kaW5nKHRhcmdldCwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzID0gbmV3IE1hcCgpO1xuICAgICAgICB0aGlzLnRhcmdldCA9IG5ldyBXZWFrUmVmKHRhcmdldCk7XG4gICAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMuc291cmNlUHJvcGVydGllcyA9IGdldFByb3BlcnRpZXMob3B0aW9ucy5zb3VyY2VQcm9wZXJ0eSk7XG4gICAgICAgIHRoaXMudGFyZ2V0T3B0aW9ucyA9IHRoaXMucmVzb2x2ZU9wdGlvbnModGFyZ2V0LCBnZXRQcm9wZXJ0aWVzKG9wdGlvbnMudGFyZ2V0UHJvcGVydHkpKTtcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldE9wdGlvbnMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgcHJvcGVydHk6IFwiICsgb3B0aW9ucy50YXJnZXRQcm9wZXJ0eSArIFwiIGZvciB0YXJnZXQ6IFwiICsgdGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3B0aW9ucy50d29XYXkpIHtcbiAgICAgICAgICAgIHZhciB0YXJnZXRfMSA9IHRoaXMudGFyZ2V0T3B0aW9ucy5pbnN0YW5jZS5nZXQoKTtcbiAgICAgICAgICAgIGlmICh0YXJnZXRfMSBpbnN0YW5jZW9mIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0XzEub24odGhpcy50YXJnZXRPcHRpb25zLnByb3BlcnR5ICsgXCJDaGFuZ2VcIiwgdGhpcy5vblRhcmdldFByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgQmluZGluZy5wcm90b3R5cGUub25UYXJnZXRQcm9wZXJ0eUNoYW5nZWQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB0aGlzLnVwZGF0ZVR3b1dheShkYXRhLnZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmxvYWRlZEhhbmRsZXJWaXN1YWxUcmVlQmluZGluZyA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSBhcmdzLm9iamVjdDtcbiAgICAgICAgdGFyZ2V0Lm9mZihcImxvYWRlZFwiLCB0aGlzLmxvYWRlZEhhbmRsZXJWaXN1YWxUcmVlQmluZGluZywgdGhpcyk7XG4gICAgICAgIHZhciBjb250ZXh0ID0gdGFyZ2V0LmJpbmRpbmdDb250ZXh0O1xuICAgICAgICBpZiAoY29udGV4dCAhPT0gdW5kZWZpbmVkICYmIGNvbnRleHQgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKGNvbnRleHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5jbGVhclNvdXJjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5mb3JFYWNoKGZ1bmN0aW9uIChvYnNlcnZhYmxlLCBpbmRleCwgbWFwKSB7XG4gICAgICAgICAgICB3ZWFrX2V2ZW50X2xpc3RlbmVyXzEucmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXIob2JzZXJ2YWJsZSwgb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgX3RoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIF90aGlzKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuY2xlYXIoKTtcbiAgICAgICAgaWYgKHRoaXMuc291cmNlKSB7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZS5jbGVhcigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZU9wdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuc291cmNlT3B0aW9ucy5pbnN0YW5jZS5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5zb3VyY2VPcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS5zb3VyY2VBc09iamVjdCA9IGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgICAgdmFyIG9iamVjdFR5cGUgPSB0eXBlb2Ygc291cmNlO1xuICAgICAgICBpZiAob2JqZWN0VHlwZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgc291cmNlID0gbmV3IE51bWJlcihzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9iamVjdFR5cGUgPT09IFwiYm9vbGVhblwiKSB7XG4gICAgICAgICAgICBzb3VyY2UgPSBuZXcgQm9vbGVhbihzb3VyY2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG9iamVjdFR5cGUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHNvdXJjZSA9IG5ldyBTdHJpbmcoc291cmNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc291cmNlO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuYmluZGluZ0NvbnRleHRDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMudGFyZ2V0T3B0aW9ucy5pbnN0YW5jZS5nZXQoKTtcbiAgICAgICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudW5iaW5kKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHZhbHVlID0gZGF0YS52YWx1ZTtcbiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xlYXJCaW5kaW5nKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAoc291cmNlKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldE9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgIGlmICh0aGlzLnNvdXJjZUlzQmluZGluZ0NvbnRleHQgJiYgdGFyZ2V0IGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUgJiYgdGhpcy50YXJnZXRPcHRpb25zLnByb3BlcnR5ICE9PSBcImJpbmRpbmdDb250ZXh0XCIpIHtcbiAgICAgICAgICAgIHRhcmdldC5vbihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZShzb3VyY2UpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKHNvdXJjZSkge1xuICAgICAgICB0aGlzLmNsZWFyU291cmNlKCk7XG4gICAgICAgIHNvdXJjZSA9IHRoaXMuc291cmNlQXNPYmplY3Qoc291cmNlKTtcbiAgICAgICAgaWYgKCF0eXBlcy5pc051bGxPclVuZGVmaW5lZChzb3VyY2UpKSB7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZSA9IG5ldyBXZWFrUmVmKHNvdXJjZSk7XG4gICAgICAgICAgICB0aGlzLnNvdXJjZU9wdGlvbnMgPSB0aGlzLnJlc29sdmVPcHRpb25zKHNvdXJjZSwgdGhpcy5zb3VyY2VQcm9wZXJ0aWVzKTtcbiAgICAgICAgICAgIHZhciBzb3VyY2VWYWx1ZSA9IHRoaXMuZ2V0U291cmNlUHJvcGVydHlWYWx1ZSgpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQoc291cmNlVmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5hZGRQcm9wZXJ0eUNoYW5nZUxpc3RlbmVycyh0aGlzLnNvdXJjZSwgdGhpcy5zb3VyY2VQcm9wZXJ0aWVzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghdGhpcy5zb3VyY2VJc0JpbmRpbmdDb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgc291cmNlVmFsdWUgPSB0aGlzLmdldFNvdXJjZVByb3BlcnR5VmFsdWUoKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KHNvdXJjZVZhbHVlID8gc291cmNlVmFsdWUgOiBzb3VyY2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51bmJpbmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLnRhcmdldE9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy50d29XYXkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQub2ZmKHRoaXMudGFyZ2V0T3B0aW9ucy5wcm9wZXJ0eSArIFwiQ2hhbmdlXCIsIHRoaXMub25UYXJnZXRQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlSXNCaW5kaW5nQ29udGV4dCAmJiB0aGlzLnRhcmdldE9wdGlvbnMucHJvcGVydHkgIT09IFwiYmluZGluZ0NvbnRleHRcIikge1xuICAgICAgICAgICAgICAgIHRhcmdldC5vZmYoXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0T3B0aW9ucykge1xuICAgICAgICAgICAgdGhpcy50YXJnZXRPcHRpb25zID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc291cmNlUHJvcGVydGllcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYgKCF0aGlzLnNvdXJjZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2xlYXJTb3VyY2UoKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnJlc29sdmVPYmplY3RzQW5kUHJvcGVydGllcyA9IGZ1bmN0aW9uIChzb3VyY2UsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgY3VycmVudE9iamVjdCA9IHNvdXJjZTtcbiAgICAgICAgdmFyIGN1cnJlbnRPYmplY3RDaGFuZ2VkID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBwcm9wc0FycmF5TGVuZ3RoID0gcHJvcGVydGllcy5sZW5ndGg7IGkgPCBwcm9wc0FycmF5TGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IHByb3BlcnRpZXNbaV07XG4gICAgICAgICAgICBpZiAocHJvcGVydHkgPT09IGJjLmJpbmRpbmdWYWx1ZUtleSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRPYmplY3RDaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gYmMucGFyZW50VmFsdWVLZXkgfHwgcHJvcGVydHkuaW5kZXhPZihiYy5wYXJlbnRzVmFsdWVLZXkpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudFZpZXcgPSB0aGlzLmdldFBhcmVudFZpZXcodGhpcy50YXJnZXQuZ2V0KCksIHByb3BlcnR5KS52aWV3O1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRWaWV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRPYmplY3QgPSBwYXJlbnRWaWV3LmJpbmRpbmdDb250ZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEluc3RhbmNlID0gdGhpcy50YXJnZXQuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEluc3RhbmNlLm9mZihcImxvYWRlZFwiLCB0aGlzLmxvYWRlZEhhbmRsZXJWaXN1YWxUcmVlQmluZGluZywgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEluc3RhbmNlLm9uKFwibG9hZGVkXCIsIHRoaXMubG9hZGVkSGFuZGxlclZpc3VhbFRyZWVCaW5kaW5nLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY3VycmVudE9iamVjdENoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGN1cnJlbnRPYmplY3QpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IGluc3RhbmNlOiBjdXJyZW50T2JqZWN0LCBwcm9wZXJ0eTogcHJvcGVydHkgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghY3VycmVudE9iamVjdENoYW5nZWQgJiYgKGkgPCBwcm9wc0FycmF5TGVuZ3RoIC0gMSkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50T2JqZWN0ID0gY3VycmVudE9iamVjdCA/IGN1cnJlbnRPYmplY3RbcHJvcGVydGllc1tpXV0gOiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE9iamVjdENoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuYWRkUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoc291cmNlLCBzb3VyY2VQcm9wZXJ0eSwgcGFyZW50UHJvcGVyaWVzKSB7XG4gICAgICAgIHZhciBvYmplY3RzQW5kUHJvcGVydGllcyA9IHRoaXMucmVzb2x2ZU9iamVjdHNBbmRQcm9wZXJ0aWVzKHNvdXJjZS5nZXQoKSwgc291cmNlUHJvcGVydHkpO1xuICAgICAgICB2YXIgcHJvcCA9IHBhcmVudFByb3BlcmllcyB8fCBcIlwiO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBvYmplY3RzQW5kUHJvcGVydGllcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcHJvcE5hbWUgPSBvYmplY3RzQW5kUHJvcGVydGllc1tpXS5wcm9wZXJ0eTtcbiAgICAgICAgICAgIHByb3AgKz0gXCIkXCIgKyBwcm9wTmFtZTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50T2JqZWN0ID0gb2JqZWN0c0FuZFByb3BlcnRpZXNbaV0uaW5zdGFuY2U7XG4gICAgICAgICAgICBpZiAoIXRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuaGFzKHByb3ApICYmIGN1cnJlbnRPYmplY3QgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSAmJiBjdXJyZW50T2JqZWN0Ll9pc1ZpZXdCYXNlKSB7XG4gICAgICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLmFkZFdlYWtFdmVudExpc3RlbmVyKGN1cnJlbnRPYmplY3QsIHByb3BOYW1lICsgXCJDaGFuZ2VcIiwgdGhpcy5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgd2Vha19ldmVudF9saXN0ZW5lcl8xLmFkZFdlYWtFdmVudExpc3RlbmVyKGN1cnJlbnRPYmplY3QsIG9ic2VydmFibGVfMS5PYnNlcnZhYmxlLnByb3BlcnR5Q2hhbmdlRXZlbnQsIHRoaXMub25Tb3VyY2VQcm9wZXJ0eUNoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuc2V0KHByb3AsIGN1cnJlbnRPYmplY3QpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoIXRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuaGFzKHByb3ApICYmIGN1cnJlbnRPYmplY3QgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5hZGRXZWFrRXZlbnRMaXN0ZW5lcihjdXJyZW50T2JqZWN0LCBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZS5wcm9wZXJ0eUNoYW5nZUV2ZW50LCB0aGlzLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLnNldChwcm9wLCBjdXJyZW50T2JqZWN0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUucHJlcGFyZUV4cHJlc3Npb25Gb3JVcGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlc2NhcGVkU291cmNlUHJvcGVydHkgPSB1dGlsc18xLmVzY2FwZVJlZ2V4U3ltYm9scyh0aGlzLm9wdGlvbnMuc291cmNlUHJvcGVydHkpO1xuICAgICAgICB2YXIgZXhwUmVnZXggPSBuZXcgUmVnRXhwKGVzY2FwZWRTb3VyY2VQcm9wZXJ0eSwgXCJnXCIpO1xuICAgICAgICB2YXIgcmVzdWx0RXhwID0gdGhpcy5vcHRpb25zLmV4cHJlc3Npb24ucmVwbGFjZShleHBSZWdleCwgYmMubmV3UHJvcGVydHlWYWx1ZUtleSk7XG4gICAgICAgIHJldHVybiByZXN1bHRFeHA7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGVUd29XYXkgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudXBkYXRpbmcgfHwgIXRoaXMub3B0aW9ucy50d29XYXkpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmV3VmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5leHByZXNzaW9uKSB7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZE1vZGVsID0ge307XG4gICAgICAgICAgICBjaGFuZ2VkTW9kZWxbYmMuYmluZGluZ1ZhbHVlS2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgY2hhbmdlZE1vZGVsW2JjLm5ld1Byb3BlcnR5VmFsdWVLZXldID0gdmFsdWU7XG4gICAgICAgICAgICB2YXIgc291cmNlUHJvcGVydHlOYW1lID0gXCJcIjtcbiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZU9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eU5hbWUgPSB0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5ID09PSBcInN0cmluZ1wiICYmIHRoaXMub3B0aW9ucy5zb3VyY2VQcm9wZXJ0eS5pbmRleE9mKFwiLlwiKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VQcm9wZXJ0eU5hbWUgPSB0aGlzLm9wdGlvbnMuc291cmNlUHJvcGVydHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc291cmNlUHJvcGVydHlOYW1lICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZE1vZGVsW3NvdXJjZVByb3BlcnR5TmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB1cGRhdGVFeHByZXNzaW9uID0gdGhpcy5wcmVwYXJlRXhwcmVzc2lvbkZvclVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5wcmVwYXJlQ29udGV4dEZvckV4cHJlc3Npb24oY2hhbmdlZE1vZGVsLCB1cGRhdGVFeHByZXNzaW9uLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb25WYWx1ZSA9IHRoaXMuX2dldEV4cHJlc3Npb25WYWx1ZSh1cGRhdGVFeHByZXNzaW9uLCB0cnVlLCBjaGFuZ2VkTW9kZWwpO1xuICAgICAgICAgICAgaWYgKGV4cHJlc3Npb25WYWx1ZSBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShleHByZXNzaW9uVmFsdWUubWVzc2FnZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkJpbmRpbmcsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3VmFsdWUgPSBleHByZXNzaW9uVmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVTb3VyY2UobmV3VmFsdWUpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuX2dldEV4cHJlc3Npb25WYWx1ZSA9IGZ1bmN0aW9uIChleHByZXNzaW9uLCBpc0JhY2tDb252ZXJ0LCBjaGFuZ2VkTW9kZWwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBleHBfMSA9IHBvbHltZXJFeHByZXNzaW9ucy5Qb2x5bWVyRXhwcmVzc2lvbnMuZ2V0RXhwcmVzc2lvbihleHByZXNzaW9uKTtcbiAgICAgICAgICAgIGlmIChleHBfMSkge1xuICAgICAgICAgICAgICAgIHZhciBjb250ZXh0XzEgPSB0aGlzLnNvdXJjZSAmJiB0aGlzLnNvdXJjZS5nZXQgJiYgdGhpcy5zb3VyY2UuZ2V0KCkgfHwgZ2xvYmFsO1xuICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IHt9O1xuICAgICAgICAgICAgICAgIHZhciBhZGRlZFByb3BzID0gW107XG4gICAgICAgICAgICAgICAgdmFyIHJlc291cmNlcyA9IGFwcGxpY2F0aW9uQ29tbW9uLmdldFJlc291cmNlcygpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHByb3AgaW4gcmVzb3VyY2VzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNvdXJjZXMuaGFzT3duUHJvcGVydHkocHJvcCkgJiYgIWNvbnRleHRfMS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dF8xW3Byb3BdID0gcmVzb3VyY2VzW3Byb3BdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkZWRQcm9wcy5wdXNoKHByb3ApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucHJlcGFyZUNvbnRleHRGb3JFeHByZXNzaW9uKGNvbnRleHRfMSwgZXhwcmVzc2lvbiwgYWRkZWRQcm9wcyk7XG4gICAgICAgICAgICAgICAgbW9kZWxbY29udGV4dEtleV0gPSBjb250ZXh0XzE7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGV4cF8xLmdldFZhbHVlKG1vZGVsLCBpc0JhY2tDb252ZXJ0LCBjaGFuZ2VkTW9kZWwgPyBjaGFuZ2VkTW9kZWwgOiBtb2RlbCk7XG4gICAgICAgICAgICAgICAgdmFyIGFkZGVkUHJvcHNMZW5ndGggPSBhZGRlZFByb3BzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFkZGVkUHJvcHNMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29udGV4dF8xW2FkZGVkUHJvcHNbaV1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhZGRlZFByb3BzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgRXJyb3IoZXhwcmVzc2lvbiArIFwiIGlzIG5vdCBhIHZhbGlkIGV4cHJlc3Npb24uXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gXCJSdW4tdGltZSBlcnJvciBvY2N1cmVkIGluIGZpbGU6IFwiICsgZS5zb3VyY2VVUkwgKyBcIiBhdCBsaW5lOiBcIiArIGUubGluZSArIFwiIGFuZCBjb2x1bW46IFwiICsgZS5jb2x1bW47XG4gICAgICAgICAgICByZXR1cm4gbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLm9uU291cmNlUHJvcGVydHlDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdmFyIHNvdXJjZVByb3BzID0gdGhpcy5zb3VyY2VQcm9wZXJ0aWVzO1xuICAgICAgICB2YXIgc291cmNlUHJvcHNMZW5ndGggPSBzb3VyY2VQcm9wcy5sZW5ndGg7XG4gICAgICAgIHZhciBjaGFuZ2VkUHJvcGVydHlJbmRleCA9IHNvdXJjZVByb3BzLmluZGV4T2YoZGF0YS5wcm9wZXJ0eU5hbWUpO1xuICAgICAgICB2YXIgcGFyZW50UHJvcHMgPSBcIlwiO1xuICAgICAgICBpZiAoY2hhbmdlZFByb3BlcnR5SW5kZXggPiAtMSkge1xuICAgICAgICAgICAgcGFyZW50UHJvcHMgPSBcIiRcIiArIHNvdXJjZVByb3BzLnNsaWNlKDAsIGNoYW5nZWRQcm9wZXJ0eUluZGV4ICsgMSkuam9pbihcIiRcIik7XG4gICAgICAgICAgICB3aGlsZSAodGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5nZXQocGFyZW50UHJvcHMpICE9PSBkYXRhLm9iamVjdCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZWRQcm9wZXJ0eUluZGV4ICs9IHNvdXJjZVByb3BzLnNsaWNlKGNoYW5nZWRQcm9wZXJ0eUluZGV4ICsgMSkuaW5kZXhPZihkYXRhLnByb3BlcnR5TmFtZSkgKyAxO1xuICAgICAgICAgICAgICAgIHBhcmVudFByb3BzID0gXCIkXCIgKyBzb3VyY2VQcm9wcy5zbGljZSgwLCBjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpLmpvaW4oXCIkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbikge1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb25WYWx1ZSA9IHRoaXMuX2dldEV4cHJlc3Npb25WYWx1ZSh0aGlzLm9wdGlvbnMuZXhwcmVzc2lvbiwgZmFsc2UsIHVuZGVmaW5lZCk7XG4gICAgICAgICAgICBpZiAoZXhwcmVzc2lvblZhbHVlIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKGV4cHJlc3Npb25WYWx1ZS5tZXNzYWdlLCB0cmFjZV8xLmNhdGVnb3JpZXMuQmluZGluZywgdHJhY2VfMS5tZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChleHByZXNzaW9uVmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGNoYW5nZWRQcm9wZXJ0eUluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcHMgPSBzb3VyY2VQcm9wcy5zbGljZShjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpO1xuICAgICAgICAgICAgICAgIHZhciBwcm9wc0xlbmd0aCA9IHByb3BzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAocHJvcHNMZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGRhdGEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHNMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2YWx1ZVtwcm9wc1tpXV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGVUYXJnZXQodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChkYXRhLnByb3BlcnR5TmFtZSA9PT0gdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVGFyZ2V0KGRhdGEudmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoY2hhbmdlZFByb3BlcnR5SW5kZXggPiAtMSAmJiBjaGFuZ2VkUHJvcGVydHlJbmRleCA8IHNvdXJjZVByb3BzTGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgdmFyIHByb2JhYmx5Q2hhbmdlZE9iamVjdCA9IHRoaXMucHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMuZ2V0KHBhcmVudFByb3BzKTtcbiAgICAgICAgICAgIGlmIChwcm9iYWJseUNoYW5nZWRPYmplY3QgJiZcbiAgICAgICAgICAgICAgICBwcm9iYWJseUNoYW5nZWRPYmplY3QgIT09IGRhdGEub2JqZWN0W3NvdXJjZVByb3BzW2NoYW5nZWRQcm9wZXJ0eUluZGV4XV0pIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gc291cmNlUHJvcHNMZW5ndGggLSAxOyBpID4gY2hhbmdlZFByb3BlcnR5SW5kZXg7IGktLSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IFwiJFwiICsgc291cmNlUHJvcHMuc2xpY2UoMCwgaSArIDEpLmpvaW4oXCIkXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eUNoYW5nZUxpc3RlbmVycy5oYXMocHJvcCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdlYWtfZXZlbnRfbGlzdGVuZXJfMS5yZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcih0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmdldChwcm9wKSwgb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGhpcy5vblNvdXJjZVByb3BlcnR5Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5Q2hhbmdlTGlzdGVuZXJzLmRlbGV0ZShwcm9wKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgbmV3UHJvcHMgPSBzb3VyY2VQcm9wcy5zbGljZShjaGFuZ2VkUHJvcGVydHlJbmRleCArIDEpO1xuICAgICAgICAgICAgICAgIHZhciBuZXdPYmplY3QgPSBkYXRhLm9iamVjdFtzb3VyY2VQcm9wc1tjaGFuZ2VkUHJvcGVydHlJbmRleF1dO1xuICAgICAgICAgICAgICAgIGlmICghdHlwZXMuaXNOdWxsT3JVbmRlZmluZWQobmV3T2JqZWN0KSAmJiB0eXBlb2YgbmV3T2JqZWN0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkUHJvcGVydHlDaGFuZ2VMaXN0ZW5lcnMobmV3IFdlYWtSZWYobmV3T2JqZWN0KSwgbmV3UHJvcHMsIHBhcmVudFByb3BzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnByZXBhcmVDb250ZXh0Rm9yRXhwcmVzc2lvbiA9IGZ1bmN0aW9uIChtb2RlbCwgZXhwcmVzc2lvbiwgbmV3UHJvcHMpIHtcbiAgICAgICAgdmFyIHBhcmVudFZpZXdBbmRJbmRleDtcbiAgICAgICAgdmFyIHBhcmVudFZpZXc7XG4gICAgICAgIHZhciBhZGRlZFByb3BzID0gbmV3UHJvcHMgfHwgW107XG4gICAgICAgIGlmIChleHByZXNzaW9uLmluZGV4T2YoYmMuYmluZGluZ1ZhbHVlS2V5KSA+IC0xKSB7XG4gICAgICAgICAgICBtb2RlbFtiYy5iaW5kaW5nVmFsdWVLZXldID0gbW9kZWw7XG4gICAgICAgICAgICBhZGRlZFByb3BzLnB1c2goYmMuYmluZGluZ1ZhbHVlS2V5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhwcmVzc2lvbi5pbmRleE9mKGJjLnBhcmVudFZhbHVlS2V5KSA+IC0xKSB7XG4gICAgICAgICAgICBwYXJlbnRWaWV3ID0gdGhpcy5nZXRQYXJlbnRWaWV3KHRoaXMudGFyZ2V0LmdldCgpLCBiYy5wYXJlbnRWYWx1ZUtleSkudmlldztcbiAgICAgICAgICAgIGlmIChwYXJlbnRWaWV3KSB7XG4gICAgICAgICAgICAgICAgbW9kZWxbYmMucGFyZW50VmFsdWVLZXldID0gcGFyZW50Vmlldy5iaW5kaW5nQ29udGV4dDtcbiAgICAgICAgICAgICAgICBhZGRlZFByb3BzLnB1c2goYmMucGFyZW50VmFsdWVLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnRzQXJyYXkgPSBleHByZXNzaW9uLm1hdGNoKGJpbmRpbmdfYnVpbGRlcl8xLnBhcmVudHNSZWdleCk7XG4gICAgICAgIGlmIChwYXJlbnRzQXJyYXkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFyZW50c0FycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50Vmlld0FuZEluZGV4ID0gdGhpcy5nZXRQYXJlbnRWaWV3KHRoaXMudGFyZ2V0LmdldCgpLCBwYXJlbnRzQXJyYXlbaV0pO1xuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRWaWV3QW5kSW5kZXgudmlldykge1xuICAgICAgICAgICAgICAgICAgICBtb2RlbFtiYy5wYXJlbnRzVmFsdWVLZXldID0gbW9kZWxbYmMucGFyZW50c1ZhbHVlS2V5XSB8fCB7fTtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxbYmMucGFyZW50c1ZhbHVlS2V5XVtwYXJlbnRWaWV3QW5kSW5kZXguaW5kZXhdID0gcGFyZW50Vmlld0FuZEluZGV4LnZpZXcuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgICAgICAgICAgICAgIGFkZGVkUHJvcHMucHVzaChiYy5wYXJlbnRzVmFsdWVLZXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuZ2V0U291cmNlUHJvcGVydHlWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5leHByZXNzaW9uKSB7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZE1vZGVsID0ge307XG4gICAgICAgICAgICBjaGFuZ2VkTW9kZWxbYmMuYmluZGluZ1ZhbHVlS2V5XSA9IHRoaXMuc291cmNlID8gdGhpcy5zb3VyY2UuZ2V0KCkgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvblZhbHVlID0gdGhpcy5fZ2V0RXhwcmVzc2lvblZhbHVlKHRoaXMub3B0aW9ucy5leHByZXNzaW9uLCBmYWxzZSwgY2hhbmdlZE1vZGVsKTtcbiAgICAgICAgICAgIGlmIChleHByZXNzaW9uVmFsdWUgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoZXhwcmVzc2lvblZhbHVlLm1lc3NhZ2UsIHRyYWNlXzEuY2F0ZWdvcmllcy5CaW5kaW5nLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBleHByZXNzaW9uVmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuc291cmNlT3B0aW9ucykge1xuICAgICAgICAgICAgdmFyIHNvdXJjZU9wdGlvbnNJbnN0YW5jZSA9IHRoaXMuc291cmNlT3B0aW9ucy5pbnN0YW5jZS5nZXQoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgPT09IGJjLmJpbmRpbmdWYWx1ZUtleSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2VPcHRpb25zSW5zdGFuY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICgoc291cmNlT3B0aW9uc0luc3RhbmNlIGluc3RhbmNlb2Ygb2JzZXJ2YWJsZV8xLk9ic2VydmFibGUpICYmICh0aGlzLnNvdXJjZU9wdGlvbnMucHJvcGVydHkgJiYgdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ICE9PSBcIlwiKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzb3VyY2VPcHRpb25zSW5zdGFuY2UuZ2V0KHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzb3VyY2VPcHRpb25zSW5zdGFuY2UgJiYgdGhpcy5zb3VyY2VPcHRpb25zLnByb3BlcnR5ICYmIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSAhPT0gXCJcIiAmJlxuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSBpbiBzb3VyY2VPcHRpb25zSW5zdGFuY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlT3B0aW9uc0luc3RhbmNlW3RoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiUHJvcGVydHk6ICdcIiArIHRoaXMuc291cmNlT3B0aW9ucy5wcm9wZXJ0eSArIFwiJyBpcyBpbnZhbGlkIG9yIGRvZXMgbm90IGV4aXN0LiBTb3VyY2VQcm9wZXJ0eTogJ1wiICsgdGhpcy5vcHRpb25zLnNvdXJjZVByb3BlcnR5ICsgXCInXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5CaW5kaW5nLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLmNsZWFyQmluZGluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5jbGVhclNvdXJjZSgpO1xuICAgICAgICB0aGlzLnVwZGF0ZVRhcmdldChwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSk7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGVUYXJnZXQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHRoaXMudXBkYXRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZU9wdGlvbnModGhpcy50YXJnZXRPcHRpb25zLCB0eXBlcy5pc051bGxPclVuZGVmaW5lZCh2YWx1ZSkgPyBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSA6IHZhbHVlKTtcbiAgICB9O1xuICAgIEJpbmRpbmcucHJvdG90eXBlLnVwZGF0ZVNvdXJjZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy51cGRhdGluZyB8fCAhdGhpcy5zb3VyY2UgfHwgIXRoaXMuc291cmNlLmdldCgpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy51cGRhdGVPcHRpb25zKHRoaXMuc291cmNlT3B0aW9ucywgdmFsdWUpO1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUuZ2V0UGFyZW50VmlldyA9IGZ1bmN0aW9uICh0YXJnZXQsIHByb3BlcnR5KSB7XG4gICAgICAgIGlmICghdGFyZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm4geyB2aWV3OiBudWxsLCBpbmRleDogbnVsbCB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgIGlmIChwcm9wZXJ0eSA9PT0gYmMucGFyZW50VmFsdWVLZXkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRhcmdldC5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gbnVsbDtcbiAgICAgICAgaWYgKHByb3BlcnR5LmluZGV4T2YoYmMucGFyZW50c1ZhbHVlS2V5KSA9PT0gMCkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdGFyZ2V0LnBhcmVudDtcbiAgICAgICAgICAgIHZhciBpbmRleFBhcmFtcyA9IHBhcmFtc1JlZ2V4LmV4ZWMocHJvcGVydHkpO1xuICAgICAgICAgICAgaWYgKGluZGV4UGFyYW1zICYmIGluZGV4UGFyYW1zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBpbmRleCA9IGluZGV4UGFyYW1zWzJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFpc05hTihpbmRleCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhBc0ludCA9IHBhcnNlSW50KGluZGV4KTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoaW5kZXhBc0ludCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgaW5kZXhBc0ludC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVzLmlzU3RyaW5nKGluZGV4KSkge1xuICAgICAgICAgICAgICAgIHdoaWxlIChyZXN1bHQgJiYgcmVzdWx0LnR5cGVOYW1lICE9PSBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQucGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4geyB2aWV3OiByZXN1bHQsIGluZGV4OiBpbmRleCB9O1xuICAgIH07XG4gICAgQmluZGluZy5wcm90b3R5cGUucmVzb2x2ZU9wdGlvbnMgPSBmdW5jdGlvbiAob2JqLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHZhciBvYmplY3RzQW5kUHJvcGVydGllcyA9IHRoaXMucmVzb2x2ZU9iamVjdHNBbmRQcm9wZXJ0aWVzKG9iaiwgcHJvcGVydGllcyk7XG4gICAgICAgIGlmIChvYmplY3RzQW5kUHJvcGVydGllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB2YXIgcmVzb2x2ZWRPYmogPSBvYmplY3RzQW5kUHJvcGVydGllc1tvYmplY3RzQW5kUHJvcGVydGllcy5sZW5ndGggLSAxXS5pbnN0YW5jZTtcbiAgICAgICAgICAgIHZhciBwcm9wID0gb2JqZWN0c0FuZFByb3BlcnRpZXNbb2JqZWN0c0FuZFByb3BlcnRpZXMubGVuZ3RoIC0gMV0ucHJvcGVydHk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGluc3RhbmNlOiBuZXcgV2Vha1JlZih0aGlzLnNvdXJjZUFzT2JqZWN0KHJlc29sdmVkT2JqKSksXG4gICAgICAgICAgICAgICAgcHJvcGVydHk6IHByb3BcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBCaW5kaW5nLnByb3RvdHlwZS51cGRhdGVPcHRpb25zID0gZnVuY3Rpb24gKG9wdGlvbnMsIHZhbHVlKSB7XG4gICAgICAgIHZhciBvcHRpb25zSW5zdGFuY2U7XG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuaW5zdGFuY2UpIHtcbiAgICAgICAgICAgIG9wdGlvbnNJbnN0YW5jZSA9IG9wdGlvbnMuaW5zdGFuY2UuZ2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRpb25zSW5zdGFuY2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0aW5nID0gdHJ1ZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChpc0V2ZW50T3JHZXN0dXJlKG9wdGlvbnMucHJvcGVydHksIG9wdGlvbnNJbnN0YW5jZSkgJiZcbiAgICAgICAgICAgICAgICB0eXBlcy5pc0Z1bmN0aW9uKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNJbnN0YW5jZS5vZmYob3B0aW9ucy5wcm9wZXJ0eSwgbnVsbCwgb3B0aW9uc0luc3RhbmNlLmJpbmRpbmdDb250ZXh0KTtcbiAgICAgICAgICAgICAgICBvcHRpb25zSW5zdGFuY2Uub24ob3B0aW9ucy5wcm9wZXJ0eSwgdmFsdWUsIG9wdGlvbnNJbnN0YW5jZS5iaW5kaW5nQ29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChvcHRpb25zSW5zdGFuY2UgaW5zdGFuY2VvZiBvYnNlcnZhYmxlXzEuT2JzZXJ2YWJsZSkge1xuICAgICAgICAgICAgICAgIG9wdGlvbnNJbnN0YW5jZS5zZXQob3B0aW9ucy5wcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb3B0aW9uc0luc3RhbmNlW29wdGlvbnMucHJvcGVydHldID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiQmluZGluZyBlcnJvciB3aGlsZSBzZXR0aW5nIHByb3BlcnR5IFwiICsgb3B0aW9ucy5wcm9wZXJ0eSArIFwiIG9mIFwiICsgb3B0aW9uc0luc3RhbmNlICsgXCI6IFwiICsgZXgsIHRyYWNlXzEuY2F0ZWdvcmllcy5CaW5kaW5nLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0aW5nID0gZmFsc2U7XG4gICAgfTtcbiAgICByZXR1cm4gQmluZGluZztcbn0oKSk7XG5leHBvcnRzLkJpbmRpbmcgPSBCaW5kaW5nO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmluZGFibGUuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIE9ic2VydmVyQ2xhc3MgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhPYnNlcnZlckNsYXNzLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIE9ic2VydmVyQ2xhc3MoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JzZXJ2ZXJDbGFzcy5wcm90b3R5cGUub2JzZXJ2ZVZhbHVlRm9yS2V5UGF0aE9mT2JqZWN0Q2hhbmdlQ29udGV4dCA9IGZ1bmN0aW9uIChwYXRoKSB7XG4gICAgICAgIGlmIChwYXRoID09PSBcInNlbGVjdGVkXCIpIHtcbiAgICAgICAgICAgIHRoaXNbXCJfb3duZXJcIl0uX29uU2VsZWN0ZWRDaGFuZ2VkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAocGF0aCA9PT0gXCJlbmFibGVkXCIpIHtcbiAgICAgICAgICAgIHRoaXNbXCJfb3duZXJcIl0uX29uRW5hYmxlZENoYW5nZWQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXRoID09PSBcImhpZ2hsaWdodGVkXCIpIHtcbiAgICAgICAgICAgIHRoaXNbXCJfb3duZXJcIl0uX29uSGlnaGxpZ2h0ZWRDaGFuZ2VkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBPYnNlcnZlckNsYXNzO1xufShOU09iamVjdCkpO1xudmFyIENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lcihjb250cm9sLCBjYWxsYmFjaykge1xuICAgICAgICB0aGlzLl9vYnNlcnZpbmcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXIgPSBPYnNlcnZlckNsYXNzLmFsbG9jKCk7XG4gICAgICAgIHRoaXMuX29ic2VydmVyW1wiX293bmVyXCJdID0gdGhpcztcbiAgICAgICAgdGhpcy5fY29udHJvbCA9IGNvbnRyb2w7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuICAgIENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9vYnNlcnZpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRyb2wuYWRkT2JzZXJ2ZXJGb3JLZXlQYXRoT3B0aW9uc0NvbnRleHQodGhpcy5fb2JzZXJ2ZXIsIFwiaGlnaGxpZ2h0ZWRcIiwgMSwgbnVsbCk7XG4gICAgICAgICAgICB0aGlzLl9vYnNlcnZpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXIucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9vYnNlcnZpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX29ic2VydmluZyA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fY29udHJvbC5yZW1vdmVPYnNlcnZlckZvcktleVBhdGgodGhpcy5fb2JzZXJ2ZXIsIFwiaGlnaGxpZ2h0ZWRcIik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyLnByb3RvdHlwZS5fb25FbmFibGVkQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3RhdGUoKTtcbiAgICB9O1xuICAgIENvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyLnByb3RvdHlwZS5fb25TZWxlY3RlZENoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZVN0YXRlKCk7XG4gICAgfTtcbiAgICBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lci5wcm90b3R5cGUuX29uSGlnaGxpZ2h0ZWRDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl91cGRhdGVTdGF0ZSgpO1xuICAgIH07XG4gICAgQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXIucHJvdG90eXBlLl91cGRhdGVTdGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0YXRlID0gXCJub3JtYWxcIjtcbiAgICAgICAgaWYgKHRoaXMuX2NvbnRyb2wuaGlnaGxpZ2h0ZWQpIHtcbiAgICAgICAgICAgIHN0YXRlID0gXCJoaWdobGlnaHRlZFwiO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrKHN0YXRlKTtcbiAgICB9O1xuICAgIHJldHVybiBDb250cm9sU3RhdGVDaGFuZ2VMaXN0ZW5lcjtcbn0oKSk7XG5leHBvcnRzLkNvbnRyb2xTdGF0ZUNoYW5nZUxpc3RlbmVyID0gQ29udHJvbFN0YXRlQ2hhbmdlTGlzdGVuZXI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb250cm9sLXN0YXRlLWNoYW5nZS5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIG9ic2VydmFibGVfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9kYXRhL29ic2VydmFibGVcIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi90cmFjZVwiKTtcbnZhciBzdHlsZV8xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGVcIik7XG5leHBvcnRzLlN0eWxlID0gc3R5bGVfMS5TdHlsZTtcbnZhciBwcm9maWxpbmdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9wcm9maWxpbmdcIik7XG5leHBvcnRzLnVuc2V0VmFsdWUgPSBuZXcgT2JqZWN0KCk7XG52YXIgY3NzUHJvcGVydHlOYW1lcyA9IFtdO1xudmFyIHN5bWJvbFByb3BlcnR5TWFwID0ge307XG52YXIgY3NzU3ltYm9sUHJvcGVydHlNYXAgPSB7fTtcbnZhciBpbmhlcml0YWJsZVByb3BlcnRpZXMgPSBuZXcgQXJyYXkoKTtcbnZhciBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXMgPSBuZXcgQXJyYXkoKTtcbmZ1bmN0aW9uIHByaW50KG1hcCkge1xuICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhtYXApO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc18xID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzFbX2ldO1xuICAgICAgICB2YXIgcHJvcCA9IG1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3AucmVnaXN0ZXJlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJQcm9wZXJ0eSBcIiArIHByb3AubmFtZSArIFwiIG5vdCBSZWdpc3RlcmVkISEhISFcIik7XG4gICAgICAgIH1cbiAgICB9XG59XG5mdW5jdGlvbiBfcHJpbnRVbnJlZ2lzdGVyZWRQcm9wZXJ0aWVzKCkge1xuICAgIHByaW50KHN5bWJvbFByb3BlcnR5TWFwKTtcbiAgICBwcmludChjc3NTeW1ib2xQcm9wZXJ0eU1hcCk7XG59XG5leHBvcnRzLl9wcmludFVucmVnaXN0ZXJlZFByb3BlcnRpZXMgPSBfcHJpbnRVbnJlZ2lzdGVyZWRQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gX2dldFByb3BlcnRpZXMoKSB7XG4gICAgcmV0dXJuIGdldFByb3BlcnRpZXNGcm9tTWFwKHN5bWJvbFByb3BlcnR5TWFwKTtcbn1cbmV4cG9ydHMuX2dldFByb3BlcnRpZXMgPSBfZ2V0UHJvcGVydGllcztcbmZ1bmN0aW9uIF9nZXRTdHlsZVByb3BlcnRpZXMoKSB7XG4gICAgcmV0dXJuIGdldFByb3BlcnRpZXNGcm9tTWFwKGNzc1N5bWJvbFByb3BlcnR5TWFwKTtcbn1cbmV4cG9ydHMuX2dldFN0eWxlUHJvcGVydGllcyA9IF9nZXRTdHlsZVByb3BlcnRpZXM7XG5mdW5jdGlvbiBnZXRQcm9wZXJ0aWVzRnJvbU1hcChtYXApIHtcbiAgICB2YXIgcHJvcHMgPSBbXTtcbiAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG1hcCkuZm9yRWFjaChmdW5jdGlvbiAoc3ltYm9sKSB7IHJldHVybiBwcm9wcy5wdXNoKG1hcFtzeW1ib2xdKTsgfSk7XG4gICAgcmV0dXJuIHByb3BzO1xufVxudmFyIFByb3BlcnR5ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHRoaXMuZW51bWVyYWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5uYW1lID0gcHJvcGVydHlOYW1lO1xuICAgICAgICB2YXIga2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnByb3BlcnR5S2V5XCIpO1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdmFyIGdldERlZmF1bHQgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6Z2V0RGVmYXVsdFwiKTtcbiAgICAgICAgdGhpcy5nZXREZWZhdWx0ID0gZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpzZXROYXRpdmVcIik7XG4gICAgICAgIHRoaXMuc2V0TmF0aXZlID0gc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOm5hdGl2ZURlZmF1bHRWYWx1ZVwiKTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWVLZXkgPSBkZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlcjtcbiAgICAgICAgdmFyIGFmZmVjdHNMYXlvdXQgPSBvcHRpb25zLmFmZmVjdHNMYXlvdXQ7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZDtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gdGhpcztcbiAgICAgICAgdGhpcy5zZXQgPSBmdW5jdGlvbiAoYm94ZWRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJlc2V0ID0gYm94ZWRWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQ7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHdyYXBwZWQgPSBib3hlZFZhbHVlICYmIGJveGVkVmFsdWUud3JhcHBlZDtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHdyYXBwZWQgPyBvYnNlcnZhYmxlXzEuV3JhcHBlZFZhbHVlLnVud3JhcChib3hlZFZhbHVlKSA6IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbHVlQ29udmVydGVyKHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgb2xkVmFsdWUgPSBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gZXF1YWxpdHlDb21wYXJlciA/ICFlcXVhbGl0eUNvbXBhcmVyKG9sZFZhbHVlLCB2YWx1ZSkgOiBvbGRWYWx1ZSAhPT0gdmFsdWU7XG4gICAgICAgICAgICBpZiAod3JhcHBlZCB8fCBjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1trZXldO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0odGhpc1tkZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXShkZWZhdWx0VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzW3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHRoaXNbZ2V0RGVmYXVsdF0gPyB0aGlzW2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRvbU5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbU5vZGUuYXR0cmlidXRlUmVtb3ZlZChwcm9wZXJ0eU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kb21Ob2RlLmF0dHJpYnV0ZU1vZGlmaWVkKHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLmdldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5uYXRpdmVWYWx1ZUNoYW5nZSA9IGZ1bmN0aW9uIChvd25lciwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiBvd25lciA/IG93bmVyW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IGVxdWFsaXR5Q29tcGFyZXIgPyAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpIDogb2xkVmFsdWUgIT09IHZhbHVlO1xuICAgICAgICAgICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBvd25lcltrZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQob3duZXIsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChvd25lci5uYXRpdmVWaWV3UHJvdGVjdGVkICYmICEoZGVmYXVsdFZhbHVlS2V5IGluIG93bmVyKSkge1xuICAgICAgICAgICAgICAgICAgICBvd25lcltkZWZhdWx0VmFsdWVLZXldID0gb3duZXJbZ2V0RGVmYXVsdF0gPyBvd25lcltnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob3duZXIuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIubm90aWZ5KHsgb2JqZWN0OiBvd25lciwgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgb3duZXIucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAob3duZXIuZG9tTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBvd25lci5kb21Ob2RlLmF0dHJpYnV0ZU1vZGlmaWVkKHByb3BlcnR5TmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgc3ltYm9sUHJvcGVydHlNYXBba2V5XSA9IHRoaXM7XG4gICAgfVxuICAgIFByb3BlcnR5LnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgaWYgKHRoaXMucmVnaXN0ZXJlZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUHJvcGVydHkgXCIgKyB0aGlzLm5hbWUgKyBcIiBhbHJlYWR5IHJlZ2lzdGVyZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVnaXN0ZXJlZCA9IHRydWU7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLm5hbWUsIHRoaXMpO1xuICAgIH07XG4gICAgUHJvcGVydHkucHJvdG90eXBlLmlzU2V0ID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleSBpbiBpbnN0YW5jZTtcbiAgICB9O1xuICAgIHJldHVybiBQcm9wZXJ0eTtcbn0oKSk7XG5leHBvcnRzLlByb3BlcnR5ID0gUHJvcGVydHk7XG5Qcm9wZXJ0eS5wcm90b3R5cGUuaXNTdHlsZVByb3BlcnR5ID0gZmFsc2U7XG52YXIgQ29lcmNpYmxlUHJvcGVydHkgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb2VyY2libGVQcm9wZXJ0eSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb2VyY2libGVQcm9wZXJ0eShvcHRpb25zKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMpIHx8IHRoaXM7XG4gICAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zLm5hbWU7XG4gICAgICAgIHZhciBrZXkgPSBfdGhpcy5rZXk7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gX3RoaXMuZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IF90aGlzLnNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IF90aGlzLmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IF90aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgdmFyIGNvZXJjZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpjb2VyY2VLZXlcIik7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgYWZmZWN0c0xheW91dCA9IG9wdGlvbnMuYWZmZWN0c0xheW91dDtcbiAgICAgICAgdmFyIGVxdWFsaXR5Q29tcGFyZXIgPSBvcHRpb25zLmVxdWFsaXR5Q29tcGFyZXI7XG4gICAgICAgIHZhciB2YWx1ZUNoYW5nZWQgPSBvcHRpb25zLnZhbHVlQ2hhbmdlZDtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIGNvZXJjZUNhbGxiYWNrID0gb3B0aW9ucy5jb2VyY2VWYWx1ZTtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gX3RoaXM7XG4gICAgICAgIF90aGlzLmNvZXJjZSA9IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbFZhbHVlID0gY29lcmNlS2V5IGluIHRhcmdldCA/IHRhcmdldFtjb2VyY2VLZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdGFyZ2V0W3Byb3BlcnR5TmFtZV0gPSBvcmlnaW5hbFZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5zZXQgPSBmdW5jdGlvbiAoYm94ZWRWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJlc2V0ID0gYm94ZWRWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgdmFyIHdyYXBwZWQ7XG4gICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tjb2VyY2VLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgd3JhcHBlZCA9IGJveGVkVmFsdWUgJiYgYm94ZWRWYWx1ZS53cmFwcGVkO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gd3JhcHBlZCA/IG9ic2VydmFibGVfMS5XcmFwcGVkVmFsdWUudW53cmFwKGJveGVkVmFsdWUpIDogYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzW2NvZXJjZUtleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IGNvZXJjZUNhbGxiYWNrKHRoaXMsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh3cmFwcGVkIHx8IGNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tzZXROYXRpdmVdKHRoaXNbZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2RlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0oZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tzZXROYXRpdmVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXSA9IHByb3BlcnR5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB0aGlzW2dldERlZmF1bHRdID8gdGhpc1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc0xpc3RlbmVycyhldmVudE5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWZmZWN0c0xheW91dCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlcXVlc3RMYXlvdXQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZG9tTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9tTm9kZS5hdHRyaWJ1dGVSZW1vdmVkKHByb3BlcnR5TmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmRvbU5vZGUuYXR0cmlidXRlTW9kaWZpZWQocHJvcGVydHlOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIENvZXJjaWJsZVByb3BlcnR5O1xufShQcm9wZXJ0eSkpO1xuZXhwb3J0cy5Db2VyY2libGVQcm9wZXJ0eSA9IENvZXJjaWJsZVByb3BlcnR5O1xudmFyIEluaGVyaXRlZFByb3BlcnR5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW5oZXJpdGVkUHJvcGVydHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5oZXJpdGVkUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICB2YXIgbmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdmFyIGtleSA9IF90aGlzLmtleTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gU3ltYm9sKG5hbWUgKyBcIjp2YWx1ZVNvdXJjZUtleVwiKTtcbiAgICAgICAgX3RoaXMuc291cmNlS2V5ID0gc291cmNlS2V5O1xuICAgICAgICB2YXIgc2V0QmFzZSA9IF90aGlzLnNldDtcbiAgICAgICAgdmFyIHNldEZ1bmMgPSBmdW5jdGlvbiAodmFsdWVTb3VyY2UpIHsgcmV0dXJuIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHVuYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZVNvdXJjZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdGhhdC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudF8xICYmIHBhcmVudF8xW3NvdXJjZUtleV0gIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdW5ib3hlZFZhbHVlID0gcGFyZW50XzFbbmFtZV07XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlU291cmNlID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVuYm94ZWRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVTb3VyY2UgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHVuYm94ZWRWYWx1ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlU291cmNlID0gdmFsdWVTb3VyY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3VycmVudFZhbHVlID0gdGhhdFtrZXldO1xuICAgICAgICAgICAgc2V0QmFzZS5jYWxsKHRoYXQsIHVuYm94ZWRWYWx1ZSk7XG4gICAgICAgICAgICB2YXIgbmV3VmFsdWUgPSB0aGF0W2tleV07XG4gICAgICAgICAgICB0aGF0W3NvdXJjZUtleV0gPSBuZXdWYWx1ZVNvdXJjZTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc2V0XzEgPSBuZXdWYWx1ZVNvdXJjZSA9PT0gMDtcbiAgICAgICAgICAgICAgICB0aGF0LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkVmFsdWVTb3VyY2UgPSBjaGlsZFtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNldF8xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRWYWx1ZVNvdXJjZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldEZ1bmMuY2FsbChjaGlsZCwgZXhwb3J0cy51bnNldFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZFZhbHVlU291cmNlIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKGNoaWxkLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07IH07XG4gICAgICAgIHZhciBzZXRJbmhlcml0ZWRWYWx1ZSA9IHNldEZ1bmMoMSk7XG4gICAgICAgIF90aGlzLnNldEluaGVyaXRlZFZhbHVlID0gc2V0SW5oZXJpdGVkVmFsdWU7XG4gICAgICAgIF90aGlzLnNldCA9IHNldEZ1bmMoMyk7XG4gICAgICAgIGluaGVyaXRhYmxlUHJvcGVydGllcy5wdXNoKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gSW5oZXJpdGVkUHJvcGVydHk7XG59KFByb3BlcnR5KSk7XG5leHBvcnRzLkluaGVyaXRlZFByb3BlcnR5ID0gSW5oZXJpdGVkUHJvcGVydHk7XG52YXIgQ3NzUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENzc1Byb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHByb3BlcnR5TmFtZSA9IG9wdGlvbnMubmFtZTtcbiAgICAgICAgdGhpcy5uYW1lID0gcHJvcGVydHlOYW1lO1xuICAgICAgICBjc3NQcm9wZXJ0eU5hbWVzLnB1c2gob3B0aW9ucy5jc3NOYW1lKTtcbiAgICAgICAgdGhpcy5jc3NOYW1lID0gXCJjc3M6XCIgKyBvcHRpb25zLmNzc05hbWU7XG4gICAgICAgIHRoaXMuY3NzTG9jYWxOYW1lID0gb3B0aW9ucy5jc3NOYW1lO1xuICAgICAgICB2YXIga2V5ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnByb3BlcnR5S2V5XCIpO1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjp2YWx1ZVNvdXJjZUtleVwiKTtcbiAgICAgICAgdGhpcy5zb3VyY2VLZXkgPSBzb3VyY2VLZXk7XG4gICAgICAgIHZhciBnZXREZWZhdWx0ID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOmdldERlZmF1bHRcIik7XG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdCA9IGdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBTeW1ib2wocHJvcGVydHlOYW1lICsgXCI6c2V0TmF0aXZlXCIpO1xuICAgICAgICB0aGlzLnNldE5hdGl2ZSA9IHNldE5hdGl2ZTtcbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpuYXRpdmVEZWZhdWx0VmFsdWVcIik7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlS2V5ID0gZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHRoaXMuZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgZXZlbnROYW1lID0gcHJvcGVydHlOYW1lICsgXCJDaGFuZ2VcIjtcbiAgICAgICAgdmFyIGFmZmVjdHNMYXlvdXQgPSBvcHRpb25zLmFmZmVjdHNMYXlvdXQ7XG4gICAgICAgIHZhciBlcXVhbGl0eUNvbXBhcmVyID0gb3B0aW9ucy5lcXVhbGl0eUNvbXBhcmVyO1xuICAgICAgICB2YXIgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQ7XG4gICAgICAgIHZhciB2YWx1ZUNvbnZlcnRlciA9IG9wdGlvbnMudmFsdWVDb252ZXJ0ZXI7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIHNldExvY2FsVmFsdWUobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlc2V0ID0gbmV3VmFsdWUgPT09IGV4cG9ydHMudW5zZXRWYWx1ZSB8fCBuZXdWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgIHZhciB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW3NvdXJjZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzW3NvdXJjZUtleV0gPSAzO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIikgP1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNvbnZlcnRlcihuZXdWYWx1ZSkgOlxuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIHNldENzc1ZhbHVlKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSB0aGlzW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPT09IDMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBuZXdWYWx1ZSA9PT0gZXhwb3J0cy51bnNldFZhbHVlIHx8IG5ld1ZhbHVlID09PSBcIlwiO1xuICAgICAgICAgICAgdmFyIHZhbHVlO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbc291cmNlS2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiID9cbiAgICAgICAgICAgICAgICAgICAgdmFsdWVDb252ZXJ0ZXIobmV3VmFsdWUpIDpcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBvbGRWYWx1ZSA9IGtleSBpbiB0aGlzID8gdGhpc1trZXldIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzW2tleV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZUNoYW5nZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlQ2hhbmdlZCh0aGlzLCBvbGRWYWx1ZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3W3NldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZGVkVXBkYXRlcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGhpcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tkZWZhdWx0VmFsdWVLZXldID0gdmlld1tnZXREZWZhdWx0XSA/IHZpZXdbZ2V0RGVmYXVsdF0oKSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNMaXN0ZW5lcnMoZXZlbnROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeSh7IG9iamVjdDogdGhpcywgZXZlbnROYW1lOiBldmVudE5hbWUsIHByb3BlcnR5TmFtZTogcHJvcGVydHlOYW1lLCB2YWx1ZTogdmFsdWUsIG9sZFZhbHVlOiBvbGRWYWx1ZSB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFmZmVjdHNMYXlvdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXkgaW4gdGhpcyA/IHRoaXNba2V5XSA6IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNzc1ZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgICAgIHNldDogc2V0Q3NzVmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IGdldCxcbiAgICAgICAgICAgIHNldDogc2V0TG9jYWxWYWx1ZVxuICAgICAgICB9O1xuICAgICAgICBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtrZXldID0gdGhpcztcbiAgICB9XG4gICAgQ3NzUHJvcGVydHkucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBpZiAodGhpcy5yZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIHRoaXMubmFtZSArIFwiIGFscmVhZHkgcmVnaXN0ZXJlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMubmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc05hbWUsIHRoaXMuY3NzVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgaWYgKHRoaXMuY3NzTG9jYWxOYW1lICE9PSB0aGlzLmNzc05hbWUpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc0xvY2FsTmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc1Byb3BlcnR5LnByb3RvdHlwZS5pc1NldCA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXkgaW4gaW5zdGFuY2U7XG4gICAgfTtcbiAgICByZXR1cm4gQ3NzUHJvcGVydHk7XG59KCkpO1xuZXhwb3J0cy5Dc3NQcm9wZXJ0eSA9IENzc1Byb3BlcnR5O1xuQ3NzUHJvcGVydHkucHJvdG90eXBlLmlzU3R5bGVQcm9wZXJ0eSA9IHRydWU7XG52YXIgQ3NzQW5pbWF0aW9uUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENzc0FuaW1hdGlvblByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIHZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlciwgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlciwgdmFsdWVDaGFuZ2VkID0gb3B0aW9ucy52YWx1ZUNoYW5nZWQsIGRlZmF1bHRWYWx1ZSA9IG9wdGlvbnMuZGVmYXVsdFZhbHVlO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB0aGlzLm5hbWUgPSBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIGNzc1Byb3BlcnR5TmFtZXMucHVzaChvcHRpb25zLmNzc05hbWUpO1xuICAgICAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzW3Byb3BlcnR5TmFtZV0gPSB0aGlzO1xuICAgICAgICBpZiAob3B0aW9ucy5jc3NOYW1lICYmIG9wdGlvbnMuY3NzTmFtZSAhPT0gcHJvcGVydHlOYW1lKSB7XG4gICAgICAgICAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzW29wdGlvbnMuY3NzTmFtZV0gPSB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3ZhbHVlQ29udmVydGVyID0gb3B0aW9ucy52YWx1ZUNvbnZlcnRlcjtcbiAgICAgICAgdmFyIGNzc0xvY2FsTmFtZSA9IChvcHRpb25zLmNzc05hbWUgfHwgcHJvcGVydHlOYW1lKTtcbiAgICAgICAgdGhpcy5jc3NMb2NhbE5hbWUgPSBjc3NMb2NhbE5hbWU7XG4gICAgICAgIHZhciBjc3NOYW1lID0gXCJjc3M6XCIgKyBjc3NMb2NhbE5hbWU7XG4gICAgICAgIHRoaXMuY3NzTmFtZSA9IGNzc05hbWU7XG4gICAgICAgIHZhciBrZXlmcmFtZU5hbWUgPSBcImtleWZyYW1lOlwiICsgcHJvcGVydHlOYW1lO1xuICAgICAgICB0aGlzLmtleWZyYW1lID0ga2V5ZnJhbWVOYW1lO1xuICAgICAgICB2YXIgZGVmYXVsdE5hbWUgPSBcImRlZmF1bHQ6XCIgKyBwcm9wZXJ0eU5hbWU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBTeW1ib2woZGVmYXVsdE5hbWUpO1xuICAgICAgICB0aGlzLmRlZmF1bHRWYWx1ZUtleSA9IGRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VmFsdWUgPSBkZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBjc3NWYWx1ZSA9IFN5bWJvbChjc3NOYW1lKTtcbiAgICAgICAgdmFyIHN0eWxlVmFsdWUgPSBTeW1ib2woXCJsb2NhbDpcIiArIHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHZhciBrZXlmcmFtZVZhbHVlID0gU3ltYm9sKGtleWZyYW1lTmFtZSk7XG4gICAgICAgIHZhciBjb21wdXRlZFZhbHVlID0gU3ltYm9sKFwiY29tcHV0ZWQtdmFsdWU6XCIgKyBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICB0aGlzLmtleSA9IGNvbXB1dGVkVmFsdWU7XG4gICAgICAgIHZhciBjb21wdXRlZFNvdXJjZSA9IFN5bWJvbChcImNvbXB1dGVkLXNvdXJjZTpcIiArIHByb3BlcnR5TmFtZSk7XG4gICAgICAgIHRoaXMuc291cmNlID0gY29tcHV0ZWRTb3VyY2U7XG4gICAgICAgIHRoaXMuZ2V0RGVmYXVsdCA9IFN5bWJvbChwcm9wZXJ0eU5hbWUgKyBcIjpnZXREZWZhdWx0XCIpO1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IHRoaXMuZ2V0RGVmYXVsdDtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IHRoaXMuc2V0TmF0aXZlID0gU3ltYm9sKHByb3BlcnR5TmFtZSArIFwiOnNldE5hdGl2ZVwiKTtcbiAgICAgICAgdmFyIGV2ZW50TmFtZSA9IHByb3BlcnR5TmFtZSArIFwiQ2hhbmdlXCI7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHRoaXM7XG4gICAgICAgIGZ1bmN0aW9uIGRlc2NyaXB0b3Ioc3ltYm9sLCBwcm9wZXJ0eVNvdXJjZSwgZW51bWVyYWJsZSwgY29uZmlndXJhYmxlLCBnZXRzQ29tcHV0ZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogZW51bWVyYWJsZSwgY29uZmlndXJhYmxlOiBjb25maWd1cmFibGUsXG4gICAgICAgICAgICAgICAgZ2V0OiBnZXRzQ29tcHV0ZWQgPyBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzW2NvbXB1dGVkVmFsdWVdOyB9IDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpc1tzeW1ib2xdOyB9LFxuICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKGJveGVkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShib3hlZFZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0gdGhpc1tjb21wdXRlZFZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9sZFNvdXJjZSA9IHRoaXNbY29tcHV0ZWRTb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgd2FzU2V0ID0gb2xkU291cmNlICE9PSAwO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzZXQgPSBib3hlZFZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUgfHwgYm94ZWRWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3N5bWJvbF0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1tjb21wdXRlZFNvdXJjZV0gPT09IHByb3BlcnR5U291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbc3R5bGVWYWx1ZV0gIT09IGV4cG9ydHMudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkU291cmNlXSA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRWYWx1ZV0gPSB0aGlzW3N0eWxlVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzW2Nzc1ZhbHVlXSAhPT0gZXhwb3J0cy51bnNldFZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbY29tcHV0ZWRTb3VyY2VdID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFZhbHVlXSA9IHRoaXNbY3NzVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbY29tcHV0ZWRTb3VyY2VdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tjb21wdXRlZFZhbHVlXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVDb252ZXJ0ZXIgJiYgdHlwZW9mIGJveGVkVmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3hlZFZhbHVlID0gdmFsdWVDb252ZXJ0ZXIoYm94ZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzW3N5bWJvbF0gPSBib3hlZFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXNbY29tcHV0ZWRTb3VyY2VdIDw9IHByb3BlcnR5U291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1tjb21wdXRlZFNvdXJjZV0gPSBwcm9wZXJ0eVNvdXJjZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2NvbXB1dGVkVmFsdWVdID0gYm94ZWRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzW2NvbXB1dGVkVmFsdWVdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gdGhpc1tjb21wdXRlZFNvdXJjZV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpc1NldCA9IHNvdXJjZSAhPT0gMDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXB1dGVkVmFsdWVDaGFuZ2VkID0gb2xkVmFsdWUgIT09IHZhbHVlICYmICghZXF1YWxpdHlDb21wYXJlciB8fCAhZXF1YWxpdHlDb21wYXJlcihvbGRWYWx1ZSwgdmFsdWUpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXB1dGVkVmFsdWVDaGFuZ2VkICYmIHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVDaGFuZ2VkKHRoaXMsIG9sZFZhbHVlLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSAmJiAoY29tcHV0ZWRWYWx1ZUNoYW5nZWQgfHwgaXNTZXQgIT09IHdhc1NldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2aWV3Ll9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5fc3VzcGVuZGVkVXBkYXRlc1twcm9wZXJ0eU5hbWVdID0gcHJvcGVydHk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzU2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghd2FzU2V0ICYmICEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHdhc1NldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXB1dGVkVmFsdWVDaGFuZ2VkICYmIHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm90aWZ5KHsgb2JqZWN0OiB0aGlzLCBldmVudE5hbWU6IGV2ZW50TmFtZSwgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsIHZhbHVlOiB2YWx1ZSwgb2xkVmFsdWU6IG9sZFZhbHVlIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZGVmYXVsdFByb3BlcnR5RGVzY3JpcHRvciA9IGRlc2NyaXB0b3IoZGVmYXVsdFZhbHVlS2V5LCAwLCBmYWxzZSwgZmFsc2UsIGZhbHNlKTtcbiAgICAgICAgdmFyIGNzc1Byb3BlcnR5RGVzY3JpcHRvciA9IGRlc2NyaXB0b3IoY3NzVmFsdWUsIDIsIGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICB2YXIgc3R5bGVQcm9wZXJ0eURlc2NyaXB0b3IgPSBkZXNjcmlwdG9yKHN0eWxlVmFsdWUsIDMsIHRydWUsIHRydWUsIHRydWUpO1xuICAgICAgICB2YXIga2V5ZnJhbWVQcm9wZXJ0eURlc2NyaXB0b3IgPSBkZXNjcmlwdG9yKGtleWZyYW1lVmFsdWUsIDQsIGZhbHNlLCBmYWxzZSwgZmFsc2UpO1xuICAgICAgICBzeW1ib2xQcm9wZXJ0eU1hcFtjb21wdXRlZFZhbHVlXSA9IHRoaXM7XG4gICAgICAgIGNzc1N5bWJvbFByb3BlcnR5TWFwW2NvbXB1dGVkVmFsdWVdID0gdGhpcztcbiAgICAgICAgdGhpcy5yZWdpc3RlciA9IGZ1bmN0aW9uIChjbHMpIHtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbY29tcHV0ZWRWYWx1ZV0gPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbY29tcHV0ZWRTb3VyY2VdID0gMDtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVbY3NzVmFsdWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgY2xzLnByb3RvdHlwZVtzdHlsZVZhbHVlXSA9IGV4cG9ydHMudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIGNscy5wcm90b3R5cGVba2V5ZnJhbWVWYWx1ZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgZGVmYXVsdE5hbWUsIGRlZmF1bHRQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIGNzc05hbWUsIGNzc1Byb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoY2xzLnByb3RvdHlwZSwgcHJvcGVydHlOYW1lLCBzdHlsZVByb3BlcnR5RGVzY3JpcHRvcik7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5jc3NOYW1lICYmIG9wdGlvbnMuY3NzTmFtZSAhPT0gb3B0aW9ucy5uYW1lKSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIG9wdGlvbnMuY3NzTmFtZSwgc3R5bGVQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIGtleWZyYW1lTmFtZSwga2V5ZnJhbWVQcm9wZXJ0eURlc2NyaXB0b3IpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm90b3R5cGUuX2luaXREZWZhdWx0TmF0aXZlVmFsdWUgPSBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIl9pbml0RGVmYXVsdE5hdGl2ZVZhbHVlIG5vdCBleGVjdXRlZCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IHRoaXMuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdGFyZ2V0KSkge1xuICAgICAgICAgICAgdmFyIGdldERlZmF1bHQgPSB0aGlzLmdldERlZmF1bHQ7XG4gICAgICAgICAgICB0YXJnZXRbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiB0aGlzLmRlZmF1bHRWYWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkuX2dldEJ5Q3NzTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BlcnRpZXNbbmFtZV07XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5fZ2V0UHJvcGVydHlOYW1lcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKENzc0FuaW1hdGlvblByb3BlcnR5LnByb3BlcnRpZXMpO1xuICAgIH07XG4gICAgQ3NzQW5pbWF0aW9uUHJvcGVydHkucHJvdG90eXBlLmlzU2V0ID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiBpbnN0YW5jZVt0aGlzLnNvdXJjZV0gIT09IDA7XG4gICAgfTtcbiAgICBDc3NBbmltYXRpb25Qcm9wZXJ0eS5wcm9wZXJ0aWVzID0ge307XG4gICAgcmV0dXJuIENzc0FuaW1hdGlvblByb3BlcnR5O1xufSgpKTtcbmV4cG9ydHMuQ3NzQW5pbWF0aW9uUHJvcGVydHkgPSBDc3NBbmltYXRpb25Qcm9wZXJ0eTtcbkNzc0FuaW1hdGlvblByb3BlcnR5LnByb3RvdHlwZS5pc1N0eWxlUHJvcGVydHkgPSB0cnVlO1xudmFyIEluaGVyaXRlZENzc1Byb3BlcnR5ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoSW5oZXJpdGVkQ3NzUHJvcGVydHksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW5oZXJpdGVkQ3NzUHJvcGVydHkob3B0aW9ucykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKSB8fCB0aGlzO1xuICAgICAgICB2YXIgcHJvcGVydHlOYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB2YXIga2V5ID0gX3RoaXMua2V5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gX3RoaXMuc291cmNlS2V5O1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IF90aGlzLmdldERlZmF1bHQ7XG4gICAgICAgIHZhciBzZXROYXRpdmUgPSBfdGhpcy5zZXROYXRpdmU7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVLZXkgPSBfdGhpcy5kZWZhdWx0VmFsdWVLZXk7XG4gICAgICAgIHZhciBldmVudE5hbWUgPSBwcm9wZXJ0eU5hbWUgKyBcIkNoYW5nZVwiO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gb3B0aW9ucy5kZWZhdWx0VmFsdWU7XG4gICAgICAgIHZhciBhZmZlY3RzTGF5b3V0ID0gb3B0aW9ucy5hZmZlY3RzTGF5b3V0O1xuICAgICAgICB2YXIgZXF1YWxpdHlDb21wYXJlciA9IG9wdGlvbnMuZXF1YWxpdHlDb21wYXJlcjtcbiAgICAgICAgdmFyIHZhbHVlQ2hhbmdlZCA9IG9wdGlvbnMudmFsdWVDaGFuZ2VkO1xuICAgICAgICB2YXIgdmFsdWVDb252ZXJ0ZXIgPSBvcHRpb25zLnZhbHVlQ29udmVydGVyO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBfdGhpcztcbiAgICAgICAgdmFyIHNldEZ1bmMgPSBmdW5jdGlvbiAodmFsdWVTb3VyY2UpIHsgcmV0dXJuIGZ1bmN0aW9uIChib3hlZFZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoYm94ZWRWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVzZXQgPSBib3hlZFZhbHVlID09PSBleHBvcnRzLnVuc2V0VmFsdWUgfHwgYm94ZWRWYWx1ZSA9PT0gXCJcIjtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSB0aGlzW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgIGlmIChyZXNldCkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZVNvdXJjZSA9PT0gMiAmJiBjdXJyZW50VmFsdWVTb3VyY2UgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPiB2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG9sZFZhbHVlID0ga2V5IGluIHRoaXMgPyB0aGlzW2tleV0gOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB2YXIgdmFsdWU7XG4gICAgICAgICAgICB2YXIgdW5zZXROYXRpdmVWYWx1ZSA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8yID0gdmlldy5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgdmFyIHN0eWxlID0gcGFyZW50XzIgPyBwYXJlbnRfMi5zdHlsZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKHN0eWxlICYmIHN0eWxlW3NvdXJjZUtleV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gc3R5bGVbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gMTtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRlZmF1bHRWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNbc291cmNlS2V5XTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgdW5zZXROYXRpdmVWYWx1ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpc1tzb3VyY2VLZXldID0gdmFsdWVTb3VyY2U7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ29udmVydGVyICYmIHR5cGVvZiBib3hlZFZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmFsdWVDb252ZXJ0ZXIoYm94ZWRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGJveGVkVmFsdWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBlcXVhbGl0eUNvbXBhcmVyID8gIWVxdWFsaXR5Q29tcGFyZXIob2xkVmFsdWUsIHZhbHVlKSA6IG9sZFZhbHVlICE9PSB2YWx1ZTtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlQ2hhbmdlZCkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZUNoYW5nZWQodGhpcywgb2xkVmFsdWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlldy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzW3Byb3BlcnR5TmFtZV0gPSBwcm9wZXJ0eTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh1bnNldE5hdGl2ZVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlZmF1bHRWYWx1ZUtleSBpbiB0aGlzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh0aGlzW2RlZmF1bHRWYWx1ZUtleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGhpc1tkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1tzZXROYXRpdmVdKGRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHRoaXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzTGlzdGVuZXJzKGV2ZW50TmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ub3RpZnkoeyBvYmplY3Q6IHRoaXMsIGV2ZW50TmFtZTogZXZlbnROYW1lLCBwcm9wZXJ0eU5hbWU6IHByb3BlcnR5TmFtZSwgdmFsdWU6IHZhbHVlLCBvbGRWYWx1ZTogb2xkVmFsdWUgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhZmZlY3RzTGF5b3V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2aWV3LmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZC5zdHlsZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoaWxkVmFsdWVTb3VyY2UgPSBjaGlsZFN0eWxlW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hpbGRWYWx1ZVNvdXJjZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldERlZmF1bHRGdW5jLmNhbGwoY2hpbGRTdHlsZSwgZXhwb3J0cy51bnNldFZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZFZhbHVlU291cmNlIDw9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRJbmhlcml0ZWRGdW5jLmNhbGwoY2hpbGRTdHlsZSwgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9OyB9O1xuICAgICAgICB2YXIgc2V0RGVmYXVsdEZ1bmMgPSBzZXRGdW5jKDApO1xuICAgICAgICB2YXIgc2V0SW5oZXJpdGVkRnVuYyA9IHNldEZ1bmMoMSk7XG4gICAgICAgIF90aGlzLnNldEluaGVyaXRlZFZhbHVlID0gc2V0SW5oZXJpdGVkRnVuYztcbiAgICAgICAgX3RoaXMuY3NzVmFsdWVEZXNjcmlwdG9yLnNldCA9IHNldEZ1bmMoMik7XG4gICAgICAgIF90aGlzLmxvY2FsVmFsdWVEZXNjcmlwdG9yLnNldCA9IHNldEZ1bmMoMyk7XG4gICAgICAgIGluaGVyaXRhYmxlQ3NzUHJvcGVydGllcy5wdXNoKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICByZXR1cm4gSW5oZXJpdGVkQ3NzUHJvcGVydHk7XG59KENzc1Byb3BlcnR5KSk7XG5leHBvcnRzLkluaGVyaXRlZENzc1Byb3BlcnR5ID0gSW5oZXJpdGVkQ3NzUHJvcGVydHk7XG52YXIgU2hvcnRoYW5kUHJvcGVydHkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNob3J0aGFuZFByb3BlcnR5KG9wdGlvbnMpIHtcbiAgICAgICAgdGhpcy5uYW1lID0gb3B0aW9ucy5uYW1lO1xuICAgICAgICB2YXIga2V5ID0gU3ltYm9sKHRoaXMubmFtZSArIFwiOnByb3BlcnR5S2V5XCIpO1xuICAgICAgICB0aGlzLmtleSA9IGtleTtcbiAgICAgICAgdGhpcy5jc3NOYW1lID0gXCJjc3M6XCIgKyBvcHRpb25zLmNzc05hbWU7XG4gICAgICAgIHRoaXMuY3NzTG9jYWxOYW1lID0gXCJcIiArIG9wdGlvbnMuY3NzTmFtZTtcbiAgICAgICAgdmFyIGNvbnZlcnRlciA9IG9wdGlvbnMuY29udmVydGVyO1xuICAgICAgICBmdW5jdGlvbiBzZXRMb2NhbFZhbHVlKHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwic2V0TG9jYWxWYWx1ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXcuX2JhdGNoVXBkYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29udmVydGVyKHZhbHVlKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBwID0gX2JbMF0sIHYgPSBfYlsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXNbcC5uYW1lXSA9IHY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gc2V0Q3NzVmFsdWUodmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICghdmlldykge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJzZXRDc3NWYWx1ZSBub3QgZXhlY3V0ZWQgdG8gdmlldyBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZpZXcuX2JhdGNoVXBkYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gY29udmVydGVyKHZhbHVlKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9iID0gX2FbX2ldLCBwID0gX2JbMF0sIHYgPSBfYlsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXNbcC5jc3NOYW1lXSA9IHY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jc3NWYWx1ZURlc2NyaXB0b3IgPSB7XG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgZ2V0OiBvcHRpb25zLmdldHRlcixcbiAgICAgICAgICAgIHNldDogc2V0Q3NzVmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvciA9IHtcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBnZXQ6IG9wdGlvbnMuZ2V0dGVyLFxuICAgICAgICAgICAgc2V0OiBzZXRMb2NhbFZhbHVlXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJvcGVydHlCYWdEZXNjcmlwdG9yID0ge1xuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgY29udmVydGVyKHZhbHVlKS5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBfYVswXSwgdmFsdWUgPSBfYVsxXTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXNbcHJvcGVydHkuY3NzTG9jYWxOYW1lXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtrZXldID0gdGhpcztcbiAgICB9XG4gICAgU2hvcnRoYW5kUHJvcGVydHkucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGNscykge1xuICAgICAgICBpZiAodGhpcy5yZWdpc3RlcmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQcm9wZXJ0eSBcIiArIHRoaXMubmFtZSArIFwiIGFscmVhZHkgcmVnaXN0ZXJlZC5cIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZWdpc3RlcmVkID0gdHJ1ZTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUsIHRoaXMubmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc05hbWUsIHRoaXMuY3NzVmFsdWVEZXNjcmlwdG9yKTtcbiAgICAgICAgaWYgKHRoaXMuY3NzTG9jYWxOYW1lICE9PSB0aGlzLmNzc05hbWUpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjbHMucHJvdG90eXBlLCB0aGlzLmNzc0xvY2FsTmFtZSwgdGhpcy5sb2NhbFZhbHVlRGVzY3JpcHRvcik7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGNscy5wcm90b3R5cGUuUHJvcGVydHlCYWcsIHRoaXMuY3NzTG9jYWxOYW1lLCB0aGlzLnByb3BlcnR5QmFnRGVzY3JpcHRvcik7XG4gICAgfTtcbiAgICByZXR1cm4gU2hvcnRoYW5kUHJvcGVydHk7XG59KCkpO1xuZXhwb3J0cy5TaG9ydGhhbmRQcm9wZXJ0eSA9IFNob3J0aGFuZFByb3BlcnR5O1xuZnVuY3Rpb24gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc09uKHZpZXcpIHtcbiAgICB2YXIgYXJyYXkgPSBuZXcgQXJyYXkoKTtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlUHJvcGVydGllc18xID0gaW5oZXJpdGFibGVQcm9wZXJ0aWVzOyBfaSA8IGluaGVyaXRhYmxlUHJvcGVydGllc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlUHJvcGVydGllc18xW19pXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICB2YXIgdmFsdWVTb3VyY2UgPSB2aWV3W3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgaWYgKHZhbHVlU291cmNlICE9PSAwKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKHsgcHJvcGVydHk6IHByb3AsIHZhbHVlOiB2aWV3W3Byb3AubmFtZV0gfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZnVuY3Rpb24gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc09uKHN0eWxlKSB7XG4gICAgdmFyIGFycmF5ID0gbmV3IEFycmF5KCk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMSA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllczsgX2kgPCBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHByb3AgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnRpZXNfMVtfaV07XG4gICAgICAgIHZhciBzb3VyY2VLZXkgPSBwcm9wLnNvdXJjZUtleTtcbiAgICAgICAgdmFyIHZhbHVlU291cmNlID0gc3R5bGVbc291cmNlS2V5XSB8fCAwO1xuICAgICAgICBpZiAodmFsdWVTb3VyY2UgIT09IDApIHtcbiAgICAgICAgICAgIGFycmF5LnB1c2goeyBwcm9wZXJ0eTogcHJvcCwgdmFsdWU6IHN0eWxlW3Byb3AubmFtZV0gfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xufVxuZXhwb3J0cy5pbml0TmF0aXZlVmlldyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwicHJvcGVydGllc1xcXCIuaW5pdE5hdGl2ZVZpZXdcIiwgZnVuY3Rpb24gaW5pdE5hdGl2ZVZpZXcodmlldykge1xuICAgIGlmICh2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgIGFwcGx5UGVuZGluZ05hdGl2ZVNldHRlcnModmlldyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBhcHBseUFsbE5hdGl2ZVNldHRlcnModmlldyk7XG4gICAgfVxuICAgIHZpZXcuX3N1c3BlbmRlZFVwZGF0ZXMgPSB7fTtcbn0pO1xuZnVuY3Rpb24gYXBwbHlQZW5kaW5nTmF0aXZlU2V0dGVycyh2aWV3KSB7XG4gICAgdmFyIHN1c3BlbmRlZFVwZGF0ZXMgPSB2aWV3Ll9zdXNwZW5kZWRVcGRhdGVzO1xuICAgIGZvciAodmFyIHByb3BlcnR5TmFtZSBpbiBzdXNwZW5kZWRVcGRhdGVzKSB7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHN1c3BlbmRlZFVwZGF0ZXNbcHJvcGVydHlOYW1lXTtcbiAgICAgICAgdmFyIHNldE5hdGl2ZSA9IHByb3BlcnR5LnNldE5hdGl2ZTtcbiAgICAgICAgaWYgKHZpZXdbc2V0TmF0aXZlXSkge1xuICAgICAgICAgICAgdmFyIGdldERlZmF1bHQgPSBwcm9wZXJ0eS5nZXREZWZhdWx0LCBpc1N0eWxlUHJvcGVydHkgPSBwcm9wZXJ0eS5pc1N0eWxlUHJvcGVydHksIGRlZmF1bHRWYWx1ZUtleSA9IHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleSwgZGVmYXVsdFZhbHVlID0gcHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGlzU3R5bGVQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5LmlzU2V0KHZpZXcuc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiBzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W2dldERlZmF1bHRdID8gdmlld1tnZXREZWZhdWx0XSgpIDogZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdmlldy5zdHlsZVtwcm9wZXJ0eU5hbWVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBzdHlsZVtkZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5pc1NldCh2aWV3KSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIShkZWZhdWx0VmFsdWVLZXkgaW4gdmlldykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBkZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2aWV3W3Byb3BlcnR5TmFtZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHZpZXdbZGVmYXVsdFZhbHVlS2V5XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5hcHBseVBlbmRpbmdOYXRpdmVTZXR0ZXJzID0gYXBwbHlQZW5kaW5nTmF0aXZlU2V0dGVycztcbmZ1bmN0aW9uIGFwcGx5QWxsTmF0aXZlU2V0dGVycyh2aWV3KSB7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc18yID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzJbX2ldO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBzeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2V0TmF0aXZlID0gcHJvcGVydHkuc2V0TmF0aXZlO1xuICAgICAgICB2YXIgZ2V0RGVmYXVsdCA9IHByb3BlcnR5LmdldERlZmF1bHQ7XG4gICAgICAgIGlmIChzZXROYXRpdmUgaW4gdmlldykge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZUtleSA9IHByb3BlcnR5LmRlZmF1bHRWYWx1ZUtleTtcbiAgICAgICAgICAgIGlmICghKGRlZmF1bHRWYWx1ZUtleSBpbiB2aWV3KSkge1xuICAgICAgICAgICAgICAgIHZpZXdbZGVmYXVsdFZhbHVlS2V5XSA9IHZpZXdbZ2V0RGVmYXVsdF0gPyB2aWV3W2dldERlZmF1bHRdKCkgOiBwcm9wZXJ0eS5kZWZhdWx0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB2aWV3W3N5bWJvbF07XG4gICAgICAgICAgICB2aWV3W3NldE5hdGl2ZV0odmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBzdHlsZSA9IHZpZXcuc3R5bGU7XG4gICAgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc3R5bGUpO1xuICAgIGZvciAodmFyIF9hID0gMCwgc3ltYm9sc18zID0gc3ltYm9sczsgX2EgPCBzeW1ib2xzXzMubGVuZ3RoOyBfYSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzNbX2FdO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBjc3NTeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdFZhbHVlS2V5ID0gcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5O1xuICAgICAgICAgICAgaWYgKCEoZGVmYXVsdFZhbHVlS2V5IGluIHN0eWxlKSkge1xuICAgICAgICAgICAgICAgIHN0eWxlW2RlZmF1bHRWYWx1ZUtleV0gPSB2aWV3W3Byb3BlcnR5LmdldERlZmF1bHRdID8gdmlld1twcm9wZXJ0eS5nZXREZWZhdWx0XSgpIDogcHJvcGVydHkuZGVmYXVsdFZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHZhbHVlID0gc3R5bGVbc3ltYm9sXTtcbiAgICAgICAgICAgIHZpZXdbcHJvcGVydHkuc2V0TmF0aXZlXSh2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLmFwcGx5QWxsTmF0aXZlU2V0dGVycyA9IGFwcGx5QWxsTmF0aXZlU2V0dGVycztcbmZ1bmN0aW9uIHJlc2V0TmF0aXZlVmlldyh2aWV3KSB7XG4gICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc180ID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzQubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzRbX2ldO1xuICAgICAgICB2YXIgcHJvcGVydHkgPSBzeW1ib2xQcm9wZXJ0eU1hcFtzeW1ib2xdO1xuICAgICAgICBpZiAoIXByb3BlcnR5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICBpZiAocHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5IGluIHZpZXcpIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0odmlld1twcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXldKTtcbiAgICAgICAgICAgICAgICBkZWxldGUgdmlld1twcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlld1twcm9wZXJ0eS5zZXROYXRpdmVdKHByb3BlcnR5LmRlZmF1bHRWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzdHlsZSk7XG4gICAgZm9yICh2YXIgX2EgPSAwLCBzeW1ib2xzXzUgPSBzeW1ib2xzOyBfYSA8IHN5bWJvbHNfNS5sZW5ndGg7IF9hKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfNVtfYV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IGNzc1N5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0pIHtcbiAgICAgICAgICAgIGlmIChwcm9wZXJ0eS5kZWZhdWx0VmFsdWVLZXkgaW4gc3R5bGUpIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0oc3R5bGVbcHJvcGVydHkuZGVmYXVsdFZhbHVlS2V5XSk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHN0eWxlW3Byb3BlcnR5LmRlZmF1bHRWYWx1ZUtleV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2aWV3W3Byb3BlcnR5LnNldE5hdGl2ZV0ocHJvcGVydHkuZGVmYXVsdFZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucmVzZXROYXRpdmVWaWV3ID0gcmVzZXROYXRpdmVWaWV3O1xuZnVuY3Rpb24gY2xlYXJJbmhlcml0ZWRQcm9wZXJ0aWVzKHZpZXcpIHtcbiAgICBmb3IgKHZhciBfaSA9IDAsIGluaGVyaXRhYmxlUHJvcGVydGllc18yID0gaW5oZXJpdGFibGVQcm9wZXJ0aWVzOyBfaSA8IGluaGVyaXRhYmxlUHJvcGVydGllc18yLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlUHJvcGVydGllc18yW19pXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICBpZiAodmlld1tzb3VyY2VLZXldID09PSAxKSB7XG4gICAgICAgICAgICBwcm9wLnNldC5jYWxsKHZpZXcsIGV4cG9ydHMudW5zZXRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBmb3IgKHZhciBfYSA9IDAsIGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18yID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzOyBfYSA8IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18yLmxlbmd0aDsgX2ErKykge1xuICAgICAgICB2YXIgcHJvcCA9IGluaGVyaXRhYmxlQ3NzUHJvcGVydGllc18yW19hXTtcbiAgICAgICAgdmFyIHNvdXJjZUtleSA9IHByb3Auc291cmNlS2V5O1xuICAgICAgICBpZiAoc3R5bGVbc291cmNlS2V5XSA9PT0gMSkge1xuICAgICAgICAgICAgcHJvcC5zZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKHN0eWxlLCBleHBvcnRzLnVuc2V0VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZXhwb3J0cy5jbGVhckluaGVyaXRlZFByb3BlcnRpZXMgPSBjbGVhckluaGVyaXRlZFByb3BlcnRpZXM7XG5mdW5jdGlvbiByZXNldENTU1Byb3BlcnRpZXMoc3R5bGUpIHtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoc3R5bGUpO1xuICAgIGZvciAodmFyIF9pID0gMCwgc3ltYm9sc182ID0gc3ltYm9sczsgX2kgPCBzeW1ib2xzXzYubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBzeW1ib2wgPSBzeW1ib2xzXzZbX2ldO1xuICAgICAgICB2YXIgY3NzUHJvcGVydHkgPSB2b2lkIDA7XG4gICAgICAgIGlmIChjc3NQcm9wZXJ0eSA9IGNzc1N5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF0pIHtcbiAgICAgICAgICAgIHN0eWxlW2Nzc1Byb3BlcnR5LmNzc05hbWVdID0gZXhwb3J0cy51bnNldFZhbHVlO1xuICAgICAgICAgICAgaWYgKGNzc1Byb3BlcnR5IGluc3RhbmNlb2YgQ3NzQW5pbWF0aW9uUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICBzdHlsZVtjc3NQcm9wZXJ0eS5rZXlmcmFtZV0gPSBleHBvcnRzLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnJlc2V0Q1NTUHJvcGVydGllcyA9IHJlc2V0Q1NTUHJvcGVydGllcztcbmZ1bmN0aW9uIHByb3BhZ2F0ZUluaGVyaXRhYmxlUHJvcGVydGllcyh2aWV3LCBjaGlsZCkge1xuICAgIHZhciBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzID0gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc09uKHZpZXcpO1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc18xID0gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlczsgX2kgPCBpbmhlcml0YWJsZVByb3BlcnR5VmFsdWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwYWlyID0gaW5oZXJpdGFibGVQcm9wZXJ0eVZhbHVlc18xW19pXTtcbiAgICAgICAgdmFyIHByb3AgPSBwYWlyLnByb3BlcnR5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSBjaGlsZFtzb3VyY2VLZXldIHx8IDA7XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWVTb3VyY2UgPD0gMSkge1xuICAgICAgICAgICAgcHJvcC5zZXRJbmhlcml0ZWRWYWx1ZS5jYWxsKGNoaWxkLCBwYWlyLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucHJvcGFnYXRlSW5oZXJpdGFibGVQcm9wZXJ0aWVzID0gcHJvcGFnYXRlSW5oZXJpdGFibGVQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gcHJvcGFnYXRlSW5oZXJpdGFibGVDc3NQcm9wZXJ0aWVzKHBhcmVudFN0eWxlLCBjaGlsZFN0eWxlKSB7XG4gICAgdmFyIGluaGVyaXRhYmxlQ3NzUHJvcGVydHlWYWx1ZXMgPSBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzT24ocGFyZW50U3R5bGUpO1xuICAgIGZvciAodmFyIF9pID0gMCwgaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc18xID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlczsgX2kgPCBpbmhlcml0YWJsZUNzc1Byb3BlcnR5VmFsdWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwYWlyID0gaW5oZXJpdGFibGVDc3NQcm9wZXJ0eVZhbHVlc18xW19pXTtcbiAgICAgICAgdmFyIHByb3AgPSBwYWlyLnByb3BlcnR5O1xuICAgICAgICB2YXIgc291cmNlS2V5ID0gcHJvcC5zb3VyY2VLZXk7XG4gICAgICAgIHZhciBjdXJyZW50VmFsdWVTb3VyY2UgPSBjaGlsZFN0eWxlW3NvdXJjZUtleV0gfHwgMDtcbiAgICAgICAgaWYgKGN1cnJlbnRWYWx1ZVNvdXJjZSA8PSAxKSB7XG4gICAgICAgICAgICBwcm9wLnNldEluaGVyaXRlZFZhbHVlLmNhbGwoY2hpbGRTdHlsZSwgcGFpci52YWx1ZSwgMSk7XG4gICAgICAgIH1cbiAgICB9XG59XG5leHBvcnRzLnByb3BhZ2F0ZUluaGVyaXRhYmxlQ3NzUHJvcGVydGllcyA9IHByb3BhZ2F0ZUluaGVyaXRhYmxlQ3NzUHJvcGVydGllcztcbmZ1bmN0aW9uIG1ha2VWYWxpZGF0b3IoKSB7XG4gICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhbHVlc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgIH1cbiAgICB2YXIgc2V0ID0gbmV3IFNldCh2YWx1ZXMpO1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHNldC5oYXModmFsdWUpOyB9O1xufVxuZXhwb3J0cy5tYWtlVmFsaWRhdG9yID0gbWFrZVZhbGlkYXRvcjtcbmZ1bmN0aW9uIG1ha2VQYXJzZXIoaXNWYWxpZCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGxvd2VyID0gdmFsdWUgJiYgdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgaWYgKGlzVmFsaWQobG93ZXIpKSB7XG4gICAgICAgICAgICByZXR1cm4gbG93ZXI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH07XG59XG5leHBvcnRzLm1ha2VQYXJzZXIgPSBtYWtlUGFyc2VyO1xuZnVuY3Rpb24gZ2V0U2V0UHJvcGVydGllcyh2aWV3KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHZpZXcpLmZvckVhY2goZnVuY3Rpb24gKHByb3ApIHtcbiAgICAgICAgcmVzdWx0LnB1c2goW3Byb3AsIHZpZXdbcHJvcF1dKTtcbiAgICB9KTtcbiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHModmlldyk7XG4gICAgZm9yICh2YXIgX2kgPSAwLCBzeW1ib2xzXzcgPSBzeW1ib2xzOyBfaSA8IHN5bWJvbHNfNy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgdmFyIHN5bWJvbCA9IHN5bWJvbHNfN1tfaV07XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHN5bWJvbFByb3BlcnR5TWFwW3N5bWJvbF07XG4gICAgICAgIGlmICghcHJvcGVydHkpIHtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2YWx1ZSA9IHZpZXdbcHJvcGVydHkua2V5XTtcbiAgICAgICAgcmVzdWx0LnB1c2goW3Byb3BlcnR5Lm5hbWUsIHZhbHVlXSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldFNldFByb3BlcnRpZXMgPSBnZXRTZXRQcm9wZXJ0aWVzO1xuZnVuY3Rpb24gZ2V0Q29tcHV0ZWRDc3NWYWx1ZXModmlldykge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB2YXIgc3R5bGUgPSB2aWV3LnN0eWxlO1xuICAgIGZvciAodmFyIF9pID0gMCwgY3NzUHJvcGVydHlOYW1lc18xID0gY3NzUHJvcGVydHlOYW1lczsgX2kgPCBjc3NQcm9wZXJ0eU5hbWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHZhciBwcm9wID0gY3NzUHJvcGVydHlOYW1lc18xW19pXTtcbiAgICAgICAgcmVzdWx0LnB1c2goW3Byb3AsIHN0eWxlW3Byb3BdXSk7XG4gICAgfVxuICAgIHJlc3VsdC5wdXNoKFtcInRvcFwiLCBcImF1dG9cIl0pO1xuICAgIHJlc3VsdC5wdXNoKFtcImxlZnRcIiwgXCJhdXRvXCJdKTtcbiAgICByZXN1bHQucHVzaChbXCJib3R0b21cIiwgXCJhdXRvXCJdKTtcbiAgICByZXN1bHQucHVzaChbXCJyaWdodFwiLCBcImF1dG9cIl0pO1xuICAgIHJldHVybiByZXN1bHQ7XG59XG5leHBvcnRzLmdldENvbXB1dGVkQ3NzVmFsdWVzID0gZ2V0Q29tcHV0ZWRDc3NWYWx1ZXM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wcm9wZXJ0aWVzLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL3Byb3BlcnRpZXNcIik7XG52YXIgZGVidWdfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy9kZWJ1Z1wiKTtcbnZhciBiaW5kYWJsZV8xID0gcmVxdWlyZShcIi4uL2JpbmRhYmxlXCIpO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcGxhdGZvcm1cIik7XG5leHBvcnRzLmlzSU9TID0gcGxhdGZvcm1fMS5pc0lPUztcbmV4cG9ydHMuaXNBbmRyb2lkID0gcGxhdGZvcm1fMS5pc0FuZHJvaWQ7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy91dGlsc1wiKTtcbmV4cG9ydHMubGF5b3V0ID0gdXRpbHNfMS5sYXlvdXQ7XG52YXIgc3R5bGVfcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtcHJvcGVydGllc1wiKTtcbnZhciB0eXBlcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciBjb2xvcl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NvbG9yXCIpO1xuZXhwb3J0cy5Db2xvciA9IGNvbG9yXzEuQ29sb3I7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vcHJvZmlsaW5nXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2JpbmRhYmxlXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi9wcm9wZXJ0aWVzXCIpKTtcbnZhciBzc20gPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1zY29wZVwiKTtcbnZhciBkb21Ob2RlTW9kdWxlO1xuZnVuY3Rpb24gZW5zdXJlZG9tTm9kZU1vZHVsZSgpIHtcbiAgICBpZiAoIWRvbU5vZGVNb2R1bGUpIHtcbiAgICAgICAgZG9tTm9kZU1vZHVsZSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9kZWJ1Z2dlci9kb20tbm9kZVwiKTtcbiAgICB9XG59XG52YXIgc3R5bGVTY29wZU1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZVN0eWxlU2NvcGVNb2R1bGUoKSB7XG4gICAgaWYgKCFzdHlsZVNjb3BlTW9kdWxlKSB7XG4gICAgICAgIHN0eWxlU2NvcGVNb2R1bGUgPSByZXF1aXJlKFwidWkvc3R5bGluZy9zdHlsZS1zY29wZVwiKTtcbiAgICB9XG59XG52YXIgZGVmYXVsdEJpbmRpbmdTb3VyY2UgPSB7fTtcbmZ1bmN0aW9uIGdldEFuY2VzdG9yKHZpZXcsIGNyaXRlcmlvbikge1xuICAgIHZhciBtYXRjaGVyID0gbnVsbDtcbiAgICBpZiAodHlwZW9mIGNyaXRlcmlvbiA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBtYXRjaGVyID0gZnVuY3Rpb24gKHZpZXcpIHsgcmV0dXJuIHZpZXcudHlwZU5hbWUgPT09IGNyaXRlcmlvbjsgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG1hdGNoZXIgPSBmdW5jdGlvbiAodmlldykgeyByZXR1cm4gdmlldyBpbnN0YW5jZW9mIGNyaXRlcmlvbjsgfTtcbiAgICB9XG4gICAgZm9yICh2YXIgcGFyZW50XzEgPSB2aWV3LnBhcmVudDsgcGFyZW50XzEgIT0gbnVsbDsgcGFyZW50XzEgPSBwYXJlbnRfMS5wYXJlbnQpIHtcbiAgICAgICAgaWYgKG1hdGNoZXIocGFyZW50XzEpKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyZW50XzE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLmdldEFuY2VzdG9yID0gZ2V0QW5jZXN0b3I7XG5mdW5jdGlvbiBnZXRWaWV3QnlJZCh2aWV3LCBpZCkge1xuICAgIGlmICghdmlldykge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodmlldy5pZCA9PT0gaWQpIHtcbiAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfVxuICAgIHZhciByZXRWYWw7XG4gICAgdmFyIGRlc2NlbmRhbnRzQ2FsbGJhY2sgPSBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgaWYgKGNoaWxkLmlkID09PSBpZCkge1xuICAgICAgICAgICAgcmV0VmFsID0gY2hpbGQ7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBlYWNoRGVzY2VuZGFudCh2aWV3LCBkZXNjZW5kYW50c0NhbGxiYWNrKTtcbiAgICByZXR1cm4gcmV0VmFsO1xufVxuZXhwb3J0cy5nZXRWaWV3QnlJZCA9IGdldFZpZXdCeUlkO1xuZnVuY3Rpb24gZWFjaERlc2NlbmRhbnQodmlldywgY2FsbGJhY2spIHtcbiAgICBpZiAoIWNhbGxiYWNrIHx8ICF2aWV3KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIGNvbnRpbnVlSXRlcmF0aW9uO1xuICAgIHZhciBsb2NhbENhbGxiYWNrID0gZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgIGNvbnRpbnVlSXRlcmF0aW9uID0gY2FsbGJhY2soY2hpbGQpO1xuICAgICAgICBpZiAoY29udGludWVJdGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNoaWxkLmVhY2hDaGlsZChsb2NhbENhbGxiYWNrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29udGludWVJdGVyYXRpb247XG4gICAgfTtcbiAgICB2aWV3LmVhY2hDaGlsZChsb2NhbENhbGxiYWNrKTtcbn1cbmV4cG9ydHMuZWFjaERlc2NlbmRhbnQgPSBlYWNoRGVzY2VuZGFudDtcbnZhciB2aWV3SWRDb3VudGVyID0gMTtcbnZhciBGbGFncztcbihmdW5jdGlvbiAoRmxhZ3MpIHtcbiAgICBGbGFnc1tcInN1cGVyT25Mb2FkZWRDYWxsZWRcIl0gPSBcIkxvYWRlZFwiO1xuICAgIEZsYWdzW1wic3VwZXJPblVubG9hZGVkQ2FsbGVkXCJdID0gXCJVbmxvYWRlZFwiO1xufSkoRmxhZ3MgfHwgKEZsYWdzID0ge30pKTtcbnZhciBTdXNwZW5kVHlwZTtcbihmdW5jdGlvbiAoU3VzcGVuZFR5cGUpIHtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIkluY3JlbWVudGFsXCJdID0gMF0gPSBcIkluY3JlbWVudGFsXCI7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJMb2FkZWRcIl0gPSAxMDQ4NTc2XSA9IFwiTG9hZGVkXCI7XG4gICAgU3VzcGVuZFR5cGVbU3VzcGVuZFR5cGVbXCJOYXRpdmVWaWV3XCJdID0gMjA5NzE1Ml0gPSBcIk5hdGl2ZVZpZXdcIjtcbiAgICBTdXNwZW5kVHlwZVtTdXNwZW5kVHlwZVtcIlVJU2V0dXBcIl0gPSA0MTk0MzA0XSA9IFwiVUlTZXR1cFwiO1xuICAgIFN1c3BlbmRUeXBlW1N1c3BlbmRUeXBlW1wiSW5jcmVtZW50YWxDb3VudE1hc2tcIl0gPSAtNzM0MDAzM10gPSBcIkluY3JlbWVudGFsQ291bnRNYXNrXCI7XG59KShTdXNwZW5kVHlwZSB8fCAoU3VzcGVuZFR5cGUgPSB7fSkpO1xuKGZ1bmN0aW9uIChTdXNwZW5kVHlwZSkge1xuICAgIGZ1bmN0aW9uIHRvU3RyaW5nKHR5cGUpIHtcbiAgICAgICAgcmV0dXJuICh0eXBlID8gXCJzdXNwZW5kZWRcIiA6IFwicmVzdW1lZFwiKSArIFwiKFwiICtcbiAgICAgICAgICAgIFwiSW5jcmVtZW50YWw6IFwiICsgKHR5cGUgJiBTdXNwZW5kVHlwZS5JbmNyZW1lbnRhbENvdW50TWFzaykgKyBcIiwgXCIgK1xuICAgICAgICAgICAgXCJMb2FkZWQ6IFwiICsgISh0eXBlICYgU3VzcGVuZFR5cGUuTG9hZGVkKSArIFwiLCBcIiArXG4gICAgICAgICAgICBcIk5hdGl2ZVZpZXc6IFwiICsgISh0eXBlICYgU3VzcGVuZFR5cGUuTmF0aXZlVmlldykgKyBcIiwgXCIgK1xuICAgICAgICAgICAgXCJVSVNldHVwOiBcIiArICEodHlwZSAmIFN1c3BlbmRUeXBlLlVJU2V0dXApICtcbiAgICAgICAgICAgIFwiKVwiO1xuICAgIH1cbiAgICBTdXNwZW5kVHlwZS50b1N0cmluZyA9IHRvU3RyaW5nO1xufSkoU3VzcGVuZFR5cGUgfHwgKFN1c3BlbmRUeXBlID0ge30pKTtcbnZhciBWaWV3QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFZpZXdCYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFZpZXdCYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fb25Mb2FkZWRDYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX29uVW5sb2FkZWRDYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2Nzc1N0YXRlID0gbmV3IHNzbS5Dc3NTdGF0ZShuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICBfdGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXMgPSB7XG4gICAgICAgICAgICBcImhpZ2hsaWdodGVkXCI6IFtcbiAgICAgICAgICAgICAgICBcImFjdGl2ZVwiLFxuICAgICAgICAgICAgICAgIFwicHJlc3NlZFwiXG4gICAgICAgICAgICBdXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNzc0NsYXNzZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIF90aGlzLmNzc1BzZXVkb0NsYXNzZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIF90aGlzLl9kb21JZCA9IHZpZXdJZENvdW50ZXIrKztcbiAgICAgICAgX3RoaXMuX3N0eWxlID0gbmV3IHByb3BlcnRpZXNfMS5TdHlsZShuZXcgV2Vha1JlZihfdGhpcykpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwicGFyZW50Tm9kZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RlbXBsYXRlUGFyZW50IHx8IHRoaXMucGFyZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICB0aGlzLl90ZW1wbGF0ZVBhcmVudCA9IG5vZGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwibmF0aXZlVmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0TmF0aXZlVmlldyh2YWx1ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwidHlwZU5hbWVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0eXBlcy5nZXRDbGFzcyh0aGlzKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJzdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChpbmxpbmVTdHlsZSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBpbmxpbmVTdHlsZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0SW5saW5lU3R5bGUoaW5saW5lU3R5bGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlldy5zdHlsZSBwcm9wZXJ0eSBpcyByZWFkLW9ubHkuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcImFuZHJvaWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hbmRyb2lkVmlldztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdCYXNlLnByb3RvdHlwZSwgXCJpb3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pb3NWaWV3O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0Jhc2UucHJvdG90eXBlLCBcImlzTG9hZGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNMb2FkZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwiY2xhc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNsYXNzTmFtZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodikge1xuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSB2O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZ2V0Vmlld0J5SWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgICAgcmV0dXJuIGdldFZpZXdCeUlkKHRoaXMsIGlkKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3QmFzZS5wcm90b3R5cGUsIFwicGFnZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50LnBhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmVuc3VyZURvbU5vZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICBlbnN1cmVkb21Ob2RlTW9kdWxlKCk7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUgPSBuZXcgZG9tTm9kZU1vZHVsZS5ET01Ob2RlKHRoaXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7XG4gICAgICAgIHRoaXNbbmFtZV0gPSBiaW5kYWJsZV8xLldyYXBwZWRWYWx1ZS51bndyYXAodmFsdWUpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLm9uTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldEZsYWcoRmxhZ3Muc3VwZXJPbkxvYWRlZENhbGxlZCwgdHJ1ZSk7XG4gICAgICAgIGlmICh0aGlzLl9pc0xvYWRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lzTG9hZGVkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY3NzU3RhdGUub25Mb2FkZWQoKTtcbiAgICAgICAgdGhpcy5fcmVzdW1lTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5Mb2FkZWQpO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIF90aGlzLmxvYWRWaWV3KGNoaWxkKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fZW1pdChcImxvYWRlZFwiKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNldEZsYWcoRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkLCB0cnVlKTtcbiAgICAgICAgaWYgKCF0aGlzLl9pc0xvYWRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLkxvYWRlZCk7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgX3RoaXMudW5sb2FkVmlldyhjaGlsZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX2lzTG9hZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2Nzc1N0YXRlLm9uVW5sb2FkZWQoKTtcbiAgICAgICAgdGhpcy5fZW1pdChcInVubG9hZGVkXCIpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ID0gdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCB8IHR5cGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50Kys7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcmVzdW1lTmF0aXZlVXBkYXRlcyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIGlmICh0eXBlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ID0gdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCAmIH50eXBlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKCh0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlc0NvdW50ICYgU3VzcGVuZFR5cGUuSW5jcmVtZW50YWxDb3VudE1hc2spID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBjYWxsIHRvIFwiICsgdGhpcyArIFwiLl9yZXN1bWVOYXRpdmVVcGRhdGVzXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudC0tO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5vblJlc3VtZU5hdGl2ZVVwZGF0ZXMoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9iYXRjaFVwZGF0ZSA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuSW5jcmVtZW50YWwpO1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICAgIH1cbiAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVOYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLkluY3JlbWVudGFsKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnNldEZsYWcgPSBmdW5jdGlvbiAoZmxhZywgdmFsdWUpIHtcbiAgICAgICAgc3dpdGNoIChmbGFnKSB7XG4gICAgICAgICAgICBjYXNlIEZsYWdzLnN1cGVyT25Mb2FkZWRDYWxsZWQ6XG4gICAgICAgICAgICAgICAgdGhpcy5fb25Mb2FkZWRDYWxsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHRoaXMuX29uVW5sb2FkZWRDYWxsZWQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmlzRmxhZ1NldCA9IGZ1bmN0aW9uIChmbGFnKSB7XG4gICAgICAgIHN3aXRjaCAoZmxhZykge1xuICAgICAgICAgICAgY2FzZSBGbGFncy5zdXBlck9uTG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkxvYWRlZENhbGxlZDtcbiAgICAgICAgICAgIGNhc2UgRmxhZ3Muc3VwZXJPblVubG9hZGVkQ2FsbGVkOlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblVubG9hZGVkQ2FsbGVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuY2FsbEZ1bmN0aW9uV2l0aFN1cGVyID0gZnVuY3Rpb24gKGZsYWcsIGZ1bmMpIHtcbiAgICAgICAgdGhpcy5zZXRGbGFnKGZsYWcsIGZhbHNlKTtcbiAgICAgICAgZnVuYygpO1xuICAgICAgICBpZiAoIXRoaXMuaXNGbGFnU2V0KGZsYWcpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJzdXBlci5cIiArIGZsYWcgKyBcIiBub3QgY2FsbGVkIGluIFwiICsgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jYWxsTG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmNhbGxGdW5jdGlvbldpdGhTdXBlcihGbGFncy5zdXBlck9uTG9hZGVkQ2FsbGVkLCBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5vbkxvYWRlZCgpOyB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jYWxsVW5sb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuY2FsbEZ1bmN0aW9uV2l0aFN1cGVyKEZsYWdzLnN1cGVyT25VbmxvYWRlZENhbGxlZCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMub25VbmxvYWRlZCgpOyB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5ub3RpZnlQc2V1ZG9DbGFzc0NoYW5nZWQgPSBmdW5jdGlvbiAocHNldWRvQ2xhc3MpIHtcbiAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IFwiOlwiICsgcHNldWRvQ2xhc3MsIG9iamVjdDogdGhpcyB9KTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5nZXRBbGxBbGlhc2VkU3RhdGVzID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgdmFyIGFsbFN0YXRlcyA9IFtdO1xuICAgICAgICBhbGxTdGF0ZXMucHVzaChuYW1lKTtcbiAgICAgICAgaWYgKG5hbWUgaW4gdGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wc2V1ZG9DbGFzc0FsaWFzZXNbbmFtZV0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBhbGxTdGF0ZXMucHVzaCh0aGlzLnBzZXVkb0NsYXNzQWxpYXNlc1tuYW1lXVtpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFsbFN0YXRlcztcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5hZGRQc2V1ZG9DbGFzcyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgIHZhciBhbGxTdGF0ZXMgPSB0aGlzLmdldEFsbEFsaWFzZWRTdGF0ZXMobmFtZSk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWxsU3RhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5oYXMoYWxsU3RhdGVzW2ldKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5hZGQoYWxsU3RhdGVzW2ldKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVBzZXVkb0NsYXNzQ2hhbmdlZChhbGxTdGF0ZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZGVsZXRlUHNldWRvQ2xhc3MgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICB2YXIgYWxsU3RhdGVzID0gdGhpcy5nZXRBbGxBbGlhc2VkU3RhdGVzKG5hbWUpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFsbFN0YXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5oYXMoYWxsU3RhdGVzW2ldKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3NzUHNldWRvQ2xhc3Nlcy5kZWxldGUoYWxsU3RhdGVzW2ldKTtcbiAgICAgICAgICAgICAgICB0aGlzLm5vdGlmeVBzZXVkb0NsYXNzQ2hhbmdlZChhbGxTdGF0ZXNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuYmluZGluZ0NvbnRleHRDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdGhpcy5iaW5kaW5ncy5nZXQoXCJiaW5kaW5nQ29udGV4dFwiKS5iaW5kKGRhdGEudmFsdWUpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmJpbmQgPSBmdW5jdGlvbiAob3B0aW9ucywgc291cmNlKSB7XG4gICAgICAgIGlmIChzb3VyY2UgPT09IHZvaWQgMCkgeyBzb3VyY2UgPSBkZWZhdWx0QmluZGluZ1NvdXJjZTsgfVxuICAgICAgICB2YXIgdGFyZ2V0UHJvcGVydHkgPSBvcHRpb25zLnRhcmdldFByb3BlcnR5O1xuICAgICAgICB0aGlzLnVuYmluZCh0YXJnZXRQcm9wZXJ0eSk7XG4gICAgICAgIGlmICghdGhpcy5iaW5kaW5ncykge1xuICAgICAgICAgICAgdGhpcy5iaW5kaW5ncyA9IG5ldyBNYXAoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmluZGluZyA9IG5ldyBiaW5kYWJsZV8xLkJpbmRpbmcodGhpcywgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMuYmluZGluZ3Muc2V0KHRhcmdldFByb3BlcnR5LCBiaW5kaW5nKTtcbiAgICAgICAgdmFyIGJpbmRpbmdTb3VyY2UgPSBzb3VyY2U7XG4gICAgICAgIGlmIChiaW5kaW5nU291cmNlID09PSBkZWZhdWx0QmluZGluZ1NvdXJjZSkge1xuICAgICAgICAgICAgYmluZGluZ1NvdXJjZSA9IHRoaXMuYmluZGluZ0NvbnRleHQ7XG4gICAgICAgICAgICBiaW5kaW5nLnNvdXJjZUlzQmluZGluZ0NvbnRleHQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRhcmdldFByb3BlcnR5ID09PSBcImJpbmRpbmdDb250ZXh0XCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0Qm91bmRUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmVudF8yID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmVudF8yKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudF8yLm9uKFwiYmluZGluZ0NvbnRleHRDaGFuZ2VcIiwgdGhpcy5iaW5kaW5nQ29udGV4dENoYW5nZWQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaG91bGRBZGRIYW5kbGVyVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBiaW5kaW5nLmJpbmQoYmluZGluZ1NvdXJjZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUudW5iaW5kID0gZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgICAgIHZhciBiaW5kaW5ncyA9IHRoaXMuYmluZGluZ3M7XG4gICAgICAgIGlmICghYmluZGluZ3MpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmluZGluZyA9IGJpbmRpbmdzLmdldChwcm9wZXJ0eSk7XG4gICAgICAgIGlmIChiaW5kaW5nKSB7XG4gICAgICAgICAgICBiaW5kaW5nLnVuYmluZCgpO1xuICAgICAgICAgICAgYmluZGluZ3MuZGVsZXRlKHByb3BlcnR5KTtcbiAgICAgICAgICAgIGlmIChiaW5kaW5nLnNvdXJjZUlzQmluZGluZ0NvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocHJvcGVydHkgPT09IFwiYmluZGluZ0NvbnRleHRcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3VsZEFkZEhhbmRsZXJUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbmRpbmdDb250ZXh0Qm91bmRUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50XzMgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcmVudF8zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfMy5vZmYoXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcGFyZW50ID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgIGlmIChwYXJlbnQpIHtcbiAgICAgICAgICAgIHBhcmVudC5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYWRkVmlldyA9IGZ1bmN0aW9uICh2aWV3LCBhdEluZGV4KSB7XG4gICAgICAgIGlmIChiaW5kYWJsZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBiaW5kYWJsZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9hZGRWaWV3KFwiICsgdmlldyArIFwiLCBcIiArIGF0SW5kZXggKyBcIilcIiwgYmluZGFibGVfMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJFeHBlY3RpbmcgYSB2YWxpZCBWaWV3IGluc3RhbmNlLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISh2aWV3IGluc3RhbmNlb2YgVmlld0Jhc2UpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IodmlldyArIFwiIGlzIG5vdCBhIHZhbGlkIFZpZXcgaW5zdGFuY2UuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2aWV3LnBhcmVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmlldyBhbHJlYWR5IGhhcyBhIHBhcmVudC4gVmlldzogXCIgKyB2aWV3ICsgXCIgUGFyZW50OiBcIiArIHZpZXcucGFyZW50KTtcbiAgICAgICAgfVxuICAgICAgICB2aWV3LnBhcmVudCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2FkZFZpZXdDb3JlKHZpZXcsIGF0SW5kZXgpO1xuICAgICAgICB2aWV3Ll9wYXJlbnRDaGFuZ2VkKG51bGwpO1xuICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUub25DaGlsZEFkZGVkKHZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2FkZFZpZXdDb3JlID0gZnVuY3Rpb24gKHZpZXcsIGF0SW5kZXgpIHtcbiAgICAgICAgcHJvcGVydGllc18xLnByb3BhZ2F0ZUluaGVyaXRhYmxlUHJvcGVydGllcyh0aGlzLCB2aWV3KTtcbiAgICAgICAgdmlldy5faW5oZXJpdFN0eWxlU2NvcGUodGhpcy5fc3R5bGVTY29wZSk7XG4gICAgICAgIHByb3BlcnRpZXNfMS5wcm9wYWdhdGVJbmhlcml0YWJsZUNzc1Byb3BlcnRpZXModGhpcy5zdHlsZSwgdmlldy5zdHlsZSk7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICB2aWV3Ll9zZXR1cFVJKHRoaXMuX2NvbnRleHQsIGF0SW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9pc0xvYWRlZCkge1xuICAgICAgICAgICAgdGhpcy5sb2FkVmlldyh2aWV3KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmxvYWRWaWV3ID0gZnVuY3Rpb24gKHZpZXcpIHtcbiAgICAgICAgaWYgKHZpZXcgJiYgIXZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHZpZXcuY2FsbExvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUudW5sb2FkVmlldyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmICh2aWV3ICYmIHZpZXcuaXNMb2FkZWQpIHtcbiAgICAgICAgICAgIHZpZXcuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fcmVtb3ZlVmlldyA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIGlmIChiaW5kYWJsZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBiaW5kYWJsZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9yZW1vdmVWaWV3KFwiICsgdmlldyArIFwiKVwiLCBiaW5kYWJsZV8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlldy5wYXJlbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZpZXcgbm90IGFkZGVkIHRvIHRoaXMgaW5zdGFuY2UuIFZpZXc6IFwiICsgdmlldyArIFwiIEN1cnJlbnRQYXJlbnQ6IFwiICsgdmlldy5wYXJlbnQgKyBcIiBFeHBlY3RlZFBhcmVudDogXCIgKyB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUub25DaGlsZFJlbW92ZWQodmlldyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVtb3ZlVmlld0NvcmUodmlldyk7XG4gICAgICAgIHZpZXcucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgICAgICB2aWV3Ll9wYXJlbnRDaGFuZ2VkKHRoaXMpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9yZW1vdmVWaWV3Q29yZSA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHRoaXMudW5sb2FkVmlldyh2aWV3KTtcbiAgICAgICAgaWYgKHZpZXcuX2NvbnRleHQpIHtcbiAgICAgICAgICAgIHZpZXcuX3RlYXJEb3duVUkoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLmNyZWF0ZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLnJlc2V0TmF0aXZlVmlld0ludGVybmFsID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9zZXR1cEFzUm9vdFZpZXcgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICB0aGlzLl9zZXR1cFVJKGNvbnRleHQpO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9zZXR1cFVJID0gZnVuY3Rpb24gKGNvbnRleHQsIGF0SW5kZXgsIHBhcmVudElzTG9hZGVkKSB7XG4gICAgICAgIGlmICh0aGlzLl9jb250ZXh0ID09PSBjb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fY29udGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fdGVhckRvd25VSSh0cnVlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldyA9IHRoaXMuY3JlYXRlTmF0aXZlVmlldygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzQW5kcm9pZCkge1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZFZpZXcgPSBuYXRpdmVWaWV3O1xuICAgICAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNQYWRkaW5nUmVsYXRpdmUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc1BhZGRpbmdSZWxhdGl2ZSA9IG5hdGl2ZVZpZXcuaXNQYWRkaW5nUmVsYXRpdmUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5hdGl2ZVZpZXcuZGVmYXVsdFBhZGRpbmdzO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBvcmcubmF0aXZlc2NyaXB0LndpZGdldHMuVmlld0hlbHBlci5nZXRQYWRkaW5nKG5hdGl2ZVZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmRlZmF1bHRQYWRkaW5ncyA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFBhZGRpbmdUb3AgPSByZXN1bHQudG9wO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRQYWRkaW5nUmlnaHQgPSByZXN1bHQucmlnaHQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFBhZGRpbmdCb3R0b20gPSByZXN1bHQuYm90dG9tO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdCA9IHJlc3VsdC5sZWZ0O1xuICAgICAgICAgICAgICAgIHZhciBzdHlsZSA9IHRoaXMuc3R5bGU7XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ1RvcFByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdUb3AgPSB0aGlzLl9kZWZhdWx0UGFkZGluZ1RvcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ1JpZ2h0UHJvcGVydHkuaXNTZXQoc3R5bGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWZmZWN0aXZlUGFkZGluZ1JpZ2h0ID0gdGhpcy5fZGVmYXVsdFBhZGRpbmdSaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmlzU2V0KHN0eWxlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVmZmVjdGl2ZVBhZGRpbmdCb3R0b20gPSB0aGlzLl9kZWZhdWx0UGFkZGluZ0JvdHRvbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFzdHlsZV9wcm9wZXJ0aWVzXzEucGFkZGluZ0xlZnRQcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdCA9IHRoaXMuX2RlZmF1bHRQYWRkaW5nTGVmdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9pb3NWaWV3ID0gbmF0aXZlVmlldztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldE5hdGl2ZVZpZXcobmF0aXZlVmlldyk7XG4gICAgICAgIGlmICh0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZUluZGV4ID0gdGhpcy5wYXJlbnQuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXgoYXRJbmRleCk7XG4gICAgICAgICAgICB0aGlzLl9pc0FkZGVkVG9OYXRpdmVWaXN1YWxUcmVlID0gdGhpcy5wYXJlbnQuX2FkZFZpZXdUb05hdGl2ZVZpc3VhbFRyZWUodGhpcywgbmF0aXZlSW5kZXgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jlc3VtZU5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuVUlTZXR1cCk7XG4gICAgICAgIHRoaXMuZWFjaENoaWxkKGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX3NldHVwVUkoY29udGV4dCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodGhpcy5fX25hdGl2ZVZpZXcgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX19uYXRpdmVWaWV3KSB7XG4gICAgICAgICAgICB0aGlzLl9zdXNwZW5kTmF0aXZlVXBkYXRlcyhTdXNwZW5kVHlwZS5OYXRpdmVWaWV3KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9fbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCA9IHZhbHVlO1xuICAgICAgICBpZiAodGhpcy5fX25hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRlZFVwZGF0ZXMgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLmluaXROYXRpdmVWaWV3KCk7XG4gICAgICAgICAgICB0aGlzLl9yZXN1bWVOYXRpdmVVcGRhdGVzKFN1c3BlbmRUeXBlLk5hdGl2ZVZpZXcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3RlYXJEb3duVUkgPSBmdW5jdGlvbiAoZm9yY2UpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZXNldE5hdGl2ZVZpZXdJbnRlcm5hbCgpO1xuICAgICAgICB0aGlzLmVhY2hDaGlsZChmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl90ZWFyRG93blVJKGZvcmNlKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5fcmVtb3ZlVmlld0Zyb21OYXRpdmVWaXN1YWxUcmVlKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlzcG9zZU5hdGl2ZVZpZXcoKTtcbiAgICAgICAgdGhpcy5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXMoU3VzcGVuZFR5cGUuVUlTZXR1cCk7XG4gICAgICAgIGlmIChwbGF0Zm9ybV8xLmlzQW5kcm9pZCkge1xuICAgICAgICAgICAgdGhpcy5zZXROYXRpdmVWaWV3KG51bGwpO1xuICAgICAgICAgICAgdGhpcy5fYW5kcm9pZFZpZXcgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xuICAgICAgICBpZiAodGhpcy5kb21Ob2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRvbU5vZGUuZGlzcG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5kb21Ob2RlID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX2NoaWxkSW5kZXhUb05hdGl2ZUNoaWxkSW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGluZGV4O1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlID0gZnVuY3Rpb24gKHZpZXcsIGF0SW5kZXgpIHtcbiAgICAgICAgaWYgKHZpZXcuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNoaWxkIGFscmVhZHkgYWRkZWQgdG8gdGhlIG5hdGl2ZSB2aXN1YWwgdHJlZS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uICh2aWV3KSB7XG4gICAgICAgIHZpZXcuX2lzQWRkZWRUb05hdGl2ZVZpc3VhbFRyZWUgPSBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fZ29Ub1Zpc3VhbFN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgIGlmIChiaW5kYWJsZV8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBiaW5kYWJsZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiIGdvaW5nIHRvIHN0YXRlOiBcIiArIHN0YXRlLCBiaW5kYWJsZV8xLnRyYWNlQ2F0ZWdvcmllcy5TdHlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0YXRlID09PSB0aGlzLl92aXN1YWxTdGF0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGVsZXRlUHNldWRvQ2xhc3ModGhpcy5fdmlzdWFsU3RhdGUpO1xuICAgICAgICB0aGlzLl92aXN1YWxTdGF0ZSA9IHN0YXRlO1xuICAgICAgICB0aGlzLmFkZFBzZXVkb0NsYXNzKHN0YXRlKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5fYXBwbHlYbWxBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoYXR0cmlidXRlLCB2YWx1ZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlZpZXdCYXNlLl9hcHBseVhtbEF0dHJpYnV0ZSguLi4pIGlzIGRlcHJlY2F0ZWQ7IHNldCBhdHRyaWJ1dGVzIGFzIHBsYWluIHByb3BlcnRpZXMgaW5zdGVhZFwiKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZSA9PT0gXCJzdHlsZVwiIHx8IGF0dHJpYnV0ZSA9PT0gXCJyb3dzXCIgfHwgYXR0cmlidXRlID09PSBcImNvbHVtbnNcIiB8fCBhdHRyaWJ1dGUgPT09IFwiZm9udEF0dHJpYnV0ZXNcIikge1xuICAgICAgICAgICAgdGhpc1thdHRyaWJ1dGVdID0gdmFsdWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuc2V0SW5saW5lU3R5bGUgPSBmdW5jdGlvbiAoc3R5bGUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBzdHlsZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUGFyYW1ldGVyIHNob3VsZCBiZSB2YWxpZCBDU1Mgc3RyaW5nIVwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbnN1cmVTdHlsZVNjb3BlTW9kdWxlKCk7XG4gICAgICAgIHN0eWxlU2NvcGVNb2R1bGUuYXBwbHlJbmxpbmVTdHlsZSh0aGlzLCBzdHlsZSk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUuX3BhcmVudENoYW5nZWQgPSBmdW5jdGlvbiAob2xkUGFyZW50KSB7XG4gICAgICAgIHZhciBuZXdQYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKG9sZFBhcmVudCkge1xuICAgICAgICAgICAgcHJvcGVydGllc18xLmNsZWFySW5oZXJpdGVkUHJvcGVydGllcyh0aGlzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLmJpbmRpbmdDb250ZXh0Qm91bmRUb1BhcmVudEJpbmRpbmdDb250ZXh0Q2hhbmdlZCkge1xuICAgICAgICAgICAgICAgIG9sZFBhcmVudC5vZmYoXCJiaW5kaW5nQ29udGV4dENoYW5nZVwiLCB0aGlzLmJpbmRpbmdDb250ZXh0Q2hhbmdlZCwgdGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zaG91bGRBZGRIYW5kbGVyVG9QYXJlbnRCaW5kaW5nQ29udGV4dENoYW5nZWQpIHtcbiAgICAgICAgICAgIG5ld1BhcmVudC5vbihcImJpbmRpbmdDb250ZXh0Q2hhbmdlXCIsIHRoaXMuYmluZGluZ0NvbnRleHRDaGFuZ2VkLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYmluZGluZ3MuZ2V0KFwiYmluZGluZ0NvbnRleHRcIikuYmluZChuZXdQYXJlbnQuYmluZGluZ0NvbnRleHQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUub25SZXN1bWVOYXRpdmVVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBwcm9wZXJ0aWVzXzEuaW5pdE5hdGl2ZVZpZXcodGhpcyk7XG4gICAgfTtcbiAgICBWaWV3QmFzZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdHIgPSB0aGlzLnR5cGVOYW1lO1xuICAgICAgICBpZiAodGhpcy5pZCkge1xuICAgICAgICAgICAgc3RyICs9IFwiPFwiICsgdGhpcy5pZCArIFwiPlwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgc3RyICs9IFwiKFwiICsgdGhpcy5fZG9tSWQgKyBcIilcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc291cmNlID0gZGVidWdfMS5Tb3VyY2UuZ2V0KHRoaXMpO1xuICAgICAgICBpZiAoc291cmNlKSB7XG4gICAgICAgICAgICBzdHIgKz0gXCJAXCIgKyBzb3VyY2UgKyBcIjtcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3RyO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9vbkNzc1N0YXRlQ2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9jc3NTdGF0ZS5vbkNoYW5nZSgpO1xuICAgICAgICBlYWNoRGVzY2VuZGFudCh0aGlzLCBmdW5jdGlvbiAoY2hpbGQpIHtcbiAgICAgICAgICAgIGNoaWxkLl9jc3NTdGF0ZS5vbkNoYW5nZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9pbmhlcml0U3R5bGVTY29wZSA9IGZ1bmN0aW9uIChzdHlsZVNjb3BlKSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1N0eWxlU2NvcGVIb3N0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3N0eWxlU2NvcGUgIT09IHN0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlU2NvcGUgPSBzdHlsZVNjb3BlO1xuICAgICAgICAgICAgdGhpcy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICAgICAgdGhpcy5lYWNoQ2hpbGQoZnVuY3Rpb24gKGNoaWxkKSB7XG4gICAgICAgICAgICAgICAgY2hpbGQuX2luaGVyaXRTdHlsZVNjb3BlKHN0eWxlU2NvcGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5zaG93TW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudCA9IHRoaXMucGFyZW50O1xuICAgICAgICByZXR1cm4gcGFyZW50ICYmIHBhcmVudC5zaG93TW9kYWwuYXBwbHkocGFyZW50LCBhcmdzKTtcbiAgICB9O1xuICAgIFZpZXdCYXNlLnByb3RvdHlwZS5jbG9zZU1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgaWYgKHBhcmVudCkge1xuICAgICAgICAgICAgcGFyZW50LmNsb3NlTW9kYWwuYXBwbHkocGFyZW50LCBhcmdzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9kaWFsb2dDbG9zZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVhY2hEZXNjZW5kYW50KHRoaXMsIGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX2RpYWxvZ0Nsb3NlZCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UucHJvdG90eXBlLl9vblJvb3RWaWV3UmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGVhY2hEZXNjZW5kYW50KHRoaXMsIGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgY2hpbGQuX29uUm9vdFZpZXdSZXNldCgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgVmlld0Jhc2UubG9hZGVkRXZlbnQgPSBcImxvYWRlZFwiO1xuICAgIFZpZXdCYXNlLnVubG9hZGVkRXZlbnQgPSBcInVubG9hZGVkXCI7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwib25Mb2FkZWRcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBWaWV3QmFzZS5wcm90b3R5cGUsIFwib25VbmxvYWRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJhZGRQc2V1ZG9DbGFzc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJkZWxldGVQc2V1ZG9DbGFzc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFZpZXdCYXNlLnByb3RvdHlwZSwgXCJyZXF1ZXN0TGF5b3V0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIl9hZGRWaWV3XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIl9zZXR1cFVJXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlld0Jhc2UucHJvdG90eXBlLCBcIl90ZWFyRG93blVJXCIsIG51bGwpO1xuICAgIHJldHVybiBWaWV3QmFzZTtcbn0oYmluZGFibGVfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLlZpZXdCYXNlID0gVmlld0Jhc2U7XG5WaWV3QmFzZS5wcm90b3R5cGUuaXNDb2xsYXBzZWQgPSBmYWxzZTtcblZpZXdCYXNlLnByb3RvdHlwZS5fb2xkTGVmdCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX29sZFRvcCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuX29sZFJpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fb2xkQm90dG9tID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNaW5XaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlTWluSGVpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVXaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlSGVpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNYXJnaW5Ub3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1hcmdpblJpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVNYXJnaW5Cb3R0b20gPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZU1hcmdpbkxlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVBhZGRpbmdUb3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZVBhZGRpbmdSaWdodCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlUGFkZGluZ0xlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCA9IDA7XG5WaWV3QmFzZS5wcm90b3R5cGUuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFBhZGRpbmdUb3AgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9kZWZhdWx0UGFkZGluZ1JpZ2h0ID0gMDtcblZpZXdCYXNlLnByb3RvdHlwZS5fZGVmYXVsdFBhZGRpbmdCb3R0b20gPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9kZWZhdWx0UGFkZGluZ0xlZnQgPSAwO1xuVmlld0Jhc2UucHJvdG90eXBlLl9pc1ZpZXdCYXNlID0gdHJ1ZTtcblZpZXdCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwibmV2ZXJcIjtcblZpZXdCYXNlLnByb3RvdHlwZS5fc3VzcGVuZE5hdGl2ZVVwZGF0ZXNDb3VudCA9XG4gICAgU3VzcGVuZFR5cGUuTG9hZGVkIHxcbiAgICAgICAgU3VzcGVuZFR5cGUuTmF0aXZlVmlldyB8XG4gICAgICAgIFN1c3BlbmRUeXBlLlVJU2V0dXA7XG5leHBvcnRzLmJpbmRpbmdDb250ZXh0UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkluaGVyaXRlZFByb3BlcnR5KHsgbmFtZTogXCJiaW5kaW5nQ29udGV4dFwiIH0pO1xuZXhwb3J0cy5iaW5kaW5nQ29udGV4dFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdCYXNlKTtcbmV4cG9ydHMuY2xhc3NOYW1lUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImNsYXNzTmFtZVwiLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHZpZXcsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY2xhc3NlcyA9IHZpZXcuY3NzQ2xhc3NlcztcbiAgICAgICAgY2xhc3Nlcy5jbGVhcigpO1xuICAgICAgICBpZiAodHlwZW9mIG5ld1ZhbHVlID09PSBcInN0cmluZ1wiICYmIG5ld1ZhbHVlICE9PSBcIlwiKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZS5zcGxpdChcIiBcIikuZm9yRWFjaChmdW5jdGlvbiAoYykgeyByZXR1cm4gY2xhc3Nlcy5hZGQoYyk7IH0pO1xuICAgICAgICB9XG4gICAgICAgIHZpZXcuX29uQ3NzU3RhdGVDaGFuZ2UoKTtcbiAgICB9XG59KTtcbmV4cG9ydHMuY2xhc3NOYW1lUHJvcGVydHkucmVnaXN0ZXIoVmlld0Jhc2UpO1xuZXhwb3J0cy5pZFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaWRcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodmlldywgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7IHJldHVybiB2aWV3Ll9vbkNzc1N0YXRlQ2hhbmdlKCk7IH0gfSk7XG5leHBvcnRzLmlkUHJvcGVydHkucmVnaXN0ZXIoVmlld0Jhc2UpO1xuZnVuY3Rpb24gYm9vbGVhbkNvbnZlcnRlcih2KSB7XG4gICAgdmFyIGxvd2VyY2FzZSA9ICh2ICsgXCJcIikudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAobG93ZXJjYXNlID09PSBcInRydWVcIikge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgZWxzZSBpZiAobG93ZXJjYXNlID09PSBcImZhbHNlXCIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGJvb2xlYW46IFwiICsgdik7XG59XG5leHBvcnRzLmJvb2xlYW5Db252ZXJ0ZXIgPSBib29sZWFuQ29udmVydGVyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dmlldy1iYXNlLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld19iYXNlXzEgPSByZXF1aXJlKFwiLi4vdmlldy1iYXNlXCIpO1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgZ2VzdHVyZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9nZXN0dXJlc1wiKTtcbnZhciBidWlsZGVyXzEgPSByZXF1aXJlKFwiLi4vLi4vYnVpbGRlclwiKTtcbnZhciBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9idWlsZGVyL21vZHVsZS1uYW1lLXNhbml0aXplclwiKTtcbnZhciBzdHlsZV9zY29wZV8xID0gcmVxdWlyZShcIi4uLy4uL3N0eWxpbmcvc3R5bGUtc2NvcGVcIik7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9saW5lYXItZ3JhZGllbnRcIik7XG5leHBvcnRzLkxpbmVhckdyYWRpZW50ID0gbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQ7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuLi92aWV3LWJhc2VcIikpO1xudmFyIGFuaW1hdGlvbk1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZUFuaW1hdGlvbk1vZHVsZSgpIHtcbiAgICBpZiAoIWFuaW1hdGlvbk1vZHVsZSkge1xuICAgICAgICBhbmltYXRpb25Nb2R1bGUgPSByZXF1aXJlKFwidWkvYW5pbWF0aW9uXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIENTU1R5cGUodHlwZSkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgIGNscy5wcm90b3R5cGUuY3NzVHlwZSA9IHR5cGU7XG4gICAgfTtcbn1cbmV4cG9ydHMuQ1NTVHlwZSA9IENTU1R5cGU7XG5mdW5jdGlvbiB2aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQodmlldywgY29udGV4dCwgdHlwZXMpIHtcbiAgICByZXR1cm4gY29udGV4dCAmJlxuICAgICAgICB2aWV3Ll9tb2R1bGVOYW1lICYmXG4gICAgICAgIGNvbnRleHQudHlwZSAmJlxuICAgICAgICB0eXBlcy5zb21lKGZ1bmN0aW9uICh0eXBlKSB7IHJldHVybiB0eXBlID09PSBjb250ZXh0LnR5cGU7IH0pICYmXG4gICAgICAgIGNvbnRleHQucGF0aCAmJlxuICAgICAgICBjb250ZXh0LnBhdGguaW5jbHVkZXModmlldy5fbW9kdWxlTmFtZSk7XG59XG5leHBvcnRzLnZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dCA9IHZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dDtcbmZ1bmN0aW9uIFBzZXVkb0NsYXNzSGFuZGxlcigpIHtcbiAgICB2YXIgcHNldWRvQ2xhc3NlcyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIHBzZXVkb0NsYXNzZXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIHN0YXRlRXZlbnROYW1lcyA9IHBzZXVkb0NsYXNzZXMubWFwKGZ1bmN0aW9uIChzKSB7IHJldHVybiBcIjpcIiArIHM7IH0pO1xuICAgIHZhciBsaXN0ZW5lcnMgPSBTeW1ib2woXCJsaXN0ZW5lcnNcIik7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIHByb3BlcnR5S2V5LCBkZXNjcmlwdG9yKSB7XG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZShjaGFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBwcmV2ID0gdGhpc1tsaXN0ZW5lcnNdIHx8IDA7XG4gICAgICAgICAgICB2YXIgbmV4dCA9IHByZXYgKyBjaGFuZ2U7XG4gICAgICAgICAgICBpZiAocHJldiA8PSAwICYmIG5leHQgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpc1twcm9wZXJ0eUtleV0odHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwcmV2ID4gMCAmJiBuZXh0IDw9IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzW3Byb3BlcnR5S2V5XShmYWxzZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgc3RhdGVFdmVudE5hbWVzLmZvckVhY2goZnVuY3Rpb24gKHMpIHsgcmV0dXJuIHRhcmdldFtzXSA9IHVwZGF0ZTsgfSk7XG4gICAgfTtcbn1cbmV4cG9ydHMuUHNldWRvQ2xhc3NIYW5kbGVyID0gUHNldWRvQ2xhc3NIYW5kbGVyO1xuZXhwb3J0cy5fcm9vdE1vZGFsVmlld3MgPSBuZXcgQXJyYXkoKTtcbnZhciBWaWV3Q29tbW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVmlld0NvbW1vbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBWaWV3Q29tbW9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2dlc3R1cmVPYnNlcnZlcnMgPSB7fTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwiY3NzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLl9zdHlsZVNjb3BlO1xuICAgICAgICAgICAgcmV0dXJuIHNjb3BlICYmIHNjb3BlLmNzcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlU2NvcGUodW5kZWZpbmVkLCB1bmRlZmluZWQsIHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuYWRkQ3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZykge1xuICAgICAgICB0aGlzLl91cGRhdGVTdHlsZVNjb3BlKHVuZGVmaW5lZCwgY3NzU3RyaW5nKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmFkZENzc0ZpbGUgPSBmdW5jdGlvbiAoY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlU3R5bGVTY29wZShjc3NGaWxlTmFtZSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5jaGFuZ2VDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHZhciBzY29wZSA9IHRoaXMuX3N0eWxlU2NvcGU7XG4gICAgICAgIGlmIChzY29wZSAmJiBjc3NGaWxlTmFtZSkge1xuICAgICAgICAgICAgc2NvcGUuY2hhbmdlQ3NzRmlsZShjc3NGaWxlTmFtZSk7XG4gICAgICAgICAgICB0aGlzLl9vbkNzc1N0YXRlQ2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl91cGRhdGVTdHlsZVNjb3BlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lLCBjc3NTdHJpbmcsIGNzcykge1xuICAgICAgICB2YXIgc2NvcGUgPSB0aGlzLl9zdHlsZVNjb3BlO1xuICAgICAgICBpZiAoIXNjb3BlKSB7XG4gICAgICAgICAgICBzY29wZSA9IG5ldyBzdHlsZV9zY29wZV8xLlN0eWxlU2NvcGUoKTtcbiAgICAgICAgICAgIHRoaXMuc2V0U2NvcGVQcm9wZXJ0eShzY29wZSwgY3NzRmlsZU5hbWUsIGNzc1N0cmluZywgY3NzKTtcbiAgICAgICAgICAgIHRoaXMuX2luaGVyaXRTdHlsZVNjb3BlKHNjb3BlKTtcbiAgICAgICAgICAgIHRoaXMuX2lzU3R5bGVTY29wZUhvc3QgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zZXRTY29wZVByb3BlcnR5KHNjb3BlLCBjc3NGaWxlTmFtZSwgY3NzU3RyaW5nLCBjc3MpO1xuICAgICAgICAgICAgdGhpcy5fb25Dc3NTdGF0ZUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5zZXRTY29wZVByb3BlcnR5ID0gZnVuY3Rpb24gKHNjb3BlLCBjc3NGaWxlTmFtZSwgY3NzU3RyaW5nLCBjc3MpIHtcbiAgICAgICAgaWYgKGNzc0ZpbGVOYW1lICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHNjb3BlLmFkZENzc0ZpbGUoY3NzRmlsZU5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGNzc1N0cmluZyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBzY29wZS5hZGRDc3MoY3NzU3RyaW5nKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChjc3MgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgc2NvcGUuY3NzID0gY3NzO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fb25MaXZlc3luYyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld19iYXNlXzEudHJhY2VXcml0ZSh0aGlzICsgXCIuX29uTGl2ZXN5bmMoXCIgKyBKU09OLnN0cmluZ2lmeShjb250ZXh0KSArIFwiKVwiLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9oYW5kbGVMaXZlc3luYyhjb250ZXh0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhbmRsZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICAgICAgaWYgKGNoaWxkLl9vbkxpdmVzeW5jKGNvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhhbmRsZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5faGFuZGxlTGl2ZXN5bmMgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9oYW5kbGVMaXZlc3luYyhcIiArIEpTT04uc3RyaW5naWZ5KGNvbnRleHQpICsgXCIpXCIsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdNYXRjaGVzTW9kdWxlQ29udGV4dCh0aGlzLCBjb250ZXh0LCBbXCJzdHlsZVwiXSkpIHtcbiAgICAgICAgICAgIGlmICh2aWV3X2Jhc2VfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUoXCJDaGFuZ2UgSGFuZGxlZDogQ2hhbmdpbmcgQ1NTIGZvciBcIiArIHRoaXMsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY3NzTW9kdWxlTmFtZSA9IG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShjb250ZXh0LnBhdGgpICsgXCIuY3NzXCI7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZUNzc0ZpbGUoY3NzTW9kdWxlTmFtZSk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmlld01hdGNoZXNNb2R1bGVDb250ZXh0KHRoaXMsIGNvbnRleHQsIFtcIm1hcmt1cFwiLCBcInNjcmlwdFwiXSkgJiZcbiAgICAgICAgICAgIHRoaXMucGFnZSAmJlxuICAgICAgICAgICAgdGhpcy5wYWdlLmZyYW1lKSB7XG4gICAgICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKFwiQ2hhbmdlIEhhbmRsZWQ6IENoYW5naW5nIFwiICsgY29udGV4dC50eXBlICsgXCIgZm9yIFwiICsgdGhpcyArIFwiIGluc2lkZSBcIiArIHRoaXMucGFnZSwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxpdmVzeW5jKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhZ2UuZnJhbWUuX2hhbmRsZUxpdmVzeW5jKHsgdHlwZTogY29udGV4dC50eXBlLCBwYXRoOiB0aGlzLnBhZ2UuX21vZHVsZU5hbWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldHVwQXNSb290VmlldyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3NldHVwQXNSb290Vmlldy5jYWxsKHRoaXMsIGNvbnRleHQpO1xuICAgICAgICBpZiAoIXRoaXMuX3N0eWxlU2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3VwZGF0ZVN0eWxlU2NvcGUoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29ic2VydmUgPSBmdW5jdGlvbiAodHlwZSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdKSB7XG4gICAgICAgICAgICB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZ2VzdHVyZU9ic2VydmVyc1t0eXBlXS5wdXNoKGdlc3R1cmVzXzEub2JzZXJ2ZSh0aGlzLCB0eXBlLCBjYWxsYmFjaywgdGhpc0FyZykpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0R2VzdHVyZU9ic2VydmVycyA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXN0dXJlT2JzZXJ2ZXJzW3R5cGVdO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICBhcmcgPSB2aWV3X2Jhc2VfMS5nZXRFdmVudE9yR2VzdHVyZU5hbWUoYXJnKTtcbiAgICAgICAgICAgIHZhciBnZXN0dXJlID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGFyZyk7XG4gICAgICAgICAgICBpZiAoZ2VzdHVyZSAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb2JzZXJ2ZShnZXN0dXJlLCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gKGFyZykuc3BsaXQoXCIsXCIpO1xuICAgICAgICAgICAgICAgIGlmIChldmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2dCA9IGV2ZW50c1tpXS50cmltKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ3N0ID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGV2dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ3N0ICYmICF0aGlzLl9pc0V2ZW50KGFyZykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vYnNlcnZlKGdzdCwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyLmNhbGwodGhpcywgZXZ0LCBjYWxsYmFjaywgdGhpc0FyZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgYXJnID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgICAgICB0aGlzLl9vYnNlcnZlKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGFyZywgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBhcmcgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBnZXN0dXJlID0gZ2VzdHVyZXNfMS5mcm9tU3RyaW5nKGFyZyk7XG4gICAgICAgICAgICBpZiAoZ2VzdHVyZSAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMoZ2VzdHVyZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZXZlbnRzID0gYXJnLnNwbGl0KFwiLFwiKTtcbiAgICAgICAgICAgICAgICBpZiAoZXZlbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldnQgPSBldmVudHNbaV0udHJpbSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdzdCA9IGdlc3R1cmVzXzEuZnJvbVN0cmluZyhldnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdzdCAmJiAhdGhpcy5faXNFdmVudChhcmcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMoZ3N0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIGV2dCwgY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIuY2FsbCh0aGlzLCBhcmcsIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgdGhpcy5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMoYXJnKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUub25CYWNrUHJlc3NlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2dldEZyYWdtZW50TWFuYWdlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldE1vZGFsT3B0aW9ucyA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIGlmIChhcmdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic2hvd01vZGFsIHdpdGhvdXQgcGFyYW1ldGVycyBpcyBkZXByZWNhdGVkLiBQbGVhc2UgY2FsbCBzaG93TW9kYWwgb24gYSB2aWV3IGluc3RhbmNlIGluc3RlYWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBudWxsO1xuICAgICAgICAgICAgaWYgKGFyZ3MubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IGFyZ3NbMV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYXJnc1swXSBpbnN0YW5jZW9mIFZpZXdDb21tb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJzaG93TW9kYWwodmlldzogVmlld0Jhc2UsIGNvbnRleHQ6IGFueSwgY2xvc2VDYWxsYmFjazogRnVuY3Rpb24sIGZ1bGxzY3JlZW4/OiBib29sZWFuLCBhbmltYXRlZD86IGJvb2xlYW4sIHN0cmV0Y2hlZD86IGJvb2xlYW4pIFwiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaXMgZGVwcmVjYXRlZC4gVXNlIHNob3dNb2RhbCh2aWV3OiBWaWV3QmFzZSwgbW9kYWxPcHRpb25zOiBTaG93TW9kYWxPcHRpb25zKSBpbnN0ZWFkLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwic2hvd01vZGFsKG1vZHVsZU5hbWU6IHN0cmluZywgY29udGV4dDogYW55LCBjbG9zZUNhbGxiYWNrOiBGdW5jdGlvbiwgZnVsbHNjcmVlbj86IGJvb2xlYW4sIGFuaW1hdGVkPzogYm9vbGVhbiwgc3RyZXRjaGVkPzogYm9vbGVhbikgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpcyBkZXByZWNhdGVkLiBVc2Ugc2hvd01vZGFsKG1vZHVsZU5hbWU6IHN0cmluZywgbW9kYWxPcHRpb25zOiBTaG93TW9kYWxPcHRpb25zKSBpbnN0ZWFkLlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dDogYXJnc1sxXSxcbiAgICAgICAgICAgICAgICAgICAgY2xvc2VDYWxsYmFjazogYXJnc1syXSxcbiAgICAgICAgICAgICAgICAgICAgZnVsbHNjcmVlbjogYXJnc1szXSxcbiAgICAgICAgICAgICAgICAgICAgYW5pbWF0ZWQ6IGFyZ3NbNF0sXG4gICAgICAgICAgICAgICAgICAgIHN0cmV0Y2hlZDogYXJnc1s1XVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmlyc3RBcmd1bWVudCA9IGFyZ3NbMF07XG4gICAgICAgICAgICB2YXIgdmlldyA9IGZpcnN0QXJndW1lbnQgaW5zdGFuY2VvZiBWaWV3Q29tbW9uXG4gICAgICAgICAgICAgICAgPyBmaXJzdEFyZ3VtZW50IDogYnVpbGRlcl8xLmNyZWF0ZVZpZXdGcm9tRW50cnkoeyBtb2R1bGVOYW1lOiBmaXJzdEFyZ3VtZW50IH0pO1xuICAgICAgICAgICAgcmV0dXJuIHsgdmlldzogdmlldywgb3B0aW9uczogb3B0aW9ucyB9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5zaG93TW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYSA9IHRoaXMuZ2V0TW9kYWxPcHRpb25zKGFyZ3VtZW50cyksIHZpZXcgPSBfYS52aWV3LCBvcHRpb25zID0gX2Eub3B0aW9ucztcbiAgICAgICAgdmlldy5fc2hvd05hdGl2ZU1vZGFsVmlldyh0aGlzLCBvcHRpb25zKTtcbiAgICAgICAgcmV0dXJuIHZpZXc7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5jbG9zZU1vZGFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgYXJnc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbG9zZUNhbGxiYWNrID0gdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrO1xuICAgICAgICBpZiAoY2xvc2VDYWxsYmFjaykge1xuICAgICAgICAgICAgY2xvc2VDYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50XzEgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIGlmIChwYXJlbnRfMSkge1xuICAgICAgICAgICAgICAgIHBhcmVudF8xLmNsb3NlTW9kYWwuYXBwbHkocGFyZW50XzEsIGFyZ3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlld0NvbW1vbi5wcm90b3R5cGUsIFwibW9kYWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2RhbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3Nob3dOYXRpdmVNb2RhbFZpZXcgPSBmdW5jdGlvbiAocGFyZW50LCBvcHRpb25zKSB7XG4gICAgICAgIGV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzLnB1c2godGhpcyk7XG4gICAgICAgIHBhcmVudC5fbW9kYWwgPSB0aGlzO1xuICAgICAgICB0aGlzLl9tb2RhbFBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgdGhpcy5fbW9kYWxDb250ZXh0ID0gb3B0aW9ucy5jb250ZXh0O1xuICAgICAgICB2YXIgdGhhdCA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2Nsb3NlTW9kYWxDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbEFyZ3MgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgb3JpZ2luYWxBcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhhdC5fY2xvc2VNb2RhbENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1vZGFsSW5kZXggPSBleHBvcnRzLl9yb290TW9kYWxWaWV3cy5pbmRleE9mKHRoYXQpO1xuICAgICAgICAgICAgICAgIGV4cG9ydHMuX3Jvb3RNb2RhbFZpZXdzLnNwbGljZShtb2RhbEluZGV4KTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9tb2RhbFBhcmVudCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhhdC5fbW9kYWxDb250ZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGF0Ll9jbG9zZU1vZGFsQ2FsbGJhY2sgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoYXQuX2RpYWxvZ0Nsb3NlZCgpO1xuICAgICAgICAgICAgICAgIHBhcmVudC5fbW9kYWwgPSBudWxsO1xuICAgICAgICAgICAgICAgIHZhciB3aGVuQ2xvc2VkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5jbG9zZUNhbGxiYWNrID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY2xvc2VDYWxsYmFjay5hcHBseSh1bmRlZmluZWQsIG9yaWdpbmFsQXJncyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoYXQuX2hpZGVOYXRpdmVNb2RhbFZpZXcocGFyZW50LCB3aGVuQ2xvc2VkQ2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JhaXNlTGF5b3V0Q2hhbmdlZEV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogVmlld0NvbW1vbi5sYXlvdXRDaGFuZ2VkRXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXNcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmFpc2VTaG93bk1vZGFsbHlFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICBldmVudE5hbWU6IFZpZXdDb21tb24uc2hvd25Nb2RhbGx5RXZlbnQsXG4gICAgICAgICAgICBvYmplY3Q6IHRoaXMsXG4gICAgICAgICAgICBjb250ZXh0OiB0aGlzLl9tb2RhbENvbnRleHQsXG4gICAgICAgICAgICBjbG9zZUNhbGxiYWNrOiB0aGlzLl9jbG9zZU1vZGFsQ2FsbGJhY2tcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ub3RpZnkoYXJncyk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmFpc2VTaG93aW5nTW9kYWxseUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJncyA9IHtcbiAgICAgICAgICAgIGV2ZW50TmFtZTogVmlld0NvbW1vbi5zaG93aW5nTW9kYWxseUV2ZW50LFxuICAgICAgICAgICAgb2JqZWN0OiB0aGlzLFxuICAgICAgICAgICAgY29udGV4dDogdGhpcy5fbW9kYWxDb250ZXh0LFxuICAgICAgICAgICAgY2xvc2VDYWxsYmFjazogdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubm90aWZ5KGFyZ3MpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2lzRXZlbnQgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciAmJiBuYW1lICsgXCJFdmVudFwiIGluIHRoaXMuY29uc3RydWN0b3I7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fZGlzY29ubmVjdEdlc3R1cmVPYnNlcnZlcnMgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICB2YXIgb2JzZXJ2ZXJzID0gdGhpcy5nZXRHZXN0dXJlT2JzZXJ2ZXJzKHR5cGUpO1xuICAgICAgICBpZiAob2JzZXJ2ZXJzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9ic2VydmVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIG9ic2VydmVyc1tpXS5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BDb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJSaWdodENvbG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJSaWdodENvbG9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJSaWdodENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21Db2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tQ29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbUNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJMZWZ0Q29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckxlZnRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyTGVmdENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlcldpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BXaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJSaWdodFdpZHRoXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJSaWdodFdpZHRoO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJSaWdodFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21XaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJMZWZ0V2lkdGhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlckxlZnRXaWR0aDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyTGVmdFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJSYWRpdXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJvcmRlclJhZGl1cztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYm9yZGVyUmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BMZWZ0UmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJUb3BSaWdodFJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyVG9wUmlnaHRSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlclRvcFJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21SaWdodFJhZGl1c1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJib3JkZXJCb3R0b21MZWZ0UmFkaXVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJjb2xvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuY29sb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmNvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kQ29sb3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kSW1hZ2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRJbWFnZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kU2l6ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYmFja2dyb3VuZFNpemU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmJhY2tncm91bmRTaXplID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kUG9zaXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmJhY2tncm91bmRQb3NpdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJiYWNrZ3JvdW5kUmVwZWF0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kUmVwZWF0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5iYWNrZ3JvdW5kUmVwZWF0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtaW5XaWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWluV2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1pbldpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtaW5IZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1pbkhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWluSGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ3aWR0aFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2lkdGg7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLndpZHRoID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJoZWlnaHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmhlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuaGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5MZWZ0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5tYXJnaW5MZWZ0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5tYXJnaW5MZWZ0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5Ub3BcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpblRvcDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luVG9wID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5SaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUubWFyZ2luUmlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLm1hcmdpblJpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJtYXJnaW5Cb3R0b21cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLm1hcmdpbkJvdHRvbTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUubWFyZ2luQm90dG9tID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJob3Jpem9udGFsQWxpZ25tZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5ob3Jpem9udGFsQWxpZ25tZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ2ZXJ0aWNhbEFsaWdubWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudmVydGljYWxBbGlnbm1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnZlcnRpY2FsQWxpZ25tZW50ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ2aXNpYmlsaXR5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS52aXNpYmlsaXR5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS52aXNpYmlsaXR5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJvcGFjaXR5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5vcGFjaXR5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5vcGFjaXR5ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJyb3RhdGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnJvdGF0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucm90YXRlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ0cmFuc2xhdGVYXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50cmFuc2xhdGVYO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50cmFuc2xhdGVYID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJ0cmFuc2xhdGVZXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50cmFuc2xhdGVZO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50cmFuc2xhdGVZID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJzY2FsZVhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNjYWxlWDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2NhbGVYID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJzY2FsZVlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnNjYWxlWTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuc2NhbGVZID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJhbmRyb2lkRWxldmF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5hbmRyb2lkRWxldmF0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5hbmRyb2lkRWxldmF0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJhbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmFuZHJvaWREeW5hbWljRWxldmF0aW9uT2Zmc2V0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3Q29tbW9uLnByb3RvdHlwZSwgXCJpc0xheW91dFZhbGlkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faXNMYXlvdXRWYWxpZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImNzc1R5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fY3NzVHlwZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Nzc1R5cGUgPSB0aGlzLnR5cGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY3NzVHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgdGhpcy5fY3NzVHlwZSA9IHR5cGUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXdDb21tb24ucHJvdG90eXBlLCBcImlzTGF5b3V0UmVxdWlyZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5tZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHRoaXMuX3NldEN1cnJlbnRNZWFzdXJlU3BlY3Mod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICB0aGlzLl9zZXRDdXJyZW50TGF5b3V0Qm91bmRzKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRNZWFzdXJlZFdpZHRoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWVhc3VyZWRXaWR0aCAmIHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TSVpFX01BU0sgfHwgMDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldE1lYXN1cmVkSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWVhc3VyZWRIZWlnaHQgJiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU0laRV9NQVNLIHx8IDA7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRNZWFzdXJlZFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuX21lYXN1cmVkV2lkdGggJiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfU1RBVEVfTUFTSylcbiAgICAgICAgICAgIHwgKCh0aGlzLl9tZWFzdXJlZEhlaWdodCA+PiB2aWV3X2Jhc2VfMS5sYXlvdXQuTUVBU1VSRURfSEVJR0hUX1NUQVRFX1NISUZUKVxuICAgICAgICAgICAgICAgICYgKHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9NQVNLID4+IHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9IRUlHSFRfU1RBVEVfU0hJRlQpKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLnNldE1lYXN1cmVkRGltZW5zaW9uID0gZnVuY3Rpb24gKG1lYXN1cmVkV2lkdGgsIG1lYXN1cmVkSGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX21lYXN1cmVkV2lkdGggPSBtZWFzdXJlZFdpZHRoO1xuICAgICAgICB0aGlzLl9tZWFzdXJlZEhlaWdodCA9IG1lYXN1cmVkSGVpZ2h0O1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUodGhpcyArIFwiIDpzZXRNZWFzdXJlZERpbWVuc2lvbjogXCIgKyBtZWFzdXJlZFdpZHRoICsgXCIsIFwiICsgbWVhc3VyZWRIZWlnaHQsIHZpZXdfYmFzZV8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9pc0xheW91dFZhbGlkID0gZmFsc2U7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUucmVxdWVzdExheW91dC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5yZXNvbHZlU2l6ZUFuZFN0YXRlID0gZnVuY3Rpb24gKHNpemUsIHNwZWNTaXplLCBzcGVjTW9kZSwgY2hpbGRNZWFzdXJlZFN0YXRlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBzaXplO1xuICAgICAgICBzd2l0Y2ggKHNwZWNNb2RlKSB7XG4gICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRDpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmNlaWwoc2l6ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIHZpZXdfYmFzZV8xLmxheW91dC5BVF9NT1NUOlxuICAgICAgICAgICAgICAgIGlmIChzcGVjU2l6ZSA8IHNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gTWF0aC5jZWlsKHNwZWNTaXplKSB8IHZpZXdfYmFzZV8xLmxheW91dC5NRUFTVVJFRF9TVEFURV9UT09fU01BTEw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWTpcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBNYXRoLmNlaWwoc3BlY1NpemUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQgfCAoY2hpbGRNZWFzdXJlZFN0YXRlICYgdmlld19iYXNlXzEubGF5b3V0Lk1FQVNVUkVEX1NUQVRFX01BU0spO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5jb21iaW5lTWVhc3VyZWRTdGF0ZXMgPSBmdW5jdGlvbiAoY3VyU3RhdGUsIG5ld1N0YXRlKSB7XG4gICAgICAgIHJldHVybiBjdXJTdGF0ZSB8IG5ld1N0YXRlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5sYXlvdXRDaGlsZCA9IGZ1bmN0aW9uIChwYXJlbnQsIGNoaWxkLCBsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20sIHNldEZyYW1lKSB7XG4gICAgICAgIGlmIChzZXRGcmFtZSA9PT0gdm9pZCAwKSB7IHNldEZyYW1lID0gdHJ1ZTsgfVxuICAgICAgICBpZiAoIWNoaWxkIHx8IGNoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNoaWxkU3R5bGUgPSBjaGlsZC5zdHlsZTtcbiAgICAgICAgdmFyIGNoaWxkVG9wO1xuICAgICAgICB2YXIgY2hpbGRMZWZ0O1xuICAgICAgICB2YXIgY2hpbGRXaWR0aCA9IGNoaWxkLmdldE1lYXN1cmVkV2lkdGgoKTtcbiAgICAgICAgdmFyIGNoaWxkSGVpZ2h0ID0gY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKTtcbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpblRvcCA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpblRvcDtcbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbSA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgdmFyIHZBbGlnbm1lbnQ7XG4gICAgICAgIGlmIChjaGlsZC5lZmZlY3RpdmVIZWlnaHQgPj0gMCAmJiBjaGlsZFN0eWxlLnZlcnRpY2FsQWxpZ25tZW50ID09PSBcInN0cmV0Y2hcIikge1xuICAgICAgICAgICAgdkFsaWdubWVudCA9IFwibWlkZGxlXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2QWxpZ25tZW50ID0gY2hpbGRTdHlsZS52ZXJ0aWNhbEFsaWdubWVudDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHZBbGlnbm1lbnQpIHtcbiAgICAgICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IHRvcCArIGVmZmVjdGl2ZU1hcmdpblRvcDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJtaWRkbGVcIjpcbiAgICAgICAgICAgICAgICBjaGlsZFRvcCA9IHRvcCArIChib3R0b20gLSB0b3AgLSBjaGlsZEhlaWdodCArIChlZmZlY3RpdmVNYXJnaW5Ub3AgLSBlZmZlY3RpdmVNYXJnaW5Cb3R0b20pKSAvIDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiYm90dG9tXCI6XG4gICAgICAgICAgICAgICAgY2hpbGRUb3AgPSBib3R0b20gLSBjaGlsZEhlaWdodCAtIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzdHJldGNoXCI6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGNoaWxkVG9wID0gdG9wICsgZWZmZWN0aXZlTWFyZ2luVG9wO1xuICAgICAgICAgICAgICAgIGNoaWxkSGVpZ2h0ID0gYm90dG9tIC0gdG9wIC0gKGVmZmVjdGl2ZU1hcmdpblRvcCArIGVmZmVjdGl2ZU1hcmdpbkJvdHRvbSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVmZmVjdGl2ZU1hcmdpbkxlZnQgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5MZWZ0O1xuICAgICAgICB2YXIgZWZmZWN0aXZlTWFyZ2luUmlnaHQgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgdmFyIGhBbGlnbm1lbnQ7XG4gICAgICAgIGlmIChjaGlsZC5lZmZlY3RpdmVXaWR0aCA+PSAwICYmIGNoaWxkU3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudCA9PT0gXCJzdHJldGNoXCIpIHtcbiAgICAgICAgICAgIGhBbGlnbm1lbnQgPSBcImNlbnRlclwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaEFsaWdubWVudCA9IGNoaWxkU3R5bGUuaG9yaXpvbnRhbEFsaWdubWVudDtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKGhBbGlnbm1lbnQpIHtcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gbGVmdCArIGVmZmVjdGl2ZU1hcmdpbkxlZnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY2VudGVyXCI6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gbGVmdCArIChyaWdodCAtIGxlZnQgLSBjaGlsZFdpZHRoICsgKGVmZmVjdGl2ZU1hcmdpbkxlZnQgLSBlZmZlY3RpdmVNYXJnaW5SaWdodCkpIC8gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICAgICAgICAgIGNoaWxkTGVmdCA9IHJpZ2h0IC0gY2hpbGRXaWR0aCAtIGVmZmVjdGl2ZU1hcmdpblJpZ2h0O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInN0cmV0Y2hcIjpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgY2hpbGRMZWZ0ID0gbGVmdCArIGVmZmVjdGl2ZU1hcmdpbkxlZnQ7XG4gICAgICAgICAgICAgICAgY2hpbGRXaWR0aCA9IHJpZ2h0IC0gbGVmdCAtIChlZmZlY3RpdmVNYXJnaW5MZWZ0ICsgZWZmZWN0aXZlTWFyZ2luUmlnaHQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjaGlsZFJpZ2h0ID0gTWF0aC5yb3VuZChjaGlsZExlZnQgKyBjaGlsZFdpZHRoKTtcbiAgICAgICAgdmFyIGNoaWxkQm90dG9tID0gTWF0aC5yb3VuZChjaGlsZFRvcCArIGNoaWxkSGVpZ2h0KTtcbiAgICAgICAgY2hpbGRMZWZ0ID0gTWF0aC5yb3VuZChjaGlsZExlZnQpO1xuICAgICAgICBjaGlsZFRvcCA9IE1hdGgucm91bmQoY2hpbGRUb3ApO1xuICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIHZpZXdfYmFzZV8xLnRyYWNlV3JpdGUoY2hpbGQucGFyZW50ICsgXCIgOmxheW91dENoaWxkOiBcIiArIGNoaWxkICsgXCIgXCIgKyBjaGlsZExlZnQgKyBcIiwgXCIgKyBjaGlsZFRvcCArIFwiLCBcIiArIGNoaWxkUmlnaHQgKyBcIiwgXCIgKyBjaGlsZEJvdHRvbSwgdmlld19iYXNlXzEudHJhY2VDYXRlZ29yaWVzLkxheW91dCk7XG4gICAgICAgIH1cbiAgICAgICAgY2hpbGQubGF5b3V0KGNoaWxkTGVmdCwgY2hpbGRUb3AsIGNoaWxkUmlnaHQsIGNoaWxkQm90dG9tLCBzZXRGcmFtZSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLm1lYXN1cmVDaGlsZCA9IGZ1bmN0aW9uIChwYXJlbnQsIGNoaWxkLCB3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgbWVhc3VyZVdpZHRoID0gMDtcbiAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSAwO1xuICAgICAgICBpZiAoY2hpbGQgJiYgIWNoaWxkLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGhTcGVjID0gcGFyZW50ID8gcGFyZW50Ll9jdXJyZW50V2lkdGhNZWFzdXJlU3BlYyA6IHdpZHRoTWVhc3VyZVNwZWM7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0U3BlYyA9IHBhcmVudCA/IHBhcmVudC5fY3VycmVudEhlaWdodE1lYXN1cmVTcGVjIDogaGVpZ2h0TWVhc3VyZVNwZWM7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHdpZHRoU3BlYyk7XG4gICAgICAgICAgICB2YXIgd2lkdGhNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aFNwZWMpO1xuICAgICAgICAgICAgdmFyIGhlaWdodCA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0U3BlYyk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUoaGVpZ2h0U3BlYyk7XG4gICAgICAgICAgICBjaGlsZC5fdXBkYXRlRWZmZWN0aXZlTGF5b3V0VmFsdWVzKHdpZHRoLCB3aWR0aE1vZGUsIGhlaWdodCwgaGVpZ2h0TW9kZSk7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSBjaGlsZC5zdHlsZTtcbiAgICAgICAgICAgIHZhciBob3Jpem9udGFsTWFyZ2lucyA9IGNoaWxkLmVmZmVjdGl2ZU1hcmdpbkxlZnQgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5SaWdodDtcbiAgICAgICAgICAgIHZhciB2ZXJ0aWNhbE1hcmdpbnMgPSBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Ub3AgKyBjaGlsZC5lZmZlY3RpdmVNYXJnaW5Cb3R0b207XG4gICAgICAgICAgICB2YXIgY2hpbGRXaWR0aE1lYXN1cmVTcGVjID0gVmlld0NvbW1vbi5nZXRNZWFzdXJlU3BlYyh3aWR0aE1lYXN1cmVTcGVjLCBob3Jpem9udGFsTWFyZ2lucywgY2hpbGQuZWZmZWN0aXZlV2lkdGgsIHN0eWxlLmhvcml6b250YWxBbGlnbm1lbnQgPT09IFwic3RyZXRjaFwiKTtcbiAgICAgICAgICAgIHZhciBjaGlsZEhlaWdodE1lYXN1cmVTcGVjID0gVmlld0NvbW1vbi5nZXRNZWFzdXJlU3BlYyhoZWlnaHRNZWFzdXJlU3BlYywgdmVydGljYWxNYXJnaW5zLCBjaGlsZC5lZmZlY3RpdmVIZWlnaHQsIHN0eWxlLnZlcnRpY2FsQWxpZ25tZW50ID09PSBcInN0cmV0Y2hcIik7XG4gICAgICAgICAgICBpZiAodmlld19iYXNlXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2Jhc2VfMS50cmFjZVdyaXRlKGNoaWxkLnBhcmVudCArIFwiIDptZWFzdXJlQ2hpbGQ6IFwiICsgY2hpbGQgKyBcIiBcIiArIHZpZXdfYmFzZV8xLmxheW91dC5tZWFzdXJlU3BlY1RvU3RyaW5nKGNoaWxkV2lkdGhNZWFzdXJlU3BlYykgKyBcIiwgXCIgKyB2aWV3X2Jhc2VfMS5sYXlvdXQubWVhc3VyZVNwZWNUb1N0cmluZyhjaGlsZEhlaWdodE1lYXN1cmVTcGVjKSArIFwifVwiLCB2aWV3X2Jhc2VfMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNoaWxkLm1lYXN1cmUoY2hpbGRXaWR0aE1lYXN1cmVTcGVjLCBjaGlsZEhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIG1lYXN1cmVXaWR0aCA9IE1hdGgucm91bmQoY2hpbGQuZ2V0TWVhc3VyZWRXaWR0aCgpICsgaG9yaXpvbnRhbE1hcmdpbnMpO1xuICAgICAgICAgICAgbWVhc3VyZUhlaWdodCA9IE1hdGgucm91bmQoY2hpbGQuZ2V0TWVhc3VyZWRIZWlnaHQoKSArIHZlcnRpY2FsTWFyZ2lucyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgbWVhc3VyZWRXaWR0aDogbWVhc3VyZVdpZHRoLCBtZWFzdXJlZEhlaWdodDogbWVhc3VyZUhlaWdodCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5nZXRNZWFzdXJlU3BlYyA9IGZ1bmN0aW9uIChwYXJlbnRTcGVjLCBtYXJnaW5zLCBjaGlsZExlbmd0aCwgc3RyZXRjaGVkKSB7XG4gICAgICAgIHZhciBwYXJlbnRMZW5ndGggPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKHBhcmVudFNwZWMpO1xuICAgICAgICB2YXIgcGFyZW50U3BlY01vZGUgPSB2aWV3X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHBhcmVudFNwZWMpO1xuICAgICAgICB2YXIgcmVzdWx0U2l6ZTtcbiAgICAgICAgdmFyIHJlc3VsdE1vZGU7XG4gICAgICAgIGlmIChjaGlsZExlbmd0aCA+PSAwKSB7XG4gICAgICAgICAgICByZXN1bHRTaXplID0gcGFyZW50U3BlY01vZGUgPT09IHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRCA/IGNoaWxkTGVuZ3RoIDogTWF0aC5taW4ocGFyZW50TGVuZ3RoLCBjaGlsZExlbmd0aCk7XG4gICAgICAgICAgICByZXN1bHRNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LkVYQUNUTFk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcmVudFNwZWNNb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWTpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IE1hdGgubWF4KDAsIHBhcmVudExlbmd0aCAtIG1hcmdpbnMpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gc3RyZXRjaGVkID8gdmlld19iYXNlXzEubGF5b3V0LkVYQUNUTFkgOiB2aWV3X2Jhc2VfMS5sYXlvdXQuQVRfTU9TVDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSB2aWV3X2Jhc2VfMS5sYXlvdXQuQVRfTU9TVDpcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0U2l6ZSA9IE1hdGgubWF4KDAsIHBhcmVudExlbmd0aCAtIG1hcmdpbnMpO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHRNb2RlID0gdmlld19iYXNlXzEubGF5b3V0LkFUX01PU1Q7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2Ugdmlld19iYXNlXzEubGF5b3V0LlVOU1BFQ0lGSUVEOlxuICAgICAgICAgICAgICAgICAgICByZXN1bHRTaXplID0gMDtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0TW9kZSA9IHZpZXdfYmFzZV8xLmxheW91dC5VTlNQRUNJRklFRDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXdfYmFzZV8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMocmVzdWx0U2l6ZSwgcmVzdWx0TW9kZSk7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fc2V0Q3VycmVudE1lYXN1cmVTcGVjcyA9IGZ1bmN0aW9uICh3aWR0aE1lYXN1cmVTcGVjLCBoZWlnaHRNZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgY2hhbmdlZCA9IHRoaXMuX2N1cnJlbnRXaWR0aE1lYXN1cmVTcGVjICE9PSB3aWR0aE1lYXN1cmVTcGVjIHx8IHRoaXMuX2N1cnJlbnRIZWlnaHRNZWFzdXJlU3BlYyAhPT0gaGVpZ2h0TWVhc3VyZVNwZWM7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRXaWR0aE1lYXN1cmVTcGVjID0gd2lkdGhNZWFzdXJlU3BlYztcbiAgICAgICAgdGhpcy5fY3VycmVudEhlaWdodE1lYXN1cmVTcGVjID0gaGVpZ2h0TWVhc3VyZVNwZWM7XG4gICAgICAgIHJldHVybiBjaGFuZ2VkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldEN1cnJlbnRMYXlvdXRCb3VuZHMgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgICAgIHRoaXMuX2lzTGF5b3V0VmFsaWQgPSB0cnVlO1xuICAgICAgICB2YXIgYm91bmRzQ2hhbmdlZCA9IHRoaXMuX29sZExlZnQgIT09IGxlZnQgfHwgdGhpcy5fb2xkVG9wICE9PSB0b3AgfHwgdGhpcy5fb2xkUmlnaHQgIT09IHJpZ2h0IHx8IHRoaXMuX29sZEJvdHRvbSAhPT0gYm90dG9tO1xuICAgICAgICB2YXIgc2l6ZUNoYW5nZWQgPSAodGhpcy5fb2xkUmlnaHQgLSB0aGlzLl9vbGRMZWZ0ICE9PSByaWdodCAtIGxlZnQpIHx8ICh0aGlzLl9vbGRCb3R0b20gLSB0aGlzLl9vbGRUb3AgIT09IGJvdHRvbSAtIHRvcCk7XG4gICAgICAgIHRoaXMuX29sZExlZnQgPSBsZWZ0O1xuICAgICAgICB0aGlzLl9vbGRUb3AgPSB0b3A7XG4gICAgICAgIHRoaXMuX29sZFJpZ2h0ID0gcmlnaHQ7XG4gICAgICAgIHRoaXMuX29sZEJvdHRvbSA9IGJvdHRvbTtcbiAgICAgICAgcmV0dXJuIHsgYm91bmRzQ2hhbmdlZDogYm91bmRzQ2hhbmdlZCwgc2l6ZUNoYW5nZWQ6IHNpemVDaGFuZ2VkIH07XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5lYWNoQ2hpbGQgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdGhpcy5lYWNoQ2hpbGRWaWV3KGNhbGxiYWNrKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXROYXRpdmVWaWV3c0NvdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faXNBZGRlZFRvTmF0aXZlVmlzdWFsVHJlZSA/IDEgOiAwO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX2VhY2hMYXlvdXRWaWV3ID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFjayh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0U2FmZUFyZWFJbnNldHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuZ2V0TG9jYXRpb25JbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLmdldExvY2F0aW9uT25TY3JlZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRMb2NhdGlvblJlbGF0aXZlVG8gPSBmdW5jdGlvbiAob3RoZXJWaWV3KSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5nZXRBY3R1YWxTaXplID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VycmVudEJvdW5kcyA9IHRoaXMuX2dldEN1cnJlbnRMYXlvdXRCb3VuZHMoKTtcbiAgICAgICAgaWYgKCFjdXJyZW50Qm91bmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogdmlld19iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoY3VycmVudEJvdW5kcy5yaWdodCAtIGN1cnJlbnRCb3VuZHMubGVmdCksXG4gICAgICAgICAgICBoZWlnaHQ6IHZpZXdfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGN1cnJlbnRCb3VuZHMuYm90dG9tIC0gY3VycmVudEJvdW5kcy50b3ApLFxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuYW5pbWF0ZSA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlQW5pbWF0aW9uKGFuaW1hdGlvbikucGxheSgpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuY3JlYXRlQW5pbWF0aW9uID0gZnVuY3Rpb24gKGFuaW1hdGlvbikge1xuICAgICAgICBlbnN1cmVBbmltYXRpb25Nb2R1bGUoKTtcbiAgICAgICAgaWYgKCF0aGlzLl9sb2NhbEFuaW1hdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvY2FsQW5pbWF0aW9ucyA9IG5ldyBTZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBhbmltYXRpb24udGFyZ2V0ID0gdGhpcztcbiAgICAgICAgdmFyIGFuaW0gPSBuZXcgYW5pbWF0aW9uTW9kdWxlLkFuaW1hdGlvbihbYW5pbWF0aW9uXSk7XG4gICAgICAgIHRoaXMuX2xvY2FsQW5pbWF0aW9ucy5hZGQoYW5pbSk7XG4gICAgICAgIHJldHVybiBhbmltO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3JlbW92ZUFuaW1hdGlvbiA9IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcbiAgICAgICAgdmFyIGxvY2FsQW5pbWF0aW9ucyA9IHRoaXMuX2xvY2FsQW5pbWF0aW9ucztcbiAgICAgICAgaWYgKGxvY2FsQW5pbWF0aW9ucyAmJiBsb2NhbEFuaW1hdGlvbnMuaGFzKGFuaW1hdGlvbikpIHtcbiAgICAgICAgICAgIGxvY2FsQW5pbWF0aW9ucy5kZWxldGUoYW5pbWF0aW9uKTtcbiAgICAgICAgICAgIGlmIChhbmltYXRpb24uaXNQbGF5aW5nKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uLmNhbmNlbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUucmVzZXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5fbG9jYWxBbmltYXRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2NhbEFuaW1hdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoYSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZUFuaW1hdGlvbihhKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXNldE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXROYXRpdmVWaWV3RnJhbWUgPSBmdW5jdGlvbiAobmF0aXZlVmlldywgZnJhbWUpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9nZXRWYWx1ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIFZpZXcuX2dldFZhbHVlIGlzIG9ic29sZXRlLiBUaGVyZSBpcyBhIG5ldyBwcm9wZXJ0eSBzeXN0ZW0uXCIpO1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX3NldFZhbHVlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGUgVmlldy5fc2V0VmFsdWUgaXMgb2Jzb2xldGUuIFRoZXJlIGlzIGEgbmV3IHByb3BlcnR5IHN5c3RlbS5cIik7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fdXBkYXRlRWZmZWN0aXZlTGF5b3V0VmFsdWVzID0gZnVuY3Rpb24gKHBhcmVudFdpZHRoTWVhc3VyZVNpemUsIHBhcmVudFdpZHRoTWVhc3VyZU1vZGUsIHBhcmVudEhlaWdodE1lYXN1cmVTaXplLCBwYXJlbnRIZWlnaHRNZWFzdXJlTW9kZSkge1xuICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLnN0eWxlO1xuICAgICAgICB2YXIgYXZhaWxhYmxlV2lkdGggPSBwYXJlbnRXaWR0aE1lYXN1cmVNb2RlID09PSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyAtMSA6IHBhcmVudFdpZHRoTWVhc3VyZVNpemU7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlV2lkdGggPSBzdHlsZV9wcm9wZXJ0aWVzXzEuUGVyY2VudExlbmd0aC50b0RldmljZVBpeGVscyhzdHlsZS53aWR0aCwgLTIsIGF2YWlsYWJsZVdpZHRoKTtcbiAgICAgICAgdGhpcy5lZmZlY3RpdmVNYXJnaW5MZWZ0ID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luTGVmdCwgMCwgYXZhaWxhYmxlV2lkdGgpO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZU1hcmdpblJpZ2h0ID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luUmlnaHQsIDAsIGF2YWlsYWJsZVdpZHRoKTtcbiAgICAgICAgdmFyIGF2YWlsYWJsZUhlaWdodCA9IHBhcmVudEhlaWdodE1lYXN1cmVNb2RlID09PSB2aWV3X2Jhc2VfMS5sYXlvdXQuVU5TUEVDSUZJRUQgPyAtMSA6IHBhcmVudEhlaWdodE1lYXN1cmVTaXplO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZUhlaWdodCA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLmhlaWdodCwgLTIsIGF2YWlsYWJsZUhlaWdodCk7XG4gICAgICAgIHRoaXMuZWZmZWN0aXZlTWFyZ2luVG9wID0gc3R5bGVfcHJvcGVydGllc18xLlBlcmNlbnRMZW5ndGgudG9EZXZpY2VQaXhlbHMoc3R5bGUubWFyZ2luVG9wLCAwLCBhdmFpbGFibGVIZWlnaHQpO1xuICAgICAgICB0aGlzLmVmZmVjdGl2ZU1hcmdpbkJvdHRvbSA9IHN0eWxlX3Byb3BlcnRpZXNfMS5QZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKHN0eWxlLm1hcmdpbkJvdHRvbSwgMCwgYXZhaWxhYmxlSGVpZ2h0KTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9zZXROYXRpdmVDbGlwVG9Cb3VuZHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgfTtcbiAgICBWaWV3Q29tbW9uLnByb3RvdHlwZS5fcmVkcmF3TmF0aXZlQmFja2dyb3VuZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVmlld0NvbW1vbi5wcm90b3R5cGUuX29uQXR0YWNoZWRUb1dpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9vbkRldGFjaGVkRnJvbVdpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ucHJvdG90eXBlLl9oYXNBbmNlc3RvclZpZXcgPSBmdW5jdGlvbiAoYW5jZXN0b3JWaWV3KSB7XG4gICAgICAgIHZhciBtYXRjaGVyID0gZnVuY3Rpb24gKHZpZXcpIHsgcmV0dXJuIHZpZXcgPT09IGFuY2VzdG9yVmlldzsgfTtcbiAgICAgICAgZm9yICh2YXIgcGFyZW50XzIgPSB0aGlzLnBhcmVudDsgcGFyZW50XzIgIT0gbnVsbDsgcGFyZW50XzIgPSBwYXJlbnRfMi5wYXJlbnQpIHtcbiAgICAgICAgICAgIGlmIChtYXRjaGVyKHBhcmVudF8yKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXdDb21tb24ubGF5b3V0Q2hhbmdlZEV2ZW50ID0gXCJsYXlvdXRDaGFuZ2VkXCI7XG4gICAgVmlld0NvbW1vbi5zaG93bk1vZGFsbHlFdmVudCA9IFwic2hvd25Nb2RhbGx5XCI7XG4gICAgVmlld0NvbW1vbi5zaG93aW5nTW9kYWxseUV2ZW50ID0gXCJzaG93aW5nTW9kYWxseVwiO1xuICAgIHJldHVybiBWaWV3Q29tbW9uO1xufSh2aWV3X2Jhc2VfMS5WaWV3QmFzZSkpO1xuZXhwb3J0cy5WaWV3Q29tbW9uID0gVmlld0NvbW1vbjtcbmV4cG9ydHMuYXV0b21hdGlvblRleHRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYXV0b21hdGlvblRleHRcIiB9KTtcbmV4cG9ydHMuYXV0b21hdGlvblRleHRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMub3JpZ2luWFByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJvcmlnaW5YXCIsIGRlZmF1bHRWYWx1ZTogMC41LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLm9yaWdpblhQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMub3JpZ2luWVByb3BlcnR5ID0gbmV3IHZpZXdfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJvcmlnaW5ZXCIsIGRlZmF1bHRWYWx1ZTogMC41LCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH0gfSk7XG5leHBvcnRzLm9yaWdpbllQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMuaXNFbmFibGVkUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiaXNFbmFibGVkXCIsXG4gICAgZGVmYXVsdFZhbHVlOiB0cnVlLFxuICAgIHZhbHVlQ29udmVydGVyOiB2aWV3X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHRhcmdldC5fZ29Ub1Zpc3VhbFN0YXRlKG5ld1ZhbHVlID8gXCJub3JtYWxcIiA6IFwiZGlzYWJsZWRcIik7XG4gICAgfVxufSk7XG5leHBvcnRzLmlzRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5pc1VzZXJJbnRlcmFjdGlvbkVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkXCIsIGRlZmF1bHRWYWx1ZTogdHJ1ZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmlzVXNlckludGVyYWN0aW9uRW5hYmxlZFByb3BlcnR5LnJlZ2lzdGVyKFZpZXdDb21tb24pO1xuZXhwb3J0cy5pb3NPdmVyZmxvd1NhZmVBcmVhUHJvcGVydHkgPSBuZXcgdmlld19iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImlvc092ZXJmbG93U2FmZUFyZWFcIiwgZGVmYXVsdFZhbHVlOiBmYWxzZSwgdmFsdWVDb252ZXJ0ZXI6IHZpZXdfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIgfSk7XG5leHBvcnRzLmlvc092ZXJmbG93U2FmZUFyZWFQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbmV4cG9ydHMuaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWRQcm9wZXJ0eSA9IG5ldyB2aWV3X2Jhc2VfMS5Jbmhlcml0ZWRQcm9wZXJ0eSh7IG5hbWU6IFwiaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWRcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdmlld19iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWRQcm9wZXJ0eS5yZWdpc3RlcihWaWV3Q29tbW9uKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZXctY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld19jb21tb25fMSA9IHJlcXVpcmUoXCIuL3ZpZXctY29tbW9uXCIpO1xudmFyIGJhY2tncm91bmRfMSA9IHJlcXVpcmUoXCIuLi8uLi9zdHlsaW5nL2JhY2tncm91bmRcIik7XG52YXIgdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy91dGlsc1wiKTtcbnZhciBzdHlsZV9wcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vLi4vc3R5bGluZy9zdHlsZS1wcm9wZXJ0aWVzXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3ZpZXctY29tbW9uXCIpKTtcbnZhciBQRkxBR19GT1JDRV9MQVlPVVQgPSAxO1xudmFyIFBGTEFHX01FQVNVUkVEX0RJTUVOU0lPTl9TRVQgPSAxIDw8IDE7XG52YXIgUEZMQUdfTEFZT1VUX1JFUVVJUkVEID0gMSA8PCAyO1xudmFyIG1ham9yVmVyc2lvbiA9IHV0aWxzXzEuaW9zLk1ham9yVmVyc2lvbjtcbnZhciBWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVmlldywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBWaWV3KCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2lzTGFpZE91dCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5faGFzVHJhbnNmcm9tID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9wcml2YXRlRmxhZ3MgPSBQRkxBR19MQVlPVVRfUkVRVUlSRUQgfCBQRkxBR19GT1JDRV9MQVlPVVQ7XG4gICAgICAgIF90aGlzLl9zdXNwZW5kQ0FUcmFuc2FjdGlvbiA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShWaWV3LnByb3RvdHlwZSwgXCJpc0xheW91dFJlcXVpcmVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX3ByaXZhdGVGbGFncyAmIFBGTEFHX0xBWU9VVF9SRVFVSVJFRCkgPT09IFBGTEFHX0xBWU9VVF9SRVFVSVJFRDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcucHJvdG90eXBlLCBcImlzTGF5b3V0UmVxdWVzdGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuX3ByaXZhdGVGbGFncyAmIFBGTEFHX0ZPUkNFX0xBWU9VVCkgPT09IFBGTEFHX0ZPUkNFX0xBWU9VVDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVmlldy5wcm90b3R5cGUucmVxdWVzdExheW91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZXF1ZXN0TGF5b3V0LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX3ByaXZhdGVGbGFncyB8PSBQRkxBR19GT1JDRV9MQVlPVVQ7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldykge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXROZWVkc0xheW91dCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnZpZXdDb250cm9sbGVyICYmIHRoaXMudmlld0NvbnRyb2xsZXIudmlldyAhPT0gbmF0aXZlVmlldykge1xuICAgICAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlci52aWV3LnNldE5lZWRzTGF5b3V0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLm1lYXN1cmUgPSBmdW5jdGlvbiAod2lkdGhNZWFzdXJlU3BlYywgaGVpZ2h0TWVhc3VyZVNwZWMpIHtcbiAgICAgICAgdmFyIG1lYXN1cmVTcGVjc0NoYW5nZWQgPSB0aGlzLl9zZXRDdXJyZW50TWVhc3VyZVNwZWNzKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIGZvcmNlTGF5b3V0ID0gKHRoaXMuX3ByaXZhdGVGbGFncyAmIFBGTEFHX0ZPUkNFX0xBWU9VVCkgPT09IFBGTEFHX0ZPUkNFX0xBWU9VVDtcbiAgICAgICAgaWYgKGZvcmNlTGF5b3V0IHx8IG1lYXN1cmVTcGVjc0NoYW5nZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3ByaXZhdGVGbGFncyAmPSB+UEZMQUdfTUVBU1VSRURfRElNRU5TSU9OX1NFVDtcbiAgICAgICAgICAgIHRoaXMub25NZWFzdXJlKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHRoaXMuX3ByaXZhdGVGbGFncyB8PSBQRkxBR19MQVlPVVRfUkVRVUlSRUQ7XG4gICAgICAgICAgICBpZiAoKHRoaXMuX3ByaXZhdGVGbGFncyAmIFBGTEFHX01FQVNVUkVEX0RJTUVOU0lPTl9TRVQpICE9PSBQRkxBR19NRUFTVVJFRF9ESU1FTlNJT05fU0VUKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwib25NZWFzdXJlKCkgZGlkIG5vdCBzZXQgdGhlIG1lYXN1cmVkIGRpbWVuc2lvbiBieSBjYWxsaW5nIHNldE1lYXN1cmVkRGltZW5zaW9uKCkgXCIgKyB0aGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSwgc2V0RnJhbWUpIHtcbiAgICAgICAgaWYgKHNldEZyYW1lID09PSB2b2lkIDApIHsgc2V0RnJhbWUgPSB0cnVlOyB9XG4gICAgICAgIHZhciBfYSA9IHRoaXMuX3NldEN1cnJlbnRMYXlvdXRCb3VuZHMobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSwgYm91bmRzQ2hhbmdlZCA9IF9hLmJvdW5kc0NoYW5nZWQsIHNpemVDaGFuZ2VkID0gX2Euc2l6ZUNoYW5nZWQ7XG4gICAgICAgIGlmIChzZXRGcmFtZSkge1xuICAgICAgICAgICAgdGhpcy5sYXlvdXROYXRpdmVWaWV3KGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJvdW5kc0NoYW5nZWQgfHwgKHRoaXMuX3ByaXZhdGVGbGFncyAmIFBGTEFHX0xBWU9VVF9SRVFVSVJFRCkgPT09IFBGTEFHX0xBWU9VVF9SRVFVSVJFRCkge1xuICAgICAgICAgICAgdmFyIHBvc2l0aW9uID0geyBsZWZ0OiBsZWZ0LCB0b3A6IHRvcCwgcmlnaHQ6IHJpZ2h0LCBib3R0b206IGJvdHRvbSB9O1xuICAgICAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiBtYWpvclZlcnNpb24gPiAxMCkge1xuICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5mcmFtZTtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShmcmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm9uTGF5b3V0KHBvc2l0aW9uLmxlZnQsIHBvc2l0aW9uLnRvcCwgcG9zaXRpb24ucmlnaHQsIHBvc2l0aW9uLmJvdHRvbSk7XG4gICAgICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgJj0gflBGTEFHX0xBWU9VVF9SRVFVSVJFRDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnVwZGF0ZUJhY2tncm91bmQoc2l6ZUNoYW5nZWQpO1xuICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgJj0gflBGTEFHX0ZPUkNFX0xBWU9VVDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLnVwZGF0ZUJhY2tncm91bmQgPSBmdW5jdGlvbiAoc2l6ZUNoYW5nZWQpIHtcbiAgICAgICAgaWYgKHNpemVDaGFuZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLl9vblNpemVDaGFuZ2VkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5fbmF0aXZlQmFja2dyb3VuZFN0YXRlID09PSBcImludmFsaWRcIikge1xuICAgICAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0aGlzLnN0eWxlLmJhY2tncm91bmRJbnRlcm5hbDtcbiAgICAgICAgICAgIHRoaXMuX3JlZHJhd05hdGl2ZUJhY2tncm91bmQoYmFja2dyb3VuZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLnNldE1lYXN1cmVkRGltZW5zaW9uID0gZnVuY3Rpb24gKG1lYXN1cmVkV2lkdGgsIG1lYXN1cmVkSGVpZ2h0KSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuc2V0TWVhc3VyZWREaW1lbnNpb24uY2FsbCh0aGlzLCBtZWFzdXJlZFdpZHRoLCBtZWFzdXJlZEhlaWdodCk7XG4gICAgICAgIHRoaXMuX3ByaXZhdGVGbGFncyB8PSBQRkxBR19NRUFTVVJFRF9ESU1FTlNJT05fU0VUO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgd2lkdGggPSB2aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY01vZGUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHQgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUoaGVpZ2h0TWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0TW9kZSA9IHZpZXdfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBuYXRpdmVXaWR0aCA9IDA7XG4gICAgICAgIHZhciBuYXRpdmVIZWlnaHQgPSAwO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVNpemUgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5tZWFzdXJlTmF0aXZlVmlldyh2aWV3LCB3aWR0aCwgd2lkdGhNb2RlLCBoZWlnaHQsIGhlaWdodE1vZGUpO1xuICAgICAgICAgICAgbmF0aXZlV2lkdGggPSBuYXRpdmVTaXplLndpZHRoO1xuICAgICAgICAgICAgbmF0aXZlSGVpZ2h0ID0gbmF0aXZlU2l6ZS5oZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IE1hdGgubWF4KG5hdGl2ZVdpZHRoLCB0aGlzLmVmZmVjdGl2ZU1pbldpZHRoKTtcbiAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSBNYXRoLm1heChuYXRpdmVIZWlnaHQsIHRoaXMuZWZmZWN0aXZlTWluSGVpZ2h0KTtcbiAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSBWaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKG1lYXN1cmVIZWlnaHQsIGhlaWdodCwgaGVpZ2h0TW9kZSwgMCk7XG4gICAgICAgIHRoaXMuc2V0TWVhc3VyZWREaW1lbnNpb24od2lkdGhBbmRTdGF0ZSwgaGVpZ2h0QW5kU3RhdGUpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUub25MYXlvdXQgPSBmdW5jdGlvbiAobGVmdCwgdG9wLCByaWdodCwgYm90dG9tKSB7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fc2V0TmF0aXZlVmlld0ZyYW1lID0gZnVuY3Rpb24gKG5hdGl2ZVZpZXcsIGZyYW1lKSB7XG4gICAgICAgIHZhciBvbGRGcmFtZSA9IHRoaXMuX2NhY2hlZEZyYW1lIHx8IG5hdGl2ZVZpZXcuZnJhbWU7XG4gICAgICAgIGlmICghQ0dSZWN0RXF1YWxUb1JlY3Qob2xkRnJhbWUsIGZyYW1lKSkge1xuICAgICAgICAgICAgaWYgKHZpZXdfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUodGhpcyArIFwiIDpfc2V0TmF0aXZlVmlld0ZyYW1lOiBcIiArIEpTT04uc3RyaW5naWZ5KGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShmcmFtZSkpLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fY2FjaGVkRnJhbWUgPSBmcmFtZTtcbiAgICAgICAgICAgIHZhciBhZGp1c3RlZEZyYW1lID0gbnVsbDtcbiAgICAgICAgICAgIHZhciB0cmFuc2Zvcm0gPSBudWxsO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1RyYW5zZnJvbSkge1xuICAgICAgICAgICAgICAgIHRyYW5zZm9ybSA9IG5hdGl2ZVZpZXcudHJhbnNmb3JtO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcudHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1JZGVudGl0eTtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmZyYW1lID0gZnJhbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGp1c3RlZEZyYW1lID0gdGhpcy5hcHBseVNhZmVBcmVhSW5zZXRzKGZyYW1lKTtcbiAgICAgICAgICAgIGlmIChhZGp1c3RlZEZyYW1lKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5mcmFtZSA9IGFkanVzdGVkRnJhbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5faGFzVHJhbnNmcm9tKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy50cmFuc2Zvcm0gPSB0cmFuc2Zvcm07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgYm91bmRzT3JpZ2luID0gbmF0aXZlVmlldy5ib3VuZHMub3JpZ2luO1xuICAgICAgICAgICAgdmFyIGJvdW5kc0ZyYW1lID0gYWRqdXN0ZWRGcmFtZSB8fCBmcmFtZTtcbiAgICAgICAgICAgIG5hdGl2ZVZpZXcuYm91bmRzID0gQ0dSZWN0TWFrZShib3VuZHNPcmlnaW4ueCwgYm91bmRzT3JpZ2luLnksIGJvdW5kc0ZyYW1lLnNpemUud2lkdGgsIGJvdW5kc0ZyYW1lLnNpemUuaGVpZ2h0KTtcbiAgICAgICAgICAgIHRoaXMuX3JhaXNlTGF5b3V0Q2hhbmdlZEV2ZW50KCk7XG4gICAgICAgICAgICB0aGlzLl9pc0xhaWRPdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCF0aGlzLl9pc0xhaWRPdXQpIHtcbiAgICAgICAgICAgIHRoaXMuX3JhaXNlTGF5b3V0Q2hhbmdlZEV2ZW50KCk7XG4gICAgICAgICAgICB0aGlzLl9pc0xhaWRPdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVmlldy5wcm90b3R5cGUsIFwiaXNMYXlvdXRWYWxpZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9pc0xheW91dFZhbGlkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBWaWV3LnByb3RvdHlwZS5sYXlvdXROYXRpdmVWaWV3ID0gZnVuY3Rpb24gKGxlZnQsIHRvcCwgcmlnaHQsIGJvdHRvbSkge1xuICAgICAgICBpZiAoIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgZnJhbWUgPSBpb3MuZ2V0RnJhbWVGcm9tUG9zaXRpb24oeyBsZWZ0OiBsZWZ0LCB0b3A6IHRvcCwgcmlnaHQ6IHJpZ2h0LCBib3R0b206IGJvdHRvbSB9KTtcbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVmlld0ZyYW1lKG5hdGl2ZVZpZXcsIGZyYW1lKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9zZXRMYXlvdXRGbGFncyA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICAgICAgdmFyIHdpZHRoID0gcmlnaHQgLSBsZWZ0O1xuICAgICAgICB2YXIgaGVpZ2h0ID0gYm90dG9tIC0gdG9wO1xuICAgICAgICB2YXIgd2lkdGhTcGVjID0gdmlld19jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHdpZHRoLCB2aWV3X2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgdmFyIGhlaWdodFNwZWMgPSB2aWV3X2NvbW1vbl8xLmxheW91dC5tYWtlTWVhc3VyZVNwZWMoaGVpZ2h0LCB2aWV3X2NvbW1vbl8xLmxheW91dC5FWEFDVExZKTtcbiAgICAgICAgdGhpcy5fc2V0Q3VycmVudE1lYXN1cmVTcGVjcyh3aWR0aFNwZWMsIGhlaWdodFNwZWMpO1xuICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgJj0gflBGTEFHX0ZPUkNFX0xBWU9VVDtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgdmFyIHNpemVDaGFuZ2VkID0gdGhpcy5fc2V0Q3VycmVudExheW91dEJvdW5kcyhsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pLnNpemVDaGFuZ2VkO1xuICAgICAgICB0aGlzLnVwZGF0ZUJhY2tncm91bmQoc2l6ZUNoYW5nZWQpO1xuICAgICAgICB0aGlzLl9wcml2YXRlRmxhZ3MgJj0gflBGTEFHX0xBWU9VVF9SRVFVSVJFRDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmZvY3VzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5pb3MpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmlvcy5iZWNvbWVGaXJzdFJlc3BvbmRlcigpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLmFwcGx5U2FmZUFyZWFJbnNldHMgPSBmdW5jdGlvbiAoZnJhbWUpIHtcbiAgICAgICAgaWYgKG1ham9yVmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmlvc092ZXJmbG93U2FmZUFyZWEgfHwgIXRoaXMuaW9zT3ZlcmZsb3dTYWZlQXJlYUVuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiBpb3Muc2hyaW5rVG9TYWZlQXJlYSh0aGlzLCBmcmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkICYmIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC53aW5kb3cpIHtcbiAgICAgICAgICAgIHJldHVybiBpb3MuZXhwYW5kQmV5b25kU2FmZUFyZWEodGhpcywgZnJhbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0U2FmZUFyZWFJbnNldHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzYWZlQXJlYUluc2V0cyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCAmJiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuc2FmZUFyZWFJbnNldHM7XG4gICAgICAgIHZhciBpbnNldHMgPSB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgICAgICBpZiAoc2FmZUFyZWFJbnNldHMpIHtcbiAgICAgICAgICAgIGluc2V0cy5sZWZ0ID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2FmZUFyZWFJbnNldHMubGVmdCkpO1xuICAgICAgICAgICAgaW5zZXRzLnRvcCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNhZmVBcmVhSW5zZXRzLnRvcCkpO1xuICAgICAgICAgICAgaW5zZXRzLnJpZ2h0ID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2FmZUFyZWFJbnNldHMucmlnaHQpKTtcbiAgICAgICAgICAgIGluc2V0cy5ib3R0b20gPSB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhzYWZlQXJlYUluc2V0cy5ib3R0b20pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaW5zZXRzO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TG9jYXRpb25JbldpbmRvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgfHwgIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC53aW5kb3cpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBvaW50SW5XaW5kb3cgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udmVydFBvaW50VG9WaWV3KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5ib3VuZHMub3JpZ2luLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IHBvaW50SW5XaW5kb3cueCxcbiAgICAgICAgICAgIHk6IHBvaW50SW5XaW5kb3cueVxuICAgICAgICB9O1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuZ2V0TG9jYXRpb25PblNjcmVlbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgfHwgIXRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC53aW5kb3cpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBvaW50SW5XaW5kb3cgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udmVydFBvaW50VG9WaWV3KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5ib3VuZHMub3JpZ2luLCBudWxsKTtcbiAgICAgICAgdmFyIHBvaW50T25TY3JlZW4gPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQud2luZG93LmNvbnZlcnRQb2ludFRvV2luZG93KHBvaW50SW5XaW5kb3csIG51bGwpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgeDogcG9pbnRPblNjcmVlbi54LFxuICAgICAgICAgICAgeTogcG9pbnRPblNjcmVlbi55XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5nZXRMb2NhdGlvblJlbGF0aXZlVG8gPSBmdW5jdGlvbiAob3RoZXJWaWV3KSB7XG4gICAgICAgIGlmICghdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkIHx8ICF0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQud2luZG93IHx8XG4gICAgICAgICAgICAhb3RoZXJWaWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQgfHwgIW90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLndpbmRvdyB8fFxuICAgICAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLndpbmRvdyAhPT0gb3RoZXJWaWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQud2luZG93KSB7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIHZhciBteVBvaW50SW5XaW5kb3cgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY29udmVydFBvaW50VG9WaWV3KHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5ib3VuZHMub3JpZ2luLCBudWxsKTtcbiAgICAgICAgdmFyIG90aGVyUG9pbnRJbldpbmRvdyA9IG90aGVyVmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLmNvbnZlcnRQb2ludFRvVmlldyhvdGhlclZpZXcubmF0aXZlVmlld1Byb3RlY3RlZC5ib3VuZHMub3JpZ2luLCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHg6IG15UG9pbnRJbldpbmRvdy54IC0gb3RoZXJQb2ludEluV2luZG93LngsXG4gICAgICAgICAgICB5OiBteVBvaW50SW5XaW5kb3cueSAtIG90aGVyUG9pbnRJbldpbmRvdy55XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fb25TaXplQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmICghbmF0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGhpcy5zdHlsZS5iYWNrZ3JvdW5kSW50ZXJuYWw7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kRGVwZW5kc09uU2l6ZSA9IGJhY2tncm91bmQuaW1hZ2VcbiAgICAgICAgICAgIHx8ICFiYWNrZ3JvdW5kLmhhc1VuaWZvcm1Cb3JkZXIoKVxuICAgICAgICAgICAgfHwgYmFja2dyb3VuZC5oYXNCb3JkZXJSYWRpdXMoKTtcbiAgICAgICAgaWYgKHRoaXMuX25hdGl2ZUJhY2tncm91bmRTdGF0ZSA9PT0gXCJpbnZhbGlkXCIgfHwgKHRoaXMuX25hdGl2ZUJhY2tncm91bmRTdGF0ZSA9PT0gXCJkcmF3blwiICYmIGJhY2tncm91bmREZXBlbmRzT25TaXplKSkge1xuICAgICAgICAgICAgdGhpcy5fcmVkcmF3TmF0aXZlQmFja2dyb3VuZChiYWNrZ3JvdW5kKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY2xpcFBhdGggPSB0aGlzLnN0eWxlLmNsaXBQYXRoO1xuICAgICAgICBpZiAoY2xpcFBhdGggIT09IFwiXCIgJiYgdGhpc1tzdHlsZV9wcm9wZXJ0aWVzXzEuY2xpcFBhdGhQcm9wZXJ0eS5zZXROYXRpdmVdKSB7XG4gICAgICAgICAgICB0aGlzW3N0eWxlX3Byb3BlcnRpZXNfMS5jbGlwUGF0aFByb3BlcnR5LnNldE5hdGl2ZV0oY2xpcFBhdGgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS51cGRhdGVOYXRpdmVUcmFuc2Zvcm0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzY2FsZVggPSB0aGlzLnNjYWxlWCB8fCAxZS02O1xuICAgICAgICB2YXIgc2NhbGVZID0gdGhpcy5zY2FsZVkgfHwgMWUtNjtcbiAgICAgICAgdmFyIHJvdGF0ZSA9IHRoaXMucm90YXRlIHx8IDA7XG4gICAgICAgIHZhciBuZXdUcmFuc2Zvcm0gPSBDR0FmZmluZVRyYW5zZm9ybUlkZW50aXR5O1xuICAgICAgICBuZXdUcmFuc2Zvcm0gPSBDR0FmZmluZVRyYW5zZm9ybVRyYW5zbGF0ZShuZXdUcmFuc2Zvcm0sIHRoaXMudHJhbnNsYXRlWCwgdGhpcy50cmFuc2xhdGVZKTtcbiAgICAgICAgbmV3VHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1Sb3RhdGUobmV3VHJhbnNmb3JtLCByb3RhdGUgKiBNYXRoLlBJIC8gMTgwKTtcbiAgICAgICAgbmV3VHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1TY2FsZShuZXdUcmFuc2Zvcm0sIHNjYWxlWCwgc2NhbGVZKTtcbiAgICAgICAgaWYgKCFDR0FmZmluZVRyYW5zZm9ybUVxdWFsVG9UcmFuc2Zvcm0odGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLnRyYW5zZm9ybSwgbmV3VHJhbnNmb3JtKSkge1xuICAgICAgICAgICAgdmFyIHVwZGF0ZVN1c3BlbmRlZCA9IHRoaXMuX2lzUHJlc2VudGF0aW9uTGF5ZXJVcGRhdGVTdXNwZW5lZGVkKCk7XG4gICAgICAgICAgICBpZiAoIXVwZGF0ZVN1c3BlbmRlZCkge1xuICAgICAgICAgICAgICAgIENBVHJhbnNhY3Rpb24uYmVnaW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC50cmFuc2Zvcm0gPSBuZXdUcmFuc2Zvcm07XG4gICAgICAgICAgICB0aGlzLl9oYXNUcmFuc2Zyb20gPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgIUNHQWZmaW5lVHJhbnNmb3JtRXF1YWxUb1RyYW5zZm9ybSh0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudHJhbnNmb3JtLCBDR0FmZmluZVRyYW5zZm9ybUlkZW50aXR5KTtcbiAgICAgICAgICAgIGlmICghdXBkYXRlU3VzcGVuZGVkKSB7XG4gICAgICAgICAgICAgICAgQ0FUcmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUudXBkYXRlT3JpZ2luUG9pbnQgPSBmdW5jdGlvbiAob3JpZ2luWCwgb3JpZ2luWSkge1xuICAgICAgICB2YXIgbmV3UG9pbnQgPSBDR1BvaW50TWFrZShvcmlnaW5YLCBvcmlnaW5ZKTtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxheWVyLmFuY2hvclBvaW50ID0gbmV3UG9pbnQ7XG4gICAgICAgIGlmICh0aGlzLl9jYWNoZWRGcmFtZSkge1xuICAgICAgICAgICAgdGhpcy5fc2V0TmF0aXZlVmlld0ZyYW1lKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCwgdGhpcy5fY2FjaGVkRnJhbWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fc3VzcGVuZFByZXNlbnRhdGlvbkxheWVyVXBkYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3VzcGVuZENBVHJhbnNhY3Rpb24gPSB0cnVlO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX3Jlc3VtZVByZXNlbnRhdGlvbkxheWVyVXBkYXRlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fc3VzcGVuZENBVHJhbnNhY3Rpb24gPSBmYWxzZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9pc1ByZXNlbnRhdGlvbkxheWVyVXBkYXRlU3VzcGVuZWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3N1c3BlbmRDQVRyYW5zYWN0aW9uIHx8IHRoaXMuX3N1c3BlbmROYXRpdmVVcGRhdGVzQ291bnQ7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fc2hvd05hdGl2ZU1vZGFsVmlldyA9IGZ1bmN0aW9uIChwYXJlbnQsIG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHBhcmVudFdpdGhDb250cm9sbGVyID0gaW9zLmdldFBhcmVudFdpdGhWaWV3Q29udHJvbGxlcihwYXJlbnQpO1xuICAgICAgICBpZiAoIXBhcmVudFdpdGhDb250cm9sbGVyKSB7XG4gICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJDb3VsZCBub3QgZmluZCBwYXJlbnQgd2l0aCB2aWV3Q29udHJvbGxlciBmb3IgXCIgKyBwYXJlbnQgKyBcIiB3aGlsZSBzaG93aW5nIG1vZGFsIHZpZXcuXCIsIHZpZXdfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlZpZXdIaWVyYXJjaHksIHZpZXdfY29tbW9uXzEudHJhY2VNZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHBhcmVudENvbnRyb2xsZXIgPSBwYXJlbnRXaXRoQ29udHJvbGxlci52aWV3Q29udHJvbGxlcjtcbiAgICAgICAgaWYgKHBhcmVudENvbnRyb2xsZXIucHJlc2VudGVkVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcIlBhcmVudCBpcyBhbHJlYWR5IHByZXNlbnRpbmcgdmlldyBjb250cm9sbGVyLiBDbG9zZSB0aGUgY3VycmVudCBtb2RhbCBwYWdlIGJlZm9yZSBzaG93aW5nIGFub3RoZXIgb25lIVwiLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5WaWV3SGllcmFyY2h5LCB2aWV3X2NvbW1vbl8xLnRyYWNlTWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGFyZW50Q29udHJvbGxlci52aWV3IHx8ICFwYXJlbnRDb250cm9sbGVyLnZpZXcud2luZG93KSB7XG4gICAgICAgICAgICB2aWV3X2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJQYXJlbnQgcGFnZSBpcyBub3QgcGFydCBvZiB0aGUgd2luZG93IGhpZXJhcmNoeS5cIiwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVmlld0hpZXJhcmNoeSwgdmlld19jb21tb25fMS50cmFjZU1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXR1cEFzUm9vdFZpZXcoe30pO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9zaG93TmF0aXZlTW9kYWxWaWV3LmNhbGwodGhpcywgcGFyZW50V2l0aENvbnRyb2xsZXIsIG9wdGlvbnMpO1xuICAgICAgICB2YXIgY29udHJvbGxlciA9IHRoaXMudmlld0NvbnRyb2xsZXI7XG4gICAgICAgIGlmICghY29udHJvbGxlcikge1xuICAgICAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLmlvcyB8fCB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBjb250cm9sbGVyID0gaW9zLlVJTGF5b3V0Vmlld0NvbnRyb2xsZXIuaW5pdFdpdGhPd25lcihuZXcgV2Vha1JlZih0aGlzKSk7XG4gICAgICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJVmlldykge1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIudmlldy5hZGRTdWJ2aWV3KG5hdGl2ZVZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy52aWV3Q29udHJvbGxlciA9IGNvbnRyb2xsZXI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMuZnVsbHNjcmVlbikge1xuICAgICAgICAgICAgY29udHJvbGxlci5tb2RhbFByZXNlbnRhdGlvblN0eWxlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIubW9kYWxQcmVzZW50YXRpb25TdHlsZSA9IDI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9wdGlvbnMuaW9zICYmIG9wdGlvbnMuaW9zLnByZXNlbnRhdGlvblN0eWxlKSB7XG4gICAgICAgICAgICB2YXIgcHJlc2VudGF0aW9uU3R5bGUgPSBvcHRpb25zLmlvcy5wcmVzZW50YXRpb25TdHlsZTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIubW9kYWxQcmVzZW50YXRpb25TdHlsZSA9IHByZXNlbnRhdGlvblN0eWxlO1xuICAgICAgICAgICAgaWYgKHByZXNlbnRhdGlvblN0eWxlID09PSA3KSB7XG4gICAgICAgICAgICAgICAgdmFyIHBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyID0gY29udHJvbGxlci5wb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlcjtcbiAgICAgICAgICAgICAgICB0aGlzLl9wb3BvdmVyUHJlc2VudGF0aW9uRGVsZWdhdGUgPSBpb3MuVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wLmluaXRXaXRoT3duZXJBbmRDYWxsYmFjayhuZXcgV2Vha1JlZih0aGlzKSwgdGhpcy5fY2xvc2VNb2RhbENhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICBwb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlci5kZWxlZ2F0ZSA9IHRoaXMuX3BvcG92ZXJQcmVzZW50YXRpb25EZWxlZ2F0ZTtcbiAgICAgICAgICAgICAgICB2YXIgdmlldyA9IHBhcmVudC5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICAgICAgICAgIHBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyLnNvdXJjZVZpZXcgPSB2aWV3O1xuICAgICAgICAgICAgICAgIHBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyLnNvdXJjZVJlY3QgPSBDR1JlY3RNYWtlKDAsIDAsIHZpZXcuZnJhbWUuc2l6ZS53aWR0aCwgdmlldy5mcmFtZS5zaXplLmhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ob3Jpem9udGFsQWxpZ25tZW50ID0gXCJzdHJldGNoXCI7XG4gICAgICAgIHRoaXMudmVydGljYWxBbGlnbm1lbnQgPSBcInN0cmV0Y2hcIjtcbiAgICAgICAgdGhpcy5fcmFpc2VTaG93aW5nTW9kYWxseUV2ZW50KCk7XG4gICAgICAgIHZhciBhbmltYXRlZCA9IG9wdGlvbnMuYW5pbWF0ZWQgPT09IHVuZGVmaW5lZCA/IHRydWUgOiAhIW9wdGlvbnMuYW5pbWF0ZWQ7XG4gICAgICAgIGNvbnRyb2xsZXIuYW5pbWF0ZWQgPSBhbmltYXRlZDtcbiAgICAgICAgcGFyZW50Q29udHJvbGxlci5wcmVzZW50Vmlld0NvbnRyb2xsZXJBbmltYXRlZENvbXBsZXRpb24oY29udHJvbGxlciwgYW5pbWF0ZWQsIG51bGwpO1xuICAgICAgICB2YXIgdHJhbnNpdGlvbkNvb3JkaW5hdG9yID0gcGFyZW50Q29udHJvbGxlci50cmFuc2l0aW9uQ29vcmRpbmF0b3I7XG4gICAgICAgIGlmICh0cmFuc2l0aW9uQ29vcmRpbmF0b3IpIHtcbiAgICAgICAgICAgIFVJVmlld0NvbnRyb2xsZXJUcmFuc2l0aW9uQ29vcmRpbmF0b3IucHJvdG90eXBlLmFuaW1hdGVBbG9uZ3NpZGVUcmFuc2l0aW9uQ29tcGxldGlvblxuICAgICAgICAgICAgICAgIC5jYWxsKHRyYW5zaXRpb25Db29yZGluYXRvciwgbnVsbCwgZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX3JhaXNlU2hvd25Nb2RhbGx5RXZlbnQoKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yYWlzZVNob3duTW9kYWxseUV2ZW50KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9oaWRlTmF0aXZlTW9kYWxWaWV3ID0gZnVuY3Rpb24gKHBhcmVudCwgd2hlbkNsb3NlZENhbGxiYWNrKSB7XG4gICAgICAgIGlmICghcGFyZW50IHx8ICFwYXJlbnQudmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VFcnJvcihcIlRyeWluZyB0byBoaWRlIG1vZGFsIHZpZXcgYnV0IG5vIHBhcmVudCB3aXRoIHZpZXdDb250cm9sbGVyIHNwZWNpZmllZC5cIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFwYXJlbnQudmlld0NvbnRyb2xsZXIucHJlc2VudGVkVmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHdoZW5DbG9zZWRDYWxsYmFjaygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBwYXJlbnRDb250cm9sbGVyID0gcGFyZW50LnZpZXdDb250cm9sbGVyO1xuICAgICAgICB2YXIgYW5pbWF0ZWQgPSB0aGlzLnZpZXdDb250cm9sbGVyLmFuaW1hdGVkO1xuICAgICAgICBwYXJlbnRDb250cm9sbGVyLmRpc21pc3NWaWV3Q29udHJvbGxlckFuaW1hdGVkQ29tcGxldGlvbihhbmltYXRlZCwgd2hlbkNsb3NlZENhbGxiYWNrKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuaXNFbmFibGVkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICByZXR1cm4gbmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQ29udHJvbCA/IG5hdGl2ZVZpZXcuZW5hYmxlZCA6IHRydWU7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmlzRW5hYmxlZFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgVUlDb250cm9sKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmVuYWJsZWQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5vcmlnaW5YUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQubGF5ZXIuYW5jaG9yUG9pbnQueDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVPcmlnaW5Qb2ludCh2YWx1ZSwgdGhpcy5vcmlnaW5ZKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEub3JpZ2luWVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmxheWVyLmFuY2hvclBvaW50Lnk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLm9yaWdpbllQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlT3JpZ2luUG9pbnQodGhpcy5vcmlnaW5YLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVt2aWV3X2NvbW1vbl8xLmF1dG9tYXRpb25UZXh0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWNjZXNzaWJpbGl0eUxhYmVsO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbdmlld19jb21tb25fMS5hdXRvbWF0aW9uVGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFjY2Vzc2liaWxpdHlJZGVudGlmaWVyID0gdmFsdWU7XG4gICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5hY2Nlc3NpYmlsaXR5TGFiZWwgPSB2YWx1ZTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudXNlckludGVyYWN0aW9uRW5hYmxlZDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3ZpZXdfY29tbW9uXzEuaXNVc2VySW50ZXJhY3Rpb25FbmFibGVkUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQudXNlckludGVyYWN0aW9uRW5hYmxlZCA9IHZhbHVlO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnZpc2liaWxpdHlQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5oaWRkZW4gPyBzdHlsZV9wcm9wZXJ0aWVzXzEuVmlzaWJpbGl0eS5DT0xMQVBTRSA6IHN0eWxlX3Byb3BlcnRpZXNfMS5WaXNpYmlsaXR5LlZJU0lCTEU7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudmlzaWJpbGl0eVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBzdHlsZV9wcm9wZXJ0aWVzXzEuVmlzaWJpbGl0eS5WSVNJQkxFOlxuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5oaWRkZW4gPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2Ugc3R5bGVfcHJvcGVydGllc18xLlZpc2liaWxpdHkuSElEREVOOlxuICAgICAgICAgICAgY2FzZSBzdHlsZV9wcm9wZXJ0aWVzXzEuVmlzaWJpbGl0eS5DT0xMQVBTRTpcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuaGlkZGVuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2aXNpYmlsaXR5IHZhbHVlOiBcIiArIHZhbHVlICsgXCIuIFZhbGlkIHZhbHVlcyBhcmU6IFxcXCJcIiArIHN0eWxlX3Byb3BlcnRpZXNfMS5WaXNpYmlsaXR5LlZJU0lCTEUgKyBcIlxcXCIsIFxcXCJcIiArIHN0eWxlX3Byb3BlcnRpZXNfMS5WaXNpYmlsaXR5LkhJRERFTiArIFwiXFxcIiwgXFxcIlwiICsgc3R5bGVfcHJvcGVydGllc18xLlZpc2liaWxpdHkuQ09MTEFQU0UgKyBcIlxcXCIuXCIpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEub3BhY2l0eVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkLmFscGhhO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLm9wYWNpdHlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB2YXIgdXBkYXRlU3VzcGVuZGVkID0gdGhpcy5faXNQcmVzZW50YXRpb25MYXllclVwZGF0ZVN1c3BlbmVkZWQoKTtcbiAgICAgICAgaWYgKCF1cGRhdGVTdXNwZW5kZWQpIHtcbiAgICAgICAgICAgIENBVHJhbnNhY3Rpb24uYmVnaW4oKTtcbiAgICAgICAgfVxuICAgICAgICBuYXRpdmVWaWV3LmFscGhhID0gdmFsdWU7XG4gICAgICAgIGlmICghdXBkYXRlU3VzcGVuZGVkKSB7XG4gICAgICAgICAgICBDQVRyYW5zYWN0aW9uLmNvbW1pdCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEucm90YXRlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnJvdGF0ZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVOYXRpdmVUcmFuc2Zvcm0oKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuc2NhbGVYUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZU5hdGl2ZVRyYW5zZm9ybSgpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnNjYWxlWVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS5zY2FsZVlQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMudXBkYXRlTmF0aXZlVHJhbnNmb3JtKCk7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2xhdGVYUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnVwZGF0ZU5hdGl2ZVRyYW5zZm9ybSgpO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLnRyYW5zbGF0ZVlQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEudHJhbnNsYXRlWVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVOYXRpdmVUcmFuc2Zvcm0oKTtcbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlW3N0eWxlX3Byb3BlcnRpZXNfMS56SW5kZXhQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuekluZGV4UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQubGF5ZXIuelBvc2l0aW9uID0gdmFsdWU7XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZVtzdHlsZV9wcm9wZXJ0aWVzXzEuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYmFja2dyb3VuZENvbG9yO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGVbc3R5bGVfcHJvcGVydGllc18xLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fbmF0aXZlQmFja2dyb3VuZFN0YXRlID0gXCJpbnZhbGlkXCI7XG4gICAgICAgIGlmICh0aGlzLmlzTGF5b3V0VmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZHJhd05hdGl2ZUJhY2tncm91bmQodmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBWaWV3LnByb3RvdHlwZS5fZ2V0Q3VycmVudExheW91dEJvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3ICYmICF0aGlzLmlzQ29sbGFwc2VkKSB7XG4gICAgICAgICAgICB2YXIgZnJhbWUgPSBuYXRpdmVWaWV3LmZyYW1lO1xuICAgICAgICAgICAgdmFyIG9yaWdpbl8xID0gZnJhbWUub3JpZ2luO1xuICAgICAgICAgICAgdmFyIHNpemUgPSBmcmFtZS5zaXplO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBsZWZ0OiBNYXRoLnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKG9yaWdpbl8xLngpKSxcbiAgICAgICAgICAgICAgICB0b3A6IE1hdGgucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMob3JpZ2luXzEueSkpLFxuICAgICAgICAgICAgICAgIHJpZ2h0OiBNYXRoLnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKG9yaWdpbl8xLnggKyBzaXplLndpZHRoKSksXG4gICAgICAgICAgICAgICAgYm90dG9tOiBNYXRoLnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKG9yaWdpbl8xLnkgKyBzaXplLmhlaWdodCkpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHsgbGVmdDogMCwgdG9wOiAwLCByaWdodDogMCwgYm90dG9tOiAwIH07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFZpZXcucHJvdG90eXBlLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB1cGRhdGVTdXNwZW5kZWQgPSB0aGlzLl9pc1ByZXNlbnRhdGlvbkxheWVyVXBkYXRlU3VzcGVuZWRlZCgpO1xuICAgICAgICBpZiAoIXVwZGF0ZVN1c3BlbmRlZCkge1xuICAgICAgICAgICAgQ0FUcmFuc2FjdGlvbi5iZWdpbigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIFVJQ29sb3IpIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5iYWNrZ3JvdW5kQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRfMS5pb3MuY3JlYXRlQmFja2dyb3VuZFVJQ29sb3IodGhpcywgZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMubmF0aXZlVmlld1Byb3RlY3RlZC5iYWNrZ3JvdW5kQ29sb3IgPSBjb2xvcjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fc2V0TmF0aXZlQ2xpcFRvQm91bmRzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF1cGRhdGVTdXNwZW5kZWQpIHtcbiAgICAgICAgICAgIENBVHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbmF0aXZlQmFja2dyb3VuZFN0YXRlID0gXCJkcmF3blwiO1xuICAgIH07XG4gICAgVmlldy5wcm90b3R5cGUuX3NldE5hdGl2ZUNsaXBUb0JvdW5kcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmRJbnRlcm5hbCA9IHRoaXMuc3R5bGUuYmFja2dyb3VuZEludGVybmFsO1xuICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQuY2xpcHNUb0JvdW5kcyA9XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQgaW5zdGFuY2VvZiBVSVNjcm9sbFZpZXcgfHxcbiAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kSW50ZXJuYWwuaGFzQm9yZGVyV2lkdGgoKSB8fFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRJbnRlcm5hbC5oYXNCb3JkZXJSYWRpdXMoKTtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlldy5wcm90b3R5cGUsIFwibGF5b3V0XCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgVmlldy5wcm90b3R5cGUsIFwib25NZWFzdXJlXCIsIG51bGwpO1xuICAgIHJldHVybiBWaWV3O1xufSh2aWV3X2NvbW1vbl8xLlZpZXdDb21tb24pKTtcbmV4cG9ydHMuVmlldyA9IFZpZXc7XG5WaWV3LnByb3RvdHlwZS5fbmF0aXZlQmFja2dyb3VuZFN0YXRlID0gXCJ1bnNldFwiO1xudmFyIENvbnRhaW5lclZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDb250YWluZXJWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIENvbnRhaW5lclZpZXcoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmlvc092ZXJmbG93U2FmZUFyZWEgPSB0cnVlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIHJldHVybiBDb250YWluZXJWaWV3O1xufShWaWV3KSk7XG5leHBvcnRzLkNvbnRhaW5lclZpZXcgPSBDb250YWluZXJWaWV3O1xudmFyIEN1c3RvbUxheW91dFZpZXcgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhDdXN0b21MYXlvdXRWaWV3LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEN1c3RvbUxheW91dFZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFVJVmlldy5hbGxvYygpLmluaXRXaXRoRnJhbWUoVUlTY3JlZW4ubWFpblNjcmVlbi5ib3VuZHMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEN1c3RvbUxheW91dFZpZXcucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgfTtcbiAgICBDdXN0b21MYXlvdXRWaWV3LnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCwgYXRJbmRleCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9hZGRWaWV3VG9OYXRpdmVWaXN1YWxUcmVlLmNhbGwodGhpcywgY2hpbGQsIGF0SW5kZXgpO1xuICAgICAgICB2YXIgcGFyZW50TmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGNoaWxkTmF0aXZlVmlldyA9IGNoaWxkLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChwYXJlbnROYXRpdmVWaWV3ICYmIGNoaWxkTmF0aXZlVmlldykge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhdEluZGV4ICE9PSBcIm51bWJlclwiIHx8IGF0SW5kZXggPj0gcGFyZW50TmF0aXZlVmlldy5zdWJ2aWV3cy5jb3VudCkge1xuICAgICAgICAgICAgICAgIHBhcmVudE5hdGl2ZVZpZXcuYWRkU3VidmlldyhjaGlsZE5hdGl2ZVZpZXcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyZW50TmF0aXZlVmlldy5pbnNlcnRTdWJ2aWV3QXRJbmRleChjaGlsZE5hdGl2ZVZpZXcsIGF0SW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgQ3VzdG9tTGF5b3V0Vmlldy5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9yZW1vdmVWaWV3RnJvbU5hdGl2ZVZpc3VhbFRyZWUuY2FsbCh0aGlzLCBjaGlsZCk7XG4gICAgICAgIGlmIChjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICBjaGlsZC5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlbW92ZUZyb21TdXBlcnZpZXcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIEN1c3RvbUxheW91dFZpZXc7XG59KENvbnRhaW5lclZpZXcpKTtcbmV4cG9ydHMuQ3VzdG9tTGF5b3V0VmlldyA9IEN1c3RvbUxheW91dFZpZXc7XG52YXIgaW9zO1xuKGZ1bmN0aW9uIChpb3MpIHtcbiAgICBmdW5jdGlvbiBnZXRQYXJlbnRXaXRoVmlld0NvbnRyb2xsZXIodmlldykge1xuICAgICAgICB3aGlsZSAodmlldyAmJiAhdmlldy52aWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgdmlldyA9IHZpZXcucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3O1xuICAgIH1cbiAgICBpb3MuZ2V0UGFyZW50V2l0aFZpZXdDb250cm9sbGVyID0gZ2V0UGFyZW50V2l0aFZpZXdDb250cm9sbGVyO1xuICAgIGZ1bmN0aW9uIHVwZGF0ZUF1dG9BZGp1c3RTY3JvbGxJbnNldHMoY29udHJvbGxlciwgb3duZXIpIHtcbiAgICAgICAgaWYgKG1ham9yVmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgb3duZXIuX2F1dG9tYXRpY2FsbHlBZGp1c3RzU2Nyb2xsVmlld0luc2V0cyA9IGZhbHNlO1xuICAgICAgICAgICAgY29udHJvbGxlci5hdXRvbWF0aWNhbGx5QWRqdXN0c1Njcm9sbFZpZXdJbnNldHMgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpb3MudXBkYXRlQXV0b0FkanVzdFNjcm9sbEluc2V0cyA9IHVwZGF0ZUF1dG9BZGp1c3RTY3JvbGxJbnNldHM7XG4gICAgZnVuY3Rpb24gdXBkYXRlQ29uc3RyYWludHMoY29udHJvbGxlciwgb3duZXIpIHtcbiAgICAgICAgaWYgKG1ham9yVmVyc2lvbiA8PSAxMCkge1xuICAgICAgICAgICAgdmFyIGxheW91dEd1aWRlID0gaW5pdExheW91dEd1aWRlKGNvbnRyb2xsZXIpO1xuICAgICAgICAgICAgY29udHJvbGxlci52aWV3LnNhZmVBcmVhTGF5b3V0R3VpZGUgPSBsYXlvdXRHdWlkZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpb3MudXBkYXRlQ29uc3RyYWludHMgPSB1cGRhdGVDb25zdHJhaW50cztcbiAgICBmdW5jdGlvbiBpbml0TGF5b3V0R3VpZGUoY29udHJvbGxlcikge1xuICAgICAgICB2YXIgcm9vdFZpZXcgPSBjb250cm9sbGVyLnZpZXc7XG4gICAgICAgIHZhciBsYXlvdXRHdWlkZSA9IFVJTGF5b3V0R3VpZGUuYWxsb2MoKS5pbml0KCk7XG4gICAgICAgIHJvb3RWaWV3LmFkZExheW91dEd1aWRlKGxheW91dEd1aWRlKTtcbiAgICAgICAgTlNMYXlvdXRDb25zdHJhaW50LmFjdGl2YXRlQ29uc3RyYWludHMoW1xuICAgICAgICAgICAgbGF5b3V0R3VpZGUudG9wQW5jaG9yLmNvbnN0cmFpbnRFcXVhbFRvQW5jaG9yKGNvbnRyb2xsZXIudG9wTGF5b3V0R3VpZGUuYm90dG9tQW5jaG9yKSxcbiAgICAgICAgICAgIGxheW91dEd1aWRlLmJvdHRvbUFuY2hvci5jb25zdHJhaW50RXF1YWxUb0FuY2hvcihjb250cm9sbGVyLmJvdHRvbUxheW91dEd1aWRlLnRvcEFuY2hvciksXG4gICAgICAgICAgICBsYXlvdXRHdWlkZS5sZWFkaW5nQW5jaG9yLmNvbnN0cmFpbnRFcXVhbFRvQW5jaG9yKHJvb3RWaWV3LmxlYWRpbmdBbmNob3IpLFxuICAgICAgICAgICAgbGF5b3V0R3VpZGUudHJhaWxpbmdBbmNob3IuY29uc3RyYWludEVxdWFsVG9BbmNob3Iocm9vdFZpZXcudHJhaWxpbmdBbmNob3IpXG4gICAgICAgIF0pO1xuICAgICAgICByZXR1cm4gbGF5b3V0R3VpZGU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGxheW91dFZpZXcoY29udHJvbGxlciwgb3duZXIpIHtcbiAgICAgICAgdmFyIGxheW91dEd1aWRlID0gY29udHJvbGxlci52aWV3LnNhZmVBcmVhTGF5b3V0R3VpZGU7XG4gICAgICAgIGlmICghbGF5b3V0R3VpZGUpIHtcbiAgICAgICAgICAgIHZpZXdfY29tbW9uXzEudHJhY2VXcml0ZShcInNhZmVBcmVhTGF5b3V0R3VpZGUgZHVyaW5nIGxheW91dCBvZiBcIiArIG93bmVyICsgXCIuIENyZWF0aW5nIGZhbGxiYWNrIGNvbnN0cmFpbnRzLCBidXQgbGF5b3V0IG1pZ2h0IGJlIHdyb25nLlwiLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQsIHZpZXdfY29tbW9uXzEudHJhY2VNZXNzYWdlVHlwZS5lcnJvcik7XG4gICAgICAgICAgICBsYXlvdXRHdWlkZSA9IGluaXRMYXlvdXRHdWlkZShjb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2FmZUFyZWEgPSBsYXlvdXRHdWlkZS5sYXlvdXRGcmFtZTtcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKHNhZmVBcmVhKTtcbiAgICAgICAgdmFyIHNhZmVBcmVhU2l6ZSA9IHNhZmVBcmVhLnNpemU7XG4gICAgICAgIHZhciBoYXNDaGlsZFZpZXdDb250cm9sbGVycyA9IGNvbnRyb2xsZXIuY2hpbGRWaWV3Q29udHJvbGxlcnMuY291bnQgPiAwO1xuICAgICAgICBpZiAoaGFzQ2hpbGRWaWV3Q29udHJvbGxlcnMpIHtcbiAgICAgICAgICAgIHZhciBmdWxsc2NyZWVuID0gY29udHJvbGxlci52aWV3LmZyYW1lO1xuICAgICAgICAgICAgcG9zaXRpb24gPSBpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoZnVsbHNjcmVlbik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNhZmVBcmVhV2lkdGggPSB2aWV3X2NvbW1vbl8xLmxheW91dC5yb3VuZCh2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhzYWZlQXJlYVNpemUud2lkdGgpKTtcbiAgICAgICAgdmFyIHNhZmVBcmVhSGVpZ2h0ID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2FmZUFyZWFTaXplLmhlaWdodCkpO1xuICAgICAgICB2YXIgd2lkdGhTcGVjID0gdmlld19jb21tb25fMS5sYXlvdXQubWFrZU1lYXN1cmVTcGVjKHNhZmVBcmVhV2lkdGgsIHZpZXdfY29tbW9uXzEubGF5b3V0LkVYQUNUTFkpO1xuICAgICAgICB2YXIgaGVpZ2h0U3BlYyA9IHZpZXdfY29tbW9uXzEubGF5b3V0Lm1ha2VNZWFzdXJlU3BlYyhzYWZlQXJlYUhlaWdodCwgdmlld19jb21tb25fMS5sYXlvdXQuRVhBQ1RMWSk7XG4gICAgICAgIFZpZXcubWVhc3VyZUNoaWxkKG51bGwsIG93bmVyLCB3aWR0aFNwZWMsIGhlaWdodFNwZWMpO1xuICAgICAgICBWaWV3LmxheW91dENoaWxkKG51bGwsIG93bmVyLCBwb3NpdGlvbi5sZWZ0LCBwb3NpdGlvbi50b3AsIHBvc2l0aW9uLnJpZ2h0LCBwb3NpdGlvbi5ib3R0b20pO1xuICAgICAgICBsYXlvdXRQYXJlbnQob3duZXIucGFyZW50KTtcbiAgICB9XG4gICAgaW9zLmxheW91dFZpZXcgPSBsYXlvdXRWaWV3O1xuICAgIGZ1bmN0aW9uIGdldFBvc2l0aW9uRnJvbUZyYW1lKGZyYW1lKSB7XG4gICAgICAgIHZhciBsZWZ0ID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoZnJhbWUub3JpZ2luLngpKTtcbiAgICAgICAgdmFyIHRvcCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZyYW1lLm9yaWdpbi55KSk7XG4gICAgICAgIHZhciByaWdodCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnJvdW5kKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGZyYW1lLm9yaWdpbi54ICsgZnJhbWUuc2l6ZS53aWR0aCkpO1xuICAgICAgICB2YXIgYm90dG9tID0gdmlld19jb21tb25fMS5sYXlvdXQucm91bmQodmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoZnJhbWUub3JpZ2luLnkgKyBmcmFtZS5zaXplLmhlaWdodCkpO1xuICAgICAgICByZXR1cm4geyBsZWZ0OiBsZWZ0LCByaWdodDogcmlnaHQsIHRvcDogdG9wLCBib3R0b206IGJvdHRvbSB9O1xuICAgIH1cbiAgICBpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUgPSBnZXRQb3NpdGlvbkZyb21GcmFtZTtcbiAgICBmdW5jdGlvbiBnZXRGcmFtZUZyb21Qb3NpdGlvbihwb3NpdGlvbiwgaW5zZXRzKSB7XG4gICAgICAgIGluc2V0cyA9IGluc2V0cyB8fCB7IGxlZnQ6IDAsIHRvcDogMCwgcmlnaHQ6IDAsIGJvdHRvbTogMCB9O1xuICAgICAgICB2YXIgbGVmdCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocG9zaXRpb24ubGVmdCArIGluc2V0cy5sZWZ0KTtcbiAgICAgICAgdmFyIHRvcCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocG9zaXRpb24udG9wICsgaW5zZXRzLnRvcCk7XG4gICAgICAgIHZhciB3aWR0aCA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocG9zaXRpb24ucmlnaHQgLSBwb3NpdGlvbi5sZWZ0IC0gaW5zZXRzLmxlZnQgLSBpbnNldHMucmlnaHQpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhwb3NpdGlvbi5ib3R0b20gLSBwb3NpdGlvbi50b3AgLSBpbnNldHMudG9wIC0gaW5zZXRzLmJvdHRvbSk7XG4gICAgICAgIHJldHVybiBDR1JlY3RNYWtlKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7XG4gICAgfVxuICAgIGlvcy5nZXRGcmFtZUZyb21Qb3NpdGlvbiA9IGdldEZyYW1lRnJvbVBvc2l0aW9uO1xuICAgIGZ1bmN0aW9uIHNocmlua1RvU2FmZUFyZWEodmlldywgZnJhbWUpIHtcbiAgICAgICAgdmFyIGluc2V0cyA9IHZpZXcuZ2V0U2FmZUFyZWFJbnNldHMoKTtcbiAgICAgICAgaWYgKGluc2V0cy5sZWZ0IHx8IGluc2V0cy50b3ApIHtcbiAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShmcmFtZSk7XG4gICAgICAgICAgICB2YXIgYWRqdXN0ZWRGcmFtZSA9IGlvcy5nZXRGcmFtZUZyb21Qb3NpdGlvbihwb3NpdGlvbiwgaW5zZXRzKTtcbiAgICAgICAgICAgIGlmICh2aWV3X2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIiA6c2hyaW5rVG9TYWZlQXJlYTogXCIgKyBKU09OLnN0cmluZ2lmeShpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoYWRqdXN0ZWRGcmFtZSkpLCB2aWV3X2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5MYXlvdXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFkanVzdGVkRnJhbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlvcy5zaHJpbmtUb1NhZmVBcmVhID0gc2hyaW5rVG9TYWZlQXJlYTtcbiAgICBmdW5jdGlvbiBleHBhbmRCZXlvbmRTYWZlQXJlYSh2aWV3LCBmcmFtZSkge1xuICAgICAgICB2YXIgYXZhaWxhYmxlU3BhY2UgPSBnZXRBdmFpbGFibGVTcGFjZUZyb21QYXJlbnQodmlldywgZnJhbWUpO1xuICAgICAgICB2YXIgc2FmZUFyZWEgPSBhdmFpbGFibGVTcGFjZS5zYWZlQXJlYTtcbiAgICAgICAgdmFyIGZ1bGxzY3JlZW4gPSBhdmFpbGFibGVTcGFjZS5mdWxsc2NyZWVuO1xuICAgICAgICB2YXIgaW5XaW5kb3cgPSBhdmFpbGFibGVTcGFjZS5pbldpbmRvdztcbiAgICAgICAgdmFyIHBvc2l0aW9uID0gaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKGZyYW1lKTtcbiAgICAgICAgdmFyIHNhZmVBcmVhUG9zaXRpb24gPSBpb3MuZ2V0UG9zaXRpb25Gcm9tRnJhbWUoc2FmZUFyZWEpO1xuICAgICAgICB2YXIgZnVsbHNjcmVlblBvc2l0aW9uID0gaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKGZ1bGxzY3JlZW4pO1xuICAgICAgICB2YXIgaW5XaW5kb3dQb3NpdGlvbiA9IGlvcy5nZXRQb3NpdGlvbkZyb21GcmFtZShpbldpbmRvdyk7XG4gICAgICAgIHZhciBhZGp1c3RlZFBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICAgIGlmIChwb3NpdGlvbi5sZWZ0ICYmIGluV2luZG93UG9zaXRpb24ubGVmdCA8PSBzYWZlQXJlYVBvc2l0aW9uLmxlZnQpIHtcbiAgICAgICAgICAgIGFkanVzdGVkUG9zaXRpb24ubGVmdCA9IGZ1bGxzY3JlZW5Qb3NpdGlvbi5sZWZ0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbi50b3AgJiYgaW5XaW5kb3dQb3NpdGlvbi50b3AgPD0gc2FmZUFyZWFQb3NpdGlvbi50b3ApIHtcbiAgICAgICAgICAgIGFkanVzdGVkUG9zaXRpb24udG9wID0gZnVsbHNjcmVlblBvc2l0aW9uLnRvcDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5XaW5kb3dQb3NpdGlvbi5yaWdodCA8IGZ1bGxzY3JlZW5Qb3NpdGlvbi5yaWdodCAmJiBpbldpbmRvd1Bvc2l0aW9uLnJpZ2h0ID49IHNhZmVBcmVhUG9zaXRpb24ucmlnaHQgKyBmdWxsc2NyZWVuUG9zaXRpb24ubGVmdCkge1xuICAgICAgICAgICAgYWRqdXN0ZWRQb3NpdGlvbi5yaWdodCArPSBmdWxsc2NyZWVuUG9zaXRpb24ucmlnaHQgLSBpbldpbmRvd1Bvc2l0aW9uLnJpZ2h0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbldpbmRvd1Bvc2l0aW9uLmJvdHRvbSA8IGZ1bGxzY3JlZW5Qb3NpdGlvbi5ib3R0b20gJiYgaW5XaW5kb3dQb3NpdGlvbi5ib3R0b20gPj0gc2FmZUFyZWFQb3NpdGlvbi5ib3R0b20gKyBmdWxsc2NyZWVuUG9zaXRpb24udG9wKSB7XG4gICAgICAgICAgICBhZGp1c3RlZFBvc2l0aW9uLmJvdHRvbSArPSBmdWxsc2NyZWVuUG9zaXRpb24uYm90dG9tIC0gaW5XaW5kb3dQb3NpdGlvbi5ib3R0b207XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFkanVzdGVkRnJhbWUgPSBDR1JlY3RNYWtlKHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYWRqdXN0ZWRQb3NpdGlvbi5sZWZ0KSwgdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhZGp1c3RlZFBvc2l0aW9uLnRvcCksIHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYWRqdXN0ZWRQb3NpdGlvbi5yaWdodCAtIGFkanVzdGVkUG9zaXRpb24ubGVmdCksIHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYWRqdXN0ZWRQb3NpdGlvbi5ib3R0b20gLSBhZGp1c3RlZFBvc2l0aW9uLnRvcCkpO1xuICAgICAgICBpZiAodmlld19jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld19jb21tb25fMS50cmFjZVdyaXRlKHZpZXcgKyBcIiA6ZXhwYW5kQmV5b25kU2FmZUFyZWE6IFwiICsgSlNPTi5zdHJpbmdpZnkoaW9zLmdldFBvc2l0aW9uRnJvbUZyYW1lKGFkanVzdGVkRnJhbWUpKSwgdmlld19jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTGF5b3V0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRqdXN0ZWRGcmFtZTtcbiAgICB9XG4gICAgaW9zLmV4cGFuZEJleW9uZFNhZmVBcmVhID0gZXhwYW5kQmV5b25kU2FmZUFyZWE7XG4gICAgZnVuY3Rpb24gbGF5b3V0UGFyZW50KHZpZXcpIHtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXcgaW5zdGFuY2VvZiBWaWV3ICYmIHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdmFyIGZyYW1lID0gdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkLmZyYW1lO1xuICAgICAgICAgICAgdmFyIG9yaWdpbl8yID0gZnJhbWUub3JpZ2luO1xuICAgICAgICAgICAgdmFyIHNpemUgPSBmcmFtZS5zaXplO1xuICAgICAgICAgICAgdmFyIGxlZnQgPSB2aWV3X2NvbW1vbl8xLmxheW91dC50b0RldmljZVBpeGVscyhvcmlnaW5fMi54KTtcbiAgICAgICAgICAgIHZhciB0b3BfMSA9IHZpZXdfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKG9yaWdpbl8yLnkpO1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2l6ZS53aWR0aCk7XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gdmlld19jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2l6ZS5oZWlnaHQpO1xuICAgICAgICAgICAgdmlldy5fc2V0TGF5b3V0RmxhZ3MobGVmdCwgdG9wXzEsIHdpZHRoICsgbGVmdCwgaGVpZ2h0ICsgdG9wXzEpO1xuICAgICAgICB9XG4gICAgICAgIGxheW91dFBhcmVudCh2aWV3LnBhcmVudCk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGdldEF2YWlsYWJsZVNwYWNlRnJvbVBhcmVudCh2aWV3LCBmcmFtZSkge1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc2Nyb2xsVmlldyA9IG51bGw7XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlclZpZXcgPSBudWxsO1xuICAgICAgICBpZiAodmlldy52aWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXJWaWV3ID0gdmlldy52aWV3Q29udHJvbGxlci52aWV3O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIHBhcmVudF8xID0gdmlldy5wYXJlbnQ7XG4gICAgICAgICAgICB3aGlsZSAocGFyZW50XzEgJiYgIXBhcmVudF8xLnZpZXdDb250cm9sbGVyICYmICEocGFyZW50XzEubmF0aXZlVmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJU2Nyb2xsVmlldykpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRfMSA9IHBhcmVudF8xLnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwYXJlbnRfMS5uYXRpdmVWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlTY3JvbGxWaWV3KSB7XG4gICAgICAgICAgICAgICAgc2Nyb2xsVmlldyA9IHBhcmVudF8xLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChwYXJlbnRfMS52aWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIHZpZXdDb250cm9sbGVyVmlldyA9IHBhcmVudF8xLnZpZXdDb250cm9sbGVyLnZpZXc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGZ1bGxzY3JlZW4gPSBudWxsO1xuICAgICAgICB2YXIgc2FmZUFyZWEgPSBudWxsO1xuICAgICAgICBpZiAodmlld0NvbnRyb2xsZXJWaWV3KSB7XG4gICAgICAgICAgICBzYWZlQXJlYSA9IHZpZXdDb250cm9sbGVyVmlldy5zYWZlQXJlYUxheW91dEd1aWRlLmxheW91dEZyYW1lO1xuICAgICAgICAgICAgZnVsbHNjcmVlbiA9IHZpZXdDb250cm9sbGVyVmlldy5mcmFtZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzY3JvbGxWaWV3KSB7XG4gICAgICAgICAgICB2YXIgaW5zZXRzID0gc2Nyb2xsVmlldy5zYWZlQXJlYUluc2V0cztcbiAgICAgICAgICAgIHNhZmVBcmVhID0gQ0dSZWN0TWFrZShpbnNldHMubGVmdCwgaW5zZXRzLnRvcCwgc2Nyb2xsVmlldy5jb250ZW50U2l6ZS53aWR0aCAtIGluc2V0cy5sZWZ0IC0gaW5zZXRzLnJpZ2h0LCBzY3JvbGxWaWV3LmNvbnRlbnRTaXplLmhlaWdodCAtIGluc2V0cy50b3AgLSBpbnNldHMuYm90dG9tKTtcbiAgICAgICAgICAgIGZ1bGxzY3JlZW4gPSBDR1JlY3RNYWtlKDAsIDAsIHNjcm9sbFZpZXcuY29udGVudFNpemUud2lkdGgsIHNjcm9sbFZpZXcuY29udGVudFNpemUuaGVpZ2h0KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbG9jYXRpb25JbldpbmRvdyA9IHZpZXcuZ2V0TG9jYXRpb25JbldpbmRvdygpO1xuICAgICAgICB2YXIgaW5XaW5kb3dMZWZ0ID0gbG9jYXRpb25JbldpbmRvdy54O1xuICAgICAgICB2YXIgaW5XaW5kb3dUb3AgPSBsb2NhdGlvbkluV2luZG93Lnk7XG4gICAgICAgIGlmIChzY3JvbGxWaWV3KSB7XG4gICAgICAgICAgICBpbldpbmRvd0xlZnQgKz0gc2Nyb2xsVmlldy5jb250ZW50T2Zmc2V0Lng7XG4gICAgICAgICAgICBpbldpbmRvd1RvcCArPSBzY3JvbGxWaWV3LmNvbnRlbnRPZmZzZXQueTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW5XaW5kb3cgPSBDR1JlY3RNYWtlKGluV2luZG93TGVmdCwgaW5XaW5kb3dUb3AsIGZyYW1lLnNpemUud2lkdGgsIGZyYW1lLnNpemUuaGVpZ2h0KTtcbiAgICAgICAgcmV0dXJuIHsgc2FmZUFyZWE6IHNhZmVBcmVhLCBmdWxsc2NyZWVuOiBmdWxsc2NyZWVuLCBpbldpbmRvdzogaW5XaW5kb3cgfTtcbiAgICB9XG4gICAgdmFyIFVJTGF5b3V0Vmlld0NvbnRyb2xsZXIgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVUlMYXlvdXRWaWV3Q29udHJvbGxlciwgX3N1cGVyKTtcbiAgICAgICAgZnVuY3Rpb24gVUlMYXlvdXRWaWV3Q29udHJvbGxlcigpIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgfVxuICAgICAgICBVSUxheW91dFZpZXdDb250cm9sbGVyLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgICAgIHZhciBjb250cm9sbGVyID0gVUlMYXlvdXRWaWV3Q29udHJvbGxlci5uZXcoKTtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIub3duZXIgPSBvd25lcjtcbiAgICAgICAgICAgIHJldHVybiBjb250cm9sbGVyO1xuICAgICAgICB9O1xuICAgICAgICBVSUxheW91dFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS52aWV3RGlkTG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld0RpZExvYWQuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuZXh0ZW5kZWRMYXlvdXRJbmNsdWRlc09wYXF1ZUJhcnMgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBVSUxheW91dFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS52aWV3V2lsbExheW91dFN1YnZpZXdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS52aWV3V2lsbExheW91dFN1YnZpZXdzLmNhbGwodGhpcyk7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyLmdldCgpO1xuICAgICAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICAgICAgdXBkYXRlQ29uc3RyYWludHModGhpcywgb3duZXIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBVSUxheW91dFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS52aWV3RGlkTGF5b3V0U3Vidmlld3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWRMYXlvdXRTdWJ2aWV3cy5jYWxsKHRoaXMpO1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmIChvd25lcikge1xuICAgICAgICAgICAgICAgIGlmIChtYWpvclZlcnNpb24gPj0gMTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhYlZpZXdJdGVtID0gb3duZXIucGFyZW50O1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFiVmlldyA9IHRhYlZpZXdJdGVtICYmIHRhYlZpZXdJdGVtLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmVudF8yID0gdGFiVmlldyAmJiB0YWJWaWV3LnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHBhcmVudF8yICYmICFwYXJlbnRfMi5uYXRpdmVWaWV3UHJvdGVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnRfMiA9IHBhcmVudF8yLnBhcmVudDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50XzIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRQYWdlSW5zZXRzVG9wID0gcGFyZW50XzIubmF0aXZlVmlld1Byb3RlY3RlZC5zYWZlQXJlYUluc2V0cy50b3A7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudEluc2V0c1RvcCA9IHRoaXMudmlldy5zYWZlQXJlYUluc2V0cy50b3A7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbEluc2V0c1RvcCA9IE1hdGgubWF4KHBhcmVudFBhZ2VJbnNldHNUb3AgLSBjdXJyZW50SW5zZXRzVG9wLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnRQYWdlSW5zZXRzQm90dG9tID0gcGFyZW50XzIubmF0aXZlVmlld1Byb3RlY3RlZC5zYWZlQXJlYUluc2V0cy5ib3R0b207XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudEluc2V0c0JvdHRvbSA9IHRoaXMudmlldy5zYWZlQXJlYUluc2V0cy5ib3R0b207XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkaXRpb25hbEluc2V0c0JvdHRvbSA9IE1hdGgubWF4KHBhcmVudFBhZ2VJbnNldHNCb3R0b20gLSBjdXJyZW50SW5zZXRzQm90dG9tLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRpdGlvbmFsSW5zZXRzVG9wID4gMCB8fCBhZGRpdGlvbmFsSW5zZXRzQm90dG9tID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhZGRpdGlvbmFsSW5zZXRzID0gbmV3IFVJRWRnZUluc2V0cyh7IHRvcDogYWRkaXRpb25hbEluc2V0c1RvcCwgbGVmdDogMCwgYm90dG9tOiBhZGRpdGlvbmFsSW5zZXRzQm90dG9tLCByaWdodDogMCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFkZGl0aW9uYWxTYWZlQXJlYUluc2V0cyA9IGFkZGl0aW9uYWxJbnNldHM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGF5b3V0Vmlldyh0aGlzLCBvd25lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFVJTGF5b3V0Vmlld0NvbnRyb2xsZXIucHJvdG90eXBlLnZpZXdXaWxsQXBwZWFyID0gZnVuY3Rpb24gKGFuaW1hdGVkKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdXaWxsQXBwZWFyLmNhbGwodGhpcywgYW5pbWF0ZWQpO1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB1cGRhdGVBdXRvQWRqdXN0U2Nyb2xsSW5zZXRzKHRoaXMsIG93bmVyKTtcbiAgICAgICAgICAgIGlmICghb3duZXIucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgb3duZXIuY2FsbExvYWRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBVSUxheW91dFZpZXdDb250cm9sbGVyLnByb3RvdHlwZS52aWV3RGlkRGlzYXBwZWFyID0gZnVuY3Rpb24gKGFuaW1hdGVkKSB7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdEaWREaXNhcHBlYXIuY2FsbCh0aGlzLCBhbmltYXRlZCk7XG4gICAgICAgICAgICB2YXIgb3duZXIgPSB0aGlzLm93bmVyLmdldCgpO1xuICAgICAgICAgICAgaWYgKG93bmVyICYmICFvd25lci5wYXJlbnQpIHtcbiAgICAgICAgICAgICAgICBvd25lci5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFVJTGF5b3V0Vmlld0NvbnRyb2xsZXI7XG4gICAgfShVSVZpZXdDb250cm9sbGVyKSk7XG4gICAgaW9zLlVJTGF5b3V0Vmlld0NvbnRyb2xsZXIgPSBVSUxheW91dFZpZXdDb250cm9sbGVyO1xuICAgIHZhciBVSVBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXAgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgICAgICBfX2V4dGVuZHMoVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wLCBfc3VwZXIpO1xuICAgICAgICBmdW5jdGlvbiBVSVBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXAoKSB7XG4gICAgICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wLmluaXRXaXRoT3duZXJBbmRDYWxsYmFjayA9IGZ1bmN0aW9uIChvd25lciwgd2hlbkNsb3NlZENhbGxiYWNrKSB7XG4gICAgICAgICAgICB2YXIgaW5zdGFuY2UgPSBfc3VwZXIubmV3LmNhbGwodGhpcyk7XG4gICAgICAgICAgICBpbnN0YW5jZS5vd25lciA9IG93bmVyO1xuICAgICAgICAgICAgaW5zdGFuY2UuY2xvc2VkQ2FsbGJhY2sgPSB3aGVuQ2xvc2VkQ2FsbGJhY2s7XG4gICAgICAgICAgICByZXR1cm4gaW5zdGFuY2U7XG4gICAgICAgIH07XG4gICAgICAgIFVJUG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcC5wcm90b3R5cGUucG9wb3ZlclByZXNlbnRhdGlvbkNvbnRyb2xsZXJEaWREaXNtaXNzUG9wb3ZlciA9IGZ1bmN0aW9uIChwb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlcikge1xuICAgICAgICAgICAgdmFyIG93bmVyID0gdGhpcy5vd25lci5nZXQoKTtcbiAgICAgICAgICAgIGlmIChvd25lciAmJiB0eXBlb2YgdGhpcy5jbG9zZWRDYWxsYmFjayA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZWRDYWxsYmFjaygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBVSVBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyRGVsZWdhdGVJbXAuT2JqQ1Byb3RvY29scyA9IFtVSVBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyRGVsZWdhdGVdO1xuICAgICAgICByZXR1cm4gVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wO1xuICAgIH0oTlNPYmplY3QpKTtcbiAgICBpb3MuVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wID0gVUlQb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wO1xufSkoaW9zID0gZXhwb3J0cy5pb3MgfHwgKGV4cG9ydHMuaW9zID0ge30pKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXZpZXcuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBoYW5kbGVyc0ZvckV2ZW50TmFtZSA9IG5ldyBNYXAoKTtcbnZhciBzb3VyY2VzTWFwID0gbmV3IFdlYWtNYXAoKTtcbnZhciBUYXJnZXRIYW5kbGVyUGFpciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVGFyZ2V0SGFuZGxlclBhaXIodGFyZ2V0LCBoYW5kbGVyKSB7XG4gICAgICAgIHRoaXMudGFnZXRSZWYgPSBuZXcgV2Vha1JlZih0YXJnZXQpO1xuICAgICAgICB0aGlzLmhhbmRsZXIgPSBoYW5kbGVyO1xuICAgIH1cbiAgICByZXR1cm4gVGFyZ2V0SGFuZGxlclBhaXI7XG59KCkpO1xuZnVuY3Rpb24gZ2V0SGFuZGxlckZvckV2ZW50TmFtZShldmVudE5hbWUpIHtcbiAgICB2YXIgaGFuZGxlciA9IGhhbmRsZXJzRm9yRXZlbnROYW1lLmdldChldmVudE5hbWUpO1xuICAgIGlmICghaGFuZGxlcikge1xuICAgICAgICBoYW5kbGVyID0gZnVuY3Rpb24gKGV2ZW50RGF0YSkge1xuICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGV2ZW50RGF0YS5vYmplY3Q7XG4gICAgICAgICAgICB2YXIgc291cmNlRXZlbnRNYXAgPSBzb3VyY2VzTWFwLmdldChzb3VyY2UpO1xuICAgICAgICAgICAgaWYgKCFzb3VyY2VFdmVudE1hcCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlcnNGb3JFdmVudE5hbWUuZ2V0KGV2ZW50TmFtZSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB0YXJnZXRIYW5kbGVyUGFpckxpc3QgPSBzb3VyY2VFdmVudE1hcC5nZXQoZXZlbnROYW1lKTtcbiAgICAgICAgICAgIGlmICghdGFyZ2V0SGFuZGxlclBhaXJMaXN0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGRlYWRQYWlyc0luZGV4ZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciBwYWlyO1xuICAgICAgICAgICAgdmFyIHRhcmdldDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0SGFuZGxlclBhaXJMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgcGFpciA9IHRhcmdldEhhbmRsZXJQYWlyTGlzdFtpXTtcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSBwYWlyLnRhZ2V0UmVmLmdldCgpO1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFpci5oYW5kbGVyLmNhbGwodGFyZ2V0LCBldmVudERhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZGVhZFBhaXJzSW5kZXhlcy5wdXNoKGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChkZWFkUGFpcnNJbmRleGVzLmxlbmd0aCA9PT0gdGFyZ2V0SGFuZGxlclBhaXJMaXN0Lmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgaGFuZGxlcnNGb3JFdmVudE5hbWUuZ2V0KGV2ZW50TmFtZSkpO1xuICAgICAgICAgICAgICAgIHNvdXJjZUV2ZW50TWFwLmRlbGV0ZShldmVudE5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRlYWRQYWlyc0luZGV4ZXMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SGFuZGxlclBhaXJMaXN0LnNwbGljZShkZWFkUGFpcnNJbmRleGVzW2pdLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGhhbmRsZXJzRm9yRXZlbnROYW1lLnNldChldmVudE5hbWUsIGhhbmRsZXIpO1xuICAgIH1cbiAgICByZXR1cm4gaGFuZGxlcjtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlQXJncyhzb3VyY2UsIGV2ZW50TmFtZSwgaGFuZGxlciwgdGFyZ2V0KSB7XG4gICAgaWYgKCFzb3VyY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwic291cmNlIGlzIG51bGwgb3IgdW5kZWZpbmVkXCIpO1xuICAgIH1cbiAgICBpZiAoIXRhcmdldCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0YXJnZXQgaXMgbnVsbCBvciB1bmRlZmluZWRcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZXZlbnROYW1lICE9PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImV2ZW50TmFtZSBpcyBub3QgYSBzdHJpbmdcIik7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgaGFuZGxlciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcImhhbmRsZXIgaXMgbm90IGEgZnVuY3Rpb25cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRkV2Vha0V2ZW50TGlzdGVuZXIoc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCkge1xuICAgIHZhbGlkYXRlQXJncyhzb3VyY2UsIGV2ZW50TmFtZSwgaGFuZGxlciwgdGFyZ2V0KTtcbiAgICB2YXIgc2hvdWxkQXR0YWNoID0gZmFsc2U7XG4gICAgdmFyIHNvdXJjZUV2ZW50TWFwID0gc291cmNlc01hcC5nZXQoc291cmNlKTtcbiAgICBpZiAoIXNvdXJjZUV2ZW50TWFwKSB7XG4gICAgICAgIHNvdXJjZUV2ZW50TWFwID0gbmV3IE1hcCgpO1xuICAgICAgICBzb3VyY2VzTWFwLnNldChzb3VyY2UsIHNvdXJjZUV2ZW50TWFwKTtcbiAgICAgICAgc2hvdWxkQXR0YWNoID0gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIHBhaXJMaXN0ID0gc291cmNlRXZlbnRNYXAuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCFwYWlyTGlzdCkge1xuICAgICAgICBwYWlyTGlzdCA9IG5ldyBBcnJheSgpO1xuICAgICAgICBzb3VyY2VFdmVudE1hcC5zZXQoZXZlbnROYW1lLCBwYWlyTGlzdCk7XG4gICAgICAgIHNob3VsZEF0dGFjaCA9IHRydWU7XG4gICAgfVxuICAgIHBhaXJMaXN0LnB1c2gobmV3IFRhcmdldEhhbmRsZXJQYWlyKHRhcmdldCwgaGFuZGxlcikpO1xuICAgIGlmIChzaG91bGRBdHRhY2gpIHtcbiAgICAgICAgc291cmNlLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBnZXRIYW5kbGVyRm9yRXZlbnROYW1lKGV2ZW50TmFtZSkpO1xuICAgIH1cbn1cbmV4cG9ydHMuYWRkV2Vha0V2ZW50TGlzdGVuZXIgPSBhZGRXZWFrRXZlbnRMaXN0ZW5lcjtcbmZ1bmN0aW9uIHJlbW92ZVdlYWtFdmVudExpc3RlbmVyKHNvdXJjZSwgZXZlbnROYW1lLCBoYW5kbGVyLCB0YXJnZXQpIHtcbiAgICB2YWxpZGF0ZUFyZ3Moc291cmNlLCBldmVudE5hbWUsIGhhbmRsZXIsIHRhcmdldCk7XG4gICAgdmFyIGhhbmRsZXJGb3JFdmVudFdpdGhOYW1lID0gaGFuZGxlcnNGb3JFdmVudE5hbWUuZ2V0KGV2ZW50TmFtZSk7XG4gICAgaWYgKCFoYW5kbGVyRm9yRXZlbnRXaXRoTmFtZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciBzb3VyY2VFdmVudE1hcCA9IHNvdXJjZXNNYXAuZ2V0KHNvdXJjZSk7XG4gICAgaWYgKCFzb3VyY2VFdmVudE1hcCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0YXJnZXRIYW5kbGVyUGFpckxpc3QgPSBzb3VyY2VFdmVudE1hcC5nZXQoZXZlbnROYW1lKTtcbiAgICBpZiAoIXRhcmdldEhhbmRsZXJQYWlyTGlzdCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZSA9IFtdO1xuICAgIHZhciBwYWlyO1xuICAgIHZhciByZWdpc3RlcmVkVGFyZ2V0O1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0SGFuZGxlclBhaXJMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHBhaXIgPSB0YXJnZXRIYW5kbGVyUGFpckxpc3RbaV07XG4gICAgICAgIHJlZ2lzdGVyZWRUYXJnZXQgPSBwYWlyLnRhZ2V0UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXJlZ2lzdGVyZWRUYXJnZXQgfHwgKHJlZ2lzdGVyZWRUYXJnZXQgPT09IHRhcmdldCAmJiBoYW5kbGVyID09PSBwYWlyLmhhbmRsZXIpKSB7XG4gICAgICAgICAgICB0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZS5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICh0YXJnZXRIYW5kbGVyUGFpcnNUb1JlbW92ZS5sZW5ndGggPT09IHRhcmdldEhhbmRsZXJQYWlyTGlzdC5sZW5ndGgpIHtcbiAgICAgICAgc291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoYW5kbGVyRm9yRXZlbnRXaXRoTmFtZSk7XG4gICAgICAgIHNvdXJjZUV2ZW50TWFwLmRlbGV0ZShldmVudE5hbWUpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IHRhcmdldEhhbmRsZXJQYWlyc1RvUmVtb3ZlLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG4gICAgICAgICAgICB0YXJnZXRIYW5kbGVyUGFpckxpc3Quc3BsaWNlKHRhcmdldEhhbmRsZXJQYWlyc1RvUmVtb3ZlW2pdLCAxKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbmV4cG9ydHMucmVtb3ZlV2Vha0V2ZW50TGlzdGVuZXIgPSByZW1vdmVXZWFrRXZlbnRMaXN0ZW5lcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXdlYWstZXZlbnQtbGlzdGVuZXIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHBsYXRmb3JtXzEgPSByZXF1aXJlKFwiLi4vLi4vcGxhdGZvcm1cIik7XG52YXIgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy90eXBlc1wiKTtcbmV4cG9ydHMuU1RSSU5HID0gXCJzdHJpbmdcIjtcbmV4cG9ydHMuUFJPTVBUID0gXCJQcm9tcHRcIjtcbmV4cG9ydHMuQ09ORklSTSA9IFwiQ29uZmlybVwiO1xuZXhwb3J0cy5BTEVSVCA9IFwiQWxlcnRcIjtcbmV4cG9ydHMuTE9HSU4gPSBcIkxvZ2luXCI7XG5leHBvcnRzLk9LID0gXCJPS1wiO1xuZXhwb3J0cy5DQU5DRUwgPSBcIkNhbmNlbFwiO1xudmFyIGlucHV0VHlwZTtcbihmdW5jdGlvbiAoaW5wdXRUeXBlKSB7XG4gICAgaW5wdXRUeXBlLnRleHQgPSBcInRleHRcIjtcbiAgICBpbnB1dFR5cGUucGFzc3dvcmQgPSBcInBhc3N3b3JkXCI7XG4gICAgaW5wdXRUeXBlLmVtYWlsID0gXCJlbWFpbFwiO1xuICAgIGlucHV0VHlwZS5udW1iZXIgPSBcIm51bWJlclwiO1xuICAgIGlucHV0VHlwZS5kZWNpbWFsID0gXCJkZWNpbWFsXCI7XG4gICAgaW5wdXRUeXBlLnBob25lID0gXCJwaG9uZVwiO1xufSkoaW5wdXRUeXBlID0gZXhwb3J0cy5pbnB1dFR5cGUgfHwgKGV4cG9ydHMuaW5wdXRUeXBlID0ge30pKTtcbnZhciBjYXBpdGFsaXphdGlvblR5cGU7XG4oZnVuY3Rpb24gKGNhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgIGNhcGl0YWxpemF0aW9uVHlwZS5ub25lID0gXCJub25lXCI7XG4gICAgY2FwaXRhbGl6YXRpb25UeXBlLmFsbCA9IFwiYWxsXCI7XG4gICAgY2FwaXRhbGl6YXRpb25UeXBlLnNlbnRlbmNlcyA9IFwic2VudGVuY2VzXCI7XG4gICAgY2FwaXRhbGl6YXRpb25UeXBlLndvcmRzID0gXCJ3b3Jkc1wiO1xufSkoY2FwaXRhbGl6YXRpb25UeXBlID0gZXhwb3J0cy5jYXBpdGFsaXphdGlvblR5cGUgfHwgKGV4cG9ydHMuY2FwaXRhbGl6YXRpb25UeXBlID0ge30pKTtcbnZhciBmcmFtZTtcbmZ1bmN0aW9uIGdldEN1cnJlbnRQYWdlKCkge1xuICAgIGlmICghZnJhbWUpIHtcbiAgICAgICAgZnJhbWUgPSByZXF1aXJlKFwidWkvZnJhbWVcIik7XG4gICAgfVxuICAgIHZhciB0b3Btb3N0RnJhbWUgPSBmcmFtZS50b3Btb3N0KCk7XG4gICAgaWYgKHRvcG1vc3RGcmFtZSkge1xuICAgICAgICByZXR1cm4gdG9wbW9zdEZyYW1lLmN1cnJlbnRQYWdlO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5nZXRDdXJyZW50UGFnZSA9IGdldEN1cnJlbnRQYWdlO1xuZnVuY3Rpb24gYXBwbHlTZWxlY3RvcnModmlldywgY2FsbGJhY2spIHtcbiAgICB2YXIgY3VycmVudFBhZ2UgPSBnZXRDdXJyZW50UGFnZSgpO1xuICAgIGlmIChjdXJyZW50UGFnZSkge1xuICAgICAgICB2YXIgc3R5bGVTY29wZSA9IGN1cnJlbnRQYWdlLl9zdHlsZVNjb3BlO1xuICAgICAgICBpZiAoc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgdmlldy5faW5oZXJpdFN0eWxlU2NvcGUoc3R5bGVTY29wZSk7XG4gICAgICAgICAgICB2aWV3Lm9uTG9hZGVkKCk7XG4gICAgICAgICAgICBjYWxsYmFjayh2aWV3KTtcbiAgICAgICAgICAgIHZpZXcub25VbmxvYWRlZCgpO1xuICAgICAgICB9XG4gICAgfVxufVxudmFyIGJ1dHRvbjtcbnZhciBsYWJlbDtcbnZhciB0ZXh0RmllbGQ7XG5mdW5jdGlvbiBnZXRCdXR0b25Db2xvcnMoKSB7XG4gICAgaWYgKCFidXR0b24pIHtcbiAgICAgICAgdmFyIEJ1dHRvbiA9IHJlcXVpcmUoXCJ1aS9idXR0b25cIikuQnV0dG9uO1xuICAgICAgICBidXR0b24gPSBuZXcgQnV0dG9uO1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5pc0lPUykge1xuICAgICAgICAgICAgYnV0dG9uLl9zZXR1cFVJKHt9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgYnV0dG9uQ29sb3I7XG4gICAgdmFyIGJ1dHRvbkJhY2tncm91bmRDb2xvcjtcbiAgICBhcHBseVNlbGVjdG9ycyhidXR0b24sIGZ1bmN0aW9uIChidG4pIHtcbiAgICAgICAgYnV0dG9uQ29sb3IgPSBidG4uY29sb3I7XG4gICAgICAgIGJ1dHRvbkJhY2tncm91bmRDb2xvciA9IGJ0bi5iYWNrZ3JvdW5kQ29sb3I7XG4gICAgfSk7XG4gICAgcmV0dXJuIHsgY29sb3I6IGJ1dHRvbkNvbG9yLCBiYWNrZ3JvdW5kQ29sb3I6IGJ1dHRvbkJhY2tncm91bmRDb2xvciB9O1xufVxuZXhwb3J0cy5nZXRCdXR0b25Db2xvcnMgPSBnZXRCdXR0b25Db2xvcnM7XG5mdW5jdGlvbiBnZXRMYWJlbENvbG9yKCkge1xuICAgIGlmICghbGFiZWwpIHtcbiAgICAgICAgdmFyIExhYmVsID0gcmVxdWlyZShcInVpL2xhYmVsXCIpLkxhYmVsO1xuICAgICAgICBsYWJlbCA9IG5ldyBMYWJlbDtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIGxhYmVsLl9zZXR1cFVJKHt9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgbGFiZWxDb2xvcjtcbiAgICBhcHBseVNlbGVjdG9ycyhsYWJlbCwgZnVuY3Rpb24gKGxibCkge1xuICAgICAgICBsYWJlbENvbG9yID0gbGJsLmNvbG9yO1xuICAgIH0pO1xuICAgIHJldHVybiBsYWJlbENvbG9yO1xufVxuZXhwb3J0cy5nZXRMYWJlbENvbG9yID0gZ2V0TGFiZWxDb2xvcjtcbmZ1bmN0aW9uIGdldFRleHRGaWVsZENvbG9yKCkge1xuICAgIGlmICghdGV4dEZpZWxkKSB7XG4gICAgICAgIHZhciBUZXh0RmllbGQgPSByZXF1aXJlKFwidWkvdGV4dC1maWVsZFwiKS5UZXh0RmllbGQ7XG4gICAgICAgIHRleHRGaWVsZCA9IG5ldyBUZXh0RmllbGQoKTtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIHRleHRGaWVsZC5fc2V0dXBVSSh7fSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHRleHRGaWVsZENvbG9yO1xuICAgIGFwcGx5U2VsZWN0b3JzKHRleHRGaWVsZCwgZnVuY3Rpb24gKHRmKSB7XG4gICAgICAgIHRleHRGaWVsZENvbG9yID0gdGYuY29sb3I7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRleHRGaWVsZENvbG9yO1xufVxuZXhwb3J0cy5nZXRUZXh0RmllbGRDb2xvciA9IGdldFRleHRGaWVsZENvbG9yO1xuZnVuY3Rpb24gaXNEaWFsb2dPcHRpb25zKGFyZykge1xuICAgIHJldHVybiBhcmcgJiYgKGFyZy5tZXNzYWdlIHx8IGFyZy50aXRsZSk7XG59XG5leHBvcnRzLmlzRGlhbG9nT3B0aW9ucyA9IGlzRGlhbG9nT3B0aW9ucztcbmZ1bmN0aW9uIHBhcnNlTG9naW5PcHRpb25zKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDEgJiYgdHlwZXNfMS5pc09iamVjdChhcmdzWzBdKSkge1xuICAgICAgICByZXR1cm4gYXJnc1swXTtcbiAgICB9XG4gICAgdmFyIG9wdGlvbnMgPSB7IHRpdGxlOiBleHBvcnRzLkxPR0lOLCBva0J1dHRvblRleHQ6IGV4cG9ydHMuT0ssIGNhbmNlbEJ1dHRvblRleHQ6IGV4cG9ydHMuQ0FOQ0VMIH07XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1swXSkpIHtcbiAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJnc1swXTtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJnc1sxXSkpIHtcbiAgICAgICAgb3B0aW9ucy51c2VyTmFtZUhpbnQgPSBhcmdzWzFdO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmdzWzJdKSkge1xuICAgICAgICBvcHRpb25zLnBhc3N3b3JkSGludCA9IGFyZ3NbMl07XG4gICAgfVxuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3NbM10pKSB7XG4gICAgICAgIG9wdGlvbnMudXNlck5hbWUgPSBhcmdzWzNdO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmdzWzRdKSkge1xuICAgICAgICBvcHRpb25zLnBhc3N3b3JkID0gYXJnc1s0XTtcbiAgICB9XG4gICAgcmV0dXJuIG9wdGlvbnM7XG59XG5leHBvcnRzLnBhcnNlTG9naW5PcHRpb25zID0gcGFyc2VMb2dpbk9wdGlvbnM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1kaWFsb2dzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHZpZXdfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3ZpZXdcIik7XG52YXIgZGlhbG9nc19jb21tb25fMSA9IHJlcXVpcmUoXCIuL2RpYWxvZ3MtY29tbW9uXCIpO1xudmFyIHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vdXRpbHMvdHlwZXNcIik7XG52YXIgYXBwbGljYXRpb25fMSA9IHJlcXVpcmUoXCIuLi8uLi9hcHBsaWNhdGlvblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2RpYWxvZ3MtY29tbW9uXCIpKTtcbmZ1bmN0aW9uIGFkZEJ1dHRvbnNUb0FsZXJ0Q29udHJvbGxlcihhbGVydENvbnRyb2xsZXIsIG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcob3B0aW9ucy5jYW5jZWxCdXR0b25UZXh0KSkge1xuICAgICAgICBhbGVydENvbnRyb2xsZXIuYWRkQWN0aW9uKFVJQWxlcnRBY3Rpb24uYWN0aW9uV2l0aFRpdGxlU3R5bGVIYW5kbGVyKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCwgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmFpc2VDYWxsYmFjayhjYWxsYmFjaywgZmFsc2UpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKG9wdGlvbnMubmV1dHJhbEJ1dHRvblRleHQpKSB7XG4gICAgICAgIGFsZXJ0Q29udHJvbGxlci5hZGRBY3Rpb24oVUlBbGVydEFjdGlvbi5hY3Rpb25XaXRoVGl0bGVTdHlsZUhhbmRsZXIob3B0aW9ucy5uZXV0cmFsQnV0dG9uVGV4dCwgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmFpc2VDYWxsYmFjayhjYWxsYmFjaywgdW5kZWZpbmVkKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhvcHRpb25zLm9rQnV0dG9uVGV4dCkpIHtcbiAgICAgICAgYWxlcnRDb250cm9sbGVyLmFkZEFjdGlvbihVSUFsZXJ0QWN0aW9uLmFjdGlvbldpdGhUaXRsZVN0eWxlSGFuZGxlcihvcHRpb25zLm9rQnV0dG9uVGV4dCwgMCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmFpc2VDYWxsYmFjayhjYWxsYmFjaywgdHJ1ZSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5mdW5jdGlvbiByYWlzZUNhbGxiYWNrKGNhbGxiYWNrLCByZXN1bHQpIHtcbiAgICBpZiAodHlwZXNfMS5pc0Z1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgICBjYWxsYmFjayhyZXN1bHQpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGFsZXJ0KGFyZykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9ICFkaWFsb2dzX2NvbW1vbl8xLmlzRGlhbG9nT3B0aW9ucyhhcmcpID8geyB0aXRsZTogZGlhbG9nc19jb21tb25fMS5BTEVSVCwgb2tCdXR0b25UZXh0OiBkaWFsb2dzX2NvbW1vbl8xLk9LLCBtZXNzYWdlOiBhcmcgKyBcIlwiIH0gOiBhcmc7XG4gICAgICAgICAgICB2YXIgYWxlcnRDb250cm9sbGVyID0gVUlBbGVydENvbnRyb2xsZXIuYWxlcnRDb250cm9sbGVyV2l0aFRpdGxlTWVzc2FnZVByZWZlcnJlZFN0eWxlKG9wdGlvbnMudGl0bGUsIG9wdGlvbnMubWVzc2FnZSwgMSk7XG4gICAgICAgICAgICBhZGRCdXR0b25zVG9BbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyLCBvcHRpb25zLCBmdW5jdGlvbiAoKSB7IHJlc29sdmUoKTsgfSk7XG4gICAgICAgICAgICBzaG93VUlBbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXgpIHtcbiAgICAgICAgICAgIHJlamVjdChleCk7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmV4cG9ydHMuYWxlcnQgPSBhbGVydDtcbmZ1bmN0aW9uIGNvbmZpcm0oYXJnKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gIWRpYWxvZ3NfY29tbW9uXzEuaXNEaWFsb2dPcHRpb25zKGFyZykgPyB7IHRpdGxlOiBkaWFsb2dzX2NvbW1vbl8xLkNPTkZJUk0sIG9rQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5PSywgY2FuY2VsQnV0dG9uVGV4dDogZGlhbG9nc19jb21tb25fMS5DQU5DRUwsIG1lc3NhZ2U6IGFyZyArIFwiXCIgfSA6IGFyZztcbiAgICAgICAgICAgIHZhciBhbGVydENvbnRyb2xsZXIgPSBVSUFsZXJ0Q29udHJvbGxlci5hbGVydENvbnRyb2xsZXJXaXRoVGl0bGVNZXNzYWdlUHJlZmVycmVkU3R5bGUob3B0aW9ucy50aXRsZSwgb3B0aW9ucy5tZXNzYWdlLCAxKTtcbiAgICAgICAgICAgIGFkZEJ1dHRvbnNUb0FsZXJ0Q29udHJvbGxlcihhbGVydENvbnRyb2xsZXIsIG9wdGlvbnMsIGZ1bmN0aW9uIChyKSB7IHJlc29sdmUocik7IH0pO1xuICAgICAgICAgICAgc2hvd1VJQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmNvbmZpcm0gPSBjb25maXJtO1xuZnVuY3Rpb24gcHJvbXB0KGFyZykge1xuICAgIHZhciBvcHRpb25zO1xuICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAgICAgdGl0bGU6IGRpYWxvZ3NfY29tbW9uXzEuUFJPTVBULFxuICAgICAgICBva0J1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuT0ssXG4gICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuQ0FOQ0VMLFxuICAgICAgICBpbnB1dFR5cGU6IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLnRleHQsXG4gICAgfTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmcpKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmc7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBvcHRpb25zID0gYXJnO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJndW1lbnRzWzBdKSAmJiB0eXBlc18xLmlzU3RyaW5nKGFyZ3VtZW50c1sxXSkpIHtcbiAgICAgICAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICAgICAgICAgIG9wdGlvbnMubWVzc2FnZSA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgICAgIG9wdGlvbnMuZGVmYXVsdFRleHQgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciB0ZXh0RmllbGRfMTtcbiAgICAgICAgICAgIHZhciBhbGVydENvbnRyb2xsZXIgPSBVSUFsZXJ0Q29udHJvbGxlci5hbGVydENvbnRyb2xsZXJXaXRoVGl0bGVNZXNzYWdlUHJlZmVycmVkU3R5bGUob3B0aW9ucy50aXRsZSwgb3B0aW9ucy5tZXNzYWdlLCAxKTtcbiAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5hZGRUZXh0RmllbGRXaXRoQ29uZmlndXJhdGlvbkhhbmRsZXIoZnVuY3Rpb24gKGFyZykge1xuICAgICAgICAgICAgICAgIGFyZy50ZXh0ID0gdHlwZXNfMS5pc1N0cmluZyhvcHRpb25zLmRlZmF1bHRUZXh0KSA/IG9wdGlvbnMuZGVmYXVsdFRleHQgOiBcIlwiO1xuICAgICAgICAgICAgICAgIGFyZy5zZWN1cmVUZXh0RW50cnkgPSBvcHRpb25zICYmIG9wdGlvbnMuaW5wdXRUeXBlID09PSBkaWFsb2dzX2NvbW1vbl8xLmlucHV0VHlwZS5wYXNzd29yZDtcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUuZW1haWwpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLmtleWJvYXJkVHlwZSA9IDc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5pbnB1dFR5cGUgPT09IGRpYWxvZ3NfY29tbW9uXzEuaW5wdXRUeXBlLm51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICBhcmcua2V5Ym9hcmRUeXBlID0gNDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUuZGVjaW1hbCkge1xuICAgICAgICAgICAgICAgICAgICBhcmcua2V5Ym9hcmRUeXBlID0gODtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmlucHV0VHlwZSA9PT0gZGlhbG9nc19jb21tb25fMS5pbnB1dFR5cGUucGhvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLmtleWJvYXJkVHlwZSA9IDU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjb2xvciA9IGRpYWxvZ3NfY29tbW9uXzEuZ2V0VGV4dEZpZWxkQ29sb3IoKTtcbiAgICAgICAgICAgICAgICBpZiAoY29sb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLnRleHRDb2xvciA9IGFyZy50aW50Q29sb3IgPSBjb2xvci5pb3M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0ZXh0RmllbGRfMSA9IGFsZXJ0Q29udHJvbGxlci50ZXh0RmllbGRzLmZpcnN0T2JqZWN0O1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wdGlvbnMuY2FwaXRhbGl6YXRpb25UeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZGlhbG9nc19jb21tb25fMS5jYXBpdGFsaXphdGlvblR5cGUuYWxsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RmllbGRfMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZGlhbG9nc19jb21tb25fMS5jYXBpdGFsaXphdGlvblR5cGUuc2VudGVuY2VzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0RmllbGRfMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlID0gMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgZGlhbG9nc19jb21tb25fMS5jYXBpdGFsaXphdGlvblR5cGUud29yZHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRGaWVsZF8xLmF1dG9jYXBpdGFsaXphdGlvblR5cGUgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dEZpZWxkXzEuYXV0b2NhcGl0YWxpemF0aW9uVHlwZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhZGRCdXR0b25zVG9BbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyLCBvcHRpb25zLCBmdW5jdGlvbiAocikgeyByZXNvbHZlKHsgcmVzdWx0OiByLCB0ZXh0OiB0ZXh0RmllbGRfMS50ZXh0IH0pOyB9KTtcbiAgICAgICAgICAgIHNob3dVSUFsZXJ0Q29udHJvbGxlcihhbGVydENvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChleCkge1xuICAgICAgICAgICAgcmVqZWN0KGV4KTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuZXhwb3J0cy5wcm9tcHQgPSBwcm9tcHQ7XG5mdW5jdGlvbiBsb2dpbigpIHtcbiAgICB2YXIgYXJncyA9IFtdO1xuICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICB9XG4gICAgdmFyIG9wdGlvbnMgPSBkaWFsb2dzX2NvbW1vbl8xLnBhcnNlTG9naW5PcHRpb25zKGFyZ3MpO1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgdXNlck5hbWVUZXh0RmllbGRfMTtcbiAgICAgICAgICAgIHZhciBwYXNzd29yZFRleHRGaWVsZF8xO1xuICAgICAgICAgICAgdmFyIGFsZXJ0Q29udHJvbGxlciA9IFVJQWxlcnRDb250cm9sbGVyLmFsZXJ0Q29udHJvbGxlcldpdGhUaXRsZU1lc3NhZ2VQcmVmZXJyZWRTdHlsZShvcHRpb25zLnRpdGxlLCBvcHRpb25zLm1lc3NhZ2UsIDEpO1xuICAgICAgICAgICAgdmFyIHRleHRGaWVsZENvbG9yXzEgPSBkaWFsb2dzX2NvbW1vbl8xLmdldFRleHRGaWVsZENvbG9yKCk7XG4gICAgICAgICAgICBhbGVydENvbnRyb2xsZXIuYWRkVGV4dEZpZWxkV2l0aENvbmZpZ3VyYXRpb25IYW5kbGVyKGZ1bmN0aW9uIChhcmcpIHtcbiAgICAgICAgICAgICAgICBhcmcucGxhY2Vob2xkZXIgPSBcIkxvZ2luXCI7XG4gICAgICAgICAgICAgICAgYXJnLnBsYWNlaG9sZGVyID0gb3B0aW9ucy51c2VyTmFtZUhpbnQgPyBvcHRpb25zLnVzZXJOYW1lSGludCA6IFwiXCI7XG4gICAgICAgICAgICAgICAgYXJnLnRleHQgPSB0eXBlc18xLmlzU3RyaW5nKG9wdGlvbnMudXNlck5hbWUpID8gb3B0aW9ucy51c2VyTmFtZSA6IFwiXCI7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRGaWVsZENvbG9yXzEpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJnLnRleHRDb2xvciA9IGFyZy50aW50Q29sb3IgPSB0ZXh0RmllbGRDb2xvcl8xLmlvcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5hZGRUZXh0RmllbGRXaXRoQ29uZmlndXJhdGlvbkhhbmRsZXIoZnVuY3Rpb24gKGFyZykge1xuICAgICAgICAgICAgICAgIGFyZy5wbGFjZWhvbGRlciA9IFwiUGFzc3dvcmRcIjtcbiAgICAgICAgICAgICAgICBhcmcuc2VjdXJlVGV4dEVudHJ5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBhcmcucGxhY2Vob2xkZXIgPSBvcHRpb25zLnBhc3N3b3JkSGludCA/IG9wdGlvbnMucGFzc3dvcmRIaW50IDogXCJcIjtcbiAgICAgICAgICAgICAgICBhcmcudGV4dCA9IHR5cGVzXzEuaXNTdHJpbmcob3B0aW9ucy5wYXNzd29yZCkgPyBvcHRpb25zLnBhc3N3b3JkIDogXCJcIjtcbiAgICAgICAgICAgICAgICBpZiAodGV4dEZpZWxkQ29sb3JfMSkge1xuICAgICAgICAgICAgICAgICAgICBhcmcudGV4dENvbG9yID0gYXJnLnRpbnRDb2xvciA9IHRleHRGaWVsZENvbG9yXzEuaW9zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdXNlck5hbWVUZXh0RmllbGRfMSA9IGFsZXJ0Q29udHJvbGxlci50ZXh0RmllbGRzLmZpcnN0T2JqZWN0O1xuICAgICAgICAgICAgcGFzc3dvcmRUZXh0RmllbGRfMSA9IGFsZXJ0Q29udHJvbGxlci50ZXh0RmllbGRzLmxhc3RPYmplY3Q7XG4gICAgICAgICAgICBhZGRCdXR0b25zVG9BbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyLCBvcHRpb25zLCBmdW5jdGlvbiAocikge1xuICAgICAgICAgICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQ6IHIsXG4gICAgICAgICAgICAgICAgICAgIHVzZXJOYW1lOiB1c2VyTmFtZVRleHRGaWVsZF8xLnRleHQsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFRleHRGaWVsZF8xLnRleHRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgc2hvd1VJQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmxvZ2luID0gbG9naW47XG5mdW5jdGlvbiBzaG93VUlBbGVydENvbnRyb2xsZXIoYWxlcnRDb250cm9sbGVyKSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICB2YXIgY3VycmVudFZpZXcgPSBkaWFsb2dzX2NvbW1vbl8xLmdldEN1cnJlbnRQYWdlKCkgfHwgYXBwbGljYXRpb25fMS5nZXRSb290VmlldygpO1xuICAgIGlmIChjdXJyZW50Vmlldykge1xuICAgICAgICBjdXJyZW50VmlldyA9IGN1cnJlbnRWaWV3Lm1vZGFsIHx8IGN1cnJlbnRWaWV3O1xuICAgICAgICB2YXIgdmlld0NvbnRyb2xsZXIgPSBjdXJyZW50Vmlldy5pb3M7XG4gICAgICAgIGlmICghKGN1cnJlbnRWaWV3LmlvcyBpbnN0YW5jZW9mIFVJVmlld0NvbnRyb2xsZXIpKSB7XG4gICAgICAgICAgICB2YXIgcGFyZW50V2l0aENvbnRyb2xsZXIgPSB2aWV3XzEuaW9zLmdldFBhcmVudFdpdGhWaWV3Q29udHJvbGxlcihjdXJyZW50Vmlldyk7XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlciA9IHBhcmVudFdpdGhDb250cm9sbGVyID8gcGFyZW50V2l0aENvbnRyb2xsZXIudmlld0NvbnRyb2xsZXIgOiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBpZiAoYWxlcnRDb250cm9sbGVyLnBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgYWxlcnRDb250cm9sbGVyLnBvcG92ZXJQcmVzZW50YXRpb25Db250cm9sbGVyLnNvdXJjZVZpZXcgPSB2aWV3Q29udHJvbGxlci52aWV3O1xuICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5wb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlci5zb3VyY2VSZWN0ID0gQ0dSZWN0TWFrZSh2aWV3Q29udHJvbGxlci52aWV3LmJvdW5kcy5zaXplLndpZHRoIC8gMi4wLCB2aWV3Q29udHJvbGxlci52aWV3LmJvdW5kcy5zaXplLmhlaWdodCAvIDIuMCwgMS4wLCAxLjApO1xuICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci5wb3BvdmVyUHJlc2VudGF0aW9uQ29udHJvbGxlci5wZXJtaXR0ZWRBcnJvd0RpcmVjdGlvbnMgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNvbG9yID0gZGlhbG9nc19jb21tb25fMS5nZXRCdXR0b25Db2xvcnMoKS5jb2xvcjtcbiAgICAgICAgICAgIGlmIChjb2xvcikge1xuICAgICAgICAgICAgICAgIGFsZXJ0Q29udHJvbGxlci52aWV3LnRpbnRDb2xvciA9IGNvbG9yLmlvcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBsYmxDb2xvciA9IGRpYWxvZ3NfY29tbW9uXzEuZ2V0TGFiZWxDb2xvcigpO1xuICAgICAgICAgICAgaWYgKGxibENvbG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFsZXJ0Q29udHJvbGxlci50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBOU0F0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0V2l0aFN0cmluZ0F0dHJpYnV0ZXMoYWxlcnRDb250cm9sbGVyLnRpdGxlLCAoX2EgPSB7fSwgX2FbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGxibENvbG9yLmlvcywgX2EpKTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnRDb250cm9sbGVyLnNldFZhbHVlRm9yS2V5KHRpdGxlLCBcImF0dHJpYnV0ZWRUaXRsZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFsZXJ0Q29udHJvbGxlci5tZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gTlNBdHRyaWJ1dGVkU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhTdHJpbmdBdHRyaWJ1dGVzKGFsZXJ0Q29udHJvbGxlci5tZXNzYWdlLCAoX2IgPSB7fSwgX2JbTlNGb3JlZ3JvdW5kQ29sb3JBdHRyaWJ1dGVOYW1lXSA9IGxibENvbG9yLmlvcywgX2IpKTtcbiAgICAgICAgICAgICAgICAgICAgYWxlcnRDb250cm9sbGVyLnNldFZhbHVlRm9yS2V5KG1lc3NhZ2UsIFwiYXR0cmlidXRlZE1lc3NhZ2VcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXIucHJlc2VudE1vZGFsVmlld0NvbnRyb2xsZXJBbmltYXRlZChhbGVydENvbnRyb2xsZXIsIHRydWUpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gYWN0aW9uKCkge1xuICAgIHZhciBvcHRpb25zO1xuICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHsgdGl0bGU6IG51bGwsIGNhbmNlbEJ1dHRvblRleHQ6IGRpYWxvZ3NfY29tbW9uXzEuQ0FOQ0VMIH07XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgaWYgKHR5cGVzXzEuaXNTdHJpbmcoYXJndW1lbnRzWzBdKSkge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGRlZmF1bHRPcHRpb25zO1xuICAgICAgICAgICAgb3B0aW9ucy5tZXNzYWdlID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgb3B0aW9ucyA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFyZ3VtZW50c1swXSkgJiYgdHlwZXNfMS5pc1N0cmluZyhhcmd1bWVudHNbMV0pKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMykge1xuICAgICAgICBpZiAodHlwZXNfMS5pc1N0cmluZyhhcmd1bWVudHNbMF0pICYmIHR5cGVzXzEuaXNTdHJpbmcoYXJndW1lbnRzWzFdKSAmJiB0eXBlc18xLmlzRGVmaW5lZChhcmd1bWVudHNbMl0pKSB7XG4gICAgICAgICAgICBvcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XG4gICAgICAgICAgICBvcHRpb25zLm1lc3NhZ2UgPSBhcmd1bWVudHNbMF07XG4gICAgICAgICAgICBvcHRpb25zLmNhbmNlbEJ1dHRvblRleHQgPSBhcmd1bWVudHNbMV07XG4gICAgICAgICAgICBvcHRpb25zLmFjdGlvbnMgPSBhcmd1bWVudHNbMl07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBpID0gdm9pZCAwO1xuICAgICAgICAgICAgdmFyIGFjdGlvbl8xO1xuICAgICAgICAgICAgdmFyIGFsZXJ0Q29udHJvbGxlciA9IFVJQWxlcnRDb250cm9sbGVyLmFsZXJ0Q29udHJvbGxlcldpdGhUaXRsZU1lc3NhZ2VQcmVmZXJyZWRTdHlsZShvcHRpb25zLnRpdGxlLCBvcHRpb25zLm1lc3NhZ2UsIDApO1xuICAgICAgICAgICAgaWYgKG9wdGlvbnMuYWN0aW9ucykge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBvcHRpb25zLmFjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uXzEgPSBvcHRpb25zLmFjdGlvbnNbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKGFjdGlvbl8xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnRDb250cm9sbGVyLmFkZEFjdGlvbihVSUFsZXJ0QWN0aW9uLmFjdGlvbldpdGhUaXRsZVN0eWxlSGFuZGxlcihhY3Rpb25fMSwgMCwgZnVuY3Rpb24gKGFyZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoYXJnLnRpdGxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlc18xLmlzU3RyaW5nKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCkpIHtcbiAgICAgICAgICAgICAgICBhbGVydENvbnRyb2xsZXIuYWRkQWN0aW9uKFVJQWxlcnRBY3Rpb24uYWN0aW9uV2l0aFRpdGxlU3R5bGVIYW5kbGVyKG9wdGlvbnMuY2FuY2VsQnV0dG9uVGV4dCwgMSwgZnVuY3Rpb24gKGFyZykge1xuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGFyZy50aXRsZSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2hvd1VJQWxlcnRDb250cm9sbGVyKGFsZXJ0Q29udHJvbGxlcik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KSB7XG4gICAgICAgICAgICByZWplY3QoZXgpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLmFjdGlvbiA9IGFjdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRpYWxvZ3MuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL3RleHQtYmFzZVwiKSk7XG52YXIgRWRpdGFibGVUZXh0QmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEVkaXRhYmxlVGV4dEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gRWRpdGFibGVUZXh0QmFzZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9mb2N1c0hhbmRsZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5fZ29Ub1Zpc3VhbFN0YXRlKFwiZm9jdXNcIik7IH07XG4gICAgICAgIF90aGlzLl9ibHVySGFuZGxlciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9nb1RvVmlzdWFsU3RhdGUoXCJibHVyXCIpOyB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLl91cGRhdGVUZXh0QmFzZUZvY3VzU3RhdGVIYW5kbGVyID0gZnVuY3Rpb24gKHN1YnNjcmliZSkge1xuICAgICAgICB2YXIgbWV0aG9kID0gc3Vic2NyaWJlID8gXCJvblwiIDogXCJvZmZcIjtcbiAgICAgICAgdGhpc1ttZXRob2RdKFwiZm9jdXNcIiwgdGhpcy5fZm9jdXNIYW5kbGVyKTtcbiAgICAgICAgdGhpc1ttZXRob2RdKFwiYmx1clwiLCB0aGlzLl9ibHVySGFuZGxlcik7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLmJsdXJFdmVudCA9IFwiYmx1clwiO1xuICAgIEVkaXRhYmxlVGV4dEJhc2UuZm9jdXNFdmVudCA9IFwiZm9jdXNcIjtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnRleHRDaGFuZ2VFdmVudCA9IFwidGV4dENoYW5nZVwiO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICB0ZXh0X2Jhc2VfMS5Qc2V1ZG9DbGFzc0hhbmRsZXIoXCJmb2N1c1wiLCBcImJsdXJcIilcbiAgICBdLCBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZSwgXCJfdXBkYXRlVGV4dEJhc2VGb2N1c1N0YXRlSGFuZGxlclwiLCBudWxsKTtcbiAgICByZXR1cm4gRWRpdGFibGVUZXh0QmFzZTtcbn0odGV4dF9iYXNlXzEuVGV4dEJhc2UpKTtcbmV4cG9ydHMuRWRpdGFibGVUZXh0QmFzZSA9IEVkaXRhYmxlVGV4dEJhc2U7XG5leHBvcnRzLnBsYWNlaG9sZGVyQ29sb3JQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwicGxhY2Vob2xkZXJDb2xvclwiLCBjc3NOYW1lOiBcInBsYWNlaG9sZGVyLWNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IHRleHRfYmFzZV8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgdGV4dF9iYXNlXzEuQ29sb3Iodik7IH0gfSk7XG5leHBvcnRzLnBsYWNlaG9sZGVyQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcih0ZXh0X2Jhc2VfMS5TdHlsZSk7XG52YXIga2V5Ym9hcmRUeXBlQ29udmVydGVyID0gdGV4dF9iYXNlXzEubWFrZVBhcnNlcih0ZXh0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwiZGF0ZXRpbWVcIiwgXCJwaG9uZVwiLCBcIm51bWJlclwiLCBcInVybFwiLCBcImVtYWlsXCIpKTtcbmV4cG9ydHMua2V5Ym9hcmRUeXBlUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImtleWJvYXJkVHlwZVwiLCB2YWx1ZUNvbnZlcnRlcjoga2V5Ym9hcmRUeXBlQ29udmVydGVyIH0pO1xuZXhwb3J0cy5rZXlib2FyZFR5cGVQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbnZhciByZXR1cm5LZXlUeXBlQ29udmVydGVyID0gdGV4dF9iYXNlXzEubWFrZVBhcnNlcih0ZXh0X2Jhc2VfMS5tYWtlVmFsaWRhdG9yKFwiZG9uZVwiLCBcIm5leHRcIiwgXCJnb1wiLCBcInNlYXJjaFwiLCBcInNlbmRcIikpO1xuZXhwb3J0cy5yZXR1cm5LZXlUeXBlUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcInJldHVybktleVR5cGVcIiwgdmFsdWVDb252ZXJ0ZXI6IHJldHVybktleVR5cGVDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLnJldHVybktleVR5cGVQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMuZWRpdGFibGVQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiZWRpdGFibGVcIiwgZGVmYXVsdFZhbHVlOiB0cnVlLCB2YWx1ZUNvbnZlcnRlcjogdGV4dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuZWRpdGFibGVQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMudXBkYXRlVGV4dFRyaWdnZXJQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidXBkYXRlVGV4dFRyaWdnZXJcIiwgZGVmYXVsdFZhbHVlOiBcInRleHRDaGFuZ2VkXCIgfSk7XG5leHBvcnRzLnVwZGF0ZVRleHRUcmlnZ2VyUHJvcGVydHkucmVnaXN0ZXIoRWRpdGFibGVUZXh0QmFzZSk7XG52YXIgYXV0b2NhcGl0YWxpemF0aW9uVHlwZUNvbnZlcnRlciA9IHRleHRfYmFzZV8xLm1ha2VQYXJzZXIodGV4dF9iYXNlXzEubWFrZVZhbGlkYXRvcihcIm5vbmVcIiwgXCJ3b3Jkc1wiLCBcInNlbnRlbmNlc1wiLCBcImFsbGNoYXJhY3RlcnNcIikpO1xuZXhwb3J0cy5hdXRvY2FwaXRhbGl6YXRpb25UeXBlUHJvcGVydHkgPSBuZXcgdGV4dF9iYXNlXzEuUHJvcGVydHkoeyBuYW1lOiBcImF1dG9jYXBpdGFsaXphdGlvblR5cGVcIiwgZGVmYXVsdFZhbHVlOiBcInNlbnRlbmNlc1wiLCB2YWx1ZUNvbnZlcnRlcjogYXV0b2NhcGl0YWxpemF0aW9uVHlwZUNvbnZlcnRlciB9KTtcbmV4cG9ydHMuYXV0b2NhcGl0YWxpemF0aW9uVHlwZVByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xuZXhwb3J0cy5hdXRvY29ycmVjdFByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJhdXRvY29ycmVjdFwiLCB2YWx1ZUNvbnZlcnRlcjogdGV4dF9iYXNlXzEuYm9vbGVhbkNvbnZlcnRlciB9KTtcbmV4cG9ydHMuYXV0b2NvcnJlY3RQcm9wZXJ0eS5yZWdpc3RlcihFZGl0YWJsZVRleHRCYXNlKTtcbmV4cG9ydHMuaGludFByb3BlcnR5ID0gbmV3IHRleHRfYmFzZV8xLlByb3BlcnR5KHsgbmFtZTogXCJoaW50XCIsIGRlZmF1bHRWYWx1ZTogXCJcIiB9KTtcbmV4cG9ydHMuaGludFByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xuZXhwb3J0cy5tYXhMZW5ndGhQcm9wZXJ0eSA9IG5ldyB0ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwibWF4TGVuZ3RoXCIsIGRlZmF1bHRWYWx1ZTogTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VJbnQgfSk7XG5leHBvcnRzLm1heExlbmd0aFByb3BlcnR5LnJlZ2lzdGVyKEVkaXRhYmxlVGV4dEJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZWRpdGFibGUtdGV4dC1iYXNlLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMSA9IHJlcXVpcmUoXCIuL2VkaXRhYmxlLXRleHQtYmFzZS1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9lZGl0YWJsZS10ZXh0LWJhc2UtY29tbW9uXCIpKTtcbnZhciBFZGl0YWJsZVRleHRCYXNlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoRWRpdGFibGVUZXh0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBFZGl0YWJsZVRleHRCYXNlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlLmRpc21pc3NTb2Z0SW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQucmVzaWduRmlyc3RSZXNwb25kZXIoKTtcbiAgICAgICAgdGhpcy5ub3RpZnkoeyBldmVudE5hbWU6IEVkaXRhYmxlVGV4dEJhc2UuYmx1ckV2ZW50LCBvYmplY3Q6IHRoaXMgfSk7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEua2V5Ym9hcmRUeXBlUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBrZXlib2FyZFR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmtleWJvYXJkVHlwZTtcbiAgICAgICAgc3dpdGNoIChrZXlib2FyZFR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJudW1iZXJcIjtcbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJwaG9uZVwiO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInVybFwiO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIHJldHVybiBcImVtYWlsXCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBrZXlib2FyZFR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmtleWJvYXJkVHlwZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIG5ld0tleWJvYXJkVHlwZTtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImRhdGV0aW1lXCI6XG4gICAgICAgICAgICAgICAgbmV3S2V5Ym9hcmRUeXBlID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJwaG9uZVwiOlxuICAgICAgICAgICAgICAgIG5ld0tleWJvYXJkVHlwZSA9IDU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibnVtYmVyXCI6XG4gICAgICAgICAgICAgICAgbmV3S2V5Ym9hcmRUeXBlID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ1cmxcIjpcbiAgICAgICAgICAgICAgICBuZXdLZXlib2FyZFR5cGUgPSAzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImVtYWlsXCI6XG4gICAgICAgICAgICAgICAgbmV3S2V5Ym9hcmRUeXBlID0gNztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdmFyIGt0ID0gK3ZhbHVlO1xuICAgICAgICAgICAgICAgIGlmICghaXNOYU4oa3QpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0tleWJvYXJkVHlwZSA9IGt0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3S2V5Ym9hcmRUeXBlID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5rZXlib2FyZFR5cGUgPSBuZXdLZXlib2FyZFR5cGU7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEucmV0dXJuS2V5VHlwZVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmV0dXJuS2V5VHlwZSA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQucmV0dXJuS2V5VHlwZTtcbiAgICAgICAgc3dpdGNoIChyZXR1cm5LZXlUeXBlKSB7XG4gICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiZG9uZVwiO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImdvXCI7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibmV4dFwiO1xuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIHJldHVybiBcInNlYXJjaFwiO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIHJldHVybiBcInNlbmRcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJldHVybktleVR5cGUudG9TdHJpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLnJldHVybktleVR5cGVQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXdWYWx1ZTtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImRvbmVcIjpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiZ29cIjpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDE7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibmV4dFwiOlxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gNDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJzZWFyY2hcIjpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDY7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic2VuZFwiOlxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gNztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdmFyIHJrdCA9ICt2YWx1ZTtcbiAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHJrdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBya3Q7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQucmV0dXJuS2V5VHlwZSA9IG5ld1ZhbHVlO1xuICAgIH07XG4gICAgRWRpdGFibGVUZXh0QmFzZS5wcm90b3R5cGVbZWRpdGFibGVfdGV4dF9iYXNlX2NvbW1vbl8xLmF1dG9jYXBpdGFsaXphdGlvblR5cGVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF1dG9jYXBpdGFsaXphdGlvblR5cGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmF1dG9jYXBpdGFsaXphdGlvblR5cGU7XG4gICAgICAgIHN3aXRjaCAoYXV0b2NhcGl0YWxpemF0aW9uVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIm5vbmVcIjtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJ3b3Jkc1wiO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHJldHVybiBcInNlbnRlbmNlc1wiO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFsbGNoYXJhY3RlcnNcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBhdXRvY2FwaXRhbGl6YXRpb25UeXBlIHZhbHVlOlwiICsgYXV0b2NhcGl0YWxpemF0aW9uVHlwZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEVkaXRhYmxlVGV4dEJhc2UucHJvdG90eXBlW2VkaXRhYmxlX3RleHRfYmFzZV9jb21tb25fMS5hdXRvY2FwaXRhbGl6YXRpb25UeXBlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmV3VmFsdWU7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIndvcmRzXCI6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInNlbnRlbmNlc1wiOlxuICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJhbGxjaGFyYWN0ZXJzXCI6XG4gICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAzO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZSA9IDI7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdXRvY2FwaXRhbGl6YXRpb25UeXBlID0gbmV3VmFsdWU7XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuYXV0b2NvcnJlY3RQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGF1dG9jb3JyZWN0aW9uVHlwZSA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuYXV0b2NvcnJlY3Rpb25UeXBlO1xuICAgICAgICBzd2l0Y2ggKGF1dG9jb3JyZWN0aW9uVHlwZSkge1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICByZXR1cm4gYXV0b2NvcnJlY3Rpb25UeXBlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBFZGl0YWJsZVRleHRCYXNlLnByb3RvdHlwZVtlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuYXV0b2NvcnJlY3RQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuZXdWYWx1ZTtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikge1xuICAgICAgICAgICAgbmV3VmFsdWUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IDI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBuZXdWYWx1ZSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdXRvY29ycmVjdGlvblR5cGUgPSBuZXdWYWx1ZTtcbiAgICB9O1xuICAgIHJldHVybiBFZGl0YWJsZVRleHRCYXNlO1xufShlZGl0YWJsZV90ZXh0X2Jhc2VfY29tbW9uXzEuRWRpdGFibGVUZXh0QmFzZSkpO1xuZXhwb3J0cy5FZGl0YWJsZVRleHRCYXNlID0gRWRpdGFibGVUZXh0QmFzZTtcbmZ1bmN0aW9uIF91cGRhdGVDaGFyYWN0ZXJzSW5SYW5nZVJlcGxhY2VtZW50U3RyaW5nKGZvcm1hdHRlZFRleHQsIHJhbmdlTG9jYXRpb24sIHJhbmdlTGVuZ3RoLCByZXBsYWNlbWVudFN0cmluZykge1xuICAgIHZhciBkZWxldGluZ1RleHQgPSAhcmVwbGFjZW1lbnRTdHJpbmc7XG4gICAgdmFyIGN1cnJlbnRMb2NhdGlvbiA9IDA7XG4gICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZm9ybWF0dGVkVGV4dC5zcGFucy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7XG4gICAgICAgIHZhciBzcGFuID0gZm9ybWF0dGVkVGV4dC5zcGFucy5nZXRJdGVtKGkpO1xuICAgICAgICBpZiAoY3VycmVudExvY2F0aW9uIDw9IHJhbmdlTG9jYXRpb24gJiYgcmFuZ2VMb2NhdGlvbiA8IChjdXJyZW50TG9jYXRpb24gKyBzcGFuLnRleHQubGVuZ3RoKSkge1xuICAgICAgICAgICAgdmFyIG5ld1RleHQgPSBzcGxpY2Uoc3Bhbi50ZXh0LCByYW5nZUxvY2F0aW9uIC0gY3VycmVudExvY2F0aW9uLCBkZWxldGluZ1RleHQgPyByYW5nZUxlbmd0aCA6IDAsIHJlcGxhY2VtZW50U3RyaW5nKTtcbiAgICAgICAgICAgIHNwYW4uX3NldFRleHRJbnRlcm5hbChuZXdUZXh0KTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjdXJyZW50TG9jYXRpb24gKz0gc3Bhbi50ZXh0Lmxlbmd0aDtcbiAgICB9XG59XG5leHBvcnRzLl91cGRhdGVDaGFyYWN0ZXJzSW5SYW5nZVJlcGxhY2VtZW50U3RyaW5nID0gX3VwZGF0ZUNoYXJhY3RlcnNJblJhbmdlUmVwbGFjZW1lbnRTdHJpbmc7XG5mdW5jdGlvbiBzcGxpY2UodmFsdWUsIHN0YXJ0LCBkZWxDb3VudCwgbmV3U3ViU3RyKSB7XG4gICAgcmV0dXJuIHZhbHVlLnNsaWNlKDAsIHN0YXJ0KSArIG5ld1N1YlN0ciArIHZhbHVlLnNsaWNlKHN0YXJ0ICsgTWF0aC5hYnMoZGVsQ291bnQpKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWVkaXRhYmxlLXRleHQtYmFzZS5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIEtleWJvYXJkVHlwZTtcbihmdW5jdGlvbiAoS2V5Ym9hcmRUeXBlKSB7XG4gICAgS2V5Ym9hcmRUeXBlLmRhdGV0aW1lID0gXCJkYXRldGltZVwiO1xuICAgIEtleWJvYXJkVHlwZS5waG9uZSA9IFwicGhvbmVcIjtcbiAgICBLZXlib2FyZFR5cGUubnVtYmVyID0gXCJudW1iZXJcIjtcbiAgICBLZXlib2FyZFR5cGUudXJsID0gXCJ1cmxcIjtcbiAgICBLZXlib2FyZFR5cGUuZW1haWwgPSBcImVtYWlsXCI7XG59KShLZXlib2FyZFR5cGUgPSBleHBvcnRzLktleWJvYXJkVHlwZSB8fCAoZXhwb3J0cy5LZXlib2FyZFR5cGUgPSB7fSkpO1xudmFyIFJldHVybktleVR5cGU7XG4oZnVuY3Rpb24gKFJldHVybktleVR5cGUpIHtcbiAgICBSZXR1cm5LZXlUeXBlLmRvbmUgPSBcImRvbmVcIjtcbiAgICBSZXR1cm5LZXlUeXBlLm5leHQgPSBcIm5leHRcIjtcbiAgICBSZXR1cm5LZXlUeXBlLmdvID0gXCJnb1wiO1xuICAgIFJldHVybktleVR5cGUuc2VhcmNoID0gXCJzZWFyY2hcIjtcbiAgICBSZXR1cm5LZXlUeXBlLnNlbmQgPSBcInNlbmRcIjtcbn0pKFJldHVybktleVR5cGUgPSBleHBvcnRzLlJldHVybktleVR5cGUgfHwgKGV4cG9ydHMuUmV0dXJuS2V5VHlwZSA9IHt9KSk7XG52YXIgVGV4dEFsaWdubWVudDtcbihmdW5jdGlvbiAoVGV4dEFsaWdubWVudCkge1xuICAgIFRleHRBbGlnbm1lbnQubGVmdCA9IFwibGVmdFwiO1xuICAgIFRleHRBbGlnbm1lbnQuY2VudGVyID0gXCJjZW50ZXJcIjtcbiAgICBUZXh0QWxpZ25tZW50LnJpZ2h0ID0gXCJyaWdodFwiO1xufSkoVGV4dEFsaWdubWVudCA9IGV4cG9ydHMuVGV4dEFsaWdubWVudCB8fCAoZXhwb3J0cy5UZXh0QWxpZ25tZW50ID0ge30pKTtcbnZhciBUZXh0RGVjb3JhdGlvbjtcbihmdW5jdGlvbiAoVGV4dERlY29yYXRpb24pIHtcbiAgICBUZXh0RGVjb3JhdGlvbi5ub25lID0gXCJub25lXCI7XG4gICAgVGV4dERlY29yYXRpb24udW5kZXJsaW5lID0gXCJ1bmRlcmxpbmVcIjtcbiAgICBUZXh0RGVjb3JhdGlvbi5saW5lVGhyb3VnaCA9IFwibGluZS10aHJvdWdoXCI7XG59KShUZXh0RGVjb3JhdGlvbiA9IGV4cG9ydHMuVGV4dERlY29yYXRpb24gfHwgKGV4cG9ydHMuVGV4dERlY29yYXRpb24gPSB7fSkpO1xudmFyIFRleHRUcmFuc2Zvcm07XG4oZnVuY3Rpb24gKFRleHRUcmFuc2Zvcm0pIHtcbiAgICBUZXh0VHJhbnNmb3JtLm5vbmUgPSBcIm5vbmVcIjtcbiAgICBUZXh0VHJhbnNmb3JtLmNhcGl0YWxpemUgPSBcImNhcGl0YWxpemVcIjtcbiAgICBUZXh0VHJhbnNmb3JtLnVwcGVyY2FzZSA9IFwidXBwZXJjYXNlXCI7XG4gICAgVGV4dFRyYW5zZm9ybS5sb3dlcmNhc2UgPSBcImxvd2VyY2FzZVwiO1xufSkoVGV4dFRyYW5zZm9ybSA9IGV4cG9ydHMuVGV4dFRyYW5zZm9ybSB8fCAoZXhwb3J0cy5UZXh0VHJhbnNmb3JtID0ge30pKTtcbnZhciBXaGl0ZVNwYWNlO1xuKGZ1bmN0aW9uIChXaGl0ZVNwYWNlKSB7XG4gICAgV2hpdGVTcGFjZS5ub3JtYWwgPSBcIm5vcm1hbFwiO1xuICAgIFdoaXRlU3BhY2Uubm93cmFwID0gXCJub3dyYXBcIjtcbn0pKFdoaXRlU3BhY2UgPSBleHBvcnRzLldoaXRlU3BhY2UgfHwgKGV4cG9ydHMuV2hpdGVTcGFjZSA9IHt9KSk7XG52YXIgT3JpZW50YXRpb247XG4oZnVuY3Rpb24gKE9yaWVudGF0aW9uKSB7XG4gICAgT3JpZW50YXRpb24uaG9yaXpvbnRhbCA9IFwiaG9yaXpvbnRhbFwiO1xuICAgIE9yaWVudGF0aW9uLnZlcnRpY2FsID0gXCJ2ZXJ0aWNhbFwiO1xufSkoT3JpZW50YXRpb24gPSBleHBvcnRzLk9yaWVudGF0aW9uIHx8IChleHBvcnRzLk9yaWVudGF0aW9uID0ge30pKTtcbnZhciBEZXZpY2VPcmllbnRhdGlvbjtcbihmdW5jdGlvbiAoRGV2aWNlT3JpZW50YXRpb24pIHtcbiAgICBEZXZpY2VPcmllbnRhdGlvbi5wb3J0cmFpdCA9IFwicG9ydHJhaXRcIjtcbiAgICBEZXZpY2VPcmllbnRhdGlvbi5sYW5kc2NhcGUgPSBcImxhbmRzY2FwZVwiO1xuICAgIERldmljZU9yaWVudGF0aW9uLnVua25vd24gPSBcInVua25vd25cIjtcbn0pKERldmljZU9yaWVudGF0aW9uID0gZXhwb3J0cy5EZXZpY2VPcmllbnRhdGlvbiB8fCAoZXhwb3J0cy5EZXZpY2VPcmllbnRhdGlvbiA9IHt9KSk7XG52YXIgSG9yaXpvbnRhbEFsaWdubWVudDtcbihmdW5jdGlvbiAoSG9yaXpvbnRhbEFsaWdubWVudCkge1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQubGVmdCA9IFwibGVmdFwiO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQuY2VudGVyID0gXCJjZW50ZXJcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LnJpZ2h0ID0gXCJyaWdodFwiO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQuc3RyZXRjaCA9IFwic3RyZXRjaFwiO1xufSkoSG9yaXpvbnRhbEFsaWdubWVudCA9IGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCB8fCAoZXhwb3J0cy5Ib3Jpem9udGFsQWxpZ25tZW50ID0ge30pKTtcbnZhciBWZXJ0aWNhbEFsaWdubWVudDtcbihmdW5jdGlvbiAoVmVydGljYWxBbGlnbm1lbnQpIHtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC50b3AgPSBcInRvcFwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50Lm1pZGRsZSA9IFwibWlkZGxlXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuYm90dG9tID0gXCJib3R0b21cIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5zdHJldGNoID0gXCJzdHJldGNoXCI7XG59KShWZXJ0aWNhbEFsaWdubWVudCA9IGV4cG9ydHMuVmVydGljYWxBbGlnbm1lbnQgfHwgKGV4cG9ydHMuVmVydGljYWxBbGlnbm1lbnQgPSB7fSkpO1xudmFyIFN0cmV0Y2g7XG4oZnVuY3Rpb24gKFN0cmV0Y2gpIHtcbiAgICBTdHJldGNoLm5vbmUgPSBcIm5vbmVcIjtcbiAgICBTdHJldGNoLmFzcGVjdEZpbGwgPSBcImFzcGVjdEZpbGxcIjtcbiAgICBTdHJldGNoLmFzcGVjdEZpdCA9IFwiYXNwZWN0Rml0XCI7XG4gICAgU3RyZXRjaC5maWxsID0gXCJmaWxsXCI7XG59KShTdHJldGNoID0gZXhwb3J0cy5TdHJldGNoIHx8IChleHBvcnRzLlN0cmV0Y2ggPSB7fSkpO1xudmFyIFZpc2liaWxpdHk7XG4oZnVuY3Rpb24gKFZpc2liaWxpdHkpIHtcbiAgICBWaXNpYmlsaXR5LnZpc2libGUgPSBcInZpc2libGVcIjtcbiAgICBWaXNpYmlsaXR5LmNvbGxhcHNlID0gXCJjb2xsYXBzZVwiO1xuICAgIFZpc2liaWxpdHkuY29sbGFwc2VkID0gXCJjb2xsYXBzZWRcIjtcbn0pKFZpc2liaWxpdHkgPSBleHBvcnRzLlZpc2liaWxpdHkgfHwgKGV4cG9ydHMuVmlzaWJpbGl0eSA9IHt9KSk7XG52YXIgRm9udEF0dHJpYnV0ZXM7XG4oZnVuY3Rpb24gKEZvbnRBdHRyaWJ1dGVzKSB7XG4gICAgRm9udEF0dHJpYnV0ZXMuTm9ybWFsID0gMDtcbiAgICBGb250QXR0cmlidXRlcy5Cb2xkID0gMTtcbiAgICBGb250QXR0cmlidXRlcy5JdGFsaWMgPSAxIDw8IDE7XG59KShGb250QXR0cmlidXRlcyA9IGV4cG9ydHMuRm9udEF0dHJpYnV0ZXMgfHwgKGV4cG9ydHMuRm9udEF0dHJpYnV0ZXMgPSB7fSkpO1xudmFyIERldmljZVR5cGU7XG4oZnVuY3Rpb24gKERldmljZVR5cGUpIHtcbiAgICBEZXZpY2VUeXBlLlBob25lID0gXCJQaG9uZVwiO1xuICAgIERldmljZVR5cGUuVGFibGV0ID0gXCJUYWJsZXRcIjtcbn0pKERldmljZVR5cGUgPSBleHBvcnRzLkRldmljZVR5cGUgfHwgKGV4cG9ydHMuRGV2aWNlVHlwZSA9IHt9KSk7XG52YXIgVXBkYXRlVGV4dFRyaWdnZXI7XG4oZnVuY3Rpb24gKFVwZGF0ZVRleHRUcmlnZ2VyKSB7XG4gICAgVXBkYXRlVGV4dFRyaWdnZXIuZm9jdXNMb3N0ID0gXCJmb2N1c0xvc3RcIjtcbiAgICBVcGRhdGVUZXh0VHJpZ2dlci50ZXh0Q2hhbmdlZCA9IFwidGV4dENoYW5nZWRcIjtcbn0pKFVwZGF0ZVRleHRUcmlnZ2VyID0gZXhwb3J0cy5VcGRhdGVUZXh0VHJpZ2dlciB8fCAoZXhwb3J0cy5VcGRhdGVUZXh0VHJpZ2dlciA9IHt9KSk7XG52YXIgQWNjdXJhY3k7XG4oZnVuY3Rpb24gKEFjY3VyYWN5KSB7XG4gICAgQWNjdXJhY3kuYW55ID0gMzAwO1xuICAgIEFjY3VyYWN5LmhpZ2ggPSAzO1xufSkoQWNjdXJhY3kgPSBleHBvcnRzLkFjY3VyYWN5IHx8IChleHBvcnRzLkFjY3VyYWN5ID0ge30pKTtcbnZhciBEb2NrO1xuKGZ1bmN0aW9uIChEb2NrKSB7XG4gICAgRG9jay5sZWZ0ID0gXCJsZWZ0XCI7XG4gICAgRG9jay50b3AgPSBcInRvcFwiO1xuICAgIERvY2sucmlnaHQgPSBcInJpZ2h0XCI7XG4gICAgRG9jay5ib3R0b20gPSBcImJvdHRvbVwiO1xufSkoRG9jayA9IGV4cG9ydHMuRG9jayB8fCAoZXhwb3J0cy5Eb2NrID0ge30pKTtcbnZhciBBdXRvY2FwaXRhbGl6YXRpb25UeXBlO1xuKGZ1bmN0aW9uIChBdXRvY2FwaXRhbGl6YXRpb25UeXBlKSB7XG4gICAgQXV0b2NhcGl0YWxpemF0aW9uVHlwZS5ub25lID0gXCJub25lXCI7XG4gICAgQXV0b2NhcGl0YWxpemF0aW9uVHlwZS53b3JkcyA9IFwid29yZHNcIjtcbiAgICBBdXRvY2FwaXRhbGl6YXRpb25UeXBlLnNlbnRlbmNlcyA9IFwic2VudGVuY2VzXCI7XG4gICAgQXV0b2NhcGl0YWxpemF0aW9uVHlwZS5hbGxDaGFyYWN0ZXJzID0gXCJhbGxjaGFyYWN0ZXJzXCI7XG59KShBdXRvY2FwaXRhbGl6YXRpb25UeXBlID0gZXhwb3J0cy5BdXRvY2FwaXRhbGl6YXRpb25UeXBlIHx8IChleHBvcnRzLkF1dG9jYXBpdGFsaXphdGlvblR5cGUgPSB7fSkpO1xudmFyIE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eSkge1xuICAgIE5hdmlnYXRpb25CYXJWaXNpYmlsaXR5LmF1dG8gPSBcImF1dG9cIjtcbiAgICBOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eS5uZXZlciA9IFwibmV2ZXJcIjtcbiAgICBOYXZpZ2F0aW9uQmFyVmlzaWJpbGl0eS5hbHdheXMgPSBcImFsd2F5c1wiO1xufSkoTmF2aWdhdGlvbkJhclZpc2liaWxpdHkgPSBleHBvcnRzLk5hdmlnYXRpb25CYXJWaXNpYmlsaXR5IHx8IChleHBvcnRzLk5hdmlnYXRpb25CYXJWaXNpYmlsaXR5ID0ge30pKTtcbnZhciBBbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHk7XG4oZnVuY3Rpb24gKEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eSkge1xuICAgIEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eS5hdXRvID0gXCJhdXRvXCI7XG4gICAgQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5Lm5ldmVyID0gXCJuZXZlclwiO1xuICAgIEFuZHJvaWRBY3Rpb25CYXJJY29uVmlzaWJpbGl0eS5hbHdheXMgPSBcImFsd2F5c1wiO1xufSkoQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5ID0gZXhwb3J0cy5BbmRyb2lkQWN0aW9uQmFySWNvblZpc2liaWxpdHkgfHwgKGV4cG9ydHMuQW5kcm9pZEFjdGlvbkJhckljb25WaXNpYmlsaXR5ID0ge30pKTtcbnZhciBBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uO1xuKGZ1bmN0aW9uIChBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uKSB7XG4gICAgQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbi5hY3Rpb25CYXIgPSBcImFjdGlvbkJhclwiO1xuICAgIEFuZHJvaWRBY3Rpb25JdGVtUG9zaXRpb24uYWN0aW9uQmFySWZSb29tID0gXCJhY3Rpb25CYXJJZlJvb21cIjtcbiAgICBBbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uLnBvcHVwID0gXCJwb3B1cFwiO1xufSkoQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbiA9IGV4cG9ydHMuQW5kcm9pZEFjdGlvbkl0ZW1Qb3NpdGlvbiB8fCAoZXhwb3J0cy5BbmRyb2lkQWN0aW9uSXRlbVBvc2l0aW9uID0ge30pKTtcbnZhciBJT1NBY3Rpb25JdGVtUG9zaXRpb247XG4oZnVuY3Rpb24gKElPU0FjdGlvbkl0ZW1Qb3NpdGlvbikge1xuICAgIElPU0FjdGlvbkl0ZW1Qb3NpdGlvbi5sZWZ0ID0gXCJsZWZ0XCI7XG4gICAgSU9TQWN0aW9uSXRlbVBvc2l0aW9uLnJpZ2h0ID0gXCJyaWdodFwiO1xufSkoSU9TQWN0aW9uSXRlbVBvc2l0aW9uID0gZXhwb3J0cy5JT1NBY3Rpb25JdGVtUG9zaXRpb24gfHwgKGV4cG9ydHMuSU9TQWN0aW9uSXRlbVBvc2l0aW9uID0ge30pKTtcbnZhciBJbWFnZUZvcm1hdDtcbihmdW5jdGlvbiAoSW1hZ2VGb3JtYXQpIHtcbiAgICBJbWFnZUZvcm1hdC5wbmcgPSBcInBuZ1wiO1xuICAgIEltYWdlRm9ybWF0LmpwZWcgPSBcImpwZWdcIjtcbiAgICBJbWFnZUZvcm1hdC5qcGcgPSBcImpwZ1wiO1xufSkoSW1hZ2VGb3JtYXQgPSBleHBvcnRzLkltYWdlRm9ybWF0IHx8IChleHBvcnRzLkltYWdlRm9ybWF0ID0ge30pKTtcbnZhciBGb250U3R5bGU7XG4oZnVuY3Rpb24gKEZvbnRTdHlsZSkge1xuICAgIEZvbnRTdHlsZS5ub3JtYWwgPSBcIm5vcm1hbFwiO1xuICAgIEZvbnRTdHlsZS5pdGFsaWMgPSBcIml0YWxpY1wiO1xufSkoRm9udFN0eWxlID0gZXhwb3J0cy5Gb250U3R5bGUgfHwgKGV4cG9ydHMuRm9udFN0eWxlID0ge30pKTtcbnZhciBGb250V2VpZ2h0O1xuKGZ1bmN0aW9uIChGb250V2VpZ2h0KSB7XG4gICAgRm9udFdlaWdodC50aGluID0gXCIxMDBcIjtcbiAgICBGb250V2VpZ2h0LmV4dHJhTGlnaHQgPSBcIjIwMFwiO1xuICAgIEZvbnRXZWlnaHQubGlnaHQgPSBcIjMwMFwiO1xuICAgIEZvbnRXZWlnaHQubm9ybWFsID0gXCJub3JtYWxcIjtcbiAgICBGb250V2VpZ2h0Lm1lZGl1bSA9IFwiNTAwXCI7XG4gICAgRm9udFdlaWdodC5zZW1pQm9sZCA9IFwiNjAwXCI7XG4gICAgRm9udFdlaWdodC5ib2xkID0gXCJib2xkXCI7XG4gICAgRm9udFdlaWdodC5leHRyYUJvbGQgPSBcIjgwMFwiO1xuICAgIEZvbnRXZWlnaHQuYmxhY2sgPSBcIjkwMFwiO1xufSkoRm9udFdlaWdodCA9IGV4cG9ydHMuRm9udFdlaWdodCB8fCAoZXhwb3J0cy5Gb250V2VpZ2h0ID0ge30pKTtcbnZhciBCYWNrZ3JvdW5kUmVwZWF0O1xuKGZ1bmN0aW9uIChCYWNrZ3JvdW5kUmVwZWF0KSB7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5yZXBlYXQgPSBcInJlcGVhdFwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQucmVwZWF0WCA9IFwicmVwZWF0LXhcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LnJlcGVhdFkgPSBcInJlcGVhdC15XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5ub1JlcGVhdCA9IFwibm8tcmVwZWF0XCI7XG59KShCYWNrZ3JvdW5kUmVwZWF0ID0gZXhwb3J0cy5CYWNrZ3JvdW5kUmVwZWF0IHx8IChleHBvcnRzLkJhY2tncm91bmRSZXBlYXQgPSB7fSkpO1xudmFyIGFuaW1hdGlvbjtcbnZhciBBbmltYXRpb25DdXJ2ZTtcbihmdW5jdGlvbiAoQW5pbWF0aW9uQ3VydmUpIHtcbiAgICBBbmltYXRpb25DdXJ2ZS5lYXNlID0gXCJlYXNlXCI7XG4gICAgQW5pbWF0aW9uQ3VydmUuZWFzZUluID0gXCJlYXNlSW5cIjtcbiAgICBBbmltYXRpb25DdXJ2ZS5lYXNlT3V0ID0gXCJlYXNlT3V0XCI7XG4gICAgQW5pbWF0aW9uQ3VydmUuZWFzZUluT3V0ID0gXCJlYXNlSW5PdXRcIjtcbiAgICBBbmltYXRpb25DdXJ2ZS5saW5lYXIgPSBcImxpbmVhclwiO1xuICAgIEFuaW1hdGlvbkN1cnZlLnNwcmluZyA9IFwic3ByaW5nXCI7XG4gICAgZnVuY3Rpb24gY3ViaWNCZXppZXIoeDEsIHkxLCB4MiwgeTIpIHtcbiAgICAgICAgYW5pbWF0aW9uID0gYW5pbWF0aW9uIHx8IHJlcXVpcmUoXCJ1aS9hbmltYXRpb25cIik7XG4gICAgICAgIHJldHVybiBuZXcgYW5pbWF0aW9uLkN1YmljQmV6aWVyQW5pbWF0aW9uQ3VydmUoeDEsIHkxLCB4MiwgeTIpO1xuICAgIH1cbiAgICBBbmltYXRpb25DdXJ2ZS5jdWJpY0JlemllciA9IGN1YmljQmV6aWVyO1xufSkoQW5pbWF0aW9uQ3VydmUgPSBleHBvcnRzLkFuaW1hdGlvbkN1cnZlIHx8IChleHBvcnRzLkFuaW1hdGlvbkN1cnZlID0ge30pKTtcbnZhciBTdGF0dXNCYXJTdHlsZTtcbihmdW5jdGlvbiAoU3RhdHVzQmFyU3R5bGUpIHtcbiAgICBTdGF0dXNCYXJTdHlsZS5saWdodCA9IFwibGlnaHRcIjtcbiAgICBTdGF0dXNCYXJTdHlsZS5kYXJrID0gXCJkYXJrXCI7XG59KShTdGF0dXNCYXJTdHlsZSA9IGV4cG9ydHMuU3RhdHVzQmFyU3R5bGUgfHwgKGV4cG9ydHMuU3RhdHVzQmFyU3R5bGUgPSB7fSkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZW51bXMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHNsaWRlX3RyYW5zaXRpb25fMSA9IHJlcXVpcmUoXCIuLi90cmFuc2l0aW9uL3NsaWRlLXRyYW5zaXRpb25cIik7XG52YXIgZmFkZV90cmFuc2l0aW9uXzEgPSByZXF1aXJlKFwiLi4vdHJhbnNpdGlvbi9mYWRlLXRyYW5zaXRpb25cIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi90cmFjZVwiKTtcbnZhciBVSVZpZXdDb250cm9sbGVyQW5pbWF0ZWRUcmFuc2l0aW9uaW5nTWV0aG9kcztcbihmdW5jdGlvbiAoVUlWaWV3Q29udHJvbGxlckFuaW1hdGVkVHJhbnNpdGlvbmluZ01ldGhvZHMpIHtcbiAgICB2YXIgbWV0aG9kU2lnbmF0dXJlID0gTlNNZXRob2RTaWduYXR1cmUuc2lnbmF0dXJlV2l0aE9iakNUeXBlcyhcInZAOmNcIik7XG4gICAgdmFyIGludm9jYXRpb24gPSBOU0ludm9jYXRpb24uaW52b2NhdGlvbldpdGhNZXRob2RTaWduYXR1cmUobWV0aG9kU2lnbmF0dXJlKTtcbiAgICBpbnZvY2F0aW9uLnNlbGVjdG9yID0gXCJjb21wbGV0ZVRyYW5zaXRpb246XCI7XG4gICAgZnVuY3Rpb24gY29tcGxldGVUcmFuc2l0aW9uKGRpZENvbXBsZXRlKSB7XG4gICAgICAgIHZhciBkaWRDb21wbGV0ZVJlZmVyZW5jZSA9IG5ldyBpbnRlcm9wLlJlZmVyZW5jZShpbnRlcm9wLnR5cGVzLmJvb2wsIGRpZENvbXBsZXRlKTtcbiAgICAgICAgaW52b2NhdGlvbi5zZXRBcmd1bWVudEF0SW5kZXgoZGlkQ29tcGxldGVSZWZlcmVuY2UsIDIpO1xuICAgICAgICBpbnZvY2F0aW9uLmludm9rZVdpdGhUYXJnZXQodGhpcyk7XG4gICAgfVxuICAgIFVJVmlld0NvbnRyb2xsZXJBbmltYXRlZFRyYW5zaXRpb25pbmdNZXRob2RzLmNvbXBsZXRlVHJhbnNpdGlvbiA9IGNvbXBsZXRlVHJhbnNpdGlvbjtcbn0pKFVJVmlld0NvbnRyb2xsZXJBbmltYXRlZFRyYW5zaXRpb25pbmdNZXRob2RzIHx8IChVSVZpZXdDb250cm9sbGVyQW5pbWF0ZWRUcmFuc2l0aW9uaW5nTWV0aG9kcyA9IHt9KSk7XG52YXIgQW5pbWF0ZWRUcmFuc2l0aW9uaW5nID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoQW5pbWF0ZWRUcmFuc2l0aW9uaW5nLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEFuaW1hdGVkVHJhbnNpdGlvbmluZygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBBbmltYXRlZFRyYW5zaXRpb25pbmcuaW5pdCA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uLCBvcGVyYXRpb24sIGZyb21WQywgdG9WQykge1xuICAgICAgICB2YXIgaW1wbCA9IEFuaW1hdGVkVHJhbnNpdGlvbmluZy5uZXcoKTtcbiAgICAgICAgaW1wbC5fdHJhbnNpdGlvbiA9IHRyYW5zaXRpb247XG4gICAgICAgIGltcGwuX29wZXJhdGlvbiA9IG9wZXJhdGlvbjtcbiAgICAgICAgaW1wbC5fZnJvbVZDID0gZnJvbVZDO1xuICAgICAgICBpbXBsLl90b1ZDID0gdG9WQztcbiAgICAgICAgcmV0dXJuIGltcGw7XG4gICAgfTtcbiAgICBBbmltYXRlZFRyYW5zaXRpb25pbmcucHJvdG90eXBlLmFuaW1hdGVUcmFuc2l0aW9uID0gZnVuY3Rpb24gKHRyYW5zaXRpb25Db250ZXh0KSB7XG4gICAgICAgIHZhciBjb250YWluZXJWaWV3ID0gdHJhbnNpdGlvbkNvbnRleHQudmFsdWVGb3JLZXkoXCJjb250YWluZXJWaWV3XCIpO1xuICAgICAgICB2YXIgY29tcGxldGlvbiA9IFVJVmlld0NvbnRyb2xsZXJBbmltYXRlZFRyYW5zaXRpb25pbmdNZXRob2RzLmNvbXBsZXRlVHJhbnNpdGlvbi5iaW5kKHRyYW5zaXRpb25Db250ZXh0KTtcbiAgICAgICAgc3dpdGNoICh0aGlzLl9vcGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uVHlwZSA9IFwicHVzaFwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb25UeXBlID0gXCJwb3BcIjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc2l0aW9uVHlwZSA9IFwibm9uZVwiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiU1RBUlQgXCIgKyB0aGlzLl90cmFuc2l0aW9uICsgXCIgXCIgKyB0aGlzLl90cmFuc2l0aW9uVHlwZSwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3RyYW5zaXRpb24uYW5pbWF0ZUlPU1RyYW5zaXRpb24oY29udGFpbmVyVmlldywgdGhpcy5fZnJvbVZDLnZpZXcsIHRoaXMuX3RvVkMudmlldywgdGhpcy5fb3BlcmF0aW9uLCBjb21wbGV0aW9uKTtcbiAgICB9O1xuICAgIEFuaW1hdGVkVHJhbnNpdGlvbmluZy5wcm90b3R5cGUudHJhbnNpdGlvbkR1cmF0aW9uID0gZnVuY3Rpb24gKHRyYW5zaXRpb25Db250ZXh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2l0aW9uLmdldER1cmF0aW9uKCk7XG4gICAgfTtcbiAgICBBbmltYXRlZFRyYW5zaXRpb25pbmcucHJvdG90eXBlLmFuaW1hdGlvbkVuZGVkID0gZnVuY3Rpb24gKHRyYW5zaXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgaWYgKHRyYW5zaXRpb25Db21wbGV0ZWQpIHtcbiAgICAgICAgICAgIGlmICh0cmFjZV8xLmlzRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgdHJhY2VfMS53cml0ZShcIkVORCBcIiArIHRoaXMuX3RyYW5zaXRpb24gKyBcIiBcIiArIHRoaXMuX3RyYW5zaXRpb25UeXBlLCB0cmFjZV8xLmNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAodHJhY2VfMS5pc0VuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDQU5DRUwgXCIgKyB0aGlzLl90cmFuc2l0aW9uICsgXCIgXCIgKyB0aGlzLl90cmFuc2l0aW9uVHlwZSwgdHJhY2VfMS5jYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBBbmltYXRlZFRyYW5zaXRpb25pbmcuT2JqQ1Byb3RvY29scyA9IFtVSVZpZXdDb250cm9sbGVyQW5pbWF0ZWRUcmFuc2l0aW9uaW5nXTtcbiAgICByZXR1cm4gQW5pbWF0ZWRUcmFuc2l0aW9uaW5nO1xufShOU09iamVjdCkpO1xuZnVuY3Rpb24gX2NyZWF0ZUlPU0FuaW1hdGVkVHJhbnNpdGlvbmluZyhuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmF0aXZlQ3VydmUsIG9wZXJhdGlvbiwgZnJvbVZDLCB0b1ZDKSB7XG4gICAgdmFyIGluc3RhbmNlID0gbmF2aWdhdGlvblRyYW5zaXRpb24uaW5zdGFuY2U7XG4gICAgdmFyIHRyYW5zaXRpb247XG4gICAgaWYgKGluc3RhbmNlKSB7XG4gICAgICAgIHRyYW5zaXRpb24gPSBpbnN0YW5jZTtcbiAgICB9XG4gICAgZWxzZSBpZiAobmF2aWdhdGlvblRyYW5zaXRpb24ubmFtZSkge1xuICAgICAgICB2YXIgbmFtZV8xID0gbmF2aWdhdGlvblRyYW5zaXRpb24ubmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAobmFtZV8xLmluZGV4T2YoXCJzbGlkZVwiKSA9PT0gMCkge1xuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbiA9IG5hbWVfMS5zdWJzdHIoXCJzbGlkZVwiLmxlbmd0aCkgfHwgXCJsZWZ0XCI7XG4gICAgICAgICAgICB0cmFuc2l0aW9uID0gbmV3IHNsaWRlX3RyYW5zaXRpb25fMS5TbGlkZVRyYW5zaXRpb24oZGlyZWN0aW9uLCBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbiwgbmF0aXZlQ3VydmUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG5hbWVfMSA9PT0gXCJmYWRlXCIpIHtcbiAgICAgICAgICAgIHRyYW5zaXRpb24gPSBuZXcgZmFkZV90cmFuc2l0aW9uXzEuRmFkZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24uZHVyYXRpb24sIG5hdGl2ZUN1cnZlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJhbnNpdGlvbiA/IEFuaW1hdGVkVHJhbnNpdGlvbmluZy5pbml0KHRyYW5zaXRpb24sIG9wZXJhdGlvbiwgZnJvbVZDLCB0b1ZDKSA6IHVuZGVmaW5lZDtcbn1cbmV4cG9ydHMuX2NyZWF0ZUlPU0FuaW1hdGVkVHJhbnNpdGlvbmluZyA9IF9jcmVhdGVJT1NBbmltYXRlZFRyYW5zaXRpb25pbmc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1mcmFnbWVudC50cmFuc2l0aW9ucy5pb3MuanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB2aWV3X2NvbW1vbl8xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlldy92aWV3LWNvbW1vblwiKTtcbnZhciB2aWV3XzEgPSByZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpO1xudmFyIGJ1aWxkZXJfMSA9IHJlcXVpcmUoXCIuLi9idWlsZGVyXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBmcmFtZV9zdGFja18xID0gcmVxdWlyZShcIi4vZnJhbWUtc3RhY2tcIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBOYXZpZ2F0aW9uVHlwZTtcbihmdW5jdGlvbiAoTmF2aWdhdGlvblR5cGUpIHtcbiAgICBOYXZpZ2F0aW9uVHlwZVtOYXZpZ2F0aW9uVHlwZVtcImJhY2tcIl0gPSAwXSA9IFwiYmFja1wiO1xuICAgIE5hdmlnYXRpb25UeXBlW05hdmlnYXRpb25UeXBlW1wiZm9yd2FyZFwiXSA9IDFdID0gXCJmb3J3YXJkXCI7XG4gICAgTmF2aWdhdGlvblR5cGVbTmF2aWdhdGlvblR5cGVbXCJyZXBsYWNlXCJdID0gMl0gPSBcInJlcGxhY2VcIjtcbn0pKE5hdmlnYXRpb25UeXBlID0gZXhwb3J0cy5OYXZpZ2F0aW9uVHlwZSB8fCAoZXhwb3J0cy5OYXZpZ2F0aW9uVHlwZSA9IHt9KSk7XG5mdW5jdGlvbiBidWlsZEVudHJ5RnJvbUFyZ3MoYXJnKSB7XG4gICAgdmFyIGVudHJ5O1xuICAgIGlmICh0eXBlb2YgYXJnID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgIGVudHJ5ID0ge1xuICAgICAgICAgICAgbW9kdWxlTmFtZTogYXJnXG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICBlbnRyeSA9IHtcbiAgICAgICAgICAgIGNyZWF0ZTogYXJnXG4gICAgICAgIH07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBlbnRyeSA9IGFyZztcbiAgICB9XG4gICAgcmV0dXJuIGVudHJ5O1xufVxudmFyIEZyYW1lQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZyYW1lQmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGcmFtZUJhc2UoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fYmFja1N0YWNrID0gbmV3IEFycmF5KCk7XG4gICAgICAgIF90aGlzLl9uYXZpZ2F0aW9uUXVldWUgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgX3RoaXMuX2lzSW5GcmFtZVN0YWNrID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgRnJhbWVCYXNlXzEgPSBGcmFtZUJhc2U7XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fYWRkQ2hpbGRGcm9tQnVpbGRlciA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGcmFtZSBzaG91bGQgbm90IGhhdmUgYSB2aWV3LiBVc2UgJ2RlZmF1bHRQYWdlJyBwcm9wZXJ0eSBpbnN0ZWFkLlwiKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25Mb2FkZWQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuY2FuR29CYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgYmFja3N0YWNrID0gdGhpcy5fYmFja1N0YWNrLmxlbmd0aDtcbiAgICAgICAgdmFyIHByZXZpb3VzRm9yd2FyZE5vdEluQmFja3N0YWNrID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX25hdmlnYXRpb25RdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICB2YXIgZW50cnkgPSBpdGVtLmVudHJ5O1xuICAgICAgICAgICAgdmFyIGlzQmFja05hdmlnYXRpb24gPSBpdGVtLm5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5iYWNrO1xuICAgICAgICAgICAgaWYgKGlzQmFja05hdmlnYXRpb24pIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICghZW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgYmFja3N0YWNrLS07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYmFja3N0YWNrSW5kZXggPSBfdGhpcy5fYmFja1N0YWNrLmluZGV4T2YoZW50cnkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYmFja3N0YWNrSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrc3RhY2sgPSBiYWNrc3RhY2tJbmRleDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tzdGFjay0tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoZW50cnkuZW50cnkuY2xlYXJIaXN0b3J5KSB7XG4gICAgICAgICAgICAgICAgcHJldmlvdXNGb3J3YXJkTm90SW5CYWNrc3RhY2sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBiYWNrc3RhY2sgPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYmFja3N0YWNrKys7XG4gICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzRm9yd2FyZE5vdEluQmFja3N0YWNrKSB7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tzdGFjay0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmV2aW91c0ZvcndhcmROb3RJbkJhY2tzdGFjayA9IGVudHJ5LmVudHJ5LmJhY2tzdGFja1Zpc2libGUgPT09IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25RdWV1ZS5sZW5ndGggPiAwICYmICF0aGlzLl9jdXJyZW50RW50cnkpIHtcbiAgICAgICAgICAgIGJhY2tzdGFjay0tO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiYWNrc3RhY2sgPiAwO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5nb0JhY2sgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoXCJHTyBCQUNLXCIsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLmNhbkdvQmFjaygpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJhY2tzdGFja0VudHJ5KSB7XG4gICAgICAgICAgICB2YXIgaW5kZXhfMSA9IHRoaXMuX2JhY2tTdGFjay5pbmRleE9mKGJhY2tzdGFja0VudHJ5KTtcbiAgICAgICAgICAgIGlmIChpbmRleF8xIDwgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF2aWdhdGlvbkNvbnRleHQgPSB7XG4gICAgICAgICAgICBlbnRyeTogYmFja3N0YWNrRW50cnksXG4gICAgICAgICAgICBpc0JhY2tOYXZpZ2F0aW9uOiB0cnVlLFxuICAgICAgICAgICAgbmF2aWdhdGlvblR5cGU6IE5hdmlnYXRpb25UeXBlLmJhY2tcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvblF1ZXVlLnB1c2gobmF2aWdhdGlvbkNvbnRleHQpO1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcmVtb3ZlRW50cnkgPSBmdW5jdGlvbiAocmVtb3ZlZCkge1xuICAgICAgICB2YXIgcGFnZSA9IHJlbW92ZWQucmVzb2x2ZWRQYWdlO1xuICAgICAgICB2YXIgZnJhbWUgPSBwYWdlLmZyYW1lO1xuICAgICAgICBwYWdlLl9mcmFtZSA9IG51bGw7XG4gICAgICAgIGlmIChmcmFtZSkge1xuICAgICAgICAgICAgZnJhbWUuX3JlbW92ZVZpZXcocGFnZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwYWdlLl90ZWFyRG93blVJKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIHJlbW92ZWQucmVzb2x2ZWRQYWdlID0gbnVsbDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUubmF2aWdhdGUgPSBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoXCJOQVZJR0FURVwiLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbnRyeSA9IGJ1aWxkRW50cnlGcm9tQXJncyhwYXJhbSk7XG4gICAgICAgIHZhciBwYWdlID0gYnVpbGRlcl8xLmNyZWF0ZVZpZXdGcm9tRW50cnkoZW50cnkpO1xuICAgICAgICB0aGlzLl9wdXNoSW5GcmFtZVN0YWNrKCk7XG4gICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeSA9IHtcbiAgICAgICAgICAgIGVudHJ5OiBlbnRyeSxcbiAgICAgICAgICAgIHJlc29sdmVkUGFnZTogcGFnZSxcbiAgICAgICAgICAgIG5hdkRlcHRoOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBmcmFnbWVudFRhZzogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQ29udGV4dCA9IHtcbiAgICAgICAgICAgIGVudHJ5OiBiYWNrc3RhY2tFbnRyeSxcbiAgICAgICAgICAgIGlzQmFja05hdmlnYXRpb246IGZhbHNlLFxuICAgICAgICAgICAgbmF2aWdhdGlvblR5cGU6IE5hdmlnYXRpb25UeXBlLmZvcndhcmRcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvblF1ZXVlLnB1c2gobmF2aWdhdGlvbkNvbnRleHQpO1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5pc0N1cnJlbnQgPSBmdW5jdGlvbiAoZW50cnkpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRFbnRyeSA9PT0gZW50cnk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLnNldEN1cnJlbnQgPSBmdW5jdGlvbiAoZW50cnksIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBuZXdQYWdlID0gZW50cnkucmVzb2x2ZWRQYWdlO1xuICAgICAgICBpZiAoIW5ld1BhZ2UuZnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2FkZFZpZXcobmV3UGFnZSk7XG4gICAgICAgICAgICBuZXdQYWdlLl9mcmFtZSA9IHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fY3VycmVudEVudHJ5ID0gZW50cnk7XG4gICAgICAgIHZhciBpc0JhY2sgPSBuYXZpZ2F0aW9uVHlwZSA9PT0gTmF2aWdhdGlvblR5cGUuYmFjaztcbiAgICAgICAgaWYgKGlzQmFjaykge1xuICAgICAgICAgICAgdGhpcy5fcHVzaEluRnJhbWVTdGFjaygpO1xuICAgICAgICB9XG4gICAgICAgIG5ld1BhZ2Uub25OYXZpZ2F0ZWRUbyhpc0JhY2spO1xuICAgICAgICB0aGlzLl9leGVjdXRpbmdDb250ZXh0ID0gbnVsbDtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3VwZGF0ZUJhY2tzdGFjayA9IGZ1bmN0aW9uIChlbnRyeSwgbmF2aWdhdGlvblR5cGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGlzQmFjayA9IG5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5iYWNrO1xuICAgICAgICB2YXIgaXNSZXBsYWNlID0gbmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLnJlcGxhY2U7XG4gICAgICAgIHRoaXMucmFpc2VDdXJyZW50UGFnZU5hdmlnYXRlZEV2ZW50cyhpc0JhY2spO1xuICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuX2N1cnJlbnRFbnRyeTtcbiAgICAgICAgaWYgKGlzQmFjaykge1xuICAgICAgICAgICAgdmFyIGluZGV4XzIgPSB0aGlzLl9iYWNrU3RhY2suaW5kZXhPZihlbnRyeSk7XG4gICAgICAgICAgICB0aGlzLl9iYWNrU3RhY2suc3BsaWNlKGluZGV4XzIgKyAxKS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5fcmVtb3ZlRW50cnkoZSk7IH0pO1xuICAgICAgICAgICAgdGhpcy5fYmFja1N0YWNrLnBvcCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgIGlmIChlbnRyeS5lbnRyeS5jbGVhckhpc3RvcnkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWNrU3RhY2suZm9yRWFjaChmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMuX3JlbW92ZUVudHJ5KGUpOyB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9iYWNrU3RhY2subGVuZ3RoID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKEZyYW1lQmFzZV8xLl9pc0VudHJ5QmFja3N0YWNrVmlzaWJsZShjdXJyZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2JhY2tTdGFjay5wdXNoKGN1cnJlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50ICYmIHRoaXMuX2JhY2tTdGFjay5pbmRleE9mKGN1cnJlbnQpIDwgMCkge1xuICAgICAgICAgICAgdGhpcy5fcmVtb3ZlRW50cnkoY3VycmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuaXNOZXN0ZWRXaXRoaW4gPSBmdW5jdGlvbiAocGFyZW50RnJhbWVDYW5kaWRhdGUpIHtcbiAgICAgICAgdmFyIGZyYW1lQW5jZXN0b3IgPSB0aGlzO1xuICAgICAgICB3aGlsZSAoZnJhbWVBbmNlc3Rvcikge1xuICAgICAgICAgICAgZnJhbWVBbmNlc3RvciA9IHZpZXdfY29tbW9uXzEuZ2V0QW5jZXN0b3IoZnJhbWVBbmNlc3RvciwgRnJhbWVCYXNlXzEpO1xuICAgICAgICAgICAgaWYgKGZyYW1lQW5jZXN0b3IgPT09IHBhcmVudEZyYW1lQ2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5yYWlzZUN1cnJlbnRQYWdlTmF2aWdhdGVkRXZlbnRzID0gZnVuY3Rpb24gKGlzQmFjaykge1xuICAgICAgICB2YXIgcGFnZSA9IHRoaXMuY3VycmVudFBhZ2U7XG4gICAgICAgIGlmIChwYWdlKSB7XG4gICAgICAgICAgICBpZiAocGFnZS5pc0xvYWRlZCkge1xuICAgICAgICAgICAgICAgIHBhZ2UuY2FsbFVubG9hZGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwYWdlLm9uTmF2aWdhdGVkRnJvbShpc0JhY2spO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wcm9jZXNzTmF2aWdhdGlvblF1ZXVlID0gZnVuY3Rpb24gKHBhZ2UpIHtcbiAgICAgICAgaWYgKHRoaXMuX25hdmlnYXRpb25RdWV1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZW50cnkgPSB0aGlzLl9uYXZpZ2F0aW9uUXVldWVbMF0uZW50cnk7XG4gICAgICAgIHZhciBjdXJyZW50TmF2aWdhdGlvblBhZ2UgPSBlbnRyeS5yZXNvbHZlZFBhZ2U7XG4gICAgICAgIGlmIChwYWdlICE9PSBjdXJyZW50TmF2aWdhdGlvblBhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9uYXZpZ2F0aW9uUXVldWUuc2hpZnQoKTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc05leHROYXZpZ2F0aW9uRW50cnkoKTtcbiAgICAgICAgdGhpcy5fdXBkYXRlQWN0aW9uQmFyKCk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9maW5kRW50cnlGb3JUYWcgPSBmdW5jdGlvbiAoZnJhZ21lbnRUYWcpIHtcbiAgICAgICAgdmFyIGVudHJ5O1xuICAgICAgICBpZiAodGhpcy5fY3VycmVudEVudHJ5ICYmIHRoaXMuX2N1cnJlbnRFbnRyeS5mcmFnbWVudFRhZyA9PT0gZnJhZ21lbnRUYWcpIHtcbiAgICAgICAgICAgIGVudHJ5ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZW50cnkgPSB0aGlzLl9iYWNrU3RhY2suZmluZChmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIHZhbHVlLmZyYWdtZW50VGFnID09PSBmcmFnbWVudFRhZzsgfSk7XG4gICAgICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hdmlnYXRpb25JdGVtID0gdGhpcy5fbmF2aWdhdGlvblF1ZXVlLmZpbmQoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZS5lbnRyeS5mcmFnbWVudFRhZyA9PT0gZnJhZ21lbnRUYWc7IH0pO1xuICAgICAgICAgICAgICAgIGVudHJ5ID0gbmF2aWdhdGlvbkl0ZW0gPyBuYXZpZ2F0aW9uSXRlbS5lbnRyeSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLm5hdmlnYXRpb25RdWV1ZUlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9uYXZpZ2F0aW9uUXVldWUubGVuZ3RoID09PSAwO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLl9pc0VudHJ5QmFja3N0YWNrVmlzaWJsZSA9IGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICBpZiAoIWVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tzdGFja1Zpc2libGVWYWx1ZSA9IGVudHJ5LmVudHJ5LmJhY2tzdGFja1Zpc2libGU7XG4gICAgICAgIHZhciBiYWNrc3RhY2tIaWRkZW4gPSBiYWNrc3RhY2tWaXNpYmxlVmFsdWUgIT09IHVuZGVmaW5lZCAmJiAhYmFja3N0YWNrVmlzaWJsZVZhbHVlO1xuICAgICAgICByZXR1cm4gIWJhY2tzdGFja0hpZGRlbjtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3VwZGF0ZUFjdGlvbkJhciA9IGZ1bmN0aW9uIChwYWdlLCBkaXNhYmxlTmF2QmFyQW5pbWF0aW9uKSB7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzTG9hZGVkIHx8IHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fbmF2aWdhdGlvblF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBuYXZpZ2F0aW9uQ29udGV4dCA9IHRoaXMuX25hdmlnYXRpb25RdWV1ZVswXTtcbiAgICAgICAgICAgIHZhciBpc0JhY2tOYXZpZ2F0aW9uID0gbmF2aWdhdGlvbkNvbnRleHQubmF2aWdhdGlvblR5cGUgPT09IE5hdmlnYXRpb25UeXBlLmJhY2s7XG4gICAgICAgICAgICBpZiAoaXNCYWNrTmF2aWdhdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMucGVyZm9ybUdvQmFjayhuYXZpZ2F0aW9uQ29udGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBlcmZvcm1OYXZpZ2F0aW9uKG5hdmlnYXRpb25Db250ZXh0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5wZXJmb3JtTmF2aWdhdGlvbiA9IGZ1bmN0aW9uIChuYXZpZ2F0aW9uQ29udGV4dCkge1xuICAgICAgICB0aGlzLl9leGVjdXRpbmdDb250ZXh0ID0gbmF2aWdhdGlvbkNvbnRleHQ7XG4gICAgICAgIHZhciBiYWNrc3RhY2tFbnRyeSA9IG5hdmlnYXRpb25Db250ZXh0LmVudHJ5O1xuICAgICAgICB2YXIgaXNCYWNrTmF2aWdhdGlvbiA9IG5hdmlnYXRpb25Db250ZXh0Lm5hdmlnYXRpb25UeXBlID09PSBOYXZpZ2F0aW9uVHlwZS5iYWNrO1xuICAgICAgICB0aGlzLl9vbk5hdmlnYXRpbmdUbyhiYWNrc3RhY2tFbnRyeSwgaXNCYWNrTmF2aWdhdGlvbik7XG4gICAgICAgIHRoaXMuX25hdmlnYXRlQ29yZShiYWNrc3RhY2tFbnRyeSk7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLnBlcmZvcm1Hb0JhY2sgPSBmdW5jdGlvbiAobmF2aWdhdGlvbkNvbnRleHQpIHtcbiAgICAgICAgdmFyIGJhY2tzdGFja0VudHJ5ID0gbmF2aWdhdGlvbkNvbnRleHQuZW50cnk7XG4gICAgICAgIHZhciBiYWNrc3RhY2sgPSB0aGlzLl9iYWNrU3RhY2s7XG4gICAgICAgIGlmICghYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgICAgIGJhY2tzdGFja0VudHJ5ID0gYmFja3N0YWNrW2JhY2tzdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIG5hdmlnYXRpb25Db250ZXh0LmVudHJ5ID0gYmFja3N0YWNrRW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZXhlY3V0aW5nQ29udGV4dCA9IG5hdmlnYXRpb25Db250ZXh0O1xuICAgICAgICB0aGlzLl9vbk5hdmlnYXRpbmdUbyhiYWNrc3RhY2tFbnRyeSwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuX2dvQmFja0NvcmUoYmFja3N0YWNrRW50cnkpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZ29CYWNrQ29yZSA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICBpZiAodmlld18xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICB2aWV3XzEudHJhY2VXcml0ZShcIkdPIEJBQ0sgQ09SRShcIiArIHRoaXMuX2JhY2tzdGFja0VudHJ5VHJhY2UoYmFja3N0YWNrRW50cnkpICsgXCIpOyBjdXJyZW50UGFnZTogXCIgKyB0aGlzLmN1cnJlbnRQYWdlLCB2aWV3XzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9uYXZpZ2F0ZUNvcmUgPSBmdW5jdGlvbiAoYmFja3N0YWNrRW50cnkpIHtcbiAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoXCJOQVZJR0FURSBDT1JFKFwiICsgdGhpcy5fYmFja3N0YWNrRW50cnlUcmFjZShiYWNrc3RhY2tFbnRyeSkgKyBcIik7IGN1cnJlbnRQYWdlOiBcIiArIHRoaXMuY3VycmVudFBhZ2UsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX29uTmF2aWdhdGluZ1RvID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5LCBpc0JhY2spIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBhZ2Uub25OYXZpZ2F0aW5nRnJvbShpc0JhY2spO1xuICAgICAgICB9XG4gICAgICAgIGJhY2tzdGFja0VudHJ5LnJlc29sdmVkUGFnZS5vbk5hdmlnYXRpbmdUbyhiYWNrc3RhY2tFbnRyeS5lbnRyeS5jb250ZXh0LCBpc0JhY2ssIGJhY2tzdGFja0VudHJ5LmVudHJ5LmJpbmRpbmdDb250ZXh0KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcImFuaW1hdGVkXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYW5pbWF0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9hbmltYXRlZCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJ0cmFuc2l0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNpdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zaXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwiYmFja1N0YWNrXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFja1N0YWNrLnNsaWNlKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZUJhc2UucHJvdG90eXBlLCBcImN1cnJlbnRQYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudEVudHJ5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRFbnRyeS5yZXNvbHZlZFBhZ2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lQmFzZS5wcm90b3R5cGUsIFwiY3VycmVudEVudHJ5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudEVudHJ5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRFbnRyeS5lbnRyeTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9wdXNoSW5GcmFtZVN0YWNrUmVjdXJzaXZlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9wdXNoSW5GcmFtZVN0YWNrKCk7XG4gICAgICAgIHZhciBmcmFtZXNUb1B1c2ggPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBmcmFtZVN0YWNrXzEgPSBmcmFtZV9zdGFja18xLmZyYW1lU3RhY2s7IF9pIDwgZnJhbWVTdGFja18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgdmFyIGZyYW1lID0gZnJhbWVTdGFja18xW19pXTtcbiAgICAgICAgICAgIGlmIChmcmFtZS5pc05lc3RlZFdpdGhpbih0aGlzKSkge1xuICAgICAgICAgICAgICAgIGZyYW1lc1RvUHVzaC5wdXNoKGZyYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBfYSA9IDAsIGZyYW1lc1RvUHVzaF8xID0gZnJhbWVzVG9QdXNoOyBfYSA8IGZyYW1lc1RvUHVzaF8xLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgdmFyIGZyYW1lID0gZnJhbWVzVG9QdXNoXzFbX2FdO1xuICAgICAgICAgICAgZnJhbWUuX3B1c2hJbkZyYW1lU3RhY2soKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHVzaEluRnJhbWVTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnJhbWVfc3RhY2tfMS5fcHVzaEluRnJhbWVTdGFjayh0aGlzKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3BvcEZyb21GcmFtZVN0YWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmcmFtZV9zdGFja18xLl9wb3BGcm9tRnJhbWVTdGFjayh0aGlzKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3JlbW92ZUZyb21GcmFtZVN0YWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmcmFtZV9zdGFja18xLl9yZW1vdmVGcm9tRnJhbWVTdGFjayh0aGlzKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2RpYWxvZ0Nsb3NlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlRnJvbUZyYW1lU3RhY2soKTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX29uUm9vdFZpZXdSZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5fb25Sb290Vmlld1Jlc2V0LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuX3JlbW92ZUZyb21GcmFtZVN0YWNrKCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJfY2hpbGRyZW5Db3VudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBhZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLmVhY2hDaGlsZFZpZXcgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHBhZ2UgPSB0aGlzLmN1cnJlbnRQYWdlO1xuICAgICAgICBpZiAocGFnZSkge1xuICAgICAgICAgICAgY2FsbGJhY2socGFnZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX2dldElzQW5pbWF0ZWROYXZpZ2F0aW9uID0gZnVuY3Rpb24gKGVudHJ5KSB7XG4gICAgICAgIGlmIChlbnRyeSAmJiBlbnRyeS5hbmltYXRlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm4gZW50cnkuYW5pbWF0ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuYW5pbWF0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYW5pbWF0ZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEZyYW1lQmFzZV8xLmRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb247XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9nZXROYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICBpZiAoZW50cnkpIHtcbiAgICAgICAgICAgIGlmICh2aWV3XzEuaXNJT1MgJiYgZW50cnkudHJhbnNpdGlvbmlPUyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5LnRyYW5zaXRpb25pT1M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmlld18xLmlzQW5kcm9pZCAmJiBlbnRyeS50cmFuc2l0aW9uQW5kcm9pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVudHJ5LnRyYW5zaXRpb25BbmRyb2lkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVudHJ5LnRyYW5zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBlbnRyeS50cmFuc2l0aW9uO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMudHJhbnNpdGlvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRnJhbWVCYXNlXzEuZGVmYXVsdFRyYW5zaXRpb247XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJuYXZpZ2F0aW9uQmFySGVpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fZ2V0TmF2QmFyVmlzaWJsZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fYWRkVmlld1RvTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIEZyYW1lQmFzZS5wcm90b3R5cGUuX3JlbW92ZVZpZXdGcm9tTmF0aXZlVmlzdWFsVHJlZSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuICAgICAgICBjaGlsZC5faXNBZGRlZFRvTmF0aXZlVmlzdWFsVHJlZSA9IGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fcHJpbnRGcmFtZUJhY2tTdGFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxlbmd0aCA9IHRoaXMuYmFja1N0YWNrLmxlbmd0aDtcbiAgICAgICAgdmFyIGkgPSBsZW5ndGggLSAxO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkZyYW1lIEJhY2sgU3RhY2s6IFwiKTtcbiAgICAgICAgd2hpbGUgKGkgPj0gMCkge1xuICAgICAgICAgICAgdmFyIGJhY2tzdGFja0VudHJ5ID0gdGhpcy5iYWNrU3RhY2tbaS0tXTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiXFx0XCIgKyBiYWNrc3RhY2tFbnRyeS5yZXNvbHZlZFBhZ2UpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9iYWNrc3RhY2tFbnRyeVRyYWNlID0gZnVuY3Rpb24gKGIpIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCIgKyBiLnJlc29sdmVkUGFnZTtcbiAgICAgICAgdmFyIGJhY2tzdGFja1Zpc2libGUgPSBGcmFtZUJhc2VfMS5faXNFbnRyeUJhY2tzdGFja1Zpc2libGUoYik7XG4gICAgICAgIGlmICghYmFja3N0YWNrVmlzaWJsZSkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IFwiIHwgSU5WSVNJQkxFXCI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGIuZW50cnkuY2xlYXJIaXN0b3J5KSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCIgfCBDTEVBUiBISVNUT1JZXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdGVkID0gdGhpcy5fZ2V0SXNBbmltYXRlZE5hdmlnYXRpb24oYi5lbnRyeSk7XG4gICAgICAgIGlmICghYW5pbWF0ZWQpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcIiB8IE5PVCBBTklNQVRFRFwiO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ID0gdGhpcy5fZ2V0TmF2aWdhdGlvblRyYW5zaXRpb24oYi5lbnRyeSk7XG4gICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCIgfCBUcmFuc2l0aW9uW1wiICsgSlNPTi5zdHJpbmdpZnkodCkgKyBcIl1cIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5fb25MaXZlc3luYyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIGlmIChfc3VwZXIucHJvdG90eXBlLl9vbkxpdmVzeW5jLmNhbGwodGhpcywgY29udGV4dCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY29udGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGVnYWN5TGl2ZXN5bmMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbiAgICBGcmFtZUJhc2UucHJvdG90eXBlLl9oYW5kbGVMaXZlc3luYyA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgIGlmIChfc3VwZXIucHJvdG90eXBlLl9oYW5kbGVMaXZlc3luYy5jYWxsKHRoaXMsIGNvbnRleHQpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGFnZSAmJlxuICAgICAgICAgICAgdmlld19jb21tb25fMS52aWV3TWF0Y2hlc01vZHVsZUNvbnRleHQodGhpcy5jdXJyZW50UGFnZSwgY29udGV4dCwgW1wibWFya3VwXCIsIFwic2NyaXB0XCJdKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUoXCJDaGFuZ2UgSGFuZGxlZDogUmVwbGFjaW5nIHBhZ2UgXCIgKyBjb250ZXh0LnBhdGgsIHZpZXdfMS50cmFjZUNhdGVnb3JpZXMuTGl2ZXN5bmMpO1xuICAgICAgICAgICAgdGhpcy5yZXBsYWNlUGFnZShjb250ZXh0LnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5sZWdhY3lMaXZlc3luYyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHZpZXdfMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgdmlld18xLnRyYWNlV3JpdGUodGhpcyArIFwiLl9vbkxpdmVzeW5jKClcIiwgdmlld18xLnRyYWNlQ2F0ZWdvcmllcy5MaXZlc3luYyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLl9jdXJyZW50RW50cnkgfHwgIXRoaXMuX2N1cnJlbnRFbnRyeS5lbnRyeSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjdXJyZW50RW50cnkgPSB0aGlzLl9jdXJyZW50RW50cnkuZW50cnk7XG4gICAgICAgIHZhciBuZXdFbnRyeSA9IHtcbiAgICAgICAgICAgIGFuaW1hdGVkOiBmYWxzZSxcbiAgICAgICAgICAgIGNsZWFySGlzdG9yeTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRleHQ6IGN1cnJlbnRFbnRyeS5jb250ZXh0LFxuICAgICAgICAgICAgY3JlYXRlOiBjdXJyZW50RW50cnkuY3JlYXRlLFxuICAgICAgICAgICAgbW9kdWxlTmFtZTogY3VycmVudEVudHJ5Lm1vZHVsZU5hbWUsXG4gICAgICAgICAgICBiYWNrc3RhY2tWaXNpYmxlOiBjdXJyZW50RW50cnkuYmFja3N0YWNrVmlzaWJsZVxuICAgICAgICB9O1xuICAgICAgICBpZiAobmV3RW50cnkuY3JlYXRlKSB7XG4gICAgICAgICAgICB2YXIgcGFnZSA9IG5ld0VudHJ5LmNyZWF0ZSgpO1xuICAgICAgICAgICAgaWYgKHBhZ2UgPT09IHRoaXMuY3VycmVudFBhZ2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5uYXZpZ2F0ZShuZXdFbnRyeSk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgRnJhbWVCYXNlLnByb3RvdHlwZS5yZXBsYWNlUGFnZSA9IGZ1bmN0aW9uIChwYWdlUGF0aCkge1xuICAgICAgICB2YXIgY3VycmVudEJhY2tzdGFja0VudHJ5ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICB2YXIgY29udGV4dE1vZHVsZU5hbWUgPSBtb2R1bGVfbmFtZV9zYW5pdGl6ZXJfMS5zYW5pdGl6ZU1vZHVsZU5hbWUocGFnZVBhdGgpO1xuICAgICAgICB2YXIgbmV3UGFnZSA9IGJ1aWxkZXJfMS5jcmVhdGVWaWV3RnJvbUVudHJ5KHsgbW9kdWxlTmFtZTogY29udGV4dE1vZHVsZU5hbWUgfSk7XG4gICAgICAgIHZhciBuZXdCYWNrc3RhY2tFbnRyeSA9IHtcbiAgICAgICAgICAgIGVudHJ5OiBjdXJyZW50QmFja3N0YWNrRW50cnkuZW50cnksXG4gICAgICAgICAgICByZXNvbHZlZFBhZ2U6IG5ld1BhZ2UsXG4gICAgICAgICAgICBuYXZEZXB0aDogY3VycmVudEJhY2tzdGFja0VudHJ5Lm5hdkRlcHRoLFxuICAgICAgICAgICAgZnJhZ21lbnRUYWc6IGN1cnJlbnRCYWNrc3RhY2tFbnRyeS5mcmFnbWVudFRhZyxcbiAgICAgICAgICAgIGZyYW1lSWQ6IGN1cnJlbnRCYWNrc3RhY2tFbnRyeS5mcmFtZUlkXG4gICAgICAgIH07XG4gICAgICAgIHZhciBuYXZpZ2F0aW9uQ29udGV4dCA9IHtcbiAgICAgICAgICAgIGVudHJ5OiBuZXdCYWNrc3RhY2tFbnRyeSxcbiAgICAgICAgICAgIGlzQmFja05hdmlnYXRpb246IGZhbHNlLFxuICAgICAgICAgICAgbmF2aWdhdGlvblR5cGU6IE5hdmlnYXRpb25UeXBlLnJlcGxhY2VcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fbmF2aWdhdGlvblF1ZXVlLnB1c2gobmF2aWdhdGlvbkNvbnRleHQpO1xuICAgICAgICB0aGlzLl9wcm9jZXNzTmV4dE5hdmlnYXRpb25FbnRyeSgpO1xuICAgIH07XG4gICAgdmFyIEZyYW1lQmFzZV8xO1xuICAgIEZyYW1lQmFzZS5hbmRyb2lkT3B0aW9uU2VsZWN0ZWRFdmVudCA9IFwib3B0aW9uU2VsZWN0ZWRcIjtcbiAgICBGcmFtZUJhc2UuZGVmYXVsdEFuaW1hdGVkTmF2aWdhdGlvbiA9IHRydWU7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBGcmFtZUJhc2UucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhbWVCYXNlLnByb3RvdHlwZSwgXCJwZXJmb3JtTmF2aWdhdGlvblwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIEZyYW1lQmFzZS5wcm90b3R5cGUsIFwicGVyZm9ybUdvQmFja1wiLCBudWxsKTtcbiAgICBGcmFtZUJhc2UgPSBGcmFtZUJhc2VfMSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICB2aWV3XzEuQ1NTVHlwZShcIkZyYW1lXCIpXG4gICAgXSwgRnJhbWVCYXNlKTtcbiAgICByZXR1cm4gRnJhbWVCYXNlO1xufSh2aWV3XzEuQ3VzdG9tTGF5b3V0VmlldykpO1xuZXhwb3J0cy5GcmFtZUJhc2UgPSBGcmFtZUJhc2U7XG5mdW5jdGlvbiBnZXRGcmFtZUJ5SWQoaWQpIHtcbiAgICByZXR1cm4gZnJhbWVfc3RhY2tfMS5mcmFtZVN0YWNrLmZpbmQoZnVuY3Rpb24gKGZyYW1lKSB7IHJldHVybiBmcmFtZS5pZCAmJiBmcmFtZS5pZCA9PT0gaWQ7IH0pO1xufVxuZXhwb3J0cy5nZXRGcmFtZUJ5SWQgPSBnZXRGcmFtZUJ5SWQ7XG5mdW5jdGlvbiB0b3Btb3N0KCkge1xuICAgIHJldHVybiBmcmFtZV9zdGFja18xLnRvcG1vc3QoKTtcbn1cbmV4cG9ydHMudG9wbW9zdCA9IHRvcG1vc3Q7XG5mdW5jdGlvbiBnb0JhY2soKSB7XG4gICAgdmFyIHRvcCA9IHRvcG1vc3QoKTtcbiAgICBpZiAodG9wICYmIHRvcC5jYW5Hb0JhY2soKSkge1xuICAgICAgICB0b3AuZ29CYWNrKCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBlbHNlIGlmICh0b3ApIHtcbiAgICAgICAgdmFyIHBhcmVudEZyYW1lQ2FuR29CYWNrID0gZmFsc2U7XG4gICAgICAgIHZhciBwYXJlbnRGcmFtZSA9IHZpZXdfY29tbW9uXzEuZ2V0QW5jZXN0b3IodG9wLCBcIkZyYW1lXCIpO1xuICAgICAgICB3aGlsZSAocGFyZW50RnJhbWUgJiYgIXBhcmVudEZyYW1lQ2FuR29CYWNrKSB7XG4gICAgICAgICAgICBpZiAocGFyZW50RnJhbWUgJiYgcGFyZW50RnJhbWUuY2FuR29CYWNrKCkpIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRGcmFtZUNhbkdvQmFjayA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRGcmFtZSA9IHZpZXdfY29tbW9uXzEuZ2V0QW5jZXN0b3IocGFyZW50RnJhbWUsIFwiRnJhbWVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBhcmVudEZyYW1lICYmIHBhcmVudEZyYW1lQ2FuR29CYWNrKSB7XG4gICAgICAgICAgICBwYXJlbnRGcmFtZS5nb0JhY2soKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChmcmFtZV9zdGFja18xLmZyYW1lU3RhY2subGVuZ3RoID4gMSkge1xuICAgICAgICB0b3AuX3BvcEZyb21GcmFtZVN0YWNrKCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmV4cG9ydHMuZ29CYWNrID0gZ29CYWNrO1xuZnVuY3Rpb24gX3N0YWNrKCkge1xuICAgIHJldHVybiBmcmFtZV9zdGFja18xLmZyYW1lU3RhY2s7XG59XG5leHBvcnRzLl9zdGFjayA9IF9zdGFjaztcbmV4cG9ydHMuZGVmYXVsdFBhZ2UgPSBuZXcgdmlld18xLlByb3BlcnR5KHtcbiAgICBuYW1lOiBcImRlZmF1bHRQYWdlXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKGZyYW1lLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgZnJhbWUubmF2aWdhdGUoeyBtb2R1bGVOYW1lOiBuZXdWYWx1ZSB9KTtcbiAgICB9XG59KTtcbmV4cG9ydHMuZGVmYXVsdFBhZ2UucmVnaXN0ZXIoRnJhbWVCYXNlKTtcbmV4cG9ydHMuYWN0aW9uQmFyVmlzaWJpbGl0eVByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwiYWN0aW9uQmFyVmlzaWJpbGl0eVwiLCBkZWZhdWx0VmFsdWU6IFwiYXV0b1wiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MgfSk7XG5leHBvcnRzLmFjdGlvbkJhclZpc2liaWxpdHlQcm9wZXJ0eS5yZWdpc3RlcihGcmFtZUJhc2UpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJhbWUtY29tbW9uLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuZnJhbWVTdGFjayA9IFtdO1xuZnVuY3Rpb24gdG9wbW9zdCgpIHtcbiAgICBpZiAoZXhwb3J0cy5mcmFtZVN0YWNrLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIGV4cG9ydHMuZnJhbWVTdGFja1tleHBvcnRzLmZyYW1lU3RhY2subGVuZ3RoIC0gMV07XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG5leHBvcnRzLnRvcG1vc3QgPSB0b3Btb3N0O1xuZnVuY3Rpb24gX3B1c2hJbkZyYW1lU3RhY2soZnJhbWUpIHtcbiAgICBpZiAoZnJhbWUuX2lzSW5GcmFtZVN0YWNrICYmIGV4cG9ydHMuZnJhbWVTdGFja1tleHBvcnRzLmZyYW1lU3RhY2subGVuZ3RoIC0gMV0gPT09IGZyYW1lKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGZyYW1lLl9pc0luRnJhbWVTdGFjaykge1xuICAgICAgICB2YXIgaW5kZXhPZkZyYW1lID0gZXhwb3J0cy5mcmFtZVN0YWNrLmluZGV4T2YoZnJhbWUpO1xuICAgICAgICBleHBvcnRzLmZyYW1lU3RhY2suc3BsaWNlKGluZGV4T2ZGcmFtZSwgMSk7XG4gICAgfVxuICAgIGV4cG9ydHMuZnJhbWVTdGFjay5wdXNoKGZyYW1lKTtcbiAgICBmcmFtZS5faXNJbkZyYW1lU3RhY2sgPSB0cnVlO1xufVxuZXhwb3J0cy5fcHVzaEluRnJhbWVTdGFjayA9IF9wdXNoSW5GcmFtZVN0YWNrO1xuZnVuY3Rpb24gX3BvcEZyb21GcmFtZVN0YWNrKGZyYW1lKSB7XG4gICAgaWYgKCFmcmFtZS5faXNJbkZyYW1lU3RhY2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdG9wID0gdG9wbW9zdCgpO1xuICAgIGlmICh0b3AgIT09IGZyYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBwb3AgYSBGcmFtZSB3aGljaCBpcyBub3QgYXQgdGhlIHRvcCBvZiB0aGUgbmF2aWdhdGlvbiBzdGFjay5cIik7XG4gICAgfVxuICAgIGV4cG9ydHMuZnJhbWVTdGFjay5wb3AoKTtcbiAgICBmcmFtZS5faXNJbkZyYW1lU3RhY2sgPSBmYWxzZTtcbn1cbmV4cG9ydHMuX3BvcEZyb21GcmFtZVN0YWNrID0gX3BvcEZyb21GcmFtZVN0YWNrO1xuZnVuY3Rpb24gX3JlbW92ZUZyb21GcmFtZVN0YWNrKGZyYW1lKSB7XG4gICAgaWYgKCFmcmFtZS5faXNJbkZyYW1lU3RhY2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgaW5kZXggPSBleHBvcnRzLmZyYW1lU3RhY2suaW5kZXhPZihmcmFtZSk7XG4gICAgZXhwb3J0cy5mcmFtZVN0YWNrLnNwbGljZShpbmRleCwgMSk7XG4gICAgZnJhbWUuX2lzSW5GcmFtZVN0YWNrID0gZmFsc2U7XG59XG5leHBvcnRzLl9yZW1vdmVGcm9tRnJhbWVTdGFjayA9IF9yZW1vdmVGcm9tRnJhbWVTdGFjaztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyYW1lLXN0YWNrLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvZmlsaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vcHJvZmlsaW5nXCIpO1xudmFyIGZyYW1lX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZnJhbWUtY29tbW9uXCIpO1xudmFyIGZyYWdtZW50X3RyYW5zaXRpb25zXzEgPSByZXF1aXJlKFwiLi9mcmFnbWVudC50cmFuc2l0aW9uc1wiKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy91dGlsc1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2ZyYW1lLWNvbW1vblwiKSk7XG52YXIgbWFqb3JWZXJzaW9uID0gdXRpbHMuaW9zLk1ham9yVmVyc2lvbjtcbnZhciBFTlRSWSA9IFwiX2VudHJ5XCI7XG52YXIgREVMRUdBVEUgPSBcIl9kZWxlZ2F0ZVwiO1xudmFyIE5BVl9ERVBUSCA9IFwiX25hdkRlcHRoXCI7XG52YXIgVFJBTlNJVElPTiA9IFwiX3RyYW5zaXRpb25cIjtcbnZhciBOT05fQU5JTUFURURfVFJBTlNJVElPTiA9IFwibm9uLWFuaW1hdGVkXCI7XG52YXIgSE1SX1JFUExBQ0VfVFJBTlNJVElPTiA9IFwiZmFkZVwiO1xudmFyIG5hdkRlcHRoID0gLTE7XG52YXIgRnJhbWUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGcmFtZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBGcmFtZSgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FuaW1hdGVkRGVsZWdhdGUgPSBVSU5hdmlnYXRpb25Db250cm9sbGVyQW5pbWF0ZWREZWxlZ2F0ZS5uZXcoKTtcbiAgICAgICAgX3RoaXMuX2lvcyA9IG5ldyBpT1NGcmFtZShfdGhpcyk7XG4gICAgICAgIF90aGlzLnZpZXdDb250cm9sbGVyID0gX3RoaXMuX2lvcy5jb250cm9sbGVyO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEZyYW1lLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy52aWV3Q29udHJvbGxlci52aWV3O1xuICAgIH07XG4gICAgRnJhbWUucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9yZW1vdmVGcm9tRnJhbWVTdGFjaygpO1xuICAgICAgICB0aGlzLnZpZXdDb250cm9sbGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW9zLmNvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc3Bvc2VOYXRpdmVWaWV3LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnJhbWUucHJvdG90eXBlLCBcImlvc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lvcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgRnJhbWUucHJvdG90eXBlLnNldEN1cnJlbnQgPSBmdW5jdGlvbiAoZW50cnksIG5hdmlnYXRpb25UeXBlKSB7XG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5fY3VycmVudEVudHJ5O1xuICAgICAgICB2YXIgY3VycmVudEVudHJ5Q2hhbmdlZCA9IGN1cnJlbnQgIT09IGVudHJ5O1xuICAgICAgICBpZiAoY3VycmVudEVudHJ5Q2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlQmFja3N0YWNrKGVudHJ5LCBuYXZpZ2F0aW9uVHlwZSk7XG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnNldEN1cnJlbnQuY2FsbCh0aGlzLCBlbnRyeSwgbmF2aWdhdGlvblR5cGUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX25hdmlnYXRlQ29yZSA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9uYXZpZ2F0ZUNvcmUuY2FsbCh0aGlzLCBiYWNrc3RhY2tFbnRyeSk7XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlciA9IGJhY2tzdGFja0VudHJ5LnJlc29sdmVkUGFnZS5pb3M7XG4gICAgICAgIGlmICghdmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlcXVpcmVkIHBhZ2UgZG9lcyBub3QgaGF2ZSBhIHZpZXdDb250cm9sbGVyIGNyZWF0ZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjbGVhckhpc3RvcnkgPSBiYWNrc3RhY2tFbnRyeS5lbnRyeS5jbGVhckhpc3Rvcnk7XG4gICAgICAgIGlmIChjbGVhckhpc3RvcnkpIHtcbiAgICAgICAgICAgIG5hdkRlcHRoID0gLTE7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGlzUmVwbGFjZSA9IHRoaXMuX2V4ZWN1dGluZ0NvbnRleHQgJiYgdGhpcy5fZXhlY3V0aW5nQ29udGV4dC5uYXZpZ2F0aW9uVHlwZSA9PT0gZnJhbWVfY29tbW9uXzEuTmF2aWdhdGlvblR5cGUucmVwbGFjZTtcbiAgICAgICAgaWYgKCFpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgIG5hdkRlcHRoKys7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uO1xuICAgICAgICB2YXIgYW5pbWF0ZWQgPSB0aGlzLmN1cnJlbnRQYWdlID8gdGhpcy5fZ2V0SXNBbmltYXRlZE5hdmlnYXRpb24oYmFja3N0YWNrRW50cnkuZW50cnkpIDogZmFsc2U7XG4gICAgICAgIGlmIChpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgIGFuaW1hdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIG5hdmlnYXRpb25UcmFuc2l0aW9uID0geyBuYW1lOiBITVJfUkVQTEFDRV9UUkFOU0lUSU9OLCBkdXJhdGlvbjogMTAwIH07XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlcltUUkFOU0lUSU9OXSA9IG5hdmlnYXRpb25UcmFuc2l0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFuaW1hdGVkKSB7XG4gICAgICAgICAgICBuYXZpZ2F0aW9uVHJhbnNpdGlvbiA9IHRoaXMuX2dldE5hdmlnYXRpb25UcmFuc2l0aW9uKGJhY2tzdGFja0VudHJ5LmVudHJ5KTtcbiAgICAgICAgICAgIGlmIChuYXZpZ2F0aW9uVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgICAgIHZpZXdDb250cm9sbGVyW1RSQU5TSVRJT05dID0gbmF2aWdhdGlvblRyYW5zaXRpb247XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlcltUUkFOU0lUSU9OXSA9IHsgbmFtZTogTk9OX0FOSU1BVEVEX1RSQU5TSVRJT04gfTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbmF0aXZlVHJhbnNpdGlvbiA9IF9nZXROYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCB0cnVlKTtcbiAgICAgICAgaWYgKCFuYXRpdmVUcmFuc2l0aW9uICYmIG5hdmlnYXRpb25UcmFuc2l0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9pb3MuY29udHJvbGxlci5kZWxlZ2F0ZSA9IHRoaXMuX2FuaW1hdGVkRGVsZWdhdGU7XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlcltERUxFR0FURV0gPSB0aGlzLl9hbmltYXRlZERlbGVnYXRlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXJbREVMRUdBVEVdID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5jb250cm9sbGVyLmRlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBiYWNrc3RhY2tFbnRyeVtOQVZfREVQVEhdID0gbmF2RGVwdGg7XG4gICAgICAgIHZpZXdDb250cm9sbGVyW0VOVFJZXSA9IGJhY2tzdGFja0VudHJ5O1xuICAgICAgICBpZiAoIWFuaW1hdGVkICYmIG1ham9yVmVyc2lvbiA+IDEwKSB7XG4gICAgICAgICAgICB2YXIgYmFyQnV0dG9uSXRlbSA9IFVJQmFyQnV0dG9uSXRlbS5hbGxvYygpLmluaXRXaXRoVGl0bGVTdHlsZVRhcmdldEFjdGlvbihcIlwiLCAwLCBudWxsLCBudWxsKTtcbiAgICAgICAgICAgIHZpZXdDb250cm9sbGVyLm5hdmlnYXRpb25JdGVtLmJhY2tCYXJCdXR0b25JdGVtID0gYmFyQnV0dG9uSXRlbTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMuX2N1cnJlbnRFbnRyeSkge1xuICAgICAgICAgICAgdGhpcy5fdXBkYXRlQWN0aW9uQmFyKGJhY2tzdGFja0VudHJ5LnJlc29sdmVkUGFnZSwgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl9pb3MuY29udHJvbGxlci5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZCh2aWV3Q29udHJvbGxlciwgYW5pbWF0ZWQpO1xuICAgICAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZSh0aGlzICsgXCIucHVzaFZpZXdDb250cm9sbGVyQW5pbWF0ZWQoXCIgKyB2aWV3Q29udHJvbGxlciArIFwiLCBcIiArIGFuaW1hdGVkICsgXCIpOyBkZXB0aCA9IFwiICsgbmF2RGVwdGgsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2xlYXJIaXN0b3J5KSB7XG4gICAgICAgICAgICB2aWV3Q29udHJvbGxlci5uYXZpZ2F0aW9uSXRlbS5oaWRlc0JhY2tCdXR0b24gPSB0cnVlO1xuICAgICAgICAgICAgdmFyIG5ld0NvbnRyb2xsZXJzID0gTlNNdXRhYmxlQXJyYXkuYWxsb2MoKS5pbml0V2l0aENhcGFjaXR5KDEpO1xuICAgICAgICAgICAgbmV3Q29udHJvbGxlcnMuYWRkT2JqZWN0KHZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgICAgIHZhciBvbGRDb250cm9sbGVycyA9IHRoaXMuX2lvcy5jb250cm9sbGVyLnZpZXdDb250cm9sbGVycztcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQ29udHJvbGxlcnMuY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIG9sZENvbnRyb2xsZXJzLm9iamVjdEF0SW5kZXgoaSkuaXNCYWNrc3RhY2tDbGVhcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2lvcy5jb250cm9sbGVyLnNldFZpZXdDb250cm9sbGVyc0FuaW1hdGVkKG5ld0NvbnRyb2xsZXJzLCBhbmltYXRlZCk7XG4gICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5zZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZChbXCIgKyB2aWV3Q29udHJvbGxlciArIFwiXSwgXCIgKyBhbmltYXRlZCArIFwiKTsgZGVwdGggPSBcIiArIG5hdkRlcHRoLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFGcmFtZS5faXNFbnRyeUJhY2tzdGFja1Zpc2libGUodGhpcy5fY3VycmVudEVudHJ5KSB8fCBpc1JlcGxhY2UpIHtcbiAgICAgICAgICAgIHZhciBuZXdDb250cm9sbGVycyA9IE5TTXV0YWJsZUFycmF5LmFsbG9jKCkuaW5pdFdpdGhBcnJheSh0aGlzLl9pb3MuY29udHJvbGxlci52aWV3Q29udHJvbGxlcnMpO1xuICAgICAgICAgICAgaWYgKG5ld0NvbnRyb2xsZXJzLmNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiV3JvbmcgY29udHJvbGxlcnMgY291bnQuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmlld0NvbnRyb2xsZXIubmF2aWdhdGlvbkl0ZW0uaGlkZXNCYWNrQnV0dG9uID0gdGhpcy5iYWNrU3RhY2subGVuZ3RoID09PSAwO1xuICAgICAgICAgICAgdmFyIHNraXBwZWROYXZDb250cm9sbGVyID0gbmV3Q29udHJvbGxlcnMubGFzdE9iamVjdDtcbiAgICAgICAgICAgIHNraXBwZWROYXZDb250cm9sbGVyLmlzQmFja3N0YWNrU2tpcHBlZCA9IHRydWU7XG4gICAgICAgICAgICBuZXdDb250cm9sbGVycy5yZW1vdmVMYXN0T2JqZWN0KCk7XG4gICAgICAgICAgICBuZXdDb250cm9sbGVycy5hZGRPYmplY3Qodmlld0NvbnRyb2xsZXIpO1xuICAgICAgICAgICAgdGhpcy5faW9zLmNvbnRyb2xsZXIuc2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWQobmV3Q29udHJvbGxlcnMsIGFuaW1hdGVkKTtcbiAgICAgICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUodGhpcyArIFwiLnNldFZpZXdDb250cm9sbGVyc0FuaW1hdGVkKFtvcmlnaW5hbENvbnRyb2xsZXJzIC0gbGFzdENvbnRyb2xsZXIgKyBcIiArIHZpZXdDb250cm9sbGVyICsgXCJdLCBcIiArIGFuaW1hdGVkICsgXCIpOyBkZXB0aCA9IFwiICsgbmF2RGVwdGgsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXZpZ2F0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pb3MuY29udHJvbGxlci5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZCh2aWV3Q29udHJvbGxlciwgYW5pbWF0ZWQpO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUodGhpcyArIFwiLnB1c2hWaWV3Q29udHJvbGxlckFuaW1hdGVkKFwiICsgdmlld0NvbnRyb2xsZXIgKyBcIiwgXCIgKyBhbmltYXRlZCArIFwiKTsgZGVwdGggPSBcIiArIG5hdkRlcHRoLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF2aWdhdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fZ29CYWNrQ29yZSA9IGZ1bmN0aW9uIChiYWNrc3RhY2tFbnRyeSkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLl9nb0JhY2tDb3JlLmNhbGwodGhpcywgYmFja3N0YWNrRW50cnkpO1xuICAgICAgICBuYXZEZXB0aCA9IGJhY2tzdGFja0VudHJ5W05BVl9ERVBUSF07XG4gICAgICAgIHZhciBjb250cm9sbGVyID0gYmFja3N0YWNrRW50cnkucmVzb2x2ZWRQYWdlLmlvcztcbiAgICAgICAgdmFyIGFuaW1hdGVkID0gdGhpcy5fY3VycmVudEVudHJ5ID8gdGhpcy5fZ2V0SXNBbmltYXRlZE5hdmlnYXRpb24odGhpcy5fY3VycmVudEVudHJ5LmVudHJ5KSA6IGZhbHNlO1xuICAgICAgICB0aGlzLl91cGRhdGVBY3Rpb25CYXIoYmFja3N0YWNrRW50cnkucmVzb2x2ZWRQYWdlKTtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKHRoaXMgKyBcIi5wb3BUb1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQoXCIgKyBjb250cm9sbGVyICsgXCIsIFwiICsgYW5pbWF0ZWQgKyBcIik7IGRlcHRoID0gXCIgKyBuYXZEZXB0aCwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdmlnYXRpb24pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2lvcy5jb250cm9sbGVyLnBvcFRvVmlld0NvbnRyb2xsZXJBbmltYXRlZChjb250cm9sbGVyLCBhbmltYXRlZCk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX3VwZGF0ZUFjdGlvbkJhciA9IGZ1bmN0aW9uIChwYWdlLCBkaXNhYmxlTmF2QmFyQW5pbWF0aW9uKSB7XG4gICAgICAgIGlmIChkaXNhYmxlTmF2QmFyQW5pbWF0aW9uID09PSB2b2lkIDApIHsgZGlzYWJsZU5hdkJhckFuaW1hdGlvbiA9IGZhbHNlOyB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3VwZGF0ZUFjdGlvbkJhci5jYWxsKHRoaXMsIHBhZ2UpO1xuICAgICAgICBpZiAocGFnZSAmJiB0aGlzLmN1cnJlbnRQYWdlICYmIHRoaXMuY3VycmVudFBhZ2UubW9kYWwgPT09IHBhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBwYWdlID0gcGFnZSB8fCB0aGlzLmN1cnJlbnRQYWdlO1xuICAgICAgICB2YXIgbmV3VmFsdWUgPSB0aGlzLl9nZXROYXZCYXJWaXNpYmxlKHBhZ2UpO1xuICAgICAgICB2YXIgZGlzYWJsZU5hdkJhckFuaW1hdGlvbkNhY2hlID0gdGhpcy5faW9zLl9kaXNhYmxlTmF2QmFyQW5pbWF0aW9uO1xuICAgICAgICBpZiAoZGlzYWJsZU5hdkJhckFuaW1hdGlvbikge1xuICAgICAgICAgICAgdGhpcy5faW9zLl9kaXNhYmxlTmF2QmFyQW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pb3Muc2hvd05hdmlnYXRpb25CYXIgPSBuZXdWYWx1ZTtcbiAgICAgICAgaWYgKGRpc2FibGVOYXZCYXJBbmltYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX2lvcy5fZGlzYWJsZU5hdkJhckFuaW1hdGlvbiA9IGRpc2FibGVOYXZCYXJBbmltYXRpb25DYWNoZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5faW9zLmNvbnRyb2xsZXIubmF2aWdhdGlvbkJhcikge1xuICAgICAgICAgICAgdGhpcy5faW9zLmNvbnRyb2xsZXIubmF2aWdhdGlvbkJhci51c2VySW50ZXJhY3Rpb25FbmFibGVkID0gdGhpcy5uYXZpZ2F0aW9uUXVldWVJc0VtcHR5KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fZ2V0TmF2QmFyVmlzaWJsZSA9IGZ1bmN0aW9uIChwYWdlKSB7XG4gICAgICAgIHN3aXRjaCAodGhpcy5hY3Rpb25CYXJWaXNpYmlsaXR5KSB7XG4gICAgICAgICAgICBjYXNlIFwiYWx3YXlzXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICBjYXNlIFwibmV2ZXJcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBjYXNlIFwiYXV0b1wiOlxuICAgICAgICAgICAgICAgIHN3aXRjaCAodGhpcy5faW9zLm5hdkJhclZpc2liaWxpdHkpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFsd2F5c1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJuZXZlclwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYXV0b1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhZ2UgJiYgcGFnZS5hY3Rpb25CYXJIaWRkZW4gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gIXBhZ2UuYWN0aW9uQmFySGlkZGVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSB0aGlzLmlvcy5jb250cm9sbGVyLnZpZXdDb250cm9sbGVycy5jb3VudCA+IDEgfHwgKHBhZ2UgJiYgcGFnZS5hY3Rpb25CYXIgJiYgIXBhZ2UuYWN0aW9uQmFyLl9pc0VtcHR5KCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSAhIW5ld1ZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld1ZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZyYW1lLCBcImRlZmF1bHRBbmltYXRlZE5hdmlnYXRpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UuZGVmYXVsdEFuaW1hdGVkTmF2aWdhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0QW5pbWF0ZWROYXZpZ2F0aW9uID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShGcmFtZSwgXCJkZWZhdWx0VHJhbnNpdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0VHJhbnNpdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLkZyYW1lQmFzZS5kZWZhdWx0VHJhbnNpdGlvbiA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGcmFtZS5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciB3aWR0aCA9IGZyYW1lX2NvbW1vbl8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aE1vZGUgPSBmcmFtZV9jb21tb25fMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNNb2RlKHdpZHRoTWVhc3VyZVNwZWMpO1xuICAgICAgICB2YXIgaGVpZ2h0ID0gZnJhbWVfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjU2l6ZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBoZWlnaHRNb2RlID0gZnJhbWVfY29tbW9uXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciB3aWR0aEFuZFN0YXRlID0gZnJhbWVfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKHdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgdmFyIGhlaWdodEFuZFN0YXRlID0gZnJhbWVfY29tbW9uXzEuVmlldy5yZXNvbHZlU2l6ZUFuZFN0YXRlKGhlaWdodCwgaGVpZ2h0LCBoZWlnaHRNb2RlLCAwKTtcbiAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUubGF5b3V0TmF0aXZlVmlldyA9IGZ1bmN0aW9uIChsZWZ0LCB0b3AsIHJpZ2h0LCBib3R0b20pIHtcbiAgICB9O1xuICAgIEZyYW1lLnByb3RvdHlwZS5fc2V0TmF0aXZlVmlld0ZyYW1lID0gZnVuY3Rpb24gKG5hdGl2ZVZpZXcsIGZyYW1lKSB7XG4gICAgfTtcbiAgICBGcmFtZS5wcm90b3R5cGUuX29uTmF2aWdhdGluZ1RvID0gZnVuY3Rpb24gKGJhY2tzdGFja0VudHJ5LCBpc0JhY2spIHtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgRnJhbWUucHJvdG90eXBlLCBcIl9uYXZpZ2F0ZUNvcmVcIiwgbnVsbCk7XG4gICAgcmV0dXJuIEZyYW1lO1xufShmcmFtZV9jb21tb25fMS5GcmFtZUJhc2UpKTtcbmV4cG9ydHMuRnJhbWUgPSBGcmFtZTtcbnZhciB0cmFuc2l0aW9uRGVsZWdhdGVzID0gbmV3IEFycmF5KCk7XG52YXIgVHJhbnNpdGlvbkRlbGVnYXRlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVHJhbnNpdGlvbkRlbGVnYXRlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRyYW5zaXRpb25EZWxlZ2F0ZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUcmFuc2l0aW9uRGVsZWdhdGUuaW5pdFdpdGhPd25lcklkID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIHZhciBkZWxlZ2F0ZSA9IFRyYW5zaXRpb25EZWxlZ2F0ZS5uZXcoKTtcbiAgICAgICAgZGVsZWdhdGUuX2lkID0gaWQ7XG4gICAgICAgIHRyYW5zaXRpb25EZWxlZ2F0ZXMucHVzaChkZWxlZ2F0ZSk7XG4gICAgICAgIHJldHVybiBkZWxlZ2F0ZTtcbiAgICB9O1xuICAgIFRyYW5zaXRpb25EZWxlZ2F0ZS5wcm90b3R5cGUuYW5pbWF0aW9uV2lsbFN0YXJ0ID0gZnVuY3Rpb24gKGFuaW1hdGlvbklELCBjb250ZXh0KSB7XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlNUQVJUIFwiICsgdGhpcy5faWQsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVHJhbnNpdGlvbkRlbGVnYXRlLnByb3RvdHlwZS5hbmltYXRpb25EaWRTdG9wID0gZnVuY3Rpb24gKGFuaW1hdGlvbklELCBmaW5pc2hlZCwgY29udGV4dCkge1xuICAgICAgICBpZiAoZmluaXNoZWQpIHtcbiAgICAgICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJFTkQgXCIgKyB0aGlzLl9pZCwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIkNBTkNFTCBcIiArIHRoaXMuX2lkLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGluZGV4ID0gdHJhbnNpdGlvbkRlbGVnYXRlcy5pbmRleE9mKHRoaXMpO1xuICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgdHJhbnNpdGlvbkRlbGVnYXRlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUcmFuc2l0aW9uRGVsZWdhdGUuT2JqQ0V4cG9zZWRNZXRob2RzID0ge1xuICAgICAgICBcImFuaW1hdGlvbldpbGxTdGFydFwiOiB7IHJldHVybnM6IGludGVyb3AudHlwZXMudm9pZCwgcGFyYW1zOiBbTlNTdHJpbmcsIE5TT2JqZWN0XSB9LFxuICAgICAgICBcImFuaW1hdGlvbkRpZFN0b3BcIjogeyByZXR1cm5zOiBpbnRlcm9wLnR5cGVzLnZvaWQsIHBhcmFtczogW05TU3RyaW5nLCBOU051bWJlciwgTlNPYmplY3RdIH1cbiAgICB9O1xuICAgIHJldHVybiBUcmFuc2l0aW9uRGVsZWdhdGU7XG59KE5TT2JqZWN0KSk7XG52YXIgX2RlZmF1bHRUcmFuc2l0aW9uRHVyYXRpb24gPSAwLjM1O1xudmFyIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJBbmltYXRlZERlbGVnYXRlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVUlOYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGVkRGVsZWdhdGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGVkRGVsZWdhdGUoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGVkRGVsZWdhdGUucHJvdG90eXBlLm5hdmlnYXRpb25Db250cm9sbGVyQW5pbWF0aW9uQ29udHJvbGxlckZvck9wZXJhdGlvbkZyb21WaWV3Q29udHJvbGxlclRvVmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAobmF2aWdhdGlvbkNvbnRyb2xsZXIsIG9wZXJhdGlvbiwgZnJvbVZDLCB0b1ZDKSB7XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlcjtcbiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB2aWV3Q29udHJvbGxlciA9IHRvVkM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgdmlld0NvbnRyb2xsZXIgPSBmcm9tVkM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF2aWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gdmlld0NvbnRyb2xsZXJbVFJBTlNJVElPTl07XG4gICAgICAgIGlmICghbmF2aWdhdGlvblRyYW5zaXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLm5hdmlnYXRpb25Db250cm9sbGVyQW5pbWF0aW9uQ29udHJvbGxlckZvck9wZXJhdGlvbkZyb21WaWV3Q29udHJvbGxlclRvVmlld0NvbnRyb2xsZXIoXCIgKyBvcGVyYXRpb24gKyBcIiwgXCIgKyBmcm9tVkMgKyBcIiwgXCIgKyB0b1ZDICsgXCIpLCB0cmFuc2l0aW9uOiBcIiArIEpTT04uc3RyaW5naWZ5KG5hdmlnYXRpb25UcmFuc2l0aW9uKSwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLk5hdGl2ZUxpZmVjeWNsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGN1cnZlID0gX2dldE5hdGl2ZUN1cnZlKG5hdmlnYXRpb25UcmFuc2l0aW9uKTtcbiAgICAgICAgdmFyIGFuaW1hdGlvbkNvbnRyb2xsZXIgPSBmcmFnbWVudF90cmFuc2l0aW9uc18xLl9jcmVhdGVJT1NBbmltYXRlZFRyYW5zaXRpb25pbmcobmF2aWdhdGlvblRyYW5zaXRpb24sIGN1cnZlLCBvcGVyYXRpb24sIGZyb21WQywgdG9WQyk7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25Db250cm9sbGVyO1xuICAgIH07XG4gICAgVUlOYXZpZ2F0aW9uQ29udHJvbGxlckFuaW1hdGVkRGVsZWdhdGUuT2JqQ1Byb3RvY29scyA9IFtVSU5hdmlnYXRpb25Db250cm9sbGVyRGVsZWdhdGVdO1xuICAgIHJldHVybiBVSU5hdmlnYXRpb25Db250cm9sbGVyQW5pbWF0ZWREZWxlZ2F0ZTtcbn0oTlNPYmplY3QpKTtcbnZhciBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGNvbnRyb2xsZXIgPSBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5uZXcoKTtcbiAgICAgICAgY29udHJvbGxlci5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGNvbnRyb2xsZXI7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwucHJvdG90eXBlLCBcIm93bmVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3V2lsbEFwcGVhciA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnZpZXdXaWxsQXBwZWFyLmNhbGwodGhpcywgYW5pbWF0ZWQpO1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyICYmICFvd25lci5pc0xvYWRlZCAmJiAhb3duZXIucGFyZW50KSB7XG4gICAgICAgICAgICBvd25lci5jYWxsTG9hZGVkKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS52aWV3RGlkRGlzYXBwZWFyID0gZnVuY3Rpb24gKGFuaW1hdGVkKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudmlld0RpZERpc2FwcGVhci5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIuZ2V0KCk7XG4gICAgICAgIGlmIChvd25lciAmJiBvd25lci5pc0xvYWRlZCAmJiAhb3duZXIucGFyZW50ICYmICF0aGlzLnByZXNlbnRlZFZpZXdDb250cm9sbGVyKSB7XG4gICAgICAgICAgICBvd25lci5jYWxsVW5sb2FkZWQoKTtcbiAgICAgICAgICAgIG93bmVyLl90ZWFyRG93blVJKHRydWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUuYW5pbWF0ZVdpdGhEdXJhdGlvbiA9IGZ1bmN0aW9uIChuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmF0aXZlVHJhbnNpdGlvbiwgdHJhbnNpdGlvblR5cGUsIGJhc2VDYWxsYmFjaykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZHVyYXRpb24gPSBuYXZpZ2F0aW9uVHJhbnNpdGlvbi5kdXJhdGlvbiA/IG5hdmlnYXRpb25UcmFuc2l0aW9uLmR1cmF0aW9uIC8gMTAwMCA6IF9kZWZhdWx0VHJhbnNpdGlvbkR1cmF0aW9uO1xuICAgICAgICB2YXIgY3VydmUgPSBfZ2V0TmF0aXZlQ3VydmUobmF2aWdhdGlvblRyYW5zaXRpb24pO1xuICAgICAgICB2YXIgdHJhbnNpdGlvblRyYWNlZCA9IGZyYW1lX2NvbW1vbl8xLmlzQ2F0ZWdvcnlTZXQoZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICB2YXIgdHJhbnNpdGlvbkRlbGVnYXRlO1xuICAgICAgICBpZiAodHJhbnNpdGlvblRyYWNlZCkge1xuICAgICAgICAgICAgdmFyIGlkID0gX2dldFRyYW5zaXRpb25JZChuYXRpdmVUcmFuc2l0aW9uLCB0cmFuc2l0aW9uVHlwZSk7XG4gICAgICAgICAgICB0cmFuc2l0aW9uRGVsZWdhdGUgPSBUcmFuc2l0aW9uRGVsZWdhdGUuaW5pdFdpdGhPd25lcklkKGlkKTtcbiAgICAgICAgfVxuICAgICAgICBVSVZpZXcuYW5pbWF0ZVdpdGhEdXJhdGlvbkFuaW1hdGlvbnMoZHVyYXRpb24sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0cmFuc2l0aW9uVHJhY2VkKSB7XG4gICAgICAgICAgICAgICAgVUlWaWV3LnNldEFuaW1hdGlvbkRlbGVnYXRlKHRyYW5zaXRpb25EZWxlZ2F0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uV2lsbFN0YXJ0U2VsZWN0b3IoXCJhbmltYXRpb25XaWxsU3RhcnRcIik7XG4gICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uRGlkU3RvcFNlbGVjdG9yKFwiYW5pbWF0aW9uRGlkU3RvcFwiKTtcbiAgICAgICAgICAgIFVJVmlldy5zZXRBbmltYXRpb25DdXJ2ZShjdXJ2ZSk7XG4gICAgICAgICAgICBiYXNlQ2FsbGJhY2soKTtcbiAgICAgICAgICAgIFVJVmlldy5zZXRBbmltYXRpb25UcmFuc2l0aW9uRm9yVmlld0NhY2hlKG5hdGl2ZVRyYW5zaXRpb24sIF90aGlzLnZpZXcsIHRydWUpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZCA9IGZ1bmN0aW9uICh2aWV3Q29udHJvbGxlciwgYW5pbWF0ZWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gdmlld0NvbnRyb2xsZXJbVFJBTlNJVElPTl07XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnB1c2hWaWV3Q29udHJvbGxlckFuaW1hdGVkKFwiICsgdmlld0NvbnRyb2xsZXIgKyBcIiwgXCIgKyBhbmltYXRlZCArIFwiKTsgdHJhbnNpdGlvbjogXCIgKyBKU09OLnN0cmluZ2lmeShuYXZpZ2F0aW9uVHJhbnNpdGlvbiksIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVUcmFuc2l0aW9uID0gX2dldE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIHRydWUpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkIHx8ICFuYXZpZ2F0aW9uVHJhbnNpdGlvbiB8fCAhbmF0aXZlVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZC5jYWxsKHRoaXMsIHZpZXdDb250cm9sbGVyLCBhbmltYXRlZCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5hbmltYXRlV2l0aER1cmF0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBuYXRpdmVUcmFuc2l0aW9uLCBcInB1c2hcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5wdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZC5jYWxsKF90aGlzLCB2aWV3Q29udHJvbGxlciwgZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS5zZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZCA9IGZ1bmN0aW9uICh2aWV3Q29udHJvbGxlcnMsIGFuaW1hdGVkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB2aWV3Q29udHJvbGxlciA9IHZpZXdDb250cm9sbGVycy5sYXN0T2JqZWN0O1xuICAgICAgICB2YXIgbmF2aWdhdGlvblRyYW5zaXRpb24gPSB2aWV3Q29udHJvbGxlcltUUkFOU0lUSU9OXTtcbiAgICAgICAgaWYgKGZyYW1lX2NvbW1vbl8xLnRyYWNlRW5hYmxlZCgpKSB7XG4gICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGwuc2V0Vmlld0NvbnRyb2xsZXJzQW5pbWF0ZWQoXCIgKyB2aWV3Q29udHJvbGxlcnMgKyBcIiwgXCIgKyBhbmltYXRlZCArIFwiKTsgdHJhbnNpdGlvbjogXCIgKyBKU09OLnN0cmluZ2lmeShuYXZpZ2F0aW9uVHJhbnNpdGlvbiksIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5OYXRpdmVMaWZlY3ljbGUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYXRpdmVUcmFuc2l0aW9uID0gX2dldE5hdGl2ZVRyYW5zaXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIHRydWUpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkIHx8ICFuYXZpZ2F0aW9uVHJhbnNpdGlvbiB8fCAhbmF0aXZlVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZC5jYWxsKHRoaXMsIHZpZXdDb250cm9sbGVycywgYW5pbWF0ZWQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuYW5pbWF0ZVdpdGhEdXJhdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgbmF0aXZlVHJhbnNpdGlvbiwgXCJzZXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZC5jYWxsKF90aGlzLCB2aWV3Q29udHJvbGxlcnMsIGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUucG9wVmlld0NvbnRyb2xsZXJBbmltYXRlZCA9IGZ1bmN0aW9uIChhbmltYXRlZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgbGFzdFZpZXdDb250cm9sbGVyID0gdGhpcy52aWV3Q29udHJvbGxlcnMubGFzdE9iamVjdDtcbiAgICAgICAgdmFyIG5hdmlnYXRpb25UcmFuc2l0aW9uID0gbGFzdFZpZXdDb250cm9sbGVyW1RSQU5TSVRJT05dO1xuICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgIGZyYW1lX2NvbW1vbl8xLnRyYWNlV3JpdGUoXCJVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wb3BWaWV3Q29udHJvbGxlckFuaW1hdGVkKFwiICsgYW5pbWF0ZWQgKyBcIik7IHRyYW5zaXRpb246IFwiICsgSlNPTi5zdHJpbmdpZnkobmF2aWdhdGlvblRyYW5zaXRpb24pLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmF2aWdhdGlvblRyYW5zaXRpb24gJiYgbmF2aWdhdGlvblRyYW5zaXRpb24ubmFtZSA9PT0gTk9OX0FOSU1BVEVEX1RSQU5TSVRJT04pIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnBvcFZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbCh0aGlzLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZVRyYW5zaXRpb24gPSBfZ2V0TmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgZmFsc2UpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkIHx8ICFuYXZpZ2F0aW9uVHJhbnNpdGlvbiB8fCAhbmF0aXZlVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUucG9wVmlld0NvbnRyb2xsZXJBbmltYXRlZC5jYWxsKHRoaXMsIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFuaW1hdGVXaXRoRHVyYXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIG5hdGl2ZVRyYW5zaXRpb24sIFwicG9wXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF9zdXBlci5wcm90b3R5cGUucG9wVmlld0NvbnRyb2xsZXJBbmltYXRlZC5jYWxsKF90aGlzLCBmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZS5wb3BUb1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQgPSBmdW5jdGlvbiAodmlld0NvbnRyb2xsZXIsIGFuaW1hdGVkKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBsYXN0Vmlld0NvbnRyb2xsZXIgPSB0aGlzLnZpZXdDb250cm9sbGVycy5sYXN0T2JqZWN0O1xuICAgICAgICB2YXIgbmF2aWdhdGlvblRyYW5zaXRpb24gPSBsYXN0Vmlld0NvbnRyb2xsZXJbVFJBTlNJVElPTl07XG4gICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnBvcFRvVmlld0NvbnRyb2xsZXJBbmltYXRlZChcIiArIHZpZXdDb250cm9sbGVyICsgXCIsIFwiICsgYW5pbWF0ZWQgKyBcIik7IHRyYW5zaXRpb246IFwiICsgSlNPTi5zdHJpbmdpZnkobmF2aWdhdGlvblRyYW5zaXRpb24pLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuTmF0aXZlTGlmZWN5Y2xlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobmF2aWdhdGlvblRyYW5zaXRpb24gJiYgbmF2aWdhdGlvblRyYW5zaXRpb24ubmFtZSA9PT0gTk9OX0FOSU1BVEVEX1RSQU5TSVRJT04pIHtcbiAgICAgICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnBvcFRvVmlld0NvbnRyb2xsZXJBbmltYXRlZC5jYWxsKHRoaXMsIHZpZXdDb250cm9sbGVyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hdGl2ZVRyYW5zaXRpb24gPSBfZ2V0TmF0aXZlVHJhbnNpdGlvbihuYXZpZ2F0aW9uVHJhbnNpdGlvbiwgZmFsc2UpO1xuICAgICAgICBpZiAoIWFuaW1hdGVkIHx8ICFuYXZpZ2F0aW9uVHJhbnNpdGlvbiB8fCAhbmF0aXZlVHJhbnNpdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUucG9wVG9WaWV3Q29udHJvbGxlckFuaW1hdGVkLmNhbGwodGhpcywgdmlld0NvbnRyb2xsZXIsIGFuaW1hdGVkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFuaW1hdGVXaXRoRHVyYXRpb24obmF2aWdhdGlvblRyYW5zaXRpb24sIG5hdGl2ZVRyYW5zaXRpb24sIFwicG9wVG9cIiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5wb3BUb1ZpZXdDb250cm9sbGVyQW5pbWF0ZWQuY2FsbChfdGhpcywgdmlld0NvbnRyb2xsZXIsIGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUsIFwidmlld1dpbGxBcHBlYXJcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBVSU5hdmlnYXRpb25Db250cm9sbGVySW1wbC5wcm90b3R5cGUsIFwidmlld0RpZERpc2FwcGVhclwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZSwgXCJwdXNoVmlld0NvbnRyb2xsZXJBbmltYXRlZFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLnByb3RvdHlwZSwgXCJzZXRWaWV3Q29udHJvbGxlcnNBbmltYXRlZFwiLCBudWxsKTtcbiAgICByZXR1cm4gVUlOYXZpZ2F0aW9uQ29udHJvbGxlckltcGw7XG59KFVJTmF2aWdhdGlvbkNvbnRyb2xsZXIpKTtcbmZ1bmN0aW9uIF9nZXRUcmFuc2l0aW9uSWQobmF0aXZlVHJhbnNpdGlvbiwgdHJhbnNpdGlvblR5cGUpIHtcbiAgICB2YXIgbmFtZTtcbiAgICBzd2l0Y2ggKG5hdGl2ZVRyYW5zaXRpb24pIHtcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgbmFtZSA9IFwiQ3VybERvd25cIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBuYW1lID0gXCJDdXJsVXBcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBuYW1lID0gXCJGbGlwRnJvbUxlZnRcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBuYW1lID0gXCJGbGlwRnJvbVJpZ2h0XCI7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgbmFtZSA9IFwiTm9uZVwiO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiBuYW1lICsgXCIgXCIgKyB0cmFuc2l0aW9uVHlwZTtcbn1cbmZ1bmN0aW9uIF9nZXROYXRpdmVUcmFuc2l0aW9uKG5hdmlnYXRpb25UcmFuc2l0aW9uLCBwdXNoKSB7XG4gICAgaWYgKG5hdmlnYXRpb25UcmFuc2l0aW9uICYmIG5hdmlnYXRpb25UcmFuc2l0aW9uLm5hbWUpIHtcbiAgICAgICAgc3dpdGNoIChuYXZpZ2F0aW9uVHJhbnNpdGlvbi5uYW1lLnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJmbGlwXCI6XG4gICAgICAgICAgICBjYXNlIFwiZmxpcHJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIHB1c2ggPyAyIDogMTtcbiAgICAgICAgICAgIGNhc2UgXCJmbGlwbGVmdFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBwdXNoID8gMSA6IDI7XG4gICAgICAgICAgICBjYXNlIFwiY3VybFwiOlxuICAgICAgICAgICAgY2FzZSBcImN1cmx1cFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBwdXNoID8gMyA6IDQ7XG4gICAgICAgICAgICBjYXNlIFwiY3VybGRvd25cIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gcHVzaCA/IDQgOiAzO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gX2dldE5hdGl2ZUN1cnZlKHRyYW5zaXRpb24pIHtcbiAgICBpZiAodHJhbnNpdGlvbi5jdXJ2ZSkge1xuICAgICAgICBzd2l0Y2ggKHRyYW5zaXRpb24uY3VydmUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJlYXNlSW5cIjpcbiAgICAgICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlRyYW5zaXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gVUlWaWV3QW5pbWF0aW9uQ3VydmUuRWFzZUluLlwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgY2FzZSBcImVhc2VPdXRcIjpcbiAgICAgICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlRyYW5zaXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gVUlWaWV3QW5pbWF0aW9uQ3VydmUuRWFzZU91dC5cIiwgZnJhbWVfY29tbW9uXzEudHJhY2VDYXRlZ29yaWVzLlRyYW5zaXRpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgICAgIGNhc2UgXCJlYXNlSW5PdXRcIjpcbiAgICAgICAgICAgICAgICBpZiAoZnJhbWVfY29tbW9uXzEudHJhY2VFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJhbWVfY29tbW9uXzEudHJhY2VXcml0ZShcIlRyYW5zaXRpb24gY3VydmUgcmVzb2x2ZWQgdG8gVUlWaWV3QW5pbWF0aW9uQ3VydmUuRWFzZUluT3V0LlwiLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSBcImxpbmVhclwiOlxuICAgICAgICAgICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiVHJhbnNpdGlvbiBjdXJ2ZSByZXNvbHZlZCB0byBVSVZpZXdBbmltYXRpb25DdXJ2ZS5MaW5lYXIuXCIsIGZyYW1lX2NvbW1vbl8xLnRyYWNlQ2F0ZWdvcmllcy5UcmFuc2l0aW9uKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDM7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGlmIChmcmFtZV9jb21tb25fMS50cmFjZUVuYWJsZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICBmcmFtZV9jb21tb25fMS50cmFjZVdyaXRlKFwiVHJhbnNpdGlvbiBjdXJ2ZSByZXNvbHZlZCB0byBvcmlnaW5hbDogXCIgKyB0cmFuc2l0aW9uLmN1cnZlLCBmcmFtZV9jb21tb25fMS50cmFjZUNhdGVnb3JpZXMuVHJhbnNpdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB0cmFuc2l0aW9uLmN1cnZlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiAwO1xufVxuZXhwb3J0cy5fZ2V0TmF0aXZlQ3VydmUgPSBfZ2V0TmF0aXZlQ3VydmU7XG52YXIgaU9TRnJhbWUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGlPU0ZyYW1lKGZyYW1lKSB7XG4gICAgICAgIHRoaXMuX25hdkJhclZpc2liaWxpdHkgPSBcImF1dG9cIjtcbiAgICAgICAgdGhpcy5fY29udHJvbGxlciA9IFVJTmF2aWdhdGlvbkNvbnRyb2xsZXJJbXBsLmluaXRXaXRoT3duZXIobmV3IFdlYWtSZWYoZnJhbWUpKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGlPU0ZyYW1lLnByb3RvdHlwZSwgXCJjb250cm9sbGVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udHJvbGxlcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGlPU0ZyYW1lLnByb3RvdHlwZSwgXCJzaG93TmF2aWdhdGlvbkJhclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3Nob3dOYXZpZ2F0aW9uQmFyO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd05hdmlnYXRpb25CYXIgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIuc2V0TmF2aWdhdGlvbkJhckhpZGRlbkFuaW1hdGVkKCF2YWx1ZSwgIXRoaXMuX2Rpc2FibGVOYXZCYXJBbmltYXRpb24pO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoaU9TRnJhbWUucHJvdG90eXBlLCBcIm5hdkJhclZpc2liaWxpdHlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uYXZCYXJWaXNpYmlsaXR5O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fbmF2QmFyVmlzaWJpbGl0eSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gaU9TRnJhbWU7XG59KCkpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZnJhbWUuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBHZXN0dXJlVHlwZXM7XG4oZnVuY3Rpb24gKEdlc3R1cmVUeXBlcykge1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJ0YXBcIl0gPSAxXSA9IFwidGFwXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcImRvdWJsZVRhcFwiXSA9IDJdID0gXCJkb3VibGVUYXBcIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wicGluY2hcIl0gPSA0XSA9IFwicGluY2hcIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wicGFuXCJdID0gOF0gPSBcInBhblwiO1xuICAgIEdlc3R1cmVUeXBlc1tHZXN0dXJlVHlwZXNbXCJzd2lwZVwiXSA9IDE2XSA9IFwic3dpcGVcIjtcbiAgICBHZXN0dXJlVHlwZXNbR2VzdHVyZVR5cGVzW1wicm90YXRpb25cIl0gPSAzMl0gPSBcInJvdGF0aW9uXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcImxvbmdQcmVzc1wiXSA9IDY0XSA9IFwibG9uZ1ByZXNzXCI7XG4gICAgR2VzdHVyZVR5cGVzW0dlc3R1cmVUeXBlc1tcInRvdWNoXCJdID0gMTI4XSA9IFwidG91Y2hcIjtcbn0pKEdlc3R1cmVUeXBlcyA9IGV4cG9ydHMuR2VzdHVyZVR5cGVzIHx8IChleHBvcnRzLkdlc3R1cmVUeXBlcyA9IHt9KSk7XG52YXIgR2VzdHVyZVN0YXRlVHlwZXM7XG4oZnVuY3Rpb24gKEdlc3R1cmVTdGF0ZVR5cGVzKSB7XG4gICAgR2VzdHVyZVN0YXRlVHlwZXNbR2VzdHVyZVN0YXRlVHlwZXNbXCJjYW5jZWxsZWRcIl0gPSAwXSA9IFwiY2FuY2VsbGVkXCI7XG4gICAgR2VzdHVyZVN0YXRlVHlwZXNbR2VzdHVyZVN0YXRlVHlwZXNbXCJiZWdhblwiXSA9IDFdID0gXCJiZWdhblwiO1xuICAgIEdlc3R1cmVTdGF0ZVR5cGVzW0dlc3R1cmVTdGF0ZVR5cGVzW1wiY2hhbmdlZFwiXSA9IDJdID0gXCJjaGFuZ2VkXCI7XG4gICAgR2VzdHVyZVN0YXRlVHlwZXNbR2VzdHVyZVN0YXRlVHlwZXNbXCJlbmRlZFwiXSA9IDNdID0gXCJlbmRlZFwiO1xufSkoR2VzdHVyZVN0YXRlVHlwZXMgPSBleHBvcnRzLkdlc3R1cmVTdGF0ZVR5cGVzIHx8IChleHBvcnRzLkdlc3R1cmVTdGF0ZVR5cGVzID0ge30pKTtcbnZhciBTd2lwZURpcmVjdGlvbjtcbihmdW5jdGlvbiAoU3dpcGVEaXJlY3Rpb24pIHtcbiAgICBTd2lwZURpcmVjdGlvbltTd2lwZURpcmVjdGlvbltcInJpZ2h0XCJdID0gMV0gPSBcInJpZ2h0XCI7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJsZWZ0XCJdID0gMl0gPSBcImxlZnRcIjtcbiAgICBTd2lwZURpcmVjdGlvbltTd2lwZURpcmVjdGlvbltcInVwXCJdID0gNF0gPSBcInVwXCI7XG4gICAgU3dpcGVEaXJlY3Rpb25bU3dpcGVEaXJlY3Rpb25bXCJkb3duXCJdID0gOF0gPSBcImRvd25cIjtcbn0pKFN3aXBlRGlyZWN0aW9uID0gZXhwb3J0cy5Td2lwZURpcmVjdGlvbiB8fCAoZXhwb3J0cy5Td2lwZURpcmVjdGlvbiA9IHt9KSk7XG52YXIgVG91Y2hBY3Rpb247XG4oZnVuY3Rpb24gKFRvdWNoQWN0aW9uKSB7XG4gICAgVG91Y2hBY3Rpb24uZG93biA9IFwiZG93blwiO1xuICAgIFRvdWNoQWN0aW9uLnVwID0gXCJ1cFwiO1xuICAgIFRvdWNoQWN0aW9uLm1vdmUgPSBcIm1vdmVcIjtcbiAgICBUb3VjaEFjdGlvbi5jYW5jZWwgPSBcImNhbmNlbFwiO1xufSkoVG91Y2hBY3Rpb24gPSBleHBvcnRzLlRvdWNoQWN0aW9uIHx8IChleHBvcnRzLlRvdWNoQWN0aW9uID0ge30pKTtcbmZ1bmN0aW9uIHRvU3RyaW5nKHR5cGUsIHNlcGFyYXRvcikge1xuICAgIHZhciB0eXBlcyA9IG5ldyBBcnJheSgpO1xuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLnRhcCkge1xuICAgICAgICB0eXBlcy5wdXNoKFwidGFwXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5kb3VibGVUYXApIHtcbiAgICAgICAgdHlwZXMucHVzaChcImRvdWJsZVRhcFwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMucGluY2gpIHtcbiAgICAgICAgdHlwZXMucHVzaChcInBpbmNoXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5wYW4pIHtcbiAgICAgICAgdHlwZXMucHVzaChcInBhblwiKTtcbiAgICB9XG4gICAgaWYgKHR5cGUgJiBHZXN0dXJlVHlwZXMuc3dpcGUpIHtcbiAgICAgICAgdHlwZXMucHVzaChcInN3aXBlXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy5yb3RhdGlvbikge1xuICAgICAgICB0eXBlcy5wdXNoKFwicm90YXRpb25cIik7XG4gICAgfVxuICAgIGlmICh0eXBlICYgR2VzdHVyZVR5cGVzLmxvbmdQcmVzcykge1xuICAgICAgICB0eXBlcy5wdXNoKFwibG9uZ1ByZXNzXCIpO1xuICAgIH1cbiAgICBpZiAodHlwZSAmIEdlc3R1cmVUeXBlcy50b3VjaCkge1xuICAgICAgICB0eXBlcy5wdXNoKFwidG91Y2hcIik7XG4gICAgfVxuICAgIHJldHVybiB0eXBlcy5qb2luKHNlcGFyYXRvcik7XG59XG5leHBvcnRzLnRvU3RyaW5nID0gdG9TdHJpbmc7XG5mdW5jdGlvbiBmcm9tU3RyaW5nKHR5cGUpIHtcbiAgICB2YXIgdCA9IHR5cGUudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKHQgPT09IFwidGFwXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy50YXA7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwiZG91YmxldGFwXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5kb3VibGVUYXA7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwicGluY2hcIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnBpbmNoO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInBhblwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMucGFuO1xuICAgIH1cbiAgICBlbHNlIGlmICh0ID09PSBcInN3aXBlXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5zd2lwZTtcbiAgICB9XG4gICAgZWxzZSBpZiAodCA9PT0gXCJyb3RhdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBHZXN0dXJlVHlwZXMucm90YXRpb247XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwibG9uZ3ByZXNzXCIpIHtcbiAgICAgICAgcmV0dXJuIEdlc3R1cmVUeXBlcy5sb25nUHJlc3M7XG4gICAgfVxuICAgIGVsc2UgaWYgKHQgPT09IFwidG91Y2hcIikge1xuICAgICAgICByZXR1cm4gR2VzdHVyZVR5cGVzLnRvdWNoO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufVxuZXhwb3J0cy5mcm9tU3RyaW5nID0gZnJvbVN0cmluZztcbnZhciBHZXN0dXJlc09ic2VydmVyQmFzZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gR2VzdHVyZXNPYnNlcnZlckJhc2UodGFyZ2V0LCBjYWxsYmFjaywgY29udGV4dCkge1xuICAgICAgICB0aGlzLl90YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIHRoaXMuX2NvbnRleHQgPSBjb250ZXh0O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLCBcImNhbGxiYWNrXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY2FsbGJhY2s7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShHZXN0dXJlc09ic2VydmVyQmFzZS5wcm90b3R5cGUsIFwidGFyZ2V0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGFyZ2V0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VzdHVyZXNPYnNlcnZlckJhc2UucHJvdG90eXBlLCBcImNvbnRleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBHZXN0dXJlc09ic2VydmVyQmFzZS5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMudGFyZ2V0LmdldEdlc3R1cmVPYnNlcnZlcnModGhpcy50eXBlKTtcbiAgICAgICAgICAgIGlmIChsaXN0ICYmIGxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlzdFtpXS5jYWxsYmFjayA9PT0gdGhpcy5jYWxsYmFjaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGlzdC5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0Ll9nZXN0dXJlT2JzZXJ2ZXJzW3RoaXMudHlwZV0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMudGFyZ2V0Ll9nZXN0dXJlT2JzZXJ2ZXJzW3RoaXMudHlwZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fdGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBudWxsO1xuICAgICAgICB0aGlzLl9jb250ZXh0ID0gbnVsbDtcbiAgICB9O1xuICAgIHJldHVybiBHZXN0dXJlc09ic2VydmVyQmFzZTtcbn0oKSk7XG5leHBvcnRzLkdlc3R1cmVzT2JzZXJ2ZXJCYXNlID0gR2VzdHVyZXNPYnNlcnZlckJhc2U7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXN0dXJlcy1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBnZXN0dXJlc19jb21tb25fMSA9IHJlcXVpcmUoXCIuL2dlc3R1cmVzLWNvbW1vblwiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL2dlc3R1cmVzLWNvbW1vblwiKSk7XG5mdW5jdGlvbiBvYnNlcnZlKHRhcmdldCwgdHlwZSwgY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICB2YXIgb2JzZXJ2ZXIgPSBuZXcgR2VzdHVyZXNPYnNlcnZlcih0YXJnZXQsIGNhbGxiYWNrLCBjb250ZXh0KTtcbiAgICBvYnNlcnZlci5vYnNlcnZlKHR5cGUpO1xuICAgIHJldHVybiBvYnNlcnZlcjtcbn1cbmV4cG9ydHMub2JzZXJ2ZSA9IG9ic2VydmU7XG52YXIgVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJR2VzdHVyZVJlY29nbml6ZXJEZWxlZ2F0ZUltcGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSUdlc3R1cmVSZWNvZ25pemVyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5nZXN0dXJlUmVjb2duaXplclNob3VsZFJlY29nbml6ZVNpbXVsdGFuZW91c2x5V2l0aEdlc3R1cmVSZWNvZ25pemVyID0gZnVuY3Rpb24gKGdlc3R1cmVSZWNvZ25pemVyLCBvdGhlckdlc3R1cmVSZWNvZ25pemVyKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuZ2VzdHVyZVJlY29nbml6ZXJTaG91bGRSZXF1aXJlRmFpbHVyZU9mR2VzdHVyZVJlY29nbml6ZXIgPSBmdW5jdGlvbiAoZ2VzdHVyZVJlY29nbml6ZXIsIG90aGVyR2VzdHVyZVJlY29nbml6ZXIpIHtcbiAgICAgICAgaWYgKGdlc3R1cmVSZWNvZ25pemVyIGluc3RhbmNlb2YgVUlUYXBHZXN0dXJlUmVjb2duaXplclxuICAgICAgICAgICAgJiYgb3RoZXJHZXN0dXJlUmVjb2duaXplciBpbnN0YW5jZW9mIFVJVGFwR2VzdHVyZVJlY29nbml6ZXJcbiAgICAgICAgICAgICYmIG90aGVyR2VzdHVyZVJlY29nbml6ZXIubnVtYmVyT2ZUYXBzUmVxdWlyZWQgPT09IDIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFVJR2VzdHVyZVJlY29nbml6ZXJEZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSUdlc3R1cmVSZWNvZ25pemVyRGVsZWdhdGVdO1xuICAgIHJldHVybiBVSUdlc3R1cmVSZWNvZ25pemVyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xudmFyIHJlY29nbml6ZXJEZWxlZ2F0ZUluc3RhbmNlID0gVUlHZXN0dXJlUmVjb2duaXplckRlbGVnYXRlSW1wbC5uZXcoKTtcbnZhciBVSUdlc3R1cmVSZWNvZ25pemVySW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJR2VzdHVyZVJlY29nbml6ZXJJbXBsLmluaXRXaXRoT3duZXJUeXBlQ2FsbGJhY2sgPSBmdW5jdGlvbiAob3duZXIsIHR5cGUsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgICAgIHZhciBoYW5kbGVyID0gVUlHZXN0dXJlUmVjb2duaXplckltcGwubmV3KCk7XG4gICAgICAgIGhhbmRsZXIuX293bmVyID0gb3duZXI7XG4gICAgICAgIGhhbmRsZXIuX3R5cGUgPSB0eXBlO1xuICAgICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGhhbmRsZXIuX2NhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXNBcmcpIHtcbiAgICAgICAgICAgIGhhbmRsZXIuX2NvbnRleHQgPSB0aGlzQXJnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBoYW5kbGVyO1xuICAgIH07XG4gICAgVUlHZXN0dXJlUmVjb2duaXplckltcGwucHJvdG90eXBlLnJlY29nbml6ZSA9IGZ1bmN0aW9uIChyZWNvZ25pemVyKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSB0aGlzLl9jYWxsYmFjayA/IHRoaXMuX2NhbGxiYWNrIDogKG93bmVyID8gb3duZXIuY2FsbGJhY2sgOiBudWxsKTtcbiAgICAgICAgdmFyIHR5cGVQYXJhbSA9IHRoaXMuX3R5cGU7XG4gICAgICAgIHZhciB0YXJnZXQgPSBvd25lciA/IG93bmVyLnRhcmdldCA6IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGFyZ3MgPSB7XG4gICAgICAgICAgICB0eXBlOiB0eXBlUGFyYW0sXG4gICAgICAgICAgICB2aWV3OiB0YXJnZXQsXG4gICAgICAgICAgICBpb3M6IHJlY29nbml6ZXIsXG4gICAgICAgICAgICBhbmRyb2lkOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBvYmplY3Q6IHRhcmdldCxcbiAgICAgICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcodHlwZVBhcmFtKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBjYWxsYmFjay5jYWxsKHRoaXMuX2NvbnRleHQsIGFyZ3MpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSUdlc3R1cmVSZWNvZ25pemVySW1wbC5PYmpDRXhwb3NlZE1ldGhvZHMgPSB7XG4gICAgICAgIFwicmVjb2duaXplXCI6IHsgcmV0dXJuczogaW50ZXJvcC50eXBlcy52b2lkLCBwYXJhbXM6IFtVSUdlc3R1cmVSZWNvZ25pemVyXSB9XG4gICAgfTtcbiAgICByZXR1cm4gVUlHZXN0dXJlUmVjb2duaXplckltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgR2VzdHVyZXNPYnNlcnZlciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEdlc3R1cmVzT2JzZXJ2ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gR2VzdHVyZXNPYnNlcnZlcih0YXJnZXQsIGNhbGxiYWNrLCBjb250ZXh0KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHRhcmdldCwgY2FsbGJhY2ssIGNvbnRleHQpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLl9yZWNvZ25pemVycyA9IHt9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLmFuZHJvaWRPblRvdWNoRXZlbnQgPSBmdW5jdGlvbiAobW90aW9uRXZlbnQpIHtcbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLm9ic2VydmUgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy50YXJnZXQpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHR5cGU7XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldExvYWRlZCA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2F0dGFjaChfdGhpcy50YXJnZXQsIHR5cGUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuX29uVGFyZ2V0VW5sb2FkZWQgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICAgICAgICAgIF90aGlzLl9kZXRhY2goKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5vbihcImxvYWRlZFwiLCB0aGlzLl9vblRhcmdldExvYWRlZCk7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5vbihcInVubG9hZGVkXCIsIHRoaXMuX29uVGFyZ2V0VW5sb2FkZWQpO1xuICAgICAgICAgICAgaWYgKHRoaXMudGFyZ2V0LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXR0YWNoKHRoaXMudGFyZ2V0LCB0eXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgR2VzdHVyZXNPYnNlcnZlci5wcm90b3R5cGUuX2F0dGFjaCA9IGZ1bmN0aW9uICh0YXJnZXQsIHR5cGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fZGV0YWNoKCk7XG4gICAgICAgIGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQgJiYgdGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQuYWRkR2VzdHVyZVJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGFyZ2V0Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50YXApIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmFkZEdlc3R1cmVSZWNvZ25pemVyKHRoaXMuX2NyZWF0ZVJlY29nbml6ZXIoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRhcCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuZG91YmxlVGFwKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5kb3VibGVUYXApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBpbmNoKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5waW5jaCwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2V4ZWN1dGVDYWxsYmFjayhfZ2V0UGluY2hEYXRhKGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5wYW4pIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmFkZEdlc3R1cmVSZWNvZ25pemVyKHRoaXMuX2NyZWF0ZVJlY29nbml6ZXIoZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBhbiwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2V4ZWN1dGVDYWxsYmFjayhfZ2V0UGFuRGF0YShhcmdzLCB0YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnN3aXBlKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2V4ZWN1dGVDYWxsYmFjayhfZ2V0U3dpcGVEYXRhKGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9LCA4KSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2V4ZWN1dGVDYWxsYmFjayhfZ2V0U3dpcGVEYXRhKGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9LCAyKSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2V4ZWN1dGVDYWxsYmFjayhfZ2V0U3dpcGVEYXRhKGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9LCAxKSk7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5zd2lwZSwgZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2V4ZWN1dGVDYWxsYmFjayhfZ2V0U3dpcGVEYXRhKGFyZ3MpKTtcbiAgICAgICAgICAgICAgICB9LCA0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZSAmIGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5yb3RhdGlvbikge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcuYWRkR2VzdHVyZVJlY29nbml6ZXIodGhpcy5fY3JlYXRlUmVjb2duaXplcihnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucm90YXRpb24sIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9leGVjdXRlQ2FsbGJhY2soX2dldFJvdGF0aW9uRGF0YShhcmdzKSk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGUgJiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMubG9uZ1ByZXNzKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5sb25nUHJlc3MpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlICYgZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnRvdWNoKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5hZGRHZXN0dXJlUmVjb2duaXplcih0aGlzLl9jcmVhdGVSZWNvZ25pemVyKGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50b3VjaCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5fZGV0YWNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy50YXJnZXQgJiYgdGhpcy50YXJnZXQubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgZm9yICh2YXIgbmFtZV8xIGluIHRoaXMuX3JlY29nbml6ZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JlY29nbml6ZXJzLmhhc093blByb3BlcnR5KG5hbWVfMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLl9yZWNvZ25pemVyc1tuYW1lXzFdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhcmdldC5uYXRpdmVWaWV3UHJvdGVjdGVkLnJlbW92ZUdlc3R1cmVSZWNvZ25pemVyKGl0ZW0ucmVjb2duaXplcik7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucmVjb2duaXplciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0udGFyZ2V0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZWNvZ25pemVycyA9IHt9O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBHZXN0dXJlc09ic2VydmVyLnByb3RvdHlwZS5kaXNjb25uZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9kZXRhY2goKTtcbiAgICAgICAgaWYgKHRoaXMudGFyZ2V0KSB7XG4gICAgICAgICAgICB0aGlzLnRhcmdldC5vZmYoXCJsb2FkZWRcIiwgdGhpcy5fb25UYXJnZXRMb2FkZWQpO1xuICAgICAgICAgICAgdGhpcy50YXJnZXQub2ZmKFwidW5sb2FkZWRcIiwgdGhpcy5fb25UYXJnZXRVbmxvYWRlZCk7XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldExvYWRlZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblRhcmdldFVubG9hZGVkID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmRpc2Nvbm5lY3QuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLl9leGVjdXRlQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICBpZiAodGhpcy5jYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFjay5jYWxsKHRoaXMuY29udGV4dCwgYXJncyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEdlc3R1cmVzT2JzZXJ2ZXIucHJvdG90eXBlLl9jcmVhdGVSZWNvZ25pemVyID0gZnVuY3Rpb24gKHR5cGUsIGNhbGxiYWNrLCBzd2lwZURpcmVjdGlvbikge1xuICAgICAgICB2YXIgcmVjb2duaXplcjtcbiAgICAgICAgdmFyIG5hbWUgPSBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyh0eXBlKTtcbiAgICAgICAgdmFyIHRhcmdldCA9IF9jcmVhdGVVSUdlc3R1cmVSZWNvZ25pemVyVGFyZ2V0KHRoaXMsIHR5cGUsIGNhbGxiYWNrLCB0aGlzLmNvbnRleHQpO1xuICAgICAgICB2YXIgcmVjb2duaXplclR5cGUgPSBfZ2V0VUlHZXN0dXJlUmVjb2duaXplclR5cGUodHlwZSk7XG4gICAgICAgIGlmIChyZWNvZ25pemVyVHlwZSkge1xuICAgICAgICAgICAgcmVjb2duaXplciA9IHJlY29nbml6ZXJUeXBlLmFsbG9jKCkuaW5pdFdpdGhUYXJnZXRBY3Rpb24odGFyZ2V0LCBcInJlY29nbml6ZVwiKTtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuc3dpcGUgJiYgc3dpcGVEaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBuYW1lID0gbmFtZSArIHN3aXBlRGlyZWN0aW9uLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgcmVjb2duaXplci5kaXJlY3Rpb24gPSBzd2lwZURpcmVjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHR5cGUgPT09IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy50b3VjaCkge1xuICAgICAgICAgICAgICAgIHJlY29nbml6ZXIub2JzZXJ2ZXIgPSB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLmRvdWJsZVRhcCkge1xuICAgICAgICAgICAgICAgIHJlY29nbml6ZXIubnVtYmVyT2ZUYXBzUmVxdWlyZWQgPSAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlY29nbml6ZXIpIHtcbiAgICAgICAgICAgICAgICByZWNvZ25pemVyLmRlbGVnYXRlID0gcmVjb2duaXplckRlbGVnYXRlSW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVjb2duaXplcnNbbmFtZV0gPSB7IHJlY29nbml6ZXI6IHJlY29nbml6ZXIsIHRhcmdldDogdGFyZ2V0IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlY29nbml6ZXI7XG4gICAgfTtcbiAgICByZXR1cm4gR2VzdHVyZXNPYnNlcnZlcjtcbn0oZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZXNPYnNlcnZlckJhc2UpKTtcbmV4cG9ydHMuR2VzdHVyZXNPYnNlcnZlciA9IEdlc3R1cmVzT2JzZXJ2ZXI7XG5mdW5jdGlvbiBfY3JlYXRlVUlHZXN0dXJlUmVjb2duaXplclRhcmdldChvd25lciwgdHlwZSwgY2FsbGJhY2ssIGNvbnRleHQpIHtcbiAgICByZXR1cm4gVUlHZXN0dXJlUmVjb2duaXplckltcGwuaW5pdFdpdGhPd25lclR5cGVDYWxsYmFjayhuZXcgV2Vha1JlZihvd25lciksIHR5cGUsIGNhbGxiYWNrLCBjb250ZXh0KTtcbn1cbmZ1bmN0aW9uIF9nZXRVSUdlc3R1cmVSZWNvZ25pemVyVHlwZSh0eXBlKSB7XG4gICAgdmFyIG5hdGl2ZVR5cGUgPSBudWxsO1xuICAgIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudGFwKSB7XG4gICAgICAgIG5hdGl2ZVR5cGUgPSBVSVRhcEdlc3R1cmVSZWNvZ25pemVyO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMuZG91YmxlVGFwKSB7XG4gICAgICAgIG5hdGl2ZVR5cGUgPSBVSVRhcEdlc3R1cmVSZWNvZ25pemVyO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMucGluY2gpIHtcbiAgICAgICAgbmF0aXZlVHlwZSA9IFVJUGluY2hHZXN0dXJlUmVjb2duaXplcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnBhbikge1xuICAgICAgICBuYXRpdmVUeXBlID0gVUlQYW5HZXN0dXJlUmVjb2duaXplcjtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZSA9PT0gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVR5cGVzLnN3aXBlKSB7XG4gICAgICAgIG5hdGl2ZVR5cGUgPSBVSVN3aXBlR2VzdHVyZVJlY29nbml6ZXI7XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGUgPT09IGdlc3R1cmVzX2NvbW1vbl8xLkdlc3R1cmVUeXBlcy5yb3RhdGlvbikge1xuICAgICAgICBuYXRpdmVUeXBlID0gVUlSb3RhdGlvbkdlc3R1cmVSZWNvZ25pemVyO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMubG9uZ1ByZXNzKSB7XG4gICAgICAgIG5hdGl2ZVR5cGUgPSBVSUxvbmdQcmVzc0dlc3R1cmVSZWNvZ25pemVyO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlID09PSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2gpIHtcbiAgICAgICAgbmF0aXZlVHlwZSA9IFRvdWNoR2VzdHVyZVJlY29nbml6ZXI7XG4gICAgfVxuICAgIHJldHVybiBuYXRpdmVUeXBlO1xufVxuZnVuY3Rpb24gZ2V0U3RhdGUocmVjb2duaXplcikge1xuICAgIGlmIChyZWNvZ25pemVyLnN0YXRlID09PSAxKSB7XG4gICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5iZWdhbjtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVjb2duaXplci5zdGF0ZSA9PT0gNCkge1xuICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuR2VzdHVyZVN0YXRlVHlwZXMuY2FuY2VsbGVkO1xuICAgIH1cbiAgICBlbHNlIGlmIChyZWNvZ25pemVyLnN0YXRlID09PSAyKSB7XG4gICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5jaGFuZ2VkO1xuICAgIH1cbiAgICBlbHNlIGlmIChyZWNvZ25pemVyLnN0YXRlID09PSAzKSB7XG4gICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlU3RhdGVUeXBlcy5lbmRlZDtcbiAgICB9XG59XG5mdW5jdGlvbiBfZ2V0U3dpcGVEaXJlY3Rpb24oZGlyZWN0aW9uKSB7XG4gICAgaWYgKGRpcmVjdGlvbiA9PT0gOCkge1xuICAgICAgICByZXR1cm4gZ2VzdHVyZXNfY29tbW9uXzEuU3dpcGVEaXJlY3Rpb24uZG93bjtcbiAgICB9XG4gICAgZWxzZSBpZiAoZGlyZWN0aW9uID09PSAyKSB7XG4gICAgICAgIHJldHVybiBnZXN0dXJlc19jb21tb25fMS5Td2lwZURpcmVjdGlvbi5sZWZ0O1xuICAgIH1cbiAgICBlbHNlIGlmIChkaXJlY3Rpb24gPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLlN3aXBlRGlyZWN0aW9uLnJpZ2h0O1xuICAgIH1cbiAgICBlbHNlIGlmIChkaXJlY3Rpb24gPT09IDQpIHtcbiAgICAgICAgcmV0dXJuIGdlc3R1cmVzX2NvbW1vbl8xLlN3aXBlRGlyZWN0aW9uLnVwO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9nZXRQaW5jaERhdGEoYXJncykge1xuICAgIHZhciByZWNvZ25pemVyID0gYXJncy5pb3M7XG4gICAgdmFyIGNlbnRlciA9IHJlY29nbml6ZXIubG9jYXRpb25JblZpZXcoYXJncy52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IGFyZ3MudHlwZSxcbiAgICAgICAgdmlldzogYXJncy52aWV3LFxuICAgICAgICBpb3M6IGFyZ3MuaW9zLFxuICAgICAgICBhbmRyb2lkOiB1bmRlZmluZWQsXG4gICAgICAgIHNjYWxlOiByZWNvZ25pemVyLnNjYWxlLFxuICAgICAgICBnZXRGb2N1c1g6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNlbnRlci54OyB9LFxuICAgICAgICBnZXRGb2N1c1k6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGNlbnRlci55OyB9LFxuICAgICAgICBvYmplY3Q6IGFyZ3MudmlldyxcbiAgICAgICAgZXZlbnROYW1lOiBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyhhcmdzLnR5cGUpLFxuICAgICAgICBzdGF0ZTogZ2V0U3RhdGUocmVjb2duaXplcilcbiAgICB9O1xufVxuZnVuY3Rpb24gX2dldFN3aXBlRGF0YShhcmdzKSB7XG4gICAgdmFyIHJlY29nbml6ZXIgPSBhcmdzLmlvcztcbiAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiBhcmdzLnR5cGUsXG4gICAgICAgIHZpZXc6IGFyZ3MudmlldyxcbiAgICAgICAgaW9zOiBhcmdzLmlvcyxcbiAgICAgICAgYW5kcm9pZDogdW5kZWZpbmVkLFxuICAgICAgICBkaXJlY3Rpb246IF9nZXRTd2lwZURpcmVjdGlvbihyZWNvZ25pemVyLmRpcmVjdGlvbiksXG4gICAgICAgIG9iamVjdDogYXJncy52aWV3LFxuICAgICAgICBldmVudE5hbWU6IGdlc3R1cmVzX2NvbW1vbl8xLnRvU3RyaW5nKGFyZ3MudHlwZSksXG4gICAgfTtcbn1cbmZ1bmN0aW9uIF9nZXRQYW5EYXRhKGFyZ3MsIHZpZXcpIHtcbiAgICB2YXIgcmVjb2duaXplciA9IGFyZ3MuaW9zO1xuICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6IGFyZ3MudHlwZSxcbiAgICAgICAgdmlldzogYXJncy52aWV3LFxuICAgICAgICBpb3M6IGFyZ3MuaW9zLFxuICAgICAgICBhbmRyb2lkOiB1bmRlZmluZWQsXG4gICAgICAgIGRlbHRhWDogcmVjb2duaXplci50cmFuc2xhdGlvbkluVmlldyh2aWV3KS54LFxuICAgICAgICBkZWx0YVk6IHJlY29nbml6ZXIudHJhbnNsYXRpb25JblZpZXcodmlldykueSxcbiAgICAgICAgb2JqZWN0OiBhcmdzLnZpZXcsXG4gICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoYXJncy50eXBlKSxcbiAgICAgICAgc3RhdGU6IGdldFN0YXRlKHJlY29nbml6ZXIpXG4gICAgfTtcbn1cbmZ1bmN0aW9uIF9nZXRSb3RhdGlvbkRhdGEoYXJncykge1xuICAgIHZhciByZWNvZ25pemVyID0gYXJncy5pb3M7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogYXJncy50eXBlLFxuICAgICAgICB2aWV3OiBhcmdzLnZpZXcsXG4gICAgICAgIGlvczogYXJncy5pb3MsXG4gICAgICAgIGFuZHJvaWQ6IHVuZGVmaW5lZCxcbiAgICAgICAgcm90YXRpb246IHJlY29nbml6ZXIucm90YXRpb24gKiAoMTgwLjAgLyBNYXRoLlBJKSxcbiAgICAgICAgb2JqZWN0OiBhcmdzLnZpZXcsXG4gICAgICAgIGV2ZW50TmFtZTogZ2VzdHVyZXNfY29tbW9uXzEudG9TdHJpbmcoYXJncy50eXBlKSxcbiAgICAgICAgc3RhdGU6IGdldFN0YXRlKHJlY29nbml6ZXIpXG4gICAgfTtcbn1cbnZhciBUb3VjaEdlc3R1cmVSZWNvZ25pemVyID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVG91Y2hHZXN0dXJlUmVjb2duaXplciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUb3VjaEdlc3R1cmVSZWNvZ25pemVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRvdWNoR2VzdHVyZVJlY29nbml6ZXIucHJvdG90eXBlLnRvdWNoZXNCZWdhbldpdGhFdmVudCA9IGZ1bmN0aW9uICh0b3VjaGVzLCBldmVudCkge1xuICAgICAgICB0aGlzLmV4ZWN1dGVDYWxsYmFjayhnZXN0dXJlc19jb21tb25fMS5Ub3VjaEFjdGlvbi5kb3duLCB0b3VjaGVzLCBldmVudCk7XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy50b3VjaGVzQmVnYW5XaXRoRXZlbnQodG91Y2hlcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVSZWNvZ25pemVyLnByb3RvdHlwZS50b3VjaGVzTW92ZWRXaXRoRXZlbnQgPSBmdW5jdGlvbiAodG91Y2hlcywgZXZlbnQpIHtcbiAgICAgICAgdGhpcy5leGVjdXRlQ2FsbGJhY2soZ2VzdHVyZXNfY29tbW9uXzEuVG91Y2hBY3Rpb24ubW92ZSwgdG91Y2hlcywgZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudG91Y2hlc01vdmVkV2l0aEV2ZW50KHRvdWNoZXMsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVG91Y2hHZXN0dXJlUmVjb2duaXplci5wcm90b3R5cGUudG91Y2hlc0VuZGVkV2l0aEV2ZW50ID0gZnVuY3Rpb24gKHRvdWNoZXMsIGV2ZW50KSB7XG4gICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGdlc3R1cmVzX2NvbW1vbl8xLlRvdWNoQWN0aW9uLnVwLCB0b3VjaGVzLCBldmVudCk7XG4gICAgICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgICAgICAgIHRoaXMudmlldy50b3VjaGVzRW5kZWRXaXRoRXZlbnQodG91Y2hlcywgZXZlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVSZWNvZ25pemVyLnByb3RvdHlwZS50b3VjaGVzQ2FuY2VsbGVkV2l0aEV2ZW50ID0gZnVuY3Rpb24gKHRvdWNoZXMsIGV2ZW50KSB7XG4gICAgICAgIHRoaXMuZXhlY3V0ZUNhbGxiYWNrKGdlc3R1cmVzX2NvbW1vbl8xLlRvdWNoQWN0aW9uLmNhbmNlbCwgdG91Y2hlcywgZXZlbnQpO1xuICAgICAgICBpZiAodGhpcy52aWV3KSB7XG4gICAgICAgICAgICB0aGlzLnZpZXcudG91Y2hlc0NhbmNlbGxlZFdpdGhFdmVudCh0b3VjaGVzLCBldmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRvdWNoR2VzdHVyZVJlY29nbml6ZXIucHJvdG90eXBlLmV4ZWN1dGVDYWxsYmFjayA9IGZ1bmN0aW9uIChhY3Rpb24sIHRvdWNoZXMsIGV2ZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5fZXZlbnREYXRhKSB7XG4gICAgICAgICAgICB0aGlzLl9ldmVudERhdGEgPSBuZXcgVG91Y2hHZXN0dXJlRXZlbnREYXRhKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZXZlbnREYXRhLnByZXBhcmUodGhpcy5vYnNlcnZlci50YXJnZXQsIGFjdGlvbiwgdG91Y2hlcywgZXZlbnQpO1xuICAgICAgICB0aGlzLm9ic2VydmVyLl9leGVjdXRlQ2FsbGJhY2sodGhpcy5fZXZlbnREYXRhKTtcbiAgICB9O1xuICAgIHJldHVybiBUb3VjaEdlc3R1cmVSZWNvZ25pemVyO1xufShVSUdlc3R1cmVSZWNvZ25pemVyKSk7XG52YXIgUG9pbnRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUG9pbnRlcih0b3VjaCwgdGFyZ2V0Vmlldykge1xuICAgICAgICB0aGlzLmFuZHJvaWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuaW9zID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLmlvcyA9IHRvdWNoO1xuICAgICAgICB0aGlzLl92aWV3ID0gdGFyZ2V0VmlldztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBvaW50ZXIucHJvdG90eXBlLCBcImxvY2F0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2xvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9jYXRpb24gPSB0aGlzLmlvcy5sb2NhdGlvbkluVmlldyh0aGlzLl92aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvY2F0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQb2ludGVyLnByb3RvdHlwZS5nZXRYID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5sb2NhdGlvbi54O1xuICAgIH07XG4gICAgUG9pbnRlci5wcm90b3R5cGUuZ2V0WSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYXRpb24ueTtcbiAgICB9O1xuICAgIHJldHVybiBQb2ludGVyO1xufSgpKTtcbnZhciBUb3VjaEdlc3R1cmVFdmVudERhdGEgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRvdWNoR2VzdHVyZUV2ZW50RGF0YSgpIHtcbiAgICAgICAgdGhpcy5ldmVudE5hbWUgPSBnZXN0dXJlc19jb21tb25fMS50b1N0cmluZyhnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2gpO1xuICAgICAgICB0aGlzLnR5cGUgPSBnZXN0dXJlc19jb21tb25fMS5HZXN0dXJlVHlwZXMudG91Y2g7XG4gICAgICAgIHRoaXMuYW5kcm9pZCA9IHVuZGVmaW5lZDtcbiAgICB9XG4gICAgVG91Y2hHZXN0dXJlRXZlbnREYXRhLnByb3RvdHlwZS5wcmVwYXJlID0gZnVuY3Rpb24gKHZpZXcsIGFjdGlvbiwgdG91Y2hlcywgZXZlbnQpIHtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSBhY3Rpb247XG4gICAgICAgIHRoaXMudmlldyA9IHZpZXc7XG4gICAgICAgIHRoaXMub2JqZWN0ID0gdmlldztcbiAgICAgICAgdGhpcy5pb3MgPSB7XG4gICAgICAgICAgICB0b3VjaGVzOiB0b3VjaGVzLFxuICAgICAgICAgICAgZXZlbnQ6IGV2ZW50XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX21haW5Qb2ludGVyID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9hY3RpdmVQb2ludGVycyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fYWxsUG9pbnRlcnMgPSB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldFBvaW50ZXJDb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW9zLmV2ZW50LmFsbFRvdWNoZXMuY291bnQ7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldE1haW5Qb2ludGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fbWFpblBvaW50ZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdGhpcy5fbWFpblBvaW50ZXIgPSB0aGlzLmlvcy50b3VjaGVzLmFueU9iamVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9tYWluUG9pbnRlcjtcbiAgICB9O1xuICAgIFRvdWNoR2VzdHVyZUV2ZW50RGF0YS5wcm90b3R5cGUuZ2V0QWN0aXZlUG9pbnRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5fYWN0aXZlUG9pbnRlcnMpIHtcbiAgICAgICAgICAgIHRoaXMuX2FjdGl2ZVBvaW50ZXJzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbnNBcnIgPSB0aGlzLmlvcy50b3VjaGVzLmFsbE9iamVjdHM7IGkgPCBuc0Fyci5jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWN0aXZlUG9pbnRlcnMucHVzaChuZXcgUG9pbnRlcihuc0Fyci5vYmplY3RBdEluZGV4KGkpLCB0aGlzLnZpZXcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWN0aXZlUG9pbnRlcnM7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldEFsbFBvaW50ZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FsbFBvaW50ZXJzKSB7XG4gICAgICAgICAgICB0aGlzLl9hbGxQb2ludGVycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG5zQXJyID0gdGhpcy5pb3MuZXZlbnQuYWxsVG91Y2hlcy5hbGxPYmplY3RzO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuc0Fyci5jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWxsUG9pbnRlcnMucHVzaChuZXcgUG9pbnRlcihuc0Fyci5vYmplY3RBdEluZGV4KGkpLCB0aGlzLnZpZXcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fYWxsUG9pbnRlcnM7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldFggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1haW5Qb2ludGVyKCkubG9jYXRpb25JblZpZXcodGhpcy52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpLng7XG4gICAgfTtcbiAgICBUb3VjaEdlc3R1cmVFdmVudERhdGEucHJvdG90eXBlLmdldFkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1haW5Qb2ludGVyKCkubG9jYXRpb25JblZpZXcodGhpcy52aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQpLnk7XG4gICAgfTtcbiAgICByZXR1cm4gVG91Y2hHZXN0dXJlRXZlbnREYXRhO1xufSgpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdlc3R1cmVzLmlvcy5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGJhY2tncm91bmRfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2JhY2tncm91bmRcIik7XG52YXIgdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpO1xudmFyIGJhY2tncm91bmRfMiA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2JhY2tncm91bmRcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vdGV4dC1iYXNlXCIpKTtcbnZhciBGaXhlZFNpemU7XG4oZnVuY3Rpb24gKEZpeGVkU2l6ZSkge1xuICAgIEZpeGVkU2l6ZVtGaXhlZFNpemVbXCJOT05FXCJdID0gMF0gPSBcIk5PTkVcIjtcbiAgICBGaXhlZFNpemVbRml4ZWRTaXplW1wiV0lEVEhcIl0gPSAxXSA9IFwiV0lEVEhcIjtcbiAgICBGaXhlZFNpemVbRml4ZWRTaXplW1wiSEVJR0hUXCJdID0gMl0gPSBcIkhFSUdIVFwiO1xuICAgIEZpeGVkU2l6ZVtGaXhlZFNpemVbXCJCT1RIXCJdID0gM10gPSBcIkJPVEhcIjtcbn0pKEZpeGVkU2l6ZSB8fCAoRml4ZWRTaXplID0ge30pKTtcbnZhciBMYWJlbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKExhYmVsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExhYmVsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIExhYmVsLnByb3RvdHlwZS5jcmVhdGVOYXRpdmVWaWV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IFROU0xhYmVsLm5ldygpO1xuICAgICAgICB2aWV3LnVzZXJJbnRlcmFjdGlvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgICByZXR1cm4gdmlldztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMYWJlbC5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExhYmVsLnByb3RvdHlwZSwgXCJ0ZXh0V3JhcFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9PT0gXCJub3JtYWxcIjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRleHRfYmFzZV8xLmJvb2xlYW5Db252ZXJ0ZXIodmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5zdHlsZS53aGl0ZVNwYWNlID0gdmFsdWUgPyBcIm5vcm1hbFwiIDogXCJub3dyYXBcIjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTGFiZWwucHJvdG90eXBlLl9yZXF1ZXN0TGF5b3V0T25UZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2ZpeGVkU2l6ZSA9PT0gRml4ZWRTaXplLkJPVEgpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5fZml4ZWRTaXplID09PSBGaXhlZFNpemUuV0lEVEggJiYgIXRoaXMudGV4dFdyYXAgJiYgdGhpcy5nZXRNZWFzdXJlZEhlaWdodCgpID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuX3JlcXVlc3RMYXlvdXRPblRleHRDaGFuZ2VkLmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGUub25NZWFzdXJlID0gZnVuY3Rpb24gKHdpZHRoTWVhc3VyZVNwZWMsIGhlaWdodE1lYXN1cmVTcGVjKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHRleHRfYmFzZV8xLmxheW91dC5nZXRNZWFzdXJlU3BlY1NpemUod2lkdGhNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB2YXIgd2lkdGhNb2RlID0gdGV4dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZSh3aWR0aE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHQgPSB0ZXh0X2Jhc2VfMS5sYXlvdXQuZ2V0TWVhc3VyZVNwZWNTaXplKGhlaWdodE1lYXN1cmVTcGVjKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRNb2RlID0gdGV4dF9iYXNlXzEubGF5b3V0LmdldE1lYXN1cmVTcGVjTW9kZShoZWlnaHRNZWFzdXJlU3BlYyk7XG4gICAgICAgICAgICB0aGlzLl9maXhlZFNpemUgPSAod2lkdGhNb2RlID09PSB0ZXh0X2Jhc2VfMS5sYXlvdXQuRVhBQ1RMWSA/IEZpeGVkU2l6ZS5XSURUSCA6IEZpeGVkU2l6ZS5OT05FKVxuICAgICAgICAgICAgICAgIHwgKGhlaWdodE1vZGUgPT09IHRleHRfYmFzZV8xLmxheW91dC5FWEFDVExZID8gRml4ZWRTaXplLkhFSUdIVCA6IEZpeGVkU2l6ZS5OT05FKTtcbiAgICAgICAgICAgIHZhciBuYXRpdmVTaXplID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKHRoaXMudGV4dFdyYXApIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVTaXplID0gdGhpcy5fbWVhc3VyZU5hdGl2ZVZpZXcod2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIG5hdGl2ZVNpemUgPSB0ZXh0X2Jhc2VfMS5sYXlvdXQubWVhc3VyZU5hdGl2ZVZpZXcobmF0aXZlVmlldywgd2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBsYWJlbFdpZHRoID0gbmF0aXZlU2l6ZS53aWR0aDtcbiAgICAgICAgICAgIGlmICh0aGlzLnRleHRXcmFwICYmIHdpZHRoTW9kZSA9PT0gdGV4dF9iYXNlXzEubGF5b3V0LkFUX01PU1QpIHtcbiAgICAgICAgICAgICAgICBsYWJlbFdpZHRoID0gTWF0aC5taW4obGFiZWxXaWR0aCwgd2lkdGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1lYXN1cmVXaWR0aCA9IE1hdGgubWF4KGxhYmVsV2lkdGgsIHRoaXMuZWZmZWN0aXZlTWluV2lkdGgpO1xuICAgICAgICAgICAgdmFyIG1lYXN1cmVIZWlnaHQgPSBNYXRoLm1heChuYXRpdmVTaXplLmhlaWdodCwgdGhpcy5lZmZlY3RpdmVNaW5IZWlnaHQpO1xuICAgICAgICAgICAgdmFyIHdpZHRoQW5kU3RhdGUgPSB0ZXh0X2Jhc2VfMS5WaWV3LnJlc29sdmVTaXplQW5kU3RhdGUobWVhc3VyZVdpZHRoLCB3aWR0aCwgd2lkdGhNb2RlLCAwKTtcbiAgICAgICAgICAgIHZhciBoZWlnaHRBbmRTdGF0ZSA9IHRleHRfYmFzZV8xLlZpZXcucmVzb2x2ZVNpemVBbmRTdGF0ZShtZWFzdXJlSGVpZ2h0LCBoZWlnaHQsIGhlaWdodE1vZGUsIDApO1xuICAgICAgICAgICAgdGhpcy5zZXRNZWFzdXJlZERpbWVuc2lvbih3aWR0aEFuZFN0YXRlLCBoZWlnaHRBbmRTdGF0ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZS5fbWVhc3VyZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAod2lkdGgsIHdpZHRoTW9kZSwgaGVpZ2h0LCBoZWlnaHRNb2RlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIG5hdGl2ZVNpemUgPSB2aWV3LnRleHRSZWN0Rm9yQm91bmRzTGltaXRlZFRvTnVtYmVyT2ZMaW5lcyhDR1JlY3RNYWtlKDAsIDAsIHdpZHRoTW9kZSA9PT0gMCA/IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSA6IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHdpZHRoKSwgaGVpZ2h0TW9kZSA9PT0gMCA/IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSA6IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGhlaWdodCkpLCAwKS5zaXplO1xuICAgICAgICBuYXRpdmVTaXplLndpZHRoID0gdGV4dF9iYXNlXzEubGF5b3V0LnJvdW5kKHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZVBpeGVscyhuYXRpdmVTaXplLndpZHRoKSk7XG4gICAgICAgIG5hdGl2ZVNpemUuaGVpZ2h0ID0gdGV4dF9iYXNlXzEubGF5b3V0LnJvdW5kKHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZVBpeGVscyhuYXRpdmVTaXplLmhlaWdodCkpO1xuICAgICAgICByZXR1cm4gbmF0aXZlU2l6ZTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS53aGl0ZVNwYWNlUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHN3aXRjaCAodmFsdWUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJub3JtYWxcIjpcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmxpbmVCcmVha01vZGUgPSAwO1xuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubnVtYmVyT2ZMaW5lcyA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwibm93cmFwXCI6XG4gICAgICAgICAgICBjYXNlIFwiaW5pdGlhbFwiOlxuICAgICAgICAgICAgICAgIG5hdGl2ZVZpZXcubGluZUJyZWFrTW9kZSA9IDQ7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5udW1iZXJPZkxpbmVzID0gMTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlLl9yZWRyYXdOYXRpdmVCYWNrZ3JvdW5kID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIGJhY2tncm91bmRfMS5CYWNrZ3JvdW5kKSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kXzIuaW9zLmNyZWF0ZUJhY2tncm91bmRVSUNvbG9yKHRoaXMsIGZ1bmN0aW9uIChjb2xvcikge1xuICAgICAgICAgICAgICAgIHZhciBjZ0NvbG9yID0gY29sb3IgPyBjb2xvci5DR0NvbG9yIDogbnVsbDtcbiAgICAgICAgICAgICAgICBfdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5sYXllci5iYWNrZ3JvdW5kQ29sb3IgPSBjZ0NvbG9yO1xuICAgICAgICAgICAgfSwgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlQ2xpcFRvQm91bmRzKCk7XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGVbdGV4dF9iYXNlXzEuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGJvcmRlciA9IG5hdGl2ZVZpZXcuYm9yZGVyVGhpY2tuZXNzO1xuICAgICAgICBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcyA9IHtcbiAgICAgICAgICAgIHRvcDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCksXG4gICAgICAgICAgICByaWdodDogYm9yZGVyLnJpZ2h0LFxuICAgICAgICAgICAgYm90dG9tOiBib3JkZXIuYm90dG9tLFxuICAgICAgICAgICAgbGVmdDogYm9yZGVyLmxlZnRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBib3JkZXIgPSBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcztcbiAgICAgICAgbmF0aXZlVmlldy5ib3JkZXJUaGlja25lc3MgPSB7XG4gICAgICAgICAgICB0b3A6IGJvcmRlci50b3AsXG4gICAgICAgICAgICByaWdodDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoKSxcbiAgICAgICAgICAgIGJvdHRvbTogYm9yZGVyLmJvdHRvbSxcbiAgICAgICAgICAgIGxlZnQ6IGJvcmRlci5sZWZ0XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBMYWJlbC5wcm90b3R5cGVbdGV4dF9iYXNlXzEuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGJvcmRlciA9IG5hdGl2ZVZpZXcuYm9yZGVyVGhpY2tuZXNzO1xuICAgICAgICBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcyA9IHtcbiAgICAgICAgICAgIHRvcDogYm9yZGVyLnRvcCxcbiAgICAgICAgICAgIHJpZ2h0OiBib3JkZXIucmlnaHQsXG4gICAgICAgICAgICBib3R0b206IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGgpLFxuICAgICAgICAgICAgbGVmdDogYm9yZGVyLmxlZnRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIGJvcmRlciA9IG5hdGl2ZVZpZXcuYm9yZGVyVGhpY2tuZXNzO1xuICAgICAgICBuYXRpdmVWaWV3LmJvcmRlclRoaWNrbmVzcyA9IHtcbiAgICAgICAgICAgIHRvcDogYm9yZGVyLnRvcCxcbiAgICAgICAgICAgIHJpZ2h0OiBib3JkZXIucmlnaHQsXG4gICAgICAgICAgICBib3R0b206IGJvcmRlci5ib3R0b20sXG4gICAgICAgICAgICBsZWZ0OiB0ZXh0X2Jhc2VfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0aGlzLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aClcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBwYWRkaW5nID0gbmF0aXZlVmlldy5wYWRkaW5nO1xuICAgICAgICBuYXRpdmVWaWV3LnBhZGRpbmcgPSB7XG4gICAgICAgICAgICB0b3A6IHRleHRfYmFzZV8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRoaXMuZWZmZWN0aXZlUGFkZGluZ1RvcCksXG4gICAgICAgICAgICByaWdodDogcGFkZGluZy5yaWdodCxcbiAgICAgICAgICAgIGJvdHRvbTogcGFkZGluZy5ib3R0b20sXG4gICAgICAgICAgICBsZWZ0OiBwYWRkaW5nLmxlZnRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsLnByb3RvdHlwZVt0ZXh0X2Jhc2VfMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSBuYXRpdmVWaWV3LnBhZGRpbmc7XG4gICAgICAgIG5hdGl2ZVZpZXcucGFkZGluZyA9IHtcbiAgICAgICAgICAgIHRvcDogcGFkZGluZy50b3AsXG4gICAgICAgICAgICByaWdodDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nUmlnaHQpLFxuICAgICAgICAgICAgYm90dG9tOiBwYWRkaW5nLmJvdHRvbSxcbiAgICAgICAgICAgIGxlZnQ6IHBhZGRpbmcubGVmdFxuICAgICAgICB9O1xuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlW3RleHRfYmFzZV8xLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSBuYXRpdmVWaWV3LnBhZGRpbmc7XG4gICAgICAgIG5hdGl2ZVZpZXcucGFkZGluZyA9IHtcbiAgICAgICAgICAgIHRvcDogcGFkZGluZy50b3AsXG4gICAgICAgICAgICByaWdodDogcGFkZGluZy5yaWdodCxcbiAgICAgICAgICAgIGJvdHRvbTogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nQm90dG9tKSxcbiAgICAgICAgICAgIGxlZnQ6IHBhZGRpbmcubGVmdFxuICAgICAgICB9O1xuICAgIH07XG4gICAgTGFiZWwucHJvdG90eXBlW3RleHRfYmFzZV8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIHZhciBwYWRkaW5nID0gbmF0aXZlVmlldy5wYWRkaW5nO1xuICAgICAgICBuYXRpdmVWaWV3LnBhZGRpbmcgPSB7XG4gICAgICAgICAgICB0b3A6IHBhZGRpbmcudG9wLFxuICAgICAgICAgICAgcmlnaHQ6IHBhZGRpbmcucmlnaHQsXG4gICAgICAgICAgICBib3R0b206IHBhZGRpbmcuYm90dG9tLFxuICAgICAgICAgICAgbGVmdDogdGV4dF9iYXNlXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGhpcy5lZmZlY3RpdmVQYWRkaW5nTGVmdClcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIExhYmVsID0gX19kZWNvcmF0ZShbXG4gICAgICAgIHRleHRfYmFzZV8xLkNTU1R5cGUoXCJMYWJlbFwiKVxuICAgIF0sIExhYmVsKTtcbiAgICByZXR1cm4gTGFiZWw7XG59KHRleHRfYmFzZV8xLlRleHRCYXNlKSk7XG5leHBvcnRzLkxhYmVsID0gTGFiZWw7XG5MYWJlbC5wcm90b3R5cGUucmVjeWNsZU5hdGl2ZVZpZXcgPSBcImF1dG9cIjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxhYmVsLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi9saW5lYXItZ3JhZGllbnRcIik7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb2xvclwiKTtcbnZhciBCYWNrZ3JvdW5kID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCYWNrZ3JvdW5kKCkge1xuICAgICAgICB0aGlzLmJvcmRlclRvcFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJSaWdodFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyTGVmdFdpZHRoID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gMDtcbiAgICAgICAgdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cyA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IDA7XG4gICAgICAgIHRoaXMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPSAwO1xuICAgIH1cbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNsb25lID0gbmV3IEJhY2tncm91bmQoKTtcbiAgICAgICAgY2xvbmUuY29sb3IgPSB0aGlzLmNvbG9yO1xuICAgICAgICBjbG9uZS5pbWFnZSA9IHRoaXMuaW1hZ2U7XG4gICAgICAgIGNsb25lLnJlcGVhdCA9IHRoaXMucmVwZWF0O1xuICAgICAgICBjbG9uZS5wb3NpdGlvbiA9IHRoaXMucG9zaXRpb247XG4gICAgICAgIGNsb25lLnNpemUgPSB0aGlzLnNpemU7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcENvbG9yID0gdGhpcy5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyUmlnaHRDb2xvciA9IHRoaXMuYm9yZGVyUmlnaHRDb2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tQ29sb3IgPSB0aGlzLmJvcmRlckJvdHRvbUNvbG9yO1xuICAgICAgICBjbG9uZS5ib3JkZXJMZWZ0Q29sb3IgPSB0aGlzLmJvcmRlckxlZnRDb2xvcjtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wV2lkdGggPSB0aGlzLmJvcmRlclRvcFdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJSaWdodFdpZHRoID0gdGhpcy5ib3JkZXJSaWdodFdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJCb3R0b21XaWR0aCA9IHRoaXMuYm9yZGVyQm90dG9tV2lkdGg7XG4gICAgICAgIGNsb25lLmJvcmRlckxlZnRXaWR0aCA9IHRoaXMuYm9yZGVyTGVmdFdpZHRoO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BMZWZ0UmFkaXVzID0gdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BSaWdodFJhZGl1cyA9IHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXM7XG4gICAgICAgIGNsb25lLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gdGhpcy5ib3JkZXJCb3R0b21SaWdodFJhZGl1cztcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyA9IHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cztcbiAgICAgICAgY2xvbmUuY2xpcFBhdGggPSB0aGlzLmNsaXBQYXRoO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5jb2xvciA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoSW1hZ2UgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5pbWFnZSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoUmVwZWF0ID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUucmVwZWF0ID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhQb3NpdGlvbiA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLnBvc2l0aW9uID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhTaXplID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuc2l6ZSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyVG9wQ29sb3IgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BDb2xvciA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyUmlnaHRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclJpZ2h0Q29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbUNvbG9yID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tQ29sb3IgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckxlZnRDb2xvciA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckxlZnRDb2xvciA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyVG9wV2lkdGggPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJUb3BXaWR0aCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyUmlnaHRXaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclJpZ2h0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbVdpZHRoID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tV2lkdGggPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckxlZnRXaWR0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlckxlZnRXaWR0aCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS53aXRoQm9yZGVyVG9wTGVmdFJhZGl1cyA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmJvcmRlclRvcExlZnRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlclRvcFJpZ2h0UmFkaXVzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjbG9uZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPSB2YWx1ZTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUud2l0aEJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIGNsb25lID0gdGhpcy5jbG9uZSgpO1xuICAgICAgICBjbG9uZS5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLndpdGhDbGlwUGF0aCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lKCk7XG4gICAgICAgIGNsb25lLmNsaXBQYXRoID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmlzRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5jb2xvclxuICAgICAgICAgICAgJiYgIXRoaXMuaW1hZ2VcbiAgICAgICAgICAgICYmICF0aGlzLmhhc0JvcmRlcldpZHRoKClcbiAgICAgICAgICAgICYmICF0aGlzLmhhc0JvcmRlclJhZGl1cygpXG4gICAgICAgICAgICAmJiAhdGhpcy5jbGlwUGF0aDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQuZXF1YWxzID0gZnVuY3Rpb24gKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgICAgIGlmICghdmFsdWUxICYmICF2YWx1ZTIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmFsdWUxIHx8ICF2YWx1ZTIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaW1hZ2VzRXF1YWwgPSBmYWxzZTtcbiAgICAgICAgaWYgKHZhbHVlMSBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50ICYmIHZhbHVlMiBpbnN0YW5jZW9mIGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50KSB7XG4gICAgICAgICAgICBpbWFnZXNFcXVhbCA9IGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50LmVxdWFscyh2YWx1ZTEsIHZhbHVlMik7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpbWFnZXNFcXVhbCA9IHZhbHVlMS5pbWFnZSA9PT0gdmFsdWUyLmltYWdlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuY29sb3IsIHZhbHVlMi5jb2xvcilcbiAgICAgICAgICAgICYmIGltYWdlc0VxdWFsXG4gICAgICAgICAgICAmJiB2YWx1ZTEucG9zaXRpb24gPT09IHZhbHVlMi5wb3NpdGlvblxuICAgICAgICAgICAgJiYgdmFsdWUxLnJlcGVhdCA9PT0gdmFsdWUyLnJlcGVhdFxuICAgICAgICAgICAgJiYgdmFsdWUxLnNpemUgPT09IHZhbHVlMi5zaXplXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh2YWx1ZTEuYm9yZGVyVG9wQ29sb3IsIHZhbHVlMi5ib3JkZXJUb3BDb2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHZhbHVlMS5ib3JkZXJSaWdodENvbG9yLCB2YWx1ZTIuYm9yZGVyUmlnaHRDb2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHZhbHVlMS5ib3JkZXJCb3R0b21Db2xvciwgdmFsdWUyLmJvcmRlckJvdHRvbUNvbG9yKVxuICAgICAgICAgICAgJiYgY29sb3JfMS5Db2xvci5lcXVhbHModmFsdWUxLmJvcmRlckxlZnRDb2xvciwgdmFsdWUyLmJvcmRlckxlZnRDb2xvcilcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJUb3BXaWR0aCA9PT0gdmFsdWUyLmJvcmRlclRvcFdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyUmlnaHRXaWR0aCA9PT0gdmFsdWUyLmJvcmRlclJpZ2h0V2lkdGhcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJCb3R0b21XaWR0aCA9PT0gdmFsdWUyLmJvcmRlckJvdHRvbVdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyTGVmdFdpZHRoID09PSB2YWx1ZTIuYm9yZGVyTGVmdFdpZHRoXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyVG9wTGVmdFJhZGl1cyA9PT0gdmFsdWUyLmJvcmRlclRvcExlZnRSYWRpdXNcbiAgICAgICAgICAgICYmIHZhbHVlMS5ib3JkZXJUb3BSaWdodFJhZGl1cyA9PT0gdmFsdWUyLmJvcmRlclRvcFJpZ2h0UmFkaXVzXG4gICAgICAgICAgICAmJiB2YWx1ZTEuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJCb3R0b21SaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdmFsdWUxLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMgPT09IHZhbHVlMi5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzXG4gICAgICAgICAgICAmJiB2YWx1ZTEuY2xpcFBhdGggPT09IHZhbHVlMi5jbGlwUGF0aDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc0JvcmRlckNvbG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLmJvcmRlclRvcENvbG9yIHx8ICEhdGhpcy5ib3JkZXJSaWdodENvbG9yIHx8ICEhdGhpcy5ib3JkZXJCb3R0b21Db2xvciB8fCAhIXRoaXMuYm9yZGVyTGVmdENvbG9yO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuaGFzQm9yZGVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcFdpZHRoID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJSaWdodFdpZHRoID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyTGVmdFdpZHRoID4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc0JvcmRlclJhZGl1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA+IDBcbiAgICAgICAgICAgIHx8IHRoaXMuYm9yZGVyVG9wUmlnaHRSYWRpdXMgPiAwXG4gICAgICAgICAgICB8fCB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzID4gMFxuICAgICAgICAgICAgfHwgdGhpcy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzID4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc1VuaWZvcm1Cb3JkZXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHRoaXMuYm9yZGVyVG9wQ29sb3IsIHRoaXMuYm9yZGVyUmlnaHRDb2xvcilcbiAgICAgICAgICAgICYmIGNvbG9yXzEuQ29sb3IuZXF1YWxzKHRoaXMuYm9yZGVyVG9wQ29sb3IsIHRoaXMuYm9yZGVyQm90dG9tQ29sb3IpXG4gICAgICAgICAgICAmJiBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlckxlZnRDb2xvcik7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5oYXNVbmlmb3JtQm9yZGVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcFdpZHRoID09PSB0aGlzLmJvcmRlclJpZ2h0V2lkdGhcbiAgICAgICAgICAgICYmIHRoaXMuYm9yZGVyVG9wV2lkdGggPT09IHRoaXMuYm9yZGVyQm90dG9tV2lkdGhcbiAgICAgICAgICAgICYmIHRoaXMuYm9yZGVyVG9wV2lkdGggPT09IHRoaXMuYm9yZGVyTGVmdFdpZHRoO1xuICAgIH07XG4gICAgQmFja2dyb3VuZC5wcm90b3R5cGUuaGFzVW5pZm9ybUJvcmRlclJhZGl1cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cyA9PT0gdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1c1xuICAgICAgICAgICAgJiYgdGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzID09PSB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzXG4gICAgICAgICAgICAmJiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgPT09IHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cztcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmhhc1VuaWZvcm1Cb3JkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc1VuaWZvcm1Cb3JkZXJDb2xvcigpXG4gICAgICAgICAgICAmJiB0aGlzLmhhc1VuaWZvcm1Cb3JkZXJXaWR0aCgpXG4gICAgICAgICAgICAmJiB0aGlzLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMoKTtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmdldFVuaWZvcm1Cb3JkZXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaGFzVW5pZm9ybUJvcmRlckNvbG9yKCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcENvbG9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBCYWNrZ3JvdW5kLnByb3RvdHlwZS5nZXRVbmlmb3JtQm9yZGVyV2lkdGggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1VuaWZvcm1Cb3JkZXJXaWR0aCgpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BXaWR0aDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLmdldFVuaWZvcm1Cb3JkZXJSYWRpdXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMoKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIEJhY2tncm91bmQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJpc0VtcHR5OiBcIiArIHRoaXMuaXNFbXB0eSgpICsgXCI7IGNvbG9yOiBcIiArIHRoaXMuY29sb3IgKyBcIjsgaW1hZ2U6IFwiICsgdGhpcy5pbWFnZSArIFwiOyByZXBlYXQ6IFwiICsgdGhpcy5yZXBlYXQgKyBcIjsgcG9zaXRpb246IFwiICsgdGhpcy5wb3NpdGlvbiArIFwiOyBzaXplOiBcIiArIHRoaXMuc2l6ZSArIFwiOyBib3JkZXJUb3BDb2xvcjogXCIgKyB0aGlzLmJvcmRlclRvcENvbG9yICsgXCI7IGJvcmRlclJpZ2h0Q29sb3I6IFwiICsgdGhpcy5ib3JkZXJSaWdodENvbG9yICsgXCI7IGJvcmRlckJvdHRvbUNvbG9yOiBcIiArIHRoaXMuYm9yZGVyQm90dG9tQ29sb3IgKyBcIjsgYm9yZGVyTGVmdENvbG9yOiBcIiArIHRoaXMuYm9yZGVyTGVmdENvbG9yICsgXCI7IGJvcmRlclRvcFdpZHRoOiBcIiArIHRoaXMuYm9yZGVyVG9wV2lkdGggKyBcIjsgYm9yZGVyUmlnaHRXaWR0aDogXCIgKyB0aGlzLmJvcmRlclJpZ2h0V2lkdGggKyBcIjsgYm9yZGVyQm90dG9tV2lkdGg6IFwiICsgdGhpcy5ib3JkZXJCb3R0b21XaWR0aCArIFwiOyBib3JkZXJMZWZ0V2lkdGg6IFwiICsgdGhpcy5ib3JkZXJMZWZ0V2lkdGggKyBcIjsgYm9yZGVyVG9wTGVmdFJhZGl1czogXCIgKyB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMgKyBcIjsgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cyArIFwiOyBib3JkZXJCb3R0b21SaWdodFJhZGl1czogXCIgKyB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzICsgXCI7IGJvcmRlckJvdHRvbUxlZnRSYWRpdXM6IFwiICsgdGhpcy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzICsgXCI7IGNsaXBQYXRoOiBcIiArIHRoaXMuY2xpcFBhdGggKyBcIjtcIjtcbiAgICB9O1xuICAgIEJhY2tncm91bmQuZGVmYXVsdCA9IG5ldyBCYWNrZ3JvdW5kKCk7XG4gICAgcmV0dXJuIEJhY2tncm91bmQ7XG59KCkpO1xuZXhwb3J0cy5CYWNrZ3JvdW5kID0gQmFja2dyb3VuZDtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhY2tncm91bmQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi9saW5lYXItZ3JhZGllbnRcIik7XG52YXIgY29sb3JfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb2xvclwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIGltYWdlX3NvdXJjZV8xID0gcmVxdWlyZShcIi4uLy4uL2ltYWdlLXNvdXJjZVwiKTtcbnZhciBjc3NfdmFsdWVfMSA9IHJlcXVpcmUoXCIuLi8uLi9jc3MtdmFsdWVcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9iYWNrZ3JvdW5kLWNvbW1vblwiKSk7XG52YXIgY2xlYXJDR0NvbG9yID0gVUlDb2xvci5jbGVhckNvbG9yLkNHQ29sb3I7XG52YXIgc3ltYm9sVXJsID0gU3ltYm9sKFwiYmFja2dyb3VuZEltYWdlVXJsXCIpO1xudmFyIGlvcztcbihmdW5jdGlvbiAoaW9zKSB7XG4gICAgZnVuY3Rpb24gY3JlYXRlQmFja2dyb3VuZFVJQ29sb3IodmlldywgY2FsbGJhY2ssIGZsaXApIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB2aWV3LnN0eWxlLmJhY2tncm91bmRJbnRlcm5hbDtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB2aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIGlmIChuYXRpdmVWaWV3Lmhhc05vblVuaWZvcm1Cb3JkZXIpIHtcbiAgICAgICAgICAgIHVuc3Vic2NyaWJlRnJvbVNjcm9sbE5vdGlmaWNhdGlvbnModmlldyk7XG4gICAgICAgICAgICBjbGVhck5vblVuaWZvcm1Cb3JkZXJzKG5hdGl2ZVZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGNsZWFyR3JhZGllbnQobmF0aXZlVmlldyk7XG4gICAgICAgIGlmIChiYWNrZ3JvdW5kLmltYWdlIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQpIHtcbiAgICAgICAgICAgIGRyYXdHcmFkaWVudChuYXRpdmVWaWV3LCBiYWNrZ3JvdW5kLmltYWdlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaGFzTm9uVW5pZm9ybUJvcmRlcldpZHRocyA9IGJhY2tncm91bmQuaGFzQm9yZGVyV2lkdGgoKSAmJiAhYmFja2dyb3VuZC5oYXNVbmlmb3JtQm9yZGVyKCk7XG4gICAgICAgIHZhciBoYXNOb25Vbmlmb3JtQm9yZGVyUmFkaXVzZXMgPSBiYWNrZ3JvdW5kLmhhc0JvcmRlclJhZGl1cygpICYmICFiYWNrZ3JvdW5kLmhhc1VuaWZvcm1Cb3JkZXJSYWRpdXMoKTtcbiAgICAgICAgaWYgKGJhY2tncm91bmQuaGFzVW5pZm9ybUJvcmRlckNvbG9yKCkgJiYgKGhhc05vblVuaWZvcm1Cb3JkZXJXaWR0aHMgfHwgaGFzTm9uVW5pZm9ybUJvcmRlclJhZGl1c2VzKSkge1xuICAgICAgICAgICAgZHJhd1VuaWZvcm1Db2xvck5vblVuaWZvcm1Cb3JkZXJzKG5hdGl2ZVZpZXcsIGJhY2tncm91bmQpO1xuICAgICAgICAgICAgc3Vic2NyaWJlRm9yU2Nyb2xsTm90aWZpY2F0aW9ucyh2aWV3KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChiYWNrZ3JvdW5kLmhhc1VuaWZvcm1Cb3JkZXIoKSkge1xuICAgICAgICAgICAgdmFyIGxheWVyID0gbmF0aXZlVmlldy5sYXllcjtcbiAgICAgICAgICAgIHZhciBib3JkZXJDb2xvciA9IGJhY2tncm91bmQuZ2V0VW5pZm9ybUJvcmRlckNvbG9yKCk7XG4gICAgICAgICAgICBsYXllci5ib3JkZXJDb2xvciA9ICFib3JkZXJDb2xvciA/IHVuZGVmaW5lZCA6IGJvcmRlckNvbG9yLmlvcy5DR0NvbG9yO1xuICAgICAgICAgICAgbGF5ZXIuYm9yZGVyV2lkdGggPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuZ2V0VW5pZm9ybUJvcmRlcldpZHRoKCkpO1xuICAgICAgICAgICAgdmFyIHJlbmRlclNpemUgPSB2aWV3LmdldEFjdHVhbFNpemUoKSB8fCB7IHdpZHRoOiAwLCBoZWlnaHQ6IDAgfTtcbiAgICAgICAgICAgIHZhciBjb3JuZXJSYWRpdXMgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuZ2V0VW5pZm9ybUJvcmRlclJhZGl1cygpKTtcbiAgICAgICAgICAgIGxheWVyLmNvcm5lclJhZGl1cyA9IE1hdGgubWluKE1hdGgubWluKHJlbmRlclNpemUud2lkdGggLyAyLCByZW5kZXJTaXplLmhlaWdodCAvIDIpLCBjb3JuZXJSYWRpdXMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZHJhd05vUmFkaXVzTm9uVW5pZm9ybUJvcmRlcnMobmF0aXZlVmlldywgYmFja2dyb3VuZCk7XG4gICAgICAgICAgICBzdWJzY3JpYmVGb3JTY3JvbGxOb3RpZmljYXRpb25zKHZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYWNrZ3JvdW5kLmNsaXBQYXRoKSB7XG4gICAgICAgICAgICBkcmF3Q2xpcFBhdGgobmF0aXZlVmlldywgYmFja2dyb3VuZCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFiYWNrZ3JvdW5kLmltYWdlIHx8IGJhY2tncm91bmQuaW1hZ2UgaW5zdGFuY2VvZiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudCkge1xuICAgICAgICAgICAgdmFyIHVpQ29sb3IgPSBiYWNrZ3JvdW5kLmNvbG9yID8gYmFja2dyb3VuZC5jb2xvci5pb3MgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBjYWxsYmFjayh1aUNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNldFVJQ29sb3JGcm9tSW1hZ2UodmlldywgbmF0aXZlVmlldywgY2FsbGJhY2ssIGZsaXApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlvcy5jcmVhdGVCYWNrZ3JvdW5kVUlDb2xvciA9IGNyZWF0ZUJhY2tncm91bmRVSUNvbG9yO1xufSkoaW9zID0gZXhwb3J0cy5pb3MgfHwgKGV4cG9ydHMuaW9zID0ge30pKTtcbmZ1bmN0aW9uIG9uU2Nyb2xsKGFyZ3MpIHtcbiAgICB2YXIgdmlldyA9IGFyZ3Mub2JqZWN0O1xuICAgIHZhciBuYXRpdmVWaWV3ID0gdmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgIGlmIChuYXRpdmVWaWV3IGluc3RhbmNlb2YgVUlTY3JvbGxWaWV3KSB7XG4gICAgICAgIGFkanVzdExheWVyc0ZvclNjcm9sbFZpZXcobmF0aXZlVmlldyk7XG4gICAgfVxufVxuZnVuY3Rpb24gYWRqdXN0TGF5ZXJzRm9yU2Nyb2xsVmlldyhuYXRpdmVWaWV3KSB7XG4gICAgdmFyIGxheWVyID0gbmF0aXZlVmlldy5ib3JkZXJMYXllcjtcbiAgICBpZiAobGF5ZXIgaW5zdGFuY2VvZiBDQUxheWVyKSB7XG4gICAgICAgIENBVHJhbnNhY3Rpb24uYmVnaW4oKTtcbiAgICAgICAgQ0FUcmFuc2FjdGlvbi5zZXRWYWx1ZUZvcktleShrQ0ZCb29sZWFuVHJ1ZSwga0NBVHJhbnNhY3Rpb25EaXNhYmxlQWN0aW9ucyk7XG4gICAgICAgIHZhciBvZmZzZXQgPSBuYXRpdmVWaWV3LmNvbnRlbnRPZmZzZXQ7XG4gICAgICAgIHZhciB0cmFuc2Zvcm0gPSB7IGE6IDEsIGI6IDAsIGM6IDAsIGQ6IDEsIHR4OiBvZmZzZXQueCwgdHk6IG9mZnNldC55IH07XG4gICAgICAgIGxheWVyLnNldEFmZmluZVRyYW5zZm9ybSh0cmFuc2Zvcm0pO1xuICAgICAgICBpZiAobmF0aXZlVmlldy5sYXllci5tYXNrKSB7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmxheWVyLm1hc2suc2V0QWZmaW5lVHJhbnNmb3JtKHRyYW5zZm9ybSk7XG4gICAgICAgIH1cbiAgICAgICAgQ0FUcmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICB9XG59XG5mdW5jdGlvbiB1bnN1YnNjcmliZUZyb21TY3JvbGxOb3RpZmljYXRpb25zKHZpZXcpIHtcbiAgICBpZiAodmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlTY3JvbGxWaWV3KSB7XG4gICAgICAgIHZpZXcub2ZmKFwic2Nyb2xsXCIsIG9uU2Nyb2xsKTtcbiAgICB9XG59XG5mdW5jdGlvbiBzdWJzY3JpYmVGb3JTY3JvbGxOb3RpZmljYXRpb25zKHZpZXcpIHtcbiAgICBpZiAodmlldy5uYXRpdmVWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlTY3JvbGxWaWV3KSB7XG4gICAgICAgIHZpZXcub24oXCJzY3JvbGxcIiwgb25TY3JvbGwpO1xuICAgICAgICBhZGp1c3RMYXllcnNGb3JTY3JvbGxWaWV3KHZpZXcubmF0aXZlVmlld1Byb3RlY3RlZCk7XG4gICAgfVxufVxuZnVuY3Rpb24gY2xlYXJOb25Vbmlmb3JtQm9yZGVycyhuYXRpdmVWaWV3KSB7XG4gICAgaWYgKG5hdGl2ZVZpZXcuYm9yZGVyTGF5ZXIpIHtcbiAgICAgICAgbmF0aXZlVmlldy5ib3JkZXJMYXllci5yZW1vdmVGcm9tU3VwZXJsYXllcigpO1xuICAgIH1cbiAgICBpZiAobmF0aXZlVmlldy5oYXNCb3JkZXJNYXNrKSB7XG4gICAgICAgIG5hdGl2ZVZpZXcubGF5ZXIubWFzayA9IG5hdGl2ZVZpZXcuYm9yZGVyT3JpZ2luYWxNYXNrO1xuICAgICAgICBuYXRpdmVWaWV3Lmhhc0JvcmRlck1hc2sgPSBmYWxzZTtcbiAgICAgICAgbmF0aXZlVmlldy5ib3JkZXJPcmlnaW5hbE1hc2sgPSBudWxsO1xuICAgIH1cbiAgICBpZiAobmF0aXZlVmlldy50b3BCb3JkZXJMYXllcikge1xuICAgICAgICBuYXRpdmVWaWV3LnRvcEJvcmRlckxheWVyLnJlbW92ZUZyb21TdXBlcmxheWVyKCk7XG4gICAgfVxuICAgIGlmIChuYXRpdmVWaWV3LnJpZ2h0Qm9yZGVyTGF5ZXIpIHtcbiAgICAgICAgbmF0aXZlVmlldy5yaWdodEJvcmRlckxheWVyLnJlbW92ZUZyb21TdXBlcmxheWVyKCk7XG4gICAgfVxuICAgIGlmIChuYXRpdmVWaWV3LmJvdHRvbUJvcmRlckxheWVyKSB7XG4gICAgICAgIG5hdGl2ZVZpZXcuYm90dG9tQm9yZGVyTGF5ZXIucmVtb3ZlRnJvbVN1cGVybGF5ZXIoKTtcbiAgICB9XG4gICAgaWYgKG5hdGl2ZVZpZXcubGVmdEJvcmRlckxheWVyKSB7XG4gICAgICAgIG5hdGl2ZVZpZXcubGVmdEJvcmRlckxheWVyLnJlbW92ZUZyb21TdXBlcmxheWVyKCk7XG4gICAgfVxufVxudmFyIHBhdHRlcm4gPSAvdXJsXFwoKCd8XCIpKC4qPylcXDFcXCkvO1xuZnVuY3Rpb24gc2V0VUlDb2xvckZyb21JbWFnZSh2aWV3LCBuYXRpdmVWaWV3LCBjYWxsYmFjaywgZmxpcCkge1xuICAgIHZhciBmcmFtZSA9IG5hdGl2ZVZpZXcuZnJhbWU7XG4gICAgdmFyIGJvdW5kc1dpZHRoID0gdmlldy5zY2FsZVggPyBmcmFtZS5zaXplLndpZHRoIC8gdmlldy5zY2FsZVggOiBmcmFtZS5zaXplLndpZHRoO1xuICAgIHZhciBib3VuZHNIZWlnaHQgPSB2aWV3LnNjYWxlWSA/IGZyYW1lLnNpemUuaGVpZ2h0IC8gdmlldy5zY2FsZVkgOiBmcmFtZS5zaXplLmhlaWdodDtcbiAgICBpZiAoIWJvdW5kc1dpZHRoIHx8ICFib3VuZHNIZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICB2YXIgYmFja2dyb3VuZCA9IHN0eWxlLmJhY2tncm91bmRJbnRlcm5hbDtcbiAgICB2YXIgaW1hZ2VVcmkgPSBiYWNrZ3JvdW5kLmltYWdlO1xuICAgIGlmIChpbWFnZVVyaSkge1xuICAgICAgICB2YXIgbWF0Y2ggPSBpbWFnZVVyaS5tYXRjaChwYXR0ZXJuKTtcbiAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAgICAgICBpbWFnZVVyaSA9IG1hdGNoWzJdO1xuICAgICAgICB9XG4gICAgfVxuICAgIHZhciBiaXRtYXA7XG4gICAgaWYgKHV0aWxzXzEuaXNEYXRhVVJJKGltYWdlVXJpKSkge1xuICAgICAgICB2YXIgYmFzZTY0RGF0YSA9IGltYWdlVXJpLnNwbGl0KFwiLFwiKVsxXTtcbiAgICAgICAgaWYgKGJhc2U2NERhdGEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgdmFyIGltYWdlU291cmNlID0gaW1hZ2Vfc291cmNlXzEuZnJvbUJhc2U2NChiYXNlNjREYXRhKTtcbiAgICAgICAgICAgIGJpdG1hcCA9IGltYWdlU291cmNlICYmIGltYWdlU291cmNlLmlvcztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh1dGlsc18xLmlzRmlsZU9yUmVzb3VyY2VQYXRoKGltYWdlVXJpKSkge1xuICAgICAgICB2YXIgaW1hZ2VTb3VyY2UgPSBpbWFnZV9zb3VyY2VfMS5mcm9tRmlsZU9yUmVzb3VyY2UoaW1hZ2VVcmkpO1xuICAgICAgICBiaXRtYXAgPSBpbWFnZVNvdXJjZSAmJiBpbWFnZVNvdXJjZS5pb3M7XG4gICAgfVxuICAgIGVsc2UgaWYgKGltYWdlVXJpLmluZGV4T2YoXCJodHRwXCIpICE9PSAtMSkge1xuICAgICAgICBzdHlsZVtzeW1ib2xVcmxdID0gaW1hZ2VVcmk7XG4gICAgICAgIGltYWdlX3NvdXJjZV8xLmZyb21VcmwoaW1hZ2VVcmkpLnRoZW4oZnVuY3Rpb24gKHIpIHtcbiAgICAgICAgICAgIGlmIChzdHlsZSAmJiBzdHlsZVtzeW1ib2xVcmxdID09PSBpbWFnZVVyaSkge1xuICAgICAgICAgICAgICAgIHVpQ29sb3JGcm9tSW1hZ2Uoci5pb3MsIHZpZXcsIGNhbGxiYWNrLCBmbGlwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHVpQ29sb3JGcm9tSW1hZ2UoYml0bWFwLCB2aWV3LCBjYWxsYmFjaywgZmxpcCk7XG59XG5mdW5jdGlvbiBwYXJzZVBvc2l0aW9uKHBvcykge1xuICAgIHZhciB2YWx1ZXMgPSBjc3NfdmFsdWVfMS5wYXJzZShwb3MpO1xuICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIHJldHVybiB7IHg6IHZhbHVlc1swXSwgeTogdmFsdWVzWzFdIH07XG4gICAgfVxuICAgIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxICYmIHZhbHVlc1swXS50eXBlID09PSBcImlkZW50XCIpIHtcbiAgICAgICAgdmFyIHZhbCA9IHZhbHVlc1swXS5zdHJpbmcudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICAgICAgdmFyIGNlbnRlciA9IHsgdHlwZTogXCJpZGVudFwiLCBzdHJpbmc6IFwiY2VudGVyXCIgfTtcbiAgICAgICAgaWYgKHZhbCA9PT0gXCJsZWZ0XCIgfHwgdmFsID09PSBcInJpZ2h0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHg6IHZhbHVlc1swXSwgeTogY2VudGVyIH07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsID09PSBcInRvcFwiIHx8IHZhbCA9PT0gXCJib3R0b21cIikge1xuICAgICAgICAgICAgcmV0dXJuIHsgeDogY2VudGVyLCB5OiB2YWx1ZXNbMF0gfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWwgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiB7IHg6IGNlbnRlciwgeTogY2VudGVyIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5mdW5jdGlvbiBnZXREcmF3UGFyYW1zKGltYWdlLCBiYWNrZ3JvdW5kLCB3aWR0aCwgaGVpZ2h0KSB7XG4gICAgaWYgKCFpbWFnZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgdmFyIHJlcyA9IHtcbiAgICAgICAgcmVwZWF0WDogdHJ1ZSxcbiAgICAgICAgcmVwZWF0WTogdHJ1ZSxcbiAgICAgICAgcG9zWDogMCxcbiAgICAgICAgcG9zWTogMCxcbiAgICB9O1xuICAgIGlmIChiYWNrZ3JvdW5kLnJlcGVhdCkge1xuICAgICAgICBzd2l0Y2ggKGJhY2tncm91bmQucmVwZWF0LnRvTG93ZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIGNhc2UgXCJuby1yZXBlYXRcIjpcbiAgICAgICAgICAgICAgICByZXMucmVwZWF0WCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJlcy5yZXBlYXRZID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmVwZWF0LXhcIjpcbiAgICAgICAgICAgICAgICByZXMucmVwZWF0WSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJlcGVhdC15XCI6XG4gICAgICAgICAgICAgICAgcmVzLnJlcGVhdFggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgaW1hZ2VTaXplID0gaW1hZ2Uuc2l6ZTtcbiAgICB2YXIgaW1hZ2VXaWR0aCA9IGltYWdlU2l6ZS53aWR0aDtcbiAgICB2YXIgaW1hZ2VIZWlnaHQgPSBpbWFnZVNpemUuaGVpZ2h0O1xuICAgIHZhciBzaXplID0gYmFja2dyb3VuZC5zaXplO1xuICAgIGlmIChzaXplKSB7XG4gICAgICAgIHZhciB2YWx1ZXMgPSBjc3NfdmFsdWVfMS5wYXJzZShzaXplKTtcbiAgICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHZhciB2eCA9IHZhbHVlc1swXTtcbiAgICAgICAgICAgIHZhciB2eSA9IHZhbHVlc1sxXTtcbiAgICAgICAgICAgIGlmICh2eC51bml0ID09PSBcIiVcIiAmJiB2eS51bml0ID09PSBcIiVcIikge1xuICAgICAgICAgICAgICAgIGltYWdlV2lkdGggPSB3aWR0aCAqIHZ4LnZhbHVlIC8gMTAwO1xuICAgICAgICAgICAgICAgIGltYWdlSGVpZ2h0ID0gaGVpZ2h0ICogdnkudmFsdWUgLyAxMDA7XG4gICAgICAgICAgICAgICAgcmVzLnNpemVYID0gaW1hZ2VXaWR0aDtcbiAgICAgICAgICAgICAgICByZXMuc2l6ZVkgPSBpbWFnZUhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZ4LnR5cGUgPT09IFwibnVtYmVyXCIgJiYgdnkudHlwZSA9PT0gXCJudW1iZXJcIiAmJlxuICAgICAgICAgICAgICAgICgodngudW5pdCA9PT0gXCJweFwiICYmIHZ5LnVuaXQgPT09IFwicHhcIikgfHwgKHZ4LnVuaXQgPT09IFwiXCIgJiYgdnkudW5pdCA9PT0gXCJcIikpKSB7XG4gICAgICAgICAgICAgICAgaW1hZ2VXaWR0aCA9IHZ4LnZhbHVlO1xuICAgICAgICAgICAgICAgIGltYWdlSGVpZ2h0ID0gdnkudmFsdWU7XG4gICAgICAgICAgICAgICAgcmVzLnNpemVYID0gaW1hZ2VXaWR0aDtcbiAgICAgICAgICAgICAgICByZXMuc2l6ZVkgPSBpbWFnZUhlaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZXMubGVuZ3RoID09PSAxICYmIHZhbHVlc1swXS50eXBlID09PSBcImlkZW50XCIpIHtcbiAgICAgICAgICAgIHZhciBzY2FsZSA9IDA7XG4gICAgICAgICAgICBpZiAodmFsdWVzWzBdLnN0cmluZyA9PT0gXCJjb3ZlclwiKSB7XG4gICAgICAgICAgICAgICAgc2NhbGUgPSBNYXRoLm1heCh3aWR0aCAvIGltYWdlV2lkdGgsIGhlaWdodCAvIGltYWdlSGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlc1swXS5zdHJpbmcgPT09IFwiY29udGFpblwiKSB7XG4gICAgICAgICAgICAgICAgc2NhbGUgPSBNYXRoLm1pbih3aWR0aCAvIGltYWdlV2lkdGgsIGhlaWdodCAvIGltYWdlSGVpZ2h0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzY2FsZSA+IDApIHtcbiAgICAgICAgICAgICAgICBpbWFnZVdpZHRoICo9IHNjYWxlO1xuICAgICAgICAgICAgICAgIGltYWdlSGVpZ2h0ICo9IHNjYWxlO1xuICAgICAgICAgICAgICAgIHJlcy5zaXplWCA9IGltYWdlV2lkdGg7XG4gICAgICAgICAgICAgICAgcmVzLnNpemVZID0gaW1hZ2VIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgdmFyIHBvc2l0aW9uID0gYmFja2dyb3VuZC5wb3NpdGlvbjtcbiAgICBpZiAocG9zaXRpb24pIHtcbiAgICAgICAgdmFyIHYgPSBwYXJzZVBvc2l0aW9uKHBvc2l0aW9uKTtcbiAgICAgICAgaWYgKHYpIHtcbiAgICAgICAgICAgIHZhciBzcGFjZVggPSB3aWR0aCAtIGltYWdlV2lkdGg7XG4gICAgICAgICAgICB2YXIgc3BhY2VZID0gaGVpZ2h0IC0gaW1hZ2VIZWlnaHQ7XG4gICAgICAgICAgICBpZiAodi54LnVuaXQgPT09IFwiJVwiICYmIHYueS51bml0ID09PSBcIiVcIikge1xuICAgICAgICAgICAgICAgIHJlcy5wb3NYID0gc3BhY2VYICogdi54LnZhbHVlIC8gMTAwO1xuICAgICAgICAgICAgICAgIHJlcy5wb3NZID0gc3BhY2VZICogdi55LnZhbHVlIC8gMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodi54LnR5cGUgPT09IFwibnVtYmVyXCIgJiYgdi55LnR5cGUgPT09IFwibnVtYmVyXCIgJiZcbiAgICAgICAgICAgICAgICAoKHYueC51bml0ID09PSBcInB4XCIgJiYgdi55LnVuaXQgPT09IFwicHhcIikgfHwgKHYueC51bml0ID09PSBcIlwiICYmIHYueS51bml0ID09PSBcIlwiKSkpIHtcbiAgICAgICAgICAgICAgICByZXMucG9zWCA9IHYueC52YWx1ZTtcbiAgICAgICAgICAgICAgICByZXMucG9zWSA9IHYueS52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHYueC50eXBlID09PSBcImlkZW50XCIgJiYgdi55LnR5cGUgPT09IFwiaWRlbnRcIikge1xuICAgICAgICAgICAgICAgIGlmICh2Lnguc3RyaW5nLnRvTG93ZXJDYXNlKCkgPT09IFwiY2VudGVyXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzLnBvc1ggPSBzcGFjZVggLyAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh2Lnguc3RyaW5nLnRvTG93ZXJDYXNlKCkgPT09IFwicmlnaHRcIikge1xuICAgICAgICAgICAgICAgICAgICByZXMucG9zWCA9IHNwYWNlWDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHYueS5zdHJpbmcudG9Mb3dlckNhc2UoKSA9PT0gXCJjZW50ZXJcIikge1xuICAgICAgICAgICAgICAgICAgICByZXMucG9zWSA9IHNwYWNlWSAvIDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHYueS5zdHJpbmcudG9Mb3dlckNhc2UoKSA9PT0gXCJib3R0b21cIikge1xuICAgICAgICAgICAgICAgICAgICByZXMucG9zWSA9IHNwYWNlWTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlcztcbn1cbmZ1bmN0aW9uIHVpQ29sb3JGcm9tSW1hZ2UoaW1nLCB2aWV3LCBjYWxsYmFjaywgZmxpcCkge1xuICAgIHZhciBiYWNrZ3JvdW5kID0gdmlldy5zdHlsZS5iYWNrZ3JvdW5kSW50ZXJuYWw7XG4gICAgaWYgKCFpbWcpIHtcbiAgICAgICAgY2FsbGJhY2soYmFja2dyb3VuZC5jb2xvciAmJiBiYWNrZ3JvdW5kLmNvbG9yLmlvcyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIG5hdGl2ZVZpZXcgPSB2aWV3Lm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgdmFyIGZyYW1lID0gbmF0aXZlVmlldy5mcmFtZTtcbiAgICB2YXIgYm91bmRzV2lkdGggPSB2aWV3LnNjYWxlWCA/IGZyYW1lLnNpemUud2lkdGggLyB2aWV3LnNjYWxlWCA6IGZyYW1lLnNpemUud2lkdGg7XG4gICAgdmFyIGJvdW5kc0hlaWdodCA9IHZpZXcuc2NhbGVZID8gZnJhbWUuc2l6ZS5oZWlnaHQgLyB2aWV3LnNjYWxlWSA6IGZyYW1lLnNpemUuaGVpZ2h0O1xuICAgIHZhciBwYXJhbXMgPSBnZXREcmF3UGFyYW1zKGltZywgYmFja2dyb3VuZCwgYm91bmRzV2lkdGgsIGJvdW5kc0hlaWdodCk7XG4gICAgaWYgKHBhcmFtcy5zaXplWCA+IDAgJiYgcGFyYW1zLnNpemVZID4gMCkge1xuICAgICAgICB2YXIgcmVzaXplUmVjdCA9IENHUmVjdE1ha2UoMCwgMCwgcGFyYW1zLnNpemVYLCBwYXJhbXMuc2l6ZVkpO1xuICAgICAgICBVSUdyYXBoaWNzQmVnaW5JbWFnZUNvbnRleHRXaXRoT3B0aW9ucyhyZXNpemVSZWN0LnNpemUsIGZhbHNlLCAwLjApO1xuICAgICAgICBpbWcuZHJhd0luUmVjdChyZXNpemVSZWN0KTtcbiAgICAgICAgaW1nID0gVUlHcmFwaGljc0dldEltYWdlRnJvbUN1cnJlbnRJbWFnZUNvbnRleHQoKTtcbiAgICAgICAgVUlHcmFwaGljc0VuZEltYWdlQ29udGV4dCgpO1xuICAgIH1cbiAgICBVSUdyYXBoaWNzQmVnaW5JbWFnZUNvbnRleHRXaXRoT3B0aW9ucyhDR1NpemVGcm9tU3RyaW5nKFwie1wiICsgYm91bmRzV2lkdGggKyBcIixcIiArIGJvdW5kc0hlaWdodCArIFwifVwiKSwgZmFsc2UsIDAuMCk7XG4gICAgdmFyIGNvbnRleHQgPSBVSUdyYXBoaWNzR2V0Q3VycmVudENvbnRleHQoKTtcbiAgICBpZiAoYmFja2dyb3VuZC5jb2xvciAmJiBiYWNrZ3JvdW5kLmNvbG9yLmlvcykge1xuICAgICAgICBDR0NvbnRleHRTZXRGaWxsQ29sb3JXaXRoQ29sb3IoY29udGV4dCwgYmFja2dyb3VuZC5jb2xvci5pb3MuQ0dDb2xvcik7XG4gICAgICAgIENHQ29udGV4dEZpbGxSZWN0KGNvbnRleHQsIENHUmVjdE1ha2UoMCwgMCwgYm91bmRzV2lkdGgsIGJvdW5kc0hlaWdodCkpO1xuICAgIH1cbiAgICBpZiAoIXBhcmFtcy5yZXBlYXRYICYmICFwYXJhbXMucmVwZWF0WSkge1xuICAgICAgICBpbWcuZHJhd0F0UG9pbnQoQ0dQb2ludE1ha2UocGFyYW1zLnBvc1gsIHBhcmFtcy5wb3NZKSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgdyA9IHBhcmFtcy5yZXBlYXRYID8gYm91bmRzV2lkdGggOiBpbWcuc2l6ZS53aWR0aDtcbiAgICAgICAgdmFyIGggPSBwYXJhbXMucmVwZWF0WSA/IGJvdW5kc0hlaWdodCA6IGltZy5zaXplLmhlaWdodDtcbiAgICAgICAgQ0dDb250ZXh0U2V0UGF0dGVyblBoYXNlKGNvbnRleHQsIENHU2l6ZU1ha2UocGFyYW1zLnBvc1gsIHBhcmFtcy5wb3NZKSk7XG4gICAgICAgIHBhcmFtcy5wb3NYID0gcGFyYW1zLnJlcGVhdFggPyAwIDogcGFyYW1zLnBvc1g7XG4gICAgICAgIHBhcmFtcy5wb3NZID0gcGFyYW1zLnJlcGVhdFkgPyAwIDogcGFyYW1zLnBvc1k7XG4gICAgICAgIHZhciBwYXR0ZXJuUmVjdCA9IENHUmVjdE1ha2UocGFyYW1zLnBvc1gsIHBhcmFtcy5wb3NZLCB3LCBoKTtcbiAgICAgICAgaW1nLmRyYXdBc1BhdHRlcm5JblJlY3QocGF0dGVyblJlY3QpO1xuICAgIH1cbiAgICB2YXIgYmtnSW1hZ2UgPSBVSUdyYXBoaWNzR2V0SW1hZ2VGcm9tQ3VycmVudEltYWdlQ29udGV4dCgpO1xuICAgIFVJR3JhcGhpY3NFbmRJbWFnZUNvbnRleHQoKTtcbiAgICBpZiAoZmxpcCkge1xuICAgICAgICB2YXIgZmxpcHBlZEltYWdlID0gX2ZsaXBJbWFnZShia2dJbWFnZSk7XG4gICAgICAgIGNhbGxiYWNrKFVJQ29sb3IuYWxsb2MoKS5pbml0V2l0aFBhdHRlcm5JbWFnZShmbGlwcGVkSW1hZ2UpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNhbGxiYWNrKFVJQ29sb3IuYWxsb2MoKS5pbml0V2l0aFBhdHRlcm5JbWFnZShia2dJbWFnZSkpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIF9mbGlwSW1hZ2Uob3JpZ2luYWxJbWFnZSkge1xuICAgIFVJR3JhcGhpY3NCZWdpbkltYWdlQ29udGV4dFdpdGhPcHRpb25zKG9yaWdpbmFsSW1hZ2Uuc2l6ZSwgZmFsc2UsIDAuMCk7XG4gICAgdmFyIGNvbnRleHQgPSBVSUdyYXBoaWNzR2V0Q3VycmVudENvbnRleHQoKTtcbiAgICBDR0NvbnRleHRTYXZlR1N0YXRlKGNvbnRleHQpO1xuICAgIENHQ29udGV4dFRyYW5zbGF0ZUNUTShjb250ZXh0LCAwLjAsIG9yaWdpbmFsSW1hZ2Uuc2l6ZS5oZWlnaHQpO1xuICAgIENHQ29udGV4dFNjYWxlQ1RNKGNvbnRleHQsIDEuMCwgLTEuMCk7XG4gICAgb3JpZ2luYWxJbWFnZS5kcmF3SW5SZWN0KENHUmVjdE1ha2UoMCwgMCwgb3JpZ2luYWxJbWFnZS5zaXplLndpZHRoLCBvcmlnaW5hbEltYWdlLnNpemUuaGVpZ2h0KSk7XG4gICAgQ0dDb250ZXh0UmVzdG9yZUdTdGF0ZShjb250ZXh0KTtcbiAgICB2YXIgZmxpcHBlZEltYWdlID0gVUlHcmFwaGljc0dldEltYWdlRnJvbUN1cnJlbnRJbWFnZUNvbnRleHQoKTtcbiAgICBVSUdyYXBoaWNzRW5kSW1hZ2VDb250ZXh0KCk7XG4gICAgcmV0dXJuIGZsaXBwZWRJbWFnZTtcbn1cbmZ1bmN0aW9uIGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhzb3VyY2UsIHRvdGFsKSB7XG4gICAgc291cmNlID0gc291cmNlLnRyaW0oKTtcbiAgICBpZiAoc291cmNlLmluZGV4T2YoXCJweFwiKSAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMocGFyc2VGbG9hdChzb3VyY2UucmVwbGFjZShcInB4XCIsIFwiXCIpKSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKHNvdXJjZS5pbmRleE9mKFwiJVwiKSAhPT0gLTEgJiYgdG90YWwgPiAwKSB7XG4gICAgICAgIHJldHVybiAocGFyc2VGbG9hdChzb3VyY2UucmVwbGFjZShcIiVcIiwgXCJcIikpIC8gMTAwKSAqIHRvdGFsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQoc291cmNlKTtcbiAgICB9XG59XG5mdW5jdGlvbiBkcmF3VW5pZm9ybUNvbG9yTm9uVW5pZm9ybUJvcmRlcnMobmF0aXZlVmlldywgYmFja2dyb3VuZCkge1xuICAgIHZhciBsYXllciA9IG5hdGl2ZVZpZXcubGF5ZXI7XG4gICAgbGF5ZXIuYmFja2dyb3VuZENvbG9yID0gdW5kZWZpbmVkO1xuICAgIGxheWVyLmJvcmRlckNvbG9yID0gdW5kZWZpbmVkO1xuICAgIGxheWVyLmJvcmRlcldpZHRoID0gMDtcbiAgICBsYXllci5jb3JuZXJSYWRpdXMgPSAwO1xuICAgIHZhciBfYSA9IGxheWVyLmJvdW5kcy5zaXplLCB3aWR0aCA9IF9hLndpZHRoLCBoZWlnaHQgPSBfYS5oZWlnaHQ7XG4gICAgdmFyIF9iID0gbGF5ZXIuYm91bmRzLm9yaWdpbiwgeCA9IF9iLngsIHkgPSBfYi55O1xuICAgIHZhciBsZWZ0ID0geDtcbiAgICB2YXIgdG9wID0geTtcbiAgICB2YXIgcmlnaHQgPSB4ICsgd2lkdGg7XG4gICAgdmFyIGJvdHRvbSA9IHkgKyBoZWlnaHQ7XG4gICAgdmFyIG1pbiA9IE1hdGgubWluLCBtYXggPSBNYXRoLm1heDtcbiAgICB2YXIgYm9yZGVyVG9wV2lkdGggPSBtYXgoMCwgdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlclRvcFdpZHRoKSk7XG4gICAgdmFyIGJvcmRlclJpZ2h0V2lkdGggPSBtYXgoMCwgdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0V2lkdGgpKTtcbiAgICB2YXIgYm9yZGVyQm90dG9tV2lkdGggPSBtYXgoMCwgdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlckJvdHRvbVdpZHRoKSk7XG4gICAgdmFyIGJvcmRlckxlZnRXaWR0aCA9IG1heCgwLCB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyTGVmdFdpZHRoKSk7XG4gICAgdmFyIGJvcmRlclZXaWR0aCA9IGJvcmRlclRvcFdpZHRoICsgYm9yZGVyQm90dG9tV2lkdGg7XG4gICAgdmFyIGJvcmRlckhXaWR0aCA9IGJvcmRlckxlZnRXaWR0aCArIGJvcmRlclJpZ2h0V2lkdGg7XG4gICAgdmFyIGNhcHBlZEJvcmRlclRvcFdpZHRoID0gYm9yZGVyVG9wV2lkdGggJiYgYm9yZGVyVG9wV2lkdGggKiBtaW4oMSwgaGVpZ2h0IC8gYm9yZGVyVldpZHRoKTtcbiAgICB2YXIgY2FwcGVkQm9yZGVyUmlnaHRXaWR0aCA9IGJvcmRlclJpZ2h0V2lkdGggJiYgYm9yZGVyUmlnaHRXaWR0aCAqIG1pbigxLCB3aWR0aCAvIGJvcmRlckhXaWR0aCk7XG4gICAgdmFyIGNhcHBlZEJvcmRlckJvdHRvbVdpZHRoID0gYm9yZGVyQm90dG9tV2lkdGggJiYgYm9yZGVyQm90dG9tV2lkdGggKiBtaW4oMSwgaGVpZ2h0IC8gYm9yZGVyVldpZHRoKTtcbiAgICB2YXIgY2FwcGVkQm9yZGVyTGVmdFdpZHRoID0gYm9yZGVyTGVmdFdpZHRoICYmIGJvcmRlckxlZnRXaWR0aCAqIG1pbigxLCB3aWR0aCAvIGJvcmRlckhXaWR0aCk7XG4gICAgdmFyIG91dGVyVG9wTGVmdFJhZGl1cyA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJUb3BMZWZ0UmFkaXVzKTtcbiAgICB2YXIgb3V0ZXJUb3BSaWdodFJhZGl1cyA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJUb3BSaWdodFJhZGl1cyk7XG4gICAgdmFyIG91dGVyQm90dG9tUmlnaHRSYWRpdXMgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXMpO1xuICAgIHZhciBvdXRlckJvdHRvbUxlZnRSYWRpdXMgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyQm90dG9tTGVmdFJhZGl1cyk7XG4gICAgdmFyIHRvcFJhZGlpID0gb3V0ZXJUb3BMZWZ0UmFkaXVzICsgb3V0ZXJUb3BSaWdodFJhZGl1cztcbiAgICB2YXIgcmlnaHRSYWRpaSA9IG91dGVyVG9wUmlnaHRSYWRpdXMgKyBvdXRlckJvdHRvbVJpZ2h0UmFkaXVzO1xuICAgIHZhciBib3R0b21SYWRpaSA9IG91dGVyQm90dG9tUmlnaHRSYWRpdXMgKyBvdXRlckJvdHRvbUxlZnRSYWRpdXM7XG4gICAgdmFyIGxlZnRSYWRpaSA9IG91dGVyQm90dG9tTGVmdFJhZGl1cyArIG91dGVyVG9wTGVmdFJhZGl1cztcbiAgICBmdW5jdGlvbiBjYXBSYWRpdXMoYSwgYiwgYykge1xuICAgICAgICByZXR1cm4gYSAmJiBNYXRoLm1pbihhLCBNYXRoLm1pbihiLCBjKSk7XG4gICAgfVxuICAgIHZhciBjYXBwZWRPdXRlclRvcExlZnRSYWRpdXMgPSBjYXBSYWRpdXMob3V0ZXJUb3BMZWZ0UmFkaXVzLCBvdXRlclRvcExlZnRSYWRpdXMgLyB0b3BSYWRpaSAqIHdpZHRoLCBvdXRlclRvcExlZnRSYWRpdXMgLyBsZWZ0UmFkaWkgKiBoZWlnaHQpO1xuICAgIHZhciBjYXBwZWRPdXRlclRvcFJpZ2h0UmFkaXVzID0gY2FwUmFkaXVzKG91dGVyVG9wUmlnaHRSYWRpdXMsIG91dGVyVG9wUmlnaHRSYWRpdXMgLyB0b3BSYWRpaSAqIHdpZHRoLCBvdXRlclRvcFJpZ2h0UmFkaXVzIC8gcmlnaHRSYWRpaSAqIGhlaWdodCk7XG4gICAgdmFyIGNhcHBlZE91dGVyQm90dG9tUmlnaHRSYWRpdXMgPSBjYXBSYWRpdXMob3V0ZXJCb3R0b21SaWdodFJhZGl1cywgb3V0ZXJCb3R0b21SaWdodFJhZGl1cyAvIGJvdHRvbVJhZGlpICogd2lkdGgsIG91dGVyQm90dG9tUmlnaHRSYWRpdXMgLyByaWdodFJhZGlpICogaGVpZ2h0KTtcbiAgICB2YXIgY2FwcGVkT3V0ZXJCb3R0b21MZWZ0UmFkaXVzID0gY2FwUmFkaXVzKG91dGVyQm90dG9tTGVmdFJhZGl1cywgb3V0ZXJCb3R0b21MZWZ0UmFkaXVzIC8gYm90dG9tUmFkaWkgKiB3aWR0aCwgb3V0ZXJCb3R0b21MZWZ0UmFkaXVzIC8gbGVmdFJhZGlpICogaGVpZ2h0KTtcbiAgICB2YXIgY2xpcFBhdGggPSBDR1BhdGhDcmVhdGVNdXRhYmxlKCk7XG4gICAgQ0dQYXRoTW92ZVRvUG9pbnQoY2xpcFBhdGgsIG51bGwsIGxlZnQgKyBjYXBwZWRPdXRlclRvcExlZnRSYWRpdXMsIHRvcCk7XG4gICAgQ0dQYXRoQWRkQXJjVG9Qb2ludChjbGlwUGF0aCwgbnVsbCwgcmlnaHQsIHRvcCwgcmlnaHQsIHRvcCArIGNhcHBlZE91dGVyVG9wUmlnaHRSYWRpdXMsIGNhcHBlZE91dGVyVG9wUmlnaHRSYWRpdXMpO1xuICAgIENHUGF0aEFkZEFyY1RvUG9pbnQoY2xpcFBhdGgsIG51bGwsIHJpZ2h0LCBib3R0b20sIHJpZ2h0IC0gY2FwcGVkT3V0ZXJCb3R0b21SaWdodFJhZGl1cywgYm90dG9tLCBjYXBwZWRPdXRlckJvdHRvbVJpZ2h0UmFkaXVzKTtcbiAgICBDR1BhdGhBZGRBcmNUb1BvaW50KGNsaXBQYXRoLCBudWxsLCBsZWZ0LCBib3R0b20sIGxlZnQsIGJvdHRvbSAtIGNhcHBlZE91dGVyQm90dG9tTGVmdFJhZGl1cywgY2FwcGVkT3V0ZXJCb3R0b21MZWZ0UmFkaXVzKTtcbiAgICBDR1BhdGhBZGRBcmNUb1BvaW50KGNsaXBQYXRoLCBudWxsLCBsZWZ0LCB0b3AsIGxlZnQgKyBjYXBwZWRPdXRlclRvcExlZnRSYWRpdXMsIHRvcCwgY2FwcGVkT3V0ZXJUb3BMZWZ0UmFkaXVzKTtcbiAgICBDR1BhdGhDbG9zZVN1YnBhdGgoY2xpcFBhdGgpO1xuICAgIG5hdGl2ZVZpZXcuYm9yZGVyT3JpZ2luYWxNYXNrID0gbGF5ZXIubWFzaztcbiAgICB2YXIgY2xpcFNoYXBlTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICBjbGlwU2hhcGVMYXllci5wYXRoID0gY2xpcFBhdGg7XG4gICAgbGF5ZXIubWFzayA9IGNsaXBTaGFwZUxheWVyO1xuICAgIG5hdGl2ZVZpZXcuaGFzQm9yZGVyTWFzayA9IHRydWU7XG4gICAgaWYgKGNhcHBlZEJvcmRlckxlZnRXaWR0aCA+IDAgfHwgY2FwcGVkQm9yZGVyVG9wV2lkdGggPiAwIHx8IGNhcHBlZEJvcmRlclJpZ2h0V2lkdGggPiAwIHx8IGNhcHBlZEJvcmRlckJvdHRvbVdpZHRoID4gMCkge1xuICAgICAgICB2YXIgYm9yZGVyUGF0aCA9IENHUGF0aENyZWF0ZU11dGFibGUoKTtcbiAgICAgICAgQ0dQYXRoQWRkUmVjdChib3JkZXJQYXRoLCBudWxsLCBDR1JlY3RNYWtlKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCkpO1xuICAgICAgICBpZiAoY2FwcGVkQm9yZGVyVG9wV2lkdGggPiAwIHx8IGNhcHBlZEJvcmRlckxlZnRXaWR0aCA+IDApIHtcbiAgICAgICAgICAgIENHUGF0aE1vdmVUb1BvaW50KGJvcmRlclBhdGgsIG51bGwsIGxlZnQgKyBjYXBwZWRPdXRlclRvcExlZnRSYWRpdXMsIHRvcCArIGNhcHBlZEJvcmRlclRvcFdpZHRoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIENHUGF0aE1vdmVUb1BvaW50KGJvcmRlclBhdGgsIG51bGwsIGxlZnQsIHRvcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhcHBlZEJvcmRlclRvcFdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJSaWdodFdpZHRoID4gMCkge1xuICAgICAgICAgICAgdmFyIGlubmVyVG9wUmlnaHRXUmFkaXVzID0gbWF4KDAsIGNhcHBlZE91dGVyVG9wUmlnaHRSYWRpdXMgLSBjYXBwZWRCb3JkZXJSaWdodFdpZHRoKTtcbiAgICAgICAgICAgIHZhciBpbm5lclRvcFJpZ2h0SFJhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlclRvcFJpZ2h0UmFkaXVzIC0gY2FwcGVkQm9yZGVyVG9wV2lkdGgpO1xuICAgICAgICAgICAgdmFyIGlubmVyVG9wUmlnaHRNYXhSYWRpdXMgPSBtYXgoaW5uZXJUb3BSaWdodFdSYWRpdXMsIGlubmVyVG9wUmlnaHRIUmFkaXVzKTtcbiAgICAgICAgICAgIHZhciBpbm5lclRvcFJpZ2h0VHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1NYWtlKGlubmVyVG9wUmlnaHRNYXhSYWRpdXMgJiYgaW5uZXJUb3BSaWdodFdSYWRpdXMgLyBpbm5lclRvcFJpZ2h0TWF4UmFkaXVzLCAwLCAwLCBpbm5lclRvcFJpZ2h0TWF4UmFkaXVzICYmIGlubmVyVG9wUmlnaHRIUmFkaXVzIC8gaW5uZXJUb3BSaWdodE1heFJhZGl1cywgcmlnaHQgLSBjYXBwZWRCb3JkZXJSaWdodFdpZHRoIC0gaW5uZXJUb3BSaWdodFdSYWRpdXMsIHRvcCArIGNhcHBlZEJvcmRlclRvcFdpZHRoICsgaW5uZXJUb3BSaWdodEhSYWRpdXMpO1xuICAgICAgICAgICAgQ0dQYXRoQWRkQXJjKGJvcmRlclBhdGgsIGlubmVyVG9wUmlnaHRUcmFuc2Zvcm0sIDAsIDAsIGlubmVyVG9wUmlnaHRNYXhSYWRpdXMsIE1hdGguUEkgKiAzIC8gMiwgMCwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgQ0dQYXRoTW92ZVRvUG9pbnQoYm9yZGVyUGF0aCwgbnVsbCwgcmlnaHQsIHRvcCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNhcHBlZEJvcmRlckJvdHRvbVdpZHRoID4gMCB8fCBjYXBwZWRCb3JkZXJSaWdodFdpZHRoID4gMCkge1xuICAgICAgICAgICAgdmFyIGlubmVyQm90dG9tUmlnaHRXUmFkaXVzID0gbWF4KDAsIGNhcHBlZE91dGVyQm90dG9tUmlnaHRSYWRpdXMgLSBjYXBwZWRCb3JkZXJSaWdodFdpZHRoKTtcbiAgICAgICAgICAgIHZhciBpbm5lckJvdHRvbVJpZ2h0SFJhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlckJvdHRvbVJpZ2h0UmFkaXVzIC0gY2FwcGVkQm9yZGVyQm90dG9tV2lkdGgpO1xuICAgICAgICAgICAgdmFyIGlubmVyQm90dG9tUmlnaHRNYXhSYWRpdXMgPSBtYXgoaW5uZXJCb3R0b21SaWdodFdSYWRpdXMsIGlubmVyQm90dG9tUmlnaHRIUmFkaXVzKTtcbiAgICAgICAgICAgIHZhciBpbm5lckJvdHRvbVJpZ2h0VHJhbnNmb3JtID0gQ0dBZmZpbmVUcmFuc2Zvcm1NYWtlKGlubmVyQm90dG9tUmlnaHRNYXhSYWRpdXMgJiYgaW5uZXJCb3R0b21SaWdodFdSYWRpdXMgLyBpbm5lckJvdHRvbVJpZ2h0TWF4UmFkaXVzLCAwLCAwLCBpbm5lckJvdHRvbVJpZ2h0TWF4UmFkaXVzICYmIGlubmVyQm90dG9tUmlnaHRIUmFkaXVzIC8gaW5uZXJCb3R0b21SaWdodE1heFJhZGl1cywgcmlnaHQgLSBjYXBwZWRCb3JkZXJSaWdodFdpZHRoIC0gaW5uZXJCb3R0b21SaWdodFdSYWRpdXMsIGJvdHRvbSAtIGNhcHBlZEJvcmRlckJvdHRvbVdpZHRoIC0gaW5uZXJCb3R0b21SaWdodEhSYWRpdXMpO1xuICAgICAgICAgICAgQ0dQYXRoQWRkQXJjKGJvcmRlclBhdGgsIGlubmVyQm90dG9tUmlnaHRUcmFuc2Zvcm0sIDAsIDAsIGlubmVyQm90dG9tUmlnaHRNYXhSYWRpdXMsIDAsIE1hdGguUEkgLyAyLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChib3JkZXJQYXRoLCBudWxsLCByaWdodCwgYm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FwcGVkQm9yZGVyQm90dG9tV2lkdGggPiAwIHx8IGNhcHBlZEJvcmRlckxlZnRXaWR0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpbm5lckJvdHRvbUxlZnRXUmFkaXVzID0gbWF4KDAsIGNhcHBlZE91dGVyQm90dG9tTGVmdFJhZGl1cyAtIGNhcHBlZEJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgICAgICB2YXIgaW5uZXJCb3R0b21MZWZ0SFJhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlckJvdHRvbUxlZnRSYWRpdXMgLSBjYXBwZWRCb3JkZXJCb3R0b21XaWR0aCk7XG4gICAgICAgICAgICB2YXIgaW5uZXJCb3R0b21MZWZ0TWF4UmFkaXVzID0gbWF4KGlubmVyQm90dG9tTGVmdFdSYWRpdXMsIGlubmVyQm90dG9tTGVmdEhSYWRpdXMpO1xuICAgICAgICAgICAgdmFyIGlubmVyQm90dG9tTGVmdFRyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtTWFrZShpbm5lckJvdHRvbUxlZnRNYXhSYWRpdXMgJiYgaW5uZXJCb3R0b21MZWZ0V1JhZGl1cyAvIGlubmVyQm90dG9tTGVmdE1heFJhZGl1cywgMCwgMCwgaW5uZXJCb3R0b21MZWZ0TWF4UmFkaXVzICYmIGlubmVyQm90dG9tTGVmdEhSYWRpdXMgLyBpbm5lckJvdHRvbUxlZnRNYXhSYWRpdXMsIGxlZnQgKyBjYXBwZWRCb3JkZXJMZWZ0V2lkdGggKyBpbm5lckJvdHRvbUxlZnRXUmFkaXVzLCBib3R0b20gLSBjYXBwZWRCb3JkZXJCb3R0b21XaWR0aCAtIGlubmVyQm90dG9tTGVmdEhSYWRpdXMpO1xuICAgICAgICAgICAgQ0dQYXRoQWRkQXJjKGJvcmRlclBhdGgsIGlubmVyQm90dG9tTGVmdFRyYW5zZm9ybSwgMCwgMCwgaW5uZXJCb3R0b21MZWZ0TWF4UmFkaXVzLCBNYXRoLlBJIC8gMiwgTWF0aC5QSSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQoYm9yZGVyUGF0aCwgbnVsbCwgbGVmdCwgYm90dG9tKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2FwcGVkQm9yZGVyVG9wV2lkdGggPiAwIHx8IGNhcHBlZEJvcmRlckxlZnRXaWR0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciBpbm5lclRvcExlZnRXUmFkaXVzID0gbWF4KDAsIGNhcHBlZE91dGVyVG9wTGVmdFJhZGl1cyAtIGNhcHBlZEJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgICAgICB2YXIgaW5uZXJUb3BMZWZ0SFJhZGl1cyA9IG1heCgwLCBjYXBwZWRPdXRlclRvcExlZnRSYWRpdXMgLSBjYXBwZWRCb3JkZXJUb3BXaWR0aCk7XG4gICAgICAgICAgICB2YXIgaW5uZXJUb3BMZWZ0TWF4UmFkaXVzID0gbWF4KGlubmVyVG9wTGVmdFdSYWRpdXMsIGlubmVyVG9wTGVmdEhSYWRpdXMpO1xuICAgICAgICAgICAgdmFyIGlubmVyVG9wTGVmdFRyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtTWFrZShpbm5lclRvcExlZnRNYXhSYWRpdXMgJiYgaW5uZXJUb3BMZWZ0V1JhZGl1cyAvIGlubmVyVG9wTGVmdE1heFJhZGl1cywgMCwgMCwgaW5uZXJUb3BMZWZ0TWF4UmFkaXVzICYmIGlubmVyVG9wTGVmdEhSYWRpdXMgLyBpbm5lclRvcExlZnRNYXhSYWRpdXMsIGxlZnQgKyBjYXBwZWRCb3JkZXJMZWZ0V2lkdGggKyBpbm5lclRvcExlZnRXUmFkaXVzLCB0b3AgKyBjYXBwZWRCb3JkZXJUb3BXaWR0aCArIGlubmVyVG9wTGVmdEhSYWRpdXMpO1xuICAgICAgICAgICAgQ0dQYXRoQWRkQXJjKGJvcmRlclBhdGgsIGlubmVyVG9wTGVmdFRyYW5zZm9ybSwgMCwgMCwgaW5uZXJUb3BMZWZ0TWF4UmFkaXVzLCBNYXRoLlBJLCBNYXRoLlBJICogMyAvIDIsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KGJvcmRlclBhdGgsIG51bGwsIGxlZnQsIHRvcCk7XG4gICAgICAgIH1cbiAgICAgICAgQ0dQYXRoQ2xvc2VTdWJwYXRoKGJvcmRlclBhdGgpO1xuICAgICAgICB2YXIgYm9yZGVyTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgYm9yZGVyTGF5ZXIuZmlsbENvbG9yID0gYmFja2dyb3VuZC5ib3JkZXJUb3BDb2xvciAmJiBiYWNrZ3JvdW5kLmJvcmRlclRvcENvbG9yLmlvcy5DR0NvbG9yIHx8IFVJQ29sb3IuYmxhY2tDb2xvci5DR0NvbG9yO1xuICAgICAgICBib3JkZXJMYXllci5maWxsUnVsZSA9IGtDQUZpbGxSdWxlRXZlbk9kZDtcbiAgICAgICAgYm9yZGVyTGF5ZXIucGF0aCA9IGJvcmRlclBhdGg7XG4gICAgICAgIGxheWVyLmFkZFN1YmxheWVyKGJvcmRlckxheWVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5ib3JkZXJMYXllciA9IGJvcmRlckxheWVyO1xuICAgIH1cbiAgICBuYXRpdmVWaWV3Lmhhc05vblVuaWZvcm1Cb3JkZXIgPSB0cnVlO1xufVxuZnVuY3Rpb24gZHJhd05vUmFkaXVzTm9uVW5pZm9ybUJvcmRlcnMobmF0aXZlVmlldywgYmFja2dyb3VuZCkge1xuICAgIHZhciBib3JkZXJMYXllciA9IENBTGF5ZXIubGF5ZXIoKTtcbiAgICBuYXRpdmVWaWV3LmxheWVyLmFkZFN1YmxheWVyKGJvcmRlckxheWVyKTtcbiAgICBuYXRpdmVWaWV3LmJvcmRlckxheWVyID0gYm9yZGVyTGF5ZXI7XG4gICAgYm9yZGVyTGF5ZXIuYm9yZGVyQ29sb3IgPSB1bmRlZmluZWQ7XG4gICAgYm9yZGVyTGF5ZXIuYm9yZGVyV2lkdGggPSAwO1xuICAgIGJvcmRlckxheWVyLmNvcm5lclJhZGl1cyA9IDA7XG4gICAgdmFyIGxheWVyQm91bmRzID0gbmF0aXZlVmlldy5sYXllci5ib3VuZHM7XG4gICAgdmFyIGxheWVyT3JpZ2luID0gbGF5ZXJCb3VuZHMub3JpZ2luO1xuICAgIHZhciBsYXllclNpemUgPSBsYXllckJvdW5kcy5zaXplO1xuICAgIHZhciBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMgPSB7XG4gICAgICAgIGxlZnQ6IGxheWVyT3JpZ2luLngsXG4gICAgICAgIHRvcDogbGF5ZXJPcmlnaW4ueSxcbiAgICAgICAgYm90dG9tOiBsYXllclNpemUuaGVpZ2h0LFxuICAgICAgICByaWdodDogbGF5ZXJTaXplLndpZHRoXG4gICAgfTtcbiAgICB2YXIgdG9wID0gdXRpbHNfMS5sYXlvdXQudG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhiYWNrZ3JvdW5kLmJvcmRlclRvcFdpZHRoKTtcbiAgICB2YXIgcmlnaHQgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyUmlnaHRXaWR0aCk7XG4gICAgdmFyIGJvdHRvbSA9IHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYmFja2dyb3VuZC5ib3JkZXJCb3R0b21XaWR0aCk7XG4gICAgdmFyIGxlZnQgPSB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGJhY2tncm91bmQuYm9yZGVyTGVmdFdpZHRoKTtcbiAgICB2YXIgbHRvID0geyB4OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMubGVmdCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLnRvcCB9O1xuICAgIHZhciBsdGkgPSB7IHg6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5sZWZ0ICsgbGVmdCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLnRvcCArIHRvcCB9O1xuICAgIHZhciBydG8gPSB7IHg6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5yaWdodCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLnRvcCB9O1xuICAgIHZhciBydGkgPSB7IHg6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5yaWdodCAtIHJpZ2h0LCB5OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMudG9wICsgdG9wIH07XG4gICAgdmFyIHJibyA9IHsgeDogbmF0aXZlVmlld0xheWVyQm91bmRzLnJpZ2h0LCB5OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMuYm90dG9tIH07XG4gICAgdmFyIHJiaSA9IHsgeDogbmF0aXZlVmlld0xheWVyQm91bmRzLnJpZ2h0IC0gcmlnaHQsIHk6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5ib3R0b20gLSBib3R0b20gfTtcbiAgICB2YXIgbGJvID0geyB4OiBuYXRpdmVWaWV3TGF5ZXJCb3VuZHMubGVmdCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLmJvdHRvbSB9O1xuICAgIHZhciBsYmkgPSB7IHg6IG5hdGl2ZVZpZXdMYXllckJvdW5kcy5sZWZ0ICsgbGVmdCwgeTogbmF0aXZlVmlld0xheWVyQm91bmRzLmJvdHRvbSAtIGJvdHRvbSB9O1xuICAgIHZhciBoYXNOb25Vbmlmb3JtQm9yZGVyO1xuICAgIHZhciBib3JkZXJUb3BDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyVG9wQ29sb3I7XG4gICAgaWYgKHRvcCA+IDAgJiYgYm9yZGVyVG9wQ29sb3IgJiYgYm9yZGVyVG9wQ29sb3IuaW9zKSB7XG4gICAgICAgIHZhciB0b3BCb3JkZXJQYXRoID0gQ0dQYXRoQ3JlYXRlTXV0YWJsZSgpO1xuICAgICAgICBDR1BhdGhNb3ZlVG9Qb2ludCh0b3BCb3JkZXJQYXRoLCBudWxsLCBsdG8ueCwgbHRvLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludCh0b3BCb3JkZXJQYXRoLCBudWxsLCBydG8ueCwgcnRvLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludCh0b3BCb3JkZXJQYXRoLCBudWxsLCBydGkueCwgcnRpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludCh0b3BCb3JkZXJQYXRoLCBudWxsLCBsdGkueCwgbHRpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludCh0b3BCb3JkZXJQYXRoLCBudWxsLCBsdG8ueCwgbHRvLnkpO1xuICAgICAgICB2YXIgdG9wQm9yZGVyTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgdG9wQm9yZGVyTGF5ZXIuZmlsbENvbG9yID0gYmFja2dyb3VuZC5ib3JkZXJUb3BDb2xvci5pb3MuQ0dDb2xvcjtcbiAgICAgICAgdG9wQm9yZGVyTGF5ZXIucGF0aCA9IHRvcEJvcmRlclBhdGg7XG4gICAgICAgIGJvcmRlckxheWVyLmFkZFN1YmxheWVyKHRvcEJvcmRlckxheWVyKTtcbiAgICAgICAgbmF0aXZlVmlldy50b3BCb3JkZXJMYXllciA9IHRvcEJvcmRlckxheWVyO1xuICAgICAgICBoYXNOb25Vbmlmb3JtQm9yZGVyID0gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIGJvcmRlclJpZ2h0Q29sb3IgPSBiYWNrZ3JvdW5kLmJvcmRlclJpZ2h0Q29sb3I7XG4gICAgaWYgKHJpZ2h0ID4gMCAmJiBib3JkZXJSaWdodENvbG9yICYmIGJvcmRlclJpZ2h0Q29sb3IuaW9zKSB7XG4gICAgICAgIHZhciByaWdodEJvcmRlclBhdGggPSBDR1BhdGhDcmVhdGVNdXRhYmxlKCk7XG4gICAgICAgIENHUGF0aE1vdmVUb1BvaW50KHJpZ2h0Qm9yZGVyUGF0aCwgbnVsbCwgcnRvLngsIHJ0by55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQocmlnaHRCb3JkZXJQYXRoLCBudWxsLCByYm8ueCwgcmJvLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChyaWdodEJvcmRlclBhdGgsIG51bGwsIHJiaS54LCByYmkueSk7XG4gICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KHJpZ2h0Qm9yZGVyUGF0aCwgbnVsbCwgcnRpLngsIHJ0aS55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQocmlnaHRCb3JkZXJQYXRoLCBudWxsLCBydG8ueCwgcnRvLnkpO1xuICAgICAgICB2YXIgcmlnaHRCb3JkZXJMYXllciA9IENBU2hhcGVMYXllci5sYXllcigpO1xuICAgICAgICByaWdodEJvcmRlckxheWVyLmZpbGxDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyUmlnaHRDb2xvci5pb3MuQ0dDb2xvcjtcbiAgICAgICAgcmlnaHRCb3JkZXJMYXllci5wYXRoID0gcmlnaHRCb3JkZXJQYXRoO1xuICAgICAgICBib3JkZXJMYXllci5hZGRTdWJsYXllcihyaWdodEJvcmRlckxheWVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5yaWdodEJvcmRlckxheWVyID0gcmlnaHRCb3JkZXJMYXllcjtcbiAgICAgICAgaGFzTm9uVW5pZm9ybUJvcmRlciA9IHRydWU7XG4gICAgfVxuICAgIHZhciBib3JkZXJCb3R0b21Db2xvciA9IGJhY2tncm91bmQuYm9yZGVyQm90dG9tQ29sb3I7XG4gICAgaWYgKGJvdHRvbSA+IDAgJiYgYm9yZGVyQm90dG9tQ29sb3IgJiYgYm9yZGVyQm90dG9tQ29sb3IuaW9zKSB7XG4gICAgICAgIHZhciBib3R0b21Cb3JkZXJQYXRoID0gQ0dQYXRoQ3JlYXRlTXV0YWJsZSgpO1xuICAgICAgICBDR1BhdGhNb3ZlVG9Qb2ludChib3R0b21Cb3JkZXJQYXRoLCBudWxsLCByYm8ueCwgcmJvLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChib3R0b21Cb3JkZXJQYXRoLCBudWxsLCBsYm8ueCwgbGJvLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChib3R0b21Cb3JkZXJQYXRoLCBudWxsLCBsYmkueCwgbGJpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChib3R0b21Cb3JkZXJQYXRoLCBudWxsLCByYmkueCwgcmJpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChib3R0b21Cb3JkZXJQYXRoLCBudWxsLCByYm8ueCwgcmJvLnkpO1xuICAgICAgICB2YXIgYm90dG9tQm9yZGVyTGF5ZXIgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgYm90dG9tQm9yZGVyTGF5ZXIuZmlsbENvbG9yID0gYmFja2dyb3VuZC5ib3JkZXJCb3R0b21Db2xvci5pb3MuQ0dDb2xvcjtcbiAgICAgICAgYm90dG9tQm9yZGVyTGF5ZXIucGF0aCA9IGJvdHRvbUJvcmRlclBhdGg7XG4gICAgICAgIGJvcmRlckxheWVyLmFkZFN1YmxheWVyKGJvdHRvbUJvcmRlckxheWVyKTtcbiAgICAgICAgbmF0aXZlVmlldy5ib3R0b21Cb3JkZXJMYXllciA9IGJvdHRvbUJvcmRlckxheWVyO1xuICAgICAgICBoYXNOb25Vbmlmb3JtQm9yZGVyID0gdHJ1ZTtcbiAgICB9XG4gICAgdmFyIGJvcmRlckxlZnRDb2xvciA9IGJhY2tncm91bmQuYm9yZGVyTGVmdENvbG9yO1xuICAgIGlmIChsZWZ0ID4gMCAmJiBib3JkZXJMZWZ0Q29sb3IgJiYgYm9yZGVyTGVmdENvbG9yLmlvcykge1xuICAgICAgICB2YXIgbGVmdEJvcmRlclBhdGggPSBDR1BhdGhDcmVhdGVNdXRhYmxlKCk7XG4gICAgICAgIENHUGF0aE1vdmVUb1BvaW50KGxlZnRCb3JkZXJQYXRoLCBudWxsLCBsYm8ueCwgbGJvLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChsZWZ0Qm9yZGVyUGF0aCwgbnVsbCwgbHRvLngsIGx0by55KTtcbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQobGVmdEJvcmRlclBhdGgsIG51bGwsIGx0aS54LCBsdGkueSk7XG4gICAgICAgIENHUGF0aEFkZExpbmVUb1BvaW50KGxlZnRCb3JkZXJQYXRoLCBudWxsLCBsYmkueCwgbGJpLnkpO1xuICAgICAgICBDR1BhdGhBZGRMaW5lVG9Qb2ludChsZWZ0Qm9yZGVyUGF0aCwgbnVsbCwgbGJvLngsIGxiby55KTtcbiAgICAgICAgdmFyIGxlZnRCb3JkZXJMYXllciA9IENBU2hhcGVMYXllci5sYXllcigpO1xuICAgICAgICBsZWZ0Qm9yZGVyTGF5ZXIuZmlsbENvbG9yID0gYmFja2dyb3VuZC5ib3JkZXJMZWZ0Q29sb3IuaW9zLkNHQ29sb3I7XG4gICAgICAgIGxlZnRCb3JkZXJMYXllci5wYXRoID0gbGVmdEJvcmRlclBhdGg7XG4gICAgICAgIGJvcmRlckxheWVyLmFkZFN1YmxheWVyKGxlZnRCb3JkZXJMYXllcik7XG4gICAgICAgIG5hdGl2ZVZpZXcubGVmdEJvcmRlckxheWVyID0gbGVmdEJvcmRlckxheWVyO1xuICAgICAgICBoYXNOb25Vbmlmb3JtQm9yZGVyID0gdHJ1ZTtcbiAgICB9XG4gICAgbmF0aXZlVmlldy5oYXNOb25Vbmlmb3JtQm9yZGVyID0gaGFzTm9uVW5pZm9ybUJvcmRlcjtcbn1cbmZ1bmN0aW9uIGRyYXdHcmFkaWVudChuYXRpdmVWaWV3LCBncmFkaWVudCkge1xuICAgIHZhciBncmFkaWVudExheWVyID0gQ0FHcmFkaWVudExheWVyLmxheWVyKCk7XG4gICAgZ3JhZGllbnRMYXllci5mcmFtZSA9IG5hdGl2ZVZpZXcuYm91bmRzO1xuICAgIG5hdGl2ZVZpZXcuZ3JhZGllbnRMYXllciA9IGdyYWRpZW50TGF5ZXI7XG4gICAgdmFyIGlvc0NvbG9ycyA9IE5TTXV0YWJsZUFycmF5LmFsbG9jKCkuaW5pdFdpdGhDYXBhY2l0eShncmFkaWVudC5jb2xvclN0b3BzLmxlbmd0aCk7XG4gICAgdmFyIGlvc1N0b3BzID0gTlNNdXRhYmxlQXJyYXkuYWxsb2MoKS5pbml0V2l0aENhcGFjaXR5KGdyYWRpZW50LmNvbG9yU3RvcHMubGVuZ3RoKTtcbiAgICB2YXIgaGFzU3RvcHMgPSBmYWxzZTtcbiAgICBncmFkaWVudC5jb2xvclN0b3BzLmZvckVhY2goZnVuY3Rpb24gKHN0b3ApIHtcbiAgICAgICAgaW9zQ29sb3JzLmFkZE9iamVjdChzdG9wLmNvbG9yLmlvcy5DR0NvbG9yKTtcbiAgICAgICAgaWYgKHN0b3Aub2Zmc2V0KSB7XG4gICAgICAgICAgICBpb3NTdG9wcy5hZGRPYmplY3Qoc3RvcC5vZmZzZXQudmFsdWUpO1xuICAgICAgICAgICAgaGFzU3RvcHMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgZ3JhZGllbnRMYXllci5jb2xvcnMgPSBpb3NDb2xvcnM7XG4gICAgaWYgKGhhc1N0b3BzKSB7XG4gICAgICAgIGdyYWRpZW50TGF5ZXIubG9jYXRpb25zID0gaW9zU3RvcHM7XG4gICAgfVxuICAgIHZhciBhbHBoYSA9IGdyYWRpZW50LmFuZ2xlIC8gKE1hdGguUEkgKiAyKTtcbiAgICB2YXIgc3RhcnRYID0gTWF0aC5wb3coTWF0aC5zaW4oTWF0aC5QSSAqIChhbHBoYSArIDAuNzUpKSwgMik7XG4gICAgdmFyIHN0YXJ0WSA9IE1hdGgucG93KE1hdGguc2luKE1hdGguUEkgKiAoYWxwaGEgKyAwLjUpKSwgMik7XG4gICAgdmFyIGVuZFggPSBNYXRoLnBvdyhNYXRoLnNpbihNYXRoLlBJICogKGFscGhhICsgMC4yNSkpLCAyKTtcbiAgICB2YXIgZW5kWSA9IE1hdGgucG93KE1hdGguc2luKE1hdGguUEkgKiBhbHBoYSksIDIpO1xuICAgIGdyYWRpZW50TGF5ZXIuc3RhcnRQb2ludCA9IHsgeDogc3RhcnRYLCB5OiBzdGFydFkgfTtcbiAgICBncmFkaWVudExheWVyLmVuZFBvaW50ID0geyB4OiBlbmRYLCB5OiBlbmRZIH07XG4gICAgbmF0aXZlVmlldy5sYXllci5pbnNlcnRTdWJsYXllckF0SW5kZXgoZ3JhZGllbnRMYXllciwgMCk7XG59XG5mdW5jdGlvbiBjbGVhckdyYWRpZW50KG5hdGl2ZVZpZXcpIHtcbiAgICBpZiAobmF0aXZlVmlldy5ncmFkaWVudExheWVyKSB7XG4gICAgICAgIG5hdGl2ZVZpZXcuZ3JhZGllbnRMYXllci5yZW1vdmVGcm9tU3VwZXJsYXllcigpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGRyYXdDbGlwUGF0aChuYXRpdmVWaWV3LCBiYWNrZ3JvdW5kKSB7XG4gICAgdmFyIGxheWVyID0gbmF0aXZlVmlldy5sYXllcjtcbiAgICB2YXIgbGF5ZXJCb3VuZHMgPSBsYXllci5ib3VuZHM7XG4gICAgdmFyIGxheWVyT3JpZ2luID0gbGF5ZXJCb3VuZHMub3JpZ2luO1xuICAgIHZhciBsYXllclNpemUgPSBsYXllckJvdW5kcy5zaXplO1xuICAgIHZhciBib3VuZHMgPSB7XG4gICAgICAgIGxlZnQ6IGxheWVyT3JpZ2luLngsXG4gICAgICAgIHRvcDogbGF5ZXJPcmlnaW4ueSxcbiAgICAgICAgYm90dG9tOiBsYXllclNpemUuaGVpZ2h0LFxuICAgICAgICByaWdodDogbGF5ZXJTaXplLndpZHRoXG4gICAgfTtcbiAgICBpZiAoYm91bmRzLnJpZ2h0ID09PSAwIHx8IGJvdW5kcy5ib3R0b20gPT09IDApIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgcGF0aDtcbiAgICB2YXIgY2xpcFBhdGggPSBiYWNrZ3JvdW5kLmNsaXBQYXRoO1xuICAgIHZhciBmdW5jdGlvbk5hbWUgPSBjbGlwUGF0aC5zdWJzdHJpbmcoMCwgY2xpcFBhdGguaW5kZXhPZihcIihcIikpO1xuICAgIHZhciB2YWx1ZSA9IGNsaXBQYXRoLnJlcGxhY2UoZnVuY3Rpb25OYW1lICsgXCIoXCIsIFwiXCIpLnJlcGxhY2UoXCIpXCIsIFwiXCIpO1xuICAgIHN3aXRjaCAoZnVuY3Rpb25OYW1lKSB7XG4gICAgICAgIGNhc2UgXCJyZWN0XCI6XG4gICAgICAgICAgICBwYXRoID0gcmVjdFBhdGgodmFsdWUsIGJvdW5kcyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImluc2V0XCI6XG4gICAgICAgICAgICBwYXRoID0gaW5zZXRQYXRoKHZhbHVlLCBib3VuZHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJjaXJjbGVcIjpcbiAgICAgICAgICAgIHBhdGggPSBjaXJjbGVQYXRoKHZhbHVlLCBib3VuZHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJlbGxpcHNlXCI6XG4gICAgICAgICAgICBwYXRoID0gZWxsaXBzZVBhdGgodmFsdWUsIGJvdW5kcyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInBvbHlnb25cIjpcbiAgICAgICAgICAgIHBhdGggPSBwb2x5Z29uUGF0aCh2YWx1ZSwgYm91bmRzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAocGF0aCkge1xuICAgICAgICB2YXIgc2hhcGUgPSBDQVNoYXBlTGF5ZXIubGF5ZXIoKTtcbiAgICAgICAgc2hhcGUucGF0aCA9IHBhdGg7XG4gICAgICAgIGxheWVyLm1hc2sgPSBzaGFwZTtcbiAgICAgICAgbmF0aXZlVmlldy5jbGlwc1RvQm91bmRzID0gdHJ1ZTtcbiAgICAgICAgdmFyIGJvcmRlcldpZHRoID0gYmFja2dyb3VuZC5nZXRVbmlmb3JtQm9yZGVyV2lkdGgoKTtcbiAgICAgICAgdmFyIGJvcmRlckNvbG9yID0gYmFja2dyb3VuZC5nZXRVbmlmb3JtQm9yZGVyQ29sb3IoKTtcbiAgICAgICAgaWYgKGJvcmRlcldpZHRoID4gMCAmJiBib3JkZXJDb2xvciBpbnN0YW5jZW9mIGNvbG9yXzEuQ29sb3IpIHtcbiAgICAgICAgICAgIHZhciBib3JkZXJMYXllciA9IENBU2hhcGVMYXllci5sYXllcigpO1xuICAgICAgICAgICAgYm9yZGVyTGF5ZXIucGF0aCA9IHBhdGg7XG4gICAgICAgICAgICBib3JkZXJMYXllci5saW5lV2lkdGggPSBib3JkZXJXaWR0aCAqIDI7XG4gICAgICAgICAgICBib3JkZXJMYXllci5zdHJva2VDb2xvciA9IGJvcmRlckNvbG9yLmlvcy5DR0NvbG9yO1xuICAgICAgICAgICAgYm9yZGVyTGF5ZXIuZmlsbENvbG9yID0gY2xlYXJDR0NvbG9yO1xuICAgICAgICAgICAgYm9yZGVyTGF5ZXIuZnJhbWUgPSBuYXRpdmVWaWV3LmJvdW5kcztcbiAgICAgICAgICAgIGxheWVyLmJvcmRlckNvbG9yID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgbGF5ZXIuYm9yZGVyV2lkdGggPSAwO1xuICAgICAgICAgICAgbGF5ZXIuYWRkU3VibGF5ZXIoYm9yZGVyTGF5ZXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcmVjdFBhdGgodmFsdWUsIGJvdW5kcykge1xuICAgIHZhciBhcnIgPSB2YWx1ZS5zcGxpdCgvW1xcc10rLyk7XG4gICAgdmFyIHRvcCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbMF0sIGJvdW5kcy50b3ApO1xuICAgIHZhciByaWdodCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbMV0sIGJvdW5kcy5yaWdodCk7XG4gICAgdmFyIGJvdHRvbSA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbMl0sIGJvdW5kcy5ib3R0b20pO1xuICAgIHZhciBsZWZ0ID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFyclszXSwgYm91bmRzLmxlZnQpO1xuICAgIHJldHVybiBVSUJlemllclBhdGguYmV6aWVyUGF0aFdpdGhSZWN0KENHUmVjdE1ha2UobGVmdCwgdG9wLCByaWdodCAtIGxlZnQsIGJvdHRvbSAtIHRvcCkpLkNHUGF0aDtcbn1cbmZ1bmN0aW9uIGluc2V0UGF0aCh2YWx1ZSwgYm91bmRzKSB7XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bXFxzXSsvKTtcbiAgICB2YXIgdG9wU3RyaW5nO1xuICAgIHZhciByaWdodFN0cmluZztcbiAgICB2YXIgYm90dG9tU3RyaW5nO1xuICAgIHZhciBsZWZ0U3RyaW5nO1xuICAgIGlmIChhcnIubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIHRvcFN0cmluZyA9IHJpZ2h0U3RyaW5nID0gYm90dG9tU3RyaW5nID0gbGVmdFN0cmluZyA9IGFyclswXTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICB0b3BTdHJpbmcgPSBib3R0b21TdHJpbmcgPSBhcnJbMF07XG4gICAgICAgIHJpZ2h0U3RyaW5nID0gbGVmdFN0cmluZyA9IGFyclsxXTtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJyLmxlbmd0aCA9PT0gMykge1xuICAgICAgICB0b3BTdHJpbmcgPSBhcnJbMF07XG4gICAgICAgIHJpZ2h0U3RyaW5nID0gbGVmdFN0cmluZyA9IGFyclsxXTtcbiAgICAgICAgYm90dG9tU3RyaW5nID0gYXJyWzJdO1xuICAgIH1cbiAgICBlbHNlIGlmIChhcnIubGVuZ3RoID09PSA0KSB7XG4gICAgICAgIHRvcFN0cmluZyA9IGFyclswXTtcbiAgICAgICAgcmlnaHRTdHJpbmcgPSBhcnJbMV07XG4gICAgICAgIGJvdHRvbVN0cmluZyA9IGFyclsyXTtcbiAgICAgICAgbGVmdFN0cmluZyA9IGFyclszXTtcbiAgICB9XG4gICAgdmFyIHRvcCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh0b3BTdHJpbmcsIGJvdW5kcy5ib3R0b20pO1xuICAgIHZhciByaWdodCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhcIjEwMCVcIiwgYm91bmRzLnJpZ2h0KSAtIGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhyaWdodFN0cmluZywgYm91bmRzLnJpZ2h0KTtcbiAgICB2YXIgYm90dG9tID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKFwiMTAwJVwiLCBib3VuZHMuYm90dG9tKSAtIGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhib3R0b21TdHJpbmcsIGJvdW5kcy5ib3R0b20pO1xuICAgIHZhciBsZWZ0ID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGxlZnRTdHJpbmcsIGJvdW5kcy5yaWdodCk7XG4gICAgcmV0dXJuIFVJQmV6aWVyUGF0aC5iZXppZXJQYXRoV2l0aFJlY3QoQ0dSZWN0TWFrZShsZWZ0LCB0b3AsIHJpZ2h0IC0gbGVmdCwgYm90dG9tIC0gdG9wKSkuQ0dQYXRoO1xufVxuZnVuY3Rpb24gY2lyY2xlUGF0aCh2YWx1ZSwgYm91bmRzKSB7XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bXFxzXSsvKTtcbiAgICB2YXIgcmFkaXVzID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFyclswXSwgKGJvdW5kcy5yaWdodCA+IGJvdW5kcy5ib3R0b20gPyBib3VuZHMuYm90dG9tIDogYm91bmRzLnJpZ2h0KSAvIDIpO1xuICAgIHZhciB5ID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFyclsyXSwgYm91bmRzLmJvdHRvbSk7XG4gICAgdmFyIHggPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzNdLCBib3VuZHMucmlnaHQpO1xuICAgIHJldHVybiBVSUJlemllclBhdGguYmV6aWVyUGF0aFdpdGhBcmNDZW50ZXJSYWRpdXNTdGFydEFuZ2xlRW5kQW5nbGVDbG9ja3dpc2UoQ0dQb2ludE1ha2UoeCwgeSksIHJhZGl1cywgMCwgMzYwLCB0cnVlKS5DR1BhdGg7XG59XG5mdW5jdGlvbiBlbGxpcHNlUGF0aCh2YWx1ZSwgYm91bmRzKSB7XG4gICAgdmFyIGFyciA9IHZhbHVlLnNwbGl0KC9bXFxzXSsvKTtcbiAgICB2YXIgclggPSBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoYXJyWzBdLCBib3VuZHMucmlnaHQpO1xuICAgIHZhciByWSA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbMV0sIGJvdW5kcy5ib3R0b20pO1xuICAgIHZhciBjWCA9IGNzc1ZhbHVlVG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyhhcnJbM10sIGJvdW5kcy5yaWdodCk7XG4gICAgdmFyIGNZID0gY3NzVmFsdWVUb0RldmljZUluZGVwZW5kZW50UGl4ZWxzKGFycls0XSwgYm91bmRzLmJvdHRvbSk7XG4gICAgdmFyIGxlZnQgPSBjWCAtIHJYO1xuICAgIHZhciB0b3AgPSBjWSAtIHJZO1xuICAgIHZhciB3aWR0aCA9IHJYICogMjtcbiAgICB2YXIgaGVpZ2h0ID0gclkgKiAyO1xuICAgIHJldHVybiBVSUJlemllclBhdGguYmV6aWVyUGF0aFdpdGhPdmFsSW5SZWN0KENHUmVjdE1ha2UobGVmdCwgdG9wLCB3aWR0aCwgaGVpZ2h0KSkuQ0dQYXRoO1xufVxuZnVuY3Rpb24gcG9seWdvblBhdGgodmFsdWUsIGJvdW5kcykge1xuICAgIHZhciBwYXRoID0gQ0dQYXRoQ3JlYXRlTXV0YWJsZSgpO1xuICAgIHZhciBmaXJzdFBvaW50O1xuICAgIHZhciBhcnIgPSB2YWx1ZS5zcGxpdCgvWyxdKy8pO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciB4eSA9IGFycltpXS50cmltKCkuc3BsaXQoL1tcXHNdKy8pO1xuICAgICAgICB2YXIgcG9pbnQgPSB7XG4gICAgICAgICAgICB4OiBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoeHlbMF0sIGJvdW5kcy5yaWdodCksXG4gICAgICAgICAgICB5OiBjc3NWYWx1ZVRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoeHlbMV0sIGJvdW5kcy5ib3R0b20pXG4gICAgICAgIH07XG4gICAgICAgIGlmICghZmlyc3RQb2ludCkge1xuICAgICAgICAgICAgZmlyc3RQb2ludCA9IHBvaW50O1xuICAgICAgICAgICAgQ0dQYXRoTW92ZVRvUG9pbnQocGF0aCwgbnVsbCwgcG9pbnQueCwgcG9pbnQueSk7XG4gICAgICAgIH1cbiAgICAgICAgQ0dQYXRoQWRkTGluZVRvUG9pbnQocGF0aCwgbnVsbCwgcG9pbnQueCwgcG9pbnQueSk7XG4gICAgfVxuICAgIENHUGF0aEFkZExpbmVUb1BvaW50KHBhdGgsIG51bGwsIGZpcnN0UG9pbnQueCwgZmlyc3RQb2ludC55KTtcbiAgICByZXR1cm4gcGF0aDtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhY2tncm91bmQuaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBlbnVtc18xID0gcmVxdWlyZShcIi4uL2VudW1zXCIpO1xudmFyIFNUWUxFX0NVUlZFX01BUCA9IE9iamVjdC5mcmVlemUoe1xuICAgIFwiZWFzZVwiOiBlbnVtc18xLkFuaW1hdGlvbkN1cnZlLmVhc2UsXG4gICAgXCJsaW5lYXJcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5saW5lYXIsXG4gICAgXCJlYXNlLWluXCI6IGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZUluLFxuICAgIFwiZWFzZS1vdXRcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlT3V0LFxuICAgIFwiZWFzZS1pbi1vdXRcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5lYXNlSW5PdXQsXG4gICAgXCJzcHJpbmdcIjogZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5zcHJpbmcsXG59KTtcbmZ1bmN0aW9uIHRpbWVDb252ZXJ0ZXIodmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgaWYgKHZhbHVlLmluZGV4T2YoXCJtc1wiKSA9PT0gLTEpIHtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICogMTAwMDtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWF4KDAuMCwgcmVzdWx0KTtcbn1cbmV4cG9ydHMudGltZUNvbnZlcnRlciA9IHRpbWVDb252ZXJ0ZXI7XG5mdW5jdGlvbiBhbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA/XG4gICAgICAgIFNUWUxFX0NVUlZFX01BUFt2YWx1ZV0gfHwgcGFyc2VDdWJpY0JlemllckN1cnZlKHZhbHVlKSA6XG4gICAgICAgIGVudW1zXzEuQW5pbWF0aW9uQ3VydmUuZWFzZTtcbn1cbmV4cG9ydHMuYW5pbWF0aW9uVGltaW5nRnVuY3Rpb25Db252ZXJ0ZXIgPSBhbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcjtcbmZ1bmN0aW9uIHBhcnNlQ3ViaWNCZXppZXJDdXJ2ZSh2YWx1ZSkge1xuICAgIHZhciBjb29yZHNTdHJpbmcgPSAvXFwoKC4qPylcXCkvLmV4ZWModmFsdWUpO1xuICAgIHZhciBjb29yZHMgPSBjb29yZHNTdHJpbmcgJiYgY29vcmRzU3RyaW5nWzFdXG4gICAgICAgIC5zcGxpdChcIixcIilcbiAgICAgICAgLm1hcChzdHJpbmdUb0JlemllQ29vcmRzKTtcbiAgICBpZiAodmFsdWUuc3RhcnRzV2l0aChcImN1YmljLWJlemllclwiKSAmJlxuICAgICAgICBjb29yZHNTdHJpbmcgJiZcbiAgICAgICAgY29vcmRzLmxlbmd0aCA9PT0gNCkge1xuICAgICAgICB2YXIgX2EgPSBjb29yZHMuc2xpY2UoKSwgeDEgPSBfYVswXSwgeDIgPSBfYVsxXSwgeTFfMSA9IF9hWzJdLCB5MiA9IF9hWzNdO1xuICAgICAgICByZXR1cm4gZW51bXNfMS5BbmltYXRpb25DdXJ2ZS5jdWJpY0Jlemllcih4MSwgeDIsIHkxXzEsIHkyKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgdmFsdWUgZm9yIGFuaW1hdGlvbjogXCIgKyB2YWx1ZSk7XG4gICAgfVxufVxuZnVuY3Rpb24gc3RyaW5nVG9CZXppZUNvb3Jkcyh2YWx1ZSkge1xuICAgIHZhciByZXN1bHQgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICBpZiAocmVzdWx0IDwgMCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG4gICAgZWxzZSBpZiAocmVzdWx0ID4gMSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbnZlcnRlcnMuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHByb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9jb3JlL3Byb3BlcnRpZXNcIik7XG52YXIga2V5ZnJhbWVfYW5pbWF0aW9uXzEgPSByZXF1aXJlKFwiLi4vYW5pbWF0aW9uL2tleWZyYW1lLWFuaW1hdGlvblwiKTtcbnZhciBjb252ZXJ0ZXJzXzEgPSByZXF1aXJlKFwiLi4vc3R5bGluZy9jb252ZXJ0ZXJzXCIpO1xudmFyIHN0eWxlX3Byb3BlcnRpZXNfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL3N0eWxlLXByb3BlcnRpZXNcIik7XG52YXIgQU5JTUFUSU9OX1BST1BFUlRZX0hBTkRMRVJTID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgXCJhbmltYXRpb24tbmFtZVwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8ubmFtZSA9IHZhbHVlOyB9LFxuICAgIFwiYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5kdXJhdGlvbiA9IGNvbnZlcnRlcnNfMS50aW1lQ29udmVydGVyKHZhbHVlKTsgfSxcbiAgICBcImFuaW1hdGlvbi1kZWxheVwiOiBmdW5jdGlvbiAoaW5mbywgdmFsdWUpIHsgcmV0dXJuIGluZm8uZGVsYXkgPSBjb252ZXJ0ZXJzXzEudGltZUNvbnZlcnRlcih2YWx1ZSk7IH0sXG4gICAgXCJhbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uXCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5jdXJ2ZSA9IGNvbnZlcnRlcnNfMS5hbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcih2YWx1ZSk7IH0sXG4gICAgXCJhbmltYXRpb24taXRlcmF0aW9uLWNvdW50XCI6IGZ1bmN0aW9uIChpbmZvLCB2YWx1ZSkgeyByZXR1cm4gaW5mby5pdGVyYXRpb25zID0gdmFsdWUgPT09IFwiaW5maW5pdGVcIiA/IE51bWJlci5NQVhfVkFMVUUgOiBwYXJzZUZsb2F0KHZhbHVlKTsgfSxcbiAgICBcImFuaW1hdGlvbi1kaXJlY3Rpb25cIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLmlzUmV2ZXJzZSA9IHZhbHVlID09PSBcInJldmVyc2VcIjsgfSxcbiAgICBcImFuaW1hdGlvbi1maWxsLW1vZGVcIjogZnVuY3Rpb24gKGluZm8sIHZhbHVlKSB7IHJldHVybiBpbmZvLmlzRm9yd2FyZHMgPSB2YWx1ZSA9PT0gXCJmb3J3YXJkc1wiOyB9XG59KTtcbnZhciBDc3NBbmltYXRpb25QYXJzZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENzc0FuaW1hdGlvblBhcnNlcigpIHtcbiAgICB9XG4gICAgQ3NzQW5pbWF0aW9uUGFyc2VyLmtleWZyYW1lQW5pbWF0aW9uc0Zyb21DU1NEZWNsYXJhdGlvbnMgPSBmdW5jdGlvbiAoZGVjbGFyYXRpb25zKSB7XG4gICAgICAgIGlmIChkZWNsYXJhdGlvbnMgPT09IG51bGwgfHwgZGVjbGFyYXRpb25zID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFuaW1hdGlvbnMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdmFyIGFuaW1hdGlvbkluZm8gPSB1bmRlZmluZWQ7XG4gICAgICAgIGRlY2xhcmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChfYSkge1xuICAgICAgICAgICAgdmFyIHByb3BlcnR5ID0gX2EucHJvcGVydHksIHZhbHVlID0gX2EudmFsdWU7XG4gICAgICAgICAgICBpZiAocHJvcGVydHkgPT09IFwiYW5pbWF0aW9uXCIpIHtcbiAgICAgICAgICAgICAgICBrZXlmcmFtZUFuaW1hdGlvbnNGcm9tQ1NTUHJvcGVydHkodmFsdWUsIGFuaW1hdGlvbnMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BlcnR5SGFuZGxlciA9IEFOSU1BVElPTl9QUk9QRVJUWV9IQU5ETEVSU1twcm9wZXJ0eV07XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5SGFuZGxlcikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYW5pbWF0aW9uSW5mbyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvID0gbmV3IGtleWZyYW1lX2FuaW1hdGlvbl8xLktleWZyYW1lQW5pbWF0aW9uSW5mbygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbkluZm8pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHByb3BlcnR5SGFuZGxlcihhbmltYXRpb25JbmZvLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFuaW1hdGlvbnMubGVuZ3RoID09PSAwID8gdW5kZWZpbmVkIDogYW5pbWF0aW9ucztcbiAgICB9O1xuICAgIENzc0FuaW1hdGlvblBhcnNlci5rZXlmcmFtZXNBcnJheUZyb21DU1MgPSBmdW5jdGlvbiAoa2V5ZnJhbWVzKSB7XG4gICAgICAgIHZhciBwYXJzZWRLZXlmcmFtZXMgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBrZXlmcmFtZXNfMSA9IGtleWZyYW1lczsgX2kgPCBrZXlmcmFtZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBrZXlmcmFtZSA9IGtleWZyYW1lc18xW19pXTtcbiAgICAgICAgICAgIHZhciBkZWNsYXJhdGlvbnMgPSBwYXJzZUtleWZyYW1lRGVjbGFyYXRpb25zKGtleWZyYW1lLmRlY2xhcmF0aW9ucyk7XG4gICAgICAgICAgICBmb3IgKHZhciBfYSA9IDAsIF9iID0ga2V5ZnJhbWUudmFsdWVzOyBfYSA8IF9iLmxlbmd0aDsgX2ErKykge1xuICAgICAgICAgICAgICAgIHZhciB0aW1lXzEgPSBfYltfYV07XG4gICAgICAgICAgICAgICAgaWYgKHRpbWVfMSA9PT0gXCJmcm9tXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZV8xID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGltZV8xID09PSBcInRvXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGltZV8xID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IHBhcnNlRmxvYXQodGltZV8xKSAvIDEwMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVfMSA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVfMSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVfMSA+IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGltZV8xID0gMTAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjdXJyZW50ID0gcGFyc2VkS2V5ZnJhbWVzW3RpbWVfMV07XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50ID0ge307XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuZHVyYXRpb24gPSB0aW1lXzE7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNlZEtleWZyYW1lc1t0aW1lXzFdID0gY3VycmVudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSAwLCBfZCA9IGtleWZyYW1lLmRlY2xhcmF0aW9uczsgX2MgPCBfZC5sZW5ndGg7IF9jKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlY2xhcmF0aW9uID0gX2RbX2NdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGVjbGFyYXRpb24ucHJvcGVydHkgPT09IFwiYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvblwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LmN1cnZlID0gY29udmVydGVyc18xLmFuaW1hdGlvblRpbWluZ0Z1bmN0aW9uQ29udmVydGVyKGRlY2xhcmF0aW9uLnZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjdXJyZW50LmRlY2xhcmF0aW9ucyA9IGRlY2xhcmF0aW9ucztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJyYXkgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgZm9yICh2YXIgcGFyc2VkS2V5ZnJhbWUgaW4gcGFyc2VkS2V5ZnJhbWVzKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKHBhcnNlZEtleWZyYW1lc1twYXJzZWRLZXlmcmFtZV0pO1xuICAgICAgICB9XG4gICAgICAgIGFycmF5LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEuZHVyYXRpb24gLSBiLmR1cmF0aW9uOyB9KTtcbiAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH07XG4gICAgcmV0dXJuIENzc0FuaW1hdGlvblBhcnNlcjtcbn0oKSk7XG5leHBvcnRzLkNzc0FuaW1hdGlvblBhcnNlciA9IENzc0FuaW1hdGlvblBhcnNlcjtcbmZ1bmN0aW9uIGtleWZyYW1lQW5pbWF0aW9uc0Zyb21DU1NQcm9wZXJ0eSh2YWx1ZSwgYW5pbWF0aW9ucykge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgdmFyIHZhbHVlcyA9IHZhbHVlLnNwbGl0KC9bLF0rLyk7XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgdmFsdWVzXzEgPSB2YWx1ZXM7IF9pIDwgdmFsdWVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgcGFyc2VkVmFsdWUgPSB2YWx1ZXNfMVtfaV07XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9uSW5mbyA9IG5ldyBrZXlmcmFtZV9hbmltYXRpb25fMS5LZXlmcmFtZUFuaW1hdGlvbkluZm8oKTtcbiAgICAgICAgICAgIHZhciBhcnIgPSBwYXJzZWRWYWx1ZS50cmltKCkuc3BsaXQoL1sgXSsvKTtcbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8ubmFtZSA9IGFyclswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhcnIubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGFuaW1hdGlvbkluZm8uZHVyYXRpb24gPSBjb252ZXJ0ZXJzXzEudGltZUNvbnZlcnRlcihhcnJbMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5jdXJ2ZSA9IGNvbnZlcnRlcnNfMS5hbmltYXRpb25UaW1pbmdGdW5jdGlvbkNvbnZlcnRlcihhcnJbMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiAzKSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5kZWxheSA9IGNvbnZlcnRlcnNfMS50aW1lQ29udmVydGVyKGFyclszXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDQpIHtcbiAgICAgICAgICAgICAgICBhbmltYXRpb25JbmZvLml0ZXJhdGlvbnMgPSBwYXJzZUludChhcnJbNF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiA1KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5pc1JldmVyc2UgPSBhcnJbNF0gPT09IFwicmV2ZXJzZVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFyci5sZW5ndGggPiA2KSB7XG4gICAgICAgICAgICAgICAgYW5pbWF0aW9uSW5mby5pc0ZvcndhcmRzID0gYXJyWzVdID09PSBcImZvcndhcmRzXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDcpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlIGZvciBhbmltYXRpb246IFwiICsgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbkluZm8pO1xuICAgICAgICB9XG4gICAgfVxufVxuZnVuY3Rpb24gcGFyc2VLZXlmcmFtZURlY2xhcmF0aW9ucyh1bnBhcnNlZEtleWZyYW1lRGVjbGFyYXRpb25zKSB7XG4gICAgdmFyIGRlY2xhcmF0aW9ucyA9IHVucGFyc2VkS2V5ZnJhbWVEZWNsYXJhdGlvbnNcbiAgICAgICAgLnJlZHVjZShmdW5jdGlvbiAoZGVjbGFyYXRpb25zLCBfYSkge1xuICAgICAgICB2YXIgdW5wYXJzZWRQcm9wZXJ0eSA9IF9hLnByb3BlcnR5LCB1bnBhcnNlZFZhbHVlID0gX2EudmFsdWU7XG4gICAgICAgIHZhciBwcm9wZXJ0eSA9IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eS5fZ2V0QnlDc3NOYW1lKHVucGFyc2VkUHJvcGVydHkpO1xuICAgICAgICBpZiAodHlwZW9mIHVucGFyc2VkUHJvcGVydHkgPT09IFwic3RyaW5nXCIgJiYgcHJvcGVydHkgJiYgcHJvcGVydHkuX3ZhbHVlQ29udmVydGVyKSB7XG4gICAgICAgICAgICBkZWNsYXJhdGlvbnNbcHJvcGVydHkubmFtZV0gPSBwcm9wZXJ0eS5fdmFsdWVDb252ZXJ0ZXIodW5wYXJzZWRWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHVucGFyc2VkVmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdW5wYXJzZWRQcm9wZXJ0eSA9PT0gXCJ0cmFuc2Zvcm1cIikge1xuICAgICAgICAgICAgdmFyIHRyYW5zZm9ybWF0aW9ucyA9IHN0eWxlX3Byb3BlcnRpZXNfMS50cmFuc2Zvcm1Db252ZXJ0ZXIodW5wYXJzZWRWYWx1ZSk7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGRlY2xhcmF0aW9ucywgdHJhbnNmb3JtYXRpb25zKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZGVjbGFyYXRpb25zO1xuICAgIH0sIHt9KTtcbiAgICByZXR1cm4gT2JqZWN0LmtleXMoZGVjbGFyYXRpb25zKS5tYXAoZnVuY3Rpb24gKHByb3BlcnR5KSB7IHJldHVybiAoeyBwcm9wZXJ0eTogcHJvcGVydHksIHZhbHVlOiBkZWNsYXJhdGlvbnNbcHJvcGVydHldIH0pOyB9KTtcbn1cbmV4cG9ydHMucGFyc2VLZXlmcmFtZURlY2xhcmF0aW9ucyA9IHBhcnNlS2V5ZnJhbWVEZWNsYXJhdGlvbnM7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jc3MtYW5pbWF0aW9uLXBhcnNlci5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy90eXBlc1wiKTtcbnZhciB1dGlsc19jb21tb25fMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi91dGlscy91dGlscy1jb21tb25cIik7XG52YXIgcGFyc2VyID0gcmVxdWlyZShcIi4uLy4uLy4uL2Nzcy9wYXJzZXJcIik7XG52YXIgTWF0Y2g7XG4oZnVuY3Rpb24gKE1hdGNoKSB7XG4gICAgTWF0Y2guRHluYW1pYyA9IHRydWU7XG4gICAgTWF0Y2guU3RhdGljID0gZmFsc2U7XG59KShNYXRjaCB8fCAoTWF0Y2ggPSB7fSkpO1xuZnVuY3Rpb24gZ2V0Tm9kZURpcmVjdFNpYmxpbmcobm9kZSkge1xuICAgIGlmICghbm9kZS5wYXJlbnQgfHwgIW5vZGUucGFyZW50LmdldENoaWxkSW5kZXggfHwgIW5vZGUucGFyZW50LmdldENoaWxkQXQpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHZhciBub2RlSW5kZXggPSBub2RlLnBhcmVudC5nZXRDaGlsZEluZGV4KG5vZGUpO1xuICAgIGlmIChub2RlSW5kZXggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybiBub2RlLnBhcmVudC5nZXRDaGlsZEF0KG5vZGVJbmRleCAtIDEpO1xufVxuZnVuY3Rpb24gU2VsZWN0b3JQcm9wZXJ0aWVzKHNwZWNpZmljaXR5LCByYXJpdHksIGR5bmFtaWMpIHtcbiAgICBpZiAoZHluYW1pYyA9PT0gdm9pZCAwKSB7IGR5bmFtaWMgPSBmYWxzZTsgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoY2xzKSB7XG4gICAgICAgIGNscy5wcm90b3R5cGUuc3BlY2lmaWNpdHkgPSBzcGVjaWZpY2l0eTtcbiAgICAgICAgY2xzLnByb3RvdHlwZS5yYXJpdHkgPSByYXJpdHk7XG4gICAgICAgIGNscy5wcm90b3R5cGUuY29tYmluYXRvciA9IHVuZGVmaW5lZDtcbiAgICAgICAgY2xzLnByb3RvdHlwZS5keW5hbWljID0gZHluYW1pYztcbiAgICAgICAgcmV0dXJuIGNscztcbiAgICB9O1xufVxudmFyIFNlbGVjdG9yQ29yZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VsZWN0b3JDb3JlKCkge1xuICAgIH1cbiAgICBTZWxlY3RvckNvcmUucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7IHNvcnRlci5zb3J0QXNVbml2ZXJzYWwoYmFzZSB8fCB0aGlzKTsgfTtcbiAgICBTZWxlY3RvckNvcmUgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDAsIDAsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBTZWxlY3RvckNvcmUpO1xuICAgIHJldHVybiBTZWxlY3RvckNvcmU7XG59KCkpO1xuZXhwb3J0cy5TZWxlY3RvckNvcmUgPSBTZWxlY3RvckNvcmU7XG52YXIgU2ltcGxlU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTaW1wbGVTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTaW1wbGVTZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTaW1wbGVTZWxlY3Rvci5wcm90b3R5cGUuYWNjdW11bGF0ZUNoYW5nZXMgPSBmdW5jdGlvbiAobm9kZSwgbWFwKSB7XG4gICAgICAgIGlmICghdGhpcy5keW5hbWljKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tYXRjaChub2RlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLm1heU1hdGNoKG5vZGUpKSB7XG4gICAgICAgICAgICB0aGlzLnRyYWNrQ2hhbmdlcyhub2RlLCBtYXApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG4gICAgU2ltcGxlU2VsZWN0b3IucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRoaXMubWF0Y2gobm9kZSk7IH07XG4gICAgU2ltcGxlU2VsZWN0b3IucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICB9O1xuICAgIHJldHVybiBTaW1wbGVTZWxlY3Rvcjtcbn0oU2VsZWN0b3JDb3JlKSk7XG5leHBvcnRzLlNpbXBsZVNlbGVjdG9yID0gU2ltcGxlU2VsZWN0b3I7XG5mdW5jdGlvbiB3cmFwKHRleHQpIHtcbiAgICByZXR1cm4gdGV4dCA/IFwiIFwiICsgdGV4dCArIFwiIFwiIDogXCJcIjtcbn1cbnZhciBJbnZhbGlkU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhJbnZhbGlkU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSW52YWxpZFNlbGVjdG9yKGUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuZSA9IGU7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgSW52YWxpZFNlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiPGVycm9yOiBcIiArIHRoaXMuZSArIFwiPlwiOyB9O1xuICAgIEludmFsaWRTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgSW52YWxpZFNlbGVjdG9yLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkge1xuICAgIH07XG4gICAgSW52YWxpZFNlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygwLCA0LCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgSW52YWxpZFNlbGVjdG9yKTtcbiAgICByZXR1cm4gSW52YWxpZFNlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5JbnZhbGlkU2VsZWN0b3IgPSBJbnZhbGlkU2VsZWN0b3I7XG52YXIgVW5pdmVyc2FsU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVbml2ZXJzYWxTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBVbml2ZXJzYWxTZWxlY3RvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVbml2ZXJzYWxTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIipcIiArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBVbml2ZXJzYWxTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gdHJ1ZTsgfTtcbiAgICBVbml2ZXJzYWxTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoMCwgMCwgTWF0Y2guU3RhdGljKVxuICAgIF0sIFVuaXZlcnNhbFNlbGVjdG9yKTtcbiAgICByZXR1cm4gVW5pdmVyc2FsU2VsZWN0b3I7XG59KFNpbXBsZVNlbGVjdG9yKSk7XG5leHBvcnRzLlVuaXZlcnNhbFNlbGVjdG9yID0gVW5pdmVyc2FsU2VsZWN0b3I7XG52YXIgSWRTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKElkU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSWRTZWxlY3RvcihpZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5pZCA9IGlkO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIElkU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCIjXCIgKyB0aGlzLmlkICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIElkU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUuaWQgPT09IHRoaXMuaWQ7IH07XG4gICAgSWRTZWxlY3Rvci5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIsIGJhc2UpIHsgc29ydGVyLnNvcnRCeUlkKHRoaXMuaWQsIGJhc2UgfHwgdGhpcyk7IH07XG4gICAgSWRTZWxlY3RvciA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBTZWxlY3RvclByb3BlcnRpZXMoNjU1MzYsIDMsIE1hdGNoLlN0YXRpYylcbiAgICBdLCBJZFNlbGVjdG9yKTtcbiAgICByZXR1cm4gSWRTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuSWRTZWxlY3RvciA9IElkU2VsZWN0b3I7XG52YXIgVHlwZVNlbGVjdG9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVHlwZVNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFR5cGVTZWxlY3Rvcihjc3NUeXBlKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNzc1R5cGUgPSBjc3NUeXBlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFR5cGVTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIlwiICsgdGhpcy5jc3NUeXBlICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIFR5cGVTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gbm9kZS5jc3NUeXBlID09PSB0aGlzLmNzc1R5cGU7IH07XG4gICAgVHlwZVNlbGVjdG9yLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkgeyBzb3J0ZXIuc29ydEJ5VHlwZSh0aGlzLmNzc1R5cGUsIGJhc2UgfHwgdGhpcyk7IH07XG4gICAgVHlwZVNlbGVjdG9yID0gX19kZWNvcmF0ZShbXG4gICAgICAgIFNlbGVjdG9yUHJvcGVydGllcygxLCAxLCBNYXRjaC5TdGF0aWMpXG4gICAgXSwgVHlwZVNlbGVjdG9yKTtcbiAgICByZXR1cm4gVHlwZVNlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5UeXBlU2VsZWN0b3IgPSBUeXBlU2VsZWN0b3I7XG52YXIgQ2xhc3NTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKENsYXNzU2VsZWN0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ2xhc3NTZWxlY3Rvcihjc3NDbGFzcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5jc3NDbGFzcyA9IGNzc0NsYXNzO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIENsYXNzU2VsZWN0b3IucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCIuXCIgKyB0aGlzLmNzc0NsYXNzICsgd3JhcCh0aGlzLmNvbWJpbmF0b3IpOyB9O1xuICAgIENsYXNzU2VsZWN0b3IucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIG5vZGUuY3NzQ2xhc3NlcyAmJiBub2RlLmNzc0NsYXNzZXMuaGFzKHRoaXMuY3NzQ2xhc3MpOyB9O1xuICAgIENsYXNzU2VsZWN0b3IucHJvdG90eXBlLmxvb2t1cFNvcnQgPSBmdW5jdGlvbiAoc29ydGVyLCBiYXNlKSB7IHNvcnRlci5zb3J0QnlDbGFzcyh0aGlzLmNzc0NsYXNzLCBiYXNlIHx8IHRoaXMpOyB9O1xuICAgIENsYXNzU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDI1NiwgMiwgTWF0Y2guU3RhdGljKVxuICAgIF0sIENsYXNzU2VsZWN0b3IpO1xuICAgIHJldHVybiBDbGFzc1NlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5DbGFzc1NlbGVjdG9yID0gQ2xhc3NTZWxlY3RvcjtcbnZhciBBdHRyaWJ1dGVTZWxlY3RvciA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEF0dHJpYnV0ZVNlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEF0dHJpYnV0ZVNlbGVjdG9yKGF0dHJpYnV0ZSwgdGVzdCwgdmFsdWUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuYXR0cmlidXRlID0gYXR0cmlidXRlO1xuICAgICAgICBfdGhpcy50ZXN0ID0gdGVzdDtcbiAgICAgICAgX3RoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgaWYgKCF0ZXN0KSB7XG4gICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiAhdHlwZXNfMS5pc051bGxPclVuZGVmaW5lZChub2RlW2F0dHJpYnV0ZV0pOyB9O1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgIF90aGlzLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBlc2NhcGVkVmFsdWUgPSB1dGlsc19jb21tb25fMS5lc2NhcGVSZWdleFN5bWJvbHModmFsdWUpO1xuICAgICAgICB2YXIgcmVnZXhwID0gbnVsbDtcbiAgICAgICAgc3dpdGNoICh0ZXN0KSB7XG4gICAgICAgICAgICBjYXNlIFwiXj1cIjpcbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKFwiXlwiICsgZXNjYXBlZFZhbHVlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCIkPVwiOlxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoZXNjYXBlZFZhbHVlICsgXCIkXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIio9XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChlc2NhcGVkVmFsdWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIj1cIjpcbiAgICAgICAgICAgICAgICByZWdleHAgPSBuZXcgUmVnRXhwKFwiXlwiICsgZXNjYXBlZFZhbHVlICsgXCIkXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcIn49XCI6XG4gICAgICAgICAgICAgICAgaWYgKC9cXHMvLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIGZhbHNlOyB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJlZ2V4cCA9IG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIiArIGVzY2FwZWRWYWx1ZSArIFwiKFxcXFxzfCQpXCIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInw9XCI6XG4gICAgICAgICAgICAgICAgcmVnZXhwID0gbmV3IFJlZ0V4cChcIl5cIiArIGVzY2FwZWRWYWx1ZSArIFwiKC18JClcIik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlZ2V4cCkge1xuICAgICAgICAgICAgX3RoaXMubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gcmVnZXhwLnRlc3Qobm9kZVthdHRyaWJ1dGVdICsgXCJcIik7IH07XG4gICAgICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBmYWxzZTsgfTtcbiAgICAgICAgICAgIHJldHVybiBfdGhpcztcbiAgICAgICAgfVxuICAgIH1cbiAgICBBdHRyaWJ1dGVTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBcIltcIiArIHRoaXMuYXR0cmlidXRlICsgd3JhcCh0aGlzLnRlc3QpICsgKCh0aGlzLnRlc3QgJiYgdGhpcy52YWx1ZSkgfHwgXCJcIikgKyBcIl1cIiArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBBdHRyaWJ1dGVTZWxlY3Rvci5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gZmFsc2U7IH07XG4gICAgQXR0cmlidXRlU2VsZWN0b3IucHJvdG90eXBlLm1heU1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHsgcmV0dXJuIHRydWU7IH07XG4gICAgQXR0cmlidXRlU2VsZWN0b3IucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHsgbWFwLmFkZEF0dHJpYnV0ZShub2RlLCB0aGlzLmF0dHJpYnV0ZSk7IH07XG4gICAgQXR0cmlidXRlU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDI1NiwgMCwgTWF0Y2guRHluYW1pYylcbiAgICBdLCBBdHRyaWJ1dGVTZWxlY3Rvcik7XG4gICAgcmV0dXJuIEF0dHJpYnV0ZVNlbGVjdG9yO1xufShTaW1wbGVTZWxlY3RvcikpO1xuZXhwb3J0cy5BdHRyaWJ1dGVTZWxlY3RvciA9IEF0dHJpYnV0ZVNlbGVjdG9yO1xudmFyIFBzZXVkb0NsYXNzU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhQc2V1ZG9DbGFzc1NlbGVjdG9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBzZXVkb0NsYXNzU2VsZWN0b3IoY3NzUHNldWRvQ2xhc3MpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY3NzUHNldWRvQ2xhc3MgPSBjc3NQc2V1ZG9DbGFzcztcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwiOlwiICsgdGhpcy5jc3NQc2V1ZG9DbGFzcyArIHdyYXAodGhpcy5jb21iaW5hdG9yKTsgfTtcbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBub2RlLmNzc1BzZXVkb0NsYXNzZXMgJiYgbm9kZS5jc3NQc2V1ZG9DbGFzc2VzLmhhcyh0aGlzLmNzc1BzZXVkb0NsYXNzKTsgfTtcbiAgICBQc2V1ZG9DbGFzc1NlbGVjdG9yLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiB0cnVlOyB9O1xuICAgIFBzZXVkb0NsYXNzU2VsZWN0b3IucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHsgbWFwLmFkZFBzZXVkb0NsYXNzKG5vZGUsIHRoaXMuY3NzUHNldWRvQ2xhc3MpOyB9O1xuICAgIFBzZXVkb0NsYXNzU2VsZWN0b3IgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgU2VsZWN0b3JQcm9wZXJ0aWVzKDI1NiwgMCwgTWF0Y2guRHluYW1pYylcbiAgICBdLCBQc2V1ZG9DbGFzc1NlbGVjdG9yKTtcbiAgICByZXR1cm4gUHNldWRvQ2xhc3NTZWxlY3Rvcjtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuUHNldWRvQ2xhc3NTZWxlY3RvciA9IFBzZXVkb0NsYXNzU2VsZWN0b3I7XG52YXIgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZShzZWxlY3RvcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuICAgICAgICBfdGhpcy5zcGVjaWZpY2l0eSA9IHNlbGVjdG9ycy5yZWR1Y2UoZnVuY3Rpb24gKHN1bSwgc2VsKSB7IHJldHVybiBzZWwuc3BlY2lmaWNpdHkgKyBzdW07IH0sIDApO1xuICAgICAgICBfdGhpcy5oZWFkID0gX3RoaXMuc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbiAocHJldiwgY3VycikgeyByZXR1cm4gIXByZXYgfHwgKGN1cnIucmFyaXR5ID4gcHJldi5yYXJpdHkpID8gY3VyciA6IHByZXY7IH0sIG51bGwpO1xuICAgICAgICBfdGhpcy5keW5hbWljID0gc2VsZWN0b3JzLnNvbWUoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLmR5bmFtaWM7IH0pO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNpbXBsZVNlbGVjdG9yU2VxdWVuY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gXCJcIiArIHRoaXMuc2VsZWN0b3JzLmpvaW4oXCJcIikgKyB3cmFwKHRoaXMuY29tYmluYXRvcik7IH07XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUubWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkgeyByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCkgeyByZXR1cm4gc2VsLm1hdGNoKG5vZGUpOyB9KTsgfTtcbiAgICBTaW1wbGVTZWxlY3RvclNlcXVlbmNlLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwubWF5TWF0Y2gobm9kZSk7IH0pO1xuICAgIH07XG4gICAgU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZS5wcm90b3R5cGUudHJhY2tDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgICAgICB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC50cmFja0NoYW5nZXMobm9kZSwgbWFwKTsgfSk7XG4gICAgfTtcbiAgICBTaW1wbGVTZWxlY3RvclNlcXVlbmNlLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkge1xuICAgICAgICB0aGlzLmhlYWQubG9va3VwU29ydChzb3J0ZXIsIGJhc2UgfHwgdGhpcyk7XG4gICAgfTtcbiAgICByZXR1cm4gU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZTtcbn0oU2ltcGxlU2VsZWN0b3IpKTtcbmV4cG9ydHMuU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSA9IFNpbXBsZVNlbGVjdG9yU2VxdWVuY2U7XG52YXIgU2VsZWN0b3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTZWxlY3RvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTZWxlY3RvcihzZWxlY3RvcnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc2VsZWN0b3JzID0gc2VsZWN0b3JzO1xuICAgICAgICB2YXIgc3VwcG9ydGVkQ29tYmluYXRvciA9IFt1bmRlZmluZWQsIFwiIFwiLCBcIj5cIiwgXCIrXCJdO1xuICAgICAgICB2YXIgc2libGluZ0dyb3VwO1xuICAgICAgICB2YXIgbGFzdEdyb3VwO1xuICAgICAgICB2YXIgZ3JvdXBzID0gW107XG4gICAgICAgIHNlbGVjdG9ycy5yZXZlcnNlKCkuZm9yRWFjaChmdW5jdGlvbiAoc2VsKSB7XG4gICAgICAgICAgICBpZiAoc3VwcG9ydGVkQ29tYmluYXRvci5pbmRleE9mKHNlbC5jb21iaW5hdG9yKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbnN1cHBvcnRlZCBjb21iaW5hdG9yIFxcXCJcIiArIHNlbC5jb21iaW5hdG9yICsgXCJcXFwiLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZWwuY29tYmluYXRvciA9PT0gdW5kZWZpbmVkIHx8IHNlbC5jb21iaW5hdG9yID09PSBcIiBcIikge1xuICAgICAgICAgICAgICAgIGdyb3Vwcy5wdXNoKGxhc3RHcm91cCA9IFtzaWJsaW5nR3JvdXAgPSBbXV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNlbC5jb21iaW5hdG9yID09PSBcIj5cIikge1xuICAgICAgICAgICAgICAgIGxhc3RHcm91cC5wdXNoKHNpYmxpbmdHcm91cCA9IFtdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmdHcm91cC5wdXNoKHNlbCk7XG4gICAgICAgIH0pO1xuICAgICAgICBfdGhpcy5ncm91cHMgPSBncm91cHMubWFwKGZ1bmN0aW9uIChnKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFNlbGVjdG9yLkNoaWxkR3JvdXAoZy5tYXAoZnVuY3Rpb24gKHNnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBTZWxlY3Rvci5TaWJsaW5nR3JvdXAoc2cpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgX3RoaXMubGFzdCA9IHNlbGVjdG9yc1swXTtcbiAgICAgICAgX3RoaXMuc3BlY2lmaWNpdHkgPSBzZWxlY3RvcnMucmVkdWNlKGZ1bmN0aW9uIChzdW0sIHNlbCkgeyByZXR1cm4gc2VsLnNwZWNpZmljaXR5ICsgc3VtOyB9LCAwKTtcbiAgICAgICAgX3RoaXMuZHluYW1pYyA9IHNlbGVjdG9ycy5zb21lKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljOyB9KTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTZWxlY3Rvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLnNlbGVjdG9ycy5qb2luKFwiXCIpOyB9O1xuICAgIFNlbGVjdG9yLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdyb3Vwcy5ldmVyeShmdW5jdGlvbiAoZ3JvdXAsIGkpIHtcbiAgICAgICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgbm9kZSA9IGdyb3VwLm1hdGNoKG5vZGUpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhIW5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgYW5jZXN0b3IgPSBub2RlO1xuICAgICAgICAgICAgICAgIHdoaWxlIChhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZSA9IGdyb3VwLm1hdGNoKGFuY2VzdG9yKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNlbGVjdG9yLnByb3RvdHlwZS5sb29rdXBTb3J0ID0gZnVuY3Rpb24gKHNvcnRlciwgYmFzZSkge1xuICAgICAgICB0aGlzLmxhc3QubG9va3VwU29ydChzb3J0ZXIsIHRoaXMpO1xuICAgIH07XG4gICAgU2VsZWN0b3IucHJvdG90eXBlLmFjY3VtdWxhdGVDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgICAgICBpZiAoIXRoaXMuZHluYW1pYykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2gobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJvdW5kcyA9IFtdO1xuICAgICAgICB2YXIgbWF5TWF0Y2ggPSB0aGlzLmdyb3Vwcy5ldmVyeShmdW5jdGlvbiAoZ3JvdXAsIGkpIHtcbiAgICAgICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5leHROb2RlID0gZ3JvdXAubWF5TWF0Y2gobm9kZSk7XG4gICAgICAgICAgICAgICAgYm91bmRzLnB1c2goeyBsZWZ0OiBub2RlLCByaWdodDogbm9kZSB9KTtcbiAgICAgICAgICAgICAgICBub2RlID0gbmV4dE5vZGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhbm9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBhbmNlc3RvciA9IG5vZGU7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Tm9kZSA9IGdyb3VwLm1heU1hdGNoKGFuY2VzdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3VuZHMucHVzaCh7IGxlZnQ6IGFuY2VzdG9yLCByaWdodDogbnVsbCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUgPSBuZXh0Tm9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghbWF5TWF0Y2gpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW1hcCkge1xuICAgICAgICAgICAgcmV0dXJuIG1heU1hdGNoO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5ncm91cHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBncm91cF8xID0gdGhpcy5ncm91cHNbaV07XG4gICAgICAgICAgICBpZiAoIWdyb3VwXzEuZHluYW1pYykge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGJvdW5kID0gYm91bmRzW2ldO1xuICAgICAgICAgICAgdmFyIG5vZGVfMSA9IGJvdW5kLmxlZnQ7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaWYgKGdyb3VwXzEubWF5TWF0Y2gobm9kZV8xKSkge1xuICAgICAgICAgICAgICAgICAgICBncm91cF8xLnRyYWNrQ2hhbmdlcyhub2RlXzEsIG1hcCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAoKG5vZGVfMSAhPT0gYm91bmQucmlnaHQpICYmIChub2RlXzEgPSBub2RlXzEucGFyZW50KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1heU1hdGNoO1xuICAgIH07XG4gICAgcmV0dXJuIFNlbGVjdG9yO1xufShTZWxlY3RvckNvcmUpKTtcbmV4cG9ydHMuU2VsZWN0b3IgPSBTZWxlY3RvcjtcbihmdW5jdGlvbiAoU2VsZWN0b3IpIHtcbiAgICB2YXIgQ2hpbGRHcm91cCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIENoaWxkR3JvdXAoc2VsZWN0b3JzKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgICAgIHRoaXMuZHluYW1pYyA9IHNlbGVjdG9ycy5zb21lKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBDaGlsZEdyb3VwLnByb3RvdHlwZS5tYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IG5vZGUucGFyZW50KSAmJiAhIXNlbC5tYXRjaChub2RlKTsgfSkgPyBub2RlIDogbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgQ2hpbGRHcm91cC5wcm90b3R5cGUubWF5TWF0Y2ggPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmV2ZXJ5KGZ1bmN0aW9uIChzZWwsIGkpIHsgcmV0dXJuIChpID09PSAwID8gbm9kZSA6IG5vZGUgPSBub2RlLnBhcmVudCkgJiYgISFzZWwubWF5TWF0Y2gobm9kZSk7IH0pID8gbm9kZSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIENoaWxkR3JvdXAucHJvdG90eXBlLnRyYWNrQ2hhbmdlcyA9IGZ1bmN0aW9uIChub2RlLCBtYXApIHtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IG5vZGUucGFyZW50KSAmJiBzZWwudHJhY2tDaGFuZ2VzKG5vZGUsIG1hcCk7IH0pO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ2hpbGRHcm91cDtcbiAgICB9KCkpO1xuICAgIFNlbGVjdG9yLkNoaWxkR3JvdXAgPSBDaGlsZEdyb3VwO1xuICAgIHZhciBTaWJsaW5nR3JvdXAgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBTaWJsaW5nR3JvdXAoc2VsZWN0b3JzKSB7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdG9ycyA9IHNlbGVjdG9ycztcbiAgICAgICAgICAgIHRoaXMuZHluYW1pYyA9IHNlbGVjdG9ycy5zb21lKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljOyB9KTtcbiAgICAgICAgfVxuICAgICAgICBTaWJsaW5nR3JvdXAucHJvdG90eXBlLm1hdGNoID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNlbGVjdG9ycy5ldmVyeShmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gZ2V0Tm9kZURpcmVjdFNpYmxpbmcobm9kZSkpICYmIHNlbC5tYXRjaChub2RlKTsgfSkgPyBub2RlIDogbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgU2libGluZ0dyb3VwLnByb3RvdHlwZS5tYXlNYXRjaCA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3RvcnMuZXZlcnkoZnVuY3Rpb24gKHNlbCwgaSkgeyByZXR1cm4gKGkgPT09IDAgPyBub2RlIDogbm9kZSA9IGdldE5vZGVEaXJlY3RTaWJsaW5nKG5vZGUpKSAmJiBzZWwubWF5TWF0Y2gobm9kZSk7IH0pID8gbm9kZSA6IG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIFNpYmxpbmdHcm91cC5wcm90b3R5cGUudHJhY2tDaGFuZ2VzID0gZnVuY3Rpb24gKG5vZGUsIG1hcCkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsLCBpKSB7IHJldHVybiAoaSA9PT0gMCA/IG5vZGUgOiBub2RlID0gZ2V0Tm9kZURpcmVjdFNpYmxpbmcobm9kZSkpICYmIHNlbC50cmFja0NoYW5nZXMobm9kZSwgbWFwKTsgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBTaWJsaW5nR3JvdXA7XG4gICAgfSgpKTtcbiAgICBTZWxlY3Rvci5TaWJsaW5nR3JvdXAgPSBTaWJsaW5nR3JvdXA7XG59KShTZWxlY3RvciA9IGV4cG9ydHMuU2VsZWN0b3IgfHwgKGV4cG9ydHMuU2VsZWN0b3IgPSB7fSkpO1xuZXhwb3J0cy5TZWxlY3RvciA9IFNlbGVjdG9yO1xudmFyIFJ1bGVTZXQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJ1bGVTZXQoc2VsZWN0b3JzLCBkZWNsYXJhdGlvbnMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zZWxlY3RvcnMgPSBzZWxlY3RvcnM7XG4gICAgICAgIHRoaXMuZGVjbGFyYXRpb25zID0gZGVjbGFyYXRpb25zO1xuICAgICAgICB0aGlzLnNlbGVjdG9ycy5mb3JFYWNoKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5ydWxlc2V0ID0gX3RoaXM7IH0pO1xuICAgIH1cbiAgICBSdWxlU2V0LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuc2VsZWN0b3JzLmpvaW4oXCIsIFwiKSArIFwiIHtcIiArIHRoaXMuZGVjbGFyYXRpb25zLm1hcChmdW5jdGlvbiAoZCwgaSkgeyByZXR1cm4gXCJcIiArIChpID09PSAwID8gXCIgXCIgOiBcIlwiKSArIGQucHJvcGVydHkgKyBcIjogXCIgKyBkLnZhbHVlOyB9KS5qb2luKFwiOyBcIikgKyBcIiB9XCI7IH07XG4gICAgUnVsZVNldC5wcm90b3R5cGUubG9va3VwU29ydCA9IGZ1bmN0aW9uIChzb3J0ZXIpIHsgdGhpcy5zZWxlY3RvcnMuZm9yRWFjaChmdW5jdGlvbiAoc2VsKSB7IHJldHVybiBzZWwubG9va3VwU29ydChzb3J0ZXIpOyB9KTsgfTtcbiAgICByZXR1cm4gUnVsZVNldDtcbn0oKSk7XG5leHBvcnRzLlJ1bGVTZXQgPSBSdWxlU2V0O1xuZnVuY3Rpb24gZnJvbUFzdE5vZGVzKGFzdFJ1bGVzKSB7XG4gICAgcmV0dXJuIGFzdFJ1bGVzLmZpbHRlcihpc1J1bGUpLm1hcChmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICB2YXIgZGVjbGFyYXRpb25zID0gcnVsZS5kZWNsYXJhdGlvbnMuZmlsdGVyKGlzRGVjbGFyYXRpb24pLm1hcChjcmVhdGVEZWNsYXJhdGlvbik7XG4gICAgICAgIHZhciBzZWxlY3RvcnMgPSBydWxlLnNlbGVjdG9ycy5tYXAoY3JlYXRlU2VsZWN0b3IpO1xuICAgICAgICB2YXIgcnVsZXNldCA9IG5ldyBSdWxlU2V0KHNlbGVjdG9ycywgZGVjbGFyYXRpb25zKTtcbiAgICAgICAgcmV0dXJuIHJ1bGVzZXQ7XG4gICAgfSk7XG59XG5leHBvcnRzLmZyb21Bc3ROb2RlcyA9IGZyb21Bc3ROb2RlcztcbmZ1bmN0aW9uIGNyZWF0ZURlY2xhcmF0aW9uKGRlY2wpIHtcbiAgICByZXR1cm4geyBwcm9wZXJ0eTogZGVjbC5wcm9wZXJ0eS50b0xvd2VyQ2FzZSgpLCB2YWx1ZTogZGVjbC52YWx1ZSB9O1xufVxuZnVuY3Rpb24gY3JlYXRlU2ltcGxlU2VsZWN0b3JGcm9tQXN0KGFzdCkge1xuICAgIHN3aXRjaCAoYXN0LnR5cGUpIHtcbiAgICAgICAgY2FzZSBcIipcIjogcmV0dXJuIG5ldyBVbml2ZXJzYWxTZWxlY3RvcigpO1xuICAgICAgICBjYXNlIFwiI1wiOiByZXR1cm4gbmV3IElkU2VsZWN0b3IoYXN0LmlkZW50aWZpZXIpO1xuICAgICAgICBjYXNlIFwiXCI6IHJldHVybiBuZXcgVHlwZVNlbGVjdG9yKGFzdC5pZGVudGlmaWVyLnJlcGxhY2UoLy0vLCBcIlwiKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgY2FzZSBcIi5cIjogcmV0dXJuIG5ldyBDbGFzc1NlbGVjdG9yKGFzdC5pZGVudGlmaWVyKTtcbiAgICAgICAgY2FzZSBcIjpcIjogcmV0dXJuIG5ldyBQc2V1ZG9DbGFzc1NlbGVjdG9yKGFzdC5pZGVudGlmaWVyKTtcbiAgICAgICAgY2FzZSBcIltdXCI6IHJldHVybiBhc3QudGVzdCA/IG5ldyBBdHRyaWJ1dGVTZWxlY3Rvcihhc3QucHJvcGVydHksIGFzdC50ZXN0LCBhc3QudmFsdWUpIDogbmV3IEF0dHJpYnV0ZVNlbGVjdG9yKGFzdC5wcm9wZXJ0eSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlU2ltcGxlU2VsZWN0b3JTZXF1ZW5jZUZyb21Bc3QoYXN0KSB7XG4gICAgaWYgKGFzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnZhbGlkU2VsZWN0b3IobmV3IEVycm9yKFwiRW1wdHkgc2ltcGxlIHNlbGVjdG9yIHNlcXVlbmNlLlwiKSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFzdC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVNpbXBsZVNlbGVjdG9yRnJvbUFzdChhc3RbMF0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTaW1wbGVTZWxlY3RvclNlcXVlbmNlKGFzdC5tYXAoY3JlYXRlU2ltcGxlU2VsZWN0b3JGcm9tQXN0KSk7XG4gICAgfVxufVxuZnVuY3Rpb24gY3JlYXRlU2VsZWN0b3JGcm9tQXN0KGFzdCkge1xuICAgIGlmIChhc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW52YWxpZFNlbGVjdG9yKG5ldyBFcnJvcihcIkVtcHR5IHNlbGVjdG9yLlwiKSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFzdC5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2VGcm9tQXN0KGFzdFswXVswXSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZXMgPSBbXTtcbiAgICAgICAgdmFyIHNpbXBsZVNlbGVjdG9yU2VxdWVuY2UgPSB2b2lkIDA7XG4gICAgICAgIHZhciBjb21iaW5hdG9yID0gdm9pZCAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZSA9IGNyZWF0ZVNpbXBsZVNlbGVjdG9yU2VxdWVuY2VGcm9tQXN0KGFzdFtpXVswXSk7XG4gICAgICAgICAgICBjb21iaW5hdG9yID0gYXN0W2ldWzFdO1xuICAgICAgICAgICAgaWYgKGNvbWJpbmF0b3IpIHtcbiAgICAgICAgICAgICAgICBzaW1wbGVTZWxlY3RvclNlcXVlbmNlLmNvbWJpbmF0b3IgPSBjb21iaW5hdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2ltcGxlU2VsZWN0b3JTZXF1ZW5jZXMucHVzaChzaW1wbGVTZWxlY3RvclNlcXVlbmNlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IFNlbGVjdG9yKHNpbXBsZVNlbGVjdG9yU2VxdWVuY2VzKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjcmVhdGVTZWxlY3RvcihzZWwpIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgcGFyc2VkU2VsZWN0b3IgPSBwYXJzZXIucGFyc2VTZWxlY3RvcihzZWwpO1xuICAgICAgICBpZiAoIXBhcnNlZFNlbGVjdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEludmFsaWRTZWxlY3RvcihuZXcgRXJyb3IoXCJFbXB0eSBzZWxlY3RvclwiKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyZWF0ZVNlbGVjdG9yRnJvbUFzdChwYXJzZWRTZWxlY3Rvci52YWx1ZSk7XG4gICAgfVxuICAgIGNhdGNoIChlKSB7XG4gICAgICAgIHJldHVybiBuZXcgSW52YWxpZFNlbGVjdG9yKGUpO1xuICAgIH1cbn1cbmV4cG9ydHMuY3JlYXRlU2VsZWN0b3IgPSBjcmVhdGVTZWxlY3RvcjtcbmZ1bmN0aW9uIGlzUnVsZShub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUudHlwZSA9PT0gXCJydWxlXCI7XG59XG5mdW5jdGlvbiBpc0RlY2xhcmF0aW9uKG5vZGUpIHtcbiAgICByZXR1cm4gbm9kZS50eXBlID09PSBcImRlY2xhcmF0aW9uXCI7XG59XG52YXIgU2VsZWN0b3JzTWFwID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTZWxlY3RvcnNNYXAocnVsZXNldHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5pZCA9IHt9O1xuICAgICAgICB0aGlzLmNsYXNzID0ge307XG4gICAgICAgIHRoaXMudHlwZSA9IHt9O1xuICAgICAgICB0aGlzLnVuaXZlcnNhbCA9IFtdO1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gMDtcbiAgICAgICAgcnVsZXNldHMuZm9yRWFjaChmdW5jdGlvbiAocnVsZSkgeyByZXR1cm4gcnVsZS5sb29rdXBTb3J0KF90aGlzKTsgfSk7XG4gICAgfVxuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgc2VsZWN0b3JDbGFzc2VzID0gW1xuICAgICAgICAgICAgdGhpcy51bml2ZXJzYWwsXG4gICAgICAgICAgICB0aGlzLmlkW25vZGUuaWRdLFxuICAgICAgICAgICAgdGhpcy50eXBlW25vZGUuY3NzVHlwZV1cbiAgICAgICAgXTtcbiAgICAgICAgaWYgKG5vZGUuY3NzQ2xhc3Nlcykge1xuICAgICAgICAgICAgbm9kZS5jc3NDbGFzc2VzLmZvckVhY2goZnVuY3Rpb24gKGMpIHsgcmV0dXJuIHNlbGVjdG9yQ2xhc3Nlcy5wdXNoKF90aGlzLmNsYXNzW2NdKTsgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNlbGVjdG9ycyA9IHNlbGVjdG9yQ2xhc3Nlc1xuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoYXJyKSB7IHJldHVybiAhIWFycjsgfSlcbiAgICAgICAgICAgIC5yZWR1Y2UoZnVuY3Rpb24gKGN1ciwgbmV4dCkgeyByZXR1cm4gY3VyLmNvbmNhdChuZXh0KTsgfSwgW10pO1xuICAgICAgICB2YXIgc2VsZWN0b3JzTWF0Y2ggPSBuZXcgU2VsZWN0b3JzTWF0Y2goKTtcbiAgICAgICAgc2VsZWN0b3JzTWF0Y2guc2VsZWN0b3JzID0gc2VsZWN0b3JzXG4gICAgICAgICAgICAuZmlsdGVyKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5zZWwuYWNjdW11bGF0ZUNoYW5nZXMobm9kZSwgc2VsZWN0b3JzTWF0Y2gpOyB9KVxuICAgICAgICAgICAgLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGEuc2VsLnNwZWNpZmljaXR5IC0gYi5zZWwuc3BlY2lmaWNpdHkgfHwgYS5wb3MgLSBiLnBvczsgfSlcbiAgICAgICAgICAgIC5tYXAoZnVuY3Rpb24gKGRvY1NlbCkgeyByZXR1cm4gZG9jU2VsLnNlbDsgfSk7XG4gICAgICAgIHJldHVybiBzZWxlY3RvcnNNYXRjaDtcbiAgICB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUuc29ydEJ5SWQgPSBmdW5jdGlvbiAoaWQsIHNlbCkgeyB0aGlzLmFkZFRvTWFwKHRoaXMuaWQsIGlkLCBzZWwpOyB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUuc29ydEJ5Q2xhc3MgPSBmdW5jdGlvbiAoY3NzQ2xhc3MsIHNlbCkge1xuICAgICAgICB0aGlzLmFkZFRvTWFwKHRoaXMuY2xhc3MsIGNzc0NsYXNzLCBzZWwpO1xuICAgIH07XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5zb3J0QnlUeXBlID0gZnVuY3Rpb24gKGNzc1R5cGUsIHNlbCkge1xuICAgICAgICB0aGlzLmFkZFRvTWFwKHRoaXMudHlwZSwgY3NzVHlwZSwgc2VsKTtcbiAgICB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUuc29ydEFzVW5pdmVyc2FsID0gZnVuY3Rpb24gKHNlbCkgeyB0aGlzLnVuaXZlcnNhbC5wdXNoKHRoaXMubWFrZURvY1NlbGVjdG9yKHNlbCkpOyB9O1xuICAgIFNlbGVjdG9yc01hcC5wcm90b3R5cGUuYWRkVG9NYXAgPSBmdW5jdGlvbiAobWFwLCBoZWFkLCBzZWwpIHtcbiAgICAgICAgdGhpcy5wb3NpdGlvbisrO1xuICAgICAgICB2YXIgbGlzdCA9IG1hcFtoZWFkXTtcbiAgICAgICAgaWYgKGxpc3QpIHtcbiAgICAgICAgICAgIGxpc3QucHVzaCh0aGlzLm1ha2VEb2NTZWxlY3RvcihzZWwpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIG1hcFtoZWFkXSA9IFt0aGlzLm1ha2VEb2NTZWxlY3RvcihzZWwpXTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VsZWN0b3JzTWFwLnByb3RvdHlwZS5tYWtlRG9jU2VsZWN0b3IgPSBmdW5jdGlvbiAoc2VsKSB7XG4gICAgICAgIHJldHVybiB7IHNlbDogc2VsLCBwb3M6IHRoaXMucG9zaXRpb24rKyB9O1xuICAgIH07XG4gICAgcmV0dXJuIFNlbGVjdG9yc01hcDtcbn0oKSk7XG5leHBvcnRzLlNlbGVjdG9yc01hcCA9IFNlbGVjdG9yc01hcDtcbnZhciBTZWxlY3RvcnNNYXRjaCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VsZWN0b3JzTWF0Y2goKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlTWFwID0gbmV3IE1hcCgpO1xuICAgIH1cbiAgICBTZWxlY3RvcnNNYXRjaC5wcm90b3R5cGUuYWRkQXR0cmlidXRlID0gZnVuY3Rpb24gKG5vZGUsIGF0dHJpYnV0ZSkge1xuICAgICAgICB2YXIgZGVwcyA9IHRoaXMucHJvcGVydGllcyhub2RlKTtcbiAgICAgICAgaWYgKCFkZXBzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGRlcHMuYXR0cmlidXRlcyA9IG5ldyBTZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBkZXBzLmF0dHJpYnV0ZXMuYWRkKGF0dHJpYnV0ZSk7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXRjaC5wcm90b3R5cGUuYWRkUHNldWRvQ2xhc3MgPSBmdW5jdGlvbiAobm9kZSwgcHNldWRvQ2xhc3MpIHtcbiAgICAgICAgdmFyIGRlcHMgPSB0aGlzLnByb3BlcnRpZXMobm9kZSk7XG4gICAgICAgIGlmICghZGVwcy5wc2V1ZG9DbGFzc2VzKSB7XG4gICAgICAgICAgICBkZXBzLnBzZXVkb0NsYXNzZXMgPSBuZXcgU2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZGVwcy5wc2V1ZG9DbGFzc2VzLmFkZChwc2V1ZG9DbGFzcyk7XG4gICAgfTtcbiAgICBTZWxlY3RvcnNNYXRjaC5wcm90b3R5cGUucHJvcGVydGllcyA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHZhciBzZXQgPSB0aGlzLmNoYW5nZU1hcC5nZXQobm9kZSk7XG4gICAgICAgIGlmICghc2V0KSB7XG4gICAgICAgICAgICB0aGlzLmNoYW5nZU1hcC5zZXQobm9kZSwgc2V0ID0ge30pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXQ7XG4gICAgfTtcbiAgICByZXR1cm4gU2VsZWN0b3JzTWF0Y2g7XG59KCkpO1xuZXhwb3J0cy5TZWxlY3RvcnNNYXRjaCA9IFNlbGVjdG9yc01hdGNoO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y3NzLXNlbGVjdG9yLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vY29yZS9wcm9wZXJ0aWVzXCIpO1xudmFyIEZvbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZvbnQoZm9udEZhbWlseSwgZm9udFNpemUsIGZvbnRTdHlsZSwgZm9udFdlaWdodCkge1xuICAgICAgICB0aGlzLmZvbnRGYW1pbHkgPSBmb250RmFtaWx5O1xuICAgICAgICB0aGlzLmZvbnRTaXplID0gZm9udFNpemU7XG4gICAgICAgIHRoaXMuZm9udFN0eWxlID0gZm9udFN0eWxlO1xuICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPSBmb250V2VpZ2h0O1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9udC5wcm90b3R5cGUsIFwiaXNJdGFsaWNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZvbnRTdHlsZSA9PT0gRm9udFN0eWxlLklUQUxJQztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEZvbnQucHJvdG90eXBlLCBcImlzQm9sZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9udFdlaWdodCA9PT0gRm9udFdlaWdodC5TRU1JX0JPTEQgfHxcbiAgICAgICAgICAgICAgICB0aGlzLmZvbnRXZWlnaHQgPT09IEZvbnRXZWlnaHQuQk9MRCB8fFxuICAgICAgICAgICAgICAgIHRoaXMuZm9udFdlaWdodCA9PT0gXCI3MDBcIiB8fFxuICAgICAgICAgICAgICAgIHRoaXMuZm9udFdlaWdodCA9PT0gRm9udFdlaWdodC5FWFRSQV9CT0xEIHx8XG4gICAgICAgICAgICAgICAgdGhpcy5mb250V2VpZ2h0ID09PSBGb250V2VpZ2h0LkJMQUNLO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBGb250LmVxdWFscyA9IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAoIXZhbHVlMSAmJiAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXZhbHVlMSB8fCAhdmFsdWUyKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlMS5mb250RmFtaWx5ID09PSB2YWx1ZTIuZm9udEZhbWlseSAmJlxuICAgICAgICAgICAgdmFsdWUxLmZvbnRTaXplID09PSB2YWx1ZTIuZm9udFNpemUgJiZcbiAgICAgICAgICAgIHZhbHVlMS5mb250U3R5bGUgPT09IHZhbHVlMi5mb250U3R5bGUgJiZcbiAgICAgICAgICAgIHZhbHVlMS5mb250V2VpZ2h0ID09PSB2YWx1ZTIuZm9udFdlaWdodDtcbiAgICB9O1xuICAgIEZvbnQuZGVmYXVsdCA9IHVuZGVmaW5lZDtcbiAgICByZXR1cm4gRm9udDtcbn0oKSk7XG5leHBvcnRzLkZvbnQgPSBGb250O1xudmFyIEZvbnRTdHlsZTtcbihmdW5jdGlvbiAoRm9udFN0eWxlKSB7XG4gICAgRm9udFN0eWxlLk5PUk1BTCA9IFwibm9ybWFsXCI7XG4gICAgRm9udFN0eWxlLklUQUxJQyA9IFwiaXRhbGljXCI7XG4gICAgRm9udFN0eWxlLmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihGb250U3R5bGUuTk9STUFMLCBGb250U3R5bGUuSVRBTElDKTtcbiAgICBGb250U3R5bGUucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihGb250U3R5bGUuaXNWYWxpZCk7XG59KShGb250U3R5bGUgPSBleHBvcnRzLkZvbnRTdHlsZSB8fCAoZXhwb3J0cy5Gb250U3R5bGUgPSB7fSkpO1xudmFyIEZvbnRXZWlnaHQ7XG4oZnVuY3Rpb24gKEZvbnRXZWlnaHQpIHtcbiAgICBGb250V2VpZ2h0LlRISU4gPSBcIjEwMFwiO1xuICAgIEZvbnRXZWlnaHQuRVhUUkFfTElHSFQgPSBcIjIwMFwiO1xuICAgIEZvbnRXZWlnaHQuTElHSFQgPSBcIjMwMFwiO1xuICAgIEZvbnRXZWlnaHQuTk9STUFMID0gXCJub3JtYWxcIjtcbiAgICBGb250V2VpZ2h0Lk1FRElVTSA9IFwiNTAwXCI7XG4gICAgRm9udFdlaWdodC5TRU1JX0JPTEQgPSBcIjYwMFwiO1xuICAgIEZvbnRXZWlnaHQuQk9MRCA9IFwiYm9sZFwiO1xuICAgIEZvbnRXZWlnaHQuRVhUUkFfQk9MRCA9IFwiODAwXCI7XG4gICAgRm9udFdlaWdodC5CTEFDSyA9IFwiOTAwXCI7XG4gICAgRm9udFdlaWdodC5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoRm9udFdlaWdodC5USElOLCBGb250V2VpZ2h0LkVYVFJBX0xJR0hULCBGb250V2VpZ2h0LkxJR0hULCBGb250V2VpZ2h0Lk5PUk1BTCwgXCI0MDBcIiwgRm9udFdlaWdodC5NRURJVU0sIEZvbnRXZWlnaHQuU0VNSV9CT0xELCBGb250V2VpZ2h0LkJPTEQsIFwiNzAwXCIsIEZvbnRXZWlnaHQuRVhUUkFfQk9MRCwgRm9udFdlaWdodC5CTEFDSyk7XG4gICAgRm9udFdlaWdodC5wYXJzZSA9IHByb3BlcnRpZXNfMS5tYWtlUGFyc2VyKEZvbnRXZWlnaHQuaXNWYWxpZCk7XG59KShGb250V2VpZ2h0ID0gZXhwb3J0cy5Gb250V2VpZ2h0IHx8IChleHBvcnRzLkZvbnRXZWlnaHQgPSB7fSkpO1xuZnVuY3Rpb24gcGFyc2VGb250RmFtaWx5KHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSgpO1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdmFyIHNwbGl0ID0gdmFsdWUuc3BsaXQoXCIsXCIpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BsaXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIHN0ciA9IHNwbGl0W2ldLnRyaW0oKS5yZXBsYWNlKC9bJ1wiXSsvZywgXCJcIik7XG4gICAgICAgIGlmIChzdHIpIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHN0cik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMucGFyc2VGb250RmFtaWx5ID0gcGFyc2VGb250RmFtaWx5O1xudmFyIGdlbmVyaWNGb250RmFtaWxpZXM7XG4oZnVuY3Rpb24gKGdlbmVyaWNGb250RmFtaWxpZXMpIHtcbiAgICBnZW5lcmljRm9udEZhbWlsaWVzLnNlcmlmID0gXCJzZXJpZlwiO1xuICAgIGdlbmVyaWNGb250RmFtaWxpZXMuc2Fuc1NlcmlmID0gXCJzYW5zLXNlcmlmXCI7XG4gICAgZ2VuZXJpY0ZvbnRGYW1pbGllcy5tb25vc3BhY2UgPSBcIm1vbm9zcGFjZVwiO1xuICAgIGdlbmVyaWNGb250RmFtaWxpZXMuc3lzdGVtID0gXCJzeXN0ZW1cIjtcbn0pKGdlbmVyaWNGb250RmFtaWxpZXMgPSBleHBvcnRzLmdlbmVyaWNGb250RmFtaWxpZXMgfHwgKGV4cG9ydHMuZ2VuZXJpY0ZvbnRGYW1pbGllcyA9IHt9KSk7XG52YXIgc3R5bGVzID0gbmV3IFNldCgpO1xuW1xuICAgIEZvbnRTdHlsZS5OT1JNQUwsXG4gICAgRm9udFN0eWxlLklUQUxJQ1xuXS5mb3JFYWNoKGZ1bmN0aW9uICh2YWwsIGksIGEpIHsgcmV0dXJuIHN0eWxlcy5hZGQodmFsKTsgfSk7XG52YXIgd2VpZ2h0cyA9IG5ldyBTZXQoKTtcbltcbiAgICBGb250V2VpZ2h0LlRISU4sXG4gICAgRm9udFdlaWdodC5FWFRSQV9MSUdIVCxcbiAgICBGb250V2VpZ2h0LkxJR0hULFxuICAgIEZvbnRXZWlnaHQuTk9STUFMLFxuICAgIFwiNDAwXCIsXG4gICAgRm9udFdlaWdodC5NRURJVU0sXG4gICAgRm9udFdlaWdodC5TRU1JX0JPTEQsXG4gICAgRm9udFdlaWdodC5CT0xELFxuICAgIFwiNzAwXCIsXG4gICAgRm9udFdlaWdodC5FWFRSQV9CT0xELFxuICAgIEZvbnRXZWlnaHQuQkxBQ0tcbl0uZm9yRWFjaChmdW5jdGlvbiAodmFsLCBpLCBhKSB7IHJldHVybiB3ZWlnaHRzLmFkZCh2YWwpOyB9KTtcbmZ1bmN0aW9uIHBhcnNlRm9udChmb250VmFsdWUpIHtcbiAgICB2YXIgcmVzdWx0ID0ge1xuICAgICAgICBmb250U3R5bGU6IFwibm9ybWFsXCIsXG4gICAgICAgIGZvbnRWYXJpYW50OiBcIm5vcm1hbFwiLFxuICAgICAgICBmb250V2VpZ2h0OiBcIm5vcm1hbFwiXG4gICAgfTtcbiAgICB2YXIgcGFydHMgPSBmb250VmFsdWUuc3BsaXQoL1xccysvKTtcbiAgICB2YXIgcGFydDtcbiAgICB3aGlsZSAocGFydCA9IHBhcnRzLnNoaWZ0KCkpIHtcbiAgICAgICAgaWYgKHBhcnQgPT09IFwibm9ybWFsXCIpIHtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChwYXJ0ID09PSBcInNtYWxsLWNhcHNcIikge1xuICAgICAgICAgICAgcmVzdWx0LmZvbnRWYXJpYW50ID0gcGFydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChzdHlsZXMuaGFzKHBhcnQpKSB7XG4gICAgICAgICAgICByZXN1bHQuZm9udFN0eWxlID0gcGFydDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh3ZWlnaHRzLmhhcyhwYXJ0KSkge1xuICAgICAgICAgICAgcmVzdWx0LmZvbnRXZWlnaHQgPSBwYXJ0O1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCFyZXN1bHQuZm9udFNpemUpIHtcbiAgICAgICAgICAgIHZhciBzaXplcyA9IHBhcnQuc3BsaXQoXCIvXCIpO1xuICAgICAgICAgICAgcmVzdWx0LmZvbnRTaXplID0gc2l6ZXNbMF07XG4gICAgICAgICAgICByZXN1bHQubGluZUhlaWdodCA9IHNpemVzLmxlbmd0aCA+IDEgPyBzaXplc1sxXSA6IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdC5mb250RmFtaWx5ID0gcGFydDtcbiAgICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuZm9udEZhbWlseSArPSBcIiBcIiArIHBhcnRzLmpvaW4oXCIgXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMucGFyc2VGb250ID0gcGFyc2VGb250O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zm9udC1jb21tb24uanMubWFwIiwiZnVuY3Rpb24gX19leHBvcnQobSkge1xuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcbn1cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBmb250X2NvbW1vbl8xID0gcmVxdWlyZShcIi4vZm9udC1jb21tb25cIik7XG52YXIgdHJhY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi90cmFjZVwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIGZzID0gcmVxdWlyZShcIi4uLy4uL2ZpbGUtc3lzdGVtXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vZm9udC1jb21tb25cIikpO1xudmFyIEVNVUxBVEVfT0JMSVFVRSA9IHRydWU7XG52YXIgT0JMSVFVRV9UUkFOU0ZPUk0gPSBDR0FmZmluZVRyYW5zZm9ybU1ha2UoMSwgMCwgMC4yLCAxLCAwLCAwKTtcbnZhciBERUZBVUxUX1NFUklGID0gXCJUaW1lcyBOZXcgUm9tYW5cIjtcbnZhciBERUZBVUxUX01PTk9TUEFDRSA9IFwiQ291cmllciBOZXdcIjtcbnZhciBTVVBQT1JUX0ZPTlRfV0VJR0hUUyA9IHBhcnNlRmxvYXQocGxhdGZvcm1fMS5kZXZpY2Uub3NWZXJzaW9uKSA+PSAxMC4wO1xudmFyIEZvbnQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhGb250LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZvbnQoZmFtaWx5LCBzaXplLCBzdHlsZSwgd2VpZ2h0KSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBmYW1pbHksIHNpemUsIHN0eWxlLCB3ZWlnaHQpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZvbnQucHJvdG90eXBlLndpdGhGb250RmFtaWx5ID0gZnVuY3Rpb24gKGZhbWlseSkge1xuICAgICAgICByZXR1cm4gbmV3IEZvbnQoZmFtaWx5LCB0aGlzLmZvbnRTaXplLCB0aGlzLmZvbnRTdHlsZSwgdGhpcy5mb250V2VpZ2h0KTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLndpdGhGb250U3R5bGUgPSBmdW5jdGlvbiAoc3R5bGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGb250KHRoaXMuZm9udEZhbWlseSwgdGhpcy5mb250U2l6ZSwgc3R5bGUsIHRoaXMuZm9udFdlaWdodCk7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS53aXRoRm9udFdlaWdodCA9IGZ1bmN0aW9uICh3ZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGb250KHRoaXMuZm9udEZhbWlseSwgdGhpcy5mb250U2l6ZSwgdGhpcy5mb250U3R5bGUsIHdlaWdodCk7XG4gICAgfTtcbiAgICBGb250LnByb3RvdHlwZS53aXRoRm9udFNpemUgPSBmdW5jdGlvbiAoc2l6ZSkge1xuICAgICAgICByZXR1cm4gbmV3IEZvbnQodGhpcy5mb250RmFtaWx5LCBzaXplLCB0aGlzLmZvbnRTdHlsZSwgdGhpcy5mb250V2VpZ2h0KTtcbiAgICB9O1xuICAgIEZvbnQucHJvdG90eXBlLmdldFVJRm9udCA9IGZ1bmN0aW9uIChkZWZhdWx0Rm9udCkge1xuICAgICAgICBpZiAoIXRoaXMuX3VpRm9udCkge1xuICAgICAgICAgICAgdGhpcy5fdWlGb250ID0gY3JlYXRlVUlGb250KHRoaXMsIGRlZmF1bHRGb250KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fdWlGb250O1xuICAgIH07XG4gICAgRm9udC5wcm90b3R5cGUuZ2V0QW5kcm9pZFR5cGVmYWNlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgRm9udC5kZWZhdWx0ID0gbmV3IEZvbnQodW5kZWZpbmVkLCB1bmRlZmluZWQsIGZvbnRfY29tbW9uXzEuRm9udFN0eWxlLk5PUk1BTCwgZm9udF9jb21tb25fMS5Gb250V2VpZ2h0Lk5PUk1BTCk7XG4gICAgcmV0dXJuIEZvbnQ7XG59KGZvbnRfY29tbW9uXzEuRm9udCkpO1xuZXhwb3J0cy5Gb250ID0gRm9udDtcbmZ1bmN0aW9uIGdldEZvbnRGYW1pbHlSZXNwZWN0aW5nR2VuZXJpY0ZvbnRzKGZvbnRGYW1pbHkpIHtcbiAgICBpZiAoIWZvbnRGYW1pbHkpIHtcbiAgICAgICAgcmV0dXJuIGZvbnRGYW1pbHk7XG4gICAgfVxuICAgIHN3aXRjaCAoZm9udEZhbWlseS50b0xvd2VyQ2FzZSgpKSB7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLnNlcmlmOlxuICAgICAgICAgICAgcmV0dXJuIERFRkFVTFRfU0VSSUY7XG4gICAgICAgIGNhc2UgZm9udF9jb21tb25fMS5nZW5lcmljRm9udEZhbWlsaWVzLm1vbm9zcGFjZTpcbiAgICAgICAgICAgIHJldHVybiBERUZBVUxUX01PTk9TUEFDRTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBmb250RmFtaWx5O1xuICAgIH1cbn1cbmZ1bmN0aW9uIHNob3VsZFVzZVN5c3RlbUZvbnQoZm9udEZhbWlseSkge1xuICAgIHJldHVybiAhZm9udEZhbWlseSB8fFxuICAgICAgICBmb250RmFtaWx5ID09PSBmb250X2NvbW1vbl8xLmdlbmVyaWNGb250RmFtaWxpZXMuc2Fuc1NlcmlmIHx8XG4gICAgICAgIGZvbnRGYW1pbHkgPT09IGZvbnRfY29tbW9uXzEuZ2VuZXJpY0ZvbnRGYW1pbGllcy5zeXN0ZW07XG59XG5mdW5jdGlvbiBnZXROYXRpdmVGb250V2VpZ2h0KGZvbnRXZWlnaHQpIHtcbiAgICBzd2l0Y2ggKGZvbnRXZWlnaHQpIHtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuVEhJTjpcbiAgICAgICAgICAgIHJldHVybiBVSUZvbnRXZWlnaHRVbHRyYUxpZ2h0O1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5FWFRSQV9MSUdIVDpcbiAgICAgICAgICAgIHJldHVybiBVSUZvbnRXZWlnaHRUaGluO1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5MSUdIVDpcbiAgICAgICAgICAgIHJldHVybiBVSUZvbnRXZWlnaHRMaWdodDtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuTk9STUFMOlxuICAgICAgICBjYXNlIFwiNDAwXCI6XG4gICAgICAgIGNhc2UgdW5kZWZpbmVkOlxuICAgICAgICBjYXNlIG51bGw6XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0UmVndWxhcjtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuTUVESVVNOlxuICAgICAgICAgICAgcmV0dXJuIFVJRm9udFdlaWdodE1lZGl1bTtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuU0VNSV9CT0xEOlxuICAgICAgICAgICAgcmV0dXJuIFVJRm9udFdlaWdodFNlbWlib2xkO1xuICAgICAgICBjYXNlIGZvbnRfY29tbW9uXzEuRm9udFdlaWdodC5CT0xEOlxuICAgICAgICBjYXNlIFwiNzAwXCI6XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0Qm9sZDtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuRVhUUkFfQk9MRDpcbiAgICAgICAgICAgIHJldHVybiBVSUZvbnRXZWlnaHRIZWF2eTtcbiAgICAgICAgY2FzZSBmb250X2NvbW1vbl8xLkZvbnRXZWlnaHQuQkxBQ0s6XG4gICAgICAgICAgICByZXR1cm4gVUlGb250V2VpZ2h0QmxhY2s7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGZvbnQgd2VpZ2h0OiBcXFwiXCIgKyBmb250V2VpZ2h0ICsgXCJcXFwiXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldFN5c3RlbUZvbnQoc2l6ZSwgbmF0aXZlV2VpZ2h0LCBpdGFsaWMsIHN5bWJvbGljVHJhaXRzKSB7XG4gICAgdmFyIHJlc3VsdCA9IFVJRm9udC5zeXN0ZW1Gb250T2ZTaXplV2VpZ2h0KHNpemUsIG5hdGl2ZVdlaWdodCk7XG4gICAgaWYgKGl0YWxpYykge1xuICAgICAgICB2YXIgZGVzY3JpcHRvciA9IHJlc3VsdC5mb250RGVzY3JpcHRvci5mb250RGVzY3JpcHRvcldpdGhTeW1ib2xpY1RyYWl0cyhzeW1ib2xpY1RyYWl0cyk7XG4gICAgICAgIHJlc3VsdCA9IFVJRm9udC5mb250V2l0aERlc2NyaXB0b3JTaXplKGRlc2NyaXB0b3IsIHNpemUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZnVuY3Rpb24gY3JlYXRlVUlGb250KGZvbnQsIGRlZmF1bHRGb250KSB7XG4gICAgdmFyIF9hLCBfYjtcbiAgICB2YXIgcmVzdWx0O1xuICAgIHZhciBzaXplID0gZm9udC5mb250U2l6ZSB8fCBkZWZhdWx0Rm9udC5wb2ludFNpemU7XG4gICAgdmFyIG5hdGl2ZVdlaWdodCA9IGdldE5hdGl2ZUZvbnRXZWlnaHQoZm9udC5mb250V2VpZ2h0KTtcbiAgICB2YXIgZm9udEZhbWlsaWVzID0gZm9udF9jb21tb25fMS5wYXJzZUZvbnRGYW1pbHkoZm9udC5mb250RmFtaWx5KTtcbiAgICB2YXIgc3ltYm9saWNUcmFpdHMgPSAwO1xuICAgIGlmIChmb250LmlzQm9sZCkge1xuICAgICAgICBzeW1ib2xpY1RyYWl0cyB8PSAyO1xuICAgIH1cbiAgICBpZiAoZm9udC5pc0l0YWxpYykge1xuICAgICAgICBzeW1ib2xpY1RyYWl0cyB8PSAxO1xuICAgIH1cbiAgICB2YXIgZm9udERlc2NyaXB0b3JUcmFpdHMgPSAoX2EgPSB7fSxcbiAgICAgICAgX2FbVUlGb250U3ltYm9saWNUcmFpdF0gPSBzeW1ib2xpY1RyYWl0cyxcbiAgICAgICAgX2EpO1xuICAgIGlmIChTVVBQT1JUX0ZPTlRfV0VJR0hUUykge1xuICAgICAgICBmb250RGVzY3JpcHRvclRyYWl0c1tVSUZvbnRXZWlnaHRUcmFpdF0gPSBuYXRpdmVXZWlnaHQ7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZm9udEZhbWlsaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBmb250RmFtaWx5ID0gZ2V0Rm9udEZhbWlseVJlc3BlY3RpbmdHZW5lcmljRm9udHMoZm9udEZhbWlsaWVzW2ldKTtcbiAgICAgICAgaWYgKHNob3VsZFVzZVN5c3RlbUZvbnQoZm9udEZhbWlseSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGdldFN5c3RlbUZvbnQoc2l6ZSwgbmF0aXZlV2VpZ2h0LCBmb250LmlzSXRhbGljLCBzeW1ib2xpY1RyYWl0cyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmb250QXR0cmlidXRlcyA9IChfYiA9IHt9LFxuICAgICAgICAgICAgICAgIF9iW1VJRm9udERlc2NyaXB0b3JGYW1pbHlBdHRyaWJ1dGVdID0gZm9udEZhbWlseSxcbiAgICAgICAgICAgICAgICBfYltVSUZvbnREZXNjcmlwdG9yVHJhaXRzQXR0cmlidXRlXSA9IGZvbnREZXNjcmlwdG9yVHJhaXRzLFxuICAgICAgICAgICAgICAgIF9iKTtcbiAgICAgICAgICAgIHZhciBkZXNjcmlwdG9yID0gVUlGb250RGVzY3JpcHRvci5mb250RGVzY3JpcHRvcldpdGhGb250QXR0cmlidXRlcyhmb250QXR0cmlidXRlcyk7XG4gICAgICAgICAgICByZXN1bHQgPSBVSUZvbnQuZm9udFdpdGhEZXNjcmlwdG9yU2l6ZShkZXNjcmlwdG9yLCBzaXplKTtcbiAgICAgICAgICAgIHZhciBhY3R1YWxJdGFsaWMgPSByZXN1bHQuZm9udERlc2NyaXB0b3Iuc3ltYm9saWNUcmFpdHMgJiAxO1xuICAgICAgICAgICAgaWYgKGZvbnQuaXNJdGFsaWMgJiYgIWFjdHVhbEl0YWxpYyAmJiBFTVVMQVRFX09CTElRVUUpIHtcbiAgICAgICAgICAgICAgICBkZXNjcmlwdG9yID0gZGVzY3JpcHRvci5mb250RGVzY3JpcHRvcldpdGhNYXRyaXgoT0JMSVFVRV9UUkFOU0ZPUk0pO1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IFVJRm9udC5mb250V2l0aERlc2NyaXB0b3JTaXplKGRlc2NyaXB0b3IsIHNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdC5mYW1pbHlOYW1lID09PSBmb250RmFtaWx5KSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJlc3VsdCA9IGdldFN5c3RlbUZvbnQoc2l6ZSwgbmF0aXZlV2VpZ2h0LCBmb250LmlzSXRhbGljLCBzeW1ib2xpY1RyYWl0cyk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG59XG52YXIgaW9zO1xuKGZ1bmN0aW9uIChpb3MpIHtcbiAgICBmdW5jdGlvbiByZWdpc3RlckZvbnQoZm9udEZpbGUpIHtcbiAgICAgICAgdmFyIGZpbGVQYXRoID0gZnMucGF0aC5qb2luKGZzLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aCwgXCJmb250c1wiLCBmb250RmlsZSk7XG4gICAgICAgIGlmICghZnMuRmlsZS5leGlzdHMoZmlsZVBhdGgpKSB7XG4gICAgICAgICAgICBmaWxlUGF0aCA9IGZzLnBhdGguam9pbihmcy5rbm93bkZvbGRlcnMuY3VycmVudEFwcCgpLnBhdGgsIGZvbnRGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm9udERhdGEgPSBOU0ZpbGVNYW5hZ2VyLmRlZmF1bHRNYW5hZ2VyLmNvbnRlbnRzQXRQYXRoKGZpbGVQYXRoKTtcbiAgICAgICAgaWYgKCFmb250RGF0YSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ291bGQgbm90IGxvYWQgZm9udCBmcm9tOiBcIiArIGZvbnRGaWxlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcHJvdmlkZXIgPSBDR0RhdGFQcm92aWRlckNyZWF0ZVdpdGhDRkRhdGEoZm9udERhdGEpO1xuICAgICAgICB2YXIgZm9udCA9IENHRm9udENyZWF0ZVdpdGhEYXRhUHJvdmlkZXIocHJvdmlkZXIpO1xuICAgICAgICBpZiAoIWZvbnQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkIG5vdCBsb2FkIGZvbnQgZnJvbTogXCIgKyBmb250RmlsZSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGVycm9yID0gbmV3IGludGVyb3AuUmVmZXJlbmNlKCk7XG4gICAgICAgIGlmICghQ1RGb250TWFuYWdlclJlZ2lzdGVyR3JhcGhpY3NGb250KGZvbnQsIGVycm9yKSkge1xuICAgICAgICAgICAgaWYgKHRyYWNlXzEuaXNFbmFibGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRXJyb3Igb2NjdXIgd2hpbGUgcmVnaXN0ZXJpbmcgZm9udDogXCIgKyBDRkVycm9yQ29weURlc2NyaXB0aW9uKGVycm9yLnZhbHVlKSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpb3MucmVnaXN0ZXJGb250ID0gcmVnaXN0ZXJGb250O1xufSkoaW9zID0gZXhwb3J0cy5pb3MgfHwgKGV4cG9ydHMuaW9zID0ge30pKTtcbmZ1bmN0aW9uIHJlZ2lzdGVyRm9udHNJbkZvbGRlcihmb250c0ZvbGRlclBhdGgpIHtcbiAgICB2YXIgZm9udHNGb2xkZXIgPSBmcy5Gb2xkZXIuZnJvbVBhdGgoZm9udHNGb2xkZXJQYXRoKTtcbiAgICBmb250c0ZvbGRlci5lYWNoRW50aXR5KGZ1bmN0aW9uIChmaWxlRW50aXR5KSB7XG4gICAgICAgIGlmIChmcy5Gb2xkZXIuZXhpc3RzKGZzLnBhdGguam9pbihmb250c0ZvbGRlclBhdGgsIGZpbGVFbnRpdHkubmFtZSkpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsZUVudGl0eSBpbnN0YW5jZW9mIGZzLkZpbGUgJiZcbiAgICAgICAgICAgIChmaWxlRW50aXR5LmV4dGVuc2lvbiA9PT0gXCIudHRmXCIgfHwgZmlsZUVudGl0eS5leHRlbnNpb24gPT09IFwiLm90ZlwiKSkge1xuICAgICAgICAgICAgaW9zLnJlZ2lzdGVyRm9udChmaWxlRW50aXR5Lm5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gcmVnaXN0ZXJDdXN0b21Gb250cygpIHtcbiAgICB2YXIgYXBwRGlyID0gZnMua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoO1xuICAgIHZhciBmb250c0RpciA9IGZzLnBhdGguam9pbihhcHBEaXIsIFwiZm9udHNcIik7XG4gICAgaWYgKGZzLkZvbGRlci5leGlzdHMoZm9udHNEaXIpKSB7XG4gICAgICAgIHJlZ2lzdGVyRm9udHNJbkZvbGRlcihmb250c0Rpcik7XG4gICAgfVxufVxucmVnaXN0ZXJDdXN0b21Gb250cygpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zm9udC5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgTGluZWFyR3JhZGllbnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExpbmVhckdyYWRpZW50KCkge1xuICAgIH1cbiAgICBMaW5lYXJHcmFkaWVudC5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IExpbmVhckdyYWRpZW50KCk7XG4gICAgICAgIHJlc3VsdC5hbmdsZSA9IHZhbHVlLmFuZ2xlO1xuICAgICAgICByZXN1bHQuY29sb3JTdG9wcyA9IHZhbHVlLmNvbG9ycy5tYXAoZnVuY3Rpb24gKGNvbG9yKSB7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gY29sb3Iub2Zmc2V0IHx8IG51bGw7XG4gICAgICAgICAgICB2YXIgb2Zmc2V0VW5pdDtcbiAgICAgICAgICAgIGlmIChvZmZzZXQgJiYgb2Zmc2V0LnVuaXQgPT09IFwiJVwiKSB7XG4gICAgICAgICAgICAgICAgb2Zmc2V0VW5pdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgdW5pdDogXCIlXCIsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvZmZzZXQudmFsdWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb2xvcjogbmV3IGNvbG9yXzEuQ29sb3IoY29sb3IuYXJnYiksXG4gICAgICAgICAgICAgICAgb2Zmc2V0OiBvZmZzZXRVbml0XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIExpbmVhckdyYWRpZW50LmVxdWFscyA9IGZ1bmN0aW9uIChmaXJzdCwgc2Vjb25kKSB7XG4gICAgICAgIGlmICghZmlyc3QgJiYgIXNlY29uZCkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIWZpcnN0IHx8ICFzZWNvbmQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlyc3QuYW5nbGUgIT09IHNlY29uZC5hbmdsZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaXJzdC5jb2xvclN0b3BzLmxlbmd0aCAhPT0gc2Vjb25kLmNvbG9yU3RvcHMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBmaXJzdC5jb2xvclN0b3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZmlyc3RTdG9wID0gZmlyc3QuY29sb3JTdG9wc1tpXTtcbiAgICAgICAgICAgIHZhciBzZWNvbmRTdG9wID0gc2Vjb25kLmNvbG9yU3RvcHNbaV07XG4gICAgICAgICAgICBpZiAoZmlyc3RTdG9wLm9mZnNldCAhPT0gc2Vjb25kU3RvcC5vZmZzZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWNvbG9yXzEuQ29sb3IuZXF1YWxzKGZpcnN0U3RvcC5jb2xvciwgc2Vjb25kU3RvcC5jb2xvcikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICByZXR1cm4gTGluZWFyR3JhZGllbnQ7XG59KCkpO1xuZXhwb3J0cy5MaW5lYXJHcmFkaWVudCA9IExpbmVhckdyYWRpZW50O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bGluZWFyLWdyYWRpZW50LmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBwcm9wZXJ0aWVzXzEgPSByZXF1aXJlKFwiLi4vY29yZS9wcm9wZXJ0aWVzXCIpO1xudmFyIGNvbG9yXzEgPSByZXF1aXJlKFwiLi4vLi4vY29sb3JcIik7XG52YXIgZm9udF8xID0gcmVxdWlyZShcIi4uLy4uL3VpL3N0eWxpbmcvZm9udFwiKTtcbnZhciB1dGlsc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3V0aWxzXCIpO1xudmFyIGJhY2tncm91bmRfMSA9IHJlcXVpcmUoXCIuLi8uLi91aS9zdHlsaW5nL2JhY2tncm91bmRcIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi9wbGF0Zm9ybVwiKTtcbnZhciBudW1iZXJfdXRpbHNfMSA9IHJlcXVpcmUoXCIuLi8uLi91dGlscy9udW1iZXItdXRpbHNcIik7XG52YXIgbWF0cml4XzEgPSByZXF1aXJlKFwiLi4vLi4vbWF0cml4XCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vdHJhY2VcIik7XG52YXIgcGFyc2VyID0gcmVxdWlyZShcIi4uLy4uL2Nzcy9wYXJzZXJcIik7XG52YXIgbGluZWFyX2dyYWRpZW50XzEgPSByZXF1aXJlKFwiLi9saW5lYXItZ3JhZGllbnRcIik7XG5mdW5jdGlvbiBlcXVhbHNDb21tb24oYSwgYikge1xuICAgIGlmIChhID09IFwiYXV0b1wiKSB7XG4gICAgICAgIHJldHVybiBiID09IFwiYXV0b1wiO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGEgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgaWYgKGIgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBhID09IGI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFiKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGIudW5pdCA9PSBcImRpcFwiICYmIGEgPT0gYi52YWx1ZTtcbiAgICB9XG4gICAgaWYgKGIgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGIgPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuIGEgPyAoYS51bml0ID09IFwiZGlwXCIgJiYgYS52YWx1ZSA9PSBiKSA6IGZhbHNlO1xuICAgIH1cbiAgICBpZiAoIWEgfHwgIWIpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gYS52YWx1ZSA9PSBiLnZhbHVlICYmIGEudW5pdCA9PSBiLnVuaXQ7XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9TdHJpbmdDb21tb24obGVuZ3RoKSB7XG4gICAgaWYgKGxlbmd0aCA9PSBcImF1dG9cIikge1xuICAgICAgICByZXR1cm4gXCJhdXRvXCI7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgbGVuZ3RoID09PSBcIm51bWJlclwiKSB7XG4gICAgICAgIHJldHVybiBsZW5ndGgudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgdmFyIHZhbCA9IGxlbmd0aC52YWx1ZTtcbiAgICBpZiAobGVuZ3RoLnVuaXQgPT09IFwiJVwiKSB7XG4gICAgICAgIHZhbCAqPSAxMDA7XG4gICAgfVxuICAgIHJldHVybiB2YWwgKyBsZW5ndGgudW5pdDtcbn1cbmZ1bmN0aW9uIHRvRGV2aWNlUGl4ZWxzQ29tbW9uKGxlbmd0aCwgYXV0bywgcGFyZW50QXZhaWxhYmxlV2lkdGgpIHtcbiAgICBpZiAoYXV0byA9PT0gdm9pZCAwKSB7IGF1dG8gPSBOdW1iZXIuTmFOOyB9XG4gICAgaWYgKHBhcmVudEF2YWlsYWJsZVdpZHRoID09PSB2b2lkIDApIHsgcGFyZW50QXZhaWxhYmxlV2lkdGggPSBOdW1iZXIuTmFOOyB9XG4gICAgaWYgKGxlbmd0aCA9PSBcImF1dG9cIikge1xuICAgICAgICByZXR1cm4gYXV0bztcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBsZW5ndGggPT09IFwibnVtYmVyXCIpIHtcbiAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnJvdW5kKHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGxlbmd0aCkpO1xuICAgIH1cbiAgICBpZiAoIWxlbmd0aCkge1xuICAgICAgICByZXR1cm4gYXV0bztcbiAgICB9XG4gICAgc3dpdGNoIChsZW5ndGgudW5pdCkge1xuICAgICAgICBjYXNlIFwicHhcIjpcbiAgICAgICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC5yb3VuZChsZW5ndGgudmFsdWUpO1xuICAgICAgICBjYXNlIFwiJVwiOlxuICAgICAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnJvdW5kKHBhcmVudEF2YWlsYWJsZVdpZHRoICogbGVuZ3RoLnZhbHVlKTtcbiAgICAgICAgY2FzZSBcImRpcFwiOlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIHV0aWxzXzEubGF5b3V0LnJvdW5kKHV0aWxzXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKGxlbmd0aC52YWx1ZSkpO1xuICAgIH1cbn1cbnZhciBQZXJjZW50TGVuZ3RoO1xuKGZ1bmN0aW9uIChQZXJjZW50TGVuZ3RoKSB7XG4gICAgZnVuY3Rpb24gcGFyc2UoZnJvbVZhbHVlKSB7XG4gICAgICAgIGlmIChmcm9tVmFsdWUgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZyb21WYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gZnJvbVZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBwZXJjZW50SW5kZXggPSBzdHJpbmdWYWx1ZS5pbmRleE9mKFwiJVwiKTtcbiAgICAgICAgICAgIGlmIChwZXJjZW50SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmIChwZXJjZW50SW5kZXggIT09IChzdHJpbmdWYWx1ZS5sZW5ndGggLSAxKSB8fCBwZXJjZW50SW5kZXggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBOdW1iZXIuTmFOO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlLnN1YnN0cmluZygwLCBzdHJpbmdWYWx1ZS5sZW5ndGggLSAxKS50cmltKCkpIC8gMTAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4geyB1bml0OiBcIiVcIiwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzdHJpbmdWYWx1ZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZS5yZXBsYWNlKFwicHhcIiwgXCJcIikudHJpbSgpO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyaW5nVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIGZyb21WYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiB7IHVuaXQ6IFwicHhcIiwgdmFsdWU6IHZhbHVlIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwYXJzZUZsb2F0KHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4odmFsdWUpIHx8ICFpc0Zpbml0ZSh2YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBmcm9tVmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZnJvbVZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFBlcmNlbnRMZW5ndGgucGFyc2UgPSBwYXJzZTtcbiAgICBQZXJjZW50TGVuZ3RoLmVxdWFscyA9IGVxdWFsc0NvbW1vbjtcbiAgICBQZXJjZW50TGVuZ3RoLnRvRGV2aWNlUGl4ZWxzID0gdG9EZXZpY2VQaXhlbHNDb21tb247XG4gICAgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcgPSBjb252ZXJ0VG9TdHJpbmdDb21tb247XG59KShQZXJjZW50TGVuZ3RoID0gZXhwb3J0cy5QZXJjZW50TGVuZ3RoIHx8IChleHBvcnRzLlBlcmNlbnRMZW5ndGggPSB7fSkpO1xudmFyIExlbmd0aDtcbihmdW5jdGlvbiAoTGVuZ3RoKSB7XG4gICAgZnVuY3Rpb24gcGFyc2UoZnJvbVZhbHVlKSB7XG4gICAgICAgIGlmIChmcm9tVmFsdWUgPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcImF1dG9cIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGZyb21WYWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIHN0cmluZ1ZhbHVlID0gZnJvbVZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChzdHJpbmdWYWx1ZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZS5yZXBsYWNlKFwicHhcIiwgXCJcIikudHJpbSgpO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyaW5nVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdW5pdDogXCJweFwiLCB2YWx1ZTogdmFsdWUgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHBhcnNlRmxvYXQoc3RyaW5nVmFsdWUpO1xuICAgICAgICAgICAgICAgIGlmIChpc05hTih2YWx1ZSkgfHwgIWlzRmluaXRlKHZhbHVlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHZhbHVlOiBcIiArIHN0cmluZ1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZyb21WYWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBMZW5ndGgucGFyc2UgPSBwYXJzZTtcbiAgICBMZW5ndGguZXF1YWxzID0gZXF1YWxzQ29tbW9uO1xuICAgIExlbmd0aC50b0RldmljZVBpeGVscyA9IHRvRGV2aWNlUGl4ZWxzQ29tbW9uO1xuICAgIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcgPSBjb252ZXJ0VG9TdHJpbmdDb21tb247XG59KShMZW5ndGggPSBleHBvcnRzLkxlbmd0aCB8fCAoZXhwb3J0cy5MZW5ndGggPSB7fSkpO1xuZXhwb3J0cy56ZXJvTGVuZ3RoID0geyB2YWx1ZTogMCwgdW5pdDogXCJweFwiIH07XG5leHBvcnRzLm1pbldpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcIm1pbldpZHRoXCIsIGNzc05hbWU6IFwibWluLXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZU1pbldpZHRoID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMubWluV2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5taW5IZWlnaHRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwibWluSGVpZ2h0XCIsIGNzc05hbWU6IFwibWluLWhlaWdodFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVNaW5IZWlnaHQgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5taW5IZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy53aWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJ3aWR0aFwiLCBjc3NOYW1lOiBcIndpZHRoXCIsIGRlZmF1bHRWYWx1ZTogXCJhdXRvXCIsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKHBsYXRmb3JtXzEuaXNJT1MpIHtcbiAgICAgICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgIHZpZXcucmVxdWVzdExheW91dCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy53aWR0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmhlaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJoZWlnaHRcIiwgY3NzTmFtZTogXCJoZWlnaHRcIiwgZGVmYXVsdFZhbHVlOiBcImF1dG9cIiwgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICBpZiAocGxhdGZvcm1fMS5pc0lPUykge1xuICAgICAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICAgICAgdmlldy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogUGVyY2VudExlbmd0aC5wYXJzZSxcbn0pO1xuZXhwb3J0cy5oZWlnaHRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIG1hcmdpblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJtYXJnaW5cIiwgY3NzTmFtZTogXCJtYXJnaW5cIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKFBlcmNlbnRMZW5ndGguZXF1YWxzKHRoaXMubWFyZ2luVG9wLCB0aGlzLm1hcmdpblJpZ2h0KSAmJlxuICAgICAgICAgICAgUGVyY2VudExlbmd0aC5lcXVhbHModGhpcy5tYXJnaW5Ub3AsIHRoaXMubWFyZ2luQm90dG9tKSAmJlxuICAgICAgICAgICAgUGVyY2VudExlbmd0aC5lcXVhbHModGhpcy5tYXJnaW5Ub3AsIHRoaXMubWFyZ2luTGVmdCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hcmdpblRvcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5Ub3ApICsgXCIgXCIgKyBQZXJjZW50TGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLm1hcmdpblJpZ2h0KSArIFwiIFwiICsgUGVyY2VudExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5tYXJnaW5Cb3R0b20pICsgXCIgXCIgKyBQZXJjZW50TGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLm1hcmdpbkxlZnQpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9NYXJnaW5zXG59KTtcbm1hcmdpblByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLm1hcmdpbkxlZnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIm1hcmdpbkxlZnRcIiwgY3NzTmFtZTogXCJtYXJnaW4tbGVmdFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UgfSk7XG5leHBvcnRzLm1hcmdpbkxlZnRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibWFyZ2luUmlnaHRcIiwgY3NzTmFtZTogXCJtYXJnaW4tcmlnaHRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBQZXJjZW50TGVuZ3RoLnBhcnNlIH0pO1xuZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLm1hcmdpblRvcFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibWFyZ2luVG9wXCIsIGNzc05hbWU6IFwibWFyZ2luLXRvcFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UgfSk7XG5leHBvcnRzLm1hcmdpblRvcFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLm1hcmdpbkJvdHRvbVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibWFyZ2luQm90dG9tXCIsIGNzc05hbWU6IFwibWFyZ2luLWJvdHRvbVwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IFBlcmNlbnRMZW5ndGgucGFyc2UgfSk7XG5leHBvcnRzLm1hcmdpbkJvdHRvbVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgcGFkZGluZ1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJwYWRkaW5nXCIsIGNzc05hbWU6IFwicGFkZGluZ1wiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoTGVuZ3RoLmVxdWFscyh0aGlzLnBhZGRpbmdUb3AsIHRoaXMucGFkZGluZ1JpZ2h0KSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLnBhZGRpbmdUb3AsIHRoaXMucGFkZGluZ0JvdHRvbSkgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5wYWRkaW5nVG9wLCB0aGlzLnBhZGRpbmdMZWZ0KSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFkZGluZ1RvcDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdUb3ApICsgXCIgXCIgKyBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMucGFkZGluZ1JpZ2h0KSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLnBhZGRpbmdCb3R0b20pICsgXCIgXCIgKyBMZW5ndGguY29udmVydFRvU3RyaW5nKHRoaXMucGFkZGluZ0xlZnQpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9QYWRkaW5nc1xufSk7XG5wYWRkaW5nUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMucGFkZGluZ0xlZnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ0xlZnRcIiwgY3NzTmFtZTogXCJwYWRkaW5nLWxlZnRcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlUGFkZGluZ0xlZnQgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nTGVmdFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdSaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJwYWRkaW5nUmlnaHRcIiwgY3NzTmFtZTogXCJwYWRkaW5nLXJpZ2h0XCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdSaWdodCA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLnBhZGRpbmdSaWdodFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLnBhZGRpbmdUb3BQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwicGFkZGluZ1RvcFwiLCBjc3NOYW1lOiBcInBhZGRpbmctdG9wXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZVBhZGRpbmdUb3AgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMucGFkZGluZ0JvdHRvbVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJwYWRkaW5nQm90dG9tXCIsIGNzc05hbWU6IFwicGFkZGluZy1ib3R0b21cIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSB0YXJnZXQudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgIHZpZXcuZWZmZWN0aXZlUGFkZGluZ0JvdHRvbSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLnBhZGRpbmdCb3R0b21Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIEhvcml6b250YWxBbGlnbm1lbnQ7XG4oZnVuY3Rpb24gKEhvcml6b250YWxBbGlnbm1lbnQpIHtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LkxFRlQgPSBcImxlZnRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LkNFTlRFUiA9IFwiY2VudGVyXCI7XG4gICAgSG9yaXpvbnRhbEFsaWdubWVudC5SSUdIVCA9IFwicmlnaHRcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0ggPSBcInN0cmV0Y2hcIjtcbiAgICBIb3Jpem9udGFsQWxpZ25tZW50LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihIb3Jpem9udGFsQWxpZ25tZW50LkxFRlQsIEhvcml6b250YWxBbGlnbm1lbnQuQ0VOVEVSLCBIb3Jpem9udGFsQWxpZ25tZW50LlJJR0hULCBIb3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0gpO1xuICAgIEhvcml6b250YWxBbGlnbm1lbnQucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihIb3Jpem9udGFsQWxpZ25tZW50LmlzVmFsaWQpO1xufSkoSG9yaXpvbnRhbEFsaWdubWVudCA9IGV4cG9ydHMuSG9yaXpvbnRhbEFsaWdubWVudCB8fCAoZXhwb3J0cy5Ib3Jpem9udGFsQWxpZ25tZW50ID0ge30pKTtcbmV4cG9ydHMuaG9yaXpvbnRhbEFsaWdubWVudFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiaG9yaXpvbnRhbEFsaWdubWVudFwiLCBjc3NOYW1lOiBcImhvcml6b250YWwtYWxpZ25cIiwgZGVmYXVsdFZhbHVlOiBIb3Jpem9udGFsQWxpZ25tZW50LlNUUkVUQ0gsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBIb3Jpem9udGFsQWxpZ25tZW50LnBhcnNlIH0pO1xuZXhwb3J0cy5ob3Jpem9udGFsQWxpZ25tZW50UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBWZXJ0aWNhbEFsaWdubWVudDtcbihmdW5jdGlvbiAoVmVydGljYWxBbGlnbm1lbnQpIHtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5UT1AgPSBcInRvcFwiO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50Lk1JRERMRSA9IFwibWlkZGxlXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuQk9UVE9NID0gXCJib3R0b21cIjtcbiAgICBWZXJ0aWNhbEFsaWdubWVudC5TVFJFVENIID0gXCJzdHJldGNoXCI7XG4gICAgVmVydGljYWxBbGlnbm1lbnQuaXNWYWxpZCA9IHByb3BlcnRpZXNfMS5tYWtlVmFsaWRhdG9yKFZlcnRpY2FsQWxpZ25tZW50LlRPUCwgVmVydGljYWxBbGlnbm1lbnQuTUlERExFLCBWZXJ0aWNhbEFsaWdubWVudC5CT1RUT00sIFZlcnRpY2FsQWxpZ25tZW50LlNUUkVUQ0gpO1xuICAgIFZlcnRpY2FsQWxpZ25tZW50LnBhcnNlID0gZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiB2YWx1ZS50b0xvd2VyQ2FzZSgpID09PSBcImNlbnRlclwiID8gVmVydGljYWxBbGlnbm1lbnQuTUlERExFIDogcGFyc2VTdHJpY3QodmFsdWUpOyB9O1xuICAgIHZhciBwYXJzZVN0cmljdCA9IHByb3BlcnRpZXNfMS5tYWtlUGFyc2VyKFZlcnRpY2FsQWxpZ25tZW50LmlzVmFsaWQpO1xufSkoVmVydGljYWxBbGlnbm1lbnQgPSBleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50IHx8IChleHBvcnRzLlZlcnRpY2FsQWxpZ25tZW50ID0ge30pKTtcbmV4cG9ydHMudmVydGljYWxBbGlnbm1lbnRQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInZlcnRpY2FsQWxpZ25tZW50XCIsIGNzc05hbWU6IFwidmVydGljYWwtYWxpZ25cIiwgZGVmYXVsdFZhbHVlOiBWZXJ0aWNhbEFsaWdubWVudC5TVFJFVENILCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNvbnZlcnRlcjogVmVydGljYWxBbGlnbm1lbnQucGFyc2UgfSk7XG5leHBvcnRzLnZlcnRpY2FsQWxpZ25tZW50UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIHBhcnNlVGhpY2tuZXNzKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1sgLF0rLyk7XG4gICAgICAgIHZhciB0b3BfMTtcbiAgICAgICAgdmFyIHJpZ2h0ID0gdm9pZCAwO1xuICAgICAgICB2YXIgYm90dG9tID0gdm9pZCAwO1xuICAgICAgICB2YXIgbGVmdCA9IHZvaWQgMDtcbiAgICAgICAgaWYgKGFyci5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMF07XG4gICAgICAgICAgICBib3R0b20gPSBhcnJbMF07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMV07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzFdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMV07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzFdO1xuICAgICAgICAgICAgYm90dG9tID0gYXJyWzJdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgICAgIHRvcF8xID0gYXJyWzBdO1xuICAgICAgICAgICAgcmlnaHQgPSBhcnJbMV07XG4gICAgICAgICAgICBib3R0b20gPSBhcnJbMl07XG4gICAgICAgICAgICBsZWZ0ID0gYXJyWzNdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXhwZWN0ZWQgMSwgMiwgMyBvciA0IHBhcmFtZXRlcnMuIEFjdHVhbDogXCIgKyB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRvcDogdG9wXzEsXG4gICAgICAgICAgICByaWdodDogcmlnaHQsXG4gICAgICAgICAgICBib3R0b206IGJvdHRvbSxcbiAgICAgICAgICAgIGxlZnQ6IGxlZnRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9NYXJnaW5zKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiB2YWx1ZSAhPT0gXCJhdXRvXCIpIHtcbiAgICAgICAgdmFyIHRoaWNrbmVzcyA9IHBhcnNlVGhpY2tuZXNzKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpblRvcFByb3BlcnR5LCBQZXJjZW50TGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy50b3ApXSxcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpblJpZ2h0UHJvcGVydHksIFBlcmNlbnRMZW5ndGgucGFyc2UodGhpY2tuZXNzLnJpZ2h0KV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eSwgUGVyY2VudExlbmd0aC5wYXJzZSh0aGlja25lc3MuYm90dG9tKV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5MZWZ0UHJvcGVydHksIFBlcmNlbnRMZW5ndGgucGFyc2UodGhpY2tuZXNzLmxlZnQpXVxuICAgICAgICBdO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtleHBvcnRzLm1hcmdpblRvcFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5SaWdodFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5tYXJnaW5Cb3R0b21Qcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgW2V4cG9ydHMubWFyZ2luTGVmdFByb3BlcnR5LCB2YWx1ZV1cbiAgICAgICAgXTtcbiAgICB9XG59XG5mdW5jdGlvbiBjb252ZXJ0VG9QYWRkaW5ncyh2YWx1ZSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUgIT09IFwiYXV0b1wiKSB7XG4gICAgICAgIHZhciB0aGlja25lc3MgPSBwYXJzZVRoaWNrbmVzcyh2YWx1ZSk7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHksIExlbmd0aC5wYXJzZSh0aGlja25lc3MudG9wKV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nUmlnaHRQcm9wZXJ0eSwgTGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5yaWdodCldLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ0JvdHRvbVByb3BlcnR5LCBMZW5ndGgucGFyc2UodGhpY2tuZXNzLmJvdHRvbSldLFxuICAgICAgICAgICAgW2V4cG9ydHMucGFkZGluZ0xlZnRQcm9wZXJ0eSwgTGVuZ3RoLnBhcnNlKHRoaWNrbmVzcy5sZWZ0KV1cbiAgICAgICAgXTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nVG9wUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdSaWdodFByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5wYWRkaW5nQm90dG9tUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLnBhZGRpbmdMZWZ0UHJvcGVydHksIHZhbHVlXVxuICAgICAgICBdO1xuICAgIH1cbn1cbmV4cG9ydHMucm90YXRlUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHsgbmFtZTogXCJyb3RhdGVcIiwgY3NzTmFtZTogXCJyb3RhdGVcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMucm90YXRlUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuc2NhbGVYUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHsgbmFtZTogXCJzY2FsZVhcIiwgY3NzTmFtZTogXCJzY2FsZVhcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMuc2NhbGVYUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuc2NhbGVZUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHsgbmFtZTogXCJzY2FsZVlcIiwgY3NzTmFtZTogXCJzY2FsZVlcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMuc2NhbGVZUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIHBhcnNlRElQcyh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZS5pbmRleE9mKFwicHhcIikgIT09IC0xKSB7XG4gICAgICAgIHJldHVybiB1dGlsc18xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHBhcnNlRmxvYXQodmFsdWUucmVwbGFjZShcInB4XCIsIFwiXCIpLnRyaW0oKSkpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodmFsdWUucmVwbGFjZShcImRpcFwiLCBcIlwiKS50cmltKCkpO1xuICAgIH1cbn1cbmV4cG9ydHMudHJhbnNsYXRlWFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwidHJhbnNsYXRlWFwiLCBjc3NOYW1lOiBcInRyYW5zbGF0ZVhcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VESVBzIH0pO1xuZXhwb3J0cy50cmFuc2xhdGVYUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMudHJhbnNsYXRlWVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwidHJhbnNsYXRlWVwiLCBjc3NOYW1lOiBcInRyYW5zbGF0ZVlcIiwgZGVmYXVsdFZhbHVlOiAwLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VESVBzIH0pO1xuZXhwb3J0cy50cmFuc2xhdGVZUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciB0cmFuc2Zvcm1Qcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidHJhbnNmb3JtXCIsIGNzc05hbWU6IFwidHJhbnNmb3JtXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzY2FsZVggPSB0aGlzLnNjYWxlWDtcbiAgICAgICAgdmFyIHNjYWxlWSA9IHRoaXMuc2NhbGVZO1xuICAgICAgICB2YXIgdHJhbnNsYXRlWCA9IHRoaXMudHJhbnNsYXRlWDtcbiAgICAgICAgdmFyIHRyYW5zbGF0ZVkgPSB0aGlzLnRyYW5zbGF0ZVk7XG4gICAgICAgIHZhciByb3RhdGUgPSB0aGlzLnJvdGF0ZTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFwiXCI7XG4gICAgICAgIGlmICh0cmFuc2xhdGVYICE9PSAwIHx8IHRyYW5zbGF0ZVkgIT09IDApIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBcInRyYW5zbGF0ZShcIiArIHRyYW5zbGF0ZVggKyBcIiwgXCIgKyB0cmFuc2xhdGVZICsgXCIpIFwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzY2FsZVggIT09IDEgfHwgc2NhbGVZICE9PSAxKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJzY2FsZShcIiArIHNjYWxlWCArIFwiLCBcIiArIHNjYWxlWSArIFwiKSBcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAocm90YXRlICE9PSAwKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gXCJyb3RhdGUgKFwiICsgcm90YXRlICsgXCIpXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdC50cmltKCk7XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGNvbnZlcnRUb1RyYW5zZm9ybVxufSk7XG50cmFuc2Zvcm1Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIElERU5USVRZX1RSQU5TRk9STUFUSU9OID0ge1xuICAgIHRyYW5zbGF0ZTogeyB4OiAwLCB5OiAwIH0sXG4gICAgcm90YXRlOiAwLFxuICAgIHNjYWxlOiB7IHg6IDEsIHk6IDEgfSxcbn07XG52YXIgVFJBTlNGT1JNX1NQTElUVEVSID0gbmV3IFJlZ0V4cCgvXFxzKiguKz8pXFwoKC4qPylcXCkvZyk7XG52YXIgVFJBTlNGT1JNQVRJT05TID0gT2JqZWN0LmZyZWV6ZShbXG4gICAgXCJyb3RhdGVcIixcbiAgICBcInRyYW5zbGF0ZVwiLFxuICAgIFwidHJhbnNsYXRlM2RcIixcbiAgICBcInRyYW5zbGF0ZVhcIixcbiAgICBcInRyYW5zbGF0ZVlcIixcbiAgICBcInNjYWxlXCIsXG4gICAgXCJzY2FsZTNkXCIsXG4gICAgXCJzY2FsZVhcIixcbiAgICBcInNjYWxlWVwiLFxuXSk7XG52YXIgU1RZTEVfVFJBTlNGT1JNQVRJT05fTUFQID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgXCJzY2FsZVwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInNjYWxlXCIsIHZhbHVlOiB2YWx1ZSB9KTsgfSxcbiAgICBcInNjYWxlM2RcIjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJzY2FsZVhcIjogZnVuY3Rpb24gKF9hKSB7XG4gICAgICAgIHZhciB4ID0gX2EueDtcbiAgICAgICAgcmV0dXJuICh7IHByb3BlcnR5OiBcInNjYWxlXCIsIHZhbHVlOiB7IHg6IHgsIHk6IElERU5USVRZX1RSQU5TRk9STUFUSU9OLnNjYWxlLnkgfSB9KTtcbiAgICB9LFxuICAgIFwic2NhbGVZXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeSA9IF9hLnk7XG4gICAgICAgIHJldHVybiAoeyBwcm9wZXJ0eTogXCJzY2FsZVwiLCB2YWx1ZTogeyB5OiB5LCB4OiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTi5zY2FsZS54IH0gfSk7XG4gICAgfSxcbiAgICBcInRyYW5zbGF0ZVwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInRyYW5zbGF0ZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJ0cmFuc2xhdGUzZFwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInRyYW5zbGF0ZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG4gICAgXCJ0cmFuc2xhdGVYXCI6IGZ1bmN0aW9uIChfYSkge1xuICAgICAgICB2YXIgeCA9IF9hLng7XG4gICAgICAgIHJldHVybiAoeyBwcm9wZXJ0eTogXCJ0cmFuc2xhdGVcIiwgdmFsdWU6IHsgeDogeCwgeTogSURFTlRJVFlfVFJBTlNGT1JNQVRJT04udHJhbnNsYXRlLnkgfSB9KTtcbiAgICB9LFxuICAgIFwidHJhbnNsYXRlWVwiOiBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgdmFyIHkgPSBfYS55O1xuICAgICAgICByZXR1cm4gKHsgcHJvcGVydHk6IFwidHJhbnNsYXRlXCIsIHZhbHVlOiB7IHk6IHksIHg6IElERU5USVRZX1RSQU5TRk9STUFUSU9OLnRyYW5zbGF0ZS54IH0gfSk7XG4gICAgfSxcbiAgICBcInJvdGF0ZVwiOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuICh7IHByb3BlcnR5OiBcInJvdGF0ZVwiLCB2YWx1ZTogdmFsdWUgfSk7IH0sXG59KTtcbmZ1bmN0aW9uIGNvbnZlcnRUb1RyYW5zZm9ybSh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSA9PT0gcHJvcGVydGllc18xLnVuc2V0VmFsdWUpIHtcbiAgICAgICAgdmFsdWUgPSBcIm5vbmVcIjtcbiAgICB9XG4gICAgdmFyIF9hID0gdHJhbnNmb3JtQ29udmVydGVyKHZhbHVlKSwgdHJhbnNsYXRlID0gX2EudHJhbnNsYXRlLCByb3RhdGUgPSBfYS5yb3RhdGUsIHNjYWxlID0gX2Euc2NhbGU7XG4gICAgcmV0dXJuIFtcbiAgICAgICAgW2V4cG9ydHMudHJhbnNsYXRlWFByb3BlcnR5LCB0cmFuc2xhdGUueF0sXG4gICAgICAgIFtleHBvcnRzLnRyYW5zbGF0ZVlQcm9wZXJ0eSwgdHJhbnNsYXRlLnldLFxuICAgICAgICBbZXhwb3J0cy5zY2FsZVhQcm9wZXJ0eSwgc2NhbGUueF0sXG4gICAgICAgIFtleHBvcnRzLnNjYWxlWVByb3BlcnR5LCBzY2FsZS55XSxcbiAgICAgICAgW2V4cG9ydHMucm90YXRlUHJvcGVydHksIHJvdGF0ZV0sXG4gICAgXTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNvbnZlcnRlcih0ZXh0KSB7XG4gICAgdmFyIHRyYW5zZm9ybWF0aW9ucyA9IHBhcnNlVHJhbnNmb3JtU3RyaW5nKHRleHQpO1xuICAgIGlmICh0ZXh0ID09PSBcIm5vbmVcIiB8fCB0ZXh0ID09PSBcIlwiIHx8ICF0cmFuc2Zvcm1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBJREVOVElUWV9UUkFOU0ZPUk1BVElPTjtcbiAgICB9XG4gICAgdmFyIHVzZWRUcmFuc2Zvcm1zID0gdHJhbnNmb3JtYXRpb25zLm1hcChmdW5jdGlvbiAodCkgeyByZXR1cm4gdC5wcm9wZXJ0eTsgfSk7XG4gICAgaWYgKCF1dGlsc18xLmhhc0R1cGxpY2F0ZXModXNlZFRyYW5zZm9ybXMpKSB7XG4gICAgICAgIHZhciBmdWxsVHJhbnNmb3JtYXRpb25zXzEgPSBfX2Fzc2lnbih7fSwgSURFTlRJVFlfVFJBTlNGT1JNQVRJT04pO1xuICAgICAgICB0cmFuc2Zvcm1hdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAodHJhbnNmb3JtKSB7XG4gICAgICAgICAgICBmdWxsVHJhbnNmb3JtYXRpb25zXzFbdHJhbnNmb3JtLnByb3BlcnR5XSA9IHRyYW5zZm9ybS52YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBmdWxsVHJhbnNmb3JtYXRpb25zXzE7XG4gICAgfVxuICAgIHZhciBhZmZpbmVNYXRyaXggPSB0cmFuc2Zvcm1hdGlvbnNcbiAgICAgICAgLm1hcChtYXRyaXhfMS5nZXRUcmFuc2Zvcm1NYXRyaXgpXG4gICAgICAgIC5yZWR1Y2UobWF0cml4XzEubXVsdGlwbHlBZmZpbmUyZCk7XG4gICAgdmFyIGNzc01hdHJpeCA9IG1hdHJpeF8xLm1hdHJpeEFycmF5VG9Dc3NNYXRyaXgoYWZmaW5lTWF0cml4KTtcbiAgICByZXR1cm4gbWF0cml4XzEuZGVjb21wb3NlMkRUcmFuc2Zvcm1NYXRyaXgoY3NzTWF0cml4KTtcbn1cbmV4cG9ydHMudHJhbnNmb3JtQ29udmVydGVyID0gdHJhbnNmb3JtQ29udmVydGVyO1xuZnVuY3Rpb24gcGFyc2VUcmFuc2Zvcm1TdHJpbmcodGV4dCkge1xuICAgIHZhciBtYXRjaGVzID0gW107XG4gICAgdmFyIG1hdGNoO1xuICAgIHdoaWxlICgobWF0Y2ggPSBUUkFOU0ZPUk1fU1BMSVRURVIuZXhlYyh0ZXh0KSkgIT09IG51bGwpIHtcbiAgICAgICAgdmFyIHByb3BlcnR5ID0gbWF0Y2hbMV07XG4gICAgICAgIHZhciB2YWx1ZSA9IGNvbnZlcnRUcmFuc2Zvcm1WYWx1ZShwcm9wZXJ0eSwgbWF0Y2hbMl0pO1xuICAgICAgICBpZiAoVFJBTlNGT1JNQVRJT05TLmluZGV4T2YocHJvcGVydHkpICE9PSAtMSkge1xuICAgICAgICAgICAgbWF0Y2hlcy5wdXNoKG5vcm1hbGl6ZVRyYW5zZm9ybWF0aW9uKHsgcHJvcGVydHk6IHByb3BlcnR5LCB2YWx1ZTogdmFsdWUgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXRjaGVzO1xufVxuZnVuY3Rpb24gbm9ybWFsaXplVHJhbnNmb3JtYXRpb24oX2EpIHtcbiAgICB2YXIgcHJvcGVydHkgPSBfYS5wcm9wZXJ0eSwgdmFsdWUgPSBfYS52YWx1ZTtcbiAgICByZXR1cm4gU1RZTEVfVFJBTlNGT1JNQVRJT05fTUFQW3Byb3BlcnR5XSh2YWx1ZSk7XG59XG5mdW5jdGlvbiBjb252ZXJ0VHJhbnNmb3JtVmFsdWUocHJvcGVydHksIHN0cmluZ1ZhbHVlKSB7XG4gICAgdmFyIF9hID0gc3RyaW5nVmFsdWUuc3BsaXQoXCIsXCIpLm1hcChwYXJzZUZsb2F0KSwgeCA9IF9hWzBdLCBfYiA9IF9hWzFdLCB5ID0gX2IgPT09IHZvaWQgMCA/IHggOiBfYjtcbiAgICBpZiAocHJvcGVydHkgPT09IFwicm90YXRlXCIpIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZ1ZhbHVlLnNsaWNlKC0zKSA9PT0gXCJyYWRcIiA/IG51bWJlcl91dGlsc18xLnJhZGlhbnNUb0RlZ3JlZXMoeCkgOiB4O1xuICAgIH1cbiAgICByZXR1cm4geyB4OiB4LCB5OiB5IH07XG59XG52YXIgYmFja2dyb3VuZFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZFwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iYWNrZ3JvdW5kQ29sb3IgKyBcIiBcIiArIHRoaXMuYmFja2dyb3VuZEltYWdlICsgXCIgXCIgKyB0aGlzLmJhY2tncm91bmRSZXBlYXQgKyBcIiBcIiArIHRoaXMuYmFja2dyb3VuZFBvc2l0aW9uO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBjb252ZXJ0VG9CYWNrZ3JvdW5kc1xufSk7XG5iYWNrZ3JvdW5kUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYmFja2dyb3VuZEludGVybmFsUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJhY2tncm91bmRJbnRlcm5hbFwiLFxuICAgIGNzc05hbWU6IFwiX2JhY2tncm91bmRJbnRlcm5hbFwiLFxuICAgIGRlZmF1bHRWYWx1ZTogYmFja2dyb3VuZF8xLkJhY2tncm91bmQuZGVmYXVsdFxufSk7XG5leHBvcnRzLmJhY2tncm91bmRJbnRlcm5hbFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kSW1hZ2VcIiwgY3NzTmFtZTogXCJiYWNrZ3JvdW5kLWltYWdlXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoSW1hZ2UobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LFxuICAgIGVxdWFsaXR5Q29tcGFyZXI6IGZ1bmN0aW9uICh2YWx1ZTEsIHZhbHVlMikge1xuICAgICAgICBpZiAodmFsdWUxIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQgJiYgdmFsdWUyIGluc3RhbmNlb2YgbGluZWFyX2dyYWRpZW50XzEuTGluZWFyR3JhZGllbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5lcXVhbHModmFsdWUxLCB2YWx1ZTIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlMSA9PT0gdmFsdWUyO1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHZhciBwYXJzZWQgPSBwYXJzZXIucGFyc2VCYWNrZ3JvdW5kKHZhbHVlKTtcbiAgICAgICAgICAgIGlmIChwYXJzZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHBhcnNlZC52YWx1ZTtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICh0eXBlb2YgYmFja2dyb3VuZC5pbWFnZSA9PT0gXCJvYmplY3RcIikgPyBsaW5lYXJfZ3JhZGllbnRfMS5MaW5lYXJHcmFkaWVudC5wYXJzZShiYWNrZ3JvdW5kLmltYWdlKSA6IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZEltYWdlUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc0FuaW1hdGlvblByb3BlcnR5KHtcbiAgICBuYW1lOiBcImJhY2tncm91bmRDb2xvclwiLCBjc3NOYW1lOiBcImJhY2tncm91bmQtY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhDb2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIEJhY2tncm91bmRSZXBlYXQ7XG4oZnVuY3Rpb24gKEJhY2tncm91bmRSZXBlYXQpIHtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LlJFUEVBVCA9IFwicmVwZWF0XCI7XG4gICAgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWCA9IFwicmVwZWF0LXhcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LlJFUEVBVF9ZID0gXCJyZXBlYXQteVwiO1xuICAgIEJhY2tncm91bmRSZXBlYXQuTk9fUkVQRUFUID0gXCJuby1yZXBlYXRcIjtcbiAgICBCYWNrZ3JvdW5kUmVwZWF0LmlzVmFsaWQgPSBwcm9wZXJ0aWVzXzEubWFrZVZhbGlkYXRvcihCYWNrZ3JvdW5kUmVwZWF0LlJFUEVBVCwgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWCwgQmFja2dyb3VuZFJlcGVhdC5SRVBFQVRfWSwgQmFja2dyb3VuZFJlcGVhdC5OT19SRVBFQVQpO1xuICAgIEJhY2tncm91bmRSZXBlYXQucGFyc2UgPSBwcm9wZXJ0aWVzXzEubWFrZVBhcnNlcihCYWNrZ3JvdW5kUmVwZWF0LmlzVmFsaWQpO1xufSkoQmFja2dyb3VuZFJlcGVhdCA9IGV4cG9ydHMuQmFja2dyb3VuZFJlcGVhdCB8fCAoZXhwb3J0cy5CYWNrZ3JvdW5kUmVwZWF0ID0ge30pKTtcbmV4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kUmVwZWF0XCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1yZXBlYXRcIiwgdmFsdWVDb252ZXJ0ZXI6IEJhY2tncm91bmRSZXBlYXQucGFyc2UsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhSZXBlYXQobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRTaXplUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJhY2tncm91bmRTaXplXCIsIGNzc05hbWU6IFwiYmFja2dyb3VuZC1zaXplXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoU2l6ZShuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH1cbn0pO1xuZXhwb3J0cy5iYWNrZ3JvdW5kU2l6ZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJiYWNrZ3JvdW5kUG9zaXRpb25cIiwgY3NzTmFtZTogXCJiYWNrZ3JvdW5kLXBvc2l0aW9uXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoUG9zaXRpb24obmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9XG59KTtcbmV4cG9ydHMuYmFja2dyb3VuZFBvc2l0aW9uUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIGNvbnZlcnRUb0JhY2tncm91bmRzKHZhbHVlKSB7XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICB2YXIgYmFja2dyb3VuZHMgPSBwYXJzZXIucGFyc2VCYWNrZ3JvdW5kKHZhbHVlKS52YWx1ZTtcbiAgICAgICAgdmFyIGJhY2tncm91bmRDb2xvciA9IGJhY2tncm91bmRzLmNvbG9yID8gbmV3IGNvbG9yXzEuQ29sb3IoYmFja2dyb3VuZHMuY29sb3IpIDogcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kSW1hZ2UgPSB2b2lkIDA7XG4gICAgICAgIGlmICh0eXBlb2YgYmFja2dyb3VuZHMuaW1hZ2UgPT09IFwib2JqZWN0XCIgJiYgYmFja2dyb3VuZHMuaW1hZ2UpIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZSA9IGxpbmVhcl9ncmFkaWVudF8xLkxpbmVhckdyYWRpZW50LnBhcnNlKGJhY2tncm91bmRzLmltYWdlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGJhY2tncm91bmRJbWFnZSA9IGJhY2tncm91bmRzLmltYWdlIHx8IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kUmVwZWF0ID0gYmFja2dyb3VuZHMucmVwZWF0IHx8IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICB2YXIgYmFja2dyb3VuZFBvc2l0aW9uID0gYmFja2dyb3VuZHMucG9zaXRpb24gPyBiYWNrZ3JvdW5kcy5wb3NpdGlvbi50ZXh0IDogcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kQ29sb3JQcm9wZXJ0eSwgYmFja2dyb3VuZENvbG9yXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5LCBiYWNrZ3JvdW5kSW1hZ2VdLFxuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZFJlcGVhdFByb3BlcnR5LCBiYWNrZ3JvdW5kUmVwZWF0XSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5LCBiYWNrZ3JvdW5kUG9zaXRpb25dXG4gICAgICAgIF07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgW2V4cG9ydHMuYmFja2dyb3VuZENvbG9yUHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRJbWFnZVByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV0sXG4gICAgICAgICAgICBbZXhwb3J0cy5iYWNrZ3JvdW5kUmVwZWF0UHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgIFtleHBvcnRzLmJhY2tncm91bmRQb3NpdGlvblByb3BlcnR5LCBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZV1cbiAgICAgICAgXTtcbiAgICB9XG59XG5mdW5jdGlvbiBwYXJzZUJvcmRlckNvbG9yKHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHsgdG9wOiB1bmRlZmluZWQsIHJpZ2h0OiB1bmRlZmluZWQsIGJvdHRvbTogdW5kZWZpbmVkLCBsZWZ0OiB1bmRlZmluZWQgfTtcbiAgICBpZiAodmFsdWUuaW5kZXhPZihcInJnYlwiKSA9PT0gMCkge1xuICAgICAgICByZXN1bHQudG9wID0gcmVzdWx0LnJpZ2h0ID0gcmVzdWx0LmJvdHRvbSA9IHJlc3VsdC5sZWZ0ID0gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICB2YXIgYXJyID0gdmFsdWUuc3BsaXQoL1sgLF0rLyk7XG4gICAgaWYgKGFyci5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICByZXN1bHQudG9wID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LnJpZ2h0ID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LmJvdHRvbSA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5sZWZ0ID0gYXJyMDtcbiAgICB9XG4gICAgZWxzZSBpZiAoYXJyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICB2YXIgYXJyMCA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclswXSk7XG4gICAgICAgIHZhciBhcnIxID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzFdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjE7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIwO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICB2YXIgYXJyMSA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsxXSk7XG4gICAgICAgIHZhciBhcnIyID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzJdKTtcbiAgICAgICAgcmVzdWx0LnRvcCA9IGFycjA7XG4gICAgICAgIHJlc3VsdC5yaWdodCA9IGFycjE7XG4gICAgICAgIHJlc3VsdC5ib3R0b20gPSBhcnIyO1xuICAgICAgICByZXN1bHQubGVmdCA9IGFycjE7XG4gICAgfVxuICAgIGVsc2UgaWYgKGFyci5sZW5ndGggPT09IDQpIHtcbiAgICAgICAgdmFyIGFycjAgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbMF0pO1xuICAgICAgICB2YXIgYXJyMSA9IG5ldyBjb2xvcl8xLkNvbG9yKGFyclsxXSk7XG4gICAgICAgIHZhciBhcnIyID0gbmV3IGNvbG9yXzEuQ29sb3IoYXJyWzJdKTtcbiAgICAgICAgdmFyIGFycjMgPSBuZXcgY29sb3JfMS5Db2xvcihhcnJbM10pO1xuICAgICAgICByZXN1bHQudG9wID0gYXJyMDtcbiAgICAgICAgcmVzdWx0LnJpZ2h0ID0gYXJyMTtcbiAgICAgICAgcmVzdWx0LmJvdHRvbSA9IGFycjI7XG4gICAgICAgIHJlc3VsdC5sZWZ0ID0gYXJyMztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIDEsIDIsIDMgb3IgNCBwYXJhbWV0ZXJzLiBBY3R1YWw6IFwiICsgdmFsdWUpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxudmFyIGJvcmRlckNvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLlNob3J0aGFuZFByb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckNvbG9yXCIsIGNzc05hbWU6IFwiYm9yZGVyLWNvbG9yXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlclJpZ2h0Q29sb3IpICYmXG4gICAgICAgICAgICBjb2xvcl8xLkNvbG9yLmVxdWFscyh0aGlzLmJvcmRlclRvcENvbG9yLCB0aGlzLmJvcmRlckJvdHRvbUNvbG9yKSAmJlxuICAgICAgICAgICAgY29sb3JfMS5Db2xvci5lcXVhbHModGhpcy5ib3JkZXJUb3BDb2xvciwgdGhpcy5ib3JkZXJMZWZ0Q29sb3IpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5ib3JkZXJUb3BDb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcENvbG9yICsgXCIgXCIgKyB0aGlzLmJvcmRlclJpZ2h0Q29sb3IgKyBcIiBcIiArIHRoaXMuYm9yZGVyQm90dG9tQ29sb3IgKyBcIiBcIiArIHRoaXMuYm9yZGVyTGVmdENvbG9yO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBjb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICB2YXIgZm91ckNvbG9ycyA9IHBhcnNlQm9yZGVyQ29sb3IodmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLnRvcF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyUmlnaHRDb2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLnJpZ2h0XSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5LCBmb3VyQ29sb3JzLmJvdHRvbV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdENvbG9yUHJvcGVydHksIGZvdXJDb2xvcnMubGVmdF1cbiAgICAgICAgICAgIF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclRvcENvbG9yUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJSaWdodENvbG9yUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJCb3R0b21Db2xvclByb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdENvbG9yUHJvcGVydHksIHZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgIH1cbn0pO1xuYm9yZGVyQ29sb3JQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJUb3BDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci10b3AtY29sb3JcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJUb3BDb2xvcihuZXdWYWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBuZXcgY29sb3JfMS5Db2xvcih2YWx1ZSk7IH1cbn0pO1xuZXhwb3J0cy5ib3JkZXJUb3BDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlclJpZ2h0Q29sb3JQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyUmlnaHRDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1yaWdodC1jb2xvclwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclJpZ2h0Q29sb3IobmV3VmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCBlcXVhbGl0eUNvbXBhcmVyOiBjb2xvcl8xLkNvbG9yLmVxdWFscywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gbmV3IGNvbG9yXzEuQ29sb3IodmFsdWUpOyB9XG59KTtcbmV4cG9ydHMuYm9yZGVyUmlnaHRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbUNvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckJvdHRvbUNvbG9yXCIsIGNzc05hbWU6IFwiYm9yZGVyLWJvdHRvbS1jb2xvclwiLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbUNvbG9yKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTsgfVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbUNvbG9yUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyTGVmdENvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckxlZnRDb2xvclwiLCBjc3NOYW1lOiBcImJvcmRlci1sZWZ0LWNvbG9yXCIsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyTGVmdENvbG9yKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgZXF1YWxpdHlDb21wYXJlcjogY29sb3JfMS5Db2xvci5lcXVhbHMsIHZhbHVlQ29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHZhbHVlKTsgfVxufSk7XG5leHBvcnRzLmJvcmRlckxlZnRDb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgYm9yZGVyV2lkdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuU2hvcnRoYW5kUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyV2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItd2lkdGhcIixcbiAgICBnZXR0ZXI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BXaWR0aCwgdGhpcy5ib3JkZXJSaWdodFdpZHRoKSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcFdpZHRoLCB0aGlzLmJvcmRlckJvdHRvbVdpZHRoKSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcFdpZHRoLCB0aGlzLmJvcmRlckxlZnRXaWR0aCkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJUb3BXaWR0aCkgKyBcIiBcIiArIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJSaWdodFdpZHRoKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckJvdHRvbVdpZHRoKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckxlZnRXaWR0aCk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIGNvbnZlcnRlcjogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIgJiYgdmFsdWUgIT09IFwiYXV0b1wiKSB7XG4gICAgICAgICAgICB2YXIgYm9yZGVyV2lkdGhzID0gcGFyc2VUaGlja25lc3ModmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BXaWR0aFByb3BlcnR5LCBib3JkZXJXaWR0aHMudG9wXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHksIGJvcmRlcldpZHRocy5yaWdodF0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tV2lkdGhQcm9wZXJ0eSwgYm9yZGVyV2lkdGhzLmJvdHRvbV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHksIGJvcmRlcldpZHRocy5sZWZ0XVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eSwgdmFsdWVdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5ib3JkZXJXaWR0aFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlclRvcFdpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclRvcFdpZHRoXCIsIGNzc05hbWU6IFwiYm9yZGVyLXRvcC13aWR0aFwiLCBkZWZhdWx0VmFsdWU6IGV4cG9ydHMuemVyb0xlbmd0aCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZXF1YWxpdHlDb21wYXJlcjogTGVuZ3RoLmVxdWFscyxcbiAgICB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItdG9wLXdpZHRoIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyVG9wV2lkdGgodmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyVG9wV2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJSaWdodFdpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclJpZ2h0V2lkdGhcIiwgY3NzTmFtZTogXCJib3JkZXItcmlnaHQtd2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXJpZ2h0LXdpZHRoIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZUJvcmRlclJpZ2h0V2lkdGggPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUobmV3VmFsdWUgKyBcIiBub3Qgc2V0IHRvIHZpZXcncyBwcm9wZXJ0eSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuU3R5bGUsIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJhY2tncm91bmQgPSB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsLndpdGhCb3JkZXJSaWdodFdpZHRoKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclJpZ2h0V2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21XaWR0aFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJCb3R0b21XaWR0aFwiLCBjc3NOYW1lOiBcImJvcmRlci1ib3R0b20td2lkdGhcIiwgZGVmYXVsdFZhbHVlOiBleHBvcnRzLnplcm9MZW5ndGgsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGVxdWFsaXR5Q29tcGFyZXI6IExlbmd0aC5lcXVhbHMsXG4gICAgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLWJvdHRvbS13aWR0aCBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5lZmZlY3RpdmVCb3JkZXJCb3R0b21XaWR0aCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbVdpZHRoKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlckJvdHRvbVdpZHRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyTGVmdFdpZHRoUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckxlZnRXaWR0aFwiLCBjc3NOYW1lOiBcImJvcmRlci1sZWZ0LXdpZHRoXCIsIGRlZmF1bHRWYWx1ZTogZXhwb3J0cy56ZXJvTGVuZ3RoLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCBlcXVhbGl0eUNvbXBhcmVyOiBMZW5ndGguZXF1YWxzLFxuICAgIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1sZWZ0LXdpZHRoIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB2aWV3ID0gdGFyZ2V0LnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZShuZXdWYWx1ZSArIFwiIG5vdCBzZXQgdG8gdmlldydzIHByb3BlcnR5IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckxlZnRXaWR0aCh2YWx1ZSk7XG4gICAgICAgIHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwgPSBiYWNrZ3JvdW5kO1xuICAgIH0sIHZhbHVlQ29udmVydGVyOiBMZW5ndGgucGFyc2Vcbn0pO1xuZXhwb3J0cy5ib3JkZXJMZWZ0V2lkdGhQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xudmFyIGJvcmRlclJhZGl1c1Byb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJib3JkZXJSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItcmFkaXVzXCIsXG4gICAgZ2V0dGVyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChMZW5ndGguZXF1YWxzKHRoaXMuYm9yZGVyVG9wTGVmdFJhZGl1cywgdGhpcy5ib3JkZXJUb3BSaWdodFJhZGl1cykgJiZcbiAgICAgICAgICAgIExlbmd0aC5lcXVhbHModGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzLCB0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKSAmJlxuICAgICAgICAgICAgTGVuZ3RoLmVxdWFscyh0aGlzLmJvcmRlclRvcExlZnRSYWRpdXMsIHRoaXMuYm9yZGVyQm90dG9tTGVmdFJhZGl1cykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmJvcmRlclRvcExlZnRSYWRpdXM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIExlbmd0aC5jb252ZXJ0VG9TdHJpbmcodGhpcy5ib3JkZXJUb3BMZWZ0UmFkaXVzKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlclRvcFJpZ2h0UmFkaXVzKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzKSArIFwiIFwiICsgTGVuZ3RoLmNvbnZlcnRUb1N0cmluZyh0aGlzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXMpO1xuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgdmFyIGJvcmRlclJhZGl1cyA9IHBhcnNlVGhpY2tuZXNzKHZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5LCBib3JkZXJSYWRpdXMudG9wXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5LCBib3JkZXJSYWRpdXMucmlnaHRdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzUHJvcGVydHksIGJvcmRlclJhZGl1cy5ib3R0b21dLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXNQcm9wZXJ0eSwgYm9yZGVyUmFkaXVzLmxlZnRdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BMZWZ0UmFkaXVzUHJvcGVydHksIHZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5ib3JkZXJUb3BSaWdodFJhZGl1c1Byb3BlcnR5LCB2YWx1ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNQcm9wZXJ0eSwgdmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmJvcmRlckJvdHRvbUxlZnRSYWRpdXNQcm9wZXJ0eSwgdmFsdWVdXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5ib3JkZXJSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJUb3BMZWZ0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclRvcExlZnRSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItdG9wLWxlZnQtcmFkaXVzXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLXRvcC1sZWZ0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclRvcExlZnRSYWRpdXModmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyVG9wTGVmdFJhZGl1c1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmJvcmRlclRvcFJpZ2h0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlclRvcFJpZ2h0UmFkaXVzXCIsIGNzc05hbWU6IFwiYm9yZGVyLXRvcC1yaWdodC1yYWRpdXNcIiwgZGVmYXVsdFZhbHVlOiAwLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmFsdWUgPSBMZW5ndGgudG9EZXZpY2VQaXhlbHMobmV3VmFsdWUsIDApO1xuICAgICAgICBpZiAoIWlzTm9uTmVnYXRpdmVGaW5pdGVOdW1iZXIodmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJib3JkZXItdG9wLXJpZ2h0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlclRvcFJpZ2h0UmFkaXVzKHZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfSwgdmFsdWVDb252ZXJ0ZXI6IExlbmd0aC5wYXJzZVxufSk7XG5leHBvcnRzLmJvcmRlclRvcFJpZ2h0UmFkaXVzUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItYm90dG9tLXJpZ2h0LXJhZGl1c1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IExlbmd0aC50b0RldmljZVBpeGVscyhuZXdWYWx1ZSwgMCk7XG4gICAgICAgIGlmICghaXNOb25OZWdhdGl2ZUZpbml0ZU51bWJlcih2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcImJvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzIHNob3VsZCBiZSBOb24tTmVnYXRpdmUgRmluaXRlIG51bWJlci4gVmFsdWU6IFwiICsgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kID0gdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbC53aXRoQm9yZGVyQm90dG9tUmlnaHRSYWRpdXModmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tUmlnaHRSYWRpdXNQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5ib3JkZXJCb3R0b21MZWZ0UmFkaXVzUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHtcbiAgICBuYW1lOiBcImJvcmRlckJvdHRvbUxlZnRSYWRpdXNcIiwgY3NzTmFtZTogXCJib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzXCIsIGRlZmF1bHRWYWx1ZTogMCwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIHZhbHVlID0gTGVuZ3RoLnRvRGV2aWNlUGl4ZWxzKG5ld1ZhbHVlLCAwKTtcbiAgICAgICAgaWYgKCFpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYm9yZGVyLWJvdHRvbS1sZWZ0LXJhZGl1cyBzaG91bGQgYmUgTm9uLU5lZ2F0aXZlIEZpbml0ZSBudW1iZXIuIFZhbHVlOiBcIiArIHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aEJvcmRlckJvdHRvbUxlZnRSYWRpdXModmFsdWUpO1xuICAgICAgICB0YXJnZXQuYmFja2dyb3VuZEludGVybmFsID0gYmFja2dyb3VuZDtcbiAgICB9LCB2YWx1ZUNvbnZlcnRlcjogTGVuZ3RoLnBhcnNlXG59KTtcbmV4cG9ydHMuYm9yZGVyQm90dG9tTGVmdFJhZGl1c1Byb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBpc05vbk5lZ2F0aXZlRmluaXRlTnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIGlzRmluaXRlKHZhbHVlKSAmJiAhaXNOYU4odmFsdWUpICYmIHZhbHVlID49IDA7XG59XG52YXIgc3VwcG9ydGVkUGF0aHMgPSBbXCJyZWN0XCIsIFwiY2lyY2xlXCIsIFwiZWxsaXBzZVwiLCBcInBvbHlnb25cIiwgXCJpbnNldFwiXTtcbmZ1bmN0aW9uIGlzQ2xpcFBhdGhWYWxpZCh2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHZhciBmdW5jdGlvbk5hbWUgPSB2YWx1ZS5zdWJzdHJpbmcoMCwgdmFsdWUuaW5kZXhPZihcIihcIikpLnRyaW0oKTtcbiAgICByZXR1cm4gc3VwcG9ydGVkUGF0aHMuaW5kZXhPZihmdW5jdGlvbk5hbWUpICE9PSAtMTtcbn1cbmV4cG9ydHMuY2xpcFBhdGhQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiY2xpcFBhdGhcIiwgY3NzTmFtZTogXCJjbGlwLXBhdGhcIiwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKCFpc0NsaXBQYXRoVmFsaWQobmV3VmFsdWUpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJjbGlwLXBhdGggaXMgbm90IHZhbGlkLlwiKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYmFja2dyb3VuZCA9IHRhcmdldC5iYWNrZ3JvdW5kSW50ZXJuYWwud2l0aENsaXBQYXRoKG5ld1ZhbHVlKTtcbiAgICAgICAgdGFyZ2V0LmJhY2tncm91bmRJbnRlcm5hbCA9IGJhY2tncm91bmQ7XG4gICAgfVxufSk7XG5leHBvcnRzLmNsaXBQYXRoUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmZ1bmN0aW9uIGlzRmxvYXRWYWx1ZUNvbnZlcnRlcih2YWx1ZSkge1xuICAgIHZhciBuZXdWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xuICAgIGlmIChpc05hTihuZXdWYWx1ZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB2YWx1ZTogXCIgKyBuZXdWYWx1ZSk7XG4gICAgfVxuICAgIHJldHVybiBuZXdWYWx1ZTtcbn1cbmV4cG9ydHMuekluZGV4UHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJ6SW5kZXhcIiwgY3NzTmFtZTogXCJ6LWluZGV4XCIsIHZhbHVlQ29udmVydGVyOiBpc0Zsb2F0VmFsdWVDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLnpJbmRleFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5mdW5jdGlvbiBvcGFjaXR5Q29udmVydGVyKHZhbHVlKSB7XG4gICAgdmFyIG5ld1ZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgaWYgKCFpc05hTihuZXdWYWx1ZSkgJiYgMCA8PSBuZXdWYWx1ZSAmJiBuZXdWYWx1ZSA8PSAxKSB7XG4gICAgICAgIHJldHVybiBuZXdWYWx1ZTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiT3BhY2l0eSBzaG91bGQgYmUgYmV0d2VlbiBbMCwgMV0uIFZhbHVlOiBcIiArIG5ld1ZhbHVlKTtcbn1cbmV4cG9ydHMub3BhY2l0eVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NBbmltYXRpb25Qcm9wZXJ0eSh7IG5hbWU6IFwib3BhY2l0eVwiLCBjc3NOYW1lOiBcIm9wYWNpdHlcIiwgZGVmYXVsdFZhbHVlOiAxLCB2YWx1ZUNvbnZlcnRlcjogb3BhY2l0eUNvbnZlcnRlciB9KTtcbmV4cG9ydHMub3BhY2l0eVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmNvbG9yUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkluaGVyaXRlZENzc1Byb3BlcnR5KHsgbmFtZTogXCJjb2xvclwiLCBjc3NOYW1lOiBcImNvbG9yXCIsIGVxdWFsaXR5Q29tcGFyZXI6IGNvbG9yXzEuQ29sb3IuZXF1YWxzLCB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBjb2xvcl8xLkNvbG9yKHYpOyB9IH0pO1xuZXhwb3J0cy5jb2xvclByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRJbnRlcm5hbFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiZm9udEludGVybmFsXCIsIGNzc05hbWU6IFwiX2ZvbnRJbnRlcm5hbFwiLCBkZWZhdWx0VmFsdWU6IGZvbnRfMS5Gb250LmRlZmF1bHQgfSk7XG5leHBvcnRzLmZvbnRJbnRlcm5hbFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRGYW1pbHlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuSW5oZXJpdGVkQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwiZm9udEZhbWlseVwiLCBjc3NOYW1lOiBcImZvbnQtZmFtaWx5XCIsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ2hhbmdlZDogZnVuY3Rpb24gKHRhcmdldCwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIHZhciBjdXJyZW50Rm9udCA9IHRhcmdldC5mb250SW50ZXJuYWw7XG4gICAgICAgIGlmIChjdXJyZW50Rm9udC5mb250RmFtaWx5ICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udEZhbWlseShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLmZvbnRGYW1pbHlQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250U2l6ZVwiLCBjc3NOYW1lOiBcImZvbnQtc2l6ZVwiLCBhZmZlY3RzTGF5b3V0OiBwbGF0Zm9ybV8xLmlzSU9TLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudEZvbnQgPSB0YXJnZXQuZm9udEludGVybmFsO1xuICAgICAgICBpZiAoY3VycmVudEZvbnQuZm9udFNpemUgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgbmV3Rm9udCA9IGN1cnJlbnRGb250LndpdGhGb250U2l6ZShuZXdWYWx1ZSk7XG4gICAgICAgICAgICB0YXJnZXQuZm9udEludGVybmFsID0gZm9udF8xLkZvbnQuZXF1YWxzKGZvbnRfMS5Gb250LmRlZmF1bHQsIG5ld0ZvbnQpID8gcHJvcGVydGllc18xLnVuc2V0VmFsdWUgOiBuZXdGb250O1xuICAgICAgICB9XG4gICAgfSxcbiAgICB2YWx1ZUNvbnZlcnRlcjogZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHBhcnNlRmxvYXQodik7IH1cbn0pO1xuZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG5leHBvcnRzLmZvbnRTdHlsZVByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250U3R5bGVcIiwgY3NzTmFtZTogXCJmb250LXN0eWxlXCIsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIGRlZmF1bHRWYWx1ZTogZm9udF8xLkZvbnRTdHlsZS5OT1JNQUwsIHZhbHVlQ29udmVydGVyOiBmb250XzEuRm9udFN0eWxlLnBhcnNlLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgY3VycmVudEZvbnQgPSB0YXJnZXQuZm9udEludGVybmFsO1xuICAgICAgICBpZiAoY3VycmVudEZvbnQuZm9udFN0eWxlICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgdmFyIG5ld0ZvbnQgPSBjdXJyZW50Rm9udC53aXRoRm9udFN0eWxlKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRhcmdldC5mb250SW50ZXJuYWwgPSBmb250XzEuRm9udC5lcXVhbHMoZm9udF8xLkZvbnQuZGVmYXVsdCwgbmV3Rm9udCkgPyBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSA6IG5ld0ZvbnQ7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmV4cG9ydHMuZm9udFN0eWxlUHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbmV4cG9ydHMuZm9udFdlaWdodFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250V2VpZ2h0XCIsIGNzc05hbWU6IFwiZm9udC13ZWlnaHRcIiwgYWZmZWN0c0xheW91dDogcGxhdGZvcm1fMS5pc0lPUywgZGVmYXVsdFZhbHVlOiBmb250XzEuRm9udFdlaWdodC5OT1JNQUwsIHZhbHVlQ29udmVydGVyOiBmb250XzEuRm9udFdlaWdodC5wYXJzZSwgdmFsdWVDaGFuZ2VkOiBmdW5jdGlvbiAodGFyZ2V0LCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgdmFyIGN1cnJlbnRGb250ID0gdGFyZ2V0LmZvbnRJbnRlcm5hbDtcbiAgICAgICAgaWYgKGN1cnJlbnRGb250LmZvbnRXZWlnaHQgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgbmV3Rm9udCA9IGN1cnJlbnRGb250LndpdGhGb250V2VpZ2h0KG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIHRhcmdldC5mb250SW50ZXJuYWwgPSBmb250XzEuRm9udC5lcXVhbHMoZm9udF8xLkZvbnQuZGVmYXVsdCwgbmV3Rm9udCkgPyBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSA6IG5ld0ZvbnQ7XG4gICAgICAgIH1cbiAgICB9XG59KTtcbmV4cG9ydHMuZm9udFdlaWdodFByb3BlcnR5LnJlZ2lzdGVyKHByb3BlcnRpZXNfMS5TdHlsZSk7XG52YXIgZm9udFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5TaG9ydGhhbmRQcm9wZXJ0eSh7XG4gICAgbmFtZTogXCJmb250XCIsIGNzc05hbWU6IFwiZm9udFwiLFxuICAgIGdldHRlcjogZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5mb250U3R5bGUgKyBcIiBcIiArIHRoaXMuZm9udFdlaWdodCArIFwiIFwiICsgdGhpcy5mb250U2l6ZSArIFwiIFwiICsgdGhpcy5mb250RmFtaWx5O1xuICAgIH0sXG4gICAgY29udmVydGVyOiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZSkge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U3R5bGVQcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eSwgcHJvcGVydGllc18xLnVuc2V0VmFsdWVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRTaXplUHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250RmFtaWx5UHJvcGVydHksIHByb3BlcnRpZXNfMS51bnNldFZhbHVlXVxuICAgICAgICAgICAgXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHZhciBmb250ID0gZm9udF8xLnBhcnNlRm9udCh2YWx1ZSk7XG4gICAgICAgICAgICB2YXIgZm9udFNpemUgPSBwYXJzZUZsb2F0KGZvbnQuZm9udFNpemUpO1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U3R5bGVQcm9wZXJ0eSwgZm9udC5mb250U3R5bGVdLFxuICAgICAgICAgICAgICAgIFtleHBvcnRzLmZvbnRXZWlnaHRQcm9wZXJ0eSwgZm9udC5mb250V2VpZ2h0XSxcbiAgICAgICAgICAgICAgICBbZXhwb3J0cy5mb250U2l6ZVByb3BlcnR5LCBmb250U2l6ZV0sXG4gICAgICAgICAgICAgICAgW2V4cG9ydHMuZm9udEZhbWlseVByb3BlcnR5LCBmb250LmZvbnRGYW1pbHldXG4gICAgICAgICAgICBdO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5mb250UHJvcGVydHkucmVnaXN0ZXIocHJvcGVydGllc18xLlN0eWxlKTtcbnZhciBWaXNpYmlsaXR5O1xuKGZ1bmN0aW9uIChWaXNpYmlsaXR5KSB7XG4gICAgVmlzaWJpbGl0eS5WSVNJQkxFID0gXCJ2aXNpYmxlXCI7XG4gICAgVmlzaWJpbGl0eS5ISURERU4gPSBcImhpZGRlblwiO1xuICAgIFZpc2liaWxpdHkuQ09MTEFQU0UgPSBcImNvbGxhcHNlXCI7XG4gICAgVmlzaWJpbGl0eS5pc1ZhbGlkID0gcHJvcGVydGllc18xLm1ha2VWYWxpZGF0b3IoVmlzaWJpbGl0eS5WSVNJQkxFLCBWaXNpYmlsaXR5LkhJRERFTiwgVmlzaWJpbGl0eS5DT0xMQVBTRSk7XG4gICAgVmlzaWJpbGl0eS5wYXJzZSA9IGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJjb2xsYXBzZWRcIiA/IFZpc2liaWxpdHkuQ09MTEFQU0UgOiBwYXJzZVN0cmljdCh2YWx1ZSk7IH07XG4gICAgdmFyIHBhcnNlU3RyaWN0ID0gcHJvcGVydGllc18xLm1ha2VQYXJzZXIoVmlzaWJpbGl0eS5pc1ZhbGlkKTtcbn0pKFZpc2liaWxpdHkgPSBleHBvcnRzLlZpc2liaWxpdHkgfHwgKGV4cG9ydHMuVmlzaWJpbGl0eSA9IHt9KSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eSA9IG5ldyBwcm9wZXJ0aWVzXzEuQ3NzUHJvcGVydHkoe1xuICAgIG5hbWU6IFwidmlzaWJpbGl0eVwiLCBjc3NOYW1lOiBcInZpc2liaWxpdHlcIiwgZGVmYXVsdFZhbHVlOiBWaXNpYmlsaXR5LlZJU0lCTEUsIGFmZmVjdHNMYXlvdXQ6IHBsYXRmb3JtXzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiBWaXNpYmlsaXR5LnBhcnNlLCB2YWx1ZUNoYW5nZWQ6IGZ1bmN0aW9uICh0YXJnZXQsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgdmlldyA9IHRhcmdldC52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgdmlldy5pc0NvbGxhcHNlZCA9IChuZXdWYWx1ZSA9PT0gVmlzaWJpbGl0eS5DT0xMQVBTRSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG5ld1ZhbHVlICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICB9XG4gICAgfVxufSk7XG5leHBvcnRzLnZpc2liaWxpdHlQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5hbmRyb2lkRWxldmF0aW9uUHJvcGVydHkgPSBuZXcgcHJvcGVydGllc18xLkNzc1Byb3BlcnR5KHsgbmFtZTogXCJhbmRyb2lkRWxldmF0aW9uXCIsIGNzc05hbWU6IFwiYW5kcm9pZC1lbGV2YXRpb25cIiwgdmFsdWVDb252ZXJ0ZXI6IHBhcnNlRmxvYXQgfSk7XG5leHBvcnRzLmFuZHJvaWRFbGV2YXRpb25Qcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuZXhwb3J0cy5hbmRyb2lkRHluYW1pY0VsZXZhdGlvbk9mZnNldFByb3BlcnR5ID0gbmV3IHByb3BlcnRpZXNfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwiYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRcIiwgY3NzTmFtZTogXCJhbmRyb2lkLWR5bmFtaWMtZWxldmF0aW9uLW9mZnNldFwiLCB2YWx1ZUNvbnZlcnRlcjogcGFyc2VGbG9hdCB9KTtcbmV4cG9ydHMuYW5kcm9pZER5bmFtaWNFbGV2YXRpb25PZmZzZXRQcm9wZXJ0eS5yZWdpc3Rlcihwcm9wZXJ0aWVzXzEuU3R5bGUpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c3R5bGUtcHJvcGVydGllcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgcHJvcGVydGllc18xID0gcmVxdWlyZShcIi4uL2NvcmUvcHJvcGVydGllc1wiKTtcbnZhciBjc3NfMSA9IHJlcXVpcmUoXCIuLi8uLi9jc3NcIik7XG52YXIgcGFyc2VyXzEgPSByZXF1aXJlKFwiLi4vLi4vY3NzL3BhcnNlclwiKTtcbnZhciBjc3Nfc2VsZWN0b3JfMSA9IHJlcXVpcmUoXCIuL2Nzcy1zZWxlY3RvclwiKTtcbnZhciB0cmFjZV8xID0gcmVxdWlyZShcIi4uLy4uL3RyYWNlXCIpO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgYXBwbGljYXRpb25Db21tb24gPSByZXF1aXJlKFwiLi4vLi4vYXBwbGljYXRpb24vYXBwbGljYXRpb24tY29tbW9uXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbnZhciBrZXlmcmFtZUFuaW1hdGlvbk1vZHVsZTtcbmZ1bmN0aW9uIGVuc3VyZUtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKCkge1xuICAgIGlmICgha2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUpIHtcbiAgICAgICAga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUgPSByZXF1aXJlKFwidWkvYW5pbWF0aW9uL2tleWZyYW1lLWFuaW1hdGlvblwiKTtcbiAgICB9XG59XG52YXIgY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlO1xuZnVuY3Rpb24gZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCkge1xuICAgIGlmICghY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKSB7XG4gICAgICAgIGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSA9IHJlcXVpcmUoXCIuL2Nzcy1hbmltYXRpb24tcGFyc2VyXCIpO1xuICAgIH1cbn1cbnZhciBwYXJzZXIgPSBcInJld29ya1wiO1xudHJ5IHtcbiAgICB2YXIgYXBwQ29uZmlnID0gcmVxdWlyZShcIn4vcGFja2FnZS5qc29uXCIpO1xuICAgIGlmIChhcHBDb25maWcgJiYgYXBwQ29uZmlnLmNzc1BhcnNlciA9PT0gXCJuYXRpdmVzY3JpcHRcIikge1xuICAgICAgICBwYXJzZXIgPSBcIm5hdGl2ZXNjcmlwdFwiO1xuICAgIH1cbn1cbmNhdGNoIChlKSB7XG59XG5mdW5jdGlvbiBtZXJnZUNzc1NlbGVjdG9ycygpIHtcbiAgICBhcHBsaWNhdGlvbkNzc1NlbGVjdG9ycyA9IGFwcGxpY2F0aW9uU2VsZWN0b3JzLnNsaWNlKCk7XG4gICAgYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMucHVzaC5hcHBseShhcHBsaWNhdGlvbkNzc1NlbGVjdG9ycywgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzKTtcbiAgICBhcHBsaWNhdGlvbkNzc1NlbGVjdG9yVmVyc2lvbisrO1xufVxuZXhwb3J0cy5tZXJnZUNzc1NlbGVjdG9ycyA9IG1lcmdlQ3NzU2VsZWN0b3JzO1xudmFyIGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzID0gW107XG52YXIgYXBwbGljYXRpb25Dc3NTZWxlY3RvclZlcnNpb24gPSAwO1xudmFyIGFwcGxpY2F0aW9uU2VsZWN0b3JzID0gW107XG52YXIgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzID0gW107XG52YXIgYXBwbGljYXRpb25LZXlmcmFtZXMgPSB7fTtcbnZhciBhbmltYXRpb25zU3ltYm9sID0gU3ltYm9sKFwiYW5pbWF0aW9uc1wiKTtcbnZhciBwYXR0ZXJuID0gLygnfFwiKSguKj8pXFwxLztcbnZhciBDU1NTb3VyY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENTU1NvdXJjZShfYXN0LCBfdXJsLCBfZmlsZSwgX2tleWZyYW1lcywgX3NvdXJjZSkge1xuICAgICAgICB0aGlzLl9hc3QgPSBfYXN0O1xuICAgICAgICB0aGlzLl91cmwgPSBfdXJsO1xuICAgICAgICB0aGlzLl9maWxlID0gX2ZpbGU7XG4gICAgICAgIHRoaXMuX2tleWZyYW1lcyA9IF9rZXlmcmFtZXM7XG4gICAgICAgIHRoaXMuX3NvdXJjZSA9IF9zb3VyY2U7XG4gICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IFtdO1xuICAgICAgICB0aGlzLnBhcnNlKCk7XG4gICAgfVxuICAgIENTU1NvdXJjZS5mcm9tVVJJID0gZnVuY3Rpb24gKHVyaSwga2V5ZnJhbWVzKSB7XG4gICAgICAgIHZhciBhcHBSZWxhdGl2ZVVyaSA9IENTU1NvdXJjZS5wYXRoUmVsYXRpdmVUb0FwcCh1cmkpO1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGNzc09yQXN0ID0gZ2xvYmFsLmxvYWRNb2R1bGUoYXBwUmVsYXRpdmVVcmksIHRydWUpO1xuICAgICAgICAgICAgaWYgKGNzc09yQXN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjc3NPckFzdCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ1NTU291cmNlLmZyb21Tb3VyY2UoY3NzT3JBc3QsIGtleWZyYW1lcywgYXBwUmVsYXRpdmVVcmkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0eXBlb2YgY3NzT3JBc3QgPT09IFwib2JqZWN0XCIgJiYgY3NzT3JBc3QudHlwZSA9PT0gXCJzdHlsZXNoZWV0XCIgJiYgY3NzT3JBc3Quc3R5bGVzaGVldCAmJiBjc3NPckFzdC5zdHlsZXNoZWV0LnJ1bGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBDU1NTb3VyY2UuZnJvbUFTVChjc3NPckFzdCwga2V5ZnJhbWVzLCBhcHBSZWxhdGl2ZVVyaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQ1NTU291cmNlLmZyb21Tb3VyY2UoY3NzT3JBc3QudG9TdHJpbmcoKSwga2V5ZnJhbWVzLCBhcHBSZWxhdGl2ZVVyaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIENTU1NvdXJjZS5mcm9tRmlsZShhcHBSZWxhdGl2ZVVyaSwga2V5ZnJhbWVzKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wYXRoUmVsYXRpdmVUb0FwcCA9IGZ1bmN0aW9uICh1cmkpIHtcbiAgICAgICAgaWYgKCF1cmkuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgICAgICAgIHJldHVybiB1cmk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGFwcFBhdGggPSBmaWxlX3N5c3RlbV8xLmtub3duRm9sZGVycy5jdXJyZW50QXBwKCkucGF0aDtcbiAgICAgICAgaWYgKCF1cmkuc3RhcnRzV2l0aChhcHBQYXRoKSkge1xuICAgICAgICAgICAgdHJhY2VfMS53cml0ZSh1cmkgKyBcIiBkb2VzIG5vdCBzdGFydCB3aXRoIFwiICsgYXBwUGF0aCwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiB1cmk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlbGF0aXZlVXJpID0gXCIuXCIgKyB1cmkuc3Vic3RyKGFwcFBhdGgubGVuZ3RoKTtcbiAgICAgICAgcmV0dXJuIHJlbGF0aXZlVXJpO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21GaWxlID0gZnVuY3Rpb24gKHVybCwga2V5ZnJhbWVzKSB7XG4gICAgICAgIHZhciBjc3NGaWxlVXJsID0gdXJsLnJlcGxhY2UoL1xcLi5cXHcrJC8sIFwiLmNzc1wiKTtcbiAgICAgICAgaWYgKGNzc0ZpbGVVcmwgIT09IHVybCkge1xuICAgICAgICAgICAgdmFyIGNzc0ZpbGUgPSBDU1NTb3VyY2UucmVzb2x2ZUNTU1BhdGhGcm9tVVJMKGNzc0ZpbGVVcmwpO1xuICAgICAgICAgICAgaWYgKGNzc0ZpbGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZSh1bmRlZmluZWQsIHVybCwgY3NzRmlsZSwga2V5ZnJhbWVzLCB1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBmaWxlID0gQ1NTU291cmNlLnJlc29sdmVDU1NQYXRoRnJvbVVSTCh1cmwpO1xuICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZSh1bmRlZmluZWQsIHVybCwgZmlsZSwga2V5ZnJhbWVzLCB1bmRlZmluZWQpO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21GaWxlSW1wb3J0ID0gZnVuY3Rpb24gKHVybCwga2V5ZnJhbWVzLCBpbXBvcnRTb3VyY2UpIHtcbiAgICAgICAgdmFyIGZpbGUgPSBDU1NTb3VyY2UucmVzb2x2ZUNTU1BhdGhGcm9tVVJMKHVybCwgaW1wb3J0U291cmNlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBDU1NTb3VyY2UodW5kZWZpbmVkLCB1cmwsIGZpbGUsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5yZXNvbHZlQ1NTUGF0aEZyb21VUkwgPSBmdW5jdGlvbiAodXJsLCBpbXBvcnRTb3VyY2UpIHtcbiAgICAgICAgdmFyIGFwcCA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoO1xuICAgICAgICB2YXIgZmlsZSA9IHJlc29sdmVGaWxlTmFtZUZyb21VcmwodXJsLCBhcHAsIGZpbGVfc3lzdGVtXzEuRmlsZS5leGlzdHMsIGltcG9ydFNvdXJjZSk7XG4gICAgICAgIHJldHVybiBmaWxlO1xuICAgIH07XG4gICAgQ1NTU291cmNlLmZyb21Tb3VyY2UgPSBmdW5jdGlvbiAoc291cmNlLCBrZXlmcmFtZXMsIHVybCkge1xuICAgICAgICByZXR1cm4gbmV3IENTU1NvdXJjZSh1bmRlZmluZWQsIHVybCwgdW5kZWZpbmVkLCBrZXlmcmFtZXMsIHNvdXJjZSk7XG4gICAgfTtcbiAgICBDU1NTb3VyY2UuZnJvbUFTVCA9IGZ1bmN0aW9uIChhc3QsIGtleWZyYW1lcywgdXJsKSB7XG4gICAgICAgIHJldHVybiBuZXcgQ1NTU291cmNlKGFzdCwgdXJsLCB1bmRlZmluZWQsIGtleWZyYW1lcywgdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDU1NTb3VyY2UucHJvdG90eXBlLCBcInNlbGVjdG9yc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fc2VsZWN0b3JzOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ1NTU291cmNlLnByb3RvdHlwZSwgXCJzb3VyY2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX3NvdXJjZTsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmlsZSA9IGZpbGVfc3lzdGVtXzEuRmlsZS5mcm9tUGF0aCh0aGlzLl9maWxlKTtcbiAgICAgICAgdGhpcy5fc291cmNlID0gZmlsZS5yZWFkVGV4dFN5bmMoKTtcbiAgICB9O1xuICAgIENTU1NvdXJjZS5wcm90b3R5cGUucGFyc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2FzdCkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc291cmNlICYmIHRoaXMuX2ZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zb3VyY2UgJiYgdGhpcy5zb3VyY2UgIT09IFwiW29iamVjdCBPYmplY3RdXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJzZUNTU0FzdCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9hc3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVNlbGVjdG9ycygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2VsZWN0b3JzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJDc3Mgc3R5bGluZyBmYWlsZWQ6IFwiICsgZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IFtdO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBDU1NTb3VyY2UucHJvdG90eXBlLnBhcnNlQ1NTQXN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fc291cmNlKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHBhcnNlcikge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJuYXRpdmVzY3JpcHRcIjpcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNzc3BhcnNlciA9IG5ldyBwYXJzZXJfMS5DU1MzUGFyc2VyKHRoaXMuX3NvdXJjZSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdHlsZXNoZWV0ID0gY3NzcGFyc2VyLnBhcnNlQVN0eWxlc2hlZXQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNzc05TID0gbmV3IHBhcnNlcl8xLkNTU05hdGl2ZVNjcmlwdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hc3QgPSBjc3NOUy5wYXJzZVN0eWxlc2hlZXQoc3R5bGVzaGVldCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICBjYXNlIFwicmV3b3JrXCI6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FzdCA9IGNzc18xLnBhcnNlKHRoaXMuX3NvdXJjZSwgeyBzb3VyY2U6IHRoaXMuX2ZpbGUgfSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5jcmVhdGVTZWxlY3RvcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9hc3QpIHtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IHRoaXMuY3JlYXRlU2VsZWN0b3JzRnJvbUltcG9ydHMoKS5jb25jYXQodGhpcy5jcmVhdGVTZWxlY3RvcnNGcm9tU3ludGF4VHJlZSgpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5jcmVhdGVTZWxlY3RvcnNGcm9tSW1wb3J0cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGltcG9ydHMgPSB0aGlzLl9hc3RbXCJzdHlsZXNoZWV0XCJdW1wicnVsZXNcIl0uZmlsdGVyKGZ1bmN0aW9uIChyKSB7IHJldHVybiByLnR5cGUgPT09IFwiaW1wb3J0XCI7IH0pO1xuICAgICAgICB2YXIgdXJsRnJvbUltcG9ydE9iamVjdCA9IGZ1bmN0aW9uIChpbXBvcnRPYmplY3QpIHtcbiAgICAgICAgICAgIHZhciBpbXBvcnRJdGVtID0gaW1wb3J0T2JqZWN0W1wiaW1wb3J0XCJdO1xuICAgICAgICAgICAgdmFyIHVybE1hdGNoID0gaW1wb3J0SXRlbSAmJiBpbXBvcnRJdGVtLm1hdGNoKHBhdHRlcm4pO1xuICAgICAgICAgICAgcmV0dXJuIHVybE1hdGNoICYmIHVybE1hdGNoWzJdO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgc291cmNlRnJvbUltcG9ydE9iamVjdCA9IGZ1bmN0aW9uIChpbXBvcnRPYmplY3QpIHtcbiAgICAgICAgICAgIHJldHVybiBpbXBvcnRPYmplY3RbXCJwb3NpdGlvblwiXSAmJiBpbXBvcnRPYmplY3RbXCJwb3NpdGlvblwiXVtcInNvdXJjZVwiXTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRvVXJsU291cmNlUGFpciA9IGZ1bmN0aW9uIChpbXBvcnRPYmplY3QpIHsgcmV0dXJuICh7XG4gICAgICAgICAgICB1cmw6IHVybEZyb21JbXBvcnRPYmplY3QoaW1wb3J0T2JqZWN0KSxcbiAgICAgICAgICAgIHNvdXJjZTogc291cmNlRnJvbUltcG9ydE9iamVjdChpbXBvcnRPYmplY3QpLFxuICAgICAgICB9KTsgfTtcbiAgICAgICAgdmFyIGdldENzc0ZpbGUgPSBmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBfYS51cmwsIHNvdXJjZSA9IF9hLnNvdXJjZTtcbiAgICAgICAgICAgIHJldHVybiBzb3VyY2UgP1xuICAgICAgICAgICAgICAgIENTU1NvdXJjZS5mcm9tRmlsZUltcG9ydCh1cmwsIF90aGlzLl9rZXlmcmFtZXMsIHNvdXJjZSkgOlxuICAgICAgICAgICAgICAgIENTU1NvdXJjZS5mcm9tVVJJKHVybCwgX3RoaXMuX2tleWZyYW1lcyk7XG4gICAgICAgIH07XG4gICAgICAgIHZhciBjc3NGaWxlcyA9IGltcG9ydHNcbiAgICAgICAgICAgIC5tYXAodG9VcmxTb3VyY2VQYWlyKVxuICAgICAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAoX2EpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBfYS51cmw7XG4gICAgICAgICAgICByZXR1cm4gISF1cmw7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAubWFwKGdldENzc0ZpbGUpO1xuICAgICAgICB2YXIgc2VsZWN0b3JzID0gY3NzRmlsZXMubWFwKGZ1bmN0aW9uIChmaWxlKSB7IHJldHVybiAoZmlsZSAmJiBmaWxlLnNlbGVjdG9ycykgfHwgW107IH0pO1xuICAgICAgICByZXR1cm4gc2VsZWN0b3JzLnJlZHVjZShmdW5jdGlvbiAoYWNjLCB2YWwpIHsgcmV0dXJuIGFjYy5jb25jYXQodmFsKTsgfSwgW10pO1xuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS5jcmVhdGVTZWxlY3RvcnNGcm9tU3ludGF4VHJlZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG5vZGVzID0gdGhpcy5fYXN0LnN0eWxlc2hlZXQucnVsZXM7XG4gICAgICAgIG5vZGVzLmZpbHRlcihpc0tleWZyYW1lKS5mb3JFYWNoKGZ1bmN0aW9uIChub2RlKSB7IHJldHVybiBfdGhpcy5fa2V5ZnJhbWVzW25vZGUubmFtZV0gPSBub2RlOyB9KTtcbiAgICAgICAgdmFyIHJ1bGVzZXRzID0gY3NzX3NlbGVjdG9yXzEuZnJvbUFzdE5vZGVzKG5vZGVzKTtcbiAgICAgICAgaWYgKHJ1bGVzZXRzICYmIHJ1bGVzZXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCk7XG4gICAgICAgICAgICBydWxlc2V0cy5mb3JFYWNoKGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAgICAgcnVsZVthbmltYXRpb25zU3ltYm9sXSA9IGNzc0FuaW1hdGlvblBhcnNlck1vZHVsZS5Dc3NBbmltYXRpb25QYXJzZXJcbiAgICAgICAgICAgICAgICAgICAgLmtleWZyYW1lQW5pbWF0aW9uc0Zyb21DU1NEZWNsYXJhdGlvbnMocnVsZS5kZWNsYXJhdGlvbnMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJ1bGVzZXRzO1xuICAgIH07XG4gICAgQ1NTU291cmNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ZpbGUgfHwgdGhpcy5fdXJsIHx8IFwiKGluLW1lbW9yeSlcIjtcbiAgICB9O1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ1NTU291cmNlLnByb3RvdHlwZSwgXCJsb2FkXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgQ1NTU291cmNlLnByb3RvdHlwZSwgXCJwYXJzZVwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZS5wcm90b3R5cGUsIFwicGFyc2VDU1NBc3RcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBDU1NTb3VyY2UucHJvdG90eXBlLCBcImNyZWF0ZVNlbGVjdG9yc1wiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENTU1NvdXJjZSwgXCJyZXNvbHZlQ1NTUGF0aEZyb21VUkxcIiwgbnVsbCk7XG4gICAgcmV0dXJuIENTU1NvdXJjZTtcbn0oKSk7XG5mdW5jdGlvbiByZW1vdmVUYWdnZWRBZGRpdGlvbmFsQ1NTKHRhZykge1xuICAgIHZhciBjaGFuZ2VkID0gZmFsc2U7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcHBsaWNhdGlvbkFkZGl0aW9uYWxTZWxlY3RvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9yc1tpXS50YWcgPT09IHRhZykge1xuICAgICAgICAgICAgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLnNwbGljZShpLCAxKTtcbiAgICAgICAgICAgIGktLTtcbiAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChjaGFuZ2VkKSB7XG4gICAgICAgIG1lcmdlQ3NzU2VsZWN0b3JzKCk7XG4gICAgfVxuICAgIHJldHVybiBjaGFuZ2VkO1xufVxuZXhwb3J0cy5yZW1vdmVUYWdnZWRBZGRpdGlvbmFsQ1NTID0gcmVtb3ZlVGFnZ2VkQWRkaXRpb25hbENTUztcbmZ1bmN0aW9uIGFkZFRhZ2dlZEFkZGl0aW9uYWxDU1MoY3NzVGV4dCwgdGFnKSB7XG4gICAgdmFyIHBhcnNlZCA9IENTU1NvdXJjZS5mcm9tU291cmNlKGNzc1RleHQsIGFwcGxpY2F0aW9uS2V5ZnJhbWVzLCB1bmRlZmluZWQpLnNlbGVjdG9ycztcbiAgICB2YXIgY2hhbmdlZCA9IGZhbHNlO1xuICAgIGlmIChwYXJzZWQgJiYgcGFyc2VkLmxlbmd0aCkge1xuICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRhZyAhPSBudWxsKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhcnNlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHBhcnNlZFtpXS50YWcgPSB0YWc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLnB1c2guYXBwbHkoYXBwbGljYXRpb25BZGRpdGlvbmFsU2VsZWN0b3JzLCBwYXJzZWQpO1xuICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgIH1cbiAgICByZXR1cm4gY2hhbmdlZDtcbn1cbmV4cG9ydHMuYWRkVGFnZ2VkQWRkaXRpb25hbENTUyA9IGFkZFRhZ2dlZEFkZGl0aW9uYWxDU1M7XG52YXIgb25Dc3NDaGFuZ2VkID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlxcXCJzdHlsZS1zY29wZVxcXCIub25Dc3NDaGFuZ2VkXCIsIGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgaWYgKGFyZ3MuY3NzVGV4dCkge1xuICAgICAgICB2YXIgcGFyc2VkID0gQ1NTU291cmNlLmZyb21Tb3VyY2UoYXJncy5jc3NUZXh0LCBhcHBsaWNhdGlvbktleWZyYW1lcywgYXJncy5jc3NGaWxlKS5zZWxlY3RvcnM7XG4gICAgICAgIGlmIChwYXJzZWQpIHtcbiAgICAgICAgICAgIGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycy5wdXNoLmFwcGx5KGFwcGxpY2F0aW9uQWRkaXRpb25hbFNlbGVjdG9ycywgcGFyc2VkKTtcbiAgICAgICAgICAgIG1lcmdlQ3NzU2VsZWN0b3JzKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZWxzZSBpZiAoYXJncy5jc3NGaWxlKSB7XG4gICAgICAgIGxvYWRDc3MoYXJncy5jc3NGaWxlKTtcbiAgICB9XG59KTtcbmZ1bmN0aW9uIG9uTGl2ZVN5bmMoYXJncykge1xuICAgIGxvYWRDc3MoYXBwbGljYXRpb25Db21tb24uZ2V0Q3NzRmlsZU5hbWUoKSk7XG59XG52YXIgbG9hZENzcyA9IHByb2ZpbGluZ18xLnByb2ZpbGUoXCJcXFwic3R5bGUtc2NvcGVcXFwiLmxvYWRDc3NcIiwgZnVuY3Rpb24gKGNzc0ZpbGUpIHtcbiAgICBpZiAoIWNzc0ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgdmFyIHJlc3VsdCA9IENTU1NvdXJjZS5mcm9tVVJJKGNzc0ZpbGUsIGFwcGxpY2F0aW9uS2V5ZnJhbWVzKS5zZWxlY3RvcnM7XG4gICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGFwcGxpY2F0aW9uU2VsZWN0b3JzID0gcmVzdWx0O1xuICAgICAgICBtZXJnZUNzc1NlbGVjdG9ycygpO1xuICAgIH1cbn0pO1xuYXBwbGljYXRpb25Db21tb24ub24oXCJjc3NDaGFuZ2VkXCIsIG9uQ3NzQ2hhbmdlZCk7XG5hcHBsaWNhdGlvbkNvbW1vbi5vbihcImxpdmVzeW5jXCIsIG9uTGl2ZVN5bmMpO1xuZXhwb3J0cy5sb2FkQXBwQ1NTID0gcHJvZmlsaW5nXzEucHJvZmlsZShcIlxcXCJzdHlsZS1zY29wZVxcXCIubG9hZEFwcENTU1wiLCBmdW5jdGlvbiAoYXJncykge1xuICAgIGxvYWRDc3MoYXJncy5jc3NGaWxlKTtcbiAgICBhcHBsaWNhdGlvbkNvbW1vbi5vZmYoXCJsb2FkQXBwQ3NzXCIsIGV4cG9ydHMubG9hZEFwcENTUyk7XG59KTtcbmlmIChhcHBsaWNhdGlvbkNvbW1vbi5oYXNMYXVuY2hlZCgpKSB7XG4gICAgZXhwb3J0cy5sb2FkQXBwQ1NTKHsgZXZlbnROYW1lOiBcImxvYWRBcHBDc3NcIiwgb2JqZWN0OiBhcHBsaWNhdGlvbkNvbW1vbiwgY3NzRmlsZTogYXBwbGljYXRpb25Db21tb24uZ2V0Q3NzRmlsZU5hbWUoKSB9KTtcbn1cbmVsc2Uge1xuICAgIGFwcGxpY2F0aW9uQ29tbW9uLm9uKFwibG9hZEFwcENzc1wiLCBleHBvcnRzLmxvYWRBcHBDU1MpO1xufVxudmFyIENzc1N0YXRlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBDc3NTdGF0ZSh2aWV3UmVmKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMudmlld1JlZiA9IHZpZXdSZWY7XG4gICAgICAgIHRoaXMuX29uRHluYW1pY1N0YXRlQ2hhbmdlSGFuZGxlciA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnVwZGF0ZUR5bmFtaWNTdGF0ZSgpOyB9O1xuICAgIH1cbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUub25DaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAodmlldyAmJiB2aWV3LmlzTG9hZGVkKSB7XG4gICAgICAgICAgICB0aGlzLnVuc3Vic2NyaWJlRnJvbUR5bmFtaWNVcGRhdGVzKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1hdGNoKCk7XG4gICAgICAgICAgICB0aGlzLnN1YnNjcmliZUZvckR5bmFtaWNVcGRhdGVzKCk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUR5bmFtaWNTdGF0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbWF0Y2hJbnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLmlzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJpc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkIHJldHVybnMgZGVmYXVsdCB2YWx1ZSBcXFwiZmFsc2VcXFwiIGJlY2F1c2UgXFxcInRoaXMudmlld1JlZlxcXCIgY2xlYXJlZC5cIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnZpZXdSZWYuZ2V0KCkuX3N0eWxlU2NvcGUuX2dldFNlbGVjdG9yc1ZlcnNpb24oKSA9PT0gdGhpcy5fYXBwbGllZFNlbGVjdG9yc1ZlcnNpb247XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUub25Mb2FkZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLl9tYXRjaEludmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTWF0Y2goKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN1YnNjcmliZUZvckR5bmFtaWNVcGRhdGVzKCk7XG4gICAgICAgIHRoaXMudXBkYXRlRHluYW1pY1N0YXRlKCk7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUub25VbmxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZUZyb21EeW5hbWljVXBkYXRlcygpO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnVwZGF0ZU1hdGNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKHZpZXcgJiYgdmlldy5fc3R5bGVTY29wZSkge1xuICAgICAgICAgICAgdGhpcy5fbWF0Y2ggPSB2aWV3Ll9zdHlsZVNjb3BlLm1hdGNoU2VsZWN0b3JzKHZpZXcpO1xuICAgICAgICAgICAgdGhpcy5fYXBwbGllZFNlbGVjdG9yc1ZlcnNpb24gPSB2aWV3Ll9zdHlsZVNjb3BlLl9nZXRTZWxlY3RvcnNWZXJzaW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9tYXRjaCA9IENzc1N0YXRlLmVtcHR5TWF0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbWF0Y2hJbnZhbGlkID0gZmFsc2U7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUudXBkYXRlRHluYW1pY1N0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwidXBkYXRlRHluYW1pY1N0YXRlIG5vdCBleGVjdXRlZCB0byB2aWV3IGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5TdHlsZSwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbWF0Y2hpbmdTZWxlY3RvcnMgPSB0aGlzLl9tYXRjaC5zZWxlY3RvcnMuZmlsdGVyKGZ1bmN0aW9uIChzZWwpIHsgcmV0dXJuIHNlbC5keW5hbWljID8gc2VsLm1hdGNoKHZpZXcpIDogdHJ1ZTsgfSk7XG4gICAgICAgIHZpZXcuX2JhdGNoVXBkYXRlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnN0b3BLZXlmcmFtZUFuaW1hdGlvbnMoKTtcbiAgICAgICAgICAgIF90aGlzLnNldFByb3BlcnR5VmFsdWVzKG1hdGNoaW5nU2VsZWN0b3JzKTtcbiAgICAgICAgICAgIF90aGlzLnBsYXlLZXlmcmFtZUFuaW1hdGlvbnMobWF0Y2hpbmdTZWxlY3RvcnMpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5wbGF5S2V5ZnJhbWVBbmltYXRpb25zID0gZnVuY3Rpb24gKG1hdGNoaW5nU2VsZWN0b3JzKSB7XG4gICAgICAgIHZhciBhbmltYXRpb25zID0gW107XG4gICAgICAgIG1hdGNoaW5nU2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICB2YXIgcnVsZUFuaW1hdGlvbnMgPSBzZWxlY3Rvci5ydWxlc2V0W2FuaW1hdGlvbnNTeW1ib2xdO1xuICAgICAgICAgICAgaWYgKHJ1bGVBbmltYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlS2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJ1bGVBbmltYXRpb25zXzEgPSBydWxlQW5pbWF0aW9uczsgX2kgPCBydWxlQW5pbWF0aW9uc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uSW5mbyA9IHJ1bGVBbmltYXRpb25zXzFbX2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uID0ga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUuS2V5ZnJhbWVBbmltYXRpb24ua2V5ZnJhbWVBbmltYXRpb25Gcm9tSW5mbyhhbmltYXRpb25JbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFuaW1hdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9ucy5wdXNoKGFuaW1hdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5fcGxheXNLZXlmcmFtZUFuaW1hdGlvbnMgPSBhbmltYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHZhciB2aWV3XzEgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICBpZiAoIXZpZXdfMSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJLZXlmcmFtZUFuaW1hdGlvbnMgY2Fubm90IHBsYXkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbmltYXRpb25zLm1hcChmdW5jdGlvbiAoYW5pbWF0aW9uKSB7IHJldHVybiBhbmltYXRpb24ucGxheSh2aWV3XzEpOyB9KTtcbiAgICAgICAgICAgIE9iamVjdC5mcmVlemUoYW5pbWF0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLl9hcHBsaWVkQW5pbWF0aW9ucyA9IGFuaW1hdGlvbnM7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5zdG9wS2V5ZnJhbWVBbmltYXRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3BsYXlzS2V5ZnJhbWVBbmltYXRpb25zKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fYXBwbGllZEFuaW1hdGlvbnNcbiAgICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24gKGFuaW1hdGlvbikgeyByZXR1cm4gYW5pbWF0aW9uLmlzUGxheWluZzsgfSlcbiAgICAgICAgICAgIC5mb3JFYWNoKGZ1bmN0aW9uIChhbmltYXRpb24pIHsgcmV0dXJuIGFuaW1hdGlvbi5jYW5jZWwoKTsgfSk7XG4gICAgICAgIHRoaXMuX2FwcGxpZWRBbmltYXRpb25zID0gQ3NzU3RhdGUuZW1wdHlBbmltYXRpb25BcnJheTtcbiAgICAgICAgdmFyIHZpZXcgPSB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6cm90YXRlXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6c2NhbGVYXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6c2NhbGVZXCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgICAgICB2aWV3LnN0eWxlW1wia2V5ZnJhbWU6dHJhbnNsYXRlWFwiXSA9IHByb3BlcnRpZXNfMS51bnNldFZhbHVlO1xuICAgICAgICAgICAgdmlldy5zdHlsZVtcImtleWZyYW1lOnRyYW5zbGF0ZVlcIl0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJrZXlmcmFtZTpiYWNrZ3JvdW5kQ29sb3JcIl0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgIHZpZXcuc3R5bGVbXCJrZXlmcmFtZTpvcGFjaXR5XCJdID0gcHJvcGVydGllc18xLnVuc2V0VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiS2V5ZnJhbWVBbmltYXRpb25zIGNhbm5vdCBiZSBzdG9wcGVkIGJlY2F1c2UgXFxcIi52aWV3UmVmXFxcIiBpcyBjbGVhcmVkXCIsIHRyYWNlXzEuY2F0ZWdvcmllcy5BbmltYXRpb24sIHRyYWNlXzEubWVzc2FnZVR5cGUud2Fybik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcGxheXNLZXlmcmFtZUFuaW1hdGlvbnMgPSBmYWxzZTtcbiAgICB9O1xuICAgIENzc1N0YXRlLnByb3RvdHlwZS5zZXRQcm9wZXJ0eVZhbHVlcyA9IGZ1bmN0aW9uIChtYXRjaGluZ1NlbGVjdG9ycykge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKG1hdGNoaW5nU2VsZWN0b3JzICsgXCIgbm90IHNldCB0byB2aWV3J3MgcHJvcGVydHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLlN0eWxlLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuZXdQcm9wZXJ0eVZhbHVlcyA9IG5ldyB2aWV3LnN0eWxlLlByb3BlcnR5QmFnKCk7XG4gICAgICAgIG1hdGNoaW5nU2VsZWN0b3JzLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdG9yKSB7XG4gICAgICAgICAgICByZXR1cm4gc2VsZWN0b3IucnVsZXNldC5kZWNsYXJhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAoZGVjbGFyYXRpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3UHJvcGVydHlWYWx1ZXNbZGVjbGFyYXRpb24ucHJvcGVydHldID0gZGVjbGFyYXRpb24udmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5mcmVlemUobmV3UHJvcGVydHlWYWx1ZXMpO1xuICAgICAgICB2YXIgb2xkUHJvcGVydGllcyA9IHRoaXMuX2FwcGxpZWRQcm9wZXJ0eVZhbHVlcztcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9sZFByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIGlmICghKGtleSBpbiBuZXdQcm9wZXJ0eVZhbHVlcykpIHtcbiAgICAgICAgICAgICAgICBpZiAoa2V5IGluIHZpZXcuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zdHlsZVtcImNzczpcIiArIGtleV0gPSBwcm9wZXJ0aWVzXzEudW5zZXRWYWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIG5ld1Byb3BlcnR5VmFsdWVzKSB7XG4gICAgICAgICAgICBpZiAob2xkUHJvcGVydGllcyAmJiBwcm9wZXJ0eSBpbiBvbGRQcm9wZXJ0aWVzICYmIG9sZFByb3BlcnRpZXNbcHJvcGVydHldID09PSBuZXdQcm9wZXJ0eVZhbHVlc1twcm9wZXJ0eV0pIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG5ld1Byb3BlcnR5VmFsdWVzW3Byb3BlcnR5XTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHByb3BlcnR5IGluIHZpZXcuc3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5zdHlsZVtcImNzczpcIiArIHByb3BlcnR5XSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhbWVsQ2FzZWRQcm9wZXJ0eSA9IHByb3BlcnR5LnJlcGxhY2UoLy0oW2Etel0pL2csIGZ1bmN0aW9uIChnKSB7IHJldHVybiBnWzFdLnRvVXBwZXJDYXNlKCk7IH0pO1xuICAgICAgICAgICAgICAgICAgICB2aWV3W2NhbWVsQ2FzZWRQcm9wZXJ0eV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJGYWlsZWQgdG8gYXBwbHkgcHJvcGVydHkgW1wiICsgcHJvcGVydHkgKyBcIl0gd2l0aCB2YWx1ZSBbXCIgKyB2YWx1ZSArIFwiXSB0byBcIiArIHZpZXcgKyBcIi4gXCIgKyBlLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2FwcGxpZWRQcm9wZXJ0eVZhbHVlcyA9IG5ld1Byb3BlcnR5VmFsdWVzO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnN1YnNjcmliZUZvckR5bmFtaWNVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY2hhbmdlTWFwID0gdGhpcy5fbWF0Y2guY2hhbmdlTWFwO1xuICAgICAgICBjaGFuZ2VNYXAuZm9yRWFjaChmdW5jdGlvbiAoY2hhbmdlcywgdmlldykge1xuICAgICAgICAgICAgaWYgKGNoYW5nZXMuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMuYXR0cmlidXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlldy5hZGRFdmVudExpc3RlbmVyKGF0dHJpYnV0ZSArIFwiQ2hhbmdlXCIsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNoYW5nZXMucHNldWRvQ2xhc3Nlcykge1xuICAgICAgICAgICAgICAgIGNoYW5nZXMucHNldWRvQ2xhc3Nlcy5mb3JFYWNoKGZ1bmN0aW9uIChwc2V1ZG9DbGFzcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnROYW1lID0gXCI6XCIgKyBwc2V1ZG9DbGFzcztcbiAgICAgICAgICAgICAgICAgICAgdmlldy5hZGRFdmVudExpc3RlbmVyKFwiOlwiICsgcHNldWRvQ2xhc3MsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tldmVudE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3W2V2ZW50TmFtZV0oKzEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQ2hhbmdlTWFwID0gY2hhbmdlTWFwO1xuICAgIH07XG4gICAgQ3NzU3RhdGUucHJvdG90eXBlLnVuc3Vic2NyaWJlRnJvbUR5bmFtaWNVcGRhdGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQ2hhbmdlTWFwLmZvckVhY2goZnVuY3Rpb24gKGNoYW5nZXMsIHZpZXcpIHtcbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLmF0dHJpYnV0ZXMuZm9yRWFjaChmdW5jdGlvbiAoYXR0cmlidXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcihhdHRyaWJ1dGUgKyBcIkNoYW5nZVwiLCBfdGhpcy5fb25EeW5hbWljU3RhdGVDaGFuZ2VIYW5kbGVyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaGFuZ2VzLnBzZXVkb0NsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLnBzZXVkb0NsYXNzZXMuZm9yRWFjaChmdW5jdGlvbiAocHNldWRvQ2xhc3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50TmFtZSA9IFwiOlwiICsgcHNldWRvQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgIHZpZXcucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIF90aGlzLl9vbkR5bmFtaWNTdGF0ZUNoYW5nZUhhbmRsZXIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlld1tldmVudE5hbWVdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3W2V2ZW50TmFtZV0oLTEpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9hcHBsaWVkQ2hhbmdlTWFwID0gQ3NzU3RhdGUuZW1wdHlDaGFuZ2VNYXA7XG4gICAgfTtcbiAgICBDc3NTdGF0ZS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB2aWV3ID0gdGhpcy52aWV3UmVmLmdldCgpO1xuICAgICAgICBpZiAoIXZpZXcpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJ0b1N0cmluZygpIG9mIENzc1N0YXRlIGNhbm5vdCBleGVjdXRlIGNvcnJlY3RseSBiZWNhdXNlIFxcXCIudmlld1JlZlxcXCIgaXMgY2xlYXJlZFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuQW5pbWF0aW9uLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLndhcm4pO1xuICAgICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZpZXcgKyBcIi5fY3NzU3RhdGVcIjtcbiAgICB9O1xuICAgIENzc1N0YXRlLmVtcHR5Q2hhbmdlTWFwID0gT2JqZWN0LmZyZWV6ZShuZXcgTWFwKCkpO1xuICAgIENzc1N0YXRlLmVtcHR5UHJvcGVydHlCYWcgPSBPYmplY3QuZnJlZXplKHt9KTtcbiAgICBDc3NTdGF0ZS5lbXB0eUFuaW1hdGlvbkFycmF5ID0gT2JqZWN0LmZyZWV6ZShbXSk7XG4gICAgQ3NzU3RhdGUuZW1wdHlNYXRjaCA9IHsgc2VsZWN0b3JzOiBbXSwgY2hhbmdlTWFwOiBuZXcgTWFwKCkgfTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENzc1N0YXRlLnByb3RvdHlwZSwgXCJ1cGRhdGVNYXRjaFwiLCBudWxsKTtcbiAgICBfX2RlY29yYXRlKFtcbiAgICAgICAgcHJvZmlsaW5nXzEucHJvZmlsZVxuICAgIF0sIENzc1N0YXRlLnByb3RvdHlwZSwgXCJ1cGRhdGVEeW5hbWljU3RhdGVcIiwgbnVsbCk7XG4gICAgcmV0dXJuIENzc1N0YXRlO1xufSgpKTtcbmV4cG9ydHMuQ3NzU3RhdGUgPSBDc3NTdGF0ZTtcbkNzc1N0YXRlLnByb3RvdHlwZS5fYXBwbGllZENoYW5nZU1hcCA9IENzc1N0YXRlLmVtcHR5Q2hhbmdlTWFwO1xuQ3NzU3RhdGUucHJvdG90eXBlLl9hcHBsaWVkUHJvcGVydHlWYWx1ZXMgPSBDc3NTdGF0ZS5lbXB0eVByb3BlcnR5QmFnO1xuQ3NzU3RhdGUucHJvdG90eXBlLl9hcHBsaWVkQW5pbWF0aW9ucyA9IENzc1N0YXRlLmVtcHR5QW5pbWF0aW9uQXJyYXk7XG5Dc3NTdGF0ZS5wcm90b3R5cGUuX21hdGNoSW52YWxpZCA9IHRydWU7XG52YXIgU3R5bGVTY29wZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3R5bGVTY29wZSgpIHtcbiAgICAgICAgdGhpcy5fY3NzID0gXCJcIjtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMgPSBbXTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb24gPSAwO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID0gMDtcbiAgICAgICAgdGhpcy5fYXBwbGljYXRpb25Dc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9IDA7XG4gICAgICAgIHRoaXMuX2tleWZyYW1lcyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0eWxlU2NvcGUucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NzcztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q3NzKHZhbHVlKTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuYWRkQ3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZywgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmRDc3MoY3NzU3RyaW5nLCBjc3NGaWxlTmFtZSk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5hZGRDc3NGaWxlID0gZnVuY3Rpb24gKGNzc0ZpbGVOYW1lKSB7XG4gICAgICAgIHRoaXMuYXBwZW5kQ3NzKG51bGwsIGNzc0ZpbGVOYW1lKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmNoYW5nZUNzc0ZpbGUgPSBmdW5jdGlvbiAoY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgaWYgKCFjc3NGaWxlTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjc3NTZWxlY3RvcnMgPSBDU1NTb3VyY2UuZnJvbVVSSShjc3NGaWxlTmFtZSwgdGhpcy5fa2V5ZnJhbWVzKTtcbiAgICAgICAgdGhpcy5fY3NzID0gY3NzU2VsZWN0b3JzLnNvdXJjZTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnMgPSBjc3NTZWxlY3RvcnMuc2VsZWN0b3JzO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbisrO1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuc2V0Q3NzID0gZnVuY3Rpb24gKGNzc1N0cmluZywgY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgdGhpcy5fY3NzID0gY3NzU3RyaW5nO1xuICAgICAgICB2YXIgY3NzRmlsZSA9IENTU1NvdXJjZS5mcm9tU291cmNlKGNzc1N0cmluZywgdGhpcy5fa2V5ZnJhbWVzLCBjc3NGaWxlTmFtZSk7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzID0gY3NzRmlsZS5zZWxlY3RvcnM7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JWZXJzaW9uKys7XG4gICAgICAgIHRoaXMuZW5zdXJlU2VsZWN0b3JzKCk7XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5hcHBlbmRDc3MgPSBmdW5jdGlvbiAoY3NzU3RyaW5nLCBjc3NGaWxlTmFtZSkge1xuICAgICAgICBpZiAoIWNzc1N0cmluZyAmJiAhY3NzRmlsZU5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcGFyc2VkQ3NzU2VsZWN0b3JzID0gY3NzU3RyaW5nID8gQ1NTU291cmNlLmZyb21Tb3VyY2UoY3NzU3RyaW5nLCB0aGlzLl9rZXlmcmFtZXMsIGNzc0ZpbGVOYW1lKSA6IENTU1NvdXJjZS5mcm9tVVJJKGNzc0ZpbGVOYW1lLCB0aGlzLl9rZXlmcmFtZXMpO1xuICAgICAgICB0aGlzLl9jc3MgPSB0aGlzLl9jc3MgKyBwYXJzZWRDc3NTZWxlY3RvcnMuc291cmNlO1xuICAgICAgICB0aGlzLl9sb2NhbENzc1NlbGVjdG9ycy5wdXNoLmFwcGx5KHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzLCBwYXJzZWRDc3NTZWxlY3RvcnMuc2VsZWN0b3JzKTtcbiAgICAgICAgdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb24rKztcbiAgICAgICAgdGhpcy5lbnN1cmVTZWxlY3RvcnMoKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmdldEtleWZyYW1lQW5pbWF0aW9uV2l0aE5hbWUgPSBmdW5jdGlvbiAoYW5pbWF0aW9uTmFtZSkge1xuICAgICAgICB2YXIgY3NzS2V5ZnJhbWVzID0gdGhpcy5fa2V5ZnJhbWVzW2FuaW1hdGlvbk5hbWVdO1xuICAgICAgICBpZiAoIWNzc0tleWZyYW1lcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGVuc3VyZUtleWZyYW1lQW5pbWF0aW9uTW9kdWxlKCk7XG4gICAgICAgIHZhciBhbmltYXRpb24gPSBuZXcga2V5ZnJhbWVBbmltYXRpb25Nb2R1bGUuS2V5ZnJhbWVBbmltYXRpb25JbmZvKCk7XG4gICAgICAgIGVuc3VyZUNzc0FuaW1hdGlvblBhcnNlck1vZHVsZSgpO1xuICAgICAgICBhbmltYXRpb24ua2V5ZnJhbWVzID0gY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlXG4gICAgICAgICAgICAuQ3NzQW5pbWF0aW9uUGFyc2VyLmtleWZyYW1lc0FycmF5RnJvbUNTUyhjc3NLZXlmcmFtZXMua2V5ZnJhbWVzKTtcbiAgICAgICAgcmV0dXJuIGFuaW1hdGlvbjtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmVuc3VyZVNlbGVjdG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmlzQXBwbGljYXRpb25Dc3NTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCgpIHx8XG4gICAgICAgICAgICAhdGhpcy5pc0xvY2FsQ3NzU2VsZWN0b3JzTGF0ZXN0VmVyc2lvbkFwcGxpZWQoKSB8fFxuICAgICAgICAgICAgIXRoaXMuX21lcmdlZENzc1NlbGVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRlU2VsZWN0b3JzKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldFNlbGVjdG9yc1ZlcnNpb24oKTtcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLmlzQXBwbGljYXRpb25Dc3NTZWxlY3RvcnNMYXRlc3RWZXJzaW9uQXBwbGllZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2FwcGxpY2F0aW9uQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPT09IGFwcGxpY2F0aW9uQ3NzU2VsZWN0b3JWZXJzaW9uO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuaXNMb2NhbENzc1NlbGVjdG9yc0xhdGVzdFZlcnNpb25BcHBsaWVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbG9jYWxDc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiA9PT0gdGhpcy5fbG9jYWxDc3NTZWxlY3RvclZlcnNpb247XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5fY3JlYXRlU2VsZWN0b3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9NZXJnZSA9IFtdO1xuICAgICAgICB0b01lcmdlLnB1c2goYXBwbGljYXRpb25Dc3NTZWxlY3RvcnMpO1xuICAgICAgICB0aGlzLl9hcHBsaWNhdGlvbkNzc1NlbGVjdG9yc0FwcGxpZWRWZXJzaW9uID0gYXBwbGljYXRpb25Dc3NTZWxlY3RvclZlcnNpb247XG4gICAgICAgIHRvTWVyZ2UucHVzaCh0aGlzLl9sb2NhbENzc1NlbGVjdG9ycyk7XG4gICAgICAgIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb24gPSB0aGlzLl9sb2NhbENzc1NlbGVjdG9yVmVyc2lvbjtcbiAgICAgICAgZm9yICh2YXIga2V5ZnJhbWUgaW4gYXBwbGljYXRpb25LZXlmcmFtZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2tleWZyYW1lc1trZXlmcmFtZV0gPSBhcHBsaWNhdGlvbktleWZyYW1lc1trZXlmcmFtZV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRvTWVyZ2UubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzID0gdG9NZXJnZS5maWx0ZXIoZnVuY3Rpb24gKG0pIHsgcmV0dXJuICEhbTsgfSkucmVkdWNlKGZ1bmN0aW9uIChtZXJnZWQsIG5leHQpIHsgcmV0dXJuIG1lcmdlZC5jb25jYXQobmV4dCk7IH0sIFtdKTtcbiAgICAgICAgICAgIHRoaXMuX2FwcGx5S2V5ZnJhbWVzT25TZWxlY3RvcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdG9ycyA9IG5ldyBjc3Nfc2VsZWN0b3JfMS5TZWxlY3RvcnNNYXAodGhpcy5fbWVyZ2VkQ3NzU2VsZWN0b3JzKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUubWF0Y2hTZWxlY3RvcnMgPSBmdW5jdGlvbiAodmlldykge1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3JzLnF1ZXJ5KHZpZXcpO1xuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUucXVlcnkgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB0aGlzLmVuc3VyZVNlbGVjdG9ycygpO1xuICAgICAgICByZXR1cm4gdGhpcy5fc2VsZWN0b3JzLnF1ZXJ5KG5vZGUpLnNlbGVjdG9ycztcbiAgICB9O1xuICAgIFN0eWxlU2NvcGUucHJvdG90eXBlLl9nZXRTZWxlY3RvcnNWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gMTAwMDAwICogdGhpcy5fYXBwbGljYXRpb25Dc3NTZWxlY3RvcnNBcHBsaWVkVmVyc2lvbiArIHRoaXMuX2xvY2FsQ3NzU2VsZWN0b3JzQXBwbGllZFZlcnNpb247XG4gICAgfTtcbiAgICBTdHlsZVNjb3BlLnByb3RvdHlwZS5fYXBwbHlLZXlmcmFtZXNPblNlbGVjdG9ycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IHRoaXMuX21lcmdlZENzc1NlbGVjdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgdmFyIHJ1bGVzZXQgPSB0aGlzLl9tZXJnZWRDc3NTZWxlY3RvcnNbaV07XG4gICAgICAgICAgICB2YXIgYW5pbWF0aW9ucyA9IHJ1bGVzZXRbYW5pbWF0aW9uc1N5bWJvbF07XG4gICAgICAgICAgICBpZiAoYW5pbWF0aW9ucyAhPT0gdW5kZWZpbmVkICYmIGFuaW1hdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZW5zdXJlQ3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlKCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBhbmltYXRpb25zXzEgPSBhbmltYXRpb25zOyBfaSA8IGFuaW1hdGlvbnNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFuaW1hdGlvbiA9IGFuaW1hdGlvbnNfMVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjc3NLZXlmcmFtZSA9IHRoaXMuX2tleWZyYW1lc1thbmltYXRpb24ubmFtZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChjc3NLZXlmcmFtZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb24ua2V5ZnJhbWVzID0gY3NzQW5pbWF0aW9uUGFyc2VyTW9kdWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLkNzc0FuaW1hdGlvblBhcnNlci5rZXlmcmFtZXNBcnJheUZyb21DU1MoY3NzS2V5ZnJhbWUua2V5ZnJhbWVzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU3R5bGVTY29wZS5wcm90b3R5cGUuZ2V0QW5pbWF0aW9ucyA9IGZ1bmN0aW9uIChydWxlc2V0KSB7XG4gICAgICAgIHJldHVybiBydWxlc2V0W2FuaW1hdGlvbnNTeW1ib2xdO1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJzZXRDc3NcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJhcHBlbmRDc3NcIiwgbnVsbCk7XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBTdHlsZVNjb3BlLnByb3RvdHlwZSwgXCJfY3JlYXRlU2VsZWN0b3JzXCIsIG51bGwpO1xuICAgIF9fZGVjb3JhdGUoW1xuICAgICAgICBwcm9maWxpbmdfMS5wcm9maWxlXG4gICAgXSwgU3R5bGVTY29wZS5wcm90b3R5cGUsIFwibWF0Y2hTZWxlY3RvcnNcIiwgbnVsbCk7XG4gICAgcmV0dXJuIFN0eWxlU2NvcGU7XG59KCkpO1xuZXhwb3J0cy5TdHlsZVNjb3BlID0gU3R5bGVTY29wZTtcbmZ1bmN0aW9uIHJlc29sdmVGaWxlTmFtZUZyb21VcmwodXJsLCBhcHBEaXJlY3RvcnksIGZpbGVFeGlzdHMsIGltcG9ydFNvdXJjZSkge1xuICAgIHZhciBmaWxlTmFtZSA9IHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgPyB1cmwudHJpbSgpIDogXCJcIjtcbiAgICBpZiAoZmlsZU5hbWUuaW5kZXhPZihcIn4vXCIpID09PSAwKSB7XG4gICAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUucmVwbGFjZShcIn4vXCIsIFwiXCIpO1xuICAgIH1cbiAgICB2YXIgaXNBYnNvbHV0ZVBhdGggPSBmaWxlTmFtZS5pbmRleE9mKFwiL1wiKSA9PT0gMDtcbiAgICB2YXIgYWJzb2x1dGVQYXRoID0gaXNBYnNvbHV0ZVBhdGggPyBmaWxlTmFtZSA6IGZpbGVfc3lzdGVtXzEucGF0aC5qb2luKGFwcERpcmVjdG9yeSwgZmlsZU5hbWUpO1xuICAgIGlmIChmaWxlRXhpc3RzKGFic29sdXRlUGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIGFic29sdXRlUGF0aDtcbiAgICB9XG4gICAgaWYgKCFpc0Fic29sdXRlUGF0aCkge1xuICAgICAgICBpZiAoZmlsZU5hbWVbMF0gPT09IFwiflwiICYmIGZpbGVOYW1lWzFdICE9PSBcIi9cIiAmJiBmaWxlTmFtZVsxXSAhPT0gXCJcXFwiXCIpIHtcbiAgICAgICAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUuc3Vic3RyKDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbXBvcnRTb3VyY2UpIHtcbiAgICAgICAgICAgIHZhciBpbXBvcnRGaWxlID0gcmVzb2x2ZUZpbGVQYXRoRnJvbUltcG9ydChpbXBvcnRTb3VyY2UsIGZpbGVOYW1lKTtcbiAgICAgICAgICAgIGlmIChmaWxlRXhpc3RzKGltcG9ydEZpbGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGltcG9ydEZpbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGV4dGVybmFsXzEgPSBmaWxlX3N5c3RlbV8xLnBhdGguam9pbihhcHBEaXJlY3RvcnksIFwidG5zX21vZHVsZXNcIiwgZmlsZU5hbWUpO1xuICAgICAgICBpZiAoZmlsZUV4aXN0cyhleHRlcm5hbF8xKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsXzE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5leHBvcnRzLnJlc29sdmVGaWxlTmFtZUZyb21VcmwgPSByZXNvbHZlRmlsZU5hbWVGcm9tVXJsO1xuZnVuY3Rpb24gcmVzb2x2ZUZpbGVQYXRoRnJvbUltcG9ydChpbXBvcnRTb3VyY2UsIGZpbGVOYW1lKSB7XG4gICAgdmFyIGltcG9ydFNvdXJjZVBhcnRzID0gaW1wb3J0U291cmNlLnNwbGl0KGZpbGVfc3lzdGVtXzEucGF0aC5zZXBhcmF0b3IpO1xuICAgIHZhciBmaWxlTmFtZVBhcnRzID0gZmlsZU5hbWUuc3BsaXQoZmlsZV9zeXN0ZW1fMS5wYXRoLnNlcGFyYXRvcilcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbiAocCkgeyByZXR1cm4gIWlzQ3VycmVudERpcmVjdG9yeShwKTsgfSk7XG4gICAgaW1wb3J0U291cmNlUGFydHMucG9wKCk7XG4gICAgZmlsZU5hbWVQYXJ0cy5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7IHJldHVybiBpc1BhcmVudERpcmVjdG9yeShwKSA/IGltcG9ydFNvdXJjZVBhcnRzLnBvcCgpIDogaW1wb3J0U291cmNlUGFydHMucHVzaChwKTsgfSk7XG4gICAgcmV0dXJuIGltcG9ydFNvdXJjZVBhcnRzLmpvaW4oZmlsZV9zeXN0ZW1fMS5wYXRoLnNlcGFyYXRvcik7XG59XG5leHBvcnRzLmFwcGx5SW5saW5lU3R5bGUgPSBwcm9maWxpbmdfMS5wcm9maWxlKGZ1bmN0aW9uIGFwcGx5SW5saW5lU3R5bGUodmlldywgc3R5bGVTdHIpIHtcbiAgICB2YXIgbG9jYWxTdHlsZSA9IFwibG9jYWwgeyBcIiArIHN0eWxlU3RyICsgXCIgfVwiO1xuICAgIHZhciBpbmxpbmVSdWxlU2V0ID0gQ1NTU291cmNlLmZyb21Tb3VyY2UobG9jYWxTdHlsZSwgbmV3IE1hcCgpKS5zZWxlY3RvcnM7XG4gICAgdmFyIHN0eWxlID0gdmlldy5zdHlsZTtcbiAgICBpbmxpbmVSdWxlU2V0WzBdLmRlY2xhcmF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIHZhciBuYW1lID0gZC5wcm9wZXJ0eTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChuYW1lIGluIHN0eWxlKSB7XG4gICAgICAgICAgICAgICAgc3R5bGVbbmFtZV0gPSBkLnZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmlld1tuYW1lXSA9IGQudmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIHRyYWNlXzEud3JpdGUoXCJGYWlsZWQgdG8gYXBwbHkgcHJvcGVydHkgW1wiICsgZC5wcm9wZXJ0eSArIFwiXSB3aXRoIHZhbHVlIFtcIiArIGQudmFsdWUgKyBcIl0gdG8gXCIgKyB2aWV3ICsgXCIuIFwiICsgZSwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgfVxuICAgIH0pO1xufSk7XG5mdW5jdGlvbiBpc0N1cnJlbnREaXJlY3RvcnkodXJpUGFydCkge1xuICAgIHJldHVybiB1cmlQYXJ0ID09PSBcIi5cIjtcbn1cbmZ1bmN0aW9uIGlzUGFyZW50RGlyZWN0b3J5KHVyaVBhcnQpIHtcbiAgICByZXR1cm4gdXJpUGFydCA9PT0gXCIuLlwiO1xufVxuZnVuY3Rpb24gaXNLZXlmcmFtZShub2RlKSB7XG4gICAgcmV0dXJuIG5vZGUudHlwZSA9PT0gXCJrZXlmcmFtZXNcIjtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLXNjb3BlLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciBvYnNlcnZhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vZGF0YS9vYnNlcnZhYmxlXCIpO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vdHJhY2VcIik7XG52YXIgU3R5bGUgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdHlsZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdHlsZShvd25lclZpZXcpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcykgfHwgdGhpcztcbiAgICAgICAgaWYgKG93bmVyVmlldy5jb25zdHJ1Y3Rvci50b1N0cmluZygpLmluZGV4T2YoXCJbbmF0aXZlIGNvZGVdXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgX3RoaXMudmlld1JlZiA9IG93bmVyVmlldztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIF90aGlzLnZpZXdSZWYgPSBuZXcgV2Vha1JlZihvd25lclZpZXcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3R5bGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdmlldyA9IHRoaXMudmlld1JlZi5nZXQoKTtcbiAgICAgICAgaWYgKCF2aWV3KSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwidG9TdHJpbmcoKSBvZiBTdHlsZSBjYW5ub3QgZXhlY3V0ZSBjb3JyZWN0bHkgYmVjYXVzZSBcXFwiLnZpZXdSZWZcXFwiIGlzIGNsZWFyZWRcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkFuaW1hdGlvbiwgdHJhY2VfMS5tZXNzYWdlVHlwZS53YXJuKTtcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3ICsgXCIuc3R5bGVcIjtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHlsZS5wcm90b3R5cGUsIFwidmlld1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMudmlld1JlZikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZpZXdSZWYuZ2V0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gU3R5bGU7XG59KG9ic2VydmFibGVfMS5PYnNlcnZhYmxlKSk7XG5leHBvcnRzLlN0eWxlID0gU3R5bGU7XG5TdHlsZS5wcm90b3R5cGUuUHJvcGVydHlCYWcgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIGNsYXNzXzEoKSB7XG4gICAgfVxuICAgIHJldHVybiBjbGFzc18xO1xufSgpKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0eWxlLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdmlld18xID0gcmVxdWlyZShcIi4uL2NvcmUvdmlld1wiKTtcbnZhciBmb3JtYXR0ZWRfc3RyaW5nXzEgPSByZXF1aXJlKFwiLi4vLi4vdGV4dC9mb3JtYXR0ZWQtc3RyaW5nXCIpO1xuZXhwb3J0cy5Gb3JtYXR0ZWRTdHJpbmcgPSBmb3JtYXR0ZWRfc3RyaW5nXzEuRm9ybWF0dGVkU3RyaW5nO1xuZXhwb3J0cy5TcGFuID0gZm9ybWF0dGVkX3N0cmluZ18xLlNwYW47XG5fX2V4cG9ydChyZXF1aXJlKFwiLi4vY29yZS92aWV3XCIpKTtcbnZhciBDSElMRF9TUEFOID0gXCJTcGFuXCI7XG52YXIgQ0hJTERfRk9STUFUVEVEX1RFWFQgPSBcImZvcm1hdHRlZFRleHRcIjtcbnZhciBDSElMRF9GT1JNQVRURURfU1RSSU5HID0gXCJGb3JtYXR0ZWRTdHJpbmdcIjtcbnZhciBUZXh0QmFzZUNvbW1vbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRleHRCYXNlQ29tbW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRleHRCYXNlQ29tbW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwibmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hdGl2ZVZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwiZm9udEZhbWlseVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udEZhbWlseTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udEZhbWlseSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImZvbnRTaXplXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5mb250U2l6ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFNpemUgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJmb250U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmZvbnRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFN0eWxlID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwiZm9udFdlaWdodFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUuZm9udFdlaWdodDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUuZm9udFdlaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcImxldHRlclNwYWNpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmxldHRlclNwYWNpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLmxldHRlclNwYWNpbmcgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJsaW5lSGVpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5saW5lSGVpZ2h0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5saW5lSGVpZ2h0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwidGV4dEFsaWdubWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUudGV4dEFsaWdubWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dEFsaWdubWVudCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInRleHREZWNvcmF0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0RGVjb3JhdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUudGV4dERlY29yYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJ0ZXh0VHJhbnNmb3JtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS50ZXh0VHJhbnNmb3JtO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS50ZXh0VHJhbnNmb3JtID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwid2hpdGVTcGFjZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUud2hpdGVTcGFjZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUud2hpdGVTcGFjZSA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmcgPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nVG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nVG9wO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdHlsZS5wYWRkaW5nVG9wID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUsIFwicGFkZGluZ1JpZ2h0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdHlsZS5wYWRkaW5nUmlnaHQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdSaWdodCA9IHZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLCBcInBhZGRpbmdCb3R0b21cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLnBhZGRpbmdCb3R0b207XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdCb3R0b20gPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZSwgXCJwYWRkaW5nTGVmdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3R5bGUucGFkZGluZ0xlZnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlLnBhZGRpbmdMZWZ0ID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5fb25Gb3JtYXR0ZWRUZXh0Q29udGVudHNDaGFuZ2VkID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVmlld1Byb3RlY3RlZCkge1xuICAgICAgICAgICAgdGhpc1tleHBvcnRzLmZvcm1hdHRlZFRleHRQcm9wZXJ0eS5zZXROYXRpdmVdKGRhdGEudmFsdWUpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX2FkZENoaWxkRnJvbUJ1aWxkZXIgPSBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHtcbiAgICAgICAgaWYgKG5hbWUgPT09IENISUxEX1NQQU4pIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlZFRleHQgPSBuZXcgZm9ybWF0dGVkX3N0cmluZ18xLkZvcm1hdHRlZFN0cmluZygpO1xuICAgICAgICAgICAgICAgIGZvcm1hdHRlZFRleHQuc3BhbnMucHVzaCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5mb3JtYXR0ZWRUZXh0ID0gZm9ybWF0dGVkVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuZm9ybWF0dGVkVGV4dC5zcGFucy5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChuYW1lID09PSBDSElMRF9GT1JNQVRURURfVEVYVCB8fCBuYW1lID09PSBDSElMRF9GT1JNQVRURURfU1RSSU5HKSB7XG4gICAgICAgICAgICB0aGlzLmZvcm1hdHRlZFRleHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2VDb21tb24ucHJvdG90eXBlLl9yZXF1ZXN0TGF5b3V0T25UZXh0Q2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yZXF1ZXN0TGF5b3V0KCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuZWFjaENoaWxkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy5mb3JtYXR0ZWRUZXh0O1xuICAgICAgICBpZiAodGV4dCkge1xuICAgICAgICAgICAgY2FsbGJhY2sodGV4dCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlQ29tbW9uLnByb3RvdHlwZS5fc2V0TmF0aXZlVGV4dCA9IGZ1bmN0aW9uIChyZXNldCkge1xuICAgICAgICBpZiAocmVzZXQgPT09IHZvaWQgMCkgeyByZXNldCA9IGZhbHNlOyB9XG4gICAgfTtcbiAgICByZXR1cm4gVGV4dEJhc2VDb21tb247XG59KHZpZXdfMS5WaWV3KSk7XG5leHBvcnRzLlRleHRCYXNlQ29tbW9uID0gVGV4dEJhc2VDb21tb247XG5UZXh0QmFzZUNvbW1vbi5wcm90b3R5cGUuX2lzU2luZ2xlTGluZSA9IGZhbHNlO1xuZnVuY3Rpb24gaXNCb2xkKGZvbnRXZWlnaHQpIHtcbiAgICByZXR1cm4gZm9udFdlaWdodCA9PT0gXCJib2xkXCIgfHwgZm9udFdlaWdodCA9PT0gXCI3MDBcIiB8fCBmb250V2VpZ2h0ID09PSBcIjgwMFwiIHx8IGZvbnRXZWlnaHQgPT09IFwiOTAwXCI7XG59XG5leHBvcnRzLmlzQm9sZCA9IGlzQm9sZDtcbmV4cG9ydHMudGV4dFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwidGV4dFwiLCBkZWZhdWx0VmFsdWU6IFwiXCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0FuZHJvaWQgfSk7XG5leHBvcnRzLnRleHRQcm9wZXJ0eS5yZWdpc3RlcihUZXh0QmFzZUNvbW1vbik7XG5leHBvcnRzLmZvcm1hdHRlZFRleHRQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuUHJvcGVydHkoeyBuYW1lOiBcImZvcm1hdHRlZFRleHRcIiwgYWZmZWN0c0xheW91dDogdHJ1ZSwgdmFsdWVDaGFuZ2VkOiBvbkZvcm1hdHRlZFRleHRQcm9wZXJ0eUNoYW5nZWQgfSk7XG5leHBvcnRzLmZvcm1hdHRlZFRleHRQcm9wZXJ0eS5yZWdpc3RlcihUZXh0QmFzZUNvbW1vbik7XG5mdW5jdGlvbiBvbkZvcm1hdHRlZFRleHRQcm9wZXJ0eUNoYW5nZWQodGV4dEJhc2UsIG9sZFZhbHVlLCBuZXdWYWx1ZSkge1xuICAgIGlmIChvbGRWYWx1ZSkge1xuICAgICAgICBvbGRWYWx1ZS5vZmYodmlld18xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGV4dEJhc2UuX29uRm9ybWF0dGVkVGV4dENvbnRlbnRzQ2hhbmdlZCwgdGV4dEJhc2UpO1xuICAgICAgICB0ZXh0QmFzZS5fcmVtb3ZlVmlldyhvbGRWYWx1ZSk7XG4gICAgfVxuICAgIGlmIChuZXdWYWx1ZSkge1xuICAgICAgICB2YXIgb2xkUGFyZW50ID0gbmV3VmFsdWUucGFyZW50O1xuICAgICAgICBpZiAob2xkUGFyZW50KSB7XG4gICAgICAgICAgICBvbGRQYXJlbnQuX3JlbW92ZVZpZXcobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHRleHRCYXNlLl9hZGRWaWV3KG5ld1ZhbHVlKTtcbiAgICAgICAgbmV3VmFsdWUub24odmlld18xLk9ic2VydmFibGUucHJvcGVydHlDaGFuZ2VFdmVudCwgdGV4dEJhc2UuX29uRm9ybWF0dGVkVGV4dENvbnRlbnRzQ2hhbmdlZCwgdGV4dEJhc2UpO1xuICAgIH1cbn1cbnZhciB0ZXh0QWxpZ25tZW50Q29udmVydGVyID0gdmlld18xLm1ha2VQYXJzZXIodmlld18xLm1ha2VWYWxpZGF0b3IoXCJpbml0aWFsXCIsIFwibGVmdFwiLCBcImNlbnRlclwiLCBcInJpZ2h0XCIpKTtcbmV4cG9ydHMudGV4dEFsaWdubWVudFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Jbmhlcml0ZWRDc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGV4dEFsaWdubWVudFwiLCBjc3NOYW1lOiBcInRleHQtYWxpZ25cIiwgZGVmYXVsdFZhbHVlOiBcImluaXRpYWxcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHRBbGlnbm1lbnRDb252ZXJ0ZXIgfSk7XG5leHBvcnRzLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5yZWdpc3Rlcih2aWV3XzEuU3R5bGUpO1xudmFyIHRleHRUcmFuc2Zvcm1Db252ZXJ0ZXIgPSB2aWV3XzEubWFrZVBhcnNlcih2aWV3XzEubWFrZVZhbGlkYXRvcihcImluaXRpYWxcIiwgXCJub25lXCIsIFwiY2FwaXRhbGl6ZVwiLCBcInVwcGVyY2FzZVwiLCBcImxvd2VyY2FzZVwiKSk7XG5leHBvcnRzLnRleHRUcmFuc2Zvcm1Qcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcInRleHRUcmFuc2Zvcm1cIiwgY3NzTmFtZTogXCJ0ZXh0LXRyYW5zZm9ybVwiLCBkZWZhdWx0VmFsdWU6IFwiaW5pdGlhbFwiLCB2YWx1ZUNvbnZlcnRlcjogdGV4dFRyYW5zZm9ybUNvbnZlcnRlciB9KTtcbmV4cG9ydHMudGV4dFRyYW5zZm9ybVByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG52YXIgd2hpdGVTcGFjZUNvbnZlcnRlciA9IHZpZXdfMS5tYWtlUGFyc2VyKHZpZXdfMS5tYWtlVmFsaWRhdG9yKFwiaW5pdGlhbFwiLCBcIm5vcm1hbFwiLCBcIm5vd3JhcFwiKSk7XG5leHBvcnRzLndoaXRlU3BhY2VQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcIndoaXRlU3BhY2VcIiwgY3NzTmFtZTogXCJ3aGl0ZS1zcGFjZVwiLCBkZWZhdWx0VmFsdWU6IFwiaW5pdGlhbFwiLCBhZmZlY3RzTGF5b3V0OiB2aWV3XzEuaXNJT1MsIHZhbHVlQ29udmVydGVyOiB3aGl0ZVNwYWNlQ29udmVydGVyIH0pO1xuZXhwb3J0cy53aGl0ZVNwYWNlUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbnZhciB0ZXh0RGVjb3JhdGlvbkNvbnZlcnRlciA9IHZpZXdfMS5tYWtlUGFyc2VyKHZpZXdfMS5tYWtlVmFsaWRhdG9yKFwibm9uZVwiLCBcInVuZGVybGluZVwiLCBcImxpbmUtdGhyb3VnaFwiLCBcInVuZGVybGluZSBsaW5lLXRocm91Z2hcIikpO1xuZXhwb3J0cy50ZXh0RGVjb3JhdGlvblByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwidGV4dERlY29yYXRpb25cIiwgY3NzTmFtZTogXCJ0ZXh0LWRlY29yYXRpb25cIiwgZGVmYXVsdFZhbHVlOiBcIm5vbmVcIiwgdmFsdWVDb252ZXJ0ZXI6IHRleHREZWNvcmF0aW9uQ29udmVydGVyIH0pO1xuZXhwb3J0cy50ZXh0RGVjb3JhdGlvblByb3BlcnR5LnJlZ2lzdGVyKHZpZXdfMS5TdHlsZSk7XG5leHBvcnRzLmxldHRlclNwYWNpbmdQcm9wZXJ0eSA9IG5ldyB2aWV3XzEuQ3NzUHJvcGVydHkoeyBuYW1lOiBcImxldHRlclNwYWNpbmdcIiwgY3NzTmFtZTogXCJsZXR0ZXItc3BhY2luZ1wiLCBkZWZhdWx0VmFsdWU6IDAsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy5sZXR0ZXJTcGFjaW5nUHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMubGluZUhlaWdodFByb3BlcnR5ID0gbmV3IHZpZXdfMS5Dc3NQcm9wZXJ0eSh7IG5hbWU6IFwibGluZUhlaWdodFwiLCBjc3NOYW1lOiBcImxpbmUtaGVpZ2h0XCIsIGFmZmVjdHNMYXlvdXQ6IHZpZXdfMS5pc0lPUywgdmFsdWVDb252ZXJ0ZXI6IGZ1bmN0aW9uICh2KSB7IHJldHVybiBwYXJzZUZsb2F0KHYpOyB9IH0pO1xuZXhwb3J0cy5saW5lSGVpZ2h0UHJvcGVydHkucmVnaXN0ZXIodmlld18xLlN0eWxlKTtcbmV4cG9ydHMucmVzZXRTeW1ib2wgPSBTeW1ib2woXCJ0ZXh0UHJvcGVydHlEZWZhdWx0XCIpO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC1iYXNlLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZvbnRfMSA9IHJlcXVpcmUoXCIuLi9zdHlsaW5nL2ZvbnRcIik7XG52YXIgdGV4dF9iYXNlX2NvbW1vbl8xID0gcmVxdWlyZShcIi4vdGV4dC1iYXNlLWNvbW1vblwiKTtcbnZhciB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uL3V0aWxzL3R5cGVzXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4vdGV4dC1iYXNlLWNvbW1vblwiKSk7XG52YXIgVGV4dEJhc2UgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUZXh0QmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRleHRfYmFzZV9jb21tb25fMS5yZXNldFN5bWJvbDtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdmFyIHJlc2V0ID0gdmFsdWUgPT09IHRleHRfYmFzZV9jb21tb25fMS5yZXNldFN5bWJvbDtcbiAgICAgICAgaWYgKCFyZXNldCAmJiB0aGlzLmZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXROYXRpdmVUZXh0KHJlc2V0KTtcbiAgICAgICAgdGhpcy5fcmVxdWVzdExheW91dE9uVGV4dENoYW5nZWQoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9ybWF0dGVkVGV4dFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dCgpO1xuICAgICAgICB0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKHRoaXMsICF2YWx1ZSA/IFwiXCIgOiB2YWx1ZS50b1N0cmluZygpKTtcbiAgICAgICAgdGhpcy5fcmVxdWVzdExheW91dE9uVGV4dENoYW5nZWQoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQnV0dG9uKSB7XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy50aXRsZUNvbG9yRm9yU3RhdGUoMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gbmF0aXZlVmlldy50ZXh0Q29sb3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuY29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBjb2xvciA9IHZhbHVlIGluc3RhbmNlb2YgdGV4dF9iYXNlX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgaWYgKG5hdGl2ZVZpZXcgaW5zdGFuY2VvZiBVSUJ1dHRvbikge1xuICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRUaXRsZUNvbG9yRm9yU3RhdGUoY29sb3IsIDApO1xuICAgICAgICAgICAgbmF0aXZlVmlldy50aXRsZUxhYmVsLnRleHRDb2xvciA9IGNvbG9yO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbmF0aXZlVmlldy50ZXh0Q29sb3IgPSBjb2xvcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS5mb250SW50ZXJuYWxQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG5hdGl2ZVZpZXcgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkO1xuICAgICAgICBuYXRpdmVWaWV3ID0gbmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQnV0dG9uID8gbmF0aXZlVmlldy50aXRsZUxhYmVsIDogbmF0aXZlVmlldztcbiAgICAgICAgcmV0dXJuIG5hdGl2ZVZpZXcuZm9udDtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEuZm9udEludGVybmFsUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICBpZiAoISh2YWx1ZSBpbnN0YW5jZW9mIGZvbnRfMS5Gb250KSB8fCAhdGhpcy5mb3JtYXR0ZWRUZXh0KSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBuYXRpdmVWaWV3ID0gbmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQnV0dG9uID8gbmF0aXZlVmlldy50aXRsZUxhYmVsIDogbmF0aXZlVmlldztcbiAgICAgICAgICAgIHZhciBmb250ID0gdmFsdWUgaW5zdGFuY2VvZiBmb250XzEuRm9udCA/IHZhbHVlLmdldFVJRm9udChuYXRpdmVWaWV3LmZvbnQpIDogdmFsdWU7XG4gICAgICAgICAgICBuYXRpdmVWaWV3LmZvbnQgPSBmb250O1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLnRleHRBbGlnbm1lbnRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHZhciBuYXRpdmVWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZDtcbiAgICAgICAgc3dpdGNoICh2YWx1ZSkge1xuICAgICAgICAgICAgY2FzZSBcImluaXRpYWxcIjpcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy50ZXh0QWxpZ25tZW50ID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJjZW50ZXJcIjpcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnRleHRBbGlnbm1lbnQgPSAxO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcInJpZ2h0XCI6XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy50ZXh0QWxpZ25tZW50ID0gMjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dCgpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlW3RleHRfYmFzZV9jb21tb25fMS50ZXh0VHJhbnNmb3JtUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXROYXRpdmVUZXh0KCk7XG4gICAgfTtcbiAgICBUZXh0QmFzZS5wcm90b3R5cGVbdGV4dF9iYXNlX2NvbW1vbl8xLmxldHRlclNwYWNpbmdQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3NldE5hdGl2ZVRleHQoKTtcbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZVt0ZXh0X2Jhc2VfY29tbW9uXzEubGluZUhlaWdodFByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fc2V0TmF0aXZlVGV4dCgpO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlLl9zZXROYXRpdmVUZXh0ID0gZnVuY3Rpb24gKHJlc2V0KSB7XG4gICAgICAgIGlmIChyZXNldCA9PT0gdm9pZCAwKSB7IHJlc2V0ID0gZmFsc2U7IH1cbiAgICAgICAgaWYgKHJlc2V0KSB7XG4gICAgICAgICAgICB2YXIgbmF0aXZlVmlldyA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQ7XG4gICAgICAgICAgICBpZiAobmF0aXZlVmlldyBpbnN0YW5jZW9mIFVJQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgbmF0aXZlVmlldy5zZXRBdHRyaWJ1dGVkVGl0bGVGb3JTdGF0ZShudWxsLCAwKTtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnNldFRpdGxlRm9yU3RhdGUobnVsbCwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LmF0dHJpYnV0ZWRUZXh0ID0gbnVsbDtcbiAgICAgICAgICAgICAgICBuYXRpdmVWaWV3LnRleHQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmZvcm1hdHRlZFRleHQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9ybWF0dGVkVGV4dERlY29yYXRpb25BbmRUcmFuc2Zvcm0oKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0VGV4dERlY29yYXRpb25BbmRUcmFuc2Zvcm0oKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlLnNldEZvcm1hdHRlZFRleHREZWNvcmF0aW9uQW5kVHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXR0clRleHQgPSB0aGlzLmNyZWF0ZU5TTXV0YWJsZUF0dHJpYnV0ZWRTdHJpbmcodGhpcy5mb3JtYXR0ZWRUZXh0KTtcbiAgICAgICAgaWYgKHRoaXMubGV0dGVyU3BhY2luZyAhPT0gMCkge1xuICAgICAgICAgICAgYXR0clRleHQuYWRkQXR0cmlidXRlVmFsdWVSYW5nZShOU0tlcm5BdHRyaWJ1dGVOYW1lLCB0aGlzLmxldHRlclNwYWNpbmcgKiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmZvbnQucG9pbnRTaXplLCB7IGxvY2F0aW9uOiAwLCBsZW5ndGg6IGF0dHJUZXh0Lmxlbmd0aCB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdHlsZS5saW5lSGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgcGFyYWdyYXBoU3R5bGUgPSBOU011dGFibGVQYXJhZ3JhcGhTdHlsZS5hbGxvYygpLmluaXQoKTtcbiAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmxpbmVTcGFjaW5nID0gdGhpcy5saW5lSGVpZ2h0O1xuICAgICAgICAgICAgcGFyYWdyYXBoU3R5bGUuYWxpZ25tZW50ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0QWxpZ25tZW50O1xuICAgICAgICAgICAgaWYgKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQgaW5zdGFuY2VvZiBVSUxhYmVsKSB7XG4gICAgICAgICAgICAgICAgcGFyYWdyYXBoU3R5bGUubGluZUJyZWFrTW9kZSA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQubGluZUJyZWFrTW9kZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGF0dHJUZXh0LmFkZEF0dHJpYnV0ZVZhbHVlUmFuZ2UoTlNQYXJhZ3JhcGhTdHlsZUF0dHJpYnV0ZU5hbWUsIHBhcmFncmFwaFN0eWxlLCB7IGxvY2F0aW9uOiAwLCBsZW5ndGg6IGF0dHJUZXh0Lmxlbmd0aCB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlUZXh0Vmlldykge1xuICAgICAgICAgICAgdmFyIHBhcmFncmFwaFN0eWxlID0gTlNNdXRhYmxlUGFyYWdyYXBoU3R5bGUuYWxsb2MoKS5pbml0KCk7XG4gICAgICAgICAgICBwYXJhZ3JhcGhTdHlsZS5hbGlnbm1lbnQgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRBbGlnbm1lbnQ7XG4gICAgICAgICAgICBhdHRyVGV4dC5hZGRBdHRyaWJ1dGVWYWx1ZVJhbmdlKE5TUGFyYWdyYXBoU3R5bGVBdHRyaWJ1dGVOYW1lLCBwYXJhZ3JhcGhTdHlsZSwgeyBsb2NhdGlvbjogMCwgbGVuZ3RoOiBhdHRyVGV4dC5sZW5ndGggfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQgaW5zdGFuY2VvZiBVSUJ1dHRvbikge1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRBdHRyaWJ1dGVkVGl0bGVGb3JTdGF0ZShhdHRyVGV4dCwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmF0dHJpYnV0ZWRUZXh0ID0gYXR0clRleHQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5zZXRUZXh0RGVjb3JhdGlvbkFuZFRyYW5zZm9ybSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0eWxlID0gdGhpcy5zdHlsZTtcbiAgICAgICAgdmFyIGRpY3QgPSBuZXcgTWFwKCk7XG4gICAgICAgIHN3aXRjaCAoc3R5bGUudGV4dERlY29yYXRpb24pIHtcbiAgICAgICAgICAgIGNhc2UgXCJub25lXCI6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidW5kZXJsaW5lXCI6XG4gICAgICAgICAgICAgICAgZGljdC5zZXQoTlNVbmRlcmxpbmVTdHlsZUF0dHJpYnV0ZU5hbWUsIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImxpbmUtdGhyb3VnaFwiOlxuICAgICAgICAgICAgICAgIGRpY3Quc2V0KE5TU3RyaWtldGhyb3VnaFN0eWxlQXR0cmlidXRlTmFtZSwgMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwidW5kZXJsaW5lIGxpbmUtdGhyb3VnaFwiOlxuICAgICAgICAgICAgICAgIGRpY3Quc2V0KE5TVW5kZXJsaW5lU3R5bGVBdHRyaWJ1dGVOYW1lLCAxKTtcbiAgICAgICAgICAgICAgICBkaWN0LnNldChOU1N0cmlrZXRocm91Z2hTdHlsZUF0dHJpYnV0ZU5hbWUsIDEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHRleHQgZGVjb3JhdGlvbiB2YWx1ZTogXCIgKyBzdHlsZS50ZXh0RGVjb3JhdGlvbiArIFwiLiBWYWxpZCB2YWx1ZXMgYXJlOiAnbm9uZScsICd1bmRlcmxpbmUnLCAnbGluZS10aHJvdWdoJywgJ3VuZGVybGluZSBsaW5lLXRocm91Z2gnLlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3R5bGUubGV0dGVyU3BhY2luZyAhPT0gMCkge1xuICAgICAgICAgICAgZGljdC5zZXQoTlNLZXJuQXR0cmlidXRlTmFtZSwgc3R5bGUubGV0dGVyU3BhY2luZyAqIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuZm9udC5wb2ludFNpemUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpc1RleHRWaWV3ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJVGV4dFZpZXc7XG4gICAgICAgIGlmIChzdHlsZS5saW5lSGVpZ2h0KSB7XG4gICAgICAgICAgICB2YXIgcGFyYWdyYXBoU3R5bGUgPSBOU011dGFibGVQYXJhZ3JhcGhTdHlsZS5hbGxvYygpLmluaXQoKTtcbiAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmxpbmVTcGFjaW5nID0gc3R5bGUubGluZUhlaWdodDtcbiAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmFsaWdubWVudCA9IHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dEFsaWdubWVudDtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlMYWJlbCkge1xuICAgICAgICAgICAgICAgIHBhcmFncmFwaFN0eWxlLmxpbmVCcmVha01vZGUgPSB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmxpbmVCcmVha01vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkaWN0LnNldChOU1BhcmFncmFwaFN0eWxlQXR0cmlidXRlTmFtZSwgcGFyYWdyYXBoU3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKGlzVGV4dFZpZXcpIHtcbiAgICAgICAgICAgIHZhciBwYXJhZ3JhcGhTdHlsZSA9IE5TTXV0YWJsZVBhcmFncmFwaFN0eWxlLmFsbG9jKCkuaW5pdCgpO1xuICAgICAgICAgICAgcGFyYWdyYXBoU3R5bGUuYWxpZ25tZW50ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50ZXh0QWxpZ25tZW50O1xuICAgICAgICAgICAgZGljdC5zZXQoTlNQYXJhZ3JhcGhTdHlsZUF0dHJpYnV0ZU5hbWUsIHBhcmFncmFwaFN0eWxlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3R5bGUuY29sb3IgJiYgKGRpY3Quc2l6ZSA+IDAgfHwgaXNUZXh0VmlldykpIHtcbiAgICAgICAgICAgIGRpY3Quc2V0KE5TRm9yZWdyb3VuZENvbG9yQXR0cmlidXRlTmFtZSwgc3R5bGUuY29sb3IuaW9zKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgdGV4dCA9IHRoaXMudGV4dDtcbiAgICAgICAgdmFyIHN0cmluZyA9ICh0ZXh0ID09PSB1bmRlZmluZWQgfHwgdGV4dCA9PT0gbnVsbCkgPyBcIlwiIDogdGV4dC50b1N0cmluZygpO1xuICAgICAgICB2YXIgc291cmNlID0gZ2V0VHJhbnNmb3JtZWRUZXh0KHN0cmluZywgdGhpcy50ZXh0VHJhbnNmb3JtKTtcbiAgICAgICAgaWYgKGRpY3Quc2l6ZSA+IDAgfHwgaXNUZXh0Vmlldykge1xuICAgICAgICAgICAgaWYgKGlzVGV4dFZpZXcpIHtcbiAgICAgICAgICAgICAgICBkaWN0LnNldChOU0ZvbnRBdHRyaWJ1dGVOYW1lLCB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLmZvbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IE5TTXV0YWJsZUF0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0V2l0aFN0cmluZyhzb3VyY2UpO1xuICAgICAgICAgICAgcmVzdWx0LnNldEF0dHJpYnV0ZXNSYW5nZShkaWN0LCB7IGxvY2F0aW9uOiAwLCBsZW5ndGg6IHNvdXJjZS5sZW5ndGggfSk7XG4gICAgICAgICAgICBpZiAodGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZCBpbnN0YW5jZW9mIFVJQnV0dG9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZXRBdHRyaWJ1dGVkVGl0bGVGb3JTdGF0ZShyZXN1bHQsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdHRyaWJ1dGVkVGV4dCA9IHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkIGluc3RhbmNlb2YgVUlCdXR0b24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnNldEF0dHJpYnV0ZWRUaXRsZUZvclN0YXRlKG51bGwsIDApO1xuICAgICAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2V0VGl0bGVGb3JTdGF0ZShzb3VyY2UsIDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdHRyaWJ1dGVkVGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHQgPSBzb3VyY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRCYXNlLnByb3RvdHlwZS5jcmVhdGVOU011dGFibGVBdHRyaWJ1dGVkU3RyaW5nID0gZnVuY3Rpb24gKGZvcm1hdHRlZFN0cmluZykge1xuICAgICAgICB2YXIgbWFzID0gTlNNdXRhYmxlQXR0cmlidXRlZFN0cmluZy5hbGxvYygpLmluaXQoKTtcbiAgICAgICAgaWYgKGZvcm1hdHRlZFN0cmluZyAmJiBmb3JtYXR0ZWRTdHJpbmcucGFyZW50KSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgc3BhblN0YXJ0ID0gMCwgbGVuZ3RoXzEgPSBmb3JtYXR0ZWRTdHJpbmcuc3BhbnMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzcGFuID0gZm9ybWF0dGVkU3RyaW5nLnNwYW5zLmdldEl0ZW0oaSk7XG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSBzcGFuLnRleHQ7XG4gICAgICAgICAgICAgICAgdmFyIHRleHRUcmFuc2Zvcm0gPSBmb3JtYXR0ZWRTdHJpbmcucGFyZW50LnRleHRUcmFuc2Zvcm07XG4gICAgICAgICAgICAgICAgdmFyIHNwYW5UZXh0ID0gKHRleHQgPT09IG51bGwgfHwgdGV4dCA9PT0gdW5kZWZpbmVkKSA/IFwiXCIgOiB0ZXh0LnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRUcmFuc2Zvcm0gIT09IFwibm9uZVwiICYmIHRleHRUcmFuc2Zvcm0gIT09IFwiaW5pdGlhbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwYW5UZXh0ID0gZ2V0VHJhbnNmb3JtZWRUZXh0KHNwYW5UZXh0LCB0ZXh0VHJhbnNmb3JtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIG5zQXR0cmlidXRlZFN0cmluZyA9IHRoaXMuY3JlYXRlTXV0YWJsZVN0cmluZ0ZvclNwYW4oc3Bhbiwgc3BhblRleHQpO1xuICAgICAgICAgICAgICAgIG1hcy5pbnNlcnRBdHRyaWJ1dGVkU3RyaW5nQXRJbmRleChuc0F0dHJpYnV0ZWRTdHJpbmcsIHNwYW5TdGFydCk7XG4gICAgICAgICAgICAgICAgc3BhblN0YXJ0ICs9IHNwYW5UZXh0Lmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWFzO1xuICAgIH07XG4gICAgVGV4dEJhc2UucHJvdG90eXBlLmNyZWF0ZU11dGFibGVTdHJpbmdGb3JTcGFuID0gZnVuY3Rpb24gKHNwYW4sIHRleHQpIHtcbiAgICAgICAgdmFyIHZpZXdGb250ID0gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5mb250O1xuICAgICAgICB2YXIgYXR0ckRpY3QgPSB7fTtcbiAgICAgICAgdmFyIHN0eWxlID0gc3Bhbi5zdHlsZTtcbiAgICAgICAgdmFyIGJvbGQgPSB0ZXh0X2Jhc2VfY29tbW9uXzEuaXNCb2xkKHN0eWxlLmZvbnRXZWlnaHQpO1xuICAgICAgICB2YXIgaXRhbGljID0gc3R5bGUuZm9udFN0eWxlID09PSBcIml0YWxpY1wiO1xuICAgICAgICB2YXIgZm9udEZhbWlseSA9IHNwYW4uZm9udEZhbWlseTtcbiAgICAgICAgdmFyIGZvbnRTaXplID0gc3Bhbi5mb250U2l6ZTtcbiAgICAgICAgaWYgKGJvbGQgfHwgaXRhbGljIHx8IGZvbnRGYW1pbHkgfHwgZm9udFNpemUpIHtcbiAgICAgICAgICAgIHZhciBmb250ID0gbmV3IGZvbnRfMS5Gb250KHN0eWxlLmZvbnRGYW1pbHksIHN0eWxlLmZvbnRTaXplLCBzdHlsZS5mb250U3R5bGUsIHN0eWxlLmZvbnRXZWlnaHQpO1xuICAgICAgICAgICAgdmFyIGlvc0ZvbnQgPSBmb250LmdldFVJRm9udCh2aWV3Rm9udCk7XG4gICAgICAgICAgICBhdHRyRGljdFtOU0ZvbnRBdHRyaWJ1dGVOYW1lXSA9IGlvc0ZvbnQ7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNvbG9yID0gc3Bhbi5jb2xvcjtcbiAgICAgICAgaWYgKGNvbG9yKSB7XG4gICAgICAgICAgICBhdHRyRGljdFtOU0ZvcmVncm91bmRDb2xvckF0dHJpYnV0ZU5hbWVdID0gY29sb3IuaW9zO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kQ29sb3IgPSAoc3R5bGUuYmFja2dyb3VuZENvbG9yXG4gICAgICAgICAgICB8fCBzcGFuLnBhcmVudC5iYWNrZ3JvdW5kQ29sb3JcbiAgICAgICAgICAgIHx8IHNwYW4ucGFyZW50LnBhcmVudC5iYWNrZ3JvdW5kQ29sb3IpO1xuICAgICAgICBpZiAoYmFja2dyb3VuZENvbG9yKSB7XG4gICAgICAgICAgICBhdHRyRGljdFtOU0JhY2tncm91bmRDb2xvckF0dHJpYnV0ZU5hbWVdID0gYmFja2dyb3VuZENvbG9yLmlvcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgdmFsdWVTb3VyY2U7XG4gICAgICAgIGlmICh0ZXh0X2Jhc2VfY29tbW9uXzEudGV4dERlY29yYXRpb25Qcm9wZXJ0eS5pc1NldChzdHlsZSkpIHtcbiAgICAgICAgICAgIHZhbHVlU291cmNlID0gc3R5bGU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGV4dF9iYXNlX2NvbW1vbl8xLnRleHREZWNvcmF0aW9uUHJvcGVydHkuaXNTZXQoc3Bhbi5wYXJlbnQuc3R5bGUpKSB7XG4gICAgICAgICAgICB2YWx1ZVNvdXJjZSA9IHNwYW4ucGFyZW50LnN0eWxlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRleHRfYmFzZV9jb21tb25fMS50ZXh0RGVjb3JhdGlvblByb3BlcnR5LmlzU2V0KHNwYW4ucGFyZW50LnBhcmVudC5zdHlsZSkpIHtcbiAgICAgICAgICAgIHZhbHVlU291cmNlID0gc3Bhbi5wYXJlbnQucGFyZW50LnN0eWxlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZVNvdXJjZSkge1xuICAgICAgICAgICAgdmFyIHRleHREZWNvcmF0aW9ucyA9IHZhbHVlU291cmNlLnRleHREZWNvcmF0aW9uO1xuICAgICAgICAgICAgdmFyIHVuZGVybGluZV8xID0gdGV4dERlY29yYXRpb25zLmluZGV4T2YoXCJ1bmRlcmxpbmVcIikgIT09IC0xO1xuICAgICAgICAgICAgaWYgKHVuZGVybGluZV8xKSB7XG4gICAgICAgICAgICAgICAgYXR0ckRpY3RbTlNVbmRlcmxpbmVTdHlsZUF0dHJpYnV0ZU5hbWVdID0gdW5kZXJsaW5lXzE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgc3RyaWtldGhyb3VnaCA9IHRleHREZWNvcmF0aW9ucy5pbmRleE9mKFwibGluZS10aHJvdWdoXCIpICE9PSAtMTtcbiAgICAgICAgICAgIGlmIChzdHJpa2V0aHJvdWdoKSB7XG4gICAgICAgICAgICAgICAgYXR0ckRpY3RbTlNTdHJpa2V0aHJvdWdoU3R5bGVBdHRyaWJ1dGVOYW1lXSA9IHN0cmlrZXRocm91Z2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE5TTXV0YWJsZUF0dHJpYnV0ZWRTdHJpbmcuYWxsb2MoKS5pbml0V2l0aFN0cmluZ0F0dHJpYnV0ZXModGV4dCwgYXR0ckRpY3QpO1xuICAgIH07XG4gICAgcmV0dXJuIFRleHRCYXNlO1xufSh0ZXh0X2Jhc2VfY29tbW9uXzEuVGV4dEJhc2VDb21tb24pKTtcbmV4cG9ydHMuVGV4dEJhc2UgPSBUZXh0QmFzZTtcbmZ1bmN0aW9uIGdldFRyYW5zZm9ybWVkVGV4dCh0ZXh0LCB0ZXh0VHJhbnNmb3JtKSB7XG4gICAgaWYgKCF0ZXh0IHx8ICF0eXBlc18xLmlzU3RyaW5nKHRleHQpKSB7XG4gICAgICAgIHJldHVybiBcIlwiO1xuICAgIH1cbiAgICBzd2l0Y2ggKHRleHRUcmFuc2Zvcm0pIHtcbiAgICAgICAgY2FzZSBcInVwcGVyY2FzZVwiOlxuICAgICAgICAgICAgcmV0dXJuIE5TU3RyaW5nRnJvbU5TQXR0cmlidXRlZFN0cmluZyh0ZXh0KS51cHBlcmNhc2VTdHJpbmc7XG4gICAgICAgIGNhc2UgXCJsb3dlcmNhc2VcIjpcbiAgICAgICAgICAgIHJldHVybiBOU1N0cmluZ0Zyb21OU0F0dHJpYnV0ZWRTdHJpbmcodGV4dCkubG93ZXJjYXNlU3RyaW5nO1xuICAgICAgICBjYXNlIFwiY2FwaXRhbGl6ZVwiOlxuICAgICAgICAgICAgcmV0dXJuIE5TU3RyaW5nRnJvbU5TQXR0cmlidXRlZFN0cmluZyh0ZXh0KS5jYXBpdGFsaXplZFN0cmluZztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgIH1cbn1cbmV4cG9ydHMuZ2V0VHJhbnNmb3JtZWRUZXh0ID0gZ2V0VHJhbnNmb3JtZWRUZXh0O1xuZnVuY3Rpb24gTlNTdHJpbmdGcm9tTlNBdHRyaWJ1dGVkU3RyaW5nKHNvdXJjZSkge1xuICAgIHJldHVybiBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKHNvdXJjZSBpbnN0YW5jZW9mIE5TQXR0cmlidXRlZFN0cmluZyAmJiBzb3VyY2Uuc3RyaW5nIHx8IHNvdXJjZSk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWJhc2UuaW9zLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgZWRpdGFibGVfdGV4dF9iYXNlXzEgPSByZXF1aXJlKFwiLi4vZWRpdGFibGUtdGV4dC1iYXNlXCIpO1xuX19leHBvcnQocmVxdWlyZShcIi4uL2VkaXRhYmxlLXRleHQtYmFzZVwiKSk7XG52YXIgVGV4dEZpZWxkQmFzZSA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFRleHRGaWVsZEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dEZpZWxkQmFzZSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBUZXh0RmllbGRCYXNlLnJldHVyblByZXNzRXZlbnQgPSBcInJldHVyblByZXNzXCI7XG4gICAgVGV4dEZpZWxkQmFzZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBlZGl0YWJsZV90ZXh0X2Jhc2VfMS5DU1NUeXBlKFwiVGV4dEZpZWxkXCIpXG4gICAgXSwgVGV4dEZpZWxkQmFzZSk7XG4gICAgcmV0dXJuIFRleHRGaWVsZEJhc2U7XG59KGVkaXRhYmxlX3RleHRfYmFzZV8xLkVkaXRhYmxlVGV4dEJhc2UpKTtcbmV4cG9ydHMuVGV4dEZpZWxkQmFzZSA9IFRleHRGaWVsZEJhc2U7XG5UZXh0RmllbGRCYXNlLnByb3RvdHlwZS5yZWN5Y2xlTmF0aXZlVmlldyA9IFwiYXV0b1wiO1xuZXhwb3J0cy5zZWN1cmVQcm9wZXJ0eSA9IG5ldyBlZGl0YWJsZV90ZXh0X2Jhc2VfMS5Qcm9wZXJ0eSh7IG5hbWU6IFwic2VjdXJlXCIsIGRlZmF1bHRWYWx1ZTogZmFsc2UsIHZhbHVlQ29udmVydGVyOiBlZGl0YWJsZV90ZXh0X2Jhc2VfMS5ib29sZWFuQ29udmVydGVyIH0pO1xuZXhwb3J0cy5zZWN1cmVQcm9wZXJ0eS5yZWdpc3RlcihUZXh0RmllbGRCYXNlKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRleHQtZmllbGQtY29tbW9uLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdGV4dF9maWVsZF9jb21tb25fMSA9IHJlcXVpcmUoXCIuL3RleHQtZmllbGQtY29tbW9uXCIpO1xudmFyIHByb2ZpbGluZ18xID0gcmVxdWlyZShcIi4uLy4uL3Byb2ZpbGluZ1wiKTtcbl9fZXhwb3J0KHJlcXVpcmUoXCIuL3RleHQtZmllbGQtY29tbW9uXCIpKTtcbnZhciB6ZXJvTGVuZ3RoID0ge1xuICAgIHZhbHVlOiAwLFxuICAgIHVuaXQ6IFwicHhcIlxufTtcbnZhciBVSVRleHRGaWVsZERlbGVnYXRlSW1wbCA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLmluaXRXaXRoT3duZXIgPSBmdW5jdGlvbiAob3duZXIpIHtcbiAgICAgICAgdmFyIGRlbGVnYXRlID0gVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwubmV3KCk7XG4gICAgICAgIGRlbGVnYXRlLl9vd25lciA9IG93bmVyO1xuICAgICAgICByZXR1cm4gZGVsZWdhdGU7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dEZpZWxkU2hvdWxkQmVnaW5FZGl0aW5nID0gZnVuY3Rpb24gKHRleHRGaWVsZCkge1xuICAgICAgICB0aGlzLmZpcnN0RWRpdCA9IHRydWU7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBvd25lci5lZGl0YWJsZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLnByb3RvdHlwZS50ZXh0RmllbGREaWRCZWdpbkVkaXRpbmcgPSBmdW5jdGlvbiAodGV4dEZpZWxkKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogVGV4dEZpZWxkLmZvY3VzRXZlbnQsIG9iamVjdDogb3duZXIgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLnByb3RvdHlwZS50ZXh0RmllbGREaWRFbmRFZGl0aW5nID0gZnVuY3Rpb24gKHRleHRGaWVsZCkge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICBpZiAob3duZXIudXBkYXRlVGV4dFRyaWdnZXIgPT09IFwiZm9jdXNMb3N0XCIpIHtcbiAgICAgICAgICAgICAgICB0ZXh0X2ZpZWxkX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgdGV4dEZpZWxkLnRleHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3duZXIuZGlzbWlzc1NvZnRJbnB1dCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dEZpZWxkU2hvdWxkQ2xlYXIgPSBmdW5jdGlvbiAodGV4dEZpZWxkKSB7XG4gICAgICAgIHRoaXMuZmlyc3RFZGl0ID0gZmFsc2U7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIHRleHRfZmllbGRfY29tbW9uXzEudGV4dFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCBcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFVJVGV4dEZpZWxkRGVsZWdhdGVJbXBsLnByb3RvdHlwZS50ZXh0RmllbGRTaG91bGRSZXR1cm4gPSBmdW5jdGlvbiAodGV4dEZpZWxkKSB7XG4gICAgICAgIHZhciBvd25lciA9IHRoaXMuX293bmVyLmdldCgpO1xuICAgICAgICBpZiAob3duZXIpIHtcbiAgICAgICAgICAgIG93bmVyLmRpc21pc3NTb2Z0SW5wdXQoKTtcbiAgICAgICAgICAgIG93bmVyLm5vdGlmeSh7IGV2ZW50TmFtZTogVGV4dEZpZWxkLnJldHVyblByZXNzRXZlbnQsIG9iamVjdDogb3duZXIgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5wcm90b3R5cGUudGV4dEZpZWxkU2hvdWxkQ2hhbmdlQ2hhcmFjdGVyc0luUmFuZ2VSZXBsYWNlbWVudFN0cmluZyA9IGZ1bmN0aW9uICh0ZXh0RmllbGQsIHJhbmdlLCByZXBsYWNlbWVudFN0cmluZykge1xuICAgICAgICB2YXIgb3duZXIgPSB0aGlzLl9vd25lci5nZXQoKTtcbiAgICAgICAgaWYgKG93bmVyKSB7XG4gICAgICAgICAgICB2YXIgZGVsdGEgPSByZXBsYWNlbWVudFN0cmluZy5sZW5ndGggLSByYW5nZS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoZGVsdGEgPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRleHRGaWVsZC50ZXh0Lmxlbmd0aCArIGRlbHRhID4gb3duZXIubWF4TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3duZXIudXBkYXRlVGV4dFRyaWdnZXIgPT09IFwidGV4dENoYW5nZWRcIikge1xuICAgICAgICAgICAgICAgIGlmICh0ZXh0RmllbGQuc2VjdXJlVGV4dEVudHJ5ICYmIHRoaXMuZmlyc3RFZGl0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHRfZmllbGRfY29tbW9uXzEudGV4dFByb3BlcnR5Lm5hdGl2ZVZhbHVlQ2hhbmdlKG93bmVyLCByZXBsYWNlbWVudFN0cmluZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmFuZ2UubG9jYXRpb24gPD0gdGV4dEZpZWxkLnRleHQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VGV4dCA9IE5TU3RyaW5nLnN0cmluZ1dpdGhTdHJpbmcodGV4dEZpZWxkLnRleHQpLnN0cmluZ0J5UmVwbGFjaW5nQ2hhcmFjdGVyc0luUmFuZ2VXaXRoU3RyaW5nKHJhbmdlLCByZXBsYWNlbWVudFN0cmluZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0X2ZpZWxkX2NvbW1vbl8xLnRleHRQcm9wZXJ0eS5uYXRpdmVWYWx1ZUNoYW5nZShvd25lciwgbmV3VGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAob3duZXIuZm9ybWF0dGVkVGV4dCkge1xuICAgICAgICAgICAgICAgIHRleHRfZmllbGRfY29tbW9uXzEuX3VwZGF0ZUNoYXJhY3RlcnNJblJhbmdlUmVwbGFjZW1lbnRTdHJpbmcob3duZXIuZm9ybWF0dGVkVGV4dCwgcmFuZ2UubG9jYXRpb24sIHJhbmdlLmxlbmd0aCwgcmVwbGFjZW1lbnRTdHJpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZmlyc3RFZGl0ID0gZmFsc2U7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgVUlUZXh0RmllbGREZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSVRleHRGaWVsZERlbGVnYXRlXTtcbiAgICByZXR1cm4gVUlUZXh0RmllbGREZWxlZ2F0ZUltcGw7XG59KE5TT2JqZWN0KSk7XG52YXIgVUlUZXh0RmllbGRJbXBsID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoVUlUZXh0RmllbGRJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJVGV4dEZpZWxkSW1wbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBVSVRleHRGaWVsZEltcGwuaW5pdFdpdGhPd25lciA9IGZ1bmN0aW9uIChvd25lcikge1xuICAgICAgICB2YXIgaGFuZGxlciA9IFVJVGV4dEZpZWxkSW1wbC5uZXcoKTtcbiAgICAgICAgaGFuZGxlci5fb3duZXIgPSBvd25lcjtcbiAgICAgICAgcmV0dXJuIGhhbmRsZXI7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZEltcGwucHJvdG90eXBlLl9nZXRUZXh0UmVjdEZvckJvdW5kcyA9IGZ1bmN0aW9uIChib3VuZHMpIHtcbiAgICAgICAgdmFyIG93bmVyID0gdGhpcy5fb3duZXIgPyB0aGlzLl9vd25lci5nZXQoKSA6IG51bGw7XG4gICAgICAgIGlmICghb3duZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBib3VuZHM7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHNpemUgPSBib3VuZHMuc2l6ZTtcbiAgICAgICAgdmFyIHggPSB0ZXh0X2ZpZWxkX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG93bmVyLmVmZmVjdGl2ZUJvcmRlckxlZnRXaWR0aCArIG93bmVyLmVmZmVjdGl2ZVBhZGRpbmdMZWZ0KTtcbiAgICAgICAgdmFyIHkgPSB0ZXh0X2ZpZWxkX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKG93bmVyLmVmZmVjdGl2ZUJvcmRlclRvcFdpZHRoICsgb3duZXIuZWZmZWN0aXZlUGFkZGluZ1RvcCk7XG4gICAgICAgIHZhciB3aWR0aCA9IHRleHRfZmllbGRfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHModGV4dF9maWVsZF9jb21tb25fMS5sYXlvdXQudG9EZXZpY2VQaXhlbHMoc2l6ZS53aWR0aCkgLSAob3duZXIuZWZmZWN0aXZlQm9yZGVyTGVmdFdpZHRoICsgb3duZXIuZWZmZWN0aXZlUGFkZGluZ0xlZnQgKyBvd25lci5lZmZlY3RpdmVQYWRkaW5nUmlnaHQgKyBvd25lci5lZmZlY3RpdmVCb3JkZXJSaWdodFdpZHRoKSk7XG4gICAgICAgIHZhciBoZWlnaHQgPSB0ZXh0X2ZpZWxkX2NvbW1vbl8xLmxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHRleHRfZmllbGRfY29tbW9uXzEubGF5b3V0LnRvRGV2aWNlUGl4ZWxzKHNpemUuaGVpZ2h0KSAtIChvd25lci5lZmZlY3RpdmVCb3JkZXJUb3BXaWR0aCArIG93bmVyLmVmZmVjdGl2ZVBhZGRpbmdUb3AgKyBvd25lci5lZmZlY3RpdmVQYWRkaW5nQm90dG9tICsgb3duZXIuZWZmZWN0aXZlQm9yZGVyQm90dG9tV2lkdGgpKTtcbiAgICAgICAgcmV0dXJuIENHUmVjdE1ha2UoeCwgeSwgd2lkdGgsIGhlaWdodCk7XG4gICAgfTtcbiAgICBVSVRleHRGaWVsZEltcGwucHJvdG90eXBlLnRleHRSZWN0Rm9yQm91bmRzID0gZnVuY3Rpb24gKGJvdW5kcykge1xuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0VGV4dFJlY3RGb3JCb3VuZHMoYm91bmRzKTtcbiAgICB9O1xuICAgIFVJVGV4dEZpZWxkSW1wbC5wcm90b3R5cGUuZWRpdGluZ1JlY3RGb3JCb3VuZHMgPSBmdW5jdGlvbiAoYm91bmRzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRUZXh0UmVjdEZvckJvdW5kcyhib3VuZHMpO1xuICAgIH07XG4gICAgcmV0dXJuIFVJVGV4dEZpZWxkSW1wbDtcbn0oVUlUZXh0RmllbGQpKTtcbnZhciBUZXh0RmllbGQgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhUZXh0RmllbGQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGV4dEZpZWxkKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFRleHRGaWVsZC5wcm90b3R5cGUuY3JlYXRlTmF0aXZlVmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFVJVGV4dEZpZWxkSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuaW5pdE5hdGl2ZVZpZXcuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5fZGVsZWdhdGUgPSBVSVRleHRGaWVsZERlbGVnYXRlSW1wbC5pbml0V2l0aE93bmVyKG5ldyBXZWFrUmVmKHRoaXMpKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGUuZGlzcG9zZU5hdGl2ZVZpZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2RlbGVnYXRlID0gbnVsbDtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5kaXNwb3NlTmF0aXZlVmlldy5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZS5vbkxvYWRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5vbkxvYWRlZC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLmlvcy5kZWxlZ2F0ZSA9IHRoaXMuX2RlbGVnYXRlO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZS5vblVubG9hZGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmlvcy5kZWxlZ2F0ZSA9IG51bGw7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUub25VbmxvYWRlZC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRleHRGaWVsZC5wcm90b3R5cGUsIFwiaW9zXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVWaWV3UHJvdGVjdGVkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEuaGludFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5wbGFjZWhvbGRlcjtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5oaW50UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLl91cGRhdGVBdHRyaWJ1dGVkUGxhY2Vob2xkZXIoKTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5zZWN1cmVQcm9wZXJ0eS5nZXREZWZhdWx0XSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQuc2VjdXJlVGV4dEVudHJ5O1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnNlY3VyZVByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5zZWN1cmVUZXh0RW50cnkgPSB2YWx1ZTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5jb2xvclByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdGV4dENvbG9yOiB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb2xvcixcbiAgICAgICAgICAgIHRpbnRDb2xvcjogdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50aW50Q29sb3JcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5jb2xvclByb3BlcnR5LnNldE5hdGl2ZV0gPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgdGV4dF9maWVsZF9jb21tb25fMS5Db2xvcikge1xuICAgICAgICAgICAgdmFyIGNvbG9yID0gdmFsdWUgaW5zdGFuY2VvZiB0ZXh0X2ZpZWxkX2NvbW1vbl8xLkNvbG9yID8gdmFsdWUuaW9zIDogdmFsdWU7XG4gICAgICAgICAgICB0aGlzLm5hdGl2ZVRleHRWaWV3UHJvdGVjdGVkLnRleHRDb2xvciA9IGNvbG9yO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50aW50Q29sb3IgPSBjb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMubmF0aXZlVGV4dFZpZXdQcm90ZWN0ZWQudGV4dENvbG9yID0gdmFsdWUudGV4dENvbG9yO1xuICAgICAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC50aW50Q29sb3IgPSB2YWx1ZS50aW50Q29sb3I7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wbGFjZWhvbGRlckNvbG9yUHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnBsYWNlaG9sZGVyQ29sb3JQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3VwZGF0ZUF0dHJpYnV0ZWRQbGFjZWhvbGRlcigpO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZS5fdXBkYXRlQXR0cmlidXRlZFBsYWNlaG9sZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3RyaW5nVmFsdWUgPSB0aGlzLmhpbnQ7XG4gICAgICAgIGlmIChzdHJpbmdWYWx1ZSA9PT0gbnVsbCB8fCBzdHJpbmdWYWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZSA9IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZSA9IHN0cmluZ1ZhbHVlICsgXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyaW5nVmFsdWUgPT09IFwiXCIpIHtcbiAgICAgICAgICAgIHN0cmluZ1ZhbHVlID0gXCIgXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSB7fTtcbiAgICAgICAgaWYgKHRoaXMuc3R5bGUucGxhY2Vob2xkZXJDb2xvcikge1xuICAgICAgICAgICAgYXR0cmlidXRlc1tOU0ZvcmVncm91bmRDb2xvckF0dHJpYnV0ZU5hbWVdID0gdGhpcy5zdHlsZS5wbGFjZWhvbGRlckNvbG9yLmlvcztcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXR0cmlidXRlZFBsYWNlaG9sZGVyID0gTlNBdHRyaWJ1dGVkU3RyaW5nLmFsbG9jKCkuaW5pdFdpdGhTdHJpbmdBdHRyaWJ1dGVzKHN0cmluZ1ZhbHVlLCBhdHRyaWJ1dGVzKTtcbiAgICAgICAgdGhpcy5uYXRpdmVUZXh0Vmlld1Byb3RlY3RlZC5hdHRyaWJ1dGVkUGxhY2Vob2xkZXIgPSBhdHRyaWJ1dGVkUGxhY2Vob2xkZXI7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEucGFkZGluZ1RvcFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gemVyb0xlbmd0aDtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wYWRkaW5nVG9wUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnBhZGRpbmdSaWdodFByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gemVyb0xlbmd0aDtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wYWRkaW5nUmlnaHRQcm9wZXJ0eS5zZXROYXRpdmVdID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgfTtcbiAgICBUZXh0RmllbGQucHJvdG90eXBlW3RleHRfZmllbGRfY29tbW9uXzEucGFkZGluZ0JvdHRvbVByb3BlcnR5LmdldERlZmF1bHRdID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gemVyb0xlbmd0aDtcbiAgICB9O1xuICAgIFRleHRGaWVsZC5wcm90b3R5cGVbdGV4dF9maWVsZF9jb21tb25fMS5wYWRkaW5nQm90dG9tUHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuZ2V0RGVmYXVsdF0gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB6ZXJvTGVuZ3RoO1xuICAgIH07XG4gICAgVGV4dEZpZWxkLnByb3RvdHlwZVt0ZXh0X2ZpZWxkX2NvbW1vbl8xLnBhZGRpbmdMZWZ0UHJvcGVydHkuc2V0TmF0aXZlXSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIH07XG4gICAgX19kZWNvcmF0ZShbXG4gICAgICAgIHByb2ZpbGluZ18xLnByb2ZpbGVcbiAgICBdLCBUZXh0RmllbGQucHJvdG90eXBlLCBcIm9uTG9hZGVkXCIsIG51bGwpO1xuICAgIHJldHVybiBUZXh0RmllbGQ7XG59KHRleHRfZmllbGRfY29tbW9uXzEuVGV4dEZpZWxkQmFzZSkpO1xuZXhwb3J0cy5UZXh0RmllbGQgPSBUZXh0RmllbGQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10ZXh0LWZpZWxkLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHJhbnNpdGlvbl8xID0gcmVxdWlyZShcIi4vdHJhbnNpdGlvblwiKTtcbnZhciBGYWRlVHJhbnNpdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKEZhZGVUcmFuc2l0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEZhZGVUcmFuc2l0aW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIEZhZGVUcmFuc2l0aW9uLnByb3RvdHlwZS5hbmltYXRlSU9TVHJhbnNpdGlvbiA9IGZ1bmN0aW9uIChjb250YWluZXJWaWV3LCBmcm9tVmlldywgdG9WaWV3LCBvcGVyYXRpb24sIGNvbXBsZXRpb24pIHtcbiAgICAgICAgdmFyIG9yaWdpbmFsVG9WaWV3QWxwaGEgPSB0b1ZpZXcuYWxwaGE7XG4gICAgICAgIHZhciBvcmlnaW5hbEZyb21WaWV3QWxwaGEgPSBmcm9tVmlldy5hbHBoYTtcbiAgICAgICAgdG9WaWV3LmFscGhhID0gMC4wO1xuICAgICAgICBmcm9tVmlldy5hbHBoYSA9IDEuMDtcbiAgICAgICAgc3dpdGNoIChvcGVyYXRpb24pIHtcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBjb250YWluZXJWaWV3Lmluc2VydFN1YnZpZXdBYm92ZVN1YnZpZXcodG9WaWV3LCBmcm9tVmlldyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgY29udGFpbmVyVmlldy5pbnNlcnRTdWJ2aWV3QmVsb3dTdWJ2aWV3KHRvVmlldywgZnJvbVZpZXcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkdXJhdGlvbiA9IHRoaXMuZ2V0RHVyYXRpb24oKTtcbiAgICAgICAgdmFyIGN1cnZlID0gdGhpcy5nZXRDdXJ2ZSgpO1xuICAgICAgICBVSVZpZXcuYW5pbWF0ZVdpdGhEdXJhdGlvbkFuaW1hdGlvbnNDb21wbGV0aW9uKGR1cmF0aW9uLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBVSVZpZXcuc2V0QW5pbWF0aW9uQ3VydmUoY3VydmUpO1xuICAgICAgICAgICAgdG9WaWV3LmFscGhhID0gMS4wO1xuICAgICAgICAgICAgZnJvbVZpZXcuYWxwaGEgPSAwLjA7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChmaW5pc2hlZCkge1xuICAgICAgICAgICAgdG9WaWV3LmFscGhhID0gb3JpZ2luYWxUb1ZpZXdBbHBoYTtcbiAgICAgICAgICAgIGZyb21WaWV3LmFscGhhID0gb3JpZ2luYWxGcm9tVmlld0FscGhhO1xuICAgICAgICAgICAgY29tcGxldGlvbihmaW5pc2hlZCk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIEZhZGVUcmFuc2l0aW9uO1xufSh0cmFuc2l0aW9uXzEuVHJhbnNpdGlvbikpO1xuZXhwb3J0cy5GYWRlVHJhbnNpdGlvbiA9IEZhZGVUcmFuc2l0aW9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmFkZS10cmFuc2l0aW9uLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHJhbnNpdGlvbl8xID0gcmVxdWlyZShcIi4vdHJhbnNpdGlvblwiKTtcbnZhciBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL3BsYXRmb3JtXCIpO1xudmFyIHNjcmVlbldpZHRoID0gcGxhdGZvcm1fMS5zY3JlZW4ubWFpblNjcmVlbi53aWR0aERJUHM7XG52YXIgc2NyZWVuSGVpZ2h0ID0gcGxhdGZvcm1fMS5zY3JlZW4ubWFpblNjcmVlbi5oZWlnaHRESVBzO1xudmFyIGxlZnRFZGdlID0gQ0dBZmZpbmVUcmFuc2Zvcm1NYWtlVHJhbnNsYXRpb24oLXNjcmVlbldpZHRoLCAwKTtcbnZhciByaWdodEVkZ2UgPSBDR0FmZmluZVRyYW5zZm9ybU1ha2VUcmFuc2xhdGlvbihzY3JlZW5XaWR0aCwgMCk7XG52YXIgdG9wRWRnZSA9IENHQWZmaW5lVHJhbnNmb3JtTWFrZVRyYW5zbGF0aW9uKDAsIC1zY3JlZW5IZWlnaHQpO1xudmFyIGJvdHRvbUVkZ2UgPSBDR0FmZmluZVRyYW5zZm9ybU1ha2VUcmFuc2xhdGlvbigwLCBzY3JlZW5IZWlnaHQpO1xudmFyIFNsaWRlVHJhbnNpdGlvbiA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFNsaWRlVHJhbnNpdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTbGlkZVRyYW5zaXRpb24oZGlyZWN0aW9uLCBkdXJhdGlvbiwgY3VydmUpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZHVyYXRpb24sIGN1cnZlKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5fZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFNsaWRlVHJhbnNpdGlvbi5wcm90b3R5cGUuYW5pbWF0ZUlPU1RyYW5zaXRpb24gPSBmdW5jdGlvbiAoY29udGFpbmVyVmlldywgZnJvbVZpZXcsIHRvVmlldywgb3BlcmF0aW9uLCBjb21wbGV0aW9uKSB7XG4gICAgICAgIHZhciBvcmlnaW5hbFRvVmlld1RyYW5zZm9ybSA9IHRvVmlldy50cmFuc2Zvcm07XG4gICAgICAgIHZhciBvcmlnaW5hbEZyb21WaWV3VHJhbnNmb3JtID0gZnJvbVZpZXcudHJhbnNmb3JtO1xuICAgICAgICB2YXIgZnJvbVZpZXdFbmRUcmFuc2Zvcm07XG4gICAgICAgIHZhciB0b1ZpZXdCZWdpblRyYW5zZm9ybTtcbiAgICAgICAgdmFyIHB1c2ggPSAob3BlcmF0aW9uID09PSAxKTtcbiAgICAgICAgc3dpdGNoICh0aGlzLl9kaXJlY3Rpb24pIHtcbiAgICAgICAgICAgIGNhc2UgXCJsZWZ0XCI6XG4gICAgICAgICAgICAgICAgdG9WaWV3QmVnaW5UcmFuc2Zvcm0gPSBwdXNoID8gcmlnaHRFZGdlIDogbGVmdEVkZ2U7XG4gICAgICAgICAgICAgICAgZnJvbVZpZXdFbmRUcmFuc2Zvcm0gPSBwdXNoID8gbGVmdEVkZ2UgOiByaWdodEVkZ2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgICAgICAgICB0b1ZpZXdCZWdpblRyYW5zZm9ybSA9IHB1c2ggPyBsZWZ0RWRnZSA6IHJpZ2h0RWRnZTtcbiAgICAgICAgICAgICAgICBmcm9tVmlld0VuZFRyYW5zZm9ybSA9IHB1c2ggPyByaWdodEVkZ2UgOiBsZWZ0RWRnZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ0b3BcIjpcbiAgICAgICAgICAgICAgICB0b1ZpZXdCZWdpblRyYW5zZm9ybSA9IHB1c2ggPyBib3R0b21FZGdlIDogdG9wRWRnZTtcbiAgICAgICAgICAgICAgICBmcm9tVmlld0VuZFRyYW5zZm9ybSA9IHB1c2ggPyB0b3BFZGdlIDogYm90dG9tRWRnZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJib3R0b21cIjpcbiAgICAgICAgICAgICAgICB0b1ZpZXdCZWdpblRyYW5zZm9ybSA9IHB1c2ggPyB0b3BFZGdlIDogYm90dG9tRWRnZTtcbiAgICAgICAgICAgICAgICBmcm9tVmlld0VuZFRyYW5zZm9ybSA9IHB1c2ggPyBib3R0b21FZGdlIDogdG9wRWRnZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB0b1ZpZXcudHJhbnNmb3JtID0gdG9WaWV3QmVnaW5UcmFuc2Zvcm07XG4gICAgICAgIGZyb21WaWV3LnRyYW5zZm9ybSA9IENHQWZmaW5lVHJhbnNmb3JtSWRlbnRpdHk7XG4gICAgICAgIHN3aXRjaCAob3BlcmF0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgY29udGFpbmVyVmlldy5pbnNlcnRTdWJ2aWV3QWJvdmVTdWJ2aWV3KHRvVmlldywgZnJvbVZpZXcpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGNvbnRhaW5lclZpZXcuaW5zZXJ0U3Vidmlld0JlbG93U3Vidmlldyh0b1ZpZXcsIGZyb21WaWV3KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICB2YXIgZHVyYXRpb24gPSB0aGlzLmdldER1cmF0aW9uKCk7XG4gICAgICAgIHZhciBjdXJ2ZSA9IHRoaXMuZ2V0Q3VydmUoKTtcbiAgICAgICAgVUlWaWV3LmFuaW1hdGVXaXRoRHVyYXRpb25BbmltYXRpb25zQ29tcGxldGlvbihkdXJhdGlvbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgVUlWaWV3LnNldEFuaW1hdGlvbkN1cnZlKGN1cnZlKTtcbiAgICAgICAgICAgIHRvVmlldy50cmFuc2Zvcm0gPSBDR0FmZmluZVRyYW5zZm9ybUlkZW50aXR5O1xuICAgICAgICAgICAgZnJvbVZpZXcudHJhbnNmb3JtID0gZnJvbVZpZXdFbmRUcmFuc2Zvcm07XG4gICAgICAgIH0sIGZ1bmN0aW9uIChmaW5pc2hlZCkge1xuICAgICAgICAgICAgdG9WaWV3LnRyYW5zZm9ybSA9IG9yaWdpbmFsVG9WaWV3VHJhbnNmb3JtO1xuICAgICAgICAgICAgZnJvbVZpZXcudHJhbnNmb3JtID0gb3JpZ2luYWxGcm9tVmlld1RyYW5zZm9ybTtcbiAgICAgICAgICAgIGNvbXBsZXRpb24oZmluaXNoZWQpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTbGlkZVRyYW5zaXRpb247XG59KHRyYW5zaXRpb25fMS5UcmFuc2l0aW9uKSk7XG5leHBvcnRzLlNsaWRlVHJhbnNpdGlvbiA9IFNsaWRlVHJhbnNpdGlvbjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNsaWRlLXRyYW5zaXRpb24uaW9zLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbnZhciB0cmFuc2l0aW9uSWQgPSAwO1xudmFyIFRyYW5zaXRpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRyYW5zaXRpb24oZHVyYXRpb24sIGN1cnZlKSB7XG4gICAgICAgIGlmIChjdXJ2ZSA9PT0gdm9pZCAwKSB7IGN1cnZlID0gMDsgfVxuICAgICAgICB0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uID8gKGR1cmF0aW9uIC8gMTAwMCkgOiAwLjM1O1xuICAgICAgICB0aGlzLl9jdXJ2ZSA9IGN1cnZlO1xuICAgICAgICB0aGlzLl9pZCA9IHRyYW5zaXRpb25JZCsrO1xuICAgIH1cbiAgICBUcmFuc2l0aW9uLnByb3RvdHlwZS5nZXREdXJhdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2R1cmF0aW9uO1xuICAgIH07XG4gICAgVHJhbnNpdGlvbi5wcm90b3R5cGUuZ2V0Q3VydmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJ2ZTtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmFuaW1hdGVJT1NUcmFuc2l0aW9uID0gZnVuY3Rpb24gKGNvbnRhaW5lclZpZXcsIGZyb21WaWV3LCB0b1ZpZXcsIG9wZXJhdGlvbiwgY29tcGxldGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBYnN0cmFjdCBtZXRob2QgY2FsbFwiKTtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLmNyZWF0ZUFuZHJvaWRBbmltYXRvciA9IGZ1bmN0aW9uICh0cmFuc2l0aW9uVHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBYnN0cmFjdCBtZXRob2QgY2FsbFwiKTtcbiAgICB9O1xuICAgIFRyYW5zaXRpb24ucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJUcmFuc2l0aW9uQFwiICsgdGhpcy5faWQ7XG4gICAgfTtcbiAgICByZXR1cm4gVHJhbnNpdGlvbjtcbn0oKSk7XG5leHBvcnRzLlRyYW5zaXRpb24gPSBUcmFuc2l0aW9uO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJhbnNpdGlvbi5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGZpbGVfc3lzdGVtXzEgPSByZXF1aXJlKFwiLi4vZmlsZS1zeXN0ZW1cIik7XG52YXIgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi9wbGF0Zm9ybVwiKTtcbmV4cG9ydHMuZGVidWcgPSB0cnVlO1xudmFyIGFwcGxpY2F0aW9uUm9vdFBhdGg7XG5mdW5jdGlvbiBlbnN1cmVBcHBSb290UGF0aCgpIHtcbiAgICBpZiAoIWFwcGxpY2F0aW9uUm9vdFBhdGgpIHtcbiAgICAgICAgYXBwbGljYXRpb25Sb290UGF0aCA9IGZpbGVfc3lzdGVtXzEua25vd25Gb2xkZXJzLmN1cnJlbnRBcHAoKS5wYXRoO1xuICAgICAgICBhcHBsaWNhdGlvblJvb3RQYXRoID0gYXBwbGljYXRpb25Sb290UGF0aC5zdWJzdHIoMCwgYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGggLSBcImFwcC9cIi5sZW5ndGgpO1xuICAgIH1cbn1cbnZhciBTb3VyY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNvdXJjZSh1cmksIGxpbmUsIGNvbHVtbikge1xuICAgICAgICBlbnN1cmVBcHBSb290UGF0aCgpO1xuICAgICAgICBpZiAodXJpLmxlbmd0aCA+IGFwcGxpY2F0aW9uUm9vdFBhdGgubGVuZ3RoICYmIHVyaS5zdWJzdHIoMCwgYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGgpID09PSBhcHBsaWNhdGlvblJvb3RQYXRoKSB7XG4gICAgICAgICAgICB0aGlzLl91cmkgPSBcImZpbGU6Ly9cIiArIHVyaS5zdWJzdHIoYXBwbGljYXRpb25Sb290UGF0aC5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fdXJpID0gdXJpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2xpbmUgPSBsaW5lO1xuICAgICAgICB0aGlzLl9jb2x1bW4gPSBjb2x1bW47XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTb3VyY2UucHJvdG90eXBlLCBcInVyaVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fdXJpOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlLnByb3RvdHlwZSwgXCJsaW5lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9saW5lOyB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU291cmNlLnByb3RvdHlwZSwgXCJjb2x1bW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX2NvbHVtbjsgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU291cmNlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3VyaSArIFwiOlwiICsgdGhpcy5fbGluZSArIFwiOlwiICsgdGhpcy5fY29sdW1uO1xuICAgIH07XG4gICAgU291cmNlLmdldCA9IGZ1bmN0aW9uIChvYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIG9iamVjdFtTb3VyY2UuX3NvdXJjZV07XG4gICAgfTtcbiAgICBTb3VyY2Uuc2V0ID0gZnVuY3Rpb24gKG9iamVjdCwgc3JjKSB7XG4gICAgICAgIG9iamVjdFtTb3VyY2UuX3NvdXJjZV0gPSBzcmM7XG4gICAgfTtcbiAgICBTb3VyY2UuX3NvdXJjZSA9IFN5bWJvbChcInNvdXJjZVwiKTtcbiAgICByZXR1cm4gU291cmNlO1xufSgpKTtcbmV4cG9ydHMuU291cmNlID0gU291cmNlO1xudmFyIFNjb3BlRXJyb3IgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTY29wZUVycm9yLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNjb3BlRXJyb3IoaW5uZXIsIG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGZvcm1hdHRlZE1lc3NhZ2U7XG4gICAgICAgIGlmIChtZXNzYWdlICYmIGlubmVyLm1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGZvcm1hdHRlZE1lc3NhZ2UgPSBtZXNzYWdlICsgXCJcXG4gPiBcIiArIGlubmVyLm1lc3NhZ2UucmVwbGFjZShcIlxcblwiLCBcIlxcbiAgXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZm9ybWF0dGVkTWVzc2FnZSA9IG1lc3NhZ2UgfHwgaW5uZXIubWVzc2FnZSB8fCB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBmb3JtYXR0ZWRNZXNzYWdlKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGFjayA9IHBsYXRmb3JtXzEuaXNBbmRyb2lkID8gXCJFcnJvcjogXCIgKyBfdGhpcy5tZXNzYWdlICsgXCJcXG5cIiArIGlubmVyLnN0YWNrLnN1YnN0cihpbm5lci5zdGFjay5pbmRleE9mKFwiXFxuXCIpICsgMSkgOiBpbm5lci5zdGFjaztcbiAgICAgICAgX3RoaXMubWVzc2FnZSA9IGZvcm1hdHRlZE1lc3NhZ2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFNjb3BlRXJyb3I7XG59KEVycm9yKSk7XG5leHBvcnRzLlNjb3BlRXJyb3IgPSBTY29wZUVycm9yO1xudmFyIFNvdXJjZUVycm9yID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU291cmNlRXJyb3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU291cmNlRXJyb3IoY2hpbGQsIHNvdXJjZSwgbWVzc2FnZSkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgY2hpbGQsIG1lc3NhZ2UgPyBtZXNzYWdlICsgXCIgQFwiICsgc291cmNlICsgXCJcIiA6IHNvdXJjZSArIFwiXCIpIHx8IHRoaXM7XG4gICAgfVxuICAgIHJldHVybiBTb3VyY2VFcnJvcjtcbn0oU2NvcGVFcnJvcikpO1xuZXhwb3J0cy5Tb3VyY2VFcnJvciA9IFNvdXJjZUVycm9yO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZGVidWcuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xuZnVuY3Rpb24gZGlzcGF0Y2hUb01haW5UaHJlYWQoZnVuYykge1xuICAgIE5TT3BlcmF0aW9uUXVldWUubWFpblF1ZXVlLmFkZE9wZXJhdGlvbldpdGhCbG9jayhmdW5jKTtcbn1cbmV4cG9ydHMuZGlzcGF0Y2hUb01haW5UaHJlYWQgPSBkaXNwYXRjaFRvTWFpblRocmVhZDtcbmZ1bmN0aW9uIGlzTWFpblRocmVhZCgpIHtcbiAgICByZXR1cm4gTlNUaHJlYWQuaXNNYWluVGhyZWFkO1xufVxuZXhwb3J0cy5pc01haW5UaHJlYWQgPSBpc01haW5UaHJlYWQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tYWludGhyZWFkLWhlbHBlci5pb3MuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVwc2lsb24gPSAxRS0wNTtcbmZ1bmN0aW9uIGFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKSB7XG4gICAgcmV0dXJuIChNYXRoLmFicyh2YWx1ZTEgLSB2YWx1ZTIpIDwgZXBzaWxvbik7XG59XG5leHBvcnRzLmFyZUNsb3NlID0gYXJlQ2xvc2U7XG5mdW5jdGlvbiBncmVhdGVyVGhhbk9yQ2xvc2UodmFsdWUxLCB2YWx1ZTIpIHtcbiAgICByZXR1cm4gKHZhbHVlMSA+IHZhbHVlMikgfHwgYXJlQ2xvc2UodmFsdWUxLCB2YWx1ZTIpO1xufVxuZXhwb3J0cy5ncmVhdGVyVGhhbk9yQ2xvc2UgPSBncmVhdGVyVGhhbk9yQ2xvc2U7XG5mdW5jdGlvbiBncmVhdGVyVGhhbih2YWx1ZTEsIHZhbHVlMikge1xuICAgIHJldHVybiAodmFsdWUxID4gdmFsdWUyKSAmJiAhYXJlQ2xvc2UodmFsdWUxLCB2YWx1ZTIpO1xufVxuZXhwb3J0cy5ncmVhdGVyVGhhbiA9IGdyZWF0ZXJUaGFuO1xuZnVuY3Rpb24gbGVzc1RoYW4odmFsdWUxLCB2YWx1ZTIpIHtcbiAgICByZXR1cm4gKHZhbHVlMSA8IHZhbHVlMikgJiYgIWFyZUNsb3NlKHZhbHVlMSwgdmFsdWUyKTtcbn1cbmV4cG9ydHMubGVzc1RoYW4gPSBsZXNzVGhhbjtcbmZ1bmN0aW9uIGlzWmVybyh2YWx1ZSkge1xuICAgIHJldHVybiAoTWF0aC5hYnModmFsdWUpIDwgZXBzaWxvbik7XG59XG5leHBvcnRzLmlzWmVybyA9IGlzWmVybztcbmZ1bmN0aW9uIGdyZWF0ZXJUaGFuWmVybyh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA+IDA7XG59XG5leHBvcnRzLmdyZWF0ZXJUaGFuWmVybyA9IGdyZWF0ZXJUaGFuWmVybztcbmZ1bmN0aW9uIG5vdE5lZ2F0aXZlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID49IDA7XG59XG5leHBvcnRzLm5vdE5lZ2F0aXZlID0gbm90TmVnYXRpdmU7XG5leHBvcnRzLnJhZGlhbnNUb0RlZ3JlZXMgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSAqICgxODAgLyBNYXRoLlBJKTsgfTtcbmV4cG9ydHMuZGVncmVlc1RvUmFkaWFucyA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhICogKE1hdGguUEkgLyAxODApOyB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bnVtYmVyLXV0aWxzLmpzLm1hcCIsIk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIFN0cmluZztcbn1cbmV4cG9ydHMuaXNTdHJpbmcgPSBpc1N0cmluZztcbmZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIiB8fCB2YWx1ZSBpbnN0YW5jZW9mIE51bWJlcjtcbn1cbmV4cG9ydHMuaXNOdW1iZXIgPSBpc051bWJlcjtcbmZ1bmN0aW9uIGlzQm9vbGVhbih2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwiYm9vbGVhblwiIHx8IHZhbHVlIGluc3RhbmNlb2YgQm9vbGVhbjtcbn1cbmV4cG9ydHMuaXNCb29sZWFuID0gaXNCb29sZWFuO1xuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSBcImZ1bmN0aW9uXCI7XG59XG5leHBvcnRzLmlzRnVuY3Rpb24gPSBpc0Z1bmN0aW9uO1xuZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIjtcbn1cbmV4cG9ydHMuaXNPYmplY3QgPSBpc09iamVjdDtcbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSB1bmRlZmluZWQ7XG59XG5leHBvcnRzLmlzVW5kZWZpbmVkID0gaXNVbmRlZmluZWQ7XG5mdW5jdGlvbiBpc0RlZmluZWQodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlICE9PSBcInVuZGVmaW5lZFwiO1xufVxuZXhwb3J0cy5pc0RlZmluZWQgPSBpc0RlZmluZWQ7XG5mdW5jdGlvbiBpc051bGxPclVuZGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSBudWxsO1xufVxuZXhwb3J0cy5pc051bGxPclVuZGVmaW5lZCA9IGlzTnVsbE9yVW5kZWZpbmVkO1xuZnVuY3Rpb24gdmVyaWZ5Q2FsbGJhY2sodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgJiYgIWlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYWxsYmFjayBtdXN0IGJlIGEgdmFsaWQgZnVuY3Rpb24uXCIpO1xuICAgIH1cbn1cbmV4cG9ydHMudmVyaWZ5Q2FsbGJhY2sgPSB2ZXJpZnlDYWxsYmFjaztcbnZhciBjbGFzc0luZm9zTWFwID0gbmV3IE1hcCgpO1xudmFyIGZ1bmNOYW1lUmVnZXggPSAvZnVuY3Rpb24gKFtfYS16QS1aMC05XXsxLH0pXFwoLztcbmZ1bmN0aW9uIGdldENsYXNzKG9iamVjdCkge1xuICAgIHJldHVybiBnZXRDbGFzc0luZm8ob2JqZWN0KS5uYW1lO1xufVxuZXhwb3J0cy5nZXRDbGFzcyA9IGdldENsYXNzO1xuZnVuY3Rpb24gZ2V0Q2xhc3NJbmZvKG9iamVjdCkge1xuICAgIHZhciBjb25zdHJ1Y3RvciA9IG9iamVjdC5jb25zdHJ1Y3RvcjtcbiAgICB2YXIgcmVzdWx0ID0gY2xhc3NJbmZvc01hcC5nZXQoY29uc3RydWN0b3IpO1xuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgIHJlc3VsdCA9IG5ldyBDbGFzc0luZm8oY29uc3RydWN0b3IpO1xuICAgICAgICBjbGFzc0luZm9zTWFwLnNldChjb25zdHJ1Y3RvciwgcmVzdWx0KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0Q2xhc3NJbmZvID0gZ2V0Q2xhc3NJbmZvO1xuZnVuY3Rpb24gZ2V0QmFzZUNsYXNzZXMob2JqZWN0KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIHZhciBpbmZvID0gZ2V0Q2xhc3NJbmZvKG9iamVjdCk7XG4gICAgd2hpbGUgKGluZm8pIHtcbiAgICAgICAgcmVzdWx0LnB1c2goaW5mby5uYW1lKTtcbiAgICAgICAgaW5mbyA9IGluZm8uYmFzZUNsYXNzSW5mbztcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbmV4cG9ydHMuZ2V0QmFzZUNsYXNzZXMgPSBnZXRCYXNlQ2xhc3NlcztcbnZhciBDbGFzc0luZm8gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENsYXNzSW5mbyh0eXBlQ29zbnRydWN0b3IpIHtcbiAgICAgICAgdGhpcy5fdHlwZUNvc250cnVjdG9yID0gdHlwZUNvc250cnVjdG9yO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQ2xhc3NJbmZvLnByb3RvdHlwZSwgXCJuYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX25hbWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0cyA9IChmdW5jTmFtZVJlZ2V4KS5leGVjKHRoaXMuX3R5cGVDb3NudHJ1Y3Rvci50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9uYW1lID0gKHJlc3VsdHMgJiYgcmVzdWx0cy5sZW5ndGggPiAxKSA/IHJlc3VsdHNbMV0gOiBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDbGFzc0luZm8ucHJvdG90eXBlLCBcImJhc2VDbGFzc0luZm9cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChpc1VuZGVmaW5lZCh0aGlzLl9iYXNlQ2xhc3NJbmZvKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Jhc2VDbGFzc0luZm8gPSBDbGFzc0luZm8uX2dldEJhc2UodGhpcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Jhc2VDbGFzc0luZm8gJiYgdGhpcy5fYmFzZUNsYXNzSW5mby5uYW1lID09PSB0aGlzLm5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYmFzZUNsYXNzSW5mbyA9IENsYXNzSW5mby5fZ2V0QmFzZSh0aGlzLl9iYXNlQ2xhc3NJbmZvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fYmFzZUNsYXNzSW5mbztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgQ2xhc3NJbmZvLl9nZXRCYXNlID0gZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgIHZhciBjb25zdHJ1Y3RvclByb3RvID0gaW5mby5fdHlwZUNvc250cnVjdG9yLnByb3RvdHlwZTtcbiAgICAgICAgaWYgKGNvbnN0cnVjdG9yUHJvdG8uX19wcm90b19fKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBnZXRDbGFzc0luZm8oY29uc3RydWN0b3JQcm90by5fX3Byb3RvX18pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICByZXR1cm4gQ2xhc3NJbmZvO1xufSgpKTtcbmV4cG9ydHMuQ2xhc3NJbmZvID0gQ2xhc3NJbmZvO1xuZnVuY3Rpb24gdG9VSVN0cmluZyhvYmopIHtcbiAgICByZXR1cm4gaXNOdWxsT3JVbmRlZmluZWQob2JqKSA/IFwiXCIgOiBvYmogKyBcIlwiO1xufVxuZXhwb3J0cy50b1VJU3RyaW5nID0gdG9VSVN0cmluZztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXR5cGVzLmpzLm1hcCIsImZ1bmN0aW9uIF9fZXhwb3J0KG0pIHtcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgdHlwZXMgPSByZXF1aXJlKFwiLi90eXBlc1wiKTtcbnZhciBtYWludGhyZWFkX2hlbHBlcl8xID0gcmVxdWlyZShcIi4vbWFpbnRocmVhZC1oZWxwZXJcIik7XG52YXIgbW9kdWxlX25hbWVfc2FuaXRpemVyXzEgPSByZXF1aXJlKFwiLi4vdWkvYnVpbGRlci9tb2R1bGUtbmFtZS1zYW5pdGl6ZXJcIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi9tYWludGhyZWFkLWhlbHBlclwiKSk7XG5leHBvcnRzLlJFU09VUkNFX1BSRUZJWCA9IFwicmVzOi8vXCI7XG5leHBvcnRzLkZJTEVfUFJFRklYID0gXCJmaWxlOi8vL1wiO1xuZnVuY3Rpb24gZXNjYXBlUmVnZXhTeW1ib2xzKHNvdXJjZSkge1xuICAgIHZhciBlc2NhcGVSZWdleCA9IC9bXFwtXFxbXFxdXFwvXFx7XFx9XFwoXFwpXFwqXFwrXFw/XFwuXFxcXFxcXlxcJFxcfF0vZztcbiAgICByZXR1cm4gc291cmNlLnJlcGxhY2UoZXNjYXBlUmVnZXgsIFwiXFxcXCQmXCIpO1xufVxuZXhwb3J0cy5lc2NhcGVSZWdleFN5bWJvbHMgPSBlc2NhcGVSZWdleFN5bWJvbHM7XG5mdW5jdGlvbiBjb252ZXJ0U3RyaW5nKHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdDtcbiAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHZhbHVlKSB8fCB2YWx1ZS50cmltKCkgPT09IFwiXCIpIHtcbiAgICAgICAgcmVzdWx0ID0gdmFsdWU7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICB2YXIgdmFsdWVBc051bWJlciA9ICt2YWx1ZTtcbiAgICAgICAgaWYgKCFpc05hTih2YWx1ZUFzTnVtYmVyKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWVBc051bWJlcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSAmJiAodmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCIgfHwgdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJmYWxzZVwiKSkge1xuICAgICAgICAgICAgcmVzdWx0ID0gdmFsdWUudG9Mb3dlckNhc2UoKSA9PT0gXCJ0cnVlXCIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXN1bHQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5jb252ZXJ0U3RyaW5nID0gY29udmVydFN0cmluZztcbmZ1bmN0aW9uIGdldE1vZHVsZU5hbWUocGF0aCkge1xuICAgIHZhciBtb2R1bGVOYW1lID0gcGF0aC5yZXBsYWNlKFwiLi9cIiwgXCJcIik7XG4gICAgcmV0dXJuIG1vZHVsZV9uYW1lX3Nhbml0aXplcl8xLnNhbml0aXplTW9kdWxlTmFtZShtb2R1bGVOYW1lKTtcbn1cbmV4cG9ydHMuZ2V0TW9kdWxlTmFtZSA9IGdldE1vZHVsZU5hbWU7XG52YXIgbGF5b3V0Q29tbW9uO1xuKGZ1bmN0aW9uIChsYXlvdXRDb21tb24pIHtcbiAgICB2YXIgTU9ERV9TSElGVCA9IDMwO1xuICAgIHZhciBNT0RFX01BU0sgPSAweDMgPDwgTU9ERV9TSElGVDtcbiAgICBsYXlvdXRDb21tb24uVU5TUEVDSUZJRUQgPSAwIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLkVYQUNUTFkgPSAxIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLkFUX01PU1QgPSAyIDw8IE1PREVfU0hJRlQ7XG4gICAgbGF5b3V0Q29tbW9uLk1FQVNVUkVEX0hFSUdIVF9TVEFURV9TSElGVCA9IDB4MDAwMDAwMTA7XG4gICAgbGF5b3V0Q29tbW9uLk1FQVNVUkVEX1NUQVRFX1RPT19TTUFMTCA9IDB4MDEwMDAwMDA7XG4gICAgbGF5b3V0Q29tbW9uLk1FQVNVUkVEX1NUQVRFX01BU0sgPSAweGZmMDAwMDAwO1xuICAgIGxheW91dENvbW1vbi5NRUFTVVJFRF9TSVpFX01BU0sgPSAweDAwZmZmZmZmO1xuICAgIGZ1bmN0aW9uIGdldE1vZGUobW9kZSkge1xuICAgICAgICBzd2l0Y2ggKG1vZGUpIHtcbiAgICAgICAgICAgIGNhc2UgbGF5b3V0Q29tbW9uLkVYQUNUTFk6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiRXhhY3RcIjtcbiAgICAgICAgICAgIGNhc2UgbGF5b3V0Q29tbW9uLkFUX01PU1Q6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiQXRNb3N0XCI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHJldHVybiBcIlVuc3BlY2lmaWVkXCI7XG4gICAgICAgIH1cbiAgICB9XG4gICAgbGF5b3V0Q29tbW9uLmdldE1vZGUgPSBnZXRNb2RlO1xuICAgIGZ1bmN0aW9uIGdldE1lYXN1cmVTcGVjTW9kZShzcGVjKSB7XG4gICAgICAgIHJldHVybiAoc3BlYyAmIE1PREVfTUFTSyk7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5nZXRNZWFzdXJlU3BlY01vZGUgPSBnZXRNZWFzdXJlU3BlY01vZGU7XG4gICAgZnVuY3Rpb24gZ2V0TWVhc3VyZVNwZWNTaXplKHNwZWMpIHtcbiAgICAgICAgcmV0dXJuIChzcGVjICYgfk1PREVfTUFTSyk7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5nZXRNZWFzdXJlU3BlY1NpemUgPSBnZXRNZWFzdXJlU3BlY1NpemU7XG4gICAgZnVuY3Rpb24gbWVhc3VyZVNwZWNUb1N0cmluZyhtZWFzdXJlU3BlYykge1xuICAgICAgICB2YXIgbW9kZSA9IGdldE1lYXN1cmVTcGVjTW9kZShtZWFzdXJlU3BlYyk7XG4gICAgICAgIHZhciBzaXplID0gZ2V0TWVhc3VyZVNwZWNTaXplKG1lYXN1cmVTcGVjKTtcbiAgICAgICAgdmFyIHRleHQgPSBcIk1lYXN1cmVTcGVjOiBcIjtcbiAgICAgICAgaWYgKG1vZGUgPT09IGxheW91dENvbW1vbi5VTlNQRUNJRklFRCkge1xuICAgICAgICAgICAgdGV4dCArPSBcIlVOU1BFQ0lGSUVEIFwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1vZGUgPT09IGxheW91dENvbW1vbi5FWEFDVExZKSB7XG4gICAgICAgICAgICB0ZXh0ICs9IFwiRVhBQ1RMWSBcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChtb2RlID09PSBsYXlvdXRDb21tb24uQVRfTU9TVCkge1xuICAgICAgICAgICAgdGV4dCArPSBcIkFUX01PU1QgXCI7XG4gICAgICAgIH1cbiAgICAgICAgdGV4dCArPSBzaXplO1xuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG4gICAgbGF5b3V0Q29tbW9uLm1lYXN1cmVTcGVjVG9TdHJpbmcgPSBtZWFzdXJlU3BlY1RvU3RyaW5nO1xuICAgIGZ1bmN0aW9uIHJvdW5kKHZhbHVlKSB7XG4gICAgICAgIHZhciByZXMgPSBNYXRoLmZsb29yKHZhbHVlICsgMC41KTtcbiAgICAgICAgaWYgKHJlcyAhPT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh2YWx1ZSA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIGxheW91dENvbW1vbi5yb3VuZCA9IHJvdW5kO1xufSkobGF5b3V0Q29tbW9uID0gZXhwb3J0cy5sYXlvdXRDb21tb24gfHwgKGV4cG9ydHMubGF5b3V0Q29tbW9uID0ge30pKTtcbmZ1bmN0aW9uIGlzRmlsZU9yUmVzb3VyY2VQYXRoKHBhdGgpIHtcbiAgICBpZiAoIXR5cGVzLmlzU3RyaW5nKHBhdGgpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHBhdGguaW5kZXhPZihcIn4vXCIpID09PSAwIHx8XG4gICAgICAgIHBhdGguaW5kZXhPZihcIi9cIikgPT09IDAgfHxcbiAgICAgICAgcGF0aC5pbmRleE9mKGV4cG9ydHMuUkVTT1VSQ0VfUFJFRklYKSA9PT0gMDtcbn1cbmV4cG9ydHMuaXNGaWxlT3JSZXNvdXJjZVBhdGggPSBpc0ZpbGVPclJlc291cmNlUGF0aDtcbmZ1bmN0aW9uIGlzRm9udEljb25VUkkodXJpKSB7XG4gICAgaWYgKCF0eXBlcy5pc1N0cmluZyh1cmkpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIGZpcnN0U2VnbWVudCA9IHVyaS50cmltKCkuc3BsaXQoXCIvL1wiKVswXTtcbiAgICByZXR1cm4gZmlyc3RTZWdtZW50ICYmIGZpcnN0U2VnbWVudC5pbmRleE9mKFwiZm9udDpcIikgPT09IDA7XG59XG5leHBvcnRzLmlzRm9udEljb25VUkkgPSBpc0ZvbnRJY29uVVJJO1xuZnVuY3Rpb24gaXNEYXRhVVJJKHVyaSkge1xuICAgIGlmICghdHlwZXMuaXNTdHJpbmcodXJpKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBmaXJzdFNlZ21lbnQgPSB1cmkudHJpbSgpLnNwbGl0KFwiLFwiKVswXTtcbiAgICByZXR1cm4gZmlyc3RTZWdtZW50ICYmIGZpcnN0U2VnbWVudC5pbmRleE9mKFwiZGF0YTpcIikgPT09IDAgJiYgZmlyc3RTZWdtZW50LmluZGV4T2YoXCJiYXNlNjRcIikgPj0gMDtcbn1cbmV4cG9ydHMuaXNEYXRhVVJJID0gaXNEYXRhVVJJO1xuZnVuY3Rpb24gbWVyZ2VTb3J0KGFyciwgY29tcGFyZUZ1bmMpIHtcbiAgICBpZiAoYXJyLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgcmV0dXJuIGFycjtcbiAgICB9XG4gICAgdmFyIG1pZGRsZSA9IGFyci5sZW5ndGggLyAyO1xuICAgIHZhciBsZWZ0ID0gYXJyLnNsaWNlKDAsIG1pZGRsZSk7XG4gICAgdmFyIHJpZ2h0ID0gYXJyLnNsaWNlKG1pZGRsZSwgYXJyLmxlbmd0aCk7XG4gICAgcmV0dXJuIG1lcmdlKG1lcmdlU29ydChsZWZ0LCBjb21wYXJlRnVuYyksIG1lcmdlU29ydChyaWdodCwgY29tcGFyZUZ1bmMpLCBjb21wYXJlRnVuYyk7XG59XG5leHBvcnRzLm1lcmdlU29ydCA9IG1lcmdlU29ydDtcbmZ1bmN0aW9uIG1lcmdlKGxlZnQsIHJpZ2h0LCBjb21wYXJlRnVuYykge1xuICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICB3aGlsZSAobGVmdC5sZW5ndGggJiYgcmlnaHQubGVuZ3RoKSB7XG4gICAgICAgIGlmIChjb21wYXJlRnVuYyhsZWZ0WzBdLCByaWdodFswXSkgPD0gMCkge1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gobGVmdC5zaGlmdCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHdoaWxlIChsZWZ0Lmxlbmd0aCkge1xuICAgICAgICByZXN1bHQucHVzaChsZWZ0LnNoaWZ0KCkpO1xuICAgIH1cbiAgICB3aGlsZSAocmlnaHQubGVuZ3RoKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHJpZ2h0LnNoaWZ0KCkpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuZXhwb3J0cy5tZXJnZSA9IG1lcmdlO1xuZnVuY3Rpb24gaGFzRHVwbGljYXRlcyhhcnIpIHtcbiAgICByZXR1cm4gYXJyLmxlbmd0aCAhPT0gZWxpbWluYXRlRHVwbGljYXRlcyhhcnIpLmxlbmd0aDtcbn1cbmV4cG9ydHMuaGFzRHVwbGljYXRlcyA9IGhhc0R1cGxpY2F0ZXM7XG5mdW5jdGlvbiBlbGltaW5hdGVEdXBsaWNhdGVzKGFycikge1xuICAgIHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQoYXJyKSk7XG59XG5leHBvcnRzLmVsaW1pbmF0ZUR1cGxpY2F0ZXMgPSBlbGltaW5hdGVEdXBsaWNhdGVzO1xuZnVuY3Rpb24gZXhlY3V0ZU9uTWFpblRocmVhZChmdW5jKSB7XG4gICAgaWYgKG1haW50aHJlYWRfaGVscGVyXzEuaXNNYWluVGhyZWFkKCkpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMoKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIG1haW50aHJlYWRfaGVscGVyXzEuZGlzcGF0Y2hUb01haW5UaHJlYWQoZnVuYyk7XG4gICAgfVxufVxuZXhwb3J0cy5leGVjdXRlT25NYWluVGhyZWFkID0gZXhlY3V0ZU9uTWFpblRocmVhZDtcbmZ1bmN0aW9uIG1haW5UaHJlYWRpZnkoZnVuYykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBhcmdzVG9QYXNzID0gYXJndW1lbnRzO1xuICAgICAgICBleGVjdXRlT25NYWluVGhyZWFkKGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZ1bmMuYXBwbHkoX3RoaXMsIGFyZ3NUb1Bhc3MpOyB9KTtcbiAgICB9O1xufVxuZXhwb3J0cy5tYWluVGhyZWFkaWZ5ID0gbWFpblRocmVhZGlmeTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLWNvbW1vbi5qcy5tYXAiLCJmdW5jdGlvbiBfX2V4cG9ydChtKSB7XG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIHRyYWNlXzEgPSByZXF1aXJlKFwiLi4vdHJhY2VcIik7XG52YXIgdXRpbHNfY29tbW9uXzEgPSByZXF1aXJlKFwiLi91dGlscy1jb21tb25cIik7XG5fX2V4cG9ydChyZXF1aXJlKFwiLi91dGlscy1jb21tb25cIikpO1xudmFyIG1haW5TY3JlZW5TY2FsZTtcbmZ1bmN0aW9uIGlzT3JpZW50YXRpb25MYW5kc2NhcGUob3JpZW50YXRpb24pIHtcbiAgICByZXR1cm4gb3JpZW50YXRpb24gPT09IDMgfHwgb3JpZW50YXRpb24gPT09IDQ7XG59XG52YXIgbGF5b3V0O1xuKGZ1bmN0aW9uIChsYXlvdXQpIHtcbiAgICB2YXIgTU9ERV9TSElGVCA9IDMwO1xuICAgIHZhciBNT0RFX01BU0sgPSAweDMgPDwgTU9ERV9TSElGVDtcbiAgICBmdW5jdGlvbiBtYWtlTWVhc3VyZVNwZWMoc2l6ZSwgbW9kZSkge1xuICAgICAgICByZXR1cm4gKE1hdGgucm91bmQoTWF0aC5tYXgoMCwgc2l6ZSkpICYgfk1PREVfTUFTSykgfCAobW9kZSAmIE1PREVfTUFTSyk7XG4gICAgfVxuICAgIGxheW91dC5tYWtlTWVhc3VyZVNwZWMgPSBtYWtlTWVhc3VyZVNwZWM7XG4gICAgZnVuY3Rpb24gZ2V0RGlzcGxheURlbnNpdHkoKSB7XG4gICAgICAgIHJldHVybiBtYWluU2NyZWVuU2NhbGU7XG4gICAgfVxuICAgIGxheW91dC5nZXREaXNwbGF5RGVuc2l0eSA9IGdldERpc3BsYXlEZW5zaXR5O1xuICAgIGZ1bmN0aW9uIHRvRGV2aWNlUGl4ZWxzKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIG1haW5TY3JlZW5TY2FsZTtcbiAgICB9XG4gICAgbGF5b3V0LnRvRGV2aWNlUGl4ZWxzID0gdG9EZXZpY2VQaXhlbHM7XG4gICAgZnVuY3Rpb24gdG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscyh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gdmFsdWUgLyBtYWluU2NyZWVuU2NhbGU7XG4gICAgfVxuICAgIGxheW91dC50b0RldmljZUluZGVwZW5kZW50UGl4ZWxzID0gdG9EZXZpY2VJbmRlcGVuZGVudFBpeGVscztcbiAgICBmdW5jdGlvbiBtZWFzdXJlTmF0aXZlVmlldyhuYXRpdmVWaWV3LCB3aWR0aCwgd2lkdGhNb2RlLCBoZWlnaHQsIGhlaWdodE1vZGUpIHtcbiAgICAgICAgdmFyIHZpZXcgPSBuYXRpdmVWaWV3O1xuICAgICAgICB2YXIgbmF0aXZlU2l6ZSA9IHZpZXcuc2l6ZVRoYXRGaXRzKHtcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aE1vZGUgPT09IDAgPyBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgOiB0b0RldmljZUluZGVwZW5kZW50UGl4ZWxzKHdpZHRoKSxcbiAgICAgICAgICAgIGhlaWdodDogaGVpZ2h0TW9kZSA9PT0gMCA/IE51bWJlci5QT1NJVElWRV9JTkZJTklUWSA6IHRvRGV2aWNlSW5kZXBlbmRlbnRQaXhlbHMoaGVpZ2h0KVxuICAgICAgICB9KTtcbiAgICAgICAgbmF0aXZlU2l6ZS53aWR0aCA9IHV0aWxzX2NvbW1vbl8xLmxheW91dENvbW1vbi5yb3VuZCh0b0RldmljZVBpeGVscyhuYXRpdmVTaXplLndpZHRoKSk7XG4gICAgICAgIG5hdGl2ZVNpemUuaGVpZ2h0ID0gdXRpbHNfY29tbW9uXzEubGF5b3V0Q29tbW9uLnJvdW5kKHRvRGV2aWNlUGl4ZWxzKG5hdGl2ZVNpemUuaGVpZ2h0KSk7XG4gICAgICAgIHJldHVybiBuYXRpdmVTaXplO1xuICAgIH1cbiAgICBsYXlvdXQubWVhc3VyZU5hdGl2ZVZpZXcgPSBtZWFzdXJlTmF0aXZlVmlldztcbn0pKGxheW91dCA9IGV4cG9ydHMubGF5b3V0IHx8IChleHBvcnRzLmxheW91dCA9IHt9KSk7XG5PYmplY3QuYXNzaWduKGxheW91dCwgdXRpbHNfY29tbW9uXzEubGF5b3V0Q29tbW9uKTtcbnZhciBpb3M7XG4oZnVuY3Rpb24gKGlvcykge1xuICAgIGZ1bmN0aW9uIGdldHRlcihfdGhpcywgcHJvcGVydHkpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJ1dGlscy5pb3MuZ2V0dGVyKCkgaXMgZGVwcmVjYXRlZDsgdXNlIHRoZSByZXNwZWN0aXZlIG5hdGl2ZSBwcm9wZXJ0eSBpbnN0ZWFkXCIpO1xuICAgICAgICBpZiAodHlwZW9mIHByb3BlcnR5ID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eS5jYWxsKF90aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpb3MuZ2V0dGVyID0gZ2V0dGVyO1xuICAgIHZhciBjb2xsZWN0aW9ucztcbiAgICAoZnVuY3Rpb24gKGNvbGxlY3Rpb25zKSB7XG4gICAgICAgIGZ1bmN0aW9uIGpzQXJyYXlUb05TQXJyYXkoc3RyKSB7XG4gICAgICAgICAgICByZXR1cm4gTlNBcnJheS5hcnJheVdpdGhBcnJheShzdHIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbGxlY3Rpb25zLmpzQXJyYXlUb05TQXJyYXkgPSBqc0FycmF5VG9OU0FycmF5O1xuICAgICAgICBmdW5jdGlvbiBuc0FycmF5VG9KU0FycmF5KGEpIHtcbiAgICAgICAgICAgIHZhciBhcnIgPSBbXTtcbiAgICAgICAgICAgIGlmIChhICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB2YXIgY291bnQgPSBhLmNvdW50O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBhcnIucHVzaChhLm9iamVjdEF0SW5kZXgoaSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBhcnI7XG4gICAgICAgIH1cbiAgICAgICAgY29sbGVjdGlvbnMubnNBcnJheVRvSlNBcnJheSA9IG5zQXJyYXlUb0pTQXJyYXk7XG4gICAgfSkoY29sbGVjdGlvbnMgPSBpb3MuY29sbGVjdGlvbnMgfHwgKGlvcy5jb2xsZWN0aW9ucyA9IHt9KSk7XG4gICAgZnVuY3Rpb24gaXNMYW5kc2NhcGUoKSB7XG4gICAgICAgIHZhciBkZXZpY2UgPSBVSURldmljZS5jdXJyZW50RGV2aWNlO1xuICAgICAgICB2YXIgc3RhdHVzQmFyT3JpZW50YXRpb24gPSBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uLnN0YXR1c0Jhck9yaWVudGF0aW9uO1xuICAgICAgICB2YXIgaXNTdGF0dXNCYXJPcmllbnRhdGlvbkxhbmRzY2FwZSA9IGlzT3JpZW50YXRpb25MYW5kc2NhcGUoc3RhdHVzQmFyT3JpZW50YXRpb24pO1xuICAgICAgICByZXR1cm4gaXNPcmllbnRhdGlvbkxhbmRzY2FwZShkZXZpY2Uub3JpZW50YXRpb24pIHx8IGlzU3RhdHVzQmFyT3JpZW50YXRpb25MYW5kc2NhcGU7XG4gICAgfVxuICAgIGlvcy5pc0xhbmRzY2FwZSA9IGlzTGFuZHNjYXBlO1xuICAgIGlvcy5NYWpvclZlcnNpb24gPSBOU1N0cmluZy5zdHJpbmdXaXRoU3RyaW5nKFVJRGV2aWNlLmN1cnJlbnREZXZpY2Uuc3lzdGVtVmVyc2lvbikuaW50VmFsdWU7XG4gICAgZnVuY3Rpb24gb3BlbkZpbGUoZmlsZVBhdGgpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBhcHBQYXRoID0gZ2V0Q3VycmVudEFwcFBhdGgoKTtcbiAgICAgICAgICAgIHZhciBwYXRoID0gZmlsZVBhdGgucmVwbGFjZShcIn5cIiwgYXBwUGF0aCk7XG4gICAgICAgICAgICB2YXIgY29udHJvbGxlciA9IFVJRG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXIuaW50ZXJhY3Rpb25Db250cm9sbGVyV2l0aFVSTChOU1VSTC5maWxlVVJMV2l0aFBhdGgocGF0aCkpO1xuICAgICAgICAgICAgY29udHJvbGxlci5kZWxlZ2F0ZSA9IG5ldyBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsKCk7XG4gICAgICAgICAgICByZXR1cm4gY29udHJvbGxlci5wcmVzZW50UHJldmlld0FuaW1hdGVkKHRydWUpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0cmFjZV8xLndyaXRlKFwiRXJyb3IgaW4gb3BlbkZpbGVcIiwgdHJhY2VfMS5jYXRlZ29yaWVzLkVycm9yLCB0cmFjZV8xLm1lc3NhZ2VUeXBlLmVycm9yKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlvcy5vcGVuRmlsZSA9IG9wZW5GaWxlO1xuICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRBcHBQYXRoKCkge1xuICAgICAgICB2YXIgY3VycmVudERpciA9IF9fZGlybmFtZTtcbiAgICAgICAgdmFyIHRuc01vZHVsZXNJbmRleCA9IGN1cnJlbnREaXIuaW5kZXhPZihcIi90bnNfbW9kdWxlc1wiKTtcbiAgICAgICAgdmFyIGFwcFBhdGggPSBjdXJyZW50RGlyO1xuICAgICAgICBpZiAodG5zTW9kdWxlc0luZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgYXBwUGF0aCA9IGN1cnJlbnREaXIuc3Vic3RyaW5nKDAsIHRuc01vZHVsZXNJbmRleCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFwcFBhdGg7XG4gICAgfVxuICAgIGlvcy5nZXRDdXJyZW50QXBwUGF0aCA9IGdldEN1cnJlbnRBcHBQYXRoO1xuICAgIGZ1bmN0aW9uIGpvaW5QYXRocygpIHtcbiAgICAgICAgdmFyIHBhdGhzID0gW107XG4gICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICBwYXRoc1tfaV0gPSBhcmd1bWVudHNbX2ldO1xuICAgICAgICB9XG4gICAgICAgIGlmICghcGF0aHMgfHwgcGF0aHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTlNTdHJpbmcuc3RyaW5nV2l0aFN0cmluZyhOU1N0cmluZy5wYXRoV2l0aENvbXBvbmVudHMocGF0aHMpKS5zdHJpbmdCeVN0YW5kYXJkaXppbmdQYXRoO1xuICAgIH1cbiAgICBpb3Muam9pblBhdGhzID0gam9pblBhdGhzO1xuICAgIGZ1bmN0aW9uIGdldFZpc2libGVWaWV3Q29udHJvbGxlcihyb290Vmlld0NvbnRyb2xsZXIpIHtcbiAgICAgICAgaWYgKHJvb3RWaWV3Q29udHJvbGxlci5wcmVzZW50ZWRWaWV3Q29udHJvbGxlcikge1xuICAgICAgICAgICAgcmV0dXJuIGdldFZpc2libGVWaWV3Q29udHJvbGxlcihyb290Vmlld0NvbnRyb2xsZXIucHJlc2VudGVkVmlld0NvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb290Vmlld0NvbnRyb2xsZXIuaXNLaW5kT2ZDbGFzcyhVSU5hdmlnYXRpb25Db250cm9sbGVyLmNsYXNzKCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0VmlzaWJsZVZpZXdDb250cm9sbGVyKHJvb3RWaWV3Q29udHJvbGxlci52aXNpYmxlVmlld0NvbnRyb2xsZXIpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyb290Vmlld0NvbnRyb2xsZXIuaXNLaW5kT2ZDbGFzcyhVSVRhYkJhckNvbnRyb2xsZXIuY2xhc3MoKSkpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRWaXNpYmxlVmlld0NvbnRyb2xsZXIocm9vdFZpZXdDb250cm9sbGVyKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcm9vdFZpZXdDb250cm9sbGVyO1xuICAgIH1cbiAgICBpb3MuZ2V0VmlzaWJsZVZpZXdDb250cm9sbGVyID0gZ2V0VmlzaWJsZVZpZXdDb250cm9sbGVyO1xufSkoaW9zID0gZXhwb3J0cy5pb3MgfHwgKGV4cG9ydHMuaW9zID0ge30pKTtcbmZ1bmN0aW9uIEdDKCkge1xuICAgIF9fY29sbGVjdCgpO1xufVxuZXhwb3J0cy5HQyA9IEdDO1xuZnVuY3Rpb24gcmVsZWFzZU5hdGl2ZU9iamVjdChvYmplY3QpIHtcbiAgICBfX3JlbGVhc2VOYXRpdmVDb3VudGVycGFydChvYmplY3QpO1xufVxuZXhwb3J0cy5yZWxlYXNlTmF0aXZlT2JqZWN0ID0gcmVsZWFzZU5hdGl2ZU9iamVjdDtcbmZ1bmN0aW9uIG9wZW5VcmwobG9jYXRpb24pIHtcbiAgICB0cnkge1xuICAgICAgICB2YXIgdXJsID0gTlNVUkwuVVJMV2l0aFN0cmluZyhsb2NhdGlvbi50cmltKCkpO1xuICAgICAgICBpZiAoVUlBcHBsaWNhdGlvbi5zaGFyZWRBcHBsaWNhdGlvbi5jYW5PcGVuVVJMKHVybCkpIHtcbiAgICAgICAgICAgIHJldHVybiBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uLm9wZW5VUkwodXJsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZSkge1xuICAgICAgICB0cmFjZV8xLndyaXRlKFwiRXJyb3IgaW4gT3BlblVSTFwiLCB0cmFjZV8xLmNhdGVnb3JpZXMuRXJyb3IsIHRyYWNlXzEubWVzc2FnZVR5cGUuZXJyb3IpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5leHBvcnRzLm9wZW5VcmwgPSBvcGVuVXJsO1xudmFyIFVJRG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwgPSAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFVJRG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuZ2V0Vmlld0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcHAgPSBVSUFwcGxpY2F0aW9uLnNoYXJlZEFwcGxpY2F0aW9uO1xuICAgICAgICByZXR1cm4gYXBwLmtleVdpbmRvdy5yb290Vmlld0NvbnRyb2xsZXI7XG4gICAgfTtcbiAgICBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5kb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlclZpZXdDb250cm9sbGVyRm9yUHJldmlldyA9IGZ1bmN0aW9uIChjb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFZpZXdDb250cm9sbGVyKCk7XG4gICAgfTtcbiAgICBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsLnByb3RvdHlwZS5kb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlclZpZXdGb3JQcmV2aWV3ID0gZnVuY3Rpb24gKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Vmlld0NvbnRyb2xsZXIoKS52aWV3O1xuICAgIH07XG4gICAgVUlEb2N1bWVudEludGVyYWN0aW9uQ29udHJvbGxlckRlbGVnYXRlSW1wbC5wcm90b3R5cGUuZG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJSZWN0Rm9yUHJldmlldyA9IGZ1bmN0aW9uIChjb250cm9sbGVyKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFZpZXdDb250cm9sbGVyKCkudmlldy5mcmFtZTtcbiAgICB9O1xuICAgIFVJRG9jdW1lbnRJbnRlcmFjdGlvbkNvbnRyb2xsZXJEZWxlZ2F0ZUltcGwuT2JqQ1Byb3RvY29scyA9IFtVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVdO1xuICAgIHJldHVybiBVSURvY3VtZW50SW50ZXJhY3Rpb25Db250cm9sbGVyRGVsZWdhdGVJbXBsO1xufShOU09iamVjdCkpO1xubWFpblNjcmVlblNjYWxlID0gVUlTY3JlZW4ubWFpblNjcmVlbi5zY2FsZTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmlvcy5qcy5tYXAiLCJPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG52YXIgaHR0cCA9IHJlcXVpcmUoXCIuLi9odHRwXCIpO1xudmFyIHR5cGVzID0gcmVxdWlyZShcIi4uL3V0aWxzL3R5cGVzXCIpO1xudmFyIFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlO1xuKGZ1bmN0aW9uIChYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZSkge1xuICAgIFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLmVtcHR5ID0gXCJcIjtcbiAgICBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS50ZXh0ID0gXCJ0ZXh0XCI7XG4gICAgWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUuanNvbiA9IFwianNvblwiO1xufSkoWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUgfHwgKFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlID0ge30pKTtcbnZhciBYTUxIdHRwUmVxdWVzdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gWE1MSHR0cFJlcXVlc3QoKSB7XG4gICAgICAgIHRoaXMuVU5TRU5UID0gMDtcbiAgICAgICAgdGhpcy5PUEVORUQgPSAxO1xuICAgICAgICB0aGlzLkhFQURFUlNfUkVDRUlWRUQgPSAyO1xuICAgICAgICB0aGlzLkxPQURJTkcgPSAzO1xuICAgICAgICB0aGlzLkRPTkUgPSA0O1xuICAgICAgICB0aGlzLl9yZXNwb25zZVR5cGUgPSBcIlwiO1xuICAgICAgICB0aGlzLnRleHRUeXBlcyA9IFtcbiAgICAgICAgICAgIFwidGV4dC9wbGFpblwiLFxuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi94bWxcIixcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vcnNzK3htbFwiLFxuICAgICAgICAgICAgXCJ0ZXh0L2h0bWxcIixcbiAgICAgICAgICAgIFwidGV4dC94bWxcIlxuICAgICAgICBdO1xuICAgICAgICB0aGlzLl9saXN0ZW5lcnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuX3JlYWR5U3RhdGUgPSB0aGlzLlVOU0VOVDtcbiAgICB9XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAobWV0aG9kLCB1cmwsIGFzeW5jLCB1c2VyLCBwYXNzd29yZCkge1xuICAgICAgICBpZiAodHlwZXMuaXNTdHJpbmcobWV0aG9kKSAmJiB0eXBlcy5pc1N0cmluZyh1cmwpKSB7XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zID0geyB1cmw6IHVybCwgbWV0aG9kOiBtZXRob2QgfTtcbiAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuaGVhZGVycyA9IHt9O1xuICAgICAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKHVzZXIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5oZWFkZXJzW1widXNlclwiXSA9IHVzZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZXMuaXNTdHJpbmcocGFzc3dvcmQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5oZWFkZXJzW1wicGFzc3dvcmRcIl0gPSBwYXNzd29yZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3NldFJlYWR5U3RhdGUodGhpcy5PUEVORUQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuYWJvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Vycm9yRmxhZyA9IHRydWU7XG4gICAgICAgIHRoaXMuX3Jlc3BvbnNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLlVOU0VOVCB8fCB0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLk9QRU5FRCB8fCB0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLkRPTkUpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlYWR5U3RhdGUgPSB0aGlzLlVOU0VOVDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3NldFJlYWR5U3RhdGUodGhpcy5ET05FKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLl9lcnJvckZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2UgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZXNwb25zZVRleHRSZWFkZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9oZWFkZXJzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc3RhdHVzID0gbnVsbDtcbiAgICAgICAgaWYgKHR5cGVzLmlzRGVmaW5lZCh0aGlzLl9vcHRpb25zKSkge1xuICAgICAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKGRhdGEpICYmIHRoaXMuX29wdGlvbnMubWV0aG9kICE9PSBcIkdFVFwiKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb3B0aW9ucy5jb250ZW50ID0gZGF0YTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKGRhdGEgaW5zdGFuY2VvZiBGb3JtRGF0YSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29wdGlvbnMuY29udGVudCA9IGRhdGEudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGh0dHAucmVxdWVzdCh0aGlzLl9vcHRpb25zKS50aGVuKGZ1bmN0aW9uIChyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5fZXJyb3JGbGFnKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9sb2FkUmVzcG9uc2Uocik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fZXJyb3JGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfdGhpcy5fc2V0UmVhZHlTdGF0ZShfdGhpcy5ET05FLCBlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuX2xvYWRSZXNwb25zZSA9IGZ1bmN0aW9uIChyKSB7XG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IHIuc3RhdHVzQ29kZTtcbiAgICAgICAgdGhpcy5fcmVzcG9uc2UgPSByLmNvbnRlbnQucmF3ICsgXCJcIjtcbiAgICAgICAgdGhpcy5faGVhZGVycyA9IHIuaGVhZGVycztcbiAgICAgICAgdGhpcy5fc2V0UmVhZHlTdGF0ZSh0aGlzLkhFQURFUlNfUkVDRUlWRUQpO1xuICAgICAgICB0aGlzLl9zZXRSZWFkeVN0YXRlKHRoaXMuTE9BRElORyk7XG4gICAgICAgIHRoaXMuX3NldFJlc3BvbnNlVHlwZSgpO1xuICAgICAgICB0aGlzLl9yZXNwb25zZVRleHRSZWFkZXIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiByLmNvbnRlbnQudG9TdHJpbmcoKTsgfTtcbiAgICAgICAgdGhpcy5fYWRkVG9TdHJpbmdPblJlc3BvbnNlKCk7XG4gICAgICAgIGlmICh0aGlzLnJlc3BvbnNlVHlwZSA9PT0gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUuanNvbikge1xuICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2UgPSBKU09OLnBhcnNlKHRoaXMucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnJlc3BvbnNlVHlwZSA9PT0gWE1MSHR0cFJlcXVlc3RSZXNwb25zZVR5cGUudGV4dCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzcG9uc2UgPSB0aGlzLnJlc3BvbnNlVGV4dDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9zZXRSZWFkeVN0YXRlKHRoaXMuRE9ORSk7XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuX2FkZFRvU3RyaW5nT25SZXNwb25zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHR5cGVzLmlzT2JqZWN0KHRoaXMucmVzcG9uc2UpKSB7XG4gICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5fcmVzcG9uc2UsIFwidG9TdHJpbmdcIiwge1xuICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucmVzcG9uc2VUZXh0OyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmlzVGV4dENvbnRlbnRUeXBlID0gZnVuY3Rpb24gKGNvbnRlbnRUeXBlKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRleHRUeXBlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0aGlzLnRleHRUeXBlc1tpXSkgPj0gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5fc2V0UmVzcG9uc2VUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5nZXRSZXNwb25zZUhlYWRlcihcIkNvbnRlbnQtVHlwZVwiKTtcbiAgICAgICAgdmFyIGNvbnRlbnRUeXBlID0gaGVhZGVyICYmIGhlYWRlci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICBpZiAoY29udGVudFR5cGUpIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50VHlwZS5pbmRleE9mKFwiYXBwbGljYXRpb24vanNvblwiKSA+PSAwIHx8IGNvbnRlbnRUeXBlLmluZGV4T2YoXCIranNvblwiKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNwb25zZVR5cGUgPSBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS5qc29uO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5pc1RleHRDb250ZW50VHlwZShjb250ZW50VHlwZSkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3BvbnNlVHlwZSA9IFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLnRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlc3BvbnNlVHlwZSA9IFhNTEh0dHBSZXF1ZXN0UmVzcG9uc2VUeXBlLnRleHQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgaGFuZGxlcikge1xuICAgICAgICBpZiAoZXZlbnROYW1lICE9PSBcImxvYWRcIiAmJiBldmVudE5hbWUgIT09IFwiZXJyb3JcIiAmJiBldmVudE5hbWUgIT09IFwicHJvZ3Jlc3NcIikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXZlbnQgbm90IHN1cHBvcnRlZDogXCIgKyBldmVudE5hbWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoYW5kbGVycyA9IHRoaXMuX2xpc3RlbmVycy5nZXQoZXZlbnROYW1lKSB8fCBbXTtcbiAgICAgICAgaGFuZGxlcnMucHVzaChoYW5kbGVyKTtcbiAgICAgICAgdGhpcy5fbGlzdGVuZXJzLnNldChldmVudE5hbWUsIGhhbmRsZXJzKTtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgdG9EZXRhY2gpIHtcbiAgICAgICAgdmFyIGhhbmRsZXJzID0gdGhpcy5fbGlzdGVuZXJzLmdldChldmVudE5hbWUpIHx8IFtdO1xuICAgICAgICBoYW5kbGVycyA9IGhhbmRsZXJzLmZpbHRlcihmdW5jdGlvbiAoaGFuZGxlcikgeyByZXR1cm4gaGFuZGxlciAhPT0gdG9EZXRhY2g7IH0pO1xuICAgICAgICB0aGlzLl9saXN0ZW5lcnMuc2V0KGV2ZW50TmFtZSwgaGFuZGxlcnMpO1xuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLmVtaXRFdmVudCA9IGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIGFyZ3NbX2kgLSAxXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGhhbmRsZXJzID0gdGhpcy5fbGlzdGVuZXJzLmdldChldmVudE5hbWUpIHx8IFtdO1xuICAgICAgICBoYW5kbGVycy5mb3JFYWNoKGZ1bmN0aW9uIChoYW5kbGVyKSB7XG4gICAgICAgICAgICBoYW5kbGVyLmFwcGx5KHZvaWQgMCwgYXJncyk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNldFJlcXVlc3RIZWFkZXIgPSBmdW5jdGlvbiAoaGVhZGVyLCB2YWx1ZSkge1xuICAgICAgICBpZiAodHlwZXMuaXNEZWZpbmVkKHRoaXMuX29wdGlvbnMpICYmIHR5cGVzLmlzU3RyaW5nKGhlYWRlcikgJiYgdHlwZXMuaXNTdHJpbmcodmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLl9vcHRpb25zLmhlYWRlcnNbaGVhZGVyXSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fcmVhZHlTdGF0ZSA8IDIgfHwgdGhpcy5fZXJyb3JGbGFnKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzdWx0ID0gXCJcIjtcbiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLl9oZWFkZXJzKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gaSArIFwiOiBcIiArIHRoaXMuX2hlYWRlcnNbaV0gKyBcIlxcclxcblwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQuc3Vic3RyKDAsIHJlc3VsdC5sZW5ndGggLSAyKTtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5nZXRSZXNwb25zZUhlYWRlciA9IGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgaWYgKHR5cGVzLmlzU3RyaW5nKGhlYWRlcikgJiYgdGhpcy5fcmVhZHlTdGF0ZSA+IDFcbiAgICAgICAgICAgICYmIHRoaXMuX2hlYWRlcnNcbiAgICAgICAgICAgICYmICF0aGlzLl9lcnJvckZsYWcpIHtcbiAgICAgICAgICAgIGhlYWRlciA9IGhlYWRlci50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLl9oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkudG9Mb3dlckNhc2UoKSA9PT0gaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9oZWFkZXJzW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vdmVycmlkZU1pbWVUeXBlID0gZnVuY3Rpb24gKG1pbWUpIHtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUsIFwicmVhZHlTdGF0ZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlYWR5U3RhdGU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUsIFwicmVzcG9uc2VUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2VUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgaWYgKHZhbHVlID09PSBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZS5lbXB0eSB8fCB2YWx1ZSBpbiBYTUxIdHRwUmVxdWVzdFJlc3BvbnNlVHlwZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3BvbnNlVHlwZSA9IHZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUmVzcG9uc2UgdHlwZSBvZiAnXCIgKyB2YWx1ZSArIFwiJyBub3Qgc3VwcG9ydGVkLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLl9zZXRSZWFkeVN0YXRlID0gZnVuY3Rpb24gKHZhbHVlLCBlcnJvcikge1xuICAgICAgICBpZiAodGhpcy5fcmVhZHlTdGF0ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlYWR5U3RhdGUgPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh0eXBlcy5pc0Z1bmN0aW9uKHRoaXMub25yZWFkeXN0YXRlY2hhbmdlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMub25yZWFkeXN0YXRlY2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuX3JlYWR5U3RhdGUgPT09IHRoaXMuRE9ORSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2Vycm9yRmxhZykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlcy5pc0Z1bmN0aW9uKHRoaXMub25lcnJvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQoXCJlcnJvclwiLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZXMuaXNGdW5jdGlvbih0aGlzLm9ubG9hZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbmxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQoXCJsb2FkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInJlc3BvbnNlVGV4dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHR5cGVzLmlzRnVuY3Rpb24odGhpcy5fcmVzcG9uc2VUZXh0UmVhZGVyKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZXNwb25zZVRleHRSZWFkZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInJlc3BvbnNlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVzcG9uc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUsIFwic3RhdHVzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLCBcInN0YXR1c1RleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLlVOU0VOVCB8fCB0aGlzLl9yZWFkeVN0YXRlID09PSB0aGlzLk9QRU5FRCB8fCB0aGlzLl9lcnJvckZsYWcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBzdGF0dXNlc1t0aGlzLl9zdGF0dXNdO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gWE1MSHR0cFJlcXVlc3Q7XG59KCkpO1xuZXhwb3J0cy5YTUxIdHRwUmVxdWVzdCA9IFhNTEh0dHBSZXF1ZXN0O1xudmFyIHN0YXR1c2VzID0ge1xuICAgIDEwMDogXCJDb250aW51ZVwiLFxuICAgIDEwMTogXCJTd2l0Y2hpbmcgUHJvdG9jb2xzXCIsXG4gICAgMjAwOiBcIk9LXCIsXG4gICAgMjAxOiBcIkNyZWF0ZWRcIixcbiAgICAyMDI6IFwiQWNjZXB0ZWRcIixcbiAgICAyMDM6IFwiTm9uIC0gQXV0aG9yaXRhdGl2ZSBJbmZvcm1hdGlvblwiLFxuICAgIDIwNDogXCJObyBDb250ZW50XCIsXG4gICAgMjA1OiBcIlJlc2V0IENvbnRlbnRcIixcbiAgICAyMDY6IFwiUGFydGlhbCBDb250ZW50XCIsXG4gICAgMzAwOiBcIk11bHRpcGxlIENob2ljZXNcIixcbiAgICAzMDE6IFwiTW92ZWQgUGVybWFuZW50bHlcIixcbiAgICAzMDI6IFwiRm91bmRcIixcbiAgICAzMDM6IFwiU2VlIE90aGVyXCIsXG4gICAgMzA0OiBcIk5vdCBNb2RpZmllZFwiLFxuICAgIDMwNTogXCJVc2UgUHJveHlcIixcbiAgICAzMDc6IFwiVGVtcG9yYXJ5IFJlZGlyZWN0XCIsXG4gICAgNDAwOiBcIkJhZCBSZXF1ZXN0XCIsXG4gICAgNDAxOiBcIlVuYXV0aG9yaXplZFwiLFxuICAgIDQwMjogXCJQYXltZW50IFJlcXVpcmVkXCIsXG4gICAgNDAzOiBcIkZvcmJpZGRlblwiLFxuICAgIDQwNDogXCJOb3QgRm91bmRcIixcbiAgICA0MDU6IFwiTWV0aG9kIE5vdCBBbGxvd2VkXCIsXG4gICAgNDA2OiBcIk5vdCBBY2NlcHRhYmxlXCIsXG4gICAgNDA3OiBcIlByb3h5IEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkXCIsXG4gICAgNDA4OiBcIlJlcXVlc3QgVGltZW91dFwiLFxuICAgIDQwOTogXCJDb25mbGljdFwiLFxuICAgIDQxMDogXCJHb25lXCIsXG4gICAgNDExOiBcIkxlbmd0aCBSZXF1aXJlZFwiLFxuICAgIDQxMjogXCJQcmVjb25kaXRpb24gRmFpbGVkXCIsXG4gICAgNDEzOiBcIlJlcXVlc3QgRW50aXR5IFRvbyBMYXJnZVwiLFxuICAgIDQxNDogXCJSZXF1ZXN0IC0gVVJJIFRvbyBMb25nXCIsXG4gICAgNDE1OiBcIlVuc3VwcG9ydGVkIE1lZGlhIFR5cGVcIixcbiAgICA0MTY6IFwiUmVxdWVzdGVkIFJhbmdlIE5vdCBTYXRpc2ZpYWJsZVwiLFxuICAgIDQxNzogXCJFeHBlY3RhdGlvbiBGYWlsZWRcIixcbiAgICA1MDA6IFwiSW50ZXJuYWwgU2VydmVyIEVycm9yXCIsXG4gICAgNTAxOiBcIk5vdCBJbXBsZW1lbnRlZFwiLFxuICAgIDUwMjogXCJCYWQgR2F0ZXdheVwiLFxuICAgIDUwMzogXCJTZXJ2aWNlIFVuYXZhaWxhYmxlXCIsXG4gICAgNTA0OiBcIkdhdGV3YXkgVGltZW91dFwiLFxuICAgIDUwNTogXCJIVFRQIFZlcnNpb24gTm90IFN1cHBvcnRlZFwiXG59O1xudmFyIEZvcm1EYXRhID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGb3JtRGF0YSgpIHtcbiAgICAgICAgdGhpcy5fZGF0YSA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgRm9ybURhdGEucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xuICAgICAgICB0aGlzLl9kYXRhLnNldChuYW1lLCB2YWx1ZSk7XG4gICAgfTtcbiAgICBGb3JtRGF0YS5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBhcnIgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5fZGF0YS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgbmFtZSwgbWFwKSB7XG4gICAgICAgICAgICBhcnIucHVzaChlbmNvZGVVUklDb21wb25lbnQobmFtZSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFyci5qb2luKFwiJlwiKTtcbiAgICB9O1xuICAgIHJldHVybiBGb3JtRGF0YTtcbn0oKSk7XG5leHBvcnRzLkZvcm1EYXRhID0gRm9ybURhdGE7XG4vLyMgc291cmNlTWFwcGluZ1VSTD14aHIuanMubWFwIiwiT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGVhc3lzYXggPSByZXF1aXJlKFwiLi4vanMtbGlicy9lYXN5c2F4XCIpO1xudmFyIFBhcnNlckV2ZW50VHlwZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGFyc2VyRXZlbnRUeXBlKCkge1xuICAgIH1cbiAgICBQYXJzZXJFdmVudFR5cGUuU3RhcnRFbGVtZW50ID0gXCJTdGFydEVsZW1lbnRcIjtcbiAgICBQYXJzZXJFdmVudFR5cGUuRW5kRWxlbWVudCA9IFwiRW5kRWxlbWVudFwiO1xuICAgIFBhcnNlckV2ZW50VHlwZS5UZXh0ID0gXCJUZXh0XCI7XG4gICAgUGFyc2VyRXZlbnRUeXBlLkNEQVRBID0gXCJDREFUQVwiO1xuICAgIFBhcnNlckV2ZW50VHlwZS5Db21tZW50ID0gXCJDb21tZW50XCI7XG4gICAgcmV0dXJuIFBhcnNlckV2ZW50VHlwZTtcbn0oKSk7XG5leHBvcnRzLlBhcnNlckV2ZW50VHlwZSA9IFBhcnNlckV2ZW50VHlwZTtcbnZhciBQYXJzZXJFdmVudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGFyc2VyRXZlbnQoZXZlbnRUeXBlLCBwb3NpdGlvbiwgcHJlZml4LCBuYW1lc3BhY2UsIGVsZW1lbnROYW1lLCBhdHRyaWJ1dGVzLCBkYXRhKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50VHlwZSA9IGV2ZW50VHlwZTtcbiAgICAgICAgdGhpcy5fcG9zaXRpb24gPSBwb3NpdGlvbjtcbiAgICAgICAgdGhpcy5fcHJlZml4ID0gcHJlZml4O1xuICAgICAgICB0aGlzLl9uYW1lc3BhY2UgPSBuYW1lc3BhY2U7XG4gICAgICAgIHRoaXMuX2VsZW1lbnROYW1lID0gZWxlbWVudE5hbWU7XG4gICAgICAgIHRoaXMuX2F0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVzO1xuICAgICAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB9XG4gICAgUGFyc2VyRXZlbnQucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgZXZlbnRUeXBlOiB0aGlzLmV2ZW50VHlwZSxcbiAgICAgICAgICAgIHBvc2l0aW9uOiB0aGlzLnBvc2l0aW9uLFxuICAgICAgICAgICAgcHJlZml4OiB0aGlzLnByZWZpeCxcbiAgICAgICAgICAgIG5hbWVzcGFjZTogdGhpcy5uYW1lc3BhY2UsXG4gICAgICAgICAgICBlbGVtZW50TmFtZTogdGhpcy5lbGVtZW50TmFtZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZXM6IHRoaXMuYXR0cmlidXRlcyxcbiAgICAgICAgICAgIGRhdGE6IHRoaXMuZGF0YVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwiZXZlbnRUeXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnRUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcInBvc2l0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcG9zaXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQYXJzZXJFdmVudC5wcm90b3R5cGUsIFwicHJlZml4XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJlZml4O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcIm5hbWVzcGFjZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25hbWVzcGFjZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBhcnNlckV2ZW50LnByb3RvdHlwZSwgXCJlbGVtZW50TmFtZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnROYW1lO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcImF0dHJpYnV0ZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9hdHRyaWJ1dGVzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUGFyc2VyRXZlbnQucHJvdG90eXBlLCBcImRhdGFcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kYXRhO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gUGFyc2VyRXZlbnQ7XG59KCkpO1xuZXhwb3J0cy5QYXJzZXJFdmVudCA9IFBhcnNlckV2ZW50O1xudmFyIF9hbXBDb2RlcztcbnZhciBfZW50aXR5U2VhcmNoUmVnRXggPSAvJiMoXFxkKyk7fCYjeChbMDEyMzQ1Njc4OWFiY2RlZl0rKTt8JihcXHcrKTsvaWc7XG5mdW5jdGlvbiBfZ2VuZXJhdGVBbXBNYXAoKSB7XG4gICAgdmFyIG9iakNvZGVzID0geyBUYWI6IDksIE5ld0xpbmU6IDEwLCBleGNsOiAzMywgcXVvdDogMzQsIFFVT1Q6IDM0LCBudW06IDM1LCBkb2xsYXI6IDM2LCBwZXJjZW50OiAzNywgYW1wOiAzOCwgQU1QOiAzOCwgYXBvczogMzksIGxwYXI6IDQwLCBycGFyOiA0MSwgYXN0OiA0MiwgbWlkYXN0OiA0MiwgcGx1czogNDMsIGNvbW1hOiA0NCwgcGVyaW9kOiA0Niwgc29sOiA0NywgY29sb246IDU4LCBzZW1pOiA1OSwgbHQ6IDYwLCBMVDogNjAsIGVxdWFsczogNjEsIGd0OiA2MiwgR1Q6IDYyLCBxdWVzdDogNjMsIGNvbW1hdDogNjQsIGxzcWI6IDkxLCBsYnJhY2s6IDkxLCBic29sOiA5MiwgcnNxYjogOTIsIHJicmFjazogOTIsIEhhdDogOTQsIGxvd2JhcjogOTUsIGdyYXZlOiA5NiwgRGlhY3JpdGljYWxHcmF2ZTogOTYsIGxjdWI6IDEyMywgbGJyYWNlOiAxMjMsIHZlcmJhcjogMTI0LCB2ZXJ0OiAxMjQsIFZlcnRpY2FsTGluZTogMTI0LCByY3ViOiAxMjUsIHJicmFjZTogMTI1LCBuYnNwOiAxNjAsIGlleGNsOiAxNjEsIGNlbnQ6IDE2MiwgcG91bmQ6IDE2MywgY3VycmVuOiAxNjQsIHllbjogMTY1LCBicnZiYXI6IDE2NiwgYnJrYmFyOiAxNjYsIHNlY3Q6IDE2NywgdW1sOiAxNjgsIGNvcHk6IDE2OSwgb3JkZjogMTcwLCBsYXF1bzogMTcxLCBub3Q6IDE3Miwgc2h5OiAxNzMsIHJlZzogMTc0LCBtYWNyOiAxNzUsIGhpYmFyOiAxNzUsIGRlZzogMTc2LCBwbHVzbW46IDE3Nywgc3VwMjogMTc4LCBzdXAzOiAxNzksIGFjdXRlOiAxODAsIG1pY3JvOiAxODEsIHBhcmE6IDE4MiwgbWlkZG90OiAxODMsIGNlZGlsOiAxODQsIHN1cDE6IDE4NSwgb3JkbTogMTg2LCByYXF1bzogMTg3LCBmcmFjMTQ6IDE4OCwgZnJhYzEyOiAxODksIGZyYWMzNDogMTkwLCBpcXVlc3Q6IDE5MSwgQWdyYXZlOiAxOTIsIEFhY3V0ZTogMTkzLCBBY2lyYzogMTk0LCBBdGlsZGU6IDE5NSwgQXVtbDogMTk2LCBBcmluZzogMTk3LCBBRWxpZzogMTk4LCBDY2VkaWw6IDE5OSwgRWdyYXZlOiAyMDAsIEVhY3V0ZTogMjAxLCBFY2lyYzogMjAyLCBFdW1sOiAyMDMsIElncmF2ZTogMjA0LCBJYWN1dGU6IDIwNSwgSWNpcmM6IDIwNiwgSXVtbDogMjA3LCBFVEg6IDIwOCwgRHN0cm9rOiAyMDgsIE50aWxkZTogMjA5LCBPZ3JhdmU6IDIxMCwgT2FjdXRlOiAyMTEsIE9jaXJjOiAyMTIsIE90aWxkZTogMjEzLCBPdW1sOiAyMTQsIHRpbWVzOiAyMTUsIE9zbGFzaDogMjE2LCBVZ3JhdmU6IDIxNywgVWFjdXRlOiAyMTgsIFVjaXJjOiAyMTksIFV1bWw6IDIyMCwgWWFjdXRlOiAyMjEsIFRIT1JOOiAyMjIsIHN6bGlnOiAyMjMsIGFncmF2ZTogMjI0LCBhYWN1dGU6IDIyNSwgYWNpcmM6IDIyNiwgYXRpbGRlOiAyMjcsIGF1bWw6IDIyOCwgYXJpbmc6IDIyOSwgYWVsaWc6IDIzMCwgY2NlZGlsOiAyMzEsIGVncmF2ZTogMjMyLCBlYWN1dGU6IDIzMywgZWNpcmM6IDIzNCwgZXVtbDogMjM1LCBpZ3JhdmU6IDIzNiwgaWFjdXRlOiAyMzcsIGljaXJjOiAyMzgsIGl1bWw6IDIzOSwgZXRoOiAyNDAsIG50aWxkZTogMjQxLCBvZ3JhdmU6IDI0Miwgb2FjdXRlOiAyNDMsIG9jaXJjOiAyNDQsIG90aWxkZTogMjQ1LCBvdW1sOiAyNDYsIGRpdmlkZTogMjQ3LCBvc2xhc2g6IDI0OCwgdWdyYXZlOiAyNDksIHVhY3V0ZTogMjUwLCB1Y2lyYzogMjUxLCB1dW1sOiAyNTIsIHlhY3V0ZTogMjUzLCB0aG9ybjogMjU0LCB5dW1sOiAyNTUsIGZub2Y6IDQwMiwgaW1wZWQ6IDQzNywgZ2FjdXRlOiA1MDEsIGptYXRoOiA1NjcsIGNpcmM6IDcxMCwgY2Fyb246IDcxMSwgSGFjZWs6IDcxMSwgYnJldmU6IDcyOCwgQnJldmU6IDcyOCwgZG90OiA3MjksIERpYWNyaXRpY2FsRG90OiA3MjksIHJpbmc6IDczMCwgb2dvbjogNzMxLCB0aWxkZTogNzMyLCBEaWFjcml0aWNhbFRpbGRlOiA3MzIsIGRibGFjOiA3MzMsIERpYWNyaXRpY2FsRG91YmxlQWN1dGU6IDczMywgRG93bkJyZXZlOiA3ODUsIFVuZGVyQmFyOiA4MTgsIEFscGhhOiA5MTMsIEJldGE6IDkxNCwgR2FtbWE6IDkxNSwgRGVsdGE6IDkxNiwgRXBzaWxvbjogOTE3LCBaZXRhOiA5MTgsIEV0YTogOTE5LCBUaGV0YTogOTIwLCBJb3RhOiA5MjEsIEthcHBhOiA5MjIsIExhbWJkYTogOTIzLCBNdTogOTI0LCBOdTogOTI1LCBYaTogOTI2LCBPbWljcm9uOiA5MjcsIFBpOiA5MjgsIFJobzogOTI5LCBTaWdtYTogOTMxLCBUYXU6IDkzMiwgVXBzaWxvbjogOTMzLCBQaGk6IDkzNCwgQ2hpOiA5MzUsIFBzaTogOTM2LCBPbWVnYTogOTM3LCBhbHBoYTogOTQ1LCBiZXRhOiA5NDYsIGdhbW1hOiA5NDcsIGRlbHRhOiA5NDgsIGVwc2lsb246IDk0OSwgZXBzaXY6IDk0OSwgdmFyZXBzaWxvbjogOTQ5LCB6ZXRhOiA5NTAsIGV0YTogOTUxLCB0aGV0YTogOTUyLCBpb3RhOiA5NTMsIGthcHBhOiA5NTQsIGxhbWJkYTogOTU1LCBtdTogOTU2LCBudTogOTU3LCB4aTogOTU4LCBvbWljcm9uOiA5NTksIHBpOiA5NjAsIHJobzogOTYxLCBzaWdtYWY6IDk2Miwgc2lnbWF2OiA5NjIsIHZhcnNpZ21hOiA5NjIsIHNpZ21hOiA5NjMsIHRhdTogOTY0LCB1cHNpbG9uOiA5NjUsIHBoaTogOTY2LCBjaGk6IDk2NywgcHNpOiA5NjgsIG9tZWdhOiA5NjksIHRoZXRhdjogOTc3LCB2YXJ0aGV0YTogOTc3LCB0aGV0YXN5bTogOTc3LCBVcHNpOiA5NzgsIHVwc2loOiA5NzgsIHN0cmFpZ2h0cGhpOiA5ODEsIHBpdjogOTgyLCB2YXJwaTogOTgyLCBHYW1tYWQ6IDk4OCwgZ2FtbWFkOiA5ODksIGRpZ2FtbWE6IDk4OSwga2FwcGF2OiAxMDA4LCB2YXJrYXBwYTogMTAwOCwgcmhvdjogMTAwOSwgdmFycmhvOiAxMDA5LCBlcHNpOiAxMDEzLCBzdHJhaWdodGVwc2lsb246IDEwMTMsIGJlcHNpOiAxMDE0LCBiYWNrZXBzaWxvbjogMTAxNCwgZXVybzogODM2NCwgdHJhZGU6IDg0ODIsIFRSQURFOiA4NDgyLCBmb3JhbGw6IDg3MDQsIHBhcnQ6IDg3MDYsIGxhcnI6IDg1OTIsIHJhcnI6IDg1OTMsIGh5cGhlbjogODIwOCwgZGFzaDogODIwOCwgbmRhc2g6IDgyMTEsIG1kYXNoOiA4MjEyLCBob3JiYXI6IDgyMTMsIFZlcnQ6IDgyMTQsIFZlcmJhcjogODIxNCwgbHNxdW86IDgyMTYsIE9wZW5DdXJseVF1b3RlOiA4MjE2LCByc3F1bzogODIxNywgcnNxdW9yOiA4MjE3LCBDbG9zZUN1cmx5UXVvdGU6IDgyMTcsIGxzcXVvcjogODIxOCwgc2JxdW86IDgyMTgsIGxkcXVvOiA4MjIwLCBPcGVuQ3VybHlEb3VibGVRdW90ZTogODIyMCwgcmRxdW86IDgyMjEsIHJkcXVvcjogODIyMSwgQ2xvc2VDdXJseURvdWJsZVF1b3RlOiA4MjIxLCBsZHF1b3I6IDgyMjIsIGJkcXVvOiA4MjIyLCBkYWdnZXI6IDgyMjQsIERhZ2dlcjogODIyNSwgZGRhZ2dlcjogODIyNSwgYnVsbDogODIyNiwgYnVsbGV0OiA4MjI2LCBubGRyOiA4MjI5LCBoZWxsaXA6IDgyMzAsIG1sZHI6IDgyMzAsIGh5YnVsbDogODI1OSwgdGRvdDogODQxMSwgVHJpcGxlRG90OiA4NDExLCBEb3REb3Q6IDg0MTIsIHN0YXI6IDk3MzQsIHBob25lOiA5NzQyLCBzcGFkZXM6IDk4MjQsIGNsdWJzOiA5ODI3LCBoZWFydHM6IDk4MjksIGRpYW1zOiA5ODMwLCBmZW1hbGU6IDk3OTIsIG1hbGU6IDk3OTQsIGNoZWNrOiAxMDAwMywgY2hlY2ttYXJrOiAxMDAwMywgY3Jvc3M6IDEwMDA3LCBWZXJ0aWNhbFNlcGFyYXRvcjogMTAwNzIsIEVtcHR5U21hbGxTcXVhcmU6IDk3MjMsIEZpbGxlZFNtYWxsU3F1YXJlOiA5NzI0LCBzdGFyZjogOTczMywgYmlnc3RhcjogOTczMywgc3F1YXJlOiA5NjMzLCBzcXU6IDk2MzMsIFNxdWFyZTogOTYzMyB9O1xuICAgIHZhciBhbXBDb2RlcyA9IG5ldyBNYXAoKTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqQ29kZXMpIHtcbiAgICAgICAgaWYgKG9iakNvZGVzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGFtcENvZGVzLnNldChrZXksIG9iakNvZGVzW2tleV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhbXBDb2Rlcztcbn1cbmlmIChnbG9iYWwuX19zbmFwc2hvdCkge1xuICAgIF9hbXBDb2RlcyA9IF9nZW5lcmF0ZUFtcE1hcCgpO1xufVxuZnVuY3Rpb24gX0hhbmRsZUFtcEVudGl0aWVzKGZvdW5kLCBkZWNpbWFsVmFsdWUsIGhleFZhbHVlLCB3b3JkVmFsdWUpIHtcbiAgICBpZiAod29yZFZhbHVlKSB7XG4gICAgICAgIGlmICghX2FtcENvZGVzKSB7XG4gICAgICAgICAgICBfYW1wQ29kZXMgPSBfZ2VuZXJhdGVBbXBNYXAoKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcmVzID0gX2FtcENvZGVzLmdldCh3b3JkVmFsdWUpO1xuICAgICAgICBpZiAocmVzKSB7XG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShyZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmb3VuZDtcbiAgICB9XG4gICAgaWYgKGRlY2ltYWxWYWx1ZSkge1xuICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChkZWNpbWFsVmFsdWUsIDEwKSk7XG4gICAgfVxuICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGhleFZhbHVlLCAxNikpO1xufVxudmFyIFhtbFBhcnNlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gWG1sUGFyc2VyKG9uRXZlbnQsIG9uRXJyb3IsIHByb2Nlc3NOYW1lc3BhY2VzKSB7XG4gICAgICAgIHRoaXMuX3Byb2Nlc3NOYW1lc3BhY2VzID0gcHJvY2Vzc05hbWVzcGFjZXM7XG4gICAgICAgIHRoaXMuX3BhcnNlciA9IG5ldyBlYXN5c2F4LkVhc3lTQVhQYXJzZXIoKTtcbiAgICAgICAgdmFyIHRoYXQgPSB0aGlzO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJzdGFydE5vZGVcIiwgZnVuY3Rpb24gKGVsZW0sIGF0dHIsIHVxLCB0YWdlbmQsIHN0ciwgcG9zKSB7XG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlcyA9IGF0dHIoKTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlc1trZXldID0gWG1sUGFyc2VyLl9kZXJlZmVyZW5jZUVudGl0aWVzKGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcHJlZml4ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIG5hbWVzcGFjZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBuYW1lID0gZWxlbTtcbiAgICAgICAgICAgIGlmICh0aGF0Ll9wcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICAgICAgICAgIHZhciBzdGFja0VudHJ5ID0gWG1sUGFyc2VyLl9nZXROYW1lc3BhY2VzU3RhY2tFbnRyeShhdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICB0aGF0Ll9uYW1lc3BhY2VTdGFjay5wdXNoKHN0YWNrRW50cnkpO1xuICAgICAgICAgICAgICAgIHZhciByZXNvbHZlZCA9IHRoYXQuX3Jlc29sdmVOYW1lc3BhY2UobmFtZSk7XG4gICAgICAgICAgICAgICAgcHJlZml4ID0gcmVzb2x2ZWQucHJlZml4O1xuICAgICAgICAgICAgICAgIG5hbWVzcGFjZSA9IHJlc29sdmVkLm5hbWVzcGFjZTtcbiAgICAgICAgICAgICAgICBuYW1lID0gcmVzb2x2ZWQubmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5TdGFydEVsZW1lbnQsIHBvcygpLCBwcmVmaXgsIG5hbWVzcGFjZSwgbmFtZSwgYXR0cmlidXRlcywgdW5kZWZpbmVkKSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl9wYXJzZXIub24oXCJ0ZXh0Tm9kZVwiLCBmdW5jdGlvbiAodGV4dCwgdXEsIHBvcykge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB1cShYbWxQYXJzZXIuX2RlcmVmZXJlbmNlRW50aXRpZXModGV4dCkpO1xuICAgICAgICAgICAgb25FdmVudChuZXcgUGFyc2VyRXZlbnQoUGFyc2VyRXZlbnRUeXBlLlRleHQsIHBvcygpLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGRhdGEpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3BhcnNlci5vbihcImVuZE5vZGVcIiwgZnVuY3Rpb24gKGVsZW0sIHVxLCB0YWdzdGFydCwgc3RyLCBwb3MpIHtcbiAgICAgICAgICAgIHZhciBwcmVmaXggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgbmFtZXNwYWNlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBlbGVtO1xuICAgICAgICAgICAgaWYgKHRoYXQuX3Byb2Nlc3NOYW1lc3BhY2VzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlc29sdmVkID0gdGhhdC5fcmVzb2x2ZU5hbWVzcGFjZShuYW1lKTtcbiAgICAgICAgICAgICAgICBwcmVmaXggPSByZXNvbHZlZC5wcmVmaXg7XG4gICAgICAgICAgICAgICAgbmFtZXNwYWNlID0gcmVzb2x2ZWQubmFtZXNwYWNlO1xuICAgICAgICAgICAgICAgIG5hbWUgPSByZXNvbHZlZC5uYW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb25FdmVudChuZXcgUGFyc2VyRXZlbnQoUGFyc2VyRXZlbnRUeXBlLkVuZEVsZW1lbnQsIHBvcygpLCBwcmVmaXgsIG5hbWVzcGFjZSwgbmFtZSwgdW5kZWZpbmVkLCB1bmRlZmluZWQpKTtcbiAgICAgICAgICAgIGlmICh0aGF0Ll9wcm9jZXNzTmFtZXNwYWNlcykge1xuICAgICAgICAgICAgICAgIHRoYXQuX25hbWVzcGFjZVN0YWNrLnBvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwiY2RhdGFcIiwgZnVuY3Rpb24gKGRhdGEsIHJlcywgcG9zKSB7XG4gICAgICAgICAgICBvbkV2ZW50KG5ldyBQYXJzZXJFdmVudChQYXJzZXJFdmVudFR5cGUuQ0RBVEEsIHBvcygpLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGRhdGEpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuX3BhcnNlci5vbihcImNvbW1lbnRcIiwgZnVuY3Rpb24gKHRleHQsIHVxLCBwb3MpIHtcbiAgICAgICAgICAgIG9uRXZlbnQobmV3IFBhcnNlckV2ZW50KFBhcnNlckV2ZW50VHlwZS5Db21tZW50LCBwb3MoKSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0ZXh0KSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgICAgdGhpcy5fcGFyc2VyLm9uKFwiZXJyb3JcIiwgZnVuY3Rpb24gKG1zZywgcG9zKSB7XG4gICAgICAgICAgICAgICAgb25FcnJvcihuZXcgRXJyb3IobXNnKSwgcG9zKCkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFhtbFBhcnNlci5wcm90b3R5cGUsIFwiYW5ndWxhclN5bnRheFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhcnNlci5hbmd1bGFyU3ludGF4O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fcGFyc2VyLmFuZ3VsYXJTeW50YXggPSB2YWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgWG1sUGFyc2VyLnByb3RvdHlwZS5wYXJzZSA9IGZ1bmN0aW9uICh4bWxTdHJpbmcpIHtcbiAgICAgICAgaWYgKHRoaXMuX3Byb2Nlc3NOYW1lc3BhY2VzKSB7XG4gICAgICAgICAgICB0aGlzLl9uYW1lc3BhY2VTdGFjayA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3BhcnNlci5wYXJzZSh4bWxTdHJpbmcpO1xuICAgIH07XG4gICAgWG1sUGFyc2VyLl9nZXROYW1lc3BhY2VzU3RhY2tFbnRyeSA9IGZ1bmN0aW9uIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgIHZhciBzdGFja0VudHJ5ID0ge307XG4gICAgICAgIGlmICghYXR0cmlidXRlcykge1xuICAgICAgICAgICAgcmV0dXJuIHN0YWNrRW50cnk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGF0dHJpYnV0ZU5hbWU7XG4gICAgICAgIHZhciBuYW1lc3BhY2VQcmVmaXg7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiBhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBpZiAoIWF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXR0cmlidXRlTmFtZSA9IGtleTtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lLmluZGV4T2YoXCJ4bWxuc1wiKSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmFtZXNwYWNlUHJlZml4ID0gXCJcIjtcbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVOYW1lLmluZGV4T2YoXCI6XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIG5hbWVzcGFjZVByZWZpeCA9IGF0dHJpYnV0ZU5hbWUuc3BsaXQoXCI6XCIpWzFdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhY2tFbnRyeVtuYW1lc3BhY2VQcmVmaXhdID0gYXR0cmlidXRlc1trZXldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdGFja0VudHJ5O1xuICAgIH07XG4gICAgWG1sUGFyc2VyLnByb3RvdHlwZS5fcmVzb2x2ZU5hbWVzcGFjZSA9IGZ1bmN0aW9uIChmdWxsTmFtZSkge1xuICAgICAgICB2YXIgcmVzdWx0ID0geyBwcmVmaXg6IHVuZGVmaW5lZCwgbmFtZXNwYWNlOiB1bmRlZmluZWQsIG5hbWU6IHVuZGVmaW5lZCB9O1xuICAgICAgICByZXN1bHQucHJlZml4ID0gXCJcIjtcbiAgICAgICAgaWYgKGZ1bGxOYW1lLmluZGV4T2YoXCI6XCIpICE9PSAtMSkge1xuICAgICAgICAgICAgdmFyIHNwbGl0ID0gZnVsbE5hbWUuc3BsaXQoXCI6XCIpO1xuICAgICAgICAgICAgcmVzdWx0LnByZWZpeCA9IHNwbGl0WzBdO1xuICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSBzcGxpdFsxXTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJlc3VsdC5uYW1lID0gZnVsbE5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHN0YWNrRW50cnk7XG4gICAgICAgIGZvciAodmFyIGkgPSB0aGlzLl9uYW1lc3BhY2VTdGFjay5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgc3RhY2tFbnRyeSA9IHRoaXMuX25hbWVzcGFjZVN0YWNrW2ldO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHN0YWNrRW50cnkpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXN0YWNrRW50cnkuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5wcmVmaXggPT09IGtleSkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQubmFtZXNwYWNlID0gc3RhY2tFbnRyeVtrZXldO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgWG1sUGFyc2VyLl9kZXJlZmVyZW5jZUVudGl0aWVzID0gZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgcyA9IFN0cmluZyhzKTtcbiAgICAgICAgaWYgKHMubGVuZ3RoID4gMyAmJiBzLmluZGV4T2YoXCImXCIpICE9PSAtMSkge1xuICAgICAgICAgICAgcyA9IHMucmVwbGFjZShfZW50aXR5U2VhcmNoUmVnRXgsIF9IYW5kbGVBbXBFbnRpdGllcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHM7XG4gICAgfTtcbiAgICByZXR1cm4gWG1sUGFyc2VyO1xufSgpKTtcbmV4cG9ydHMuWG1sUGFyc2VyID0gWG1sUGFyc2VyO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9eG1sLmpzLm1hcCIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcclxuICAgICAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgICAgIH1cclxuICAgIHJldHVybiB0O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcGFyYW0ocGFyYW1JbmRleCwgZGVjb3JhdG9yKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKHRhcmdldCwga2V5KSB7IGRlY29yYXRvcih0YXJnZXQsIGtleSwgcGFyYW1JbmRleCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpIHtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0ZXIodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZ2VuZXJhdG9yKHRoaXNBcmcsIGJvZHkpIHtcclxuICAgIHZhciBfID0geyBsYWJlbDogMCwgc2VudDogZnVuY3Rpb24oKSB7IGlmICh0WzBdICYgMSkgdGhyb3cgdFsxXTsgcmV0dXJuIHRbMV07IH0sIHRyeXM6IFtdLCBvcHM6IFtdIH0sIGYsIHksIHQsIGc7XHJcbiAgICByZXR1cm4gZyA9IHsgbmV4dDogdmVyYigwKSwgXCJ0aHJvd1wiOiB2ZXJiKDEpLCBcInJldHVyblwiOiB2ZXJiKDIpIH0sIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KSwgZztcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyByZXR1cm4gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIHN0ZXAoW24sIHZdKTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gc3RlcChvcCkge1xyXG4gICAgICAgIGlmIChmKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLlwiKTtcclxuICAgICAgICB3aGlsZSAoXykgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVtcInJldHVyblwiXSA6IG9wWzBdID8geVtcInRocm93XCJdIHx8ICgodCA9IHlbXCJyZXR1cm5cIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0O1xyXG4gICAgICAgICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07XHJcbiAgICAgICAgICAgIHN3aXRjaCAob3BbMF0pIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgMDogY2FzZSAxOiB0ID0gb3A7IGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA0OiBfLmxhYmVsKys7IHJldHVybiB7IHZhbHVlOiBvcFsxXSwgZG9uZTogZmFsc2UgfTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNTogXy5sYWJlbCsrOyB5ID0gb3BbMV07IG9wID0gWzBdOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGNhc2UgNzogb3AgPSBfLm9wcy5wb3AoKTsgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEodCA9IF8udHJ5cywgdCA9IHQubGVuZ3RoID4gMCAmJiB0W3QubGVuZ3RoIC0gMV0pICYmIChvcFswXSA9PT0gNiB8fCBvcFswXSA9PT0gMikpIHsgXyA9IDA7IGNvbnRpbnVlOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSAzICYmICghdCB8fCAob3BbMV0gPiB0WzBdICYmIG9wWzFdIDwgdFszXSkpKSB7IF8ubGFiZWwgPSBvcFsxXTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDYgJiYgXy5sYWJlbCA8IHRbMV0pIHsgXy5sYWJlbCA9IHRbMV07IHQgPSBvcDsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodCAmJiBfLmxhYmVsIDwgdFsyXSkgeyBfLmxhYmVsID0gdFsyXTsgXy5vcHMucHVzaChvcCk7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRbMl0pIF8ub3BzLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgb3AgPSBib2R5LmNhbGwodGhpc0FyZywgXyk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkgeyBvcCA9IFs2LCBlXTsgeSA9IDA7IH0gZmluYWxseSB7IGYgPSB0ID0gMDsgfVxyXG4gICAgICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOyByZXR1cm4geyB2YWx1ZTogb3BbMF0gPyBvcFsxXSA6IHZvaWQgMCwgZG9uZTogdHJ1ZSB9O1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHBvcnRTdGFyKG0sIGV4cG9ydHMpIHtcclxuICAgIGZvciAodmFyIHAgaW4gbSkgaWYgKCFleHBvcnRzLmhhc093blByb3BlcnR5KHApKSBleHBvcnRzW3BdID0gbVtwXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fdmFsdWVzKG8pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXSwgaSA9IDA7XHJcbiAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwO1xyXG4gICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVhZChvLCBuKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl07XHJcbiAgICBpZiAoIW0pIHJldHVybiBvO1xyXG4gICAgdmFyIGkgPSBtLmNhbGwobyksIHIsIGFyID0gW10sIGU7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHdoaWxlICgobiA9PT0gdm9pZCAwIHx8IG4tLSA+IDApICYmICEociA9IGkubmV4dCgpKS5kb25lKSBhci5wdXNoKHIudmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycm9yKSB7IGUgPSB7IGVycm9yOiBlcnJvciB9OyB9XHJcbiAgICBmaW5hbGx5IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBpZiAociAmJiAhci5kb25lICYmIChtID0gaVtcInJldHVyblwiXSkpIG0uY2FsbChpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7IGlmIChlKSB0aHJvdyBlLmVycm9yOyB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3NwcmVhZCgpIHtcclxuICAgIGZvciAodmFyIGFyID0gW10sIGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgIGFyID0gYXIuY29uY2F0KF9fcmVhZChhcmd1bWVudHNbaV0pKTtcclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkQXJyYXlzKCkge1xyXG4gICAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSBzICs9IGFyZ3VtZW50c1tpXS5sZW5ndGg7XHJcbiAgICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspXHJcbiAgICAgICAgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspXHJcbiAgICAgICAgICAgIHJba10gPSBhW2pdO1xyXG4gICAgcmV0dXJuIHI7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsInZhciBnO1xuXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxuZyA9IChmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXM7XG59KSgpO1xuXG50cnkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcblx0ZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbn0gY2F0Y2ggKGUpIHtcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpIGcgPSB3aW5kb3c7XG59XG5cbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XG5cbm1vZHVsZS5leHBvcnRzID0gZztcbiJdLCJzb3VyY2VSb290IjoiIn0=